Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=4, mask=0, nlayer=50, obsm=4, stop=2000, ycof=0.5, ylayer=50)
Y Mean 1.919658, Std 4.231794 
Test Y Mean -0.009485, Std 4.121477 
Observe confounder 4, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.762391
Rec Loss: 10.450413
KL Loss: 0.311978
Y Loss: 0.673234
T Loss: 10.113796
Epoch 99 
Overall Loss: 10.474853
Rec Loss: 10.332323
KL Loss: 0.142530
Y Loss: 0.344853
T Loss: 10.159897
Epoch 149 
Overall Loss: 10.388098
Rec Loss: 10.276120
KL Loss: 0.111978
Y Loss: 0.215699
T Loss: 10.168270
Epoch 199 
Overall Loss: 10.357509
Rec Loss: 10.254481
KL Loss: 0.103028
Y Loss: 0.170064
T Loss: 10.169449
Epoch 249 
Overall Loss: 10.342328
Rec Loss: 10.238103
KL Loss: 0.104226
Y Loss: 0.140065
T Loss: 10.168070
Epoch 299 
Overall Loss: 10.314717
Rec Loss: 10.225778
KL Loss: 0.088939
Y Loss: 0.119409
T Loss: 10.166073
Epoch 349 
Overall Loss: 10.294513
Rec Loss: 10.221631
KL Loss: 0.072882
Y Loss: 0.107671
T Loss: 10.167795
Epoch 399 
Overall Loss: 10.278407
Rec Loss: 10.208846
KL Loss: 0.069561
Y Loss: 0.093330
T Loss: 10.162181
Epoch 449 
Overall Loss: 10.267760
Rec Loss: 10.202628
KL Loss: 0.065131
Y Loss: 0.083838
T Loss: 10.160710
Epoch 499 
Overall Loss: 10.269553
Rec Loss: 10.204735
KL Loss: 0.064818
Y Loss: 0.086336
T Loss: 10.161567
Epoch 549 
Overall Loss: 10.255177
Rec Loss: 10.196960
KL Loss: 0.058218
Y Loss: 0.075544
T Loss: 10.159188
Epoch 599 
Overall Loss: 10.254210
Rec Loss: 10.191633
KL Loss: 0.062576
Y Loss: 0.072492
T Loss: 10.155387
Epoch 649 
Overall Loss: 10.244069
Rec Loss: 10.186507
KL Loss: 0.057563
Y Loss: 0.066763
T Loss: 10.153125
Epoch 699 
Overall Loss: 10.238789
Rec Loss: 10.189171
KL Loss: 0.049618
Y Loss: 0.062551
T Loss: 10.157895
Epoch 749 
Overall Loss: 10.227855
Rec Loss: 10.178154
KL Loss: 0.049701
Y Loss: 0.057772
T Loss: 10.149268
Epoch 799 
Overall Loss: 10.246970
Rec Loss: 10.178981
KL Loss: 0.067989
Y Loss: 0.056618
T Loss: 10.150672
Epoch 849 
Overall Loss: 10.216588
Rec Loss: 10.172851
KL Loss: 0.043736
Y Loss: 0.051877
T Loss: 10.146913
Epoch 899 
Overall Loss: 10.219764
Rec Loss: 10.175481
KL Loss: 0.044283
Y Loss: 0.052979
T Loss: 10.148991
Epoch 949 
Overall Loss: 10.215388
Rec Loss: 10.169747
KL Loss: 0.045641
Y Loss: 0.048722
T Loss: 10.145387
Epoch 999 
Overall Loss: 10.222046
Rec Loss: 10.166863
KL Loss: 0.055183
Y Loss: 0.050054
T Loss: 10.141836
Epoch 1049 
Overall Loss: 10.198125
Rec Loss: 10.152027
KL Loss: 0.046098
Y Loss: 0.051963
T Loss: 10.126045
Epoch 1099 
Overall Loss: 10.202817
Rec Loss: 10.149860
KL Loss: 0.052957
Y Loss: 0.058476
T Loss: 10.120622
Epoch 1149 
Overall Loss: 10.202700
Rec Loss: 10.152658
KL Loss: 0.050042
Y Loss: 0.043586
T Loss: 10.130865
Epoch 1199 
Overall Loss: 10.209545
Rec Loss: 10.153695
KL Loss: 0.055849
Y Loss: 0.043903
T Loss: 10.131744
Epoch 1249 
Overall Loss: 10.192280
Rec Loss: 10.151419
KL Loss: 0.040861
Y Loss: 0.049104
T Loss: 10.126867
Epoch 1299 
Overall Loss: 10.182650
Rec Loss: 10.145171
KL Loss: 0.037479
Y Loss: 0.038808
T Loss: 10.125767
Epoch 1349 
Overall Loss: 10.178594
Rec Loss: 10.142075
KL Loss: 0.036520
Y Loss: 0.038773
T Loss: 10.122688
Epoch 1399 
Overall Loss: 10.172814
Rec Loss: 10.138838
KL Loss: 0.033976
Y Loss: 0.037542
T Loss: 10.120067
Epoch 1449 
Overall Loss: 10.182106
Rec Loss: 10.142800
KL Loss: 0.039306
Y Loss: 0.040100
T Loss: 10.122750
Epoch 1499 
Overall Loss: 10.166147
Rec Loss: 10.132826
KL Loss: 0.033321
Y Loss: 0.036405
T Loss: 10.114623
Epoch 1549 
Overall Loss: 10.168334
Rec Loss: 10.136465
KL Loss: 0.031869
Y Loss: 0.034221
T Loss: 10.119354
Epoch 1599 
Overall Loss: 10.164469
Rec Loss: 10.132225
KL Loss: 0.032243
Y Loss: 0.032368
T Loss: 10.116041
Epoch 1649 
Overall Loss: 10.169886
Rec Loss: 10.132914
KL Loss: 0.036972
Y Loss: 0.034919
T Loss: 10.115455
Epoch 1699 
Overall Loss: 10.158532
Rec Loss: 10.126996
KL Loss: 0.031536
Y Loss: 0.036868
T Loss: 10.108562
Epoch 1749 
Overall Loss: 10.166627
Rec Loss: 10.129806
KL Loss: 0.036821
Y Loss: 0.034708
T Loss: 10.112453
Epoch 1799 
Overall Loss: 10.159646
Rec Loss: 10.124733
KL Loss: 0.034913
Y Loss: 0.036764
T Loss: 10.106351
Epoch 1849 
Overall Loss: 10.163842
Rec Loss: 10.123682
KL Loss: 0.040160
Y Loss: 0.039229
T Loss: 10.104067
Epoch 1899 
Overall Loss: 10.150877
Rec Loss: 10.119881
KL Loss: 0.030996
Y Loss: 0.033016
T Loss: 10.103373
Epoch 1949 
Overall Loss: 10.151570
Rec Loss: 10.120722
KL Loss: 0.030848
Y Loss: 0.034054
T Loss: 10.103695
Epoch 1999 
Overall Loss: 10.144641
Rec Loss: 10.115338
KL Loss: 0.029303
Y Loss: 0.032899
T Loss: 10.098888
Epoch 2049 
Overall Loss: 10.143320
Rec Loss: 10.114531
KL Loss: 0.028790
Y Loss: 0.034857
T Loss: 10.097101
Epoch 2099 
Overall Loss: 10.145741
Rec Loss: 10.115567
KL Loss: 0.030173
Y Loss: 0.032395
T Loss: 10.099370
Epoch 2149 
Overall Loss: 10.137552
Rec Loss: 10.110036
KL Loss: 0.027516
Y Loss: 0.030982
T Loss: 10.094545
Epoch 2199 
Overall Loss: 10.137445
Rec Loss: 10.108967
KL Loss: 0.028478
Y Loss: 0.033931
T Loss: 10.092001
Epoch 2249 
Overall Loss: 10.149589
Rec Loss: 10.110851
KL Loss: 0.038738
Y Loss: 0.034104
T Loss: 10.093799
Epoch 2299 
Overall Loss: 10.133225
Rec Loss: 10.102728
KL Loss: 0.030496
Y Loss: 0.030025
T Loss: 10.087716
Epoch 2349 
Overall Loss: 10.129275
Rec Loss: 10.102353
KL Loss: 0.026923
Y Loss: 0.027316
T Loss: 10.088695
Epoch 2399 
Overall Loss: 10.129956
Rec Loss: 10.104065
KL Loss: 0.025890
Y Loss: 0.029831
T Loss: 10.089150
Epoch 2449 
Overall Loss: 10.123377
Rec Loss: 10.096678
KL Loss: 0.026700
Y Loss: 0.027575
T Loss: 10.082890
Epoch 2499 
Overall Loss: 10.125612
Rec Loss: 10.099638
KL Loss: 0.025975
Y Loss: 0.027732
T Loss: 10.085772
Epoch 2549 
Overall Loss: 10.136820
Rec Loss: 10.099240
KL Loss: 0.037580
Y Loss: 0.032158
T Loss: 10.083162
Epoch 2599 
Overall Loss: 10.119015
Rec Loss: 10.093342
KL Loss: 0.025672
Y Loss: 0.028953
T Loss: 10.078866
Epoch 2649 
Overall Loss: 10.120131
Rec Loss: 10.095947
KL Loss: 0.024183
Y Loss: 0.028727
T Loss: 10.081584
Epoch 2699 
Overall Loss: 10.120765
Rec Loss: 10.094157
KL Loss: 0.026607
Y Loss: 0.027913
T Loss: 10.080201
Epoch 2749 
Overall Loss: 10.120724
Rec Loss: 10.093824
KL Loss: 0.026900
Y Loss: 0.028550
T Loss: 10.079549
Epoch 2799 
Overall Loss: 10.196608
Rec Loss: 10.095714
KL Loss: 0.100894
Y Loss: 0.042194
T Loss: 10.074617
Epoch 2849 
Overall Loss: 10.119346
Rec Loss: 10.088435
KL Loss: 0.030911
Y Loss: 0.024977
T Loss: 10.075947
Epoch 2899 
Overall Loss: 10.114049
Rec Loss: 10.085286
KL Loss: 0.028763
Y Loss: 0.026450
T Loss: 10.072062
Epoch 2949 
Overall Loss: 10.112230
Rec Loss: 10.086187
KL Loss: 0.026043
Y Loss: 0.027353
T Loss: 10.072510
Epoch 2999 
Overall Loss: 10.105600
Rec Loss: 10.082600
KL Loss: 0.023000
Y Loss: 0.025200
T Loss: 10.070000
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.020760
Epoch 99
Rec Loss: 0.016708
Epoch 149
Rec Loss: 0.015605
Epoch 199
Rec Loss: 0.015361
Epoch 249
Rec Loss: 0.015086
Epoch 299
Rec Loss: 0.014766
Epoch 349
Rec Loss: 0.014564
Epoch 399
Rec Loss: 0.014639
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.090474
Epoch 99
Rec Loss: 10.065150
Epoch 149
Rec Loss: 10.052758
Epoch 199
Rec Loss: 10.038551
Epoch 249
Rec Loss: 10.017989
Epoch 299
Rec Loss: 10.031857
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.106979
Insample Error: 0.478531
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.498235
Rec Loss: 18.213050
KL Loss: 3.285185
Y Loss: 8.410388
T Loss: 13.200959
X Loss: 0.806897
Epoch 99 
Overall Loss: 2.676435
Rec Loss: -7.909610
KL Loss: 10.586045
Y Loss: 2.263854
T Loss: 13.038490
X Loss: -22.080027
Epoch 149 
Overall Loss: -3.536425
Rec Loss: -15.512208
KL Loss: 11.975782
Y Loss: 1.481101
T Loss: 12.864040
X Loss: -29.116798
Epoch 199 
Overall Loss: -7.179170
Rec Loss: -20.501919
KL Loss: 13.322749
Y Loss: 0.869356
T Loss: 12.609268
X Loss: -33.545865
Epoch 249 
Overall Loss: -9.367569
Rec Loss: -23.716105
KL Loss: 14.348536
Y Loss: 0.549641
T Loss: 12.378907
X Loss: -36.369833
Epoch 299 
Overall Loss: -10.924624
Rec Loss: -26.004060
KL Loss: 15.079436
Y Loss: 0.405460
T Loss: 12.230502
X Loss: -38.437291
Epoch 349 
Overall Loss: -11.968761
Rec Loss: -27.440254
KL Loss: 15.471494
Y Loss: 0.339175
T Loss: 12.153485
X Loss: -39.763327
Epoch 399 
Overall Loss: -12.714738
Rec Loss: -28.500779
KL Loss: 15.786041
Y Loss: 0.305953
T Loss: 12.090939
X Loss: -40.744695
Epoch 449 
Overall Loss: -13.654522
Rec Loss: -29.706939
KL Loss: 16.052416
Y Loss: 0.289280
T Loss: 12.062162
X Loss: -41.913740
Epoch 499 
Overall Loss: -14.277811
Rec Loss: -30.496953
KL Loss: 16.219144
Y Loss: 0.273738
T Loss: 12.036616
X Loss: -42.670439
Epoch 549 
Overall Loss: -14.945511
Rec Loss: -31.294125
KL Loss: 16.348614
Y Loss: 0.257664
T Loss: 11.982948
X Loss: -43.405906
Epoch 599 
Overall Loss: -15.447288
Rec Loss: -31.923910
KL Loss: 16.476623
Y Loss: 0.256168
T Loss: 11.972290
X Loss: -44.024284
Epoch 649 
Overall Loss: -15.728476
Rec Loss: -32.217609
KL Loss: 16.489133
Y Loss: 0.247598
T Loss: 11.936662
X Loss: -44.278069
Epoch 699 
Overall Loss: -16.469704
Rec Loss: -33.224891
KL Loss: 16.755186
Y Loss: 0.229951
T Loss: 11.886656
X Loss: -45.226522
Epoch 749 
Overall Loss: -16.715697
Rec Loss: -33.593031
KL Loss: 16.877335
Y Loss: 0.234223
T Loss: 11.844021
X Loss: -45.554164
Epoch 799 
Overall Loss: -17.149247
Rec Loss: -34.099170
KL Loss: 16.949925
Y Loss: 0.220845
T Loss: 11.815173
X Loss: -46.024765
Epoch 849 
Overall Loss: -17.773889
Rec Loss: -34.796705
KL Loss: 17.022816
Y Loss: 0.213545
T Loss: 11.764995
X Loss: -46.668472
Epoch 899 
Overall Loss: -17.998611
Rec Loss: -35.047416
KL Loss: 17.048804
Y Loss: 0.203296
T Loss: 11.716765
X Loss: -46.865829
Epoch 949 
Overall Loss: -18.276450
Rec Loss: -35.446120
KL Loss: 17.169670
Y Loss: 0.205903
T Loss: 11.667639
X Loss: -47.216711
Epoch 999 
Overall Loss: -18.640531
Rec Loss: -35.904673
KL Loss: 17.264141
Y Loss: 0.196850
T Loss: 11.611638
X Loss: -47.614735
Epoch 1049 
Overall Loss: -19.019343
Rec Loss: -36.296191
KL Loss: 17.276849
Y Loss: 0.172178
T Loss: 11.592444
X Loss: -47.974724
Epoch 1099 
Overall Loss: -19.171152
Rec Loss: -36.482868
KL Loss: 17.311717
Y Loss: 0.166887
T Loss: 11.562456
X Loss: -48.128768
Epoch 1149 
Overall Loss: -19.345567
Rec Loss: -36.755920
KL Loss: 17.410352
Y Loss: 0.164693
T Loss: 11.533560
X Loss: -48.371827
Epoch 1199 
Overall Loss: -19.582621
Rec Loss: -37.136569
KL Loss: 17.553948
Y Loss: 0.169768
T Loss: 11.508246
X Loss: -48.729698
Epoch 1249 
Overall Loss: -19.739486
Rec Loss: -37.373332
KL Loss: 17.633846
Y Loss: 0.166189
T Loss: 11.479939
X Loss: -48.936365
Epoch 1299 
Overall Loss: -19.830900
Rec Loss: -37.435838
KL Loss: 17.604938
Y Loss: 0.161884
T Loss: 11.463798
X Loss: -48.980578
Epoch 1349 
Overall Loss: -20.149844
Rec Loss: -37.706882
KL Loss: 17.557037
Y Loss: 0.171050
T Loss: 11.455873
X Loss: -49.248281
Epoch 1399 
Overall Loss: -20.126961
Rec Loss: -37.867626
KL Loss: 17.740664
Y Loss: 0.157937
T Loss: 11.435149
X Loss: -49.381743
Epoch 1449 
Overall Loss: -20.685534
Rec Loss: -38.487033
KL Loss: 17.801498
Y Loss: 0.148723
T Loss: 11.426306
X Loss: -49.987700
Epoch 1499 
Overall Loss: -20.775833
Rec Loss: -38.627821
KL Loss: 17.851988
Y Loss: 0.163340
T Loss: 11.404309
X Loss: -50.113799
Epoch 1549 
Overall Loss: -21.062126
Rec Loss: -39.043146
KL Loss: 17.981020
Y Loss: 0.143497
T Loss: 11.396853
X Loss: -50.511747
Epoch 1599 
Overall Loss: -21.279584
Rec Loss: -39.039685
KL Loss: 17.760101
Y Loss: 0.163084
T Loss: 11.404118
X Loss: -50.525344
Epoch 1649 
Overall Loss: -21.482840
Rec Loss: -39.345022
KL Loss: 17.862182
Y Loss: 0.156913
T Loss: 11.395925
X Loss: -50.819403
Epoch 1699 
Overall Loss: -21.446177
Rec Loss: -39.489897
KL Loss: 18.043720
Y Loss: 0.146761
T Loss: 11.366963
X Loss: -50.930239
Epoch 1749 
Overall Loss: -21.738422
Rec Loss: -39.790756
KL Loss: 18.052334
Y Loss: 0.162587
T Loss: 11.363283
X Loss: -51.235331
Epoch 1799 
Overall Loss: -21.946888
Rec Loss: -40.117248
KL Loss: 18.170359
Y Loss: 0.152110
T Loss: 11.355813
X Loss: -51.549116
Epoch 1849 
Overall Loss: -22.088212
Rec Loss: -40.213749
KL Loss: 18.125537
Y Loss: 0.149726
T Loss: 11.352744
X Loss: -51.641356
Epoch 1899 
Overall Loss: -21.952782
Rec Loss: -40.109085
KL Loss: 18.156304
Y Loss: 0.149012
T Loss: 11.348157
X Loss: -51.531747
Epoch 1949 
Overall Loss: -22.173122
Rec Loss: -40.397459
KL Loss: 18.224336
Y Loss: 0.147968
T Loss: 11.326439
X Loss: -51.797882
Epoch 1999 
Overall Loss: -22.250590
Rec Loss: -40.338561
KL Loss: 18.087970
Y Loss: 0.150686
T Loss: 11.337668
X Loss: -51.751572
Epoch 2049 
Overall Loss: -22.569319
Rec Loss: -40.782644
KL Loss: 18.213325
Y Loss: 0.160424
T Loss: 11.318082
X Loss: -52.180937
Epoch 2099 
Overall Loss: -22.101898
Rec Loss: -40.200673
KL Loss: 18.098775
Y Loss: 0.157313
T Loss: 11.330323
X Loss: -51.609654
Epoch 2149 
Overall Loss: -22.844965
Rec Loss: -41.256172
KL Loss: 18.411206
Y Loss: 0.147395
T Loss: 11.304394
X Loss: -52.634263
Epoch 2199 
Overall Loss: -22.577426
Rec Loss: -40.929881
KL Loss: 18.352455
Y Loss: 0.150254
T Loss: 11.303634
X Loss: -52.308643
Epoch 2249 
Overall Loss: -23.000269
Rec Loss: -41.433201
KL Loss: 18.432932
Y Loss: 0.136749
T Loss: 11.293634
X Loss: -52.795210
Epoch 2299 
Overall Loss: -22.882964
Rec Loss: -41.146554
KL Loss: 18.263590
Y Loss: 0.154229
T Loss: 11.300154
X Loss: -52.523823
Epoch 2349 
Overall Loss: -23.457399
Rec Loss: -41.978623
KL Loss: 18.521224
Y Loss: 0.155300
T Loss: 11.276804
X Loss: -53.333078
Epoch 2399 
Overall Loss: -23.289050
Rec Loss: -41.684963
KL Loss: 18.395914
Y Loss: 0.151518
T Loss: 11.291901
X Loss: -53.052624
Epoch 2449 
Overall Loss: -23.399584
Rec Loss: -41.909223
KL Loss: 18.509640
Y Loss: 0.156777
T Loss: 11.272557
X Loss: -53.260169
Epoch 2499 
Overall Loss: -23.649483
Rec Loss: -42.152566
KL Loss: 18.503083
Y Loss: 0.151879
T Loss: 11.276626
X Loss: -53.505131
Epoch 2549 
Overall Loss: -23.747839
Rec Loss: -42.195823
KL Loss: 18.447985
Y Loss: 0.169477
T Loss: 11.268541
X Loss: -53.549102
Epoch 2599 
Overall Loss: -23.668048
Rec Loss: -42.127501
KL Loss: 18.459453
Y Loss: 0.167216
T Loss: 11.260546
X Loss: -53.471653
Epoch 2649 
Overall Loss: -23.632042
Rec Loss: -42.131656
KL Loss: 18.499615
Y Loss: 0.161895
T Loss: 11.258253
X Loss: -53.470856
Epoch 2699 
Overall Loss: -24.120170
Rec Loss: -42.799079
KL Loss: 18.678909
Y Loss: 0.156196
T Loss: 11.244634
X Loss: -54.121812
Epoch 2749 
Overall Loss: -24.176033
Rec Loss: -42.769894
KL Loss: 18.593863
Y Loss: 0.169452
T Loss: 11.237223
X Loss: -54.091844
Epoch 2799 
Overall Loss: -22.869221
Rec Loss: -41.472613
KL Loss: 18.603392
Y Loss: 0.165345
T Loss: 11.250758
X Loss: -52.806044
Epoch 2849 
Overall Loss: -23.571611
Rec Loss: -42.035348
KL Loss: 18.463738
Y Loss: 0.175774
T Loss: 11.247140
X Loss: -53.370374
Epoch 2899 
Overall Loss: -23.859170
Rec Loss: -42.529138
KL Loss: 18.669968
Y Loss: 0.176522
T Loss: 11.237572
X Loss: -53.854971
Epoch 2949 
Overall Loss: -24.341368
Rec Loss: -42.855404
KL Loss: 18.514037
Y Loss: 0.184100
T Loss: 11.241054
X Loss: -54.188508
Epoch 2999 
Overall Loss: -24.507804
Rec Loss: -43.112989
KL Loss: 18.605187
Y Loss: 0.171792
T Loss: 11.225589
X Loss: -54.424475
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.210999
Epoch 99
Rec Loss: 2.193399
Epoch 149
Rec Loss: 2.171881
Epoch 199
Rec Loss: 2.165812
Epoch 249
Rec Loss: 2.152346
Epoch 299
Rec Loss: 2.152388
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.003267
Epoch 99
Rec Loss: 0.001706
Epoch 149
Rec Loss: 0.001183
Epoch 199
Rec Loss: 0.000825
Epoch 249
Rec Loss: 0.000926
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.222462
Insample Error 3.243248
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.556990
Epoch 99 
Prediction Loss: 0.164898
Epoch 149 
Prediction Loss: 0.088503
Epoch 199 
Prediction Loss: 0.059233
Epoch 249 
Prediction Loss: 0.041679
Epoch 299 
Prediction Loss: 0.032728
Epoch 349 
Prediction Loss: 0.028118
Epoch 399 
Prediction Loss: 0.022249
Epoch 449 
Prediction Loss: 0.018853
Epoch 499 
Prediction Loss: 0.016738
Epoch 549 
Prediction Loss: 0.014018
Epoch 599 
Prediction Loss: 0.012757
Epoch 649 
Prediction Loss: 0.014334
Epoch 699 
Prediction Loss: 0.011128
Epoch 749 
Prediction Loss: 0.010384
Epoch 799 
Prediction Loss: 0.011263
Epoch 849 
Prediction Loss: 0.010200
Epoch 899 
Prediction Loss: 0.008331
Epoch 949 
Prediction Loss: 0.008273
Epoch 999 
Prediction Loss: 0.008904
Epoch 1049 
Prediction Loss: 0.007257
Epoch 1099 
Prediction Loss: 0.006472
Epoch 1149 
Prediction Loss: 0.006529
Epoch 1199 
Prediction Loss: 0.010293
Epoch 1249 
Prediction Loss: 0.005956
Epoch 1299 
Prediction Loss: 0.006419
Epoch 1349 
Prediction Loss: 0.006218
Epoch 1399 
Prediction Loss: 0.005407
Epoch 1449 
Prediction Loss: 0.006122
Epoch 1499 
Prediction Loss: 0.005690
Epoch 1549 
Prediction Loss: 0.004947
Epoch 1599 
Prediction Loss: 0.004541
Epoch 1649 
Prediction Loss: 0.004508
Epoch 1699 
Prediction Loss: 0.005009
Epoch 1749 
Prediction Loss: 0.004445
Epoch 1799 
Prediction Loss: 0.007810
Epoch 1849 
Prediction Loss: 0.006992
Epoch 1899 
Prediction Loss: 0.003820
Epoch 1949 
Prediction Loss: 0.004210
Epoch 1999 
Prediction Loss: 0.004601
Epoch 2049 
Prediction Loss: 0.007882
Epoch 2099 
Prediction Loss: 0.003481
Epoch 2149 
Prediction Loss: 0.003500
Epoch 2199 
Prediction Loss: 0.007241
Epoch 2249 
Prediction Loss: 0.003253
Epoch 2299 
Prediction Loss: 0.003091
Epoch 2349 
Prediction Loss: 0.003420
Epoch 2399 
Prediction Loss: 0.003269
Epoch 2449 
Prediction Loss: 0.003741
Epoch 2499 
Prediction Loss: 0.002830
Epoch 2549 
Prediction Loss: 0.003958
Epoch 2599 
Prediction Loss: 0.003679
Epoch 2649 
Prediction Loss: 0.004839
Epoch 2699 
Prediction Loss: 0.003000
Epoch 2749 
Prediction Loss: 0.003819
Epoch 2799 
Prediction Loss: 0.002709
Epoch 2849 
Prediction Loss: 0.004264
Epoch 2899 
Prediction Loss: 0.003258
Epoch 2949 
Prediction Loss: 0.005575
Epoch 2999 
Prediction Loss: 0.002483
Epoch 3049 
Prediction Loss: 0.007563
Epoch 3099 
Prediction Loss: 0.002443
Epoch 3149 
Prediction Loss: 0.002957
Epoch 3199 
Prediction Loss: 0.003086
Epoch 3249 
Prediction Loss: 0.003920
Epoch 3299 
Prediction Loss: 0.002847
Epoch 3349 
Prediction Loss: 0.002936
Epoch 3399 
Prediction Loss: 0.002942
Epoch 3449 
Prediction Loss: 0.003314
Epoch 3499 
Prediction Loss: 0.002257
Epoch 3549 
Prediction Loss: 0.003826
Epoch 3599 
Prediction Loss: 0.003935
Epoch 3649 
Prediction Loss: 0.002929
Epoch 3699 
Prediction Loss: 0.002098
Epoch 3749 
Prediction Loss: 0.002273
Epoch 3799 
Prediction Loss: 0.002524
Epoch 3849 
Prediction Loss: 0.002908
Epoch 3899 
Prediction Loss: 0.003167
Epoch 3949 
Prediction Loss: 0.002517
Epoch 3999 
Prediction Loss: 0.001933
Epoch 4049 
Prediction Loss: 0.003858
Epoch 4099 
Prediction Loss: 0.003059
Epoch 4149 
Prediction Loss: 0.003107
Epoch 4199 
Prediction Loss: 0.002792
Epoch 4249 
Prediction Loss: 0.003528
Epoch 4299 
Prediction Loss: 0.002221
Epoch 4349 
Prediction Loss: 0.002548
Epoch 4399 
Prediction Loss: 0.002682
Epoch 4449 
Prediction Loss: 0.001658
Epoch 4499 
Prediction Loss: 0.002185
Epoch 4549 
Prediction Loss: 0.002607
Epoch 4599 
Prediction Loss: 0.003491
Epoch 4649 
Prediction Loss: 0.001941
Epoch 4699 
Prediction Loss: 0.002676
Epoch 4749 
Prediction Loss: 0.002843
Epoch 4799 
Prediction Loss: 0.002151
Epoch 4849 
Prediction Loss: 0.003309
Epoch 4899 
Prediction Loss: 0.001856
Epoch 4949 
Prediction Loss: 0.002194
Epoch 4999 
Prediction Loss: 0.005199
Epoch 5049 
Prediction Loss: 0.002290
Epoch 5099 
Prediction Loss: 0.001867
Epoch 5149 
Prediction Loss: 0.003076
Epoch 5199 
Prediction Loss: 0.002058
Epoch 5249 
Prediction Loss: 0.002163
Epoch 5299 
Prediction Loss: 0.001890
Epoch 5349 
Prediction Loss: 0.001522
Epoch 5399 
Prediction Loss: 0.002220
Epoch 5449 
Prediction Loss: 0.001692
Epoch 5499 
Prediction Loss: 0.002663
Epoch 5549 
Prediction Loss: 0.001650
Epoch 5599 
Prediction Loss: 0.001818
Epoch 5649 
Prediction Loss: 0.002107
Epoch 5699 
Prediction Loss: 0.002097
Epoch 5749 
Prediction Loss: 0.002164
Epoch 5799 
Prediction Loss: 0.005564
Epoch 5849 
Prediction Loss: 0.006571
Epoch 5899 
Prediction Loss: 0.002006
Epoch 5949 
Prediction Loss: 0.001844
Epoch 5999 
Prediction Loss: 0.001697
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.045452
Insample Error 0.209763
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.750630
Rec Loss: 10.442093
KL Loss: 0.308537
Y Loss: 0.655671
T Loss: 10.114258
Epoch 99 
Overall Loss: 10.441656
Rec Loss: 10.304870
KL Loss: 0.136786
Y Loss: 0.284861
T Loss: 10.162441
Epoch 149 
Overall Loss: 10.344838
Rec Loss: 10.242296
KL Loss: 0.102541
Y Loss: 0.145567
T Loss: 10.169513
Epoch 199 
Overall Loss: 10.316416
Rec Loss: 10.222932
KL Loss: 0.093484
Y Loss: 0.117359
T Loss: 10.164252
Epoch 249 
Overall Loss: 10.299083
Rec Loss: 10.219237
KL Loss: 0.079846
Y Loss: 0.100372
T Loss: 10.169051
Epoch 299 
Overall Loss: 10.289101
Rec Loss: 10.212252
KL Loss: 0.076849
Y Loss: 0.086620
T Loss: 10.168942
Epoch 349 
Overall Loss: 10.291616
Rec Loss: 10.210214
KL Loss: 0.081402
Y Loss: 0.079019
T Loss: 10.170704
Epoch 399 
Overall Loss: 10.270502
Rec Loss: 10.202858
KL Loss: 0.067644
Y Loss: 0.073657
T Loss: 10.166029
Epoch 449 
Overall Loss: 10.259573
Rec Loss: 10.194023
KL Loss: 0.065550
Y Loss: 0.066221
T Loss: 10.160913
Epoch 499 
Overall Loss: 10.262488
Rec Loss: 10.200843
KL Loss: 0.061645
Y Loss: 0.071042
T Loss: 10.165322
Epoch 549 
Overall Loss: 10.252181
Rec Loss: 10.189745
KL Loss: 0.062436
Y Loss: 0.059904
T Loss: 10.159793
Epoch 599 
Overall Loss: 10.233405
Rec Loss: 10.181710
KL Loss: 0.051695
Y Loss: 0.054435
T Loss: 10.154492
Epoch 649 
Overall Loss: 10.235642
Rec Loss: 10.182930
KL Loss: 0.052713
Y Loss: 0.053757
T Loss: 10.156051
Epoch 699 
Overall Loss: 10.226755
Rec Loss: 10.178333
KL Loss: 0.048422
Y Loss: 0.052377
T Loss: 10.152144
Epoch 749 
Overall Loss: 10.225236
Rec Loss: 10.178942
KL Loss: 0.046294
Y Loss: 0.050717
T Loss: 10.153583
Epoch 799 
Overall Loss: 10.219539
Rec Loss: 10.174029
KL Loss: 0.045511
Y Loss: 0.049089
T Loss: 10.149484
Epoch 849 
Overall Loss: 10.223277
Rec Loss: 10.173880
KL Loss: 0.049396
Y Loss: 0.048341
T Loss: 10.149710
Epoch 899 
Overall Loss: 10.216942
Rec Loss: 10.171867
KL Loss: 0.045075
Y Loss: 0.046343
T Loss: 10.148696
Epoch 949 
Overall Loss: 10.210156
Rec Loss: 10.166499
KL Loss: 0.043657
Y Loss: 0.042497
T Loss: 10.145250
Epoch 999 
Overall Loss: 10.207582
Rec Loss: 10.165488
KL Loss: 0.042094
Y Loss: 0.044741
T Loss: 10.143117
Epoch 1049 
Overall Loss: 10.199626
Rec Loss: 10.160590
KL Loss: 0.039036
Y Loss: 0.042540
T Loss: 10.139321
Epoch 1099 
Overall Loss: 10.189925
Rec Loss: 10.151377
KL Loss: 0.038548
Y Loss: 0.042274
T Loss: 10.130240
Epoch 1149 
Overall Loss: 10.186249
Rec Loss: 10.148747
KL Loss: 0.037502
Y Loss: 0.038135
T Loss: 10.129679
Epoch 1199 
Overall Loss: 10.184532
Rec Loss: 10.146628
KL Loss: 0.037904
Y Loss: 0.038593
T Loss: 10.127331
Epoch 1249 
Overall Loss: 10.179166
Rec Loss: 10.142517
KL Loss: 0.036649
Y Loss: 0.035547
T Loss: 10.124743
Epoch 1299 
Overall Loss: 10.179405
Rec Loss: 10.145206
KL Loss: 0.034198
Y Loss: 0.033351
T Loss: 10.128531
Epoch 1349 
Overall Loss: 10.177113
Rec Loss: 10.141871
KL Loss: 0.035243
Y Loss: 0.036179
T Loss: 10.123781
Epoch 1399 
Overall Loss: 10.173222
Rec Loss: 10.140336
KL Loss: 0.032886
Y Loss: 0.034164
T Loss: 10.123254
Epoch 1449 
Overall Loss: 10.178840
Rec Loss: 10.139266
KL Loss: 0.039575
Y Loss: 0.031532
T Loss: 10.123500
Epoch 1499 
Overall Loss: 10.195503
Rec Loss: 10.136476
KL Loss: 0.059028
Y Loss: 0.032378
T Loss: 10.120286
Epoch 1549 
Overall Loss: 10.163699
Rec Loss: 10.131608
KL Loss: 0.032090
Y Loss: 0.029191
T Loss: 10.117013
Epoch 1599 
Overall Loss: 10.164191
Rec Loss: 10.134877
KL Loss: 0.029314
Y Loss: 0.029371
T Loss: 10.120192
Epoch 1649 
Overall Loss: 10.161182
Rec Loss: 10.130819
KL Loss: 0.030364
Y Loss: 0.031271
T Loss: 10.115183
Epoch 1699 
Overall Loss: 10.148641
Rec Loss: 10.121431
KL Loss: 0.027210
Y Loss: 0.027702
T Loss: 10.107580
Epoch 1749 
Overall Loss: 10.147947
Rec Loss: 10.120833
KL Loss: 0.027114
Y Loss: 0.027646
T Loss: 10.107010
Epoch 1799 
Overall Loss: 10.151478
Rec Loss: 10.118350
KL Loss: 0.033128
Y Loss: 0.027667
T Loss: 10.104516
Epoch 1849 
Overall Loss: 10.160118
Rec Loss: 10.124208
KL Loss: 0.035911
Y Loss: 0.035259
T Loss: 10.106578
Epoch 1899 
Overall Loss: 10.164981
Rec Loss: 10.121043
KL Loss: 0.043939
Y Loss: 0.028764
T Loss: 10.106660
Epoch 1949 
Overall Loss: 10.159629
Rec Loss: 10.123566
KL Loss: 0.036063
Y Loss: 0.042621
T Loss: 10.102255
Epoch 1999 
Overall Loss: 10.145743
Rec Loss: 10.114098
KL Loss: 0.031645
Y Loss: 0.029589
T Loss: 10.099303
Epoch 2049 
Overall Loss: 10.143460
Rec Loss: 10.113493
KL Loss: 0.029966
Y Loss: 0.032522
T Loss: 10.097233
Epoch 2099 
Overall Loss: 10.144622
Rec Loss: 10.112721
KL Loss: 0.031901
Y Loss: 0.027543
T Loss: 10.098950
Epoch 2149 
Overall Loss: 10.141226
Rec Loss: 10.111167
KL Loss: 0.030059
Y Loss: 0.034602
T Loss: 10.093866
Epoch 2199 
Overall Loss: 10.136946
Rec Loss: 10.110542
KL Loss: 0.026405
Y Loss: 0.029186
T Loss: 10.095949
Epoch 2249 
Overall Loss: 10.130192
Rec Loss: 10.105286
KL Loss: 0.024906
Y Loss: 0.024652
T Loss: 10.092960
Epoch 2299 
Overall Loss: 10.130053
Rec Loss: 10.102109
KL Loss: 0.027943
Y Loss: 0.025353
T Loss: 10.089433
Epoch 2349 
Overall Loss: 10.134326
Rec Loss: 10.103968
KL Loss: 0.030357
Y Loss: 0.025398
T Loss: 10.091269
Epoch 2399 
Overall Loss: 10.127248
Rec Loss: 10.101509
KL Loss: 0.025739
Y Loss: 0.026990
T Loss: 10.088014
Epoch 2449 
Overall Loss: 10.139382
Rec Loss: 10.102643
KL Loss: 0.036740
Y Loss: 0.029217
T Loss: 10.088034
Epoch 2499 
Overall Loss: 10.129542
Rec Loss: 10.103374
KL Loss: 0.026168
Y Loss: 0.025199
T Loss: 10.090774
Epoch 2549 
Overall Loss: 10.129274
Rec Loss: 10.101057
KL Loss: 0.028217
Y Loss: 0.025693
T Loss: 10.088210
Epoch 2599 
Overall Loss: 10.133835
Rec Loss: 10.099583
KL Loss: 0.034253
Y Loss: 0.024762
T Loss: 10.087201
Epoch 2649 
Overall Loss: 10.122913
Rec Loss: 10.098023
KL Loss: 0.024890
Y Loss: 0.027015
T Loss: 10.084516
Epoch 2699 
Overall Loss: 10.129573
Rec Loss: 10.094487
KL Loss: 0.035086
Y Loss: 0.023686
T Loss: 10.082645
Epoch 2749 
Overall Loss: 10.116055
Rec Loss: 10.090478
KL Loss: 0.025577
Y Loss: 0.024350
T Loss: 10.078303
Epoch 2799 
Overall Loss: 10.117711
Rec Loss: 10.089474
KL Loss: 0.028237
Y Loss: 0.024038
T Loss: 10.077455
Epoch 2849 
Overall Loss: 10.119745
Rec Loss: 10.094026
KL Loss: 0.025720
Y Loss: 0.024949
T Loss: 10.081551
Epoch 2899 
Overall Loss: 10.158718
Rec Loss: 10.094903
KL Loss: 0.063815
Y Loss: 0.028162
T Loss: 10.080823
Epoch 2949 
Overall Loss: 10.110054
Rec Loss: 10.086995
KL Loss: 0.023059
Y Loss: 0.027445
T Loss: 10.073273
Epoch 2999 
Overall Loss: 10.116173
Rec Loss: 10.089286
KL Loss: 0.026887
Y Loss: 0.022231
T Loss: 10.078171
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.022619
Epoch 99
Rec Loss: 0.016752
Epoch 149
Rec Loss: 0.015638
Epoch 199
Rec Loss: 0.015133
Epoch 249
Rec Loss: 0.014818
Epoch 299
Rec Loss: 0.014585
Epoch 349
Rec Loss: 0.014598
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.072212
Epoch 99
Rec Loss: 10.067903
Epoch 149
Rec Loss: 10.040920
Epoch 199
Rec Loss: 10.027086
Epoch 249
Rec Loss: 10.006775
Epoch 299
Rec Loss: 9.980052
Epoch 349
Rec Loss: 9.966786
Epoch 399
Rec Loss: 9.949708
Epoch 449
Rec Loss: 9.965304
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.093004
Insample Error: 0.435729
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 19.455908
Rec Loss: 15.724006
KL Loss: 3.731902
Y Loss: 8.400502
T Loss: 13.287396
X Loss: -1.763641
Epoch 99 
Overall Loss: 1.922245
Rec Loss: -7.868104
KL Loss: 9.790349
Y Loss: 2.746925
T Loss: 13.071382
X Loss: -22.312948
Epoch 149 
Overall Loss: -4.502866
Rec Loss: -14.821419
KL Loss: 10.318554
Y Loss: 2.043967
T Loss: 13.033313
X Loss: -28.876716
Epoch 199 
Overall Loss: -8.277721
Rec Loss: -19.411342
KL Loss: 11.133621
Y Loss: 1.316401
T Loss: 12.952035
X Loss: -33.021578
Epoch 249 
Overall Loss: -10.313558
Rec Loss: -22.062019
KL Loss: 11.748461
Y Loss: 0.829641
T Loss: 12.837373
X Loss: -35.314212
Epoch 299 
Overall Loss: -11.853117
Rec Loss: -24.125069
KL Loss: 12.271953
Y Loss: 0.605862
T Loss: 12.688312
X Loss: -37.116311
Epoch 349 
Overall Loss: -12.935760
Rec Loss: -25.526336
KL Loss: 12.590575
Y Loss: 0.500008
T Loss: 12.585399
X Loss: -38.361739
Epoch 399 
Overall Loss: -13.688198
Rec Loss: -26.607198
KL Loss: 12.919000
Y Loss: 0.449520
T Loss: 12.461550
X Loss: -39.293507
Epoch 449 
Overall Loss: -14.489166
Rec Loss: -27.584266
KL Loss: 13.095101
Y Loss: 0.399921
T Loss: 12.383470
X Loss: -40.167697
Epoch 499 
Overall Loss: -14.929732
Rec Loss: -28.219894
KL Loss: 13.290162
Y Loss: 0.382761
T Loss: 12.304758
X Loss: -40.716032
Epoch 549 
Overall Loss: -15.560559
Rec Loss: -29.023236
KL Loss: 13.462677
Y Loss: 0.369048
T Loss: 12.248974
X Loss: -41.456733
Epoch 599 
Overall Loss: -16.153718
Rec Loss: -29.931303
KL Loss: 13.777585
Y Loss: 0.337575
T Loss: 12.168535
X Loss: -42.268626
Epoch 649 
Overall Loss: -16.382064
Rec Loss: -30.237213
KL Loss: 13.855148
Y Loss: 0.321076
T Loss: 12.131358
X Loss: -42.529107
Epoch 699 
Overall Loss: -16.871159
Rec Loss: -30.878738
KL Loss: 14.007579
Y Loss: 0.315158
T Loss: 12.079780
X Loss: -43.116096
Epoch 749 
Overall Loss: -17.308398
Rec Loss: -31.436577
KL Loss: 14.128180
Y Loss: 0.297422
T Loss: 12.025616
X Loss: -43.610904
Epoch 799 
Overall Loss: -17.701611
Rec Loss: -32.037424
KL Loss: 14.335812
Y Loss: 0.285973
T Loss: 11.982862
X Loss: -44.163272
Epoch 849 
Overall Loss: -18.103839
Rec Loss: -32.549465
KL Loss: 14.445625
Y Loss: 0.285355
T Loss: 11.955177
X Loss: -44.647320
Epoch 899 
Overall Loss: -18.449666
Rec Loss: -32.999300
KL Loss: 14.549634
Y Loss: 0.271030
T Loss: 11.917297
X Loss: -45.052113
Epoch 949 
Overall Loss: -18.584682
Rec Loss: -33.202119
KL Loss: 14.617437
Y Loss: 0.266935
T Loss: 11.883304
X Loss: -45.218890
Epoch 999 
Overall Loss: -19.003407
Rec Loss: -33.628767
KL Loss: 14.625360
Y Loss: 0.275996
T Loss: 11.851301
X Loss: -45.618065
Epoch 1049 
Overall Loss: -19.093403
Rec Loss: -33.882061
KL Loss: 14.788659
Y Loss: 0.264484
T Loss: 11.816181
X Loss: -45.830486
Epoch 1099 
Overall Loss: -19.571492
Rec Loss: -34.407773
KL Loss: 14.836281
Y Loss: 0.277813
T Loss: 11.781883
X Loss: -46.328564
Epoch 1149 
Overall Loss: -19.768845
Rec Loss: -34.750342
KL Loss: 14.981498
Y Loss: 0.244496
T Loss: 11.743395
X Loss: -46.615986
Epoch 1199 
Overall Loss: -19.786879
Rec Loss: -34.823751
KL Loss: 15.036872
Y Loss: 0.245879
T Loss: 11.717613
X Loss: -46.664304
Epoch 1249 
Overall Loss: -20.169954
Rec Loss: -35.252707
KL Loss: 15.082753
Y Loss: 0.253514
T Loss: 11.692215
X Loss: -47.071678
Epoch 1299 
Overall Loss: -19.859580
Rec Loss: -34.851073
KL Loss: 14.991493
Y Loss: 0.254601
T Loss: 11.676655
X Loss: -46.655029
Epoch 1349 
Overall Loss: -20.553918
Rec Loss: -35.748451
KL Loss: 15.194532
Y Loss: 0.256663
T Loss: 11.639600
X Loss: -47.516383
Epoch 1399 
Overall Loss: -20.575476
Rec Loss: -35.735182
KL Loss: 15.159706
Y Loss: 0.262617
T Loss: 11.624803
X Loss: -47.491293
Epoch 1449 
Overall Loss: -20.639325
Rec Loss: -36.038219
KL Loss: 15.398894
Y Loss: 0.252949
T Loss: 11.586116
X Loss: -47.750810
Epoch 1499 
Overall Loss: -21.020801
Rec Loss: -36.533731
KL Loss: 15.512930
Y Loss: 0.240763
T Loss: 11.570452
X Loss: -48.224565
Epoch 1549 
Overall Loss: -21.311455
Rec Loss: -36.580673
KL Loss: 15.269218
Y Loss: 0.270908
T Loss: 11.571237
X Loss: -48.287363
Epoch 1599 
Overall Loss: -21.329499
Rec Loss: -36.913690
KL Loss: 15.584191
Y Loss: 0.242539
T Loss: 11.540442
X Loss: -48.575401
Epoch 1649 
Overall Loss: -21.714180
Rec Loss: -37.354100
KL Loss: 15.639921
Y Loss: 0.243753
T Loss: 11.508666
X Loss: -48.984643
Epoch 1699 
Overall Loss: -21.896137
Rec Loss: -37.594471
KL Loss: 15.698333
Y Loss: 0.248524
T Loss: 11.514980
X Loss: -49.233712
Epoch 1749 
Overall Loss: -21.013109
Rec Loss: -36.733502
KL Loss: 15.720394
Y Loss: 0.235294
T Loss: 11.491261
X Loss: -48.342410
Epoch 1799 
Overall Loss: -21.704614
Rec Loss: -37.508463
KL Loss: 15.803850
Y Loss: 0.229484
T Loss: 11.468261
X Loss: -49.091468
Epoch 1849 
Overall Loss: -22.370830
Rec Loss: -38.192439
KL Loss: 15.821609
Y Loss: 0.232992
T Loss: 11.459685
X Loss: -49.768619
Epoch 1899 
Overall Loss: -22.339319
Rec Loss: -38.309450
KL Loss: 15.970131
Y Loss: 0.227845
T Loss: 11.443858
X Loss: -49.867230
Epoch 1949 
Overall Loss: -21.161733
Rec Loss: -36.949859
KL Loss: 15.788127
Y Loss: 0.255897
T Loss: 11.440496
X Loss: -48.518303
Epoch 1999 
Overall Loss: -22.442473
Rec Loss: -38.202887
KL Loss: 15.760414
Y Loss: 0.246694
T Loss: 11.439201
X Loss: -49.765435
Epoch 2049 
Overall Loss: -22.788942
Rec Loss: -38.594993
KL Loss: 15.806052
Y Loss: 0.252419
T Loss: 11.430129
X Loss: -50.151333
Epoch 2099 
Overall Loss: -21.956566
Rec Loss: -37.976280
KL Loss: 16.019714
Y Loss: 0.239588
T Loss: 11.403731
X Loss: -49.499804
Epoch 2149 
Overall Loss: -22.837251
Rec Loss: -38.956583
KL Loss: 16.119332
Y Loss: 0.236512
T Loss: 11.387216
X Loss: -50.462054
Epoch 2199 
Overall Loss: -22.985846
Rec Loss: -39.113584
KL Loss: 16.127737
Y Loss: 0.235091
T Loss: 11.387330
X Loss: -50.618460
Epoch 2249 
Overall Loss: -22.983089
Rec Loss: -39.003132
KL Loss: 16.020043
Y Loss: 0.236344
T Loss: 11.371358
X Loss: -50.492664
Epoch 2299 
Overall Loss: -23.176244
Rec Loss: -39.449477
KL Loss: 16.273234
Y Loss: 0.226631
T Loss: 11.355637
X Loss: -50.918431
Epoch 2349 
Overall Loss: -23.580319
Rec Loss: -39.748780
KL Loss: 16.168461
Y Loss: 0.239087
T Loss: 11.350756
X Loss: -51.219080
Epoch 2399 
Overall Loss: -22.887165
Rec Loss: -39.182094
KL Loss: 16.294929
Y Loss: 0.236928
T Loss: 11.337940
X Loss: -50.638497
Epoch 2449 
Overall Loss: -23.526310
Rec Loss: -39.714057
KL Loss: 16.187749
Y Loss: 0.240344
T Loss: 11.330781
X Loss: -51.165011
Epoch 2499 
Overall Loss: -23.035294
Rec Loss: -39.394983
KL Loss: 16.359689
Y Loss: 0.222326
T Loss: 11.311978
X Loss: -50.818123
Epoch 2549 
Overall Loss: -23.286166
Rec Loss: -39.559152
KL Loss: 16.272986
Y Loss: 0.228382
T Loss: 11.319467
X Loss: -50.992810
Epoch 2599 
Overall Loss: -23.764654
Rec Loss: -39.969285
KL Loss: 16.204631
Y Loss: 0.237570
T Loss: 11.323407
X Loss: -51.411478
Epoch 2649 
Overall Loss: -23.998596
Rec Loss: -40.445137
KL Loss: 16.446542
Y Loss: 0.222563
T Loss: 11.292640
X Loss: -51.849059
Epoch 2699 
Overall Loss: -24.051504
Rec Loss: -40.629504
KL Loss: 16.578000
Y Loss: 0.216790
T Loss: 11.281637
X Loss: -52.019536
Epoch 2749 
Overall Loss: -23.327499
Rec Loss: -39.868779
KL Loss: 16.541281
Y Loss: 0.220355
T Loss: 11.257157
X Loss: -51.236113
Epoch 2799 
Overall Loss: -23.397025
Rec Loss: -39.909220
KL Loss: 16.512196
Y Loss: 0.216637
T Loss: 11.264142
X Loss: -51.281682
Epoch 2849 
Overall Loss: -24.329789
Rec Loss: -40.714757
KL Loss: 16.384967
Y Loss: 0.222579
T Loss: 11.264005
X Loss: -52.090051
Epoch 2899 
Overall Loss: -24.097563
Rec Loss: -40.719078
KL Loss: 16.621515
Y Loss: 0.214764
T Loss: 11.249003
X Loss: -52.075461
Epoch 2949 
Overall Loss: -23.801638
Rec Loss: -40.411688
KL Loss: 16.610050
Y Loss: 0.219310
T Loss: 11.232747
X Loss: -51.754090
Epoch 2999 
Overall Loss: -23.770191
Rec Loss: -40.239355
KL Loss: 16.469164
Y Loss: 0.226131
T Loss: 11.241219
X Loss: -51.593641
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.162615
Epoch 99
Rec Loss: 2.113204
Epoch 149
Rec Loss: 2.089461
Epoch 199
Rec Loss: 2.081346
Epoch 249
Rec Loss: 2.085315
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.004652
Epoch 99
Rec Loss: 0.002596
Epoch 149
Rec Loss: 0.001854
Epoch 199
Rec Loss: 0.002104
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.221799
Insample Error 2.951373
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.447879
Epoch 99 
Prediction Loss: 0.171373
Epoch 149 
Prediction Loss: 0.099601
Epoch 199 
Prediction Loss: 0.065771
Epoch 249 
Prediction Loss: 0.049278
Epoch 299 
Prediction Loss: 0.040850
Epoch 349 
Prediction Loss: 0.033620
Epoch 399 
Prediction Loss: 0.030173
Epoch 449 
Prediction Loss: 0.024399
Epoch 499 
Prediction Loss: 0.021174
Epoch 549 
Prediction Loss: 0.020052
Epoch 599 
Prediction Loss: 0.018055
Epoch 649 
Prediction Loss: 0.014534
Epoch 699 
Prediction Loss: 0.015983
Epoch 749 
Prediction Loss: 0.012984
Epoch 799 
Prediction Loss: 0.011058
Epoch 849 
Prediction Loss: 0.010135
Epoch 899 
Prediction Loss: 0.012140
Epoch 949 
Prediction Loss: 0.011415
Epoch 999 
Prediction Loss: 0.012499
Epoch 1049 
Prediction Loss: 0.009249
Epoch 1099 
Prediction Loss: 0.008851
Epoch 1149 
Prediction Loss: 0.009351
Epoch 1199 
Prediction Loss: 0.009085
Epoch 1249 
Prediction Loss: 0.007213
Epoch 1299 
Prediction Loss: 0.008023
Epoch 1349 
Prediction Loss: 0.006946
Epoch 1399 
Prediction Loss: 0.006736
Epoch 1449 
Prediction Loss: 0.011366
Epoch 1499 
Prediction Loss: 0.008283
Epoch 1549 
Prediction Loss: 0.007957
Epoch 1599 
Prediction Loss: 0.008266
Epoch 1649 
Prediction Loss: 0.006556
Epoch 1699 
Prediction Loss: 0.006133
Epoch 1749 
Prediction Loss: 0.006419
Epoch 1799 
Prediction Loss: 0.006117
Epoch 1849 
Prediction Loss: 0.006391
Epoch 1899 
Prediction Loss: 0.005463
Epoch 1949 
Prediction Loss: 0.008841
Epoch 1999 
Prediction Loss: 0.007401
Epoch 2049 
Prediction Loss: 0.004882
Epoch 2099 
Prediction Loss: 0.005371
Epoch 2149 
Prediction Loss: 0.005088
Epoch 2199 
Prediction Loss: 0.005190
Epoch 2249 
Prediction Loss: 0.004787
Epoch 2299 
Prediction Loss: 0.005569
Epoch 2349 
Prediction Loss: 0.005526
Epoch 2399 
Prediction Loss: 0.005441
Epoch 2449 
Prediction Loss: 0.007250
Epoch 2499 
Prediction Loss: 0.006112
Epoch 2549 
Prediction Loss: 0.005008
Epoch 2599 
Prediction Loss: 0.004267
Epoch 2649 
Prediction Loss: 0.006179
Epoch 2699 
Prediction Loss: 0.004748
Epoch 2749 
Prediction Loss: 0.004720
Epoch 2799 
Prediction Loss: 0.004716
Epoch 2849 
Prediction Loss: 0.007341
Epoch 2899 
Prediction Loss: 0.014634
Epoch 2949 
Prediction Loss: 0.005077
Epoch 2999 
Prediction Loss: 0.004522
Epoch 3049 
Prediction Loss: 0.003619
Epoch 3099 
Prediction Loss: 0.005961
Epoch 3149 
Prediction Loss: 0.006722
Epoch 3199 
Prediction Loss: 0.005657
Epoch 3249 
Prediction Loss: 0.003659
Epoch 3299 
Prediction Loss: 0.003854
Epoch 3349 
Prediction Loss: 0.004860
Epoch 3399 
Prediction Loss: 0.005786
Epoch 3449 
Prediction Loss: 0.003923
Epoch 3499 
Prediction Loss: 0.006846
Epoch 3549 
Prediction Loss: 0.005430
Epoch 3599 
Prediction Loss: 0.003806
Epoch 3649 
Prediction Loss: 0.003827
Epoch 3699 
Prediction Loss: 0.004210
Epoch 3749 
Prediction Loss: 0.003462
Epoch 3799 
Prediction Loss: 0.003834
Epoch 3849 
Prediction Loss: 0.005237
Epoch 3899 
Prediction Loss: 0.006824
Epoch 3949 
Prediction Loss: 0.005409
Epoch 3999 
Prediction Loss: 0.006338
Epoch 4049 
Prediction Loss: 0.004595
Epoch 4099 
Prediction Loss: 0.004148
Epoch 4149 
Prediction Loss: 0.003302
Epoch 4199 
Prediction Loss: 0.003511
Epoch 4249 
Prediction Loss: 0.005294
Epoch 4299 
Prediction Loss: 0.003730
Epoch 4349 
Prediction Loss: 0.004498
Epoch 4399 
Prediction Loss: 0.003900
Epoch 4449 
Prediction Loss: 0.005171
Epoch 4499 
Prediction Loss: 0.006324
Epoch 4549 
Prediction Loss: 0.004442
Epoch 4599 
Prediction Loss: 0.003088
Epoch 4649 
Prediction Loss: 0.003811
Epoch 4699 
Prediction Loss: 0.003283
Epoch 4749 
Prediction Loss: 0.005242
Epoch 4799 
Prediction Loss: 0.005442
Epoch 4849 
Prediction Loss: 0.003353
Epoch 4899 
Prediction Loss: 0.003332
Epoch 4949 
Prediction Loss: 0.003908
Epoch 4999 
Prediction Loss: 0.003183
Epoch 5049 
Prediction Loss: 0.003547
Epoch 5099 
Prediction Loss: 0.006010
Epoch 5149 
Prediction Loss: 0.003635
Epoch 5199 
Prediction Loss: 0.003885
Epoch 5249 
Prediction Loss: 0.007601
Epoch 5299 
Prediction Loss: 0.004278
Epoch 5349 
Prediction Loss: 0.002986
Epoch 5399 
Prediction Loss: 0.009513
Epoch 5449 
Prediction Loss: 0.003461
Epoch 5499 
Prediction Loss: 0.002585
Epoch 5549 
Prediction Loss: 0.005207
Epoch 5599 
Prediction Loss: 0.003609
Epoch 5649 
Prediction Loss: 0.002792
Epoch 5699 
Prediction Loss: 0.005951
Epoch 5749 
Prediction Loss: 0.003121
Epoch 5799 
Prediction Loss: 0.002570
Epoch 5849 
Prediction Loss: 0.003129
Epoch 5899 
Prediction Loss: 0.003100
Epoch 5949 
Prediction Loss: 0.003229
Epoch 5999 
Prediction Loss: 0.003345
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.066607
Insample Error 0.235585
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.743143
Rec Loss: 10.443281
KL Loss: 0.299861
Y Loss: 0.655718
T Loss: 10.115422
Epoch 99 
Overall Loss: 10.524169
Rec Loss: 10.374096
KL Loss: 0.150073
Y Loss: 0.415000
T Loss: 10.166596
Epoch 149 
Overall Loss: 10.401408
Rec Loss: 10.290910
KL Loss: 0.110499
Y Loss: 0.235525
T Loss: 10.173147
Epoch 199 
Overall Loss: 10.363874
Rec Loss: 10.258236
KL Loss: 0.105638
Y Loss: 0.176102
T Loss: 10.170185
Epoch 249 
Overall Loss: 10.318469
Rec Loss: 10.233131
KL Loss: 0.085338
Y Loss: 0.128648
T Loss: 10.168808
Epoch 299 
Overall Loss: 10.315252
Rec Loss: 10.233933
KL Loss: 0.081319
Y Loss: 0.113182
T Loss: 10.177341
Epoch 349 
Overall Loss: 10.296999
Rec Loss: 10.209477
KL Loss: 0.087522
Y Loss: 0.101812
T Loss: 10.158571
Epoch 399 
Overall Loss: 10.278537
Rec Loss: 10.207604
KL Loss: 0.070933
Y Loss: 0.086828
T Loss: 10.164190
Epoch 449 
Overall Loss: 10.267148
Rec Loss: 10.204575
KL Loss: 0.062573
Y Loss: 0.077230
T Loss: 10.165960
Epoch 499 
Overall Loss: 10.259186
Rec Loss: 10.199452
KL Loss: 0.059734
Y Loss: 0.072054
T Loss: 10.163425
Epoch 549 
Overall Loss: 10.256818
Rec Loss: 10.193934
KL Loss: 0.062884
Y Loss: 0.068691
T Loss: 10.159589
Epoch 599 
Overall Loss: 10.255290
Rec Loss: 10.189822
KL Loss: 0.065467
Y Loss: 0.068668
T Loss: 10.155488
Epoch 649 
Overall Loss: 10.243418
Rec Loss: 10.185643
KL Loss: 0.057774
Y Loss: 0.064564
T Loss: 10.153361
Epoch 699 
Overall Loss: 10.239411
Rec Loss: 10.180151
KL Loss: 0.059260
Y Loss: 0.056050
T Loss: 10.152126
Epoch 749 
Overall Loss: 10.222486
Rec Loss: 10.176301
KL Loss: 0.046186
Y Loss: 0.055147
T Loss: 10.148727
Epoch 799 
Overall Loss: 10.225344
Rec Loss: 10.177424
KL Loss: 0.047920
Y Loss: 0.053508
T Loss: 10.150670
Epoch 849 
Overall Loss: 10.227850
Rec Loss: 10.178827
KL Loss: 0.049023
Y Loss: 0.061749
T Loss: 10.147952
Epoch 899 
Overall Loss: 10.218238
Rec Loss: 10.169602
KL Loss: 0.048635
Y Loss: 0.050644
T Loss: 10.144281
Epoch 949 
Overall Loss: 10.226289
Rec Loss: 10.166846
KL Loss: 0.059443
Y Loss: 0.071136
T Loss: 10.131278
Epoch 999 
Overall Loss: 10.212374
Rec Loss: 10.166596
KL Loss: 0.045778
Y Loss: 0.049198
T Loss: 10.141997
Epoch 1049 
Overall Loss: 10.200437
Rec Loss: 10.161590
KL Loss: 0.038847
Y Loss: 0.044649
T Loss: 10.139265
Epoch 1099 
Overall Loss: 10.210668
Rec Loss: 10.159678
KL Loss: 0.050989
Y Loss: 0.043600
T Loss: 10.137878
Epoch 1149 
Overall Loss: 10.194422
Rec Loss: 10.154396
KL Loss: 0.040026
Y Loss: 0.042442
T Loss: 10.133175
Epoch 1199 
Overall Loss: 10.199663
Rec Loss: 10.159471
KL Loss: 0.040192
Y Loss: 0.048916
T Loss: 10.135013
Epoch 1249 
Overall Loss: 10.195767
Rec Loss: 10.154463
KL Loss: 0.041304
Y Loss: 0.045308
T Loss: 10.131809
Epoch 1299 
Overall Loss: 10.189343
Rec Loss: 10.150545
KL Loss: 0.038797
Y Loss: 0.040942
T Loss: 10.130074
Epoch 1349 
Overall Loss: 10.195228
Rec Loss: 10.151513
KL Loss: 0.043715
Y Loss: 0.039050
T Loss: 10.131988
Epoch 1399 
Overall Loss: 10.191804
Rec Loss: 10.148615
KL Loss: 0.043189
Y Loss: 0.044049
T Loss: 10.126590
Epoch 1449 
Overall Loss: 10.178173
Rec Loss: 10.139935
KL Loss: 0.038237
Y Loss: 0.041975
T Loss: 10.118947
Epoch 1499 
Overall Loss: 10.227002
Rec Loss: 10.153791
KL Loss: 0.073211
Y Loss: 0.057135
T Loss: 10.125224
Epoch 1549 
Overall Loss: 10.177267
Rec Loss: 10.142074
KL Loss: 0.035193
Y Loss: 0.039857
T Loss: 10.122146
Epoch 1599 
Overall Loss: 10.171154
Rec Loss: 10.136819
KL Loss: 0.034335
Y Loss: 0.037101
T Loss: 10.118268
Epoch 1649 
Overall Loss: 10.177848
Rec Loss: 10.135603
KL Loss: 0.042245
Y Loss: 0.036650
T Loss: 10.117278
Epoch 1699 
Overall Loss: 10.171108
Rec Loss: 10.135587
KL Loss: 0.035520
Y Loss: 0.037161
T Loss: 10.117007
Epoch 1749 
Overall Loss: 10.171311
Rec Loss: 10.131897
KL Loss: 0.039413
Y Loss: 0.037561
T Loss: 10.113117
Epoch 1799 
Overall Loss: 10.171795
Rec Loss: 10.130121
KL Loss: 0.041673
Y Loss: 0.035546
T Loss: 10.112348
Epoch 1849 
Overall Loss: 10.162788
Rec Loss: 10.123303
KL Loss: 0.039485
Y Loss: 0.035672
T Loss: 10.105466
Epoch 1899 
Overall Loss: 10.164921
Rec Loss: 10.127362
KL Loss: 0.037559
Y Loss: 0.032924
T Loss: 10.110900
Epoch 1949 
Overall Loss: 10.188804
Rec Loss: 10.122343
KL Loss: 0.066461
Y Loss: 0.039257
T Loss: 10.102714
Epoch 1999 
Overall Loss: 10.150243
Rec Loss: 10.117826
KL Loss: 0.032417
Y Loss: 0.031829
T Loss: 10.101911
Epoch 2049 
Overall Loss: 10.155839
Rec Loss: 10.117751
KL Loss: 0.038087
Y Loss: 0.035601
T Loss: 10.099950
Epoch 2099 
Overall Loss: 10.155152
Rec Loss: 10.121241
KL Loss: 0.033911
Y Loss: 0.035042
T Loss: 10.103720
Epoch 2149 
Overall Loss: 10.142332
Rec Loss: 10.112290
KL Loss: 0.030042
Y Loss: 0.031548
T Loss: 10.096515
Epoch 2199 
Overall Loss: 10.152646
Rec Loss: 10.115080
KL Loss: 0.037566
Y Loss: 0.045373
T Loss: 10.092393
Epoch 2249 
Overall Loss: 10.145529
Rec Loss: 10.115006
KL Loss: 0.030523
Y Loss: 0.033230
T Loss: 10.098391
Epoch 2299 
Overall Loss: 10.195768
Rec Loss: 10.116849
KL Loss: 0.078919
Y Loss: 0.041147
T Loss: 10.096276
Epoch 2349 
Overall Loss: 10.144458
Rec Loss: 10.106365
KL Loss: 0.038093
Y Loss: 0.031447
T Loss: 10.090641
Epoch 2399 
Overall Loss: 10.158809
Rec Loss: 10.118214
KL Loss: 0.040595
Y Loss: 0.041783
T Loss: 10.097322
Epoch 2449 
Overall Loss: 10.136399
Rec Loss: 10.105795
KL Loss: 0.030604
Y Loss: 0.030911
T Loss: 10.090340
Epoch 2499 
Overall Loss: 10.135430
Rec Loss: 10.108507
KL Loss: 0.026923
Y Loss: 0.032429
T Loss: 10.092292
Epoch 2549 
Overall Loss: 10.132734
Rec Loss: 10.103170
KL Loss: 0.029565
Y Loss: 0.030017
T Loss: 10.088162
Epoch 2599 
Overall Loss: 10.132902
Rec Loss: 10.101327
KL Loss: 0.031574
Y Loss: 0.029620
T Loss: 10.086517
Epoch 2649 
Overall Loss: 10.124473
Rec Loss: 10.099013
KL Loss: 0.025460
Y Loss: 0.030607
T Loss: 10.083710
Epoch 2699 
Overall Loss: 10.123181
Rec Loss: 10.098121
KL Loss: 0.025060
Y Loss: 0.028484
T Loss: 10.083879
Epoch 2749 
Overall Loss: 10.123546
Rec Loss: 10.098520
KL Loss: 0.025027
Y Loss: 0.029917
T Loss: 10.083561
Epoch 2799 
Overall Loss: 10.124158
Rec Loss: 10.097248
KL Loss: 0.026910
Y Loss: 0.026935
T Loss: 10.083781
Epoch 2849 
Overall Loss: 10.137074
Rec Loss: 10.102883
KL Loss: 0.034192
Y Loss: 0.046907
T Loss: 10.079429
Epoch 2899 
Overall Loss: 10.118195
Rec Loss: 10.090188
KL Loss: 0.028007
Y Loss: 0.028537
T Loss: 10.075920
Epoch 2949 
Overall Loss: 10.116404
Rec Loss: 10.089432
KL Loss: 0.026972
Y Loss: 0.028080
T Loss: 10.075393
Epoch 2999 
Overall Loss: 10.119985
Rec Loss: 10.092241
KL Loss: 0.027743
Y Loss: 0.029560
T Loss: 10.077462
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.022516
Epoch 99
Rec Loss: 0.018731
Epoch 149
Rec Loss: 0.017963
Epoch 199
Rec Loss: 0.016958
Epoch 249
Rec Loss: 0.016902
Epoch 299
Rec Loss: 0.016452
Epoch 349
Rec Loss: 0.016386
Epoch 399
Rec Loss: 0.016465
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.083232
Epoch 99
Rec Loss: 10.069027
Epoch 149
Rec Loss: 10.052572
Epoch 199
Rec Loss: 10.033180
Epoch 249
Rec Loss: 10.019574
Epoch 299
Rec Loss: 10.034924
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.096463
Insample Error: 0.439272
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 19.665429
Rec Loss: 16.098334
KL Loss: 3.567094
Y Loss: 7.245217
T Loss: 13.217241
X Loss: -0.741515
Epoch 99 
Overall Loss: 0.834436
Rec Loss: -8.325817
KL Loss: 9.160252
Y Loss: 2.402325
T Loss: 13.058892
X Loss: -22.585871
Epoch 149 
Overall Loss: -4.387997
Rec Loss: -14.610345
KL Loss: 10.222348
Y Loss: 1.756900
T Loss: 13.036114
X Loss: -28.524909
Epoch 199 
Overall Loss: -8.769401
Rec Loss: -20.407816
KL Loss: 11.638415
Y Loss: 1.157411
T Loss: 13.010085
X Loss: -33.996606
Epoch 249 
Overall Loss: -11.479638
Rec Loss: -24.136983
KL Loss: 12.657344
Y Loss: 0.717684
T Loss: 12.980419
X Loss: -37.476244
Epoch 299 
Overall Loss: -12.731492
Rec Loss: -25.863472
KL Loss: 13.131980
Y Loss: 0.492222
T Loss: 12.943158
X Loss: -39.052741
Epoch 349 
Overall Loss: -13.872652
Rec Loss: -27.403463
KL Loss: 13.530810
Y Loss: 0.372863
T Loss: 12.916316
X Loss: -40.506211
Epoch 399 
Overall Loss: -14.731462
Rec Loss: -28.378752
KL Loss: 13.647290
Y Loss: 0.328259
T Loss: 12.874497
X Loss: -41.417378
Epoch 449 
Overall Loss: -15.532767
Rec Loss: -29.440182
KL Loss: 13.907415
Y Loss: 0.295622
T Loss: 12.845107
X Loss: -42.433101
Epoch 499 
Overall Loss: -15.949198
Rec Loss: -30.122050
KL Loss: 14.172851
Y Loss: 0.287509
T Loss: 12.784074
X Loss: -43.049879
Epoch 549 
Overall Loss: -16.688526
Rec Loss: -30.930753
KL Loss: 14.242228
Y Loss: 0.282181
T Loss: 12.734094
X Loss: -43.805937
Epoch 599 
Overall Loss: -17.105337
Rec Loss: -31.575789
KL Loss: 14.470453
Y Loss: 0.275012
T Loss: 12.647505
X Loss: -44.360802
Epoch 649 
Overall Loss: -17.390447
Rec Loss: -32.003495
KL Loss: 14.613048
Y Loss: 0.274210
T Loss: 12.553455
X Loss: -44.694055
Epoch 699 
Overall Loss: -17.938211
Rec Loss: -32.809296
KL Loss: 14.871085
Y Loss: 0.264475
T Loss: 12.434126
X Loss: -45.375659
Epoch 749 
Overall Loss: -18.496139
Rec Loss: -33.472979
KL Loss: 14.976840
Y Loss: 0.272439
T Loss: 12.322571
X Loss: -45.931770
Epoch 799 
Overall Loss: -18.614570
Rec Loss: -33.649763
KL Loss: 15.035193
Y Loss: 0.273876
T Loss: 12.222708
X Loss: -46.009409
Epoch 849 
Overall Loss: -19.146120
Rec Loss: -34.404466
KL Loss: 15.258346
Y Loss: 0.249097
T Loss: 12.141974
X Loss: -46.670989
Epoch 899 
Overall Loss: -19.407052
Rec Loss: -34.659226
KL Loss: 15.252174
Y Loss: 0.272053
T Loss: 12.074675
X Loss: -46.869929
Epoch 949 
Overall Loss: -19.784690
Rec Loss: -35.264046
KL Loss: 15.479356
Y Loss: 0.267158
T Loss: 12.014606
X Loss: -47.412231
Epoch 999 
Overall Loss: -19.881730
Rec Loss: -35.474852
KL Loss: 15.593122
Y Loss: 0.255130
T Loss: 11.971166
X Loss: -47.573583
Epoch 1049 
Overall Loss: -20.270614
Rec Loss: -36.017168
KL Loss: 15.746553
Y Loss: 0.249832
T Loss: 11.941708
X Loss: -48.083791
Epoch 1099 
Overall Loss: -20.352691
Rec Loss: -36.035675
KL Loss: 15.682984
Y Loss: 0.256889
T Loss: 11.910340
X Loss: -48.074460
Epoch 1149 
Overall Loss: -20.760945
Rec Loss: -36.592986
KL Loss: 15.832041
Y Loss: 0.259221
T Loss: 11.878245
X Loss: -48.600840
Epoch 1199 
Overall Loss: -20.852431
Rec Loss: -36.798368
KL Loss: 15.945936
Y Loss: 0.244286
T Loss: 11.844423
X Loss: -48.764934
Epoch 1249 
Overall Loss: -21.140435
Rec Loss: -37.118509
KL Loss: 15.978074
Y Loss: 0.247495
T Loss: 11.840279
X Loss: -49.082536
Epoch 1299 
Overall Loss: -21.383393
Rec Loss: -37.445787
KL Loss: 16.062394
Y Loss: 0.245470
T Loss: 11.788606
X Loss: -49.357130
Epoch 1349 
Overall Loss: -21.414390
Rec Loss: -37.526676
KL Loss: 16.112286
Y Loss: 0.242094
T Loss: 11.778740
X Loss: -49.426463
Epoch 1399 
Overall Loss: -21.799180
Rec Loss: -37.962098
KL Loss: 16.162918
Y Loss: 0.251889
T Loss: 11.762408
X Loss: -49.850450
Epoch 1449 
Overall Loss: -21.681277
Rec Loss: -37.703418
KL Loss: 16.022141
Y Loss: 0.268165
T Loss: 11.752930
X Loss: -49.590430
Epoch 1499 
Overall Loss: -22.145395
Rec Loss: -38.382158
KL Loss: 16.236762
Y Loss: 0.253477
T Loss: 11.717543
X Loss: -50.226439
Epoch 1549 
Overall Loss: -22.357082
Rec Loss: -38.717126
KL Loss: 16.360045
Y Loss: 0.250985
T Loss: 11.698660
X Loss: -50.541279
Epoch 1599 
Overall Loss: -21.960076
Rec Loss: -38.250679
KL Loss: 16.290604
Y Loss: 0.256360
T Loss: 11.688565
X Loss: -50.067424
Epoch 1649 
Overall Loss: -22.491415
Rec Loss: -38.999524
KL Loss: 16.508108
Y Loss: 0.251323
T Loss: 11.645807
X Loss: -50.770991
Epoch 1699 
Overall Loss: -22.571419
Rec Loss: -39.154708
KL Loss: 16.583288
Y Loss: 0.248262
T Loss: 11.625590
X Loss: -50.904428
Epoch 1749 
Overall Loss: -22.854780
Rec Loss: -39.356716
KL Loss: 16.501936
Y Loss: 0.248119
T Loss: 11.630611
X Loss: -51.111385
Epoch 1799 
Overall Loss: -23.086374
Rec Loss: -39.662833
KL Loss: 16.576459
Y Loss: 0.244816
T Loss: 11.607532
X Loss: -51.392773
Epoch 1849 
Overall Loss: -22.777196
Rec Loss: -39.499310
KL Loss: 16.722113
Y Loss: 0.242667
T Loss: 11.583685
X Loss: -51.204327
Epoch 1899 
Overall Loss: -23.259864
Rec Loss: -40.030536
KL Loss: 16.770672
Y Loss: 0.240917
T Loss: 11.556509
X Loss: -51.707504
Epoch 1949 
Overall Loss: -23.373856
Rec Loss: -39.917373
KL Loss: 16.543517
Y Loss: 0.264765
T Loss: 11.563636
X Loss: -51.613391
Epoch 1999 
Overall Loss: -23.214359
Rec Loss: -39.732429
KL Loss: 16.518068
Y Loss: 0.278155
T Loss: 11.563449
X Loss: -51.434954
Epoch 2049 
Overall Loss: -23.486837
Rec Loss: -40.335116
KL Loss: 16.848277
Y Loss: 0.245013
T Loss: 11.517535
X Loss: -51.975157
Epoch 2099 
Overall Loss: -23.388499
Rec Loss: -40.195476
KL Loss: 16.806976
Y Loss: 0.256276
T Loss: 11.506539
X Loss: -51.830152
Epoch 2149 
Overall Loss: -23.750692
Rec Loss: -40.715651
KL Loss: 16.964959
Y Loss: 0.245918
T Loss: 11.482007
X Loss: -52.320617
Epoch 2199 
Overall Loss: -23.533478
Rec Loss: -40.420497
KL Loss: 16.887019
Y Loss: 0.260330
T Loss: 11.482759
X Loss: -52.033421
Epoch 2249 
Overall Loss: -23.834513
Rec Loss: -40.801571
KL Loss: 16.967057
Y Loss: 0.256135
T Loss: 11.474391
X Loss: -52.404029
Epoch 2299 
Overall Loss: -23.629182
Rec Loss: -40.358788
KL Loss: 16.729605
Y Loss: 0.270079
T Loss: 11.472108
X Loss: -51.965933
Epoch 2349 
Overall Loss: -24.253213
Rec Loss: -41.309057
KL Loss: 17.055844
Y Loss: 0.245681
T Loss: 11.455861
X Loss: -52.887759
Epoch 2399 
Overall Loss: -24.307624
Rec Loss: -41.364235
KL Loss: 17.056612
Y Loss: 0.243537
T Loss: 11.437222
X Loss: -52.923227
Epoch 2449 
Overall Loss: -23.914621
Rec Loss: -40.740662
KL Loss: 16.826039
Y Loss: 0.273062
T Loss: 11.458004
X Loss: -52.335195
Epoch 2499 
Overall Loss: -24.504567
Rec Loss: -41.547702
KL Loss: 17.043134
Y Loss: 0.252374
T Loss: 11.417463
X Loss: -53.091351
Epoch 2549 
Overall Loss: -24.669192
Rec Loss: -41.850509
KL Loss: 17.181316
Y Loss: 0.244992
T Loss: 11.407974
X Loss: -53.380979
Epoch 2599 
Overall Loss: -24.563540
Rec Loss: -41.750268
KL Loss: 17.186727
Y Loss: 0.248330
T Loss: 11.410355
X Loss: -53.284787
Epoch 2649 
Overall Loss: -24.715919
Rec Loss: -41.956541
KL Loss: 17.240622
Y Loss: 0.243956
T Loss: 11.397382
X Loss: -53.475901
Epoch 2699 
Overall Loss: -24.283093
Rec Loss: -41.479503
KL Loss: 17.196409
Y Loss: 0.247536
T Loss: 11.394720
X Loss: -52.997991
Epoch 2749 
Overall Loss: -25.004672
Rec Loss: -42.232478
KL Loss: 17.227807
Y Loss: 0.257519
T Loss: 11.378373
X Loss: -53.739610
Epoch 2799 
Overall Loss: -24.614941
Rec Loss: -41.533674
KL Loss: 16.918732
Y Loss: 0.285378
T Loss: 11.395399
X Loss: -53.071762
Epoch 2849 
Overall Loss: -24.927275
Rec Loss: -42.263184
KL Loss: 17.335910
Y Loss: 0.243458
T Loss: 11.375015
X Loss: -53.759929
Epoch 2899 
Overall Loss: -24.343169
Rec Loss: -41.720322
KL Loss: 17.377153
Y Loss: 0.241908
T Loss: 11.374414
X Loss: -53.215690
Epoch 2949 
Overall Loss: -25.014693
Rec Loss: -42.311177
KL Loss: 17.296484
Y Loss: 0.251437
T Loss: 11.355319
X Loss: -53.792215
Epoch 2999 
Overall Loss: -25.278014
Rec Loss: -42.340507
KL Loss: 17.062493
Y Loss: 0.280884
T Loss: 11.377241
X Loss: -53.858190
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.330240
Epoch 99
Rec Loss: 2.290571
Epoch 149
Rec Loss: 2.286614
Epoch 199
Rec Loss: 2.277267
Epoch 249
Rec Loss: 2.297085
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.002443
Epoch 99
Rec Loss: 0.001412
Epoch 149
Rec Loss: 0.001408
Epoch 199
Rec Loss: 0.001036
Epoch 249
Rec Loss: 0.001237
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.234622
Insample Error 3.335138
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.532681
Epoch 99 
Prediction Loss: 0.188664
Epoch 149 
Prediction Loss: 0.100490
Epoch 199 
Prediction Loss: 0.061738
Epoch 249 
Prediction Loss: 0.046714
Epoch 299 
Prediction Loss: 0.034855
Epoch 349 
Prediction Loss: 0.028471
Epoch 399 
Prediction Loss: 0.026660
Epoch 449 
Prediction Loss: 0.019131
Epoch 499 
Prediction Loss: 0.017341
Epoch 549 
Prediction Loss: 0.015318
Epoch 599 
Prediction Loss: 0.010438
Epoch 649 
Prediction Loss: 0.009782
Epoch 699 
Prediction Loss: 0.008603
Epoch 749 
Prediction Loss: 0.009539
Epoch 799 
Prediction Loss: 0.007937
Epoch 849 
Prediction Loss: 0.006544
Epoch 899 
Prediction Loss: 0.005805
Epoch 949 
Prediction Loss: 0.005630
Epoch 999 
Prediction Loss: 0.005784
Epoch 1049 
Prediction Loss: 0.005240
Epoch 1099 
Prediction Loss: 0.005528
Epoch 1149 
Prediction Loss: 0.004800
Epoch 1199 
Prediction Loss: 0.004905
Epoch 1249 
Prediction Loss: 0.004661
Epoch 1299 
Prediction Loss: 0.003716
Epoch 1349 
Prediction Loss: 0.004482
Epoch 1399 
Prediction Loss: 0.004196
Epoch 1449 
Prediction Loss: 0.003498
Epoch 1499 
Prediction Loss: 0.003457
Epoch 1549 
Prediction Loss: 0.003811
Epoch 1599 
Prediction Loss: 0.003731
Epoch 1649 
Prediction Loss: 0.003504
Epoch 1699 
Prediction Loss: 0.003748
Epoch 1749 
Prediction Loss: 0.003397
Epoch 1799 
Prediction Loss: 0.003210
Epoch 1849 
Prediction Loss: 0.003349
Epoch 1899 
Prediction Loss: 0.002663
Epoch 1949 
Prediction Loss: 0.002877
Epoch 1999 
Prediction Loss: 0.002495
Epoch 2049 
Prediction Loss: 0.003160
Epoch 2099 
Prediction Loss: 0.003350
Epoch 2149 
Prediction Loss: 0.002617
Epoch 2199 
Prediction Loss: 0.002477
Epoch 2249 
Prediction Loss: 0.003100
Epoch 2299 
Prediction Loss: 0.002331
Epoch 2349 
Prediction Loss: 0.003074
Epoch 2399 
Prediction Loss: 0.003106
Epoch 2449 
Prediction Loss: 0.002446
Epoch 2499 
Prediction Loss: 0.002300
Epoch 2549 
Prediction Loss: 0.002656
Epoch 2599 
Prediction Loss: 0.003803
Epoch 2649 
Prediction Loss: 0.002218
Epoch 2699 
Prediction Loss: 0.003105
Epoch 2749 
Prediction Loss: 0.003664
Epoch 2799 
Prediction Loss: 0.001862
Epoch 2849 
Prediction Loss: 0.003212
Epoch 2899 
Prediction Loss: 0.001838
Epoch 2949 
Prediction Loss: 0.001997
Epoch 2999 
Prediction Loss: 0.001916
Epoch 3049 
Prediction Loss: 0.002162
Epoch 3099 
Prediction Loss: 0.002315
Epoch 3149 
Prediction Loss: 0.002731
Epoch 3199 
Prediction Loss: 0.004452
Epoch 3249 
Prediction Loss: 0.003936
Epoch 3299 
Prediction Loss: 0.002002
Epoch 3349 
Prediction Loss: 0.002112
Epoch 3399 
Prediction Loss: 0.001671
Epoch 3449 
Prediction Loss: 0.003265
Epoch 3499 
Prediction Loss: 0.002124
Epoch 3549 
Prediction Loss: 0.004074
Epoch 3599 
Prediction Loss: 0.002111
Epoch 3649 
Prediction Loss: 0.001669
Epoch 3699 
Prediction Loss: 0.001911
Epoch 3749 
Prediction Loss: 0.001749
Epoch 3799 
Prediction Loss: 0.006452
Epoch 3849 
Prediction Loss: 0.001420
Epoch 3899 
Prediction Loss: 0.002259
Epoch 3949 
Prediction Loss: 0.003001
Epoch 3999 
Prediction Loss: 0.001693
Epoch 4049 
Prediction Loss: 0.001305
Epoch 4099 
Prediction Loss: 0.001850
Epoch 4149 
Prediction Loss: 0.001645
Epoch 4199 
Prediction Loss: 0.003368
Epoch 4249 
Prediction Loss: 0.003588
Epoch 4299 
Prediction Loss: 0.001708
Epoch 4349 
Prediction Loss: 0.002749
Epoch 4399 
Prediction Loss: 0.002061
Epoch 4449 
Prediction Loss: 0.002281
Epoch 4499 
Prediction Loss: 0.002583
Epoch 4549 
Prediction Loss: 0.003180
Epoch 4599 
Prediction Loss: 0.001952
Epoch 4649 
Prediction Loss: 0.003306
Epoch 4699 
Prediction Loss: 0.003210
Epoch 4749 
Prediction Loss: 0.001811
Epoch 4799 
Prediction Loss: 0.002407
Epoch 4849 
Prediction Loss: 0.001265
Epoch 4899 
Prediction Loss: 0.003265
Epoch 4949 
Prediction Loss: 0.001523
Epoch 4999 
Prediction Loss: 0.003354
Epoch 5049 
Prediction Loss: 0.001496
Epoch 5099 
Prediction Loss: 0.001394
Epoch 5149 
Prediction Loss: 0.001194
Epoch 5199 
Prediction Loss: 0.001215
Epoch 5249 
Prediction Loss: 0.001080
Epoch 5299 
Prediction Loss: 0.003176
Epoch 5349 
Prediction Loss: 0.001112
Epoch 5399 
Prediction Loss: 0.001856
Epoch 5449 
Prediction Loss: 0.001312
Epoch 5499 
Prediction Loss: 0.001884
Epoch 5549 
Prediction Loss: 0.002535
Epoch 5599 
Prediction Loss: 0.001472
Epoch 5649 
Prediction Loss: 0.001131
Epoch 5699 
Prediction Loss: 0.003952
Epoch 5749 
Prediction Loss: 0.001350
Epoch 5799 
Prediction Loss: 0.001467
Epoch 5849 
Prediction Loss: 0.001284
Epoch 5899 
Prediction Loss: 0.001830
Epoch 5949 
Prediction Loss: 0.001316
Epoch 5999 
Prediction Loss: 0.001648
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.042194
Insample Error 0.216532
[31m========== repeat time 4 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.732933
Rec Loss: 10.441413
KL Loss: 0.291520
Y Loss: 0.654954
T Loss: 10.113936
Epoch 99 
Overall Loss: 10.453186
Rec Loss: 10.318149
KL Loss: 0.135037
Y Loss: 0.281698
T Loss: 10.177300
Epoch 149 
Overall Loss: 10.357932
Rec Loss: 10.253655
KL Loss: 0.104277
Y Loss: 0.156655
T Loss: 10.175327
Epoch 199 
Overall Loss: 10.332577
Rec Loss: 10.237645
KL Loss: 0.094932
Y Loss: 0.119523
T Loss: 10.177883
Epoch 249 
Overall Loss: 10.307559
Rec Loss: 10.227531
KL Loss: 0.080028
Y Loss: 0.101223
T Loss: 10.176919
Epoch 299 
Overall Loss: 10.303499
Rec Loss: 10.222091
KL Loss: 0.081409
Y Loss: 0.086749
T Loss: 10.178716
Epoch 349 
Overall Loss: 10.284734
Rec Loss: 10.212044
KL Loss: 0.072690
Y Loss: 0.071043
T Loss: 10.176523
Epoch 399 
Overall Loss: 10.275960
Rec Loss: 10.210069
KL Loss: 0.065890
Y Loss: 0.067858
T Loss: 10.176140
Epoch 449 
Overall Loss: 10.260078
Rec Loss: 10.197548
KL Loss: 0.062530
Y Loss: 0.061193
T Loss: 10.166952
Epoch 499 
Overall Loss: 10.273261
Rec Loss: 10.197290
KL Loss: 0.075971
Y Loss: 0.060878
T Loss: 10.166851
Epoch 549 
Overall Loss: 10.250597
Rec Loss: 10.193428
KL Loss: 0.057169
Y Loss: 0.051983
T Loss: 10.167437
Epoch 599 
Overall Loss: 10.244795
Rec Loss: 10.183094
KL Loss: 0.061701
Y Loss: 0.050546
T Loss: 10.157821
Epoch 649 
Overall Loss: 10.233036
Rec Loss: 10.181708
KL Loss: 0.051327
Y Loss: 0.045690
T Loss: 10.158864
Epoch 699 
Overall Loss: 10.233583
Rec Loss: 10.177290
KL Loss: 0.056293
Y Loss: 0.052468
T Loss: 10.151056
Epoch 749 
Overall Loss: 10.236719
Rec Loss: 10.179088
KL Loss: 0.057631
Y Loss: 0.055184
T Loss: 10.151495
Epoch 799 
Overall Loss: 10.222879
Rec Loss: 10.177725
KL Loss: 0.045154
Y Loss: 0.040533
T Loss: 10.157458
Epoch 849 
Overall Loss: 10.230179
Rec Loss: 10.178049
KL Loss: 0.052131
Y Loss: 0.043201
T Loss: 10.156449
Epoch 899 
Overall Loss: 10.208798
Rec Loss: 10.164766
KL Loss: 0.044031
Y Loss: 0.038691
T Loss: 10.145421
Epoch 949 
Overall Loss: 10.238661
Rec Loss: 10.174256
KL Loss: 0.064405
Y Loss: 0.043178
T Loss: 10.152667
Epoch 999 
Overall Loss: 10.199774
Rec Loss: 10.157384
KL Loss: 0.042391
Y Loss: 0.038322
T Loss: 10.138222
Epoch 1049 
Overall Loss: 10.195609
Rec Loss: 10.154009
KL Loss: 0.041600
Y Loss: 0.042533
T Loss: 10.132742
Epoch 1099 
Overall Loss: 10.199476
Rec Loss: 10.151934
KL Loss: 0.047541
Y Loss: 0.039414
T Loss: 10.132227
Epoch 1149 
Overall Loss: 10.196758
Rec Loss: 10.156925
KL Loss: 0.039832
Y Loss: 0.034948
T Loss: 10.139451
Epoch 1199 
Overall Loss: 10.192863
Rec Loss: 10.155036
KL Loss: 0.037828
Y Loss: 0.033672
T Loss: 10.138200
Epoch 1249 
Overall Loss: 10.184757
Rec Loss: 10.149415
KL Loss: 0.035342
Y Loss: 0.033407
T Loss: 10.132712
Epoch 1299 
Overall Loss: 10.187538
Rec Loss: 10.151579
KL Loss: 0.035959
Y Loss: 0.035748
T Loss: 10.133705
Epoch 1349 
Overall Loss: 10.183722
Rec Loss: 10.147972
KL Loss: 0.035749
Y Loss: 0.030867
T Loss: 10.132539
Epoch 1399 
Overall Loss: 10.197031
Rec Loss: 10.141849
KL Loss: 0.055182
Y Loss: 0.032280
T Loss: 10.125709
Epoch 1449 
Overall Loss: 10.171616
Rec Loss: 10.138404
KL Loss: 0.033211
Y Loss: 0.028858
T Loss: 10.123976
Epoch 1499 
Overall Loss: 10.171088
Rec Loss: 10.139194
KL Loss: 0.031895
Y Loss: 0.033762
T Loss: 10.122313
Epoch 1549 
Overall Loss: 10.168934
Rec Loss: 10.136928
KL Loss: 0.032007
Y Loss: 0.029491
T Loss: 10.122182
Epoch 1599 
Overall Loss: 10.168841
Rec Loss: 10.136974
KL Loss: 0.031866
Y Loss: 0.029609
T Loss: 10.122170
Epoch 1649 
Overall Loss: 10.181044
Rec Loss: 10.136145
KL Loss: 0.044899
Y Loss: 0.029526
T Loss: 10.121382
Epoch 1699 
Overall Loss: 10.161815
Rec Loss: 10.130153
KL Loss: 0.031662
Y Loss: 0.028123
T Loss: 10.116091
Epoch 1749 
Overall Loss: 10.159041
Rec Loss: 10.130784
KL Loss: 0.028257
Y Loss: 0.026103
T Loss: 10.117732
Epoch 1799 
Overall Loss: 10.162353
Rec Loss: 10.129808
KL Loss: 0.032545
Y Loss: 0.030073
T Loss: 10.114772
Epoch 1849 
Overall Loss: 10.169261
Rec Loss: 10.128142
KL Loss: 0.041119
Y Loss: 0.029669
T Loss: 10.113307
Epoch 1899 
Overall Loss: 10.234981
Rec Loss: 10.143221
KL Loss: 0.091761
Y Loss: 0.052934
T Loss: 10.116754
Epoch 1949 
Overall Loss: 10.155298
Rec Loss: 10.127011
KL Loss: 0.028287
Y Loss: 0.024877
T Loss: 10.114572
Epoch 1999 
Overall Loss: 10.163664
Rec Loss: 10.127805
KL Loss: 0.035859
Y Loss: 0.027055
T Loss: 10.114277
Epoch 2049 
Overall Loss: 10.146375
Rec Loss: 10.117753
KL Loss: 0.028622
Y Loss: 0.025615
T Loss: 10.104945
Epoch 2099 
Overall Loss: 10.148741
Rec Loss: 10.118750
KL Loss: 0.029991
Y Loss: 0.027245
T Loss: 10.105127
Epoch 2149 
Overall Loss: 10.170891
Rec Loss: 10.122865
KL Loss: 0.048026
Y Loss: 0.028738
T Loss: 10.108496
Epoch 2199 
Overall Loss: 10.146983
Rec Loss: 10.115651
KL Loss: 0.031332
Y Loss: 0.024969
T Loss: 10.103167
Epoch 2249 
Overall Loss: 10.151392
Rec Loss: 10.115508
KL Loss: 0.035884
Y Loss: 0.024816
T Loss: 10.103100
Epoch 2299 
Overall Loss: 10.166751
Rec Loss: 10.119521
KL Loss: 0.047231
Y Loss: 0.026104
T Loss: 10.106469
Epoch 2349 
Overall Loss: 10.134882
Rec Loss: 10.109621
KL Loss: 0.025261
Y Loss: 0.021786
T Loss: 10.098728
Epoch 2399 
Overall Loss: 10.140590
Rec Loss: 10.113369
KL Loss: 0.027222
Y Loss: 0.027180
T Loss: 10.099779
Epoch 2449 
Overall Loss: 10.132555
Rec Loss: 10.108347
KL Loss: 0.024207
Y Loss: 0.023887
T Loss: 10.096404
Epoch 2499 
Overall Loss: 10.139862
Rec Loss: 10.110332
KL Loss: 0.029529
Y Loss: 0.022799
T Loss: 10.098933
Epoch 2549 
Overall Loss: 10.149776
Rec Loss: 10.117327
KL Loss: 0.032449
Y Loss: 0.035451
T Loss: 10.099601
Epoch 2599 
Overall Loss: 10.133787
Rec Loss: 10.108960
KL Loss: 0.024827
Y Loss: 0.023776
T Loss: 10.097072
Epoch 2649 
Overall Loss: 10.130155
Rec Loss: 10.104822
KL Loss: 0.025333
Y Loss: 0.021712
T Loss: 10.093966
Epoch 2699 
Overall Loss: 10.128736
Rec Loss: 10.103201
KL Loss: 0.025535
Y Loss: 0.023784
T Loss: 10.091309
Epoch 2749 
Overall Loss: 10.127074
Rec Loss: 10.104235
KL Loss: 0.022838
Y Loss: 0.023353
T Loss: 10.092559
Epoch 2799 
Overall Loss: 10.126225
Rec Loss: 10.101136
KL Loss: 0.025089
Y Loss: 0.025634
T Loss: 10.088319
Epoch 2849 
Overall Loss: 10.119043
Rec Loss: 10.096881
KL Loss: 0.022162
Y Loss: 0.021225
T Loss: 10.086268
Epoch 2899 
Overall Loss: 10.124140
Rec Loss: 10.100454
KL Loss: 0.023686
Y Loss: 0.021946
T Loss: 10.089481
Epoch 2949 
Overall Loss: 10.122708
Rec Loss: 10.099537
KL Loss: 0.023170
Y Loss: 0.021695
T Loss: 10.088689
Epoch 2999 
Overall Loss: 10.119333
Rec Loss: 10.096030
KL Loss: 0.023303
Y Loss: 0.021175
T Loss: 10.085443
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.021098
Epoch 99
Rec Loss: 0.017768
Epoch 149
Rec Loss: 0.016163
Epoch 199
Rec Loss: 0.015595
Epoch 249
Rec Loss: 0.015332
Epoch 299
Rec Loss: 0.015194
Epoch 349
Rec Loss: 0.015030
Epoch 399
Rec Loss: 0.014880
Epoch 449
Rec Loss: 0.014704
Epoch 499
Rec Loss: 0.014819
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.091136
Epoch 99
Rec Loss: 10.084973
Epoch 149
Rec Loss: 10.060170
Epoch 199
Rec Loss: 10.033024
Epoch 249
Rec Loss: 10.013176
Epoch 299
Rec Loss: 10.003221
Epoch 349
Rec Loss: 9.984579
Epoch 399
Rec Loss: 9.966287
Epoch 449
Rec Loss: 9.963479
Epoch 499
Rec Loss: 9.929309
Epoch 549
Rec Loss: 9.940290
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.086327
Insample Error: 0.395980
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.195396
Rec Loss: 17.945497
KL Loss: 3.249899
Y Loss: 9.537032
T Loss: 13.250788
X Loss: -0.073807
Epoch 99 
Overall Loss: 3.269314
Rec Loss: -7.229130
KL Loss: 10.498444
Y Loss: 3.816752
T Loss: 13.022697
X Loss: -22.160203
Epoch 149 
Overall Loss: -3.620669
Rec Loss: -13.947455
KL Loss: 10.326787
Y Loss: 3.193384
T Loss: 13.052521
X Loss: -28.596668
Epoch 199 
Overall Loss: -7.234884
Rec Loss: -18.345610
KL Loss: 11.110726
Y Loss: 2.516214
T Loss: 13.040941
X Loss: -32.644658
Epoch 249 
Overall Loss: -9.584298
Rec Loss: -21.377555
KL Loss: 11.793257
Y Loss: 1.983028
T Loss: 13.023813
X Loss: -35.392881
Epoch 299 
Overall Loss: -11.120226
Rec Loss: -23.427500
KL Loss: 12.307273
Y Loss: 1.593423
T Loss: 12.996871
X Loss: -37.221081
Epoch 349 
Overall Loss: -12.070079
Rec Loss: -24.694700
KL Loss: 12.624621
Y Loss: 1.458336
T Loss: 12.978837
X Loss: -38.402705
Epoch 399 
Overall Loss: -12.966332
Rec Loss: -25.821953
KL Loss: 12.855621
Y Loss: 1.372181
T Loss: 12.937995
X Loss: -39.446037
Epoch 449 
Overall Loss: -13.873863
Rec Loss: -26.871104
KL Loss: 12.997241
Y Loss: 1.285237
T Loss: 12.909708
X Loss: -40.423431
Epoch 499 
Overall Loss: -14.353087
Rec Loss: -27.530757
KL Loss: 13.177670
Y Loss: 1.150791
T Loss: 12.874807
X Loss: -40.980960
Epoch 549 
Overall Loss: -14.892913
Rec Loss: -28.163282
KL Loss: 13.270370
Y Loss: 1.103006
T Loss: 12.835037
X Loss: -41.549822
Epoch 599 
Overall Loss: -15.706830
Rec Loss: -29.098214
KL Loss: 13.391385
Y Loss: 1.003902
T Loss: 12.804206
X Loss: -42.404371
Epoch 649 
Overall Loss: -16.215712
Rec Loss: -29.728827
KL Loss: 13.513115
Y Loss: 0.915653
T Loss: 12.771203
X Loss: -42.957857
Epoch 699 
Overall Loss: -16.613169
Rec Loss: -30.234352
KL Loss: 13.621183
Y Loss: 0.869973
T Loss: 12.737797
X Loss: -43.407136
Epoch 749 
Overall Loss: -17.147710
Rec Loss: -30.887169
KL Loss: 13.739459
Y Loss: 0.836886
T Loss: 12.693282
X Loss: -43.998894
Epoch 799 
Overall Loss: -17.683416
Rec Loss: -31.521143
KL Loss: 13.837727
Y Loss: 0.807713
T Loss: 12.626075
X Loss: -44.551074
Epoch 849 
Overall Loss: -17.890812
Rec Loss: -31.908483
KL Loss: 14.017671
Y Loss: 0.807424
T Loss: 12.567495
X Loss: -44.879690
Epoch 899 
Overall Loss: -18.435479
Rec Loss: -32.514034
KL Loss: 14.078556
Y Loss: 0.780363
T Loss: 12.485962
X Loss: -45.390179
Epoch 949 
Overall Loss: -18.765249
Rec Loss: -32.951207
KL Loss: 14.185957
Y Loss: 0.773034
T Loss: 12.420982
X Loss: -45.758705
Epoch 999 
Overall Loss: -19.097488
Rec Loss: -33.394560
KL Loss: 14.297073
Y Loss: 0.762669
T Loss: 12.333064
X Loss: -46.108959
Epoch 1049 
Overall Loss: -19.048474
Rec Loss: -33.494618
KL Loss: 14.446145
Y Loss: 0.730319
T Loss: 12.238270
X Loss: -46.098049
Epoch 1099 
Overall Loss: -19.669846
Rec Loss: -34.229581
KL Loss: 14.559735
Y Loss: 0.701812
T Loss: 12.156487
X Loss: -46.736974
Epoch 1149 
Overall Loss: -20.076982
Rec Loss: -34.654698
KL Loss: 14.577716
Y Loss: 0.712253
T Loss: 12.092710
X Loss: -47.103536
Epoch 1199 
Overall Loss: -20.161812
Rec Loss: -34.860127
KL Loss: 14.698315
Y Loss: 0.701354
T Loss: 12.019985
X Loss: -47.230788
Epoch 1249 
Overall Loss: -20.308620
Rec Loss: -35.120710
KL Loss: 14.812090
Y Loss: 0.705240
T Loss: 11.954451
X Loss: -47.427780
Epoch 1299 
Overall Loss: -20.878718
Rec Loss: -35.744586
KL Loss: 14.865868
Y Loss: 0.681585
T Loss: 11.923419
X Loss: -48.008797
Epoch 1349 
Overall Loss: -20.646134
Rec Loss: -35.490356
KL Loss: 14.844222
Y Loss: 0.664645
T Loss: 11.880839
X Loss: -47.703516
Epoch 1399 
Overall Loss: -21.235432
Rec Loss: -36.193743
KL Loss: 14.958310
Y Loss: 0.658785
T Loss: 11.833230
X Loss: -48.356365
Epoch 1449 
Overall Loss: -21.468753
Rec Loss: -36.486342
KL Loss: 15.017590
Y Loss: 0.628525
T Loss: 11.788964
X Loss: -48.589569
Epoch 1499 
Overall Loss: -21.722870
Rec Loss: -36.817978
KL Loss: 15.095107
Y Loss: 0.631231
T Loss: 11.774058
X Loss: -48.907650
Epoch 1549 
Overall Loss: -21.867383
Rec Loss: -37.062705
KL Loss: 15.195323
Y Loss: 0.612914
T Loss: 11.732347
X Loss: -49.101509
Epoch 1599 
Overall Loss: -22.029181
Rec Loss: -37.154226
KL Loss: 15.125044
Y Loss: 0.630908
T Loss: 11.711060
X Loss: -49.180740
Epoch 1649 
Overall Loss: -22.266176
Rec Loss: -37.387289
KL Loss: 15.121114
Y Loss: 0.620654
T Loss: 11.686375
X Loss: -49.383992
Epoch 1699 
Overall Loss: -22.501771
Rec Loss: -37.675551
KL Loss: 15.173780
Y Loss: 0.601285
T Loss: 11.665501
X Loss: -49.641695
Epoch 1749 
Overall Loss: -22.727545
Rec Loss: -38.011165
KL Loss: 15.283621
Y Loss: 0.580044
T Loss: 11.643276
X Loss: -49.944464
Epoch 1799 
Overall Loss: -22.894644
Rec Loss: -38.040965
KL Loss: 15.146321
Y Loss: 0.598079
T Loss: 11.638820
X Loss: -49.978826
Epoch 1849 
Overall Loss: -22.912585
Rec Loss: -38.251463
KL Loss: 15.338878
Y Loss: 0.571800
T Loss: 11.598575
X Loss: -50.135937
Epoch 1899 
Overall Loss: -23.049697
Rec Loss: -38.435021
KL Loss: 15.385324
Y Loss: 0.593569
T Loss: 11.591599
X Loss: -50.323404
Epoch 1949 
Overall Loss: -23.276244
Rec Loss: -38.826600
KL Loss: 15.550356
Y Loss: 0.546486
T Loss: 11.580783
X Loss: -50.680626
Epoch 1999 
Overall Loss: -23.242550
Rec Loss: -38.692898
KL Loss: 15.450349
Y Loss: 0.562606
T Loss: 11.569377
X Loss: -50.543578
Epoch 2049 
Overall Loss: -23.750952
Rec Loss: -39.240914
KL Loss: 15.489963
Y Loss: 0.543591
T Loss: 11.553345
X Loss: -51.066055
Epoch 2099 
Overall Loss: -23.836093
Rec Loss: -39.315448
KL Loss: 15.479356
Y Loss: 0.542276
T Loss: 11.525052
X Loss: -51.111638
Epoch 2149 
Overall Loss: -23.832844
Rec Loss: -39.299873
KL Loss: 15.467028
Y Loss: 0.569155
T Loss: 11.526623
X Loss: -51.111073
Epoch 2199 
Overall Loss: -23.943244
Rec Loss: -39.407681
KL Loss: 15.464437
Y Loss: 0.555391
T Loss: 11.511690
X Loss: -51.197066
Epoch 2249 
Overall Loss: -23.687362
Rec Loss: -39.376452
KL Loss: 15.689090
Y Loss: 0.518819
T Loss: 11.489933
X Loss: -51.125796
Epoch 2299 
Overall Loss: -24.184122
Rec Loss: -39.824661
KL Loss: 15.640539
Y Loss: 0.535355
T Loss: 11.482466
X Loss: -51.574804
Epoch 2349 
Overall Loss: -23.592424
Rec Loss: -39.173355
KL Loss: 15.580931
Y Loss: 0.519336
T Loss: 11.470824
X Loss: -50.903847
Epoch 2399 
Overall Loss: -24.650334
Rec Loss: -40.291722
KL Loss: 15.641388
Y Loss: 0.528108
T Loss: 11.453975
X Loss: -52.009750
Epoch 2449 
Overall Loss: -24.492808
Rec Loss: -40.204011
KL Loss: 15.711203
Y Loss: 0.516735
T Loss: 11.458064
X Loss: -51.920442
Epoch 2499 
Overall Loss: -24.266743
Rec Loss: -39.784740
KL Loss: 15.517998
Y Loss: 0.527920
T Loss: 11.464597
X Loss: -51.513297
Epoch 2549 
Overall Loss: -24.714047
Rec Loss: -40.428853
KL Loss: 15.714805
Y Loss: 0.506446
T Loss: 11.440659
X Loss: -52.122735
Epoch 2599 
Overall Loss: -24.882293
Rec Loss: -40.686822
KL Loss: 15.804529
Y Loss: 0.491404
T Loss: 11.425327
X Loss: -52.357851
Epoch 2649 
Overall Loss: -24.909735
Rec Loss: -40.556155
KL Loss: 15.646419
Y Loss: 0.497783
T Loss: 11.424633
X Loss: -52.229679
Epoch 2699 
Overall Loss: -25.337089
Rec Loss: -41.109072
KL Loss: 15.771983
Y Loss: 0.494403
T Loss: 11.410829
X Loss: -52.767102
Epoch 2749 
Overall Loss: -25.098383
Rec Loss: -40.942500
KL Loss: 15.844117
Y Loss: 0.491493
T Loss: 11.402641
X Loss: -52.590888
Epoch 2799 
Overall Loss: -25.438632
Rec Loss: -41.231589
KL Loss: 15.792957
Y Loss: 0.454435
T Loss: 11.401427
X Loss: -52.860235
Epoch 2849 
Overall Loss: -25.307318
Rec Loss: -40.709554
KL Loss: 15.402236
Y Loss: 0.494731
T Loss: 11.412047
X Loss: -52.368967
Epoch 2899 
Overall Loss: -25.478950
Rec Loss: -41.108183
KL Loss: 15.629234
Y Loss: 0.461275
T Loss: 11.388748
X Loss: -52.727569
Epoch 2949 
Overall Loss: -25.309723
Rec Loss: -41.024322
KL Loss: 15.714599
Y Loss: 0.478805
T Loss: 11.382781
X Loss: -52.646506
Epoch 2999 
Overall Loss: -25.650833
Rec Loss: -41.555632
KL Loss: 15.904799
Y Loss: 0.467211
T Loss: 11.367632
X Loss: -53.156871
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.219076
Epoch 99
Rec Loss: 2.188845
Epoch 149
Rec Loss: 2.176566
Epoch 199
Rec Loss: 2.147322
Epoch 249
Rec Loss: 2.152648
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.003015
Epoch 99
Rec Loss: 0.001605
Epoch 149
Rec Loss: 0.001125
Epoch 199
Rec Loss: 0.000878
Epoch 249
Rec Loss: 0.000806
Epoch 299
Rec Loss: 0.000926
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.368710
Insample Error 2.906231
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.531741
Epoch 99 
Prediction Loss: 0.222628
Epoch 149 
Prediction Loss: 0.159911
Epoch 199 
Prediction Loss: 0.121137
Epoch 249 
Prediction Loss: 0.083486
Epoch 299 
Prediction Loss: 0.062178
Epoch 349 
Prediction Loss: 0.044175
Epoch 399 
Prediction Loss: 0.032787
Epoch 449 
Prediction Loss: 0.026356
Epoch 499 
Prediction Loss: 0.019996
Epoch 549 
Prediction Loss: 0.016789
Epoch 599 
Prediction Loss: 0.013457
Epoch 649 
Prediction Loss: 0.011670
Epoch 699 
Prediction Loss: 0.010699
Epoch 749 
Prediction Loss: 0.009934
Epoch 799 
Prediction Loss: 0.008156
Epoch 849 
Prediction Loss: 0.007292
Epoch 899 
Prediction Loss: 0.007337
Epoch 949 
Prediction Loss: 0.006510
Epoch 999 
Prediction Loss: 0.008608
Epoch 1049 
Prediction Loss: 0.005585
Epoch 1099 
Prediction Loss: 0.005522
Epoch 1149 
Prediction Loss: 0.005249
Epoch 1199 
Prediction Loss: 0.004800
Epoch 1249 
Prediction Loss: 0.005523
Epoch 1299 
Prediction Loss: 0.005441
Epoch 1349 
Prediction Loss: 0.003514
Epoch 1399 
Prediction Loss: 0.005574
Epoch 1449 
Prediction Loss: 0.004811
Epoch 1499 
Prediction Loss: 0.003623
Epoch 1549 
Prediction Loss: 0.004148
Epoch 1599 
Prediction Loss: 0.004593
Epoch 1649 
Prediction Loss: 0.003276
Epoch 1699 
Prediction Loss: 0.004473
Epoch 1749 
Prediction Loss: 0.002734
Epoch 1799 
Prediction Loss: 0.003783
Epoch 1849 
Prediction Loss: 0.003142
Epoch 1899 
Prediction Loss: 0.003244
Epoch 1949 
Prediction Loss: 0.003262
Epoch 1999 
Prediction Loss: 0.002360
Epoch 2049 
Prediction Loss: 0.002805
Epoch 2099 
Prediction Loss: 0.002537
Epoch 2149 
Prediction Loss: 0.003710
Epoch 2199 
Prediction Loss: 0.002402
Epoch 2249 
Prediction Loss: 0.003400
Epoch 2299 
Prediction Loss: 0.002070
Epoch 2349 
Prediction Loss: 0.003455
Epoch 2399 
Prediction Loss: 0.002755
Epoch 2449 
Prediction Loss: 0.002521
Epoch 2499 
Prediction Loss: 0.002267
Epoch 2549 
Prediction Loss: 0.001981
Epoch 2599 
Prediction Loss: 0.002268
Epoch 2649 
Prediction Loss: 0.002024
Epoch 2699 
Prediction Loss: 0.002548
Epoch 2749 
Prediction Loss: 0.005991
Epoch 2799 
Prediction Loss: 0.001951
Epoch 2849 
Prediction Loss: 0.001925
Epoch 2899 
Prediction Loss: 0.001949
Epoch 2949 
Prediction Loss: 0.002375
Epoch 2999 
Prediction Loss: 0.002692
Epoch 3049 
Prediction Loss: 0.002692
Epoch 3099 
Prediction Loss: 0.001956
Epoch 3149 
Prediction Loss: 0.001591
Epoch 3199 
Prediction Loss: 0.001765
Epoch 3249 
Prediction Loss: 0.002015
Epoch 3299 
Prediction Loss: 0.003383
Epoch 3349 
Prediction Loss: 0.001852
Epoch 3399 
Prediction Loss: 0.007822
Epoch 3449 
Prediction Loss: 0.001947
Epoch 3499 
Prediction Loss: 0.001492
Epoch 3549 
Prediction Loss: 0.004043
Epoch 3599 
Prediction Loss: 0.004443
Epoch 3649 
Prediction Loss: 0.005183
Epoch 3699 
Prediction Loss: 0.001411
Epoch 3749 
Prediction Loss: 0.002311
Epoch 3799 
Prediction Loss: 0.001394
Epoch 3849 
Prediction Loss: 0.002325
Epoch 3899 
Prediction Loss: 0.001443
Epoch 3949 
Prediction Loss: 0.002606
Epoch 3999 
Prediction Loss: 0.002367
Epoch 4049 
Prediction Loss: 0.002382
Epoch 4099 
Prediction Loss: 0.001516
Epoch 4149 
Prediction Loss: 0.002246
Epoch 4199 
Prediction Loss: 0.002251
Epoch 4249 
Prediction Loss: 0.001743
Epoch 4299 
Prediction Loss: 0.001557
Epoch 4349 
Prediction Loss: 0.001561
Epoch 4399 
Prediction Loss: 0.002326
Epoch 4449 
Prediction Loss: 0.001257
Epoch 4499 
Prediction Loss: 0.001328
Epoch 4549 
Prediction Loss: 0.003061
Epoch 4599 
Prediction Loss: 0.002278
Epoch 4649 
Prediction Loss: 0.001699
Epoch 4699 
Prediction Loss: 0.001054
Epoch 4749 
Prediction Loss: 0.002041
Epoch 4799 
Prediction Loss: 0.002564
Epoch 4849 
Prediction Loss: 0.001625
Epoch 4899 
Prediction Loss: 0.003719
Epoch 4949 
Prediction Loss: 0.001569
Epoch 4999 
Prediction Loss: 0.001417
Epoch 5049 
Prediction Loss: 0.001327
Epoch 5099 
Prediction Loss: 0.003033
Epoch 5149 
Prediction Loss: 0.001211
Epoch 5199 
Prediction Loss: 0.000992
Epoch 5249 
Prediction Loss: 0.001932
Epoch 5299 
Prediction Loss: 0.001091
Epoch 5349 
Prediction Loss: 0.002101
Epoch 5399 
Prediction Loss: 0.001081
Epoch 5449 
Prediction Loss: 0.001055
Epoch 5499 
Prediction Loss: 0.001507
Epoch 5549 
Prediction Loss: 0.001669
Epoch 5599 
Prediction Loss: 0.001341
Epoch 5649 
Prediction Loss: 0.001254
Epoch 5699 
Prediction Loss: 0.001670
Epoch 5749 
Prediction Loss: 0.002755
Epoch 5799 
Prediction Loss: 0.001519
Epoch 5849 
Prediction Loss: 0.001990
Epoch 5899 
Prediction Loss: 0.001442
Epoch 5949 
Prediction Loss: 0.003310
Epoch 5999 
Prediction Loss: 0.001770
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.031598
Insample Error 0.180036
[31m========== repeat time 5 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.728901
Rec Loss: 10.415895
KL Loss: 0.313005
Y Loss: 0.635405
T Loss: 10.098193
Epoch 99 
Overall Loss: 10.441222
Rec Loss: 10.309140
KL Loss: 0.132083
Y Loss: 0.280693
T Loss: 10.168793
Epoch 149 
Overall Loss: 10.355997
Rec Loss: 10.245499
KL Loss: 0.110498
Y Loss: 0.164947
T Loss: 10.163026
Epoch 199 
Overall Loss: 10.324865
Rec Loss: 10.233536
KL Loss: 0.091329
Y Loss: 0.126040
T Loss: 10.170517
Epoch 249 
Overall Loss: 10.328466
Rec Loss: 10.224831
KL Loss: 0.103635
Y Loss: 0.104523
T Loss: 10.172570
Epoch 299 
Overall Loss: 10.281570
Rec Loss: 10.208537
KL Loss: 0.073033
Y Loss: 0.089251
T Loss: 10.163911
Epoch 349 
Overall Loss: 10.283113
Rec Loss: 10.214090
KL Loss: 0.069023
Y Loss: 0.082608
T Loss: 10.172786
Epoch 399 
Overall Loss: 10.270459
Rec Loss: 10.200268
KL Loss: 0.070192
Y Loss: 0.074434
T Loss: 10.163051
Epoch 449 
Overall Loss: 10.256175
Rec Loss: 10.195526
KL Loss: 0.060649
Y Loss: 0.066334
T Loss: 10.162359
Epoch 499 
Overall Loss: 10.257509
Rec Loss: 10.192395
KL Loss: 0.065114
Y Loss: 0.060806
T Loss: 10.161992
Epoch 549 
Overall Loss: 10.247686
Rec Loss: 10.188903
KL Loss: 0.058783
Y Loss: 0.053664
T Loss: 10.162071
Epoch 599 
Overall Loss: 10.240182
Rec Loss: 10.185535
KL Loss: 0.054647
Y Loss: 0.052296
T Loss: 10.159387
Epoch 649 
Overall Loss: 10.242289
Rec Loss: 10.185347
KL Loss: 0.056941
Y Loss: 0.053309
T Loss: 10.158693
Epoch 699 
Overall Loss: 10.219647
Rec Loss: 10.173003
KL Loss: 0.046644
Y Loss: 0.043911
T Loss: 10.151047
Epoch 749 
Overall Loss: 10.212183
Rec Loss: 10.167666
KL Loss: 0.044516
Y Loss: 0.038965
T Loss: 10.148183
Epoch 799 
Overall Loss: 10.218454
Rec Loss: 10.169286
KL Loss: 0.049168
Y Loss: 0.039474
T Loss: 10.149549
Epoch 849 
Overall Loss: 10.218933
Rec Loss: 10.168666
KL Loss: 0.050266
Y Loss: 0.039708
T Loss: 10.148813
Epoch 899 
Overall Loss: 10.202069
Rec Loss: 10.160384
KL Loss: 0.041685
Y Loss: 0.037426
T Loss: 10.141671
Epoch 949 
Overall Loss: 10.201060
Rec Loss: 10.160580
KL Loss: 0.040480
Y Loss: 0.037460
T Loss: 10.141850
Epoch 999 
Overall Loss: 10.193739
Rec Loss: 10.153748
KL Loss: 0.039991
Y Loss: 0.037697
T Loss: 10.134900
Epoch 1049 
Overall Loss: 10.191038
Rec Loss: 10.151726
KL Loss: 0.039312
Y Loss: 0.031374
T Loss: 10.136039
Epoch 1099 
Overall Loss: 10.201877
Rec Loss: 10.161572
KL Loss: 0.040305
Y Loss: 0.044541
T Loss: 10.139302
Epoch 1149 
Overall Loss: 10.187150
Rec Loss: 10.147468
KL Loss: 0.039682
Y Loss: 0.030215
T Loss: 10.132360
Epoch 1199 
Overall Loss: 10.187484
Rec Loss: 10.144911
KL Loss: 0.042573
Y Loss: 0.029293
T Loss: 10.130264
Epoch 1249 
Overall Loss: 10.183094
Rec Loss: 10.146908
KL Loss: 0.036185
Y Loss: 0.031623
T Loss: 10.131097
Epoch 1299 
Overall Loss: 10.174188
Rec Loss: 10.137832
KL Loss: 0.036357
Y Loss: 0.027855
T Loss: 10.123905
Epoch 1349 
Overall Loss: 10.171756
Rec Loss: 10.138078
KL Loss: 0.033678
Y Loss: 0.034022
T Loss: 10.121066
Epoch 1399 
Overall Loss: 10.167543
Rec Loss: 10.137212
KL Loss: 0.030331
Y Loss: 0.028949
T Loss: 10.122738
Epoch 1449 
Overall Loss: 10.181434
Rec Loss: 10.137993
KL Loss: 0.043441
Y Loss: 0.030955
T Loss: 10.122516
Epoch 1499 
Overall Loss: 10.170656
Rec Loss: 10.131208
KL Loss: 0.039448
Y Loss: 0.027743
T Loss: 10.117337
Epoch 1549 
Overall Loss: 10.165593
Rec Loss: 10.130223
KL Loss: 0.035369
Y Loss: 0.026433
T Loss: 10.117007
Epoch 1599 
Overall Loss: 10.151950
Rec Loss: 10.123432
KL Loss: 0.028518
Y Loss: 0.027446
T Loss: 10.109709
Epoch 1649 
Overall Loss: 10.152135
Rec Loss: 10.123719
KL Loss: 0.028417
Y Loss: 0.027256
T Loss: 10.110091
Epoch 1699 
Overall Loss: 10.160222
Rec Loss: 10.121341
KL Loss: 0.038882
Y Loss: 0.035531
T Loss: 10.103576
Epoch 1749 
Overall Loss: 10.151325
Rec Loss: 10.122236
KL Loss: 0.029089
Y Loss: 0.027113
T Loss: 10.108679
Epoch 1799 
Overall Loss: 10.148911
Rec Loss: 10.119309
KL Loss: 0.029603
Y Loss: 0.025015
T Loss: 10.106802
Epoch 1849 
Overall Loss: 10.146760
Rec Loss: 10.119323
KL Loss: 0.027437
Y Loss: 0.026944
T Loss: 10.105851
Epoch 1899 
Overall Loss: 10.151220
Rec Loss: 10.118356
KL Loss: 0.032864
Y Loss: 0.025002
T Loss: 10.105856
Epoch 1949 
Overall Loss: 10.135862
Rec Loss: 10.107291
KL Loss: 0.028570
Y Loss: 0.024382
T Loss: 10.095100
Epoch 1999 
Overall Loss: 10.138700
Rec Loss: 10.109851
KL Loss: 0.028850
Y Loss: 0.025312
T Loss: 10.097195
Epoch 2049 
Overall Loss: 10.142202
Rec Loss: 10.111773
KL Loss: 0.030428
Y Loss: 0.031159
T Loss: 10.096194
Epoch 2099 
Overall Loss: 10.136558
Rec Loss: 10.107575
KL Loss: 0.028983
Y Loss: 0.027728
T Loss: 10.093711
Epoch 2149 
Overall Loss: 10.133580
Rec Loss: 10.103781
KL Loss: 0.029799
Y Loss: 0.022000
T Loss: 10.092780
Epoch 2199 
Overall Loss: 10.133200
Rec Loss: 10.106657
KL Loss: 0.026543
Y Loss: 0.023729
T Loss: 10.094793
Epoch 2249 
Overall Loss: 10.128642
Rec Loss: 10.102122
KL Loss: 0.026521
Y Loss: 0.022500
T Loss: 10.090872
Epoch 2299 
Overall Loss: 10.123449
Rec Loss: 10.100038
KL Loss: 0.023411
Y Loss: 0.021589
T Loss: 10.089243
Epoch 2349 
Overall Loss: 10.120249
Rec Loss: 10.095858
KL Loss: 0.024392
Y Loss: 0.022786
T Loss: 10.084464
Epoch 2399 
Overall Loss: 10.120770
Rec Loss: 10.093047
KL Loss: 0.027722
Y Loss: 0.030166
T Loss: 10.077965
Epoch 2449 
Overall Loss: 10.116665
Rec Loss: 10.092000
KL Loss: 0.024665
Y Loss: 0.020569
T Loss: 10.081715
Epoch 2499 
Overall Loss: 10.115295
Rec Loss: 10.092568
KL Loss: 0.022727
Y Loss: 0.021997
T Loss: 10.081569
Epoch 2549 
Overall Loss: 10.122812
Rec Loss: 10.090439
KL Loss: 0.032373
Y Loss: 0.021947
T Loss: 10.079465
Epoch 2599 
Overall Loss: 10.116066
Rec Loss: 10.086259
KL Loss: 0.029807
Y Loss: 0.022735
T Loss: 10.074891
Epoch 2649 
Overall Loss: 10.114977
Rec Loss: 10.086806
KL Loss: 0.028171
Y Loss: 0.019750
T Loss: 10.076931
Epoch 2699 
Overall Loss: 10.108911
Rec Loss: 10.087038
KL Loss: 0.021874
Y Loss: 0.022177
T Loss: 10.075949
Epoch 2749 
Overall Loss: 10.118003
Rec Loss: 10.089508
KL Loss: 0.028495
Y Loss: 0.021961
T Loss: 10.078528
Epoch 2799 
Overall Loss: 10.104665
Rec Loss: 10.082418
KL Loss: 0.022246
Y Loss: 0.021593
T Loss: 10.071621
Epoch 2849 
Overall Loss: 10.106238
Rec Loss: 10.079876
KL Loss: 0.026362
Y Loss: 0.019589
T Loss: 10.070082
Epoch 2899 
Overall Loss: 10.104845
Rec Loss: 10.080310
KL Loss: 0.024536
Y Loss: 0.021040
T Loss: 10.069790
Epoch 2949 
Overall Loss: 10.103373
Rec Loss: 10.079461
KL Loss: 0.023911
Y Loss: 0.022924
T Loss: 10.067999
Epoch 2999 
Overall Loss: 10.101134
Rec Loss: 10.077983
KL Loss: 0.023151
Y Loss: 0.022407
T Loss: 10.066780
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.023352
Epoch 99
Rec Loss: 0.016320
Epoch 149
Rec Loss: 0.015176
Epoch 199
Rec Loss: 0.014547
Epoch 249
Rec Loss: 0.013960
Epoch 299
Rec Loss: 0.014043
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.095588
Epoch 99
Rec Loss: 10.056840
Epoch 149
Rec Loss: 10.035292
Epoch 199
Rec Loss: 10.005751
Epoch 249
Rec Loss: 9.985671
Epoch 299
Rec Loss: 9.985597
Epoch 349
Rec Loss: 9.957779
Epoch 399
Rec Loss: 9.943255
Epoch 449
Rec Loss: 9.938338
Epoch 499
Rec Loss: 9.932806
Epoch 549
Rec Loss: 9.921836
Epoch 599
Rec Loss: 9.906318
Epoch 649
Rec Loss: 9.907053
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.084784
Insample Error: 0.351886
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 20.749123
Rec Loss: 17.349192
KL Loss: 3.399931
Y Loss: 9.501382
T Loss: 13.137020
X Loss: -0.538520
Epoch 99 
Overall Loss: 3.335759
Rec Loss: -8.075639
KL Loss: 11.411398
Y Loss: 2.645524
T Loss: 12.934095
X Loss: -22.332496
Epoch 149 
Overall Loss: -1.763449
Rec Loss: -14.245962
KL Loss: 12.482513
Y Loss: 1.584283
T Loss: 12.752502
X Loss: -27.790605
Epoch 199 
Overall Loss: -4.891498
Rec Loss: -18.479380
KL Loss: 13.587882
Y Loss: 0.874016
T Loss: 12.318687
X Loss: -31.235075
Epoch 249 
Overall Loss: -6.940341
Rec Loss: -21.323327
KL Loss: 14.382986
Y Loss: 0.572407
T Loss: 12.015094
X Loss: -33.624624
Epoch 299 
Overall Loss: -8.302023
Rec Loss: -23.284585
KL Loss: 14.982562
Y Loss: 0.460679
T Loss: 11.874510
X Loss: -35.389434
Epoch 349 
Overall Loss: -9.400408
Rec Loss: -24.764803
KL Loss: 15.364395
Y Loss: 0.401286
T Loss: 11.815577
X Loss: -36.781023
Epoch 399 
Overall Loss: -10.158800
Rec Loss: -25.863731
KL Loss: 15.704930
Y Loss: 0.373967
T Loss: 11.769750
X Loss: -37.820463
Epoch 449 
Overall Loss: -10.999933
Rec Loss: -26.996821
KL Loss: 15.996889
Y Loss: 0.342565
T Loss: 11.738102
X Loss: -38.906206
Epoch 499 
Overall Loss: -11.734264
Rec Loss: -27.902869
KL Loss: 16.168604
Y Loss: 0.302758
T Loss: 11.708995
X Loss: -39.763243
Epoch 549 
Overall Loss: -12.406024
Rec Loss: -28.783383
KL Loss: 16.377359
Y Loss: 0.289699
T Loss: 11.684975
X Loss: -40.613207
Epoch 599 
Overall Loss: -12.841948
Rec Loss: -29.379879
KL Loss: 16.537930
Y Loss: 0.265671
T Loss: 11.672532
X Loss: -41.185247
Epoch 649 
Overall Loss: -13.449270
Rec Loss: -30.035952
KL Loss: 16.586683
Y Loss: 0.248120
T Loss: 11.662470
X Loss: -41.822482
Epoch 699 
Overall Loss: -13.977006
Rec Loss: -30.639736
KL Loss: 16.662730
Y Loss: 0.232479
T Loss: 11.643413
X Loss: -42.399389
Epoch 749 
Overall Loss: -14.348528
Rec Loss: -31.180049
KL Loss: 16.831521
Y Loss: 0.201139
T Loss: 11.623196
X Loss: -42.903814
Epoch 799 
Overall Loss: -14.751389
Rec Loss: -31.743284
KL Loss: 16.991895
Y Loss: 0.196661
T Loss: 11.595126
X Loss: -43.436739
Epoch 849 
Overall Loss: -15.210689
Rec Loss: -32.137746
KL Loss: 16.927057
Y Loss: 0.179975
T Loss: 11.573418
X Loss: -43.801152
Epoch 899 
Overall Loss: -15.685759
Rec Loss: -32.842024
KL Loss: 17.156265
Y Loss: 0.187024
T Loss: 11.523290
X Loss: -44.458826
Epoch 949 
Overall Loss: -15.987115
Rec Loss: -33.248878
KL Loss: 17.261763
Y Loss: 0.161509
T Loss: 11.488072
X Loss: -44.817704
Epoch 999 
Overall Loss: -16.402811
Rec Loss: -33.748854
KL Loss: 17.346043
Y Loss: 0.161509
T Loss: 11.449093
X Loss: -45.278701
Epoch 1049 
Overall Loss: -16.605102
Rec Loss: -33.933468
KL Loss: 17.328367
Y Loss: 0.164111
T Loss: 11.410915
X Loss: -45.426439
Epoch 1099 
Overall Loss: -16.848439
Rec Loss: -34.380799
KL Loss: 17.532361
Y Loss: 0.155309
T Loss: 11.377494
X Loss: -45.835948
Epoch 1149 
Overall Loss: -17.236093
Rec Loss: -34.750532
KL Loss: 17.514439
Y Loss: 0.149899
T Loss: 11.350573
X Loss: -46.176055
Epoch 1199 
Overall Loss: -17.342804
Rec Loss: -34.891360
KL Loss: 17.548555
Y Loss: 0.143781
T Loss: 11.341946
X Loss: -46.305196
Epoch 1249 
Overall Loss: -17.583655
Rec Loss: -35.249516
KL Loss: 17.665860
Y Loss: 0.146031
T Loss: 11.292758
X Loss: -46.615290
Epoch 1299 
Overall Loss: -17.853396
Rec Loss: -35.620228
KL Loss: 17.766832
Y Loss: 0.148805
T Loss: 11.270382
X Loss: -46.965012
Epoch 1349 
Overall Loss: -18.202411
Rec Loss: -36.023653
KL Loss: 17.821243
Y Loss: 0.147760
T Loss: 11.262762
X Loss: -47.360296
Epoch 1399 
Overall Loss: -17.982284
Rec Loss: -35.857404
KL Loss: 17.875121
Y Loss: 0.135804
T Loss: 11.239192
X Loss: -47.164500
Epoch 1449 
Overall Loss: -18.445070
Rec Loss: -36.427418
KL Loss: 17.982349
Y Loss: 0.123257
T Loss: 11.238802
X Loss: -47.727848
Epoch 1499 
Overall Loss: -18.805383
Rec Loss: -36.823573
KL Loss: 18.018191
Y Loss: 0.127887
T Loss: 11.222774
X Loss: -48.110291
Epoch 1549 
Overall Loss: -18.954191
Rec Loss: -37.006518
KL Loss: 18.052328
Y Loss: 0.131944
T Loss: 11.210035
X Loss: -48.282525
Epoch 1599 
Overall Loss: -18.969114
Rec Loss: -37.130811
KL Loss: 18.161697
Y Loss: 0.129491
T Loss: 11.210143
X Loss: -48.405700
Epoch 1649 
Overall Loss: -18.974618
Rec Loss: -37.219294
KL Loss: 18.244676
Y Loss: 0.123164
T Loss: 11.203765
X Loss: -48.484641
Epoch 1699 
Overall Loss: -19.141839
Rec Loss: -37.344729
KL Loss: 18.202891
Y Loss: 0.117761
T Loss: 11.181694
X Loss: -48.585304
Epoch 1749 
Overall Loss: -19.483147
Rec Loss: -37.789785
KL Loss: 18.306638
Y Loss: 0.119085
T Loss: 11.170631
X Loss: -49.019959
Epoch 1799 
Overall Loss: -19.602261
Rec Loss: -37.873394
KL Loss: 18.271132
Y Loss: 0.119091
T Loss: 11.166658
X Loss: -49.099598
Epoch 1849 
Overall Loss: -19.588171
Rec Loss: -37.905757
KL Loss: 18.317587
Y Loss: 0.110696
T Loss: 11.157711
X Loss: -49.118817
Epoch 1899 
Overall Loss: -20.135416
Rec Loss: -38.528776
KL Loss: 18.393361
Y Loss: 0.114198
T Loss: 11.133921
X Loss: -49.719796
Epoch 1949 
Overall Loss: -20.101682
Rec Loss: -38.554194
KL Loss: 18.452513
Y Loss: 0.117764
T Loss: 11.144059
X Loss: -49.757136
Epoch 1999 
Overall Loss: -20.218819
Rec Loss: -38.634564
KL Loss: 18.415744
Y Loss: 0.112867
T Loss: 11.143501
X Loss: -49.834497
Epoch 2049 
Overall Loss: -19.957692
Rec Loss: -38.332240
KL Loss: 18.374548
Y Loss: 0.113627
T Loss: 11.140058
X Loss: -49.529112
Epoch 2099 
Overall Loss: -20.579759
Rec Loss: -39.126063
KL Loss: 18.546305
Y Loss: 0.111788
T Loss: 11.126731
X Loss: -50.308687
Epoch 2149 
Overall Loss: -20.574439
Rec Loss: -39.163167
KL Loss: 18.588728
Y Loss: 0.107064
T Loss: 11.129653
X Loss: -50.346351
Epoch 2199 
Overall Loss: -20.480635
Rec Loss: -38.926946
KL Loss: 18.446311
Y Loss: 0.108138
T Loss: 11.120706
X Loss: -50.101720
Epoch 2249 
Overall Loss: -20.652826
Rec Loss: -39.263130
KL Loss: 18.610303
Y Loss: 0.100938
T Loss: 11.116075
X Loss: -50.429673
Epoch 2299 
Overall Loss: -21.101103
Rec Loss: -39.747084
KL Loss: 18.645981
Y Loss: 0.109978
T Loss: 11.112784
X Loss: -50.914857
Epoch 2349 
Overall Loss: -20.995079
Rec Loss: -39.459370
KL Loss: 18.464290
Y Loss: 0.110374
T Loss: 11.118685
X Loss: -50.633242
Epoch 2399 
Overall Loss: -21.224473
Rec Loss: -39.860760
KL Loss: 18.636288
Y Loss: 0.103574
T Loss: 11.105505
X Loss: -51.018054
Epoch 2449 
Overall Loss: -21.184551
Rec Loss: -39.944780
KL Loss: 18.760230
Y Loss: 0.097549
T Loss: 11.091969
X Loss: -51.085523
Epoch 2499 
Overall Loss: -21.119231
Rec Loss: -39.813131
KL Loss: 18.693899
Y Loss: 0.108708
T Loss: 11.091566
X Loss: -50.959051
Epoch 2549 
Overall Loss: -21.562574
Rec Loss: -40.326269
KL Loss: 18.763695
Y Loss: 0.105419
T Loss: 11.084465
X Loss: -51.463443
Epoch 2599 
Overall Loss: -21.533799
Rec Loss: -40.416519
KL Loss: 18.882720
Y Loss: 0.100066
T Loss: 11.083831
X Loss: -51.550383
Epoch 2649 
Overall Loss: -21.285003
Rec Loss: -40.151917
KL Loss: 18.866914
Y Loss: 0.101387
T Loss: 11.076793
X Loss: -51.279404
Epoch 2699 
Overall Loss: -21.788685
Rec Loss: -40.622603
KL Loss: 18.833918
Y Loss: 0.100976
T Loss: 11.084846
X Loss: -51.757937
Epoch 2749 
Overall Loss: -21.869004
Rec Loss: -40.646534
KL Loss: 18.777530
Y Loss: 0.103782
T Loss: 11.071442
X Loss: -51.769866
Epoch 2799 
Overall Loss: -22.170750
Rec Loss: -41.087370
KL Loss: 18.916619
Y Loss: 0.105760
T Loss: 11.066943
X Loss: -52.207193
Epoch 2849 
Overall Loss: -21.610044
Rec Loss: -40.707892
KL Loss: 19.097847
Y Loss: 0.091818
T Loss: 11.060866
X Loss: -51.814667
Epoch 2899 
Overall Loss: -22.241668
Rec Loss: -41.249610
KL Loss: 19.007942
Y Loss: 0.103365
T Loss: 11.054724
X Loss: -52.356016
Epoch 2949 
Overall Loss: -21.971224
Rec Loss: -40.887269
KL Loss: 18.916047
Y Loss: 0.108768
T Loss: 11.063288
X Loss: -52.004944
Epoch 2999 
Overall Loss: -21.727482
Rec Loss: -40.903621
KL Loss: 19.176141
Y Loss: 0.096668
T Loss: 11.047356
X Loss: -51.999313
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.290132
Epoch 99
Rec Loss: 2.270041
Epoch 149
Rec Loss: 2.268226
Epoch 199
Rec Loss: 2.261875
Epoch 249
Rec Loss: 2.253700
Epoch 299
Rec Loss: 2.254012
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.002210
Epoch 99
Rec Loss: 0.001339
Epoch 149
Rec Loss: 0.001045
Epoch 199
Rec Loss: 0.000951
Epoch 249
Rec Loss: 0.000798
Epoch 299
Rec Loss: 0.000772
Epoch 349
Rec Loss: 0.001075
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.246017
Insample Error 4.446201
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.551621
Epoch 99 
Prediction Loss: 0.164919
Epoch 149 
Prediction Loss: 0.100638
Epoch 199 
Prediction Loss: 0.068619
Epoch 249 
Prediction Loss: 0.052386
Epoch 299 
Prediction Loss: 0.042466
Epoch 349 
Prediction Loss: 0.033601
Epoch 399 
Prediction Loss: 0.028923
Epoch 449 
Prediction Loss: 0.022763
Epoch 499 
Prediction Loss: 0.019905
Epoch 549 
Prediction Loss: 0.015978
Epoch 599 
Prediction Loss: 0.018519
Epoch 649 
Prediction Loss: 0.012626
Epoch 699 
Prediction Loss: 0.012559
Epoch 749 
Prediction Loss: 0.011208
Epoch 799 
Prediction Loss: 0.010294
Epoch 849 
Prediction Loss: 0.010684
Epoch 899 
Prediction Loss: 0.009343
Epoch 949 
Prediction Loss: 0.011073
Epoch 999 
Prediction Loss: 0.007157
Epoch 1049 
Prediction Loss: 0.006579
Epoch 1099 
Prediction Loss: 0.007691
Epoch 1149 
Prediction Loss: 0.007696
Epoch 1199 
Prediction Loss: 0.007585
Epoch 1249 
Prediction Loss: 0.006559
Epoch 1299 
Prediction Loss: 0.005582
Epoch 1349 
Prediction Loss: 0.009177
Epoch 1399 
Prediction Loss: 0.004995
Epoch 1449 
Prediction Loss: 0.005017
Epoch 1499 
Prediction Loss: 0.005198
Epoch 1549 
Prediction Loss: 0.004915
Epoch 1599 
Prediction Loss: 0.005220
Epoch 1649 
Prediction Loss: 0.005135
Epoch 1699 
Prediction Loss: 0.004739
Epoch 1749 
Prediction Loss: 0.004965
Epoch 1799 
Prediction Loss: 0.004538
Epoch 1849 
Prediction Loss: 0.004489
Epoch 1899 
Prediction Loss: 0.004223
Epoch 1949 
Prediction Loss: 0.005684
Epoch 1999 
Prediction Loss: 0.003960
Epoch 2049 
Prediction Loss: 0.006177
Epoch 2099 
Prediction Loss: 0.003981
Epoch 2149 
Prediction Loss: 0.004121
Epoch 2199 
Prediction Loss: 0.004081
Epoch 2249 
Prediction Loss: 0.002861
Epoch 2299 
Prediction Loss: 0.004254
Epoch 2349 
Prediction Loss: 0.003299
Epoch 2399 
Prediction Loss: 0.006227
Epoch 2449 
Prediction Loss: 0.002985
Epoch 2499 
Prediction Loss: 0.003293
Epoch 2549 
Prediction Loss: 0.003096
Epoch 2599 
Prediction Loss: 0.002998
Epoch 2649 
Prediction Loss: 0.003127
Epoch 2699 
Prediction Loss: 0.003350
Epoch 2749 
Prediction Loss: 0.004650
Epoch 2799 
Prediction Loss: 0.002434
Epoch 2849 
Prediction Loss: 0.002977
Epoch 2899 
Prediction Loss: 0.004465
Epoch 2949 
Prediction Loss: 0.002612
Epoch 2999 
Prediction Loss: 0.002186
Epoch 3049 
Prediction Loss: 0.002306
Epoch 3099 
Prediction Loss: 0.002200
Epoch 3149 
Prediction Loss: 0.002919
Epoch 3199 
Prediction Loss: 0.003950
Epoch 3249 
Prediction Loss: 0.002876
Epoch 3299 
Prediction Loss: 0.002605
Epoch 3349 
Prediction Loss: 0.002354
Epoch 3399 
Prediction Loss: 0.002107
Epoch 3449 
Prediction Loss: 0.002177
Epoch 3499 
Prediction Loss: 0.002116
Epoch 3549 
Prediction Loss: 0.002619
Epoch 3599 
Prediction Loss: 0.002508
Epoch 3649 
Prediction Loss: 0.003104
Epoch 3699 
Prediction Loss: 0.002234
Epoch 3749 
Prediction Loss: 0.002152
Epoch 3799 
Prediction Loss: 0.004726
Epoch 3849 
Prediction Loss: 0.002251
Epoch 3899 
Prediction Loss: 0.002890
Epoch 3949 
Prediction Loss: 0.002283
Epoch 3999 
Prediction Loss: 0.002820
Epoch 4049 
Prediction Loss: 0.003405
Epoch 4099 
Prediction Loss: 0.002261
Epoch 4149 
Prediction Loss: 0.003043
Epoch 4199 
Prediction Loss: 0.003043
Epoch 4249 
Prediction Loss: 0.003927
Epoch 4299 
Prediction Loss: 0.001808
Epoch 4349 
Prediction Loss: 0.001601
Epoch 4399 
Prediction Loss: 0.004102
Epoch 4449 
Prediction Loss: 0.001678
Epoch 4499 
Prediction Loss: 0.001804
Epoch 4549 
Prediction Loss: 0.001626
Epoch 4599 
Prediction Loss: 0.003613
Epoch 4649 
Prediction Loss: 0.002901
Epoch 4699 
Prediction Loss: 0.003474
Epoch 4749 
Prediction Loss: 0.001783
Epoch 4799 
Prediction Loss: 0.001506
Epoch 4849 
Prediction Loss: 0.003188
Epoch 4899 
Prediction Loss: 0.002434
Epoch 4949 
Prediction Loss: 0.002114
Epoch 4999 
Prediction Loss: 0.001619
Epoch 5049 
Prediction Loss: 0.003414
Epoch 5099 
Prediction Loss: 0.001925
Epoch 5149 
Prediction Loss: 0.001771
Epoch 5199 
Prediction Loss: 0.001751
Epoch 5249 
Prediction Loss: 0.002048
Epoch 5299 
Prediction Loss: 0.001911
Epoch 5349 
Prediction Loss: 0.002107
Epoch 5399 
Prediction Loss: 0.003120
Epoch 5449 
Prediction Loss: 0.001671
Epoch 5499 
Prediction Loss: 0.005328
Epoch 5549 
Prediction Loss: 0.003963
Epoch 5599 
Prediction Loss: 0.002492
Epoch 5649 
Prediction Loss: 0.002047
Epoch 5699 
Prediction Loss: 0.001671
Epoch 5749 
Prediction Loss: 0.001499
Epoch 5799 
Prediction Loss: 0.002006
Epoch 5849 
Prediction Loss: 0.001294
Epoch 5899 
Prediction Loss: 0.001798
Epoch 5949 
Prediction Loss: 0.004345
Epoch 5999 
Prediction Loss: 0.001847
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.048147
Insample Error 0.189014
Ours, Train RMSE
0.1070, 
0.0930, 
0.0965, 
0.0863, 
0.0848, 
CEVAE, Train RMSE
0.2225, 
0.2218, 
0.2346, 
0.3687, 
0.2460, 
Ours, Insample RMSE
0.4785, 
0.4357, 
0.4393, 
0.3960, 
0.3519, 
CEVAE, Insample RMSE
3.2432, 
2.9514, 
3.3351, 
2.9062, 
4.4462, 
Direct Regression, Insample RMSE
0.2098, 
0.2356, 
0.2165, 
0.1800, 
0.1890, 
Train, RMSE mean 0.0935 std 0.0080
CEVAE, RMSE mean 0.2587 std 0.0557
Ours, RMSE mean 0.4203 std 0.0430, reconstruct confounder 0.0148 (0.0008) noise 9.9646 (0.0463)
CEVAE, RMSE mean 3.3764 std 0.5596, reconstruct confounder 2.1824 (0.0727) noise 0.0011 (0.0004)
Direct Regression, RMSE mean 0.2062 std 0.0198
Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=5, mask=0, nlayer=50, obsm=4, stop=2000, ycof=0.5, ylayer=50)
Y Mean 1.919658, Std 4.231794 
Test Y Mean -0.009485, Std 4.121477 
Observe confounder 4, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.718177
Rec Loss: 10.419365
KL Loss: 0.298812
Y Loss: 0.615155
T Loss: 10.111788
Epoch 99 
Overall Loss: 10.462790
Rec Loss: 10.295177
KL Loss: 0.167612
Y Loss: 0.301211
T Loss: 10.144571
Epoch 149 
Overall Loss: 10.385379
Rec Loss: 10.253391
KL Loss: 0.131988
Y Loss: 0.188722
T Loss: 10.159029
Epoch 199 
Overall Loss: 10.333792
Rec Loss: 10.227911
KL Loss: 0.105881
Y Loss: 0.134928
T Loss: 10.160447
Epoch 249 
Overall Loss: 10.320857
Rec Loss: 10.224510
KL Loss: 0.096348
Y Loss: 0.112423
T Loss: 10.168298
Epoch 299 
Overall Loss: 10.297940
Rec Loss: 10.208840
KL Loss: 0.089100
Y Loss: 0.097046
T Loss: 10.160316
Epoch 349 
Overall Loss: 10.287363
Rec Loss: 10.209338
KL Loss: 0.078025
Y Loss: 0.093364
T Loss: 10.162656
Epoch 399 
Overall Loss: 10.275172
Rec Loss: 10.193794
KL Loss: 0.081378
Y Loss: 0.074847
T Loss: 10.156371
Epoch 449 
Overall Loss: 10.253621
Rec Loss: 10.187624
KL Loss: 0.065998
Y Loss: 0.071414
T Loss: 10.151916
Epoch 499 
Overall Loss: 10.247237
Rec Loss: 10.186254
KL Loss: 0.060983
Y Loss: 0.062023
T Loss: 10.155243
Epoch 549 
Overall Loss: 10.243899
Rec Loss: 10.186163
KL Loss: 0.057735
Y Loss: 0.053888
T Loss: 10.159219
Epoch 599 
Overall Loss: 10.244925
Rec Loss: 10.189783
KL Loss: 0.055142
Y Loss: 0.052901
T Loss: 10.163333
Epoch 649 
Overall Loss: 10.227864
Rec Loss: 10.176267
KL Loss: 0.051597
Y Loss: 0.048837
T Loss: 10.151848
Epoch 699 
Overall Loss: 10.261493
Rec Loss: 10.179510
KL Loss: 0.081984
Y Loss: 0.055227
T Loss: 10.151896
Epoch 749 
Overall Loss: 10.216653
Rec Loss: 10.168787
KL Loss: 0.047866
Y Loss: 0.045934
T Loss: 10.145820
Epoch 799 
Overall Loss: 10.214601
Rec Loss: 10.167895
KL Loss: 0.046706
Y Loss: 0.045586
T Loss: 10.145102
Epoch 849 
Overall Loss: 10.213024
Rec Loss: 10.168192
KL Loss: 0.044832
Y Loss: 0.042775
T Loss: 10.146804
Epoch 899 
Overall Loss: 10.215360
Rec Loss: 10.165637
KL Loss: 0.049722
Y Loss: 0.042224
T Loss: 10.144526
Epoch 949 
Overall Loss: 10.209344
Rec Loss: 10.164368
KL Loss: 0.044976
Y Loss: 0.043935
T Loss: 10.142400
Epoch 999 
Overall Loss: 10.207377
Rec Loss: 10.159033
KL Loss: 0.048344
Y Loss: 0.050788
T Loss: 10.133639
Epoch 1049 
Overall Loss: 10.200831
Rec Loss: 10.158428
KL Loss: 0.042403
Y Loss: 0.037371
T Loss: 10.139743
Epoch 1099 
Overall Loss: 10.190189
Rec Loss: 10.151697
KL Loss: 0.038493
Y Loss: 0.038123
T Loss: 10.132635
Epoch 1149 
Overall Loss: 10.193530
Rec Loss: 10.149575
KL Loss: 0.043955
Y Loss: 0.050153
T Loss: 10.124499
Epoch 1199 
Overall Loss: 10.198260
Rec Loss: 10.152962
KL Loss: 0.045298
Y Loss: 0.039886
T Loss: 10.133019
Epoch 1249 
Overall Loss: 10.180509
Rec Loss: 10.145361
KL Loss: 0.035148
Y Loss: 0.035233
T Loss: 10.127744
Epoch 1299 
Overall Loss: 10.180900
Rec Loss: 10.145764
KL Loss: 0.035135
Y Loss: 0.037125
T Loss: 10.127202
Epoch 1349 
Overall Loss: 10.176179
Rec Loss: 10.142300
KL Loss: 0.033879
Y Loss: 0.035103
T Loss: 10.124748
Epoch 1399 
Overall Loss: 10.176414
Rec Loss: 10.139337
KL Loss: 0.037077
Y Loss: 0.033475
T Loss: 10.122599
Epoch 1449 
Overall Loss: 10.184622
Rec Loss: 10.144631
KL Loss: 0.039990
Y Loss: 0.049143
T Loss: 10.120059
Epoch 1499 
Overall Loss: 10.166756
Rec Loss: 10.135487
KL Loss: 0.031269
Y Loss: 0.034696
T Loss: 10.118139
Epoch 1549 
Overall Loss: 10.164797
Rec Loss: 10.133876
KL Loss: 0.030921
Y Loss: 0.030289
T Loss: 10.118732
Epoch 1599 
Overall Loss: 10.163678
Rec Loss: 10.131250
KL Loss: 0.032428
Y Loss: 0.033345
T Loss: 10.114577
Epoch 1649 
Overall Loss: 10.161018
Rec Loss: 10.124213
KL Loss: 0.036805
Y Loss: 0.031349
T Loss: 10.108538
Epoch 1699 
Overall Loss: 10.152232
Rec Loss: 10.124933
KL Loss: 0.027298
Y Loss: 0.030907
T Loss: 10.109480
Epoch 1749 
Overall Loss: 10.154818
Rec Loss: 10.121540
KL Loss: 0.033279
Y Loss: 0.038078
T Loss: 10.102501
Epoch 1799 
Overall Loss: 10.158905
Rec Loss: 10.125443
KL Loss: 0.033462
Y Loss: 0.040852
T Loss: 10.105017
Epoch 1849 
Overall Loss: 10.153047
Rec Loss: 10.123619
KL Loss: 0.029428
Y Loss: 0.029435
T Loss: 10.108902
Epoch 1899 
Overall Loss: 10.149456
Rec Loss: 10.118171
KL Loss: 0.031286
Y Loss: 0.027119
T Loss: 10.104611
Epoch 1949 
Overall Loss: 10.143704
Rec Loss: 10.115055
KL Loss: 0.028649
Y Loss: 0.028391
T Loss: 10.100859
Epoch 1999 
Overall Loss: 10.148625
Rec Loss: 10.116450
KL Loss: 0.032174
Y Loss: 0.029705
T Loss: 10.101598
Epoch 2049 
Overall Loss: 10.137884
Rec Loss: 10.110657
KL Loss: 0.027227
Y Loss: 0.030110
T Loss: 10.095602
Epoch 2099 
Overall Loss: 10.159521
Rec Loss: 10.116008
KL Loss: 0.043513
Y Loss: 0.031383
T Loss: 10.100317
Epoch 2149 
Overall Loss: 10.141536
Rec Loss: 10.112022
KL Loss: 0.029514
Y Loss: 0.032863
T Loss: 10.095591
Epoch 2199 
Overall Loss: 10.133724
Rec Loss: 10.104671
KL Loss: 0.029053
Y Loss: 0.027703
T Loss: 10.090820
Epoch 2249 
Overall Loss: 10.134804
Rec Loss: 10.104403
KL Loss: 0.030401
Y Loss: 0.026244
T Loss: 10.091281
Epoch 2299 
Overall Loss: 10.129662
Rec Loss: 10.104722
KL Loss: 0.024940
Y Loss: 0.024941
T Loss: 10.092252
Epoch 2349 
Overall Loss: 10.128377
Rec Loss: 10.104030
KL Loss: 0.024347
Y Loss: 0.025885
T Loss: 10.091088
Epoch 2399 
Overall Loss: 10.124959
Rec Loss: 10.099662
KL Loss: 0.025298
Y Loss: 0.024135
T Loss: 10.087594
Epoch 2449 
Overall Loss: 10.136200
Rec Loss: 10.106032
KL Loss: 0.030169
Y Loss: 0.036516
T Loss: 10.087774
Epoch 2499 
Overall Loss: 10.121586
Rec Loss: 10.095800
KL Loss: 0.025786
Y Loss: 0.030114
T Loss: 10.080743
Epoch 2549 
Overall Loss: 10.181208
Rec Loss: 10.102902
KL Loss: 0.078306
Y Loss: 0.038108
T Loss: 10.083848
Epoch 2599 
Overall Loss: 10.118973
Rec Loss: 10.092342
KL Loss: 0.026631
Y Loss: 0.025424
T Loss: 10.079631
Epoch 2649 
Overall Loss: 10.114926
Rec Loss: 10.092406
KL Loss: 0.022520
Y Loss: 0.024759
T Loss: 10.080026
Epoch 2699 
Overall Loss: 10.111833
Rec Loss: 10.086713
KL Loss: 0.025120
Y Loss: 0.025827
T Loss: 10.073799
Epoch 2749 
Overall Loss: 10.110870
Rec Loss: 10.086972
KL Loss: 0.023898
Y Loss: 0.023366
T Loss: 10.075289
Epoch 2799 
Overall Loss: 10.111187
Rec Loss: 10.084203
KL Loss: 0.026984
Y Loss: 0.025425
T Loss: 10.071490
Epoch 2849 
Overall Loss: 10.110320
Rec Loss: 10.087622
KL Loss: 0.022699
Y Loss: 0.026770
T Loss: 10.074237
Epoch 2899 
Overall Loss: 10.111553
Rec Loss: 10.087210
KL Loss: 0.024342
Y Loss: 0.026332
T Loss: 10.074044
Epoch 2949 
Overall Loss: 10.107654
Rec Loss: 10.084057
KL Loss: 0.023597
Y Loss: 0.024199
T Loss: 10.071958
Epoch 2999 
Overall Loss: 10.108552
Rec Loss: 10.083577
KL Loss: 0.024976
Y Loss: 0.023367
T Loss: 10.071893
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.018336
Epoch 99
Rec Loss: 0.016016
Epoch 149
Rec Loss: 0.014942
Epoch 199
Rec Loss: 0.014333
Epoch 249
Rec Loss: 0.013845
Epoch 299
Rec Loss: 0.014010
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.078861
Epoch 99
Rec Loss: 10.053681
Epoch 149
Rec Loss: 10.042889
Epoch 199
Rec Loss: 10.021746
Epoch 249
Rec Loss: 10.022343
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.091350
Insample Error: 0.426338
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 20.870132
Rec Loss: 17.468372
KL Loss: 3.401760
Y Loss: 6.808386
T Loss: 13.182346
X Loss: 0.881833
Epoch 99 
Overall Loss: 4.830570
Rec Loss: -4.878042
KL Loss: 9.708612
Y Loss: 2.659707
T Loss: 13.040820
X Loss: -19.248716
Epoch 149 
Overall Loss: -2.634929
Rec Loss: -12.990696
KL Loss: 10.355767
Y Loss: 1.932034
T Loss: 13.026384
X Loss: -26.983097
Epoch 199 
Overall Loss: -6.628328
Rec Loss: -18.035292
KL Loss: 11.406964
Y Loss: 1.451264
T Loss: 12.990642
X Loss: -31.751566
Epoch 249 
Overall Loss: -8.797993
Rec Loss: -21.047521
KL Loss: 12.249529
Y Loss: 1.159189
T Loss: 12.919199
X Loss: -34.546314
Epoch 299 
Overall Loss: -10.413928
Rec Loss: -23.167909
KL Loss: 12.753981
Y Loss: 1.021255
T Loss: 12.825119
X Loss: -36.503656
Epoch 349 
Overall Loss: -11.727448
Rec Loss: -24.948060
KL Loss: 13.220612
Y Loss: 0.900183
T Loss: 12.680499
X Loss: -38.078651
Epoch 399 
Overall Loss: -12.723735
Rec Loss: -26.329560
KL Loss: 13.605825
Y Loss: 0.737241
T Loss: 12.507692
X Loss: -39.205872
Epoch 449 
Overall Loss: -13.688700
Rec Loss: -27.587800
KL Loss: 13.899100
Y Loss: 0.664434
T Loss: 12.335517
X Loss: -40.255534
Epoch 499 
Overall Loss: -14.552860
Rec Loss: -28.756560
KL Loss: 14.203700
Y Loss: 0.615453
T Loss: 12.191473
X Loss: -41.255759
Epoch 549 
Overall Loss: -15.291360
Rec Loss: -29.736653
KL Loss: 14.445292
Y Loss: 0.591408
T Loss: 12.083270
X Loss: -42.115626
Epoch 599 
Overall Loss: -15.787694
Rec Loss: -30.408730
KL Loss: 14.621037
Y Loss: 0.565335
T Loss: 11.978426
X Loss: -42.669824
Epoch 649 
Overall Loss: -16.322197
Rec Loss: -31.161150
KL Loss: 14.838954
Y Loss: 0.540336
T Loss: 11.846477
X Loss: -43.277796
Epoch 699 
Overall Loss: -16.888139
Rec Loss: -32.020491
KL Loss: 15.132351
Y Loss: 0.491267
T Loss: 11.718126
X Loss: -43.984251
Epoch 749 
Overall Loss: -17.261169
Rec Loss: -32.603796
KL Loss: 15.342625
Y Loss: 0.468151
T Loss: 11.561644
X Loss: -44.399515
Epoch 799 
Overall Loss: -17.939370
Rec Loss: -33.409512
KL Loss: 15.470143
Y Loss: 0.455602
T Loss: 11.448138
X Loss: -45.085452
Epoch 849 
Overall Loss: -18.180027
Rec Loss: -33.844680
KL Loss: 15.664654
Y Loss: 0.443866
T Loss: 11.309014
X Loss: -45.375627
Epoch 899 
Overall Loss: -18.531869
Rec Loss: -34.402176
KL Loss: 15.870308
Y Loss: 0.432600
T Loss: 11.189295
X Loss: -45.807771
Epoch 949 
Overall Loss: -18.976066
Rec Loss: -34.908930
KL Loss: 15.932865
Y Loss: 0.418875
T Loss: 11.093767
X Loss: -46.212133
Epoch 999 
Overall Loss: -19.370351
Rec Loss: -35.464235
KL Loss: 16.093886
Y Loss: 0.421388
T Loss: 11.006202
X Loss: -46.681132
Epoch 1049 
Overall Loss: -19.722792
Rec Loss: -35.941666
KL Loss: 16.218874
Y Loss: 0.403958
T Loss: 10.927072
X Loss: -47.070718
Epoch 1099 
Overall Loss: -19.775841
Rec Loss: -36.065883
KL Loss: 16.290043
Y Loss: 0.400994
T Loss: 10.856448
X Loss: -47.122830
Epoch 1149 
Overall Loss: -19.562566
Rec Loss: -35.976052
KL Loss: 16.413487
Y Loss: 0.393351
T Loss: 10.785679
X Loss: -46.958407
Epoch 1199 
Overall Loss: -20.620374
Rec Loss: -37.137109
KL Loss: 16.516735
Y Loss: 0.391414
T Loss: 10.736423
X Loss: -48.069239
Epoch 1249 
Overall Loss: -20.530652
Rec Loss: -37.087475
KL Loss: 16.556824
Y Loss: 0.392820
T Loss: 10.711309
X Loss: -47.995195
Epoch 1299 
Overall Loss: -20.815136
Rec Loss: -37.471199
KL Loss: 16.656063
Y Loss: 0.381782
T Loss: 10.659420
X Loss: -48.321510
Epoch 1349 
Overall Loss: -20.854021
Rec Loss: -37.608846
KL Loss: 16.754825
Y Loss: 0.393507
T Loss: 10.639456
X Loss: -48.445055
Epoch 1399 
Overall Loss: -21.553960
Rec Loss: -38.367303
KL Loss: 16.813342
Y Loss: 0.387934
T Loss: 10.573911
X Loss: -49.135179
Epoch 1449 
Overall Loss: -21.771634
Rec Loss: -38.612409
KL Loss: 16.840775
Y Loss: 0.400443
T Loss: 10.568228
X Loss: -49.380859
Epoch 1499 
Overall Loss: -21.353365
Rec Loss: -38.341492
KL Loss: 16.988128
Y Loss: 0.383159
T Loss: 10.513996
X Loss: -49.047070
Epoch 1549 
Overall Loss: -22.186081
Rec Loss: -39.244533
KL Loss: 17.058453
Y Loss: 0.386536
T Loss: 10.505480
X Loss: -49.943282
Epoch 1599 
Overall Loss: -22.125413
Rec Loss: -39.240822
KL Loss: 17.115409
Y Loss: 0.393812
T Loss: 10.469629
X Loss: -49.907358
Epoch 1649 
Overall Loss: -22.459337
Rec Loss: -39.463227
KL Loss: 17.003889
Y Loss: 0.391909
T Loss: 10.456510
X Loss: -50.115691
Epoch 1699 
Overall Loss: -22.565938
Rec Loss: -39.624473
KL Loss: 17.058535
Y Loss: 0.402229
T Loss: 10.446621
X Loss: -50.272206
Epoch 1749 
Overall Loss: -23.000904
Rec Loss: -40.217793
KL Loss: 17.216889
Y Loss: 0.395708
T Loss: 10.421830
X Loss: -50.837477
Epoch 1799 
Overall Loss: -22.665522
Rec Loss: -39.849867
KL Loss: 17.184344
Y Loss: 0.415986
T Loss: 10.402053
X Loss: -50.459912
Epoch 1849 
Overall Loss: -22.932599
Rec Loss: -40.301985
KL Loss: 17.369386
Y Loss: 0.401589
T Loss: 10.376844
X Loss: -50.879624
Epoch 1899 
Overall Loss: -23.210292
Rec Loss: -40.550911
KL Loss: 17.340620
Y Loss: 0.410168
T Loss: 10.358700
X Loss: -51.114695
Epoch 1949 
Overall Loss: -23.581737
Rec Loss: -40.919570
KL Loss: 17.337833
Y Loss: 0.410528
T Loss: 10.348043
X Loss: -51.472877
Epoch 1999 
Overall Loss: -23.616826
Rec Loss: -41.081718
KL Loss: 17.464892
Y Loss: 0.416866
T Loss: 10.326073
X Loss: -51.616225
Epoch 2049 
Overall Loss: -23.760043
Rec Loss: -41.320791
KL Loss: 17.560748
Y Loss: 0.402641
T Loss: 10.309760
X Loss: -51.831872
Epoch 2099 
Overall Loss: -23.981677
Rec Loss: -41.389277
KL Loss: 17.407601
Y Loss: 0.437141
T Loss: 10.316577
X Loss: -51.924424
Epoch 2149 
Overall Loss: -23.808571
Rec Loss: -41.374390
KL Loss: 17.565820
Y Loss: 0.416448
T Loss: 10.312499
X Loss: -51.895113
Epoch 2199 
Overall Loss: -24.034336
Rec Loss: -41.666138
KL Loss: 17.631802
Y Loss: 0.419761
T Loss: 10.289328
X Loss: -52.165345
Epoch 2249 
Overall Loss: -24.270059
Rec Loss: -41.917385
KL Loss: 17.647326
Y Loss: 0.424816
T Loss: 10.274383
X Loss: -52.404177
Epoch 2299 
Overall Loss: -23.787087
Rec Loss: -41.543227
KL Loss: 17.756139
Y Loss: 0.418403
T Loss: 10.252063
X Loss: -52.004490
Epoch 2349 
Overall Loss: -24.667127
Rec Loss: -42.413709
KL Loss: 17.746582
Y Loss: 0.412082
T Loss: 10.237197
X Loss: -52.856948
Epoch 2399 
Overall Loss: -24.584962
Rec Loss: -42.064790
KL Loss: 17.479828
Y Loss: 0.454084
T Loss: 10.249403
X Loss: -52.541234
Epoch 2449 
Overall Loss: -24.951829
Rec Loss: -42.723672
KL Loss: 17.771843
Y Loss: 0.441866
T Loss: 10.233013
X Loss: -53.177619
Epoch 2499 
Overall Loss: -24.584802
Rec Loss: -42.270878
KL Loss: 17.686077
Y Loss: 0.459109
T Loss: 10.251093
X Loss: -52.751525
Epoch 2549 
Overall Loss: -24.328611
Rec Loss: -42.234259
KL Loss: 17.905648
Y Loss: 0.453132
T Loss: 10.207766
X Loss: -52.668592
Epoch 2599 
Overall Loss: -25.255904
Rec Loss: -43.109061
KL Loss: 17.853157
Y Loss: 0.442679
T Loss: 10.220319
X Loss: -53.550718
Epoch 2649 
Overall Loss: -25.437995
Rec Loss: -43.374684
KL Loss: 17.936690
Y Loss: 0.438050
T Loss: 10.201439
X Loss: -53.795150
Epoch 2699 
Overall Loss: -25.038845
Rec Loss: -42.853444
KL Loss: 17.814599
Y Loss: 0.470630
T Loss: 10.206364
X Loss: -53.295121
Epoch 2749 
Overall Loss: -24.808443
Rec Loss: -42.760927
KL Loss: 17.952484
Y Loss: 0.464986
T Loss: 10.190591
X Loss: -53.184011
Epoch 2799 
Overall Loss: -25.008277
Rec Loss: -42.916615
KL Loss: 17.908339
Y Loss: 0.473270
T Loss: 10.197054
X Loss: -53.350304
Epoch 2849 
Overall Loss: -25.483403
Rec Loss: -43.614427
KL Loss: 18.131024
Y Loss: 0.454450
T Loss: 10.174029
X Loss: -54.015681
Epoch 2899 
Overall Loss: -25.451314
Rec Loss: -43.539651
KL Loss: 18.088338
Y Loss: 0.465232
T Loss: 10.179140
X Loss: -53.951407
Epoch 2949 
Overall Loss: -25.752588
Rec Loss: -43.767170
KL Loss: 18.014583
Y Loss: 0.480367
T Loss: 10.174008
X Loss: -54.181363
Epoch 2999 
Overall Loss: -25.948531
Rec Loss: -43.911281
KL Loss: 17.962749
Y Loss: 0.496306
T Loss: 10.180161
X Loss: -54.339596
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.580410
Epoch 99
Rec Loss: 1.560443
Epoch 149
Rec Loss: 1.551029
Epoch 199
Rec Loss: 1.551689
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.002460
Epoch 99
Rec Loss: 0.001360
Epoch 149
Rec Loss: 0.000981
Epoch 199
Rec Loss: 0.000844
Epoch 249
Rec Loss: 0.000637
Epoch 299
Rec Loss: 0.000568
Epoch 349
Rec Loss: 0.000688
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.314214
Insample Error 3.066895
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.556990
Epoch 99 
Prediction Loss: 0.164898
Epoch 149 
Prediction Loss: 0.088503
Epoch 199 
Prediction Loss: 0.059233
Epoch 249 
Prediction Loss: 0.041679
Epoch 299 
Prediction Loss: 0.032728
Epoch 349 
Prediction Loss: 0.028118
Epoch 399 
Prediction Loss: 0.022249
Epoch 449 
Prediction Loss: 0.018853
Epoch 499 
Prediction Loss: 0.016738
Epoch 549 
Prediction Loss: 0.014018
Epoch 599 
Prediction Loss: 0.012757
Epoch 649 
Prediction Loss: 0.014334
Epoch 699 
Prediction Loss: 0.011128
Epoch 749 
Prediction Loss: 0.010384
Epoch 799 
Prediction Loss: 0.011263
Epoch 849 
Prediction Loss: 0.010200
Epoch 899 
Prediction Loss: 0.008331
Epoch 949 
Prediction Loss: 0.008273
Epoch 999 
Prediction Loss: 0.008904
Epoch 1049 
Prediction Loss: 0.007257
Epoch 1099 
Prediction Loss: 0.006472
Epoch 1149 
Prediction Loss: 0.006529
Epoch 1199 
Prediction Loss: 0.010293
Epoch 1249 
Prediction Loss: 0.005956
Epoch 1299 
Prediction Loss: 0.006419
Epoch 1349 
Prediction Loss: 0.006218
Epoch 1399 
Prediction Loss: 0.005407
Epoch 1449 
Prediction Loss: 0.006122
Epoch 1499 
Prediction Loss: 0.005690
Epoch 1549 
Prediction Loss: 0.004947
Epoch 1599 
Prediction Loss: 0.004541
Epoch 1649 
Prediction Loss: 0.004508
Epoch 1699 
Prediction Loss: 0.005009
Epoch 1749 
Prediction Loss: 0.004445
Epoch 1799 
Prediction Loss: 0.007810
Epoch 1849 
Prediction Loss: 0.006992
Epoch 1899 
Prediction Loss: 0.003820
Epoch 1949 
Prediction Loss: 0.004210
Epoch 1999 
Prediction Loss: 0.004601
Epoch 2049 
Prediction Loss: 0.007882
Epoch 2099 
Prediction Loss: 0.003481
Epoch 2149 
Prediction Loss: 0.003500
Epoch 2199 
Prediction Loss: 0.007241
Epoch 2249 
Prediction Loss: 0.003253
Epoch 2299 
Prediction Loss: 0.003091
Epoch 2349 
Prediction Loss: 0.003420
Epoch 2399 
Prediction Loss: 0.003269
Epoch 2449 
Prediction Loss: 0.003741
Epoch 2499 
Prediction Loss: 0.002830
Epoch 2549 
Prediction Loss: 0.003958
Epoch 2599 
Prediction Loss: 0.003679
Epoch 2649 
Prediction Loss: 0.004839
Epoch 2699 
Prediction Loss: 0.003000
Epoch 2749 
Prediction Loss: 0.003819
Epoch 2799 
Prediction Loss: 0.002709
Epoch 2849 
Prediction Loss: 0.004264
Epoch 2899 
Prediction Loss: 0.003258
Epoch 2949 
Prediction Loss: 0.005575
Epoch 2999 
Prediction Loss: 0.002483
Epoch 3049 
Prediction Loss: 0.007563
Epoch 3099 
Prediction Loss: 0.002443
Epoch 3149 
Prediction Loss: 0.002957
Epoch 3199 
Prediction Loss: 0.003086
Epoch 3249 
Prediction Loss: 0.003920
Epoch 3299 
Prediction Loss: 0.002847
Epoch 3349 
Prediction Loss: 0.002936
Epoch 3399 
Prediction Loss: 0.002942
Epoch 3449 
Prediction Loss: 0.003314
Epoch 3499 
Prediction Loss: 0.002257
Epoch 3549 
Prediction Loss: 0.003826
Epoch 3599 
Prediction Loss: 0.003935
Epoch 3649 
Prediction Loss: 0.002929
Epoch 3699 
Prediction Loss: 0.002098
Epoch 3749 
Prediction Loss: 0.002273
Epoch 3799 
Prediction Loss: 0.002524
Epoch 3849 
Prediction Loss: 0.002908
Epoch 3899 
Prediction Loss: 0.003167
Epoch 3949 
Prediction Loss: 0.002517
Epoch 3999 
Prediction Loss: 0.001933
Epoch 4049 
Prediction Loss: 0.003858
Epoch 4099 
Prediction Loss: 0.003059
Epoch 4149 
Prediction Loss: 0.003107
Epoch 4199 
Prediction Loss: 0.002792
Epoch 4249 
Prediction Loss: 0.003528
Epoch 4299 
Prediction Loss: 0.002221
Epoch 4349 
Prediction Loss: 0.002548
Epoch 4399 
Prediction Loss: 0.002682
Epoch 4449 
Prediction Loss: 0.001658
Epoch 4499 
Prediction Loss: 0.002185
Epoch 4549 
Prediction Loss: 0.002607
Epoch 4599 
Prediction Loss: 0.003491
Epoch 4649 
Prediction Loss: 0.001941
Epoch 4699 
Prediction Loss: 0.002676
Epoch 4749 
Prediction Loss: 0.002843
Epoch 4799 
Prediction Loss: 0.002151
Epoch 4849 
Prediction Loss: 0.003309
Epoch 4899 
Prediction Loss: 0.001856
Epoch 4949 
Prediction Loss: 0.002194
Epoch 4999 
Prediction Loss: 0.005199
Epoch 5049 
Prediction Loss: 0.002290
Epoch 5099 
Prediction Loss: 0.001867
Epoch 5149 
Prediction Loss: 0.003076
Epoch 5199 
Prediction Loss: 0.002058
Epoch 5249 
Prediction Loss: 0.002163
Epoch 5299 
Prediction Loss: 0.001890
Epoch 5349 
Prediction Loss: 0.001522
Epoch 5399 
Prediction Loss: 0.002220
Epoch 5449 
Prediction Loss: 0.001692
Epoch 5499 
Prediction Loss: 0.002663
Epoch 5549 
Prediction Loss: 0.001650
Epoch 5599 
Prediction Loss: 0.001818
Epoch 5649 
Prediction Loss: 0.002107
Epoch 5699 
Prediction Loss: 0.002097
Epoch 5749 
Prediction Loss: 0.002164
Epoch 5799 
Prediction Loss: 0.005564
Epoch 5849 
Prediction Loss: 0.006571
Epoch 5899 
Prediction Loss: 0.002006
Epoch 5949 
Prediction Loss: 0.001844
Epoch 5999 
Prediction Loss: 0.001697
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.045452
Insample Error 0.209763
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.699429
Rec Loss: 10.431207
KL Loss: 0.268222
Y Loss: 0.600886
T Loss: 10.130764
Epoch 99 
Overall Loss: 10.436419
Rec Loss: 10.293736
KL Loss: 0.142683
Y Loss: 0.247171
T Loss: 10.170150
Epoch 149 
Overall Loss: 10.360907
Rec Loss: 10.251081
KL Loss: 0.109826
Y Loss: 0.157236
T Loss: 10.172463
Epoch 199 
Overall Loss: 10.327052
Rec Loss: 10.230513
KL Loss: 0.096539
Y Loss: 0.120397
T Loss: 10.170314
Epoch 249 
Overall Loss: 10.313078
Rec Loss: 10.228823
KL Loss: 0.084256
Y Loss: 0.099739
T Loss: 10.178953
Epoch 299 
Overall Loss: 10.300966
Rec Loss: 10.221724
KL Loss: 0.079242
Y Loss: 0.084938
T Loss: 10.179254
Epoch 349 
Overall Loss: 10.278999
Rec Loss: 10.209636
KL Loss: 0.069363
Y Loss: 0.073466
T Loss: 10.172903
Epoch 399 
Overall Loss: 10.273140
Rec Loss: 10.203720
KL Loss: 0.069419
Y Loss: 0.068859
T Loss: 10.169291
Epoch 449 
Overall Loss: 10.257935
Rec Loss: 10.200035
KL Loss: 0.057900
Y Loss: 0.061358
T Loss: 10.169356
Epoch 499 
Overall Loss: 10.252618
Rec Loss: 10.193811
KL Loss: 0.058807
Y Loss: 0.059772
T Loss: 10.163925
Epoch 549 
Overall Loss: 10.242523
Rec Loss: 10.187587
KL Loss: 0.054936
Y Loss: 0.051452
T Loss: 10.161861
Epoch 599 
Overall Loss: 10.241611
Rec Loss: 10.188930
KL Loss: 0.052681
Y Loss: 0.048941
T Loss: 10.164460
Epoch 649 
Overall Loss: 10.226565
Rec Loss: 10.178020
KL Loss: 0.048545
Y Loss: 0.046084
T Loss: 10.154978
Epoch 699 
Overall Loss: 10.237246
Rec Loss: 10.185396
KL Loss: 0.051851
Y Loss: 0.047197
T Loss: 10.161797
Epoch 749 
Overall Loss: 10.224831
Rec Loss: 10.172746
KL Loss: 0.052085
Y Loss: 0.041954
T Loss: 10.151768
Epoch 799 
Overall Loss: 10.215069
Rec Loss: 10.170612
KL Loss: 0.044457
Y Loss: 0.040143
T Loss: 10.150541
Epoch 849 
Overall Loss: 10.212258
Rec Loss: 10.167426
KL Loss: 0.044832
Y Loss: 0.038187
T Loss: 10.148332
Epoch 899 
Overall Loss: 10.205744
Rec Loss: 10.160050
KL Loss: 0.045694
Y Loss: 0.038604
T Loss: 10.140748
Epoch 949 
Overall Loss: 10.208918
Rec Loss: 10.166735
KL Loss: 0.042183
Y Loss: 0.045153
T Loss: 10.144158
Epoch 999 
Overall Loss: 10.203782
Rec Loss: 10.161472
KL Loss: 0.042310
Y Loss: 0.034943
T Loss: 10.144001
Epoch 1049 
Overall Loss: 10.200339
Rec Loss: 10.158682
KL Loss: 0.041658
Y Loss: 0.046294
T Loss: 10.135535
Epoch 1099 
Overall Loss: 10.196066
Rec Loss: 10.154952
KL Loss: 0.041114
Y Loss: 0.034102
T Loss: 10.137901
Epoch 1149 
Overall Loss: 10.187025
Rec Loss: 10.146728
KL Loss: 0.040297
Y Loss: 0.035178
T Loss: 10.129139
Epoch 1199 
Overall Loss: 10.179117
Rec Loss: 10.140491
KL Loss: 0.038626
Y Loss: 0.030433
T Loss: 10.125275
Epoch 1249 
Overall Loss: 10.183085
Rec Loss: 10.142085
KL Loss: 0.041000
Y Loss: 0.033993
T Loss: 10.125089
Epoch 1299 
Overall Loss: 10.197847
Rec Loss: 10.146609
KL Loss: 0.051239
Y Loss: 0.033541
T Loss: 10.129838
Epoch 1349 
Overall Loss: 10.176329
Rec Loss: 10.140037
KL Loss: 0.036293
Y Loss: 0.033020
T Loss: 10.123527
Epoch 1399 
Overall Loss: 10.170104
Rec Loss: 10.137443
KL Loss: 0.032661
Y Loss: 0.031538
T Loss: 10.121674
Epoch 1449 
Overall Loss: 10.161037
Rec Loss: 10.129125
KL Loss: 0.031913
Y Loss: 0.027136
T Loss: 10.115557
Epoch 1499 
Overall Loss: 10.161071
Rec Loss: 10.126871
KL Loss: 0.034199
Y Loss: 0.030538
T Loss: 10.111602
Epoch 1549 
Overall Loss: 10.155295
Rec Loss: 10.125656
KL Loss: 0.029639
Y Loss: 0.029437
T Loss: 10.110937
Epoch 1599 
Overall Loss: 10.157842
Rec Loss: 10.126179
KL Loss: 0.031663
Y Loss: 0.026703
T Loss: 10.112827
Epoch 1649 
Overall Loss: 10.158691
Rec Loss: 10.124173
KL Loss: 0.034518
Y Loss: 0.028239
T Loss: 10.110053
Epoch 1699 
Overall Loss: 10.152811
Rec Loss: 10.122159
KL Loss: 0.030652
Y Loss: 0.032771
T Loss: 10.105773
Epoch 1749 
Overall Loss: 10.185844
Rec Loss: 10.148396
KL Loss: 0.037448
Y Loss: 0.069044
T Loss: 10.113874
Epoch 1799 
Overall Loss: 10.146715
Rec Loss: 10.112015
KL Loss: 0.034700
Y Loss: 0.026019
T Loss: 10.099005
Epoch 1849 
Overall Loss: 10.140970
Rec Loss: 10.113693
KL Loss: 0.027277
Y Loss: 0.026010
T Loss: 10.100688
Epoch 1899 
Overall Loss: 10.171901
Rec Loss: 10.116095
KL Loss: 0.055805
Y Loss: 0.028276
T Loss: 10.101957
Epoch 1949 
Overall Loss: 10.189368
Rec Loss: 10.114130
KL Loss: 0.075238
Y Loss: 0.030022
T Loss: 10.099118
Epoch 1999 
Overall Loss: 10.133956
Rec Loss: 10.105513
KL Loss: 0.028443
Y Loss: 0.025017
T Loss: 10.093005
Epoch 2049 
Overall Loss: 10.132457
Rec Loss: 10.104343
KL Loss: 0.028114
Y Loss: 0.022914
T Loss: 10.092887
Epoch 2099 
Overall Loss: 10.127751
Rec Loss: 10.102426
KL Loss: 0.025324
Y Loss: 0.022433
T Loss: 10.091210
Epoch 2149 
Overall Loss: 10.129859
Rec Loss: 10.099974
KL Loss: 0.029885
Y Loss: 0.022997
T Loss: 10.088476
Epoch 2199 
Overall Loss: 10.125000
Rec Loss: 10.098893
KL Loss: 0.026107
Y Loss: 0.023541
T Loss: 10.087122
Epoch 2249 
Overall Loss: 10.152447
Rec Loss: 10.098025
KL Loss: 0.054422
Y Loss: 0.026861
T Loss: 10.084595
Epoch 2299 
Overall Loss: 10.119262
Rec Loss: 10.094136
KL Loss: 0.025126
Y Loss: 0.022458
T Loss: 10.082907
Epoch 2349 
Overall Loss: 10.127671
Rec Loss: 10.097815
KL Loss: 0.029856
Y Loss: 0.032316
T Loss: 10.081657
Epoch 2399 
Overall Loss: 10.115444
Rec Loss: 10.089939
KL Loss: 0.025506
Y Loss: 0.021519
T Loss: 10.079179
Epoch 2449 
Overall Loss: 10.118609
Rec Loss: 10.090763
KL Loss: 0.027847
Y Loss: 0.025175
T Loss: 10.078175
Epoch 2499 
Overall Loss: 10.110653
Rec Loss: 10.087752
KL Loss: 0.022901
Y Loss: 0.022838
T Loss: 10.076333
Epoch 2549 
Overall Loss: 10.108127
Rec Loss: 10.085041
KL Loss: 0.023085
Y Loss: 0.021947
T Loss: 10.074067
Epoch 2599 
Overall Loss: 10.124392
Rec Loss: 10.086175
KL Loss: 0.038217
Y Loss: 0.021459
T Loss: 10.075445
Epoch 2649 
Overall Loss: 10.105372
Rec Loss: 10.082351
KL Loss: 0.023022
Y Loss: 0.020870
T Loss: 10.071915
Epoch 2699 
Overall Loss: 10.104293
Rec Loss: 10.080211
KL Loss: 0.024083
Y Loss: 0.021538
T Loss: 10.069442
Epoch 2749 
Overall Loss: 10.121413
Rec Loss: 10.092963
KL Loss: 0.028451
Y Loss: 0.036301
T Loss: 10.074812
Epoch 2799 
Overall Loss: 10.104186
Rec Loss: 10.081008
KL Loss: 0.023178
Y Loss: 0.022971
T Loss: 10.069523
Epoch 2849 
Overall Loss: 10.105986
Rec Loss: 10.081084
KL Loss: 0.024902
Y Loss: 0.020241
T Loss: 10.070963
Epoch 2899 
Overall Loss: 10.109774
Rec Loss: 10.079796
KL Loss: 0.029978
Y Loss: 0.031516
T Loss: 10.064038
Epoch 2949 
Overall Loss: 10.097542
Rec Loss: 10.074120
KL Loss: 0.023422
Y Loss: 0.018782
T Loss: 10.064729
Epoch 2999 
Overall Loss: 10.099083
Rec Loss: 10.076979
KL Loss: 0.022105
Y Loss: 0.022720
T Loss: 10.065619
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.021096
Epoch 99
Rec Loss: 0.017578
Epoch 149
Rec Loss: 0.016645
Epoch 199
Rec Loss: 0.015745
Epoch 249
Rec Loss: 0.015401
Epoch 299
Rec Loss: 0.015027
Epoch 349
Rec Loss: 0.014729
Epoch 399
Rec Loss: 0.014770
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.630186
Epoch 99
Rec Loss: 9.502541
Epoch 149
Rec Loss: 9.529109
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.071250
Insample Error: 0.353398
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 20.035144
Rec Loss: 15.977436
KL Loss: 4.057709
Y Loss: 8.215455
T Loss: 13.274454
X Loss: -1.404746
Epoch 99 
Overall Loss: 2.792006
Rec Loss: -7.558751
KL Loss: 10.350757
Y Loss: 3.437363
T Loss: 13.068739
X Loss: -22.346171
Epoch 149 
Overall Loss: -2.277086
Rec Loss: -13.763981
KL Loss: 11.486895
Y Loss: 2.381434
T Loss: 13.004115
X Loss: -27.958814
Epoch 199 
Overall Loss: -5.301329
Rec Loss: -17.797296
KL Loss: 12.495967
Y Loss: 1.721985
T Loss: 12.925537
X Loss: -31.583826
Epoch 249 
Overall Loss: -7.377235
Rec Loss: -20.697879
KL Loss: 13.320644
Y Loss: 1.218951
T Loss: 12.830077
X Loss: -34.137432
Epoch 299 
Overall Loss: -8.878294
Rec Loss: -22.779729
KL Loss: 13.901436
Y Loss: 1.019244
T Loss: 12.704105
X Loss: -35.993455
Epoch 349 
Overall Loss: -10.182025
Rec Loss: -24.473687
KL Loss: 14.291662
Y Loss: 0.920580
T Loss: 12.598713
X Loss: -37.532690
Epoch 399 
Overall Loss: -11.147302
Rec Loss: -25.849797
KL Loss: 14.702495
Y Loss: 0.851272
T Loss: 12.497863
X Loss: -38.773295
Epoch 449 
Overall Loss: -11.824294
Rec Loss: -26.755973
KL Loss: 14.931680
Y Loss: 0.862735
T Loss: 12.400261
X Loss: -39.587603
Epoch 499 
Overall Loss: -12.499300
Rec Loss: -27.688377
KL Loss: 15.189076
Y Loss: 0.807613
T Loss: 12.291284
X Loss: -40.383466
Epoch 549 
Overall Loss: -13.159485
Rec Loss: -28.571812
KL Loss: 15.412326
Y Loss: 0.780917
T Loss: 12.148741
X Loss: -41.111012
Epoch 599 
Overall Loss: -13.572160
Rec Loss: -29.192913
KL Loss: 15.620753
Y Loss: 0.756693
T Loss: 12.007789
X Loss: -41.579049
Epoch 649 
Overall Loss: -14.100015
Rec Loss: -29.945447
KL Loss: 15.845432
Y Loss: 0.783446
T Loss: 11.866880
X Loss: -42.204050
Epoch 699 
Overall Loss: -14.963561
Rec Loss: -31.046988
KL Loss: 16.083427
Y Loss: 0.782797
T Loss: 11.693061
X Loss: -43.131448
Epoch 749 
Overall Loss: -15.502658
Rec Loss: -31.718493
KL Loss: 16.215834
Y Loss: 0.759979
T Loss: 11.539811
X Loss: -43.638293
Epoch 799 
Overall Loss: -16.013184
Rec Loss: -32.390965
KL Loss: 16.377781
Y Loss: 0.738098
T Loss: 11.408981
X Loss: -44.168996
Epoch 849 
Overall Loss: -16.244920
Rec Loss: -32.709235
KL Loss: 16.464316
Y Loss: 0.736995
T Loss: 11.318759
X Loss: -44.396492
Epoch 899 
Overall Loss: -16.773514
Rec Loss: -33.330475
KL Loss: 16.556960
Y Loss: 0.758418
T Loss: 11.192365
X Loss: -44.902047
Epoch 949 
Overall Loss: -17.335675
Rec Loss: -33.990297
KL Loss: 16.654622
Y Loss: 0.731704
T Loss: 11.118566
X Loss: -45.474716
Epoch 999 
Overall Loss: -17.748457
Rec Loss: -34.393846
KL Loss: 16.645389
Y Loss: 0.726977
T Loss: 11.035588
X Loss: -45.792923
Epoch 1049 
Overall Loss: -18.050128
Rec Loss: -34.891855
KL Loss: 16.841728
Y Loss: 0.704274
T Loss: 10.929211
X Loss: -46.173204
Epoch 1099 
Overall Loss: -18.437959
Rec Loss: -35.355165
KL Loss: 16.917206
Y Loss: 0.706118
T Loss: 10.862896
X Loss: -46.571120
Epoch 1149 
Overall Loss: -18.787233
Rec Loss: -35.808604
KL Loss: 17.021371
Y Loss: 0.696323
T Loss: 10.801860
X Loss: -46.958626
Epoch 1199 
Overall Loss: -19.300093
Rec Loss: -36.168235
KL Loss: 16.868142
Y Loss: 0.685269
T Loss: 10.755288
X Loss: -47.266158
Epoch 1249 
Overall Loss: -19.657092
Rec Loss: -36.638215
KL Loss: 16.981125
Y Loss: 0.697692
T Loss: 10.690988
X Loss: -47.678050
Epoch 1299 
Overall Loss: -19.888319
Rec Loss: -37.062545
KL Loss: 17.174226
Y Loss: 0.664930
T Loss: 10.613279
X Loss: -48.008289
Epoch 1349 
Overall Loss: -20.176737
Rec Loss: -37.403182
KL Loss: 17.226444
Y Loss: 0.675409
T Loss: 10.558816
X Loss: -48.299702
Epoch 1399 
Overall Loss: -20.379553
Rec Loss: -37.699056
KL Loss: 17.319502
Y Loss: 0.668180
T Loss: 10.527053
X Loss: -48.560199
Epoch 1449 
Overall Loss: -20.681199
Rec Loss: -38.025272
KL Loss: 17.344072
Y Loss: 0.658692
T Loss: 10.500790
X Loss: -48.855408
Epoch 1499 
Overall Loss: -20.862042
Rec Loss: -38.320421
KL Loss: 17.458378
Y Loss: 0.634370
T Loss: 10.459349
X Loss: -49.096954
Epoch 1549 
Overall Loss: -21.202545
Rec Loss: -38.787267
KL Loss: 17.584722
Y Loss: 0.638304
T Loss: 10.422136
X Loss: -49.528555
Epoch 1599 
Overall Loss: -21.441356
Rec Loss: -38.957510
KL Loss: 17.516153
Y Loss: 0.632979
T Loss: 10.397241
X Loss: -49.671240
Epoch 1649 
Overall Loss: -21.476574
Rec Loss: -39.017381
KL Loss: 17.540807
Y Loss: 0.642038
T Loss: 10.386893
X Loss: -49.725293
Epoch 1699 
Overall Loss: -21.829150
Rec Loss: -39.541028
KL Loss: 17.711879
Y Loss: 0.634540
T Loss: 10.358282
X Loss: -50.216581
Epoch 1749 
Overall Loss: -22.208934
Rec Loss: -39.923224
KL Loss: 17.714291
Y Loss: 0.601058
T Loss: 10.325580
X Loss: -50.549332
Epoch 1799 
Overall Loss: -22.286121
Rec Loss: -40.118704
KL Loss: 17.832584
Y Loss: 0.593986
T Loss: 10.319003
X Loss: -50.734701
Epoch 1849 
Overall Loss: -22.423214
Rec Loss: -40.329343
KL Loss: 17.906130
Y Loss: 0.604984
T Loss: 10.299155
X Loss: -50.930989
Epoch 1899 
Overall Loss: -22.470033
Rec Loss: -40.341383
KL Loss: 17.871350
Y Loss: 0.595985
T Loss: 10.294177
X Loss: -50.933553
Epoch 1949 
Overall Loss: -22.463428
Rec Loss: -40.431347
KL Loss: 17.967919
Y Loss: 0.596609
T Loss: 10.279334
X Loss: -51.008985
Epoch 1999 
Overall Loss: -22.990198
Rec Loss: -40.965283
KL Loss: 17.975084
Y Loss: 0.590745
T Loss: 10.267859
X Loss: -51.528515
Epoch 2049 
Overall Loss: -23.114853
Rec Loss: -40.912256
KL Loss: 17.797405
Y Loss: 0.577104
T Loss: 10.292934
X Loss: -51.493742
Epoch 2099 
Overall Loss: -23.341149
Rec Loss: -41.368926
KL Loss: 18.027778
Y Loss: 0.576256
T Loss: 10.256228
X Loss: -51.913283
Epoch 2149 
Overall Loss: -23.471132
Rec Loss: -41.562811
KL Loss: 18.091678
Y Loss: 0.563230
T Loss: 10.231781
X Loss: -52.076207
Epoch 2199 
Overall Loss: -23.375101
Rec Loss: -41.427774
KL Loss: 18.052671
Y Loss: 0.572723
T Loss: 10.248899
X Loss: -51.963034
Epoch 2249 
Overall Loss: -23.822684
Rec Loss: -41.876838
KL Loss: 18.054155
Y Loss: 0.548451
T Loss: 10.229164
X Loss: -52.380227
Epoch 2299 
Overall Loss: -23.646548
Rec Loss: -41.716974
KL Loss: 18.070427
Y Loss: 0.573443
T Loss: 10.228629
X Loss: -52.232325
Epoch 2349 
Overall Loss: -23.994624
Rec Loss: -42.182497
KL Loss: 18.187872
Y Loss: 0.555912
T Loss: 10.231333
X Loss: -52.691785
Epoch 2399 
Overall Loss: -24.167829
Rec Loss: -42.200050
KL Loss: 18.032221
Y Loss: 0.554202
T Loss: 10.236251
X Loss: -52.713402
Epoch 2449 
Overall Loss: -24.274761
Rec Loss: -42.492118
KL Loss: 18.217358
Y Loss: 0.528655
T Loss: 10.223902
X Loss: -52.980348
Epoch 2499 
Overall Loss: -24.446339
Rec Loss: -42.663049
KL Loss: 18.216710
Y Loss: 0.525443
T Loss: 10.204040
X Loss: -53.129810
Epoch 2549 
Overall Loss: -23.959460
Rec Loss: -42.131580
KL Loss: 18.172120
Y Loss: 0.530639
T Loss: 10.234955
X Loss: -52.631856
Epoch 2599 
Overall Loss: -24.625189
Rec Loss: -42.944126
KL Loss: 18.318937
Y Loss: 0.508266
T Loss: 10.216120
X Loss: -53.414379
Epoch 2649 
Overall Loss: -24.293930
Rec Loss: -42.571979
KL Loss: 18.278049
Y Loss: 0.507484
T Loss: 10.212640
X Loss: -53.038361
Epoch 2699 
Overall Loss: -24.445581
Rec Loss: -42.669147
KL Loss: 18.223566
Y Loss: 0.519010
T Loss: 10.201157
X Loss: -53.129808
Epoch 2749 
Overall Loss: -24.939593
Rec Loss: -43.206975
KL Loss: 18.267383
Y Loss: 0.509034
T Loss: 10.206599
X Loss: -53.668090
Epoch 2799 
Overall Loss: -24.879998
Rec Loss: -43.211445
KL Loss: 18.331447
Y Loss: 0.502956
T Loss: 10.203647
X Loss: -53.666570
Epoch 2849 
Overall Loss: -25.032063
Rec Loss: -43.404701
KL Loss: 18.372639
Y Loss: 0.498801
T Loss: 10.204891
X Loss: -53.858993
Epoch 2899 
Overall Loss: -24.904772
Rec Loss: -43.230024
KL Loss: 18.325252
Y Loss: 0.512328
T Loss: 10.200407
X Loss: -53.686593
Epoch 2949 
Overall Loss: -25.295376
Rec Loss: -43.753536
KL Loss: 18.458162
Y Loss: 0.487691
T Loss: 10.198490
X Loss: -54.195874
Epoch 2999 
Overall Loss: -25.467028
Rec Loss: -43.858519
KL Loss: 18.391490
Y Loss: 0.479558
T Loss: 10.198038
X Loss: -54.296336
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.568701
Epoch 99
Rec Loss: 1.550035
Epoch 149
Rec Loss: 1.528972
Epoch 199
Rec Loss: 1.525856
Epoch 249
Rec Loss: 1.524695
Epoch 299
Rec Loss: 1.513369
Epoch 349
Rec Loss: 1.517186
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.003734
Epoch 99
Rec Loss: 0.001824
Epoch 149
Rec Loss: 0.001445
Epoch 199
Rec Loss: 0.001040
Epoch 249
Rec Loss: 0.000916
Epoch 299
Rec Loss: 0.001149
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.330999
Insample Error 2.972295
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.447879
Epoch 99 
Prediction Loss: 0.171373
Epoch 149 
Prediction Loss: 0.099601
Epoch 199 
Prediction Loss: 0.065771
Epoch 249 
Prediction Loss: 0.049278
Epoch 299 
Prediction Loss: 0.040850
Epoch 349 
Prediction Loss: 0.033620
Epoch 399 
Prediction Loss: 0.030173
Epoch 449 
Prediction Loss: 0.024399
Epoch 499 
Prediction Loss: 0.021174
Epoch 549 
Prediction Loss: 0.020052
Epoch 599 
Prediction Loss: 0.018055
Epoch 649 
Prediction Loss: 0.014534
Epoch 699 
Prediction Loss: 0.015983
Epoch 749 
Prediction Loss: 0.012984
Epoch 799 
Prediction Loss: 0.011058
Epoch 849 
Prediction Loss: 0.010135
Epoch 899 
Prediction Loss: 0.012140
Epoch 949 
Prediction Loss: 0.011415
Epoch 999 
Prediction Loss: 0.012499
Epoch 1049 
Prediction Loss: 0.009249
Epoch 1099 
Prediction Loss: 0.008851
Epoch 1149 
Prediction Loss: 0.009351
Epoch 1199 
Prediction Loss: 0.009085
Epoch 1249 
Prediction Loss: 0.007213
Epoch 1299 
Prediction Loss: 0.008023
Epoch 1349 
Prediction Loss: 0.006946
Epoch 1399 
Prediction Loss: 0.006736
Epoch 1449 
Prediction Loss: 0.011366
Epoch 1499 
Prediction Loss: 0.008283
Epoch 1549 
Prediction Loss: 0.007957
Epoch 1599 
Prediction Loss: 0.008266
Epoch 1649 
Prediction Loss: 0.006556
Epoch 1699 
Prediction Loss: 0.006133
Epoch 1749 
Prediction Loss: 0.006419
Epoch 1799 
Prediction Loss: 0.006117
Epoch 1849 
Prediction Loss: 0.006391
Epoch 1899 
Prediction Loss: 0.005463
Epoch 1949 
Prediction Loss: 0.008841
Epoch 1999 
Prediction Loss: 0.007401
Epoch 2049 
Prediction Loss: 0.004882
Epoch 2099 
Prediction Loss: 0.005371
Epoch 2149 
Prediction Loss: 0.005088
Epoch 2199 
Prediction Loss: 0.005190
Epoch 2249 
Prediction Loss: 0.004787
Epoch 2299 
Prediction Loss: 0.005569
Epoch 2349 
Prediction Loss: 0.005526
Epoch 2399 
Prediction Loss: 0.005441
Epoch 2449 
Prediction Loss: 0.007250
Epoch 2499 
Prediction Loss: 0.006112
Epoch 2549 
Prediction Loss: 0.005008
Epoch 2599 
Prediction Loss: 0.004267
Epoch 2649 
Prediction Loss: 0.006179
Epoch 2699 
Prediction Loss: 0.004748
Epoch 2749 
Prediction Loss: 0.004720
Epoch 2799 
Prediction Loss: 0.004716
Epoch 2849 
Prediction Loss: 0.007341
Epoch 2899 
Prediction Loss: 0.014634
Epoch 2949 
Prediction Loss: 0.005077
Epoch 2999 
Prediction Loss: 0.004522
Epoch 3049 
Prediction Loss: 0.003619
Epoch 3099 
Prediction Loss: 0.005961
Epoch 3149 
Prediction Loss: 0.006722
Epoch 3199 
Prediction Loss: 0.005657
Epoch 3249 
Prediction Loss: 0.003659
Epoch 3299 
Prediction Loss: 0.003854
Epoch 3349 
Prediction Loss: 0.004860
Epoch 3399 
Prediction Loss: 0.005786
Epoch 3449 
Prediction Loss: 0.003923
Epoch 3499 
Prediction Loss: 0.006846
Epoch 3549 
Prediction Loss: 0.005430
Epoch 3599 
Prediction Loss: 0.003806
Epoch 3649 
Prediction Loss: 0.003827
Epoch 3699 
Prediction Loss: 0.004210
Epoch 3749 
Prediction Loss: 0.003462
Epoch 3799 
Prediction Loss: 0.003834
Epoch 3849 
Prediction Loss: 0.005237
Epoch 3899 
Prediction Loss: 0.006824
Epoch 3949 
Prediction Loss: 0.005409
Epoch 3999 
Prediction Loss: 0.006338
Epoch 4049 
Prediction Loss: 0.004595
Epoch 4099 
Prediction Loss: 0.004148
Epoch 4149 
Prediction Loss: 0.003302
Epoch 4199 
Prediction Loss: 0.003511
Epoch 4249 
Prediction Loss: 0.005294
Epoch 4299 
Prediction Loss: 0.003730
Epoch 4349 
Prediction Loss: 0.004498
Epoch 4399 
Prediction Loss: 0.003900
Epoch 4449 
Prediction Loss: 0.005171
Epoch 4499 
Prediction Loss: 0.006324
Epoch 4549 
Prediction Loss: 0.004442
Epoch 4599 
Prediction Loss: 0.003088
Epoch 4649 
Prediction Loss: 0.003811
Epoch 4699 
Prediction Loss: 0.003283
Epoch 4749 
Prediction Loss: 0.005242
Epoch 4799 
Prediction Loss: 0.005442
Epoch 4849 
Prediction Loss: 0.003353
Epoch 4899 
Prediction Loss: 0.003332
Epoch 4949 
Prediction Loss: 0.003908
Epoch 4999 
Prediction Loss: 0.003183
Epoch 5049 
Prediction Loss: 0.003547
Epoch 5099 
Prediction Loss: 0.006010
Epoch 5149 
Prediction Loss: 0.003635
Epoch 5199 
Prediction Loss: 0.003885
Epoch 5249 
Prediction Loss: 0.007601
Epoch 5299 
Prediction Loss: 0.004278
Epoch 5349 
Prediction Loss: 0.002986
Epoch 5399 
Prediction Loss: 0.009513
Epoch 5449 
Prediction Loss: 0.003461
Epoch 5499 
Prediction Loss: 0.002585
Epoch 5549 
Prediction Loss: 0.005207
Epoch 5599 
Prediction Loss: 0.003609
Epoch 5649 
Prediction Loss: 0.002792
Epoch 5699 
Prediction Loss: 0.005951
Epoch 5749 
Prediction Loss: 0.003121
Epoch 5799 
Prediction Loss: 0.002570
Epoch 5849 
Prediction Loss: 0.003129
Epoch 5899 
Prediction Loss: 0.003100
Epoch 5949 
Prediction Loss: 0.003229
Epoch 5999 
Prediction Loss: 0.003345
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.066607
Insample Error 0.235585
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.726340
Rec Loss: 10.428949
KL Loss: 0.297391
Y Loss: 0.639114
T Loss: 10.109392
Epoch 99 
Overall Loss: 10.467532
Rec Loss: 10.313758
KL Loss: 0.153774
Y Loss: 0.327543
T Loss: 10.149987
Epoch 149 
Overall Loss: 10.380098
Rec Loss: 10.253579
KL Loss: 0.126518
Y Loss: 0.196745
T Loss: 10.155207
Epoch 199 
Overall Loss: 10.355261
Rec Loss: 10.238339
KL Loss: 0.116923
Y Loss: 0.158189
T Loss: 10.159244
Epoch 249 
Overall Loss: 10.318473
Rec Loss: 10.219223
KL Loss: 0.099250
Y Loss: 0.116610
T Loss: 10.160918
Epoch 299 
Overall Loss: 10.302033
Rec Loss: 10.207686
KL Loss: 0.094346
Y Loss: 0.101132
T Loss: 10.157121
Epoch 349 
Overall Loss: 10.290961
Rec Loss: 10.200494
KL Loss: 0.090466
Y Loss: 0.088660
T Loss: 10.156164
Epoch 399 
Overall Loss: 10.304308
Rec Loss: 10.205678
KL Loss: 0.098631
Y Loss: 0.084894
T Loss: 10.163231
Epoch 449 
Overall Loss: 10.264585
Rec Loss: 10.191262
KL Loss: 0.073323
Y Loss: 0.072760
T Loss: 10.154882
Epoch 499 
Overall Loss: 10.258249
Rec Loss: 10.184840
KL Loss: 0.073408
Y Loss: 0.066517
T Loss: 10.151582
Epoch 549 
Overall Loss: 10.254345
Rec Loss: 10.189555
KL Loss: 0.064790
Y Loss: 0.060748
T Loss: 10.159181
Epoch 599 
Overall Loss: 10.238501
Rec Loss: 10.176416
KL Loss: 0.062084
Y Loss: 0.059554
T Loss: 10.146639
Epoch 649 
Overall Loss: 10.243890
Rec Loss: 10.183464
KL Loss: 0.060426
Y Loss: 0.060367
T Loss: 10.153280
Epoch 699 
Overall Loss: 10.246077
Rec Loss: 10.185951
KL Loss: 0.060126
Y Loss: 0.056789
T Loss: 10.157557
Epoch 749 
Overall Loss: 10.228055
Rec Loss: 10.171070
KL Loss: 0.056985
Y Loss: 0.053781
T Loss: 10.144180
Epoch 799 
Overall Loss: 10.228646
Rec Loss: 10.171654
KL Loss: 0.056992
Y Loss: 0.052509
T Loss: 10.145400
Epoch 849 
Overall Loss: 10.228128
Rec Loss: 10.176557
KL Loss: 0.051571
Y Loss: 0.048073
T Loss: 10.152520
Epoch 899 
Overall Loss: 10.215311
Rec Loss: 10.165684
KL Loss: 0.049628
Y Loss: 0.045410
T Loss: 10.142978
Epoch 949 
Overall Loss: 10.214582
Rec Loss: 10.164430
KL Loss: 0.050152
Y Loss: 0.043873
T Loss: 10.142494
Epoch 999 
Overall Loss: 10.209977
Rec Loss: 10.163865
KL Loss: 0.046112
Y Loss: 0.048200
T Loss: 10.139765
Epoch 1049 
Overall Loss: 10.207386
Rec Loss: 10.162953
KL Loss: 0.044433
Y Loss: 0.046381
T Loss: 10.139762
Epoch 1099 
Overall Loss: 10.297445
Rec Loss: 10.171204
KL Loss: 0.126240
Y Loss: 0.059368
T Loss: 10.141521
Epoch 1149 
Overall Loss: 10.199623
Rec Loss: 10.157304
KL Loss: 0.042319
Y Loss: 0.042819
T Loss: 10.135895
Epoch 1199 
Overall Loss: 10.196733
Rec Loss: 10.150285
KL Loss: 0.046448
Y Loss: 0.038614
T Loss: 10.130977
Epoch 1249 
Overall Loss: 10.193921
Rec Loss: 10.152627
KL Loss: 0.041294
Y Loss: 0.043560
T Loss: 10.130848
Epoch 1299 
Overall Loss: 10.200223
Rec Loss: 10.144390
KL Loss: 0.055833
Y Loss: 0.036584
T Loss: 10.126098
Epoch 1349 
Overall Loss: 10.186857
Rec Loss: 10.144453
KL Loss: 0.042403
Y Loss: 0.037614
T Loss: 10.125646
Epoch 1399 
Overall Loss: 10.189884
Rec Loss: 10.147381
KL Loss: 0.042503
Y Loss: 0.045050
T Loss: 10.124856
Epoch 1449 
Overall Loss: 10.181895
Rec Loss: 10.139344
KL Loss: 0.042550
Y Loss: 0.037908
T Loss: 10.120390
Epoch 1499 
Overall Loss: 10.174764
Rec Loss: 10.138425
KL Loss: 0.036339
Y Loss: 0.036654
T Loss: 10.120098
Epoch 1549 
Overall Loss: 10.193725
Rec Loss: 10.138027
KL Loss: 0.055699
Y Loss: 0.040996
T Loss: 10.117529
Epoch 1599 
Overall Loss: 10.173173
Rec Loss: 10.136369
KL Loss: 0.036804
Y Loss: 0.037483
T Loss: 10.117628
Epoch 1649 
Overall Loss: 10.171997
Rec Loss: 10.136235
KL Loss: 0.035762
Y Loss: 0.034758
T Loss: 10.118856
Epoch 1699 
Overall Loss: 10.168799
Rec Loss: 10.130145
KL Loss: 0.038654
Y Loss: 0.033482
T Loss: 10.113404
Epoch 1749 
Overall Loss: 10.166794
Rec Loss: 10.130874
KL Loss: 0.035921
Y Loss: 0.040915
T Loss: 10.110416
Epoch 1799 
Overall Loss: 10.186508
Rec Loss: 10.130956
KL Loss: 0.055552
Y Loss: 0.039535
T Loss: 10.111189
Epoch 1849 
Overall Loss: 10.224942
Rec Loss: 10.127692
KL Loss: 0.097250
Y Loss: 0.038652
T Loss: 10.108367
Epoch 1899 
Overall Loss: 10.169582
Rec Loss: 10.124669
KL Loss: 0.044913
Y Loss: 0.031361
T Loss: 10.108988
Epoch 1949 
Overall Loss: 10.156122
Rec Loss: 10.124273
KL Loss: 0.031848
Y Loss: 0.034781
T Loss: 10.106883
Epoch 1999 
Overall Loss: 10.144622
Rec Loss: 10.116093
KL Loss: 0.028529
Y Loss: 0.029010
T Loss: 10.101589
Epoch 2049 
Overall Loss: 10.146831
Rec Loss: 10.114743
KL Loss: 0.032089
Y Loss: 0.032128
T Loss: 10.098678
Epoch 2099 
Overall Loss: 10.160580
Rec Loss: 10.123901
KL Loss: 0.036679
Y Loss: 0.038875
T Loss: 10.104463
Epoch 2149 
Overall Loss: 10.142253
Rec Loss: 10.114570
KL Loss: 0.027683
Y Loss: 0.030594
T Loss: 10.099273
Epoch 2199 
Overall Loss: 10.141461
Rec Loss: 10.111468
KL Loss: 0.029993
Y Loss: 0.036943
T Loss: 10.092996
Epoch 2249 
Overall Loss: 10.140439
Rec Loss: 10.112335
KL Loss: 0.028104
Y Loss: 0.030430
T Loss: 10.097120
Epoch 2299 
Overall Loss: 10.154407
Rec Loss: 10.108306
KL Loss: 0.046100
Y Loss: 0.028324
T Loss: 10.094144
Epoch 2349 
Overall Loss: 10.133323
Rec Loss: 10.107205
KL Loss: 0.026119
Y Loss: 0.033692
T Loss: 10.090358
Epoch 2399 
Overall Loss: 10.135340
Rec Loss: 10.104085
KL Loss: 0.031255
Y Loss: 0.030752
T Loss: 10.088709
Epoch 2449 
Overall Loss: 10.138441
Rec Loss: 10.110306
KL Loss: 0.028135
Y Loss: 0.041861
T Loss: 10.089375
Epoch 2499 
Overall Loss: 10.130345
Rec Loss: 10.100958
KL Loss: 0.029387
Y Loss: 0.027363
T Loss: 10.087277
Epoch 2549 
Overall Loss: 10.127976
Rec Loss: 10.099789
KL Loss: 0.028187
Y Loss: 0.034850
T Loss: 10.082364
Epoch 2599 
Overall Loss: 10.128134
Rec Loss: 10.100365
KL Loss: 0.027768
Y Loss: 0.026871
T Loss: 10.086930
Epoch 2649 
Overall Loss: 10.126943
Rec Loss: 10.099746
KL Loss: 0.027197
Y Loss: 0.033638
T Loss: 10.082927
Epoch 2699 
Overall Loss: 10.126821
Rec Loss: 10.097091
KL Loss: 0.029729
Y Loss: 0.026932
T Loss: 10.083625
Epoch 2749 
Overall Loss: 10.117185
Rec Loss: 10.091354
KL Loss: 0.025832
Y Loss: 0.031791
T Loss: 10.075458
Epoch 2799 
Overall Loss: 10.127404
Rec Loss: 10.099591
KL Loss: 0.027813
Y Loss: 0.034594
T Loss: 10.082295
Epoch 2849 
Overall Loss: 10.152518
Rec Loss: 10.103476
KL Loss: 0.049043
Y Loss: 0.038018
T Loss: 10.084467
Epoch 2899 
Overall Loss: 10.124796
Rec Loss: 10.091081
KL Loss: 0.033715
Y Loss: 0.026525
T Loss: 10.077818
Epoch 2949 
Overall Loss: 10.111762
Rec Loss: 10.088904
KL Loss: 0.022857
Y Loss: 0.026052
T Loss: 10.075878
Epoch 2999 
Overall Loss: 10.111395
Rec Loss: 10.087615
KL Loss: 0.023780
Y Loss: 0.027935
T Loss: 10.073647
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.020017
Epoch 99
Rec Loss: 0.017530
Epoch 149
Rec Loss: 0.016409
Epoch 199
Rec Loss: 0.015837
Epoch 249
Rec Loss: 0.015673
Epoch 299
Rec Loss: 0.015699
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.970464
Epoch 99
Rec Loss: 9.943394
Epoch 149
Rec Loss: 9.966308
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.096095
Insample Error: 0.424418
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 20.578505
Rec Loss: 16.761141
KL Loss: 3.817364
Y Loss: 7.455918
T Loss: 13.215209
X Loss: -0.182027
Epoch 99 
Overall Loss: 4.612112
Rec Loss: -5.833530
KL Loss: 10.445641
Y Loss: 2.537421
T Loss: 13.083143
X Loss: -20.185382
Epoch 149 
Overall Loss: -1.720291
Rec Loss: -13.801627
KL Loss: 12.081336
Y Loss: 1.541487
T Loss: 13.030636
X Loss: -27.603006
Epoch 199 
Overall Loss: -5.054001
Rec Loss: -18.379184
KL Loss: 13.325183
Y Loss: 0.902718
T Loss: 12.849617
X Loss: -31.680159
Epoch 249 
Overall Loss: -7.165385
Rec Loss: -21.304567
KL Loss: 14.139181
Y Loss: 0.619166
T Loss: 12.521112
X Loss: -34.135262
Epoch 299 
Overall Loss: -8.931424
Rec Loss: -23.611512
KL Loss: 14.680087
Y Loss: 0.537042
T Loss: 12.216136
X Loss: -36.096169
Epoch 349 
Overall Loss: -10.213090
Rec Loss: -25.248055
KL Loss: 15.034964
Y Loss: 0.487071
T Loss: 12.066275
X Loss: -37.557866
Epoch 399 
Overall Loss: -11.051482
Rec Loss: -26.402053
KL Loss: 15.350571
Y Loss: 0.469749
T Loss: 11.999921
X Loss: -38.636849
Epoch 449 
Overall Loss: -12.038539
Rec Loss: -27.527830
KL Loss: 15.489291
Y Loss: 0.436255
T Loss: 11.960892
X Loss: -39.706850
Epoch 499 
Overall Loss: -12.878200
Rec Loss: -28.307389
KL Loss: 15.429188
Y Loss: 0.456430
T Loss: 11.926670
X Loss: -40.462274
Epoch 549 
Overall Loss: -14.562845
Rec Loss: -29.291064
KL Loss: 14.728219
Y Loss: 0.578372
T Loss: 12.069718
X Loss: -41.649968
Epoch 599 
Overall Loss: -15.326777
Rec Loss: -29.890647
KL Loss: 14.563870
Y Loss: 0.580588
T Loss: 12.122462
X Loss: -42.303403
Epoch 649 
Overall Loss: -15.361499
Rec Loss: -30.112126
KL Loss: 14.750627
Y Loss: 0.525049
T Loss: 12.055344
X Loss: -42.429994
Epoch 699 
Overall Loss: -16.361713
Rec Loss: -31.277090
KL Loss: 14.915378
Y Loss: 0.501708
T Loss: 12.020227
X Loss: -43.548172
Epoch 749 
Overall Loss: -16.819494
Rec Loss: -31.869355
KL Loss: 15.049861
Y Loss: 0.508801
T Loss: 11.928254
X Loss: -44.052010
Epoch 799 
Overall Loss: -17.276899
Rec Loss: -32.499162
KL Loss: 15.222263
Y Loss: 0.485373
T Loss: 11.833746
X Loss: -44.575594
Epoch 849 
Overall Loss: -16.884502
Rec Loss: -32.276727
KL Loss: 15.392225
Y Loss: 0.489327
T Loss: 11.753793
X Loss: -44.275184
Epoch 899 
Overall Loss: -18.184874
Rec Loss: -33.832573
KL Loss: 15.647698
Y Loss: 0.485005
T Loss: 11.613950
X Loss: -45.689025
Epoch 949 
Overall Loss: -18.593032
Rec Loss: -34.347692
KL Loss: 15.754660
Y Loss: 0.494630
T Loss: 11.464598
X Loss: -46.059604
Epoch 999 
Overall Loss: -18.863169
Rec Loss: -34.549762
KL Loss: 15.686594
Y Loss: 0.510154
T Loss: 11.395349
X Loss: -46.200190
Epoch 1049 
Overall Loss: -19.187225
Rec Loss: -35.135619
KL Loss: 15.948393
Y Loss: 0.502816
T Loss: 11.239401
X Loss: -46.626428
Epoch 1099 
Overall Loss: -19.672064
Rec Loss: -35.858795
KL Loss: 16.186732
Y Loss: 0.479964
T Loss: 11.157384
X Loss: -47.256162
Epoch 1149 
Overall Loss: -19.935443
Rec Loss: -36.249116
KL Loss: 16.313671
Y Loss: 0.476954
T Loss: 11.041016
X Loss: -47.528608
Epoch 1199 
Overall Loss: -20.431712
Rec Loss: -36.805770
KL Loss: 16.374058
Y Loss: 0.479253
T Loss: 10.964853
X Loss: -48.010249
Epoch 1249 
Overall Loss: -20.402389
Rec Loss: -36.921487
KL Loss: 16.519098
Y Loss: 0.476947
T Loss: 10.915874
X Loss: -48.075835
Epoch 1299 
Overall Loss: -20.691639
Rec Loss: -37.237160
KL Loss: 16.545521
Y Loss: 0.501221
T Loss: 10.855280
X Loss: -48.343050
Epoch 1349 
Overall Loss: -20.814463
Rec Loss: -37.458487
KL Loss: 16.644024
Y Loss: 0.492948
T Loss: 10.788368
X Loss: -48.493327
Epoch 1399 
Overall Loss: -21.268678
Rec Loss: -38.069009
KL Loss: 16.800331
Y Loss: 0.483141
T Loss: 10.723974
X Loss: -49.034553
Epoch 1449 
Overall Loss: -21.162246
Rec Loss: -37.780432
KL Loss: 16.618185
Y Loss: 0.499818
T Loss: 10.708061
X Loss: -48.738401
Epoch 1499 
Overall Loss: -21.706612
Rec Loss: -38.683036
KL Loss: 16.976424
Y Loss: 0.482225
T Loss: 10.652453
X Loss: -49.576603
Epoch 1549 
Overall Loss: -21.594441
Rec Loss: -38.521639
KL Loss: 16.927199
Y Loss: 0.485225
T Loss: 10.616736
X Loss: -49.380988
Epoch 1599 
Overall Loss: -22.055484
Rec Loss: -39.040315
KL Loss: 16.984831
Y Loss: 0.489649
T Loss: 10.580801
X Loss: -49.865940
Epoch 1649 
Overall Loss: -22.240107
Rec Loss: -39.360825
KL Loss: 17.120717
Y Loss: 0.494743
T Loss: 10.569931
X Loss: -50.178128
Epoch 1699 
Overall Loss: -22.179871
Rec Loss: -39.286749
KL Loss: 17.106878
Y Loss: 0.494173
T Loss: 10.533654
X Loss: -50.067490
Epoch 1749 
Overall Loss: -22.512339
Rec Loss: -39.790974
KL Loss: 17.278636
Y Loss: 0.485389
T Loss: 10.484191
X Loss: -50.517860
Epoch 1799 
Overall Loss: -22.406018
Rec Loss: -39.762810
KL Loss: 17.356793
Y Loss: 0.491847
T Loss: 10.452437
X Loss: -50.461170
Epoch 1849 
Overall Loss: -22.403778
Rec Loss: -39.674214
KL Loss: 17.270436
Y Loss: 0.531194
T Loss: 10.442517
X Loss: -50.382328
Epoch 1899 
Overall Loss: -23.033344
Rec Loss: -40.387860
KL Loss: 17.354516
Y Loss: 0.515468
T Loss: 10.406871
X Loss: -51.052465
Epoch 1949 
Overall Loss: -23.324229
Rec Loss: -40.851998
KL Loss: 17.527770
Y Loss: 0.468078
T Loss: 10.379052
X Loss: -51.465089
Epoch 1999 
Overall Loss: -23.668349
Rec Loss: -41.026775
KL Loss: 17.358426
Y Loss: 0.493714
T Loss: 10.405158
X Loss: -51.678791
Epoch 2049 
Overall Loss: -23.589175
Rec Loss: -41.194958
KL Loss: 17.605783
Y Loss: 0.469301
T Loss: 10.348492
X Loss: -51.778099
Epoch 2099 
Overall Loss: -23.703458
Rec Loss: -41.357901
KL Loss: 17.654443
Y Loss: 0.483075
T Loss: 10.336345
X Loss: -51.935784
Epoch 2149 
Overall Loss: -23.605394
Rec Loss: -41.244607
KL Loss: 17.639213
Y Loss: 0.504290
T Loss: 10.336693
X Loss: -51.833445
Epoch 2199 
Overall Loss: -23.769886
Rec Loss: -41.447948
KL Loss: 17.678063
Y Loss: 0.509186
T Loss: 10.312128
X Loss: -52.014669
Epoch 2249 
Overall Loss: -24.105124
Rec Loss: -41.862598
KL Loss: 17.757474
Y Loss: 0.503152
T Loss: 10.296102
X Loss: -52.410277
Epoch 2299 
Overall Loss: -23.085437
Rec Loss: -40.593926
KL Loss: 17.508489
Y Loss: 0.559806
T Loss: 10.318945
X Loss: -51.192774
Epoch 2349 
Overall Loss: -24.470465
Rec Loss: -42.350490
KL Loss: 17.880026
Y Loss: 0.482973
T Loss: 10.254806
X Loss: -52.846784
Epoch 2399 
Overall Loss: -24.138792
Rec Loss: -41.938180
KL Loss: 17.799389
Y Loss: 0.518312
T Loss: 10.256723
X Loss: -52.454060
Epoch 2449 
Overall Loss: -24.429884
Rec Loss: -42.464599
KL Loss: 18.034714
Y Loss: 0.478125
T Loss: 10.222544
X Loss: -52.926204
Epoch 2499 
Overall Loss: -24.608795
Rec Loss: -42.586924
KL Loss: 17.978129
Y Loss: 0.493661
T Loss: 10.240443
X Loss: -53.074198
Epoch 2549 
Overall Loss: -24.623964
Rec Loss: -42.558120
KL Loss: 17.934155
Y Loss: 0.501905
T Loss: 10.227218
X Loss: -53.036291
Epoch 2599 
Overall Loss: -24.688430
Rec Loss: -42.546503
KL Loss: 17.858073
Y Loss: 0.518424
T Loss: 10.221340
X Loss: -53.027057
Epoch 2649 
Overall Loss: -24.720498
Rec Loss: -42.688586
KL Loss: 17.968088
Y Loss: 0.512865
T Loss: 10.204814
X Loss: -53.149832
Epoch 2699 
Overall Loss: -24.896909
Rec Loss: -42.467451
KL Loss: 17.570541
Y Loss: 0.567529
T Loss: 10.259860
X Loss: -53.011077
Epoch 2749 
Overall Loss: -25.265765
Rec Loss: -43.404109
KL Loss: 18.138344
Y Loss: 0.502096
T Loss: 10.184781
X Loss: -53.839938
Epoch 2799 
Overall Loss: -24.503833
Rec Loss: -42.526726
KL Loss: 18.022892
Y Loss: 0.503737
T Loss: 10.194730
X Loss: -52.973324
Epoch 2849 
Overall Loss: -24.757109
Rec Loss: -42.917101
KL Loss: 18.159992
Y Loss: 0.517797
T Loss: 10.178715
X Loss: -53.354715
Epoch 2899 
Overall Loss: -25.288057
Rec Loss: -43.476045
KL Loss: 18.187987
Y Loss: 0.512582
T Loss: 10.160934
X Loss: -53.893267
Epoch 2949 
Overall Loss: -25.401579
Rec Loss: -43.495057
KL Loss: 18.093477
Y Loss: 0.534252
T Loss: 10.179334
X Loss: -53.941517
Epoch 2999 
Overall Loss: -25.463899
Rec Loss: -43.769367
KL Loss: 18.305469
Y Loss: 0.514281
T Loss: 10.156404
X Loss: -54.182912
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.543783
Epoch 99
Rec Loss: 1.515884
Epoch 149
Rec Loss: 1.504505
Epoch 199
Rec Loss: 1.502696
Epoch 249
Rec Loss: 1.497370
Epoch 299
Rec Loss: 1.501643
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.003977
Epoch 99
Rec Loss: 0.002158
Epoch 149
Rec Loss: 0.002026
Epoch 199
Rec Loss: 0.001848
Epoch 249
Rec Loss: 0.001062
Epoch 299
Rec Loss: 0.001725
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.287010
Insample Error 2.768345
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.532681
Epoch 99 
Prediction Loss: 0.188664
Epoch 149 
Prediction Loss: 0.100490
Epoch 199 
Prediction Loss: 0.061738
Epoch 249 
Prediction Loss: 0.046714
Epoch 299 
Prediction Loss: 0.034855
Epoch 349 
Prediction Loss: 0.028471
Epoch 399 
Prediction Loss: 0.026660
Epoch 449 
Prediction Loss: 0.019131
Epoch 499 
Prediction Loss: 0.017341
Epoch 549 
Prediction Loss: 0.015318
Epoch 599 
Prediction Loss: 0.010438
Epoch 649 
Prediction Loss: 0.009782
Epoch 699 
Prediction Loss: 0.008603
Epoch 749 
Prediction Loss: 0.009539
Epoch 799 
Prediction Loss: 0.007937
Epoch 849 
Prediction Loss: 0.006544
Epoch 899 
Prediction Loss: 0.005805
Epoch 949 
Prediction Loss: 0.005630
Epoch 999 
Prediction Loss: 0.005784
Epoch 1049 
Prediction Loss: 0.005240
Epoch 1099 
Prediction Loss: 0.005528
Epoch 1149 
Prediction Loss: 0.004800
Epoch 1199 
Prediction Loss: 0.004905
Epoch 1249 
Prediction Loss: 0.004661
Epoch 1299 
Prediction Loss: 0.003716
Epoch 1349 
Prediction Loss: 0.004482
Epoch 1399 
Prediction Loss: 0.004196
Epoch 1449 
Prediction Loss: 0.003498
Epoch 1499 
Prediction Loss: 0.003457
Epoch 1549 
Prediction Loss: 0.003811
Epoch 1599 
Prediction Loss: 0.003731
Epoch 1649 
Prediction Loss: 0.003504
Epoch 1699 
Prediction Loss: 0.003748
Epoch 1749 
Prediction Loss: 0.003397
Epoch 1799 
Prediction Loss: 0.003210
Epoch 1849 
Prediction Loss: 0.003349
Epoch 1899 
Prediction Loss: 0.002663
Epoch 1949 
Prediction Loss: 0.002877
Epoch 1999 
Prediction Loss: 0.002495
Epoch 2049 
Prediction Loss: 0.003160
Epoch 2099 
Prediction Loss: 0.003350
Epoch 2149 
Prediction Loss: 0.002617
Epoch 2199 
Prediction Loss: 0.002477
Epoch 2249 
Prediction Loss: 0.003100
Epoch 2299 
Prediction Loss: 0.002331
Epoch 2349 
Prediction Loss: 0.003074
Epoch 2399 
Prediction Loss: 0.003106
Epoch 2449 
Prediction Loss: 0.002446
Epoch 2499 
Prediction Loss: 0.002300
Epoch 2549 
Prediction Loss: 0.002656
Epoch 2599 
Prediction Loss: 0.003803
Epoch 2649 
Prediction Loss: 0.002218
Epoch 2699 
Prediction Loss: 0.003105
Epoch 2749 
Prediction Loss: 0.003664
Epoch 2799 
Prediction Loss: 0.001862
Epoch 2849 
Prediction Loss: 0.003212
Epoch 2899 
Prediction Loss: 0.001838
Epoch 2949 
Prediction Loss: 0.001997
Epoch 2999 
Prediction Loss: 0.001916
Epoch 3049 
Prediction Loss: 0.002162
Epoch 3099 
Prediction Loss: 0.002315
Epoch 3149 
Prediction Loss: 0.002731
Epoch 3199 
Prediction Loss: 0.004452
Epoch 3249 
Prediction Loss: 0.003936
Epoch 3299 
Prediction Loss: 0.002002
Epoch 3349 
Prediction Loss: 0.002112
Epoch 3399 
Prediction Loss: 0.001671
Epoch 3449 
Prediction Loss: 0.003265
Epoch 3499 
Prediction Loss: 0.002124
Epoch 3549 
Prediction Loss: 0.004074
Epoch 3599 
Prediction Loss: 0.002111
Epoch 3649 
Prediction Loss: 0.001669
Epoch 3699 
Prediction Loss: 0.001911
Epoch 3749 
Prediction Loss: 0.001749
Epoch 3799 
Prediction Loss: 0.006452
Epoch 3849 
Prediction Loss: 0.001420
Epoch 3899 
Prediction Loss: 0.002259
Epoch 3949 
Prediction Loss: 0.003001
Epoch 3999 
Prediction Loss: 0.001693
Epoch 4049 
Prediction Loss: 0.001305
Epoch 4099 
Prediction Loss: 0.001850
Epoch 4149 
Prediction Loss: 0.001645
Epoch 4199 
Prediction Loss: 0.003368
Epoch 4249 
Prediction Loss: 0.003588
Epoch 4299 
Prediction Loss: 0.001708
Epoch 4349 
Prediction Loss: 0.002749
Epoch 4399 
Prediction Loss: 0.002061
Epoch 4449 
Prediction Loss: 0.002281
Epoch 4499 
Prediction Loss: 0.002583
Epoch 4549 
Prediction Loss: 0.003180
Epoch 4599 
Prediction Loss: 0.001952
Epoch 4649 
Prediction Loss: 0.003306
Epoch 4699 
Prediction Loss: 0.003210
Epoch 4749 
Prediction Loss: 0.001811
Epoch 4799 
Prediction Loss: 0.002407
Epoch 4849 
Prediction Loss: 0.001265
Epoch 4899 
Prediction Loss: 0.003265
Epoch 4949 
Prediction Loss: 0.001523
Epoch 4999 
Prediction Loss: 0.003354
Epoch 5049 
Prediction Loss: 0.001496
Epoch 5099 
Prediction Loss: 0.001394
Epoch 5149 
Prediction Loss: 0.001194
Epoch 5199 
Prediction Loss: 0.001215
Epoch 5249 
Prediction Loss: 0.001080
Epoch 5299 
Prediction Loss: 0.003176
Epoch 5349 
Prediction Loss: 0.001112
Epoch 5399 
Prediction Loss: 0.001856
Epoch 5449 
Prediction Loss: 0.001312
Epoch 5499 
Prediction Loss: 0.001884
Epoch 5549 
Prediction Loss: 0.002535
Epoch 5599 
Prediction Loss: 0.001472
Epoch 5649 
Prediction Loss: 0.001131
Epoch 5699 
Prediction Loss: 0.003952
Epoch 5749 
Prediction Loss: 0.001350
Epoch 5799 
Prediction Loss: 0.001467
Epoch 5849 
Prediction Loss: 0.001284
Epoch 5899 
Prediction Loss: 0.001830
Epoch 5949 
Prediction Loss: 0.001316
Epoch 5999 
Prediction Loss: 0.001648
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.042194
Insample Error 0.216532
[31m========== repeat time 4 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.694581
Rec Loss: 10.413745
KL Loss: 0.280836
Y Loss: 0.600948
T Loss: 10.113271
Epoch 99 
Overall Loss: 10.444926
Rec Loss: 10.299053
KL Loss: 0.145873
Y Loss: 0.279625
T Loss: 10.159239
Epoch 149 
Overall Loss: 10.367452
Rec Loss: 10.247959
KL Loss: 0.119493
Y Loss: 0.173111
T Loss: 10.161404
Epoch 199 
Overall Loss: 10.328091
Rec Loss: 10.226364
KL Loss: 0.101728
Y Loss: 0.128232
T Loss: 10.162248
Epoch 249 
Overall Loss: 10.307757
Rec Loss: 10.220149
KL Loss: 0.087608
Y Loss: 0.106890
T Loss: 10.166704
Epoch 299 
Overall Loss: 10.292070
Rec Loss: 10.212036
KL Loss: 0.080034
Y Loss: 0.089959
T Loss: 10.167056
Epoch 349 
Overall Loss: 10.285212
Rec Loss: 10.211190
KL Loss: 0.074022
Y Loss: 0.079446
T Loss: 10.171467
Epoch 399 
Overall Loss: 10.268502
Rec Loss: 10.198444
KL Loss: 0.070058
Y Loss: 0.075177
T Loss: 10.160855
Epoch 449 
Overall Loss: 10.258586
Rec Loss: 10.192117
KL Loss: 0.066469
Y Loss: 0.063402
T Loss: 10.160416
Epoch 499 
Overall Loss: 10.250978
Rec Loss: 10.187679
KL Loss: 0.063299
Y Loss: 0.059475
T Loss: 10.157942
Epoch 549 
Overall Loss: 10.238208
Rec Loss: 10.182817
KL Loss: 0.055391
Y Loss: 0.055801
T Loss: 10.154917
Epoch 599 
Overall Loss: 10.229780
Rec Loss: 10.169454
KL Loss: 0.060326
Y Loss: 0.055802
T Loss: 10.141553
Epoch 649 
Overall Loss: 10.233336
Rec Loss: 10.176367
KL Loss: 0.056970
Y Loss: 0.048863
T Loss: 10.151935
Epoch 699 
Overall Loss: 10.225659
Rec Loss: 10.174156
KL Loss: 0.051503
Y Loss: 0.045278
T Loss: 10.151517
Epoch 749 
Overall Loss: 10.224078
Rec Loss: 10.171798
KL Loss: 0.052280
Y Loss: 0.042906
T Loss: 10.150345
Epoch 799 
Overall Loss: 10.212922
Rec Loss: 10.164662
KL Loss: 0.048260
Y Loss: 0.043160
T Loss: 10.143082
Epoch 849 
Overall Loss: 10.212641
Rec Loss: 10.165979
KL Loss: 0.046662
Y Loss: 0.041178
T Loss: 10.145390
Epoch 899 
Overall Loss: 10.218082
Rec Loss: 10.164783
KL Loss: 0.053300
Y Loss: 0.037634
T Loss: 10.145966
Epoch 949 
Overall Loss: 10.194446
Rec Loss: 10.154360
KL Loss: 0.040086
Y Loss: 0.036486
T Loss: 10.136117
Epoch 999 
Overall Loss: 10.197447
Rec Loss: 10.156150
KL Loss: 0.041297
Y Loss: 0.033840
T Loss: 10.139231
Epoch 1049 
Overall Loss: 10.197898
Rec Loss: 10.155390
KL Loss: 0.042507
Y Loss: 0.038853
T Loss: 10.135964
Epoch 1099 
Overall Loss: 10.187176
Rec Loss: 10.147533
KL Loss: 0.039642
Y Loss: 0.040919
T Loss: 10.127073
Epoch 1149 
Overall Loss: 10.187297
Rec Loss: 10.148902
KL Loss: 0.038394
Y Loss: 0.032882
T Loss: 10.132461
Epoch 1199 
Overall Loss: 10.189453
Rec Loss: 10.151663
KL Loss: 0.037791
Y Loss: 0.036747
T Loss: 10.133289
Epoch 1249 
Overall Loss: 10.199712
Rec Loss: 10.143297
KL Loss: 0.056415
Y Loss: 0.034059
T Loss: 10.126267
Epoch 1299 
Overall Loss: 10.177240
Rec Loss: 10.142753
KL Loss: 0.034487
Y Loss: 0.030201
T Loss: 10.127652
Epoch 1349 
Overall Loss: 10.184164
Rec Loss: 10.142191
KL Loss: 0.041973
Y Loss: 0.029316
T Loss: 10.127532
Epoch 1399 
Overall Loss: 10.173371
Rec Loss: 10.132520
KL Loss: 0.040851
Y Loss: 0.029233
T Loss: 10.117904
Epoch 1449 
Overall Loss: 10.166079
Rec Loss: 10.133085
KL Loss: 0.032994
Y Loss: 0.031016
T Loss: 10.117577
Epoch 1499 
Overall Loss: 10.160130
Rec Loss: 10.126811
KL Loss: 0.033319
Y Loss: 0.027554
T Loss: 10.113034
Epoch 1549 
Overall Loss: 10.163770
Rec Loss: 10.128618
KL Loss: 0.035153
Y Loss: 0.030214
T Loss: 10.113511
Epoch 1599 
Overall Loss: 10.159942
Rec Loss: 10.123957
KL Loss: 0.035985
Y Loss: 0.029226
T Loss: 10.109344
Epoch 1649 
Overall Loss: 10.154100
Rec Loss: 10.118888
KL Loss: 0.035212
Y Loss: 0.026428
T Loss: 10.105674
Epoch 1699 
Overall Loss: 10.156841
Rec Loss: 10.124558
KL Loss: 0.032283
Y Loss: 0.028751
T Loss: 10.110182
Epoch 1749 
Overall Loss: 10.156358
Rec Loss: 10.123527
KL Loss: 0.032832
Y Loss: 0.026523
T Loss: 10.110265
Epoch 1799 
Overall Loss: 10.200896
Rec Loss: 10.137352
KL Loss: 0.063544
Y Loss: 0.055988
T Loss: 10.109358
Epoch 1849 
Overall Loss: 10.151180
Rec Loss: 10.116878
KL Loss: 0.034302
Y Loss: 0.025837
T Loss: 10.103960
Epoch 1899 
Overall Loss: 10.152356
Rec Loss: 10.114249
KL Loss: 0.038107
Y Loss: 0.024207
T Loss: 10.102146
Epoch 1949 
Overall Loss: 10.159386
Rec Loss: 10.112630
KL Loss: 0.046757
Y Loss: 0.024572
T Loss: 10.100344
Epoch 1999 
Overall Loss: 10.141861
Rec Loss: 10.110977
KL Loss: 0.030884
Y Loss: 0.029334
T Loss: 10.096310
Epoch 2049 
Overall Loss: 10.142597
Rec Loss: 10.110862
KL Loss: 0.031735
Y Loss: 0.025242
T Loss: 10.098241
Epoch 2099 
Overall Loss: 10.133837
Rec Loss: 10.106699
KL Loss: 0.027138
Y Loss: 0.026427
T Loss: 10.093486
Epoch 2149 
Overall Loss: 10.183664
Rec Loss: 10.108262
KL Loss: 0.075402
Y Loss: 0.030903
T Loss: 10.092810
Epoch 2199 
Overall Loss: 10.126414
Rec Loss: 10.100212
KL Loss: 0.026202
Y Loss: 0.024252
T Loss: 10.088086
Epoch 2249 
Overall Loss: 10.129096
Rec Loss: 10.101541
KL Loss: 0.027555
Y Loss: 0.025079
T Loss: 10.089001
Epoch 2299 
Overall Loss: 10.131515
Rec Loss: 10.101782
KL Loss: 0.029733
Y Loss: 0.022371
T Loss: 10.090596
Epoch 2349 
Overall Loss: 10.129752
Rec Loss: 10.096183
KL Loss: 0.033569
Y Loss: 0.024003
T Loss: 10.084182
Epoch 2399 
Overall Loss: 10.128822
Rec Loss: 10.097488
KL Loss: 0.031333
Y Loss: 0.032734
T Loss: 10.081121
Epoch 2449 
Overall Loss: 10.123885
Rec Loss: 10.097880
KL Loss: 0.026005
Y Loss: 0.024282
T Loss: 10.085739
Epoch 2499 
Overall Loss: 10.124298
Rec Loss: 10.097620
KL Loss: 0.026678
Y Loss: 0.022349
T Loss: 10.086446
Epoch 2549 
Overall Loss: 10.120961
Rec Loss: 10.093214
KL Loss: 0.027746
Y Loss: 0.023838
T Loss: 10.081295
Epoch 2599 
Overall Loss: 10.114566
Rec Loss: 10.088928
KL Loss: 0.025637
Y Loss: 0.022954
T Loss: 10.077452
Epoch 2649 
Overall Loss: 10.113957
Rec Loss: 10.087265
KL Loss: 0.026692
Y Loss: 0.021253
T Loss: 10.076639
Epoch 2699 
Overall Loss: 10.114710
Rec Loss: 10.085849
KL Loss: 0.028861
Y Loss: 0.022352
T Loss: 10.074673
Epoch 2749 
Overall Loss: 10.124516
Rec Loss: 10.087036
KL Loss: 0.037479
Y Loss: 0.023534
T Loss: 10.075269
Epoch 2799 
Overall Loss: 10.119023
Rec Loss: 10.087394
KL Loss: 0.031629
Y Loss: 0.031986
T Loss: 10.071401
Epoch 2849 
Overall Loss: 10.104122
Rec Loss: 10.079428
KL Loss: 0.024695
Y Loss: 0.020839
T Loss: 10.069008
Epoch 2899 
Overall Loss: 10.114308
Rec Loss: 10.087326
KL Loss: 0.026982
Y Loss: 0.035838
T Loss: 10.069407
Epoch 2949 
Overall Loss: 10.104038
Rec Loss: 10.078173
KL Loss: 0.025865
Y Loss: 0.020306
T Loss: 10.068020
Epoch 2999 
Overall Loss: 10.101767
Rec Loss: 10.078357
KL Loss: 0.023410
Y Loss: 0.020753
T Loss: 10.067980
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.018415
Epoch 99
Rec Loss: 0.015686
Epoch 149
Rec Loss: 0.014718
Epoch 199
Rec Loss: 0.014344
Epoch 249
Rec Loss: 0.013948
Epoch 299
Rec Loss: 0.013842
Epoch 349
Rec Loss: 0.013924
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.238744
Epoch 99
Rec Loss: 9.091228
Epoch 149
Rec Loss: 9.107421
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.076029
Insample Error: 0.381732
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 19.785927
Rec Loss: 15.811872
KL Loss: 3.974055
Y Loss: 8.610773
T Loss: 13.315252
X Loss: -1.808766
Epoch 99 
Overall Loss: 1.830225
Rec Loss: -7.306286
KL Loss: 9.136511
Y Loss: 4.307444
T Loss: 13.217446
X Loss: -22.677455
Epoch 149 
Overall Loss: -3.649230
Rec Loss: -14.233615
KL Loss: 10.584385
Y Loss: 3.393651
T Loss: 13.175787
X Loss: -29.106228
Epoch 199 
Overall Loss: -6.536276
Rec Loss: -17.989995
KL Loss: 11.453719
Y Loss: 2.665655
T Loss: 13.124266
X Loss: -32.447088
Epoch 249 
Overall Loss: -8.288284
Rec Loss: -20.359760
KL Loss: 12.071475
Y Loss: 2.070978
T Loss: 13.089920
X Loss: -34.485168
Epoch 299 
Overall Loss: -9.687541
Rec Loss: -22.342798
KL Loss: 12.655257
Y Loss: 1.609135
T Loss: 13.043982
X Loss: -36.191348
Epoch 349 
Overall Loss: -10.644180
Rec Loss: -23.654477
KL Loss: 13.010297
Y Loss: 1.389602
T Loss: 13.008769
X Loss: -37.358047
Epoch 399 
Overall Loss: -11.718952
Rec Loss: -25.027870
KL Loss: 13.308918
Y Loss: 1.275767
T Loss: 12.975672
X Loss: -38.641426
Epoch 449 
Overall Loss: -12.668871
Rec Loss: -26.212603
KL Loss: 13.543732
Y Loss: 1.210206
T Loss: 12.950945
X Loss: -39.768652
Epoch 499 
Overall Loss: -12.930731
Rec Loss: -26.643183
KL Loss: 13.712452
Y Loss: 1.182130
T Loss: 12.903187
X Loss: -40.137435
Epoch 549 
Overall Loss: -13.887899
Rec Loss: -27.771232
KL Loss: 13.883333
Y Loss: 1.089465
T Loss: 12.876017
X Loss: -41.191982
Epoch 599 
Overall Loss: -14.140715
Rec Loss: -28.276715
KL Loss: 14.136000
Y Loss: 1.045103
T Loss: 12.831339
X Loss: -41.630605
Epoch 649 
Overall Loss: -14.872530
Rec Loss: -29.037069
KL Loss: 14.164538
Y Loss: 1.069374
T Loss: 12.807497
X Loss: -42.379252
Epoch 699 
Overall Loss: -15.187841
Rec Loss: -29.634494
KL Loss: 14.446654
Y Loss: 1.007031
T Loss: 12.746094
X Loss: -42.884104
Epoch 749 
Overall Loss: -15.547631
Rec Loss: -30.150858
KL Loss: 14.603227
Y Loss: 0.982359
T Loss: 12.694539
X Loss: -43.336577
Epoch 799 
Overall Loss: -16.098253
Rec Loss: -30.873576
KL Loss: 14.775323
Y Loss: 0.926010
T Loss: 12.628980
X Loss: -43.965560
Epoch 849 
Overall Loss: -16.415038
Rec Loss: -31.311434
KL Loss: 14.896397
Y Loss: 0.921619
T Loss: 12.556062
X Loss: -44.328307
Epoch 899 
Overall Loss: -16.659637
Rec Loss: -31.774176
KL Loss: 15.114538
Y Loss: 0.895585
T Loss: 12.481354
X Loss: -44.703323
Epoch 949 
Overall Loss: -17.298771
Rec Loss: -32.579928
KL Loss: 15.281157
Y Loss: 0.869186
T Loss: 12.406134
X Loss: -45.420657
Epoch 999 
Overall Loss: -17.642091
Rec Loss: -33.018784
KL Loss: 15.376692
Y Loss: 0.887587
T Loss: 12.313267
X Loss: -45.775843
Epoch 1049 
Overall Loss: -17.844557
Rec Loss: -33.306100
KL Loss: 15.461543
Y Loss: 0.861289
T Loss: 12.197432
X Loss: -45.934177
Epoch 1099 
Overall Loss: -17.914388
Rec Loss: -33.484405
KL Loss: 15.570016
Y Loss: 0.849662
T Loss: 12.084518
X Loss: -45.993754
Epoch 1149 
Overall Loss: -18.370696
Rec Loss: -34.060884
KL Loss: 15.690188
Y Loss: 0.835380
T Loss: 11.978251
X Loss: -46.456825
Epoch 1199 
Overall Loss: -18.904611
Rec Loss: -34.804972
KL Loss: 15.900361
Y Loss: 0.787579
T Loss: 11.852798
X Loss: -47.051560
Epoch 1249 
Overall Loss: -19.067298
Rec Loss: -35.039140
KL Loss: 15.971843
Y Loss: 0.812697
T Loss: 11.744643
X Loss: -47.190131
Epoch 1299 
Overall Loss: -19.470241
Rec Loss: -35.601176
KL Loss: 16.130933
Y Loss: 0.785069
T Loss: 11.624266
X Loss: -47.617976
Epoch 1349 
Overall Loss: -19.467846
Rec Loss: -35.664504
KL Loss: 16.196658
Y Loss: 0.762329
T Loss: 11.521303
X Loss: -47.566972
Epoch 1399 
Overall Loss: -19.466921
Rec Loss: -35.769441
KL Loss: 16.302520
Y Loss: 0.745872
T Loss: 11.417749
X Loss: -47.560125
Epoch 1449 
Overall Loss: -19.585012
Rec Loss: -35.979037
KL Loss: 16.394025
Y Loss: 0.749337
T Loss: 11.327053
X Loss: -47.680759
Epoch 1499 
Overall Loss: -20.506792
Rec Loss: -37.074488
KL Loss: 16.567695
Y Loss: 0.734714
T Loss: 11.247938
X Loss: -48.689782
Epoch 1549 
Overall Loss: -20.727873
Rec Loss: -37.231738
KL Loss: 16.503865
Y Loss: 0.751619
T Loss: 11.150201
X Loss: -48.757749
Epoch 1599 
Overall Loss: -20.989634
Rec Loss: -37.624490
KL Loss: 16.634856
Y Loss: 0.762088
T Loss: 11.113465
X Loss: -49.119000
Epoch 1649 
Overall Loss: -21.145422
Rec Loss: -37.808275
KL Loss: 16.662852
Y Loss: 0.748926
T Loss: 11.057469
X Loss: -49.240207
Epoch 1699 
Overall Loss: -21.451939
Rec Loss: -38.200483
KL Loss: 16.748544
Y Loss: 0.752213
T Loss: 11.000025
X Loss: -49.576613
Epoch 1749 
Overall Loss: -21.342618
Rec Loss: -38.247970
KL Loss: 16.905354
Y Loss: 0.708457
T Loss: 10.936220
X Loss: -49.538419
Epoch 1799 
Overall Loss: -21.640320
Rec Loss: -38.535200
KL Loss: 16.894878
Y Loss: 0.710983
T Loss: 10.901419
X Loss: -49.792109
Epoch 1849 
Overall Loss: -21.822633
Rec Loss: -38.834794
KL Loss: 17.012160
Y Loss: 0.690475
T Loss: 10.855744
X Loss: -50.035775
Epoch 1899 
Overall Loss: -21.828468
Rec Loss: -38.710336
KL Loss: 16.881869
Y Loss: 0.731352
T Loss: 10.848075
X Loss: -49.924088
Epoch 1949 
Overall Loss: -22.439622
Rec Loss: -39.562614
KL Loss: 17.122992
Y Loss: 0.699150
T Loss: 10.773640
X Loss: -50.685830
Epoch 1999 
Overall Loss: -22.597229
Rec Loss: -39.671816
KL Loss: 17.074588
Y Loss: 0.691053
T Loss: 10.766323
X Loss: -50.783664
Epoch 2049 
Overall Loss: -22.689944
Rec Loss: -39.813767
KL Loss: 17.123822
Y Loss: 0.714953
T Loss: 10.743739
X Loss: -50.914982
Epoch 2099 
Overall Loss: -22.622982
Rec Loss: -39.842605
KL Loss: 17.219624
Y Loss: 0.683248
T Loss: 10.691070
X Loss: -50.875299
Epoch 2149 
Overall Loss: -22.673224
Rec Loss: -39.950924
KL Loss: 17.277699
Y Loss: 0.709278
T Loss: 10.668642
X Loss: -50.974203
Epoch 2199 
Overall Loss: -22.148316
Rec Loss: -39.360660
KL Loss: 17.212344
Y Loss: 0.693909
T Loss: 10.663563
X Loss: -50.371178
Epoch 2249 
Overall Loss: -23.157456
Rec Loss: -40.316530
KL Loss: 17.159074
Y Loss: 0.690640
T Loss: 10.665646
X Loss: -51.327495
Epoch 2299 
Overall Loss: -23.373051
Rec Loss: -40.773038
KL Loss: 17.399986
Y Loss: 0.681589
T Loss: 10.627560
X Loss: -51.741393
Epoch 2349 
Overall Loss: -22.967361
Rec Loss: -40.343336
KL Loss: 17.375975
Y Loss: 0.705010
T Loss: 10.620489
X Loss: -51.316331
Epoch 2399 
Overall Loss: -23.431424
Rec Loss: -40.970948
KL Loss: 17.539524
Y Loss: 0.666610
T Loss: 10.611970
X Loss: -51.916223
Epoch 2449 
Overall Loss: -23.734000
Rec Loss: -41.170153
KL Loss: 17.436153
Y Loss: 0.684696
T Loss: 10.601183
X Loss: -52.113684
Epoch 2499 
Overall Loss: -23.766918
Rec Loss: -41.305513
KL Loss: 17.538596
Y Loss: 0.671895
T Loss: 10.563682
X Loss: -52.205143
Epoch 2549 
Overall Loss: -23.395122
Rec Loss: -40.854706
KL Loss: 17.459584
Y Loss: 0.667642
T Loss: 10.570197
X Loss: -51.758724
Epoch 2599 
Overall Loss: -23.429589
Rec Loss: -40.709041
KL Loss: 17.279452
Y Loss: 0.693498
T Loss: 10.580443
X Loss: -51.636232
Epoch 2649 
Overall Loss: -23.879371
Rec Loss: -41.222747
KL Loss: 17.343377
Y Loss: 0.691141
T Loss: 10.555023
X Loss: -52.123341
Epoch 2699 
Overall Loss: -24.092352
Rec Loss: -41.734035
KL Loss: 17.641684
Y Loss: 0.668911
T Loss: 10.525621
X Loss: -52.594113
Epoch 2749 
Overall Loss: -24.648220
Rec Loss: -42.414362
KL Loss: 17.766140
Y Loss: 0.639731
T Loss: 10.494829
X Loss: -53.229056
Epoch 2799 
Overall Loss: -24.494941
Rec Loss: -42.147857
KL Loss: 17.652916
Y Loss: 0.675207
T Loss: 10.524684
X Loss: -53.010143
Epoch 2849 
Overall Loss: -24.751117
Rec Loss: -42.401011
KL Loss: 17.649895
Y Loss: 0.661540
T Loss: 10.514756
X Loss: -53.246538
Epoch 2899 
Overall Loss: -24.707122
Rec Loss: -42.447385
KL Loss: 17.740262
Y Loss: 0.660245
T Loss: 10.494756
X Loss: -53.272263
Epoch 2949 
Overall Loss: -24.535621
Rec Loss: -42.132954
KL Loss: 17.597333
Y Loss: 0.680415
T Loss: 10.503852
X Loss: -52.977015
Epoch 2999 
Overall Loss: -23.646343
Rec Loss: -41.456989
KL Loss: 17.810644
Y Loss: 0.655668
T Loss: 10.478669
X Loss: -52.263490
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.582813
Epoch 99
Rec Loss: 1.572811
Epoch 149
Rec Loss: 1.564639
Epoch 199
Rec Loss: 1.556690
Epoch 249
Rec Loss: 1.552344
Epoch 299
Rec Loss: 1.545009
Epoch 349
Rec Loss: 1.559741
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.003317
Epoch 99
Rec Loss: 0.002323
Epoch 149
Rec Loss: 0.001975
Epoch 199
Rec Loss: 0.001889
Epoch 249
Rec Loss: 0.001342
Epoch 299
Rec Loss: 0.001566
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.361996
Insample Error 2.585684
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.531741
Epoch 99 
Prediction Loss: 0.222628
Epoch 149 
Prediction Loss: 0.159911
Epoch 199 
Prediction Loss: 0.121137
Epoch 249 
Prediction Loss: 0.083486
Epoch 299 
Prediction Loss: 0.062178
Epoch 349 
Prediction Loss: 0.044175
Epoch 399 
Prediction Loss: 0.032787
Epoch 449 
Prediction Loss: 0.026356
Epoch 499 
Prediction Loss: 0.019996
Epoch 549 
Prediction Loss: 0.016789
Epoch 599 
Prediction Loss: 0.013457
Epoch 649 
Prediction Loss: 0.011670
Epoch 699 
Prediction Loss: 0.010699
Epoch 749 
Prediction Loss: 0.009934
Epoch 799 
Prediction Loss: 0.008156
Epoch 849 
Prediction Loss: 0.007292
Epoch 899 
Prediction Loss: 0.007337
Epoch 949 
Prediction Loss: 0.006510
Epoch 999 
Prediction Loss: 0.008608
Epoch 1049 
Prediction Loss: 0.005585
Epoch 1099 
Prediction Loss: 0.005522
Epoch 1149 
Prediction Loss: 0.005249
Epoch 1199 
Prediction Loss: 0.004800
Epoch 1249 
Prediction Loss: 0.005523
Epoch 1299 
Prediction Loss: 0.005441
Epoch 1349 
Prediction Loss: 0.003514
Epoch 1399 
Prediction Loss: 0.005574
Epoch 1449 
Prediction Loss: 0.004811
Epoch 1499 
Prediction Loss: 0.003623
Epoch 1549 
Prediction Loss: 0.004148
Epoch 1599 
Prediction Loss: 0.004593
Epoch 1649 
Prediction Loss: 0.003276
Epoch 1699 
Prediction Loss: 0.004473
Epoch 1749 
Prediction Loss: 0.002734
Epoch 1799 
Prediction Loss: 0.003783
Epoch 1849 
Prediction Loss: 0.003142
Epoch 1899 
Prediction Loss: 0.003244
Epoch 1949 
Prediction Loss: 0.003262
Epoch 1999 
Prediction Loss: 0.002360
Epoch 2049 
Prediction Loss: 0.002805
Epoch 2099 
Prediction Loss: 0.002537
Epoch 2149 
Prediction Loss: 0.003710
Epoch 2199 
Prediction Loss: 0.002402
Epoch 2249 
Prediction Loss: 0.003400
Epoch 2299 
Prediction Loss: 0.002070
Epoch 2349 
Prediction Loss: 0.003455
Epoch 2399 
Prediction Loss: 0.002755
Epoch 2449 
Prediction Loss: 0.002521
Epoch 2499 
Prediction Loss: 0.002267
Epoch 2549 
Prediction Loss: 0.001981
Epoch 2599 
Prediction Loss: 0.002268
Epoch 2649 
Prediction Loss: 0.002024
Epoch 2699 
Prediction Loss: 0.002548
Epoch 2749 
Prediction Loss: 0.005991
Epoch 2799 
Prediction Loss: 0.001951
Epoch 2849 
Prediction Loss: 0.001925
Epoch 2899 
Prediction Loss: 0.001949
Epoch 2949 
Prediction Loss: 0.002375
Epoch 2999 
Prediction Loss: 0.002692
Epoch 3049 
Prediction Loss: 0.002692
Epoch 3099 
Prediction Loss: 0.001956
Epoch 3149 
Prediction Loss: 0.001591
Epoch 3199 
Prediction Loss: 0.001765
Epoch 3249 
Prediction Loss: 0.002015
Epoch 3299 
Prediction Loss: 0.003383
Epoch 3349 
Prediction Loss: 0.001852
Epoch 3399 
Prediction Loss: 0.007822
Epoch 3449 
Prediction Loss: 0.001947
Epoch 3499 
Prediction Loss: 0.001492
Epoch 3549 
Prediction Loss: 0.004043
Epoch 3599 
Prediction Loss: 0.004443
Epoch 3649 
Prediction Loss: 0.005183
Epoch 3699 
Prediction Loss: 0.001411
Epoch 3749 
Prediction Loss: 0.002311
Epoch 3799 
Prediction Loss: 0.001394
Epoch 3849 
Prediction Loss: 0.002325
Epoch 3899 
Prediction Loss: 0.001443
Epoch 3949 
Prediction Loss: 0.002606
Epoch 3999 
Prediction Loss: 0.002367
Epoch 4049 
Prediction Loss: 0.002382
Epoch 4099 
Prediction Loss: 0.001516
Epoch 4149 
Prediction Loss: 0.002246
Epoch 4199 
Prediction Loss: 0.002251
Epoch 4249 
Prediction Loss: 0.001743
Epoch 4299 
Prediction Loss: 0.001557
Epoch 4349 
Prediction Loss: 0.001561
Epoch 4399 
Prediction Loss: 0.002326
Epoch 4449 
Prediction Loss: 0.001257
Epoch 4499 
Prediction Loss: 0.001328
Epoch 4549 
Prediction Loss: 0.003061
Epoch 4599 
Prediction Loss: 0.002278
Epoch 4649 
Prediction Loss: 0.001699
Epoch 4699 
Prediction Loss: 0.001054
Epoch 4749 
Prediction Loss: 0.002041
Epoch 4799 
Prediction Loss: 0.002564
Epoch 4849 
Prediction Loss: 0.001625
Epoch 4899 
Prediction Loss: 0.003719
Epoch 4949 
Prediction Loss: 0.001569
Epoch 4999 
Prediction Loss: 0.001417
Epoch 5049 
Prediction Loss: 0.001327
Epoch 5099 
Prediction Loss: 0.003033
Epoch 5149 
Prediction Loss: 0.001211
Epoch 5199 
Prediction Loss: 0.000992
Epoch 5249 
Prediction Loss: 0.001932
Epoch 5299 
Prediction Loss: 0.001091
Epoch 5349 
Prediction Loss: 0.002101
Epoch 5399 
Prediction Loss: 0.001081
Epoch 5449 
Prediction Loss: 0.001055
Epoch 5499 
Prediction Loss: 0.001507
Epoch 5549 
Prediction Loss: 0.001669
Epoch 5599 
Prediction Loss: 0.001341
Epoch 5649 
Prediction Loss: 0.001254
Epoch 5699 
Prediction Loss: 0.001670
Epoch 5749 
Prediction Loss: 0.002755
Epoch 5799 
Prediction Loss: 0.001519
Epoch 5849 
Prediction Loss: 0.001990
Epoch 5899 
Prediction Loss: 0.001442
Epoch 5949 
Prediction Loss: 0.003310
Epoch 5999 
Prediction Loss: 0.001770
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.031598
Insample Error 0.180036
[31m========== repeat time 5 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.742326
Rec Loss: 10.445608
KL Loss: 0.296718
Y Loss: 0.657012
T Loss: 10.117102
Epoch 99 
Overall Loss: 10.477202
Rec Loss: 10.336874
KL Loss: 0.140328
Y Loss: 0.340504
T Loss: 10.166622
Epoch 149 
Overall Loss: 10.379022
Rec Loss: 10.264738
KL Loss: 0.114284
Y Loss: 0.191140
T Loss: 10.169168
Epoch 199 
Overall Loss: 10.337004
Rec Loss: 10.240468
KL Loss: 0.096535
Y Loss: 0.139057
T Loss: 10.170940
Epoch 249 
Overall Loss: 10.322069
Rec Loss: 10.236041
KL Loss: 0.086028
Y Loss: 0.115985
T Loss: 10.178048
Epoch 299 
Overall Loss: 10.306934
Rec Loss: 10.224361
KL Loss: 0.082573
Y Loss: 0.104965
T Loss: 10.171878
Epoch 349 
Overall Loss: 10.296604
Rec Loss: 10.217103
KL Loss: 0.079501
Y Loss: 0.092164
T Loss: 10.171021
Epoch 399 
Overall Loss: 10.268713
Rec Loss: 10.202947
KL Loss: 0.065766
Y Loss: 0.084370
T Loss: 10.160762
Epoch 449 
Overall Loss: 10.268099
Rec Loss: 10.206586
KL Loss: 0.061513
Y Loss: 0.079511
T Loss: 10.166831
Epoch 499 
Overall Loss: 10.264465
Rec Loss: 10.200188
KL Loss: 0.064276
Y Loss: 0.069014
T Loss: 10.165681
Epoch 549 
Overall Loss: 10.282085
Rec Loss: 10.224252
KL Loss: 0.057833
Y Loss: 0.099714
T Loss: 10.174395
Epoch 599 
Overall Loss: 10.238662
Rec Loss: 10.184925
KL Loss: 0.053738
Y Loss: 0.059878
T Loss: 10.154985
Epoch 649 
Overall Loss: 10.235741
Rec Loss: 10.180105
KL Loss: 0.055635
Y Loss: 0.057271
T Loss: 10.151469
Epoch 699 
Overall Loss: 10.231805
Rec Loss: 10.179052
KL Loss: 0.052753
Y Loss: 0.053261
T Loss: 10.152422
Epoch 749 
Overall Loss: 10.230953
Rec Loss: 10.184274
KL Loss: 0.046678
Y Loss: 0.049164
T Loss: 10.159692
Epoch 799 
Overall Loss: 10.217277
Rec Loss: 10.171613
KL Loss: 0.045664
Y Loss: 0.049149
T Loss: 10.147039
Epoch 849 
Overall Loss: 10.218202
Rec Loss: 10.172762
KL Loss: 0.045440
Y Loss: 0.049391
T Loss: 10.148066
Epoch 899 
Overall Loss: 10.206246
Rec Loss: 10.163423
KL Loss: 0.042823
Y Loss: 0.043320
T Loss: 10.141763
Epoch 949 
Overall Loss: 10.200364
Rec Loss: 10.159971
KL Loss: 0.040393
Y Loss: 0.043320
T Loss: 10.138311
Epoch 999 
Overall Loss: 10.341677
Rec Loss: 10.187675
KL Loss: 0.154002
Y Loss: 0.076088
T Loss: 10.149631
Epoch 1049 
Overall Loss: 10.195989
Rec Loss: 10.156744
KL Loss: 0.039245
Y Loss: 0.037666
T Loss: 10.137911
Epoch 1099 
Overall Loss: 10.192901
Rec Loss: 10.151139
KL Loss: 0.041762
Y Loss: 0.038534
T Loss: 10.131872
Epoch 1149 
Overall Loss: 10.184327
Rec Loss: 10.149068
KL Loss: 0.035260
Y Loss: 0.036122
T Loss: 10.131007
Epoch 1199 
Overall Loss: 10.219907
Rec Loss: 10.152195
KL Loss: 0.067712
Y Loss: 0.038497
T Loss: 10.132947
Epoch 1249 
Overall Loss: 10.201002
Rec Loss: 10.153179
KL Loss: 0.047823
Y Loss: 0.039232
T Loss: 10.133563
Epoch 1299 
Overall Loss: 10.176665
Rec Loss: 10.139246
KL Loss: 0.037420
Y Loss: 0.034273
T Loss: 10.122109
Epoch 1349 
Overall Loss: 10.176094
Rec Loss: 10.143210
KL Loss: 0.032883
Y Loss: 0.034387
T Loss: 10.126016
Epoch 1399 
Overall Loss: 10.168526
Rec Loss: 10.132239
KL Loss: 0.036286
Y Loss: 0.034674
T Loss: 10.114903
Epoch 1449 
Overall Loss: 10.167480
Rec Loss: 10.134894
KL Loss: 0.032587
Y Loss: 0.032205
T Loss: 10.118791
Epoch 1499 
Overall Loss: 10.169836
Rec Loss: 10.135091
KL Loss: 0.034746
Y Loss: 0.035278
T Loss: 10.117452
Epoch 1549 
Overall Loss: 10.170840
Rec Loss: 10.136110
KL Loss: 0.034730
Y Loss: 0.032688
T Loss: 10.119766
Epoch 1599 
Overall Loss: 10.161338
Rec Loss: 10.129308
KL Loss: 0.032029
Y Loss: 0.030045
T Loss: 10.114286
Epoch 1649 
Overall Loss: 10.166255
Rec Loss: 10.132310
KL Loss: 0.033945
Y Loss: 0.032290
T Loss: 10.116165
Epoch 1699 
Overall Loss: 10.160752
Rec Loss: 10.129079
KL Loss: 0.031673
Y Loss: 0.031528
T Loss: 10.113315
Epoch 1749 
Overall Loss: 10.154597
Rec Loss: 10.123850
KL Loss: 0.030746
Y Loss: 0.028144
T Loss: 10.109778
Epoch 1799 
Overall Loss: 10.158942
Rec Loss: 10.126427
KL Loss: 0.032515
Y Loss: 0.030941
T Loss: 10.110956
Epoch 1849 
Overall Loss: 10.149085
Rec Loss: 10.120456
KL Loss: 0.028629
Y Loss: 0.028923
T Loss: 10.105994
Epoch 1899 
Overall Loss: 10.150858
Rec Loss: 10.119361
KL Loss: 0.031497
Y Loss: 0.033232
T Loss: 10.102745
Epoch 1949 
Overall Loss: 10.153139
Rec Loss: 10.115345
KL Loss: 0.037794
Y Loss: 0.026685
T Loss: 10.102002
Epoch 1999 
Overall Loss: 10.150109
Rec Loss: 10.119037
KL Loss: 0.031072
Y Loss: 0.028915
T Loss: 10.104580
Epoch 2049 
Overall Loss: 10.140505
Rec Loss: 10.112665
KL Loss: 0.027840
Y Loss: 0.031031
T Loss: 10.097149
Epoch 2099 
Overall Loss: 10.150458
Rec Loss: 10.112953
KL Loss: 0.037505
Y Loss: 0.043096
T Loss: 10.091405
Epoch 2149 
Overall Loss: 10.202689
Rec Loss: 10.119054
KL Loss: 0.083635
Y Loss: 0.034125
T Loss: 10.101992
Epoch 2199 
Overall Loss: 10.152087
Rec Loss: 10.113959
KL Loss: 0.038128
Y Loss: 0.042073
T Loss: 10.092923
Epoch 2249 
Overall Loss: 10.134469
Rec Loss: 10.108323
KL Loss: 0.026146
Y Loss: 0.025558
T Loss: 10.095544
Epoch 2299 
Overall Loss: 10.144903
Rec Loss: 10.112746
KL Loss: 0.032157
Y Loss: 0.031377
T Loss: 10.097057
Epoch 2349 
Overall Loss: 10.127916
Rec Loss: 10.102743
KL Loss: 0.025172
Y Loss: 0.027048
T Loss: 10.089220
Epoch 2399 
Overall Loss: 10.132312
Rec Loss: 10.102312
KL Loss: 0.030000
Y Loss: 0.026684
T Loss: 10.088970
Epoch 2449 
Overall Loss: 10.129723
Rec Loss: 10.102382
KL Loss: 0.027341
Y Loss: 0.024571
T Loss: 10.090096
Epoch 2499 
Overall Loss: 10.148599
Rec Loss: 10.109609
KL Loss: 0.038990
Y Loss: 0.038012
T Loss: 10.090603
Epoch 2549 
Overall Loss: 10.130260
Rec Loss: 10.100738
KL Loss: 0.029522
Y Loss: 0.023820
T Loss: 10.088828
Epoch 2599 
Overall Loss: 10.117010
Rec Loss: 10.093555
KL Loss: 0.023455
Y Loss: 0.025895
T Loss: 10.080607
Epoch 2649 
Overall Loss: 10.134018
Rec Loss: 10.098579
KL Loss: 0.035439
Y Loss: 0.024077
T Loss: 10.086541
Epoch 2699 
Overall Loss: 10.118075
Rec Loss: 10.091512
KL Loss: 0.026563
Y Loss: 0.025612
T Loss: 10.078706
Epoch 2749 
Overall Loss: 10.120932
Rec Loss: 10.094724
KL Loss: 0.026208
Y Loss: 0.024244
T Loss: 10.082601
Epoch 2799 
Overall Loss: 10.119441
Rec Loss: 10.093705
KL Loss: 0.025736
Y Loss: 0.026572
T Loss: 10.080420
Epoch 2849 
Overall Loss: 10.113351
Rec Loss: 10.088908
KL Loss: 0.024443
Y Loss: 0.022318
T Loss: 10.077749
Epoch 2899 
Overall Loss: 10.105675
Rec Loss: 10.083311
KL Loss: 0.022364
Y Loss: 0.023932
T Loss: 10.071345
Epoch 2949 
Overall Loss: 10.110978
Rec Loss: 10.087219
KL Loss: 0.023760
Y Loss: 0.021794
T Loss: 10.076322
Epoch 2999 
Overall Loss: 10.113217
Rec Loss: 10.087102
KL Loss: 0.026116
Y Loss: 0.022226
T Loss: 10.075988
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.021144
Epoch 99
Rec Loss: 0.017324
Epoch 149
Rec Loss: 0.015950
Epoch 199
Rec Loss: 0.015360
Epoch 249
Rec Loss: 0.015147
Epoch 299
Rec Loss: 0.015006
Epoch 349
Rec Loss: 0.014726
Epoch 399
Rec Loss: 0.015062
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.043651
Epoch 99
Rec Loss: 10.023505
Epoch 149
Rec Loss: 9.988407
Epoch 199
Rec Loss: 9.962092
Epoch 249
Rec Loss: 9.929717
Epoch 299
Rec Loss: 9.915378
Epoch 349
Rec Loss: 9.919912
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.090234
Insample Error: 0.391293
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 20.714860
Rec Loss: 17.323540
KL Loss: 3.391320
Y Loss: 7.025070
T Loss: 13.209342
X Loss: 0.601663
Epoch 99 
Overall Loss: 1.350882
Rec Loss: -8.026380
KL Loss: 9.377261
Y Loss: 2.797569
T Loss: 13.023304
X Loss: -22.448468
Epoch 149 
Overall Loss: -4.151849
Rec Loss: -14.729599
KL Loss: 10.577750
Y Loss: 2.037186
T Loss: 13.007147
X Loss: -28.755340
Epoch 199 
Overall Loss: -7.589795
Rec Loss: -19.171972
KL Loss: 11.582178
Y Loss: 1.428295
T Loss: 12.971539
X Loss: -32.857659
Epoch 249 
Overall Loss: -9.538591
Rec Loss: -21.911711
KL Loss: 12.373119
Y Loss: 1.104903
T Loss: 12.915690
X Loss: -35.379851
Epoch 299 
Overall Loss: -11.201306
Rec Loss: -24.118193
KL Loss: 12.916887
Y Loss: 0.952451
T Loss: 12.812046
X Loss: -37.406465
Epoch 349 
Overall Loss: -12.278995
Rec Loss: -25.666543
KL Loss: 13.387548
Y Loss: 0.875959
T Loss: 12.676279
X Loss: -38.780802
Epoch 399 
Overall Loss: -13.134643
Rec Loss: -26.888829
KL Loss: 13.754186
Y Loss: 0.832486
T Loss: 12.523398
X Loss: -39.828470
Epoch 449 
Overall Loss: -13.824813
Rec Loss: -27.792555
KL Loss: 13.967742
Y Loss: 0.787604
T Loss: 12.386974
X Loss: -40.573330
Epoch 499 
Overall Loss: -14.664144
Rec Loss: -28.999661
KL Loss: 14.335518
Y Loss: 0.750606
T Loss: 12.258029
X Loss: -41.632993
Epoch 549 
Overall Loss: -15.106651
Rec Loss: -29.612272
KL Loss: 14.505622
Y Loss: 0.732241
T Loss: 12.170608
X Loss: -42.149001
Epoch 599 
Overall Loss: -15.847164
Rec Loss: -30.472979
KL Loss: 14.625814
Y Loss: 0.720689
T Loss: 12.092569
X Loss: -42.925892
Epoch 649 
Overall Loss: -16.133681
Rec Loss: -30.912650
KL Loss: 14.778969
Y Loss: 0.717142
T Loss: 12.009409
X Loss: -43.280630
Epoch 699 
Overall Loss: -16.667125
Rec Loss: -31.721159
KL Loss: 15.054033
Y Loss: 0.697019
T Loss: 11.916978
X Loss: -43.986647
Epoch 749 
Overall Loss: -17.034807
Rec Loss: -32.278656
KL Loss: 15.243849
Y Loss: 0.661971
T Loss: 11.809450
X Loss: -44.419091
Epoch 799 
Overall Loss: -17.369622
Rec Loss: -32.758313
KL Loss: 15.388691
Y Loss: 0.637826
T Loss: 11.704230
X Loss: -44.781456
Epoch 849 
Overall Loss: -17.907440
Rec Loss: -33.445441
KL Loss: 15.538000
Y Loss: 0.625901
T Loss: 11.573551
X Loss: -45.331941
Epoch 899 
Overall Loss: -18.264845
Rec Loss: -33.948563
KL Loss: 15.683718
Y Loss: 0.608020
T Loss: 11.454570
X Loss: -45.707142
Epoch 949 
Overall Loss: -18.725289
Rec Loss: -34.500888
KL Loss: 15.775598
Y Loss: 0.594128
T Loss: 11.357067
X Loss: -46.155017
Epoch 999 
Overall Loss: -18.869484
Rec Loss: -34.634020
KL Loss: 15.764535
Y Loss: 0.629944
T Loss: 11.280969
X Loss: -46.229960
Epoch 1049 
Overall Loss: -18.889454
Rec Loss: -34.845381
KL Loss: 15.955928
Y Loss: 0.595704
T Loss: 11.197601
X Loss: -46.340835
Epoch 1099 
Overall Loss: -19.399908
Rec Loss: -35.472485
KL Loss: 16.072577
Y Loss: 0.583045
T Loss: 11.125469
X Loss: -46.889478
Epoch 1149 
Overall Loss: -19.757308
Rec Loss: -35.982425
KL Loss: 16.225116
Y Loss: 0.554575
T Loss: 11.081880
X Loss: -47.341593
Epoch 1199 
Overall Loss: -20.134622
Rec Loss: -36.354284
KL Loss: 16.219663
Y Loss: 0.553795
T Loss: 11.020434
X Loss: -47.651616
Epoch 1249 
Overall Loss: -20.318804
Rec Loss: -36.686291
KL Loss: 16.367486
Y Loss: 0.537189
T Loss: 10.982426
X Loss: -47.937311
Epoch 1299 
Overall Loss: -20.593040
Rec Loss: -37.061008
KL Loss: 16.467969
Y Loss: 0.534331
T Loss: 10.933249
X Loss: -48.261421
Epoch 1349 
Overall Loss: -20.890365
Rec Loss: -37.432806
KL Loss: 16.542440
Y Loss: 0.520745
T Loss: 10.895812
X Loss: -48.588991
Epoch 1399 
Overall Loss: -21.252930
Rec Loss: -37.766071
KL Loss: 16.513142
Y Loss: 0.520826
T Loss: 10.862142
X Loss: -48.888626
Epoch 1449 
Overall Loss: -21.184654
Rec Loss: -37.872839
KL Loss: 16.688186
Y Loss: 0.505880
T Loss: 10.814221
X Loss: -48.940002
Epoch 1499 
Overall Loss: -21.218304
Rec Loss: -37.900573
KL Loss: 16.682267
Y Loss: 0.498515
T Loss: 10.789165
X Loss: -48.938994
Epoch 1549 
Overall Loss: -21.711904
Rec Loss: -38.405761
KL Loss: 16.693857
Y Loss: 0.514857
T Loss: 10.768119
X Loss: -49.431310
Epoch 1599 
Overall Loss: -21.738157
Rec Loss: -38.518522
KL Loss: 16.780364
Y Loss: 0.480912
T Loss: 10.753719
X Loss: -49.512698
Epoch 1649 
Overall Loss: -21.753340
Rec Loss: -38.591571
KL Loss: 16.838231
Y Loss: 0.481843
T Loss: 10.711826
X Loss: -49.544320
Epoch 1699 
Overall Loss: -22.002745
Rec Loss: -39.004435
KL Loss: 17.001690
Y Loss: 0.461215
T Loss: 10.683667
X Loss: -49.918711
Epoch 1749 
Overall Loss: -22.407198
Rec Loss: -39.304589
KL Loss: 16.897392
Y Loss: 0.457057
T Loss: 10.675043
X Loss: -50.208161
Epoch 1799 
Overall Loss: -22.140457
Rec Loss: -38.946036
KL Loss: 16.805580
Y Loss: 0.466169
T Loss: 10.674813
X Loss: -49.853935
Epoch 1849 
Overall Loss: -22.966309
Rec Loss: -39.903037
KL Loss: 16.936728
Y Loss: 0.448081
T Loss: 10.649156
X Loss: -50.776232
Epoch 1899 
Overall Loss: -22.823796
Rec Loss: -39.912676
KL Loss: 17.088878
Y Loss: 0.428222
T Loss: 10.610584
X Loss: -50.737370
Epoch 1949 
Overall Loss: -23.097592
Rec Loss: -40.200920
KL Loss: 17.103327
Y Loss: 0.431913
T Loss: 10.599369
X Loss: -51.016244
Epoch 1999 
Overall Loss: -23.468262
Rec Loss: -40.645969
KL Loss: 17.177707
Y Loss: 0.415354
T Loss: 10.566313
X Loss: -51.419960
Epoch 2049 
Overall Loss: -23.397821
Rec Loss: -40.701264
KL Loss: 17.303442
Y Loss: 0.401120
T Loss: 10.569021
X Loss: -51.470844
Epoch 2099 
Overall Loss: -23.378335
Rec Loss: -40.672286
KL Loss: 17.293950
Y Loss: 0.413187
T Loss: 10.558991
X Loss: -51.437869
Epoch 2149 
Overall Loss: -23.717075
Rec Loss: -41.057759
KL Loss: 17.340684
Y Loss: 0.406763
T Loss: 10.541398
X Loss: -51.802538
Epoch 2199 
Overall Loss: -23.927168
Rec Loss: -41.219736
KL Loss: 17.292568
Y Loss: 0.387145
T Loss: 10.544877
X Loss: -51.958187
Epoch 2249 
Overall Loss: -23.604604
Rec Loss: -41.067203
KL Loss: 17.462599
Y Loss: 0.375458
T Loss: 10.543067
X Loss: -51.798000
Epoch 2299 
Overall Loss: -23.245033
Rec Loss: -40.700999
KL Loss: 17.455967
Y Loss: 0.364049
T Loss: 10.528677
X Loss: -51.411700
Epoch 2349 
Overall Loss: -24.311571
Rec Loss: -41.760685
KL Loss: 17.449114
Y Loss: 0.365536
T Loss: 10.510982
X Loss: -52.454434
Epoch 2399 
Overall Loss: -24.469813
Rec Loss: -41.917813
KL Loss: 17.447999
Y Loss: 0.366308
T Loss: 10.520221
X Loss: -52.621188
Epoch 2449 
Overall Loss: -24.347395
Rec Loss: -41.886689
KL Loss: 17.539294
Y Loss: 0.343204
T Loss: 10.492737
X Loss: -52.551028
Epoch 2499 
Overall Loss: -24.289018
Rec Loss: -41.857993
KL Loss: 17.568976
Y Loss: 0.350261
T Loss: 10.493647
X Loss: -52.526770
Epoch 2549 
Overall Loss: -24.740628
Rec Loss: -42.353107
KL Loss: 17.612479
Y Loss: 0.335813
T Loss: 10.479315
X Loss: -53.000329
Epoch 2599 
Overall Loss: -24.882833
Rec Loss: -42.468669
KL Loss: 17.585837
Y Loss: 0.338189
T Loss: 10.490934
X Loss: -53.128699
Epoch 2649 
Overall Loss: -24.854326
Rec Loss: -42.172527
KL Loss: 17.318201
Y Loss: 0.359111
T Loss: 10.513348
X Loss: -52.865430
Epoch 2699 
Overall Loss: -24.831154
Rec Loss: -42.158131
KL Loss: 17.326977
Y Loss: 0.350474
T Loss: 10.521208
X Loss: -52.854575
Epoch 2749 
Overall Loss: -24.497190
Rec Loss: -42.181368
KL Loss: 17.684178
Y Loss: 0.319638
T Loss: 10.478080
X Loss: -52.819267
Epoch 2799 
Overall Loss: -24.481963
Rec Loss: -42.243125
KL Loss: 17.761162
Y Loss: 0.317824
T Loss: 10.469254
X Loss: -52.871291
Epoch 2849 
Overall Loss: -25.175279
Rec Loss: -42.861503
KL Loss: 17.686225
Y Loss: 0.307291
T Loss: 10.471605
X Loss: -53.486754
Epoch 2899 
Overall Loss: -25.469498
Rec Loss: -43.254990
KL Loss: 17.785491
Y Loss: 0.325794
T Loss: 10.472461
X Loss: -53.890348
Epoch 2949 
Overall Loss: -25.420605
Rec Loss: -43.119331
KL Loss: 17.698726
Y Loss: 0.309536
T Loss: 10.459887
X Loss: -53.733986
Epoch 2999 
Overall Loss: -25.597421
Rec Loss: -43.356247
KL Loss: 17.758827
Y Loss: 0.306075
T Loss: 10.460253
X Loss: -53.969539
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.673556
Epoch 99
Rec Loss: 1.636231
Epoch 149
Rec Loss: 1.646087
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.003768
Epoch 99
Rec Loss: 0.001921
Epoch 149
Rec Loss: 0.001567
Epoch 199
Rec Loss: 0.001281
Epoch 249
Rec Loss: 0.001166
Epoch 299
Rec Loss: 0.001200
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.313812
Insample Error 2.989940
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.551621
Epoch 99 
Prediction Loss: 0.164919
Epoch 149 
Prediction Loss: 0.100638
Epoch 199 
Prediction Loss: 0.068619
Epoch 249 
Prediction Loss: 0.052386
Epoch 299 
Prediction Loss: 0.042466
Epoch 349 
Prediction Loss: 0.033601
Epoch 399 
Prediction Loss: 0.028923
Epoch 449 
Prediction Loss: 0.022763
Epoch 499 
Prediction Loss: 0.019905
Epoch 549 
Prediction Loss: 0.015978
Epoch 599 
Prediction Loss: 0.018519
Epoch 649 
Prediction Loss: 0.012626
Epoch 699 
Prediction Loss: 0.012559
Epoch 749 
Prediction Loss: 0.011208
Epoch 799 
Prediction Loss: 0.010294
Epoch 849 
Prediction Loss: 0.010684
Epoch 899 
Prediction Loss: 0.009343
Epoch 949 
Prediction Loss: 0.011073
Epoch 999 
Prediction Loss: 0.007157
Epoch 1049 
Prediction Loss: 0.006579
Epoch 1099 
Prediction Loss: 0.007691
Epoch 1149 
Prediction Loss: 0.007696
Epoch 1199 
Prediction Loss: 0.007585
Epoch 1249 
Prediction Loss: 0.006559
Epoch 1299 
Prediction Loss: 0.005582
Epoch 1349 
Prediction Loss: 0.009177
Epoch 1399 
Prediction Loss: 0.004995
Epoch 1449 
Prediction Loss: 0.005017
Epoch 1499 
Prediction Loss: 0.005198
Epoch 1549 
Prediction Loss: 0.004915
Epoch 1599 
Prediction Loss: 0.005220
Epoch 1649 
Prediction Loss: 0.005135
Epoch 1699 
Prediction Loss: 0.004739
Epoch 1749 
Prediction Loss: 0.004965
Epoch 1799 
Prediction Loss: 0.004538
Epoch 1849 
Prediction Loss: 0.004489
Epoch 1899 
Prediction Loss: 0.004223
Epoch 1949 
Prediction Loss: 0.005684
Epoch 1999 
Prediction Loss: 0.003960
Epoch 2049 
Prediction Loss: 0.006177
Epoch 2099 
Prediction Loss: 0.003981
Epoch 2149 
Prediction Loss: 0.004121
Epoch 2199 
Prediction Loss: 0.004081
Epoch 2249 
Prediction Loss: 0.002861
Epoch 2299 
Prediction Loss: 0.004254
Epoch 2349 
Prediction Loss: 0.003299
Epoch 2399 
Prediction Loss: 0.006227
Epoch 2449 
Prediction Loss: 0.002985
Epoch 2499 
Prediction Loss: 0.003293
Epoch 2549 
Prediction Loss: 0.003096
Epoch 2599 
Prediction Loss: 0.002998
Epoch 2649 
Prediction Loss: 0.003127
Epoch 2699 
Prediction Loss: 0.003350
Epoch 2749 
Prediction Loss: 0.004650
Epoch 2799 
Prediction Loss: 0.002434
Epoch 2849 
Prediction Loss: 0.002977
Epoch 2899 
Prediction Loss: 0.004465
Epoch 2949 
Prediction Loss: 0.002612
Epoch 2999 
Prediction Loss: 0.002186
Epoch 3049 
Prediction Loss: 0.002306
Epoch 3099 
Prediction Loss: 0.002200
Epoch 3149 
Prediction Loss: 0.002919
Epoch 3199 
Prediction Loss: 0.003950
Epoch 3249 
Prediction Loss: 0.002876
Epoch 3299 
Prediction Loss: 0.002605
Epoch 3349 
Prediction Loss: 0.002354
Epoch 3399 
Prediction Loss: 0.002107
Epoch 3449 
Prediction Loss: 0.002177
Epoch 3499 
Prediction Loss: 0.002116
Epoch 3549 
Prediction Loss: 0.002619
Epoch 3599 
Prediction Loss: 0.002508
Epoch 3649 
Prediction Loss: 0.003104
Epoch 3699 
Prediction Loss: 0.002234
Epoch 3749 
Prediction Loss: 0.002152
Epoch 3799 
Prediction Loss: 0.004726
Epoch 3849 
Prediction Loss: 0.002251
Epoch 3899 
Prediction Loss: 0.002890
Epoch 3949 
Prediction Loss: 0.002283
Epoch 3999 
Prediction Loss: 0.002820
Epoch 4049 
Prediction Loss: 0.003405
Epoch 4099 
Prediction Loss: 0.002261
Epoch 4149 
Prediction Loss: 0.003043
Epoch 4199 
Prediction Loss: 0.003043
Epoch 4249 
Prediction Loss: 0.003927
Epoch 4299 
Prediction Loss: 0.001808
Epoch 4349 
Prediction Loss: 0.001601
Epoch 4399 
Prediction Loss: 0.004102
Epoch 4449 
Prediction Loss: 0.001678
Epoch 4499 
Prediction Loss: 0.001804
Epoch 4549 
Prediction Loss: 0.001626
Epoch 4599 
Prediction Loss: 0.003613
Epoch 4649 
Prediction Loss: 0.002901
Epoch 4699 
Prediction Loss: 0.003474
Epoch 4749 
Prediction Loss: 0.001783
Epoch 4799 
Prediction Loss: 0.001506
Epoch 4849 
Prediction Loss: 0.003188
Epoch 4899 
Prediction Loss: 0.002434
Epoch 4949 
Prediction Loss: 0.002114
Epoch 4999 
Prediction Loss: 0.001619
Epoch 5049 
Prediction Loss: 0.003414
Epoch 5099 
Prediction Loss: 0.001925
Epoch 5149 
Prediction Loss: 0.001771
Epoch 5199 
Prediction Loss: 0.001751
Epoch 5249 
Prediction Loss: 0.002048
Epoch 5299 
Prediction Loss: 0.001911
Epoch 5349 
Prediction Loss: 0.002107
Epoch 5399 
Prediction Loss: 0.003120
Epoch 5449 
Prediction Loss: 0.001671
Epoch 5499 
Prediction Loss: 0.005328
Epoch 5549 
Prediction Loss: 0.003963
Epoch 5599 
Prediction Loss: 0.002492
Epoch 5649 
Prediction Loss: 0.002047
Epoch 5699 
Prediction Loss: 0.001671
Epoch 5749 
Prediction Loss: 0.001499
Epoch 5799 
Prediction Loss: 0.002006
Epoch 5849 
Prediction Loss: 0.001294
Epoch 5899 
Prediction Loss: 0.001798
Epoch 5949 
Prediction Loss: 0.004345
Epoch 5999 
Prediction Loss: 0.001847
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.048147
Insample Error 0.189014
Ours, Train RMSE
0.0914, 
0.0712, 
0.0961, 
0.0760, 
0.0902, 
CEVAE, Train RMSE
0.3142, 
0.3310, 
0.2870, 
0.3620, 
0.3138, 
Ours, Insample RMSE
0.4263, 
0.3534, 
0.4244, 
0.3817, 
0.3913, 
CEVAE, Insample RMSE
3.0669, 
2.9723, 
2.7683, 
2.5857, 
2.9899, 
Direct Regression, Insample RMSE
0.2098, 
0.2356, 
0.2165, 
0.1800, 
0.1890, 
Train, RMSE mean 0.0850 std 0.0096
CEVAE, RMSE mean 0.3216 std 0.0246
Ours, RMSE mean 0.3954 std 0.0274, reconstruct confounder 0.0146 (0.0007) noise 9.6949 (0.3517)
CEVAE, RMSE mean 2.8766 std 0.1758, reconstruct confounder 1.5486 (0.0481) noise 0.0010 (0.0003)
Direct Regression, RMSE mean 0.2062 std 0.0198
