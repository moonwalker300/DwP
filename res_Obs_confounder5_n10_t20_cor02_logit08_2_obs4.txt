Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=5, mask=0, nlayer=50, obsm=4, stop=5000, ycof=0.5, ylayer=50)
Y Mean 1.332949, Std 3.576887 
Test Y Mean 0.058822, Std 3.479489 
Observe confounder 4, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.976069
Rec Loss: 11.330716
KL Loss: 0.645353
Y Loss: 0.669953
T Loss: 10.995740
Epoch 99 
Overall Loss: 11.640717
Rec Loss: 10.971051
KL Loss: 0.669667
Y Loss: 0.503801
T Loss: 10.719150
Epoch 149 
Overall Loss: 11.577640
Rec Loss: 10.940753
KL Loss: 0.636887
Y Loss: 0.440240
T Loss: 10.720633
Epoch 199 
Overall Loss: 11.550829
Rec Loss: 10.900144
KL Loss: 0.650684
Y Loss: 0.406085
T Loss: 10.697102
Epoch 249 
Overall Loss: 11.525000
Rec Loss: 10.888204
KL Loss: 0.636796
Y Loss: 0.385675
T Loss: 10.695367
Epoch 299 
Overall Loss: 11.497940
Rec Loss: 10.901993
KL Loss: 0.595947
Y Loss: 0.371700
T Loss: 10.716143
Epoch 349 
Overall Loss: 11.484736
Rec Loss: 10.869155
KL Loss: 0.615581
Y Loss: 0.367779
T Loss: 10.685265
Epoch 399 
Overall Loss: 11.459273
Rec Loss: 10.871370
KL Loss: 0.587903
Y Loss: 0.359707
T Loss: 10.691517
Epoch 449 
Overall Loss: 11.454372
Rec Loss: 10.855728
KL Loss: 0.598644
Y Loss: 0.346076
T Loss: 10.682690
Epoch 499 
Overall Loss: 11.444118
Rec Loss: 10.839920
KL Loss: 0.604198
Y Loss: 0.344289
T Loss: 10.667776
Epoch 549 
Overall Loss: 11.454704
Rec Loss: 10.856437
KL Loss: 0.598267
Y Loss: 0.343670
T Loss: 10.684602
Epoch 599 
Overall Loss: 11.431583
Rec Loss: 10.849474
KL Loss: 0.582109
Y Loss: 0.334056
T Loss: 10.682446
Epoch 649 
Overall Loss: 11.432490
Rec Loss: 10.845195
KL Loss: 0.587294
Y Loss: 0.332236
T Loss: 10.679077
Epoch 699 
Overall Loss: 11.435100
Rec Loss: 10.839902
KL Loss: 0.595198
Y Loss: 0.328192
T Loss: 10.675806
Epoch 749 
Overall Loss: 11.425528
Rec Loss: 10.850963
KL Loss: 0.574565
Y Loss: 0.324921
T Loss: 10.688502
Epoch 799 
Overall Loss: 11.407929
Rec Loss: 10.831050
KL Loss: 0.576879
Y Loss: 0.323650
T Loss: 10.669226
Epoch 849 
Overall Loss: 11.406040
Rec Loss: 10.825172
KL Loss: 0.580868
Y Loss: 0.318528
T Loss: 10.665908
Epoch 899 
Overall Loss: 11.404717
Rec Loss: 10.817278
KL Loss: 0.587439
Y Loss: 0.319254
T Loss: 10.657651
Epoch 949 
Overall Loss: 11.406121
Rec Loss: 10.833460
KL Loss: 0.572661
Y Loss: 0.316365
T Loss: 10.675277
Epoch 999 
Overall Loss: 11.407624
Rec Loss: 10.839121
KL Loss: 0.568503
Y Loss: 0.315695
T Loss: 10.681273
Epoch 1049 
Overall Loss: 11.403540
Rec Loss: 10.826575
KL Loss: 0.576964
Y Loss: 0.312388
T Loss: 10.670381
Epoch 1099 
Overall Loss: 11.393882
Rec Loss: 10.820514
KL Loss: 0.573369
Y Loss: 0.315143
T Loss: 10.662943
Epoch 1149 
Overall Loss: 11.393294
Rec Loss: 10.814473
KL Loss: 0.578820
Y Loss: 0.310791
T Loss: 10.659078
Epoch 1199 
Overall Loss: 11.410591
Rec Loss: 10.814541
KL Loss: 0.596050
Y Loss: 0.309927
T Loss: 10.659577
Epoch 1249 
Overall Loss: 11.369064
Rec Loss: 10.797138
KL Loss: 0.571927
Y Loss: 0.306450
T Loss: 10.643913
Epoch 1299 
Overall Loss: 11.365154
Rec Loss: 10.809382
KL Loss: 0.555772
Y Loss: 0.307949
T Loss: 10.655408
Epoch 1349 
Overall Loss: 11.371921
Rec Loss: 10.795389
KL Loss: 0.576531
Y Loss: 0.307269
T Loss: 10.641755
Epoch 1399 
Overall Loss: 11.362268
Rec Loss: 10.798690
KL Loss: 0.563578
Y Loss: 0.310080
T Loss: 10.643650
Epoch 1449 
Overall Loss: 11.386297
Rec Loss: 10.806829
KL Loss: 0.579468
Y Loss: 0.309031
T Loss: 10.652314
Epoch 1499 
Overall Loss: 11.357412
Rec Loss: 10.788203
KL Loss: 0.569209
Y Loss: 0.301411
T Loss: 10.637498
Epoch 1549 
Overall Loss: 11.346823
Rec Loss: 10.780797
KL Loss: 0.566025
Y Loss: 0.301684
T Loss: 10.629955
Epoch 1599 
Overall Loss: 11.354084
Rec Loss: 10.785874
KL Loss: 0.568210
Y Loss: 0.300584
T Loss: 10.635582
Epoch 1649 
Overall Loss: 11.361366
Rec Loss: 10.777089
KL Loss: 0.584277
Y Loss: 0.301976
T Loss: 10.626101
Epoch 1699 
Overall Loss: 11.334377
Rec Loss: 10.772279
KL Loss: 0.562098
Y Loss: 0.298813
T Loss: 10.622872
Epoch 1749 
Overall Loss: 11.340558
Rec Loss: 10.775124
KL Loss: 0.565435
Y Loss: 0.297351
T Loss: 10.626449
Epoch 1799 
Overall Loss: 11.343045
Rec Loss: 10.773654
KL Loss: 0.569391
Y Loss: 0.294843
T Loss: 10.626232
Epoch 1849 
Overall Loss: 11.332590
Rec Loss: 10.766384
KL Loss: 0.566206
Y Loss: 0.295100
T Loss: 10.618834
Epoch 1899 
Overall Loss: 11.336994
Rec Loss: 10.747556
KL Loss: 0.589438
Y Loss: 0.295828
T Loss: 10.599642
Epoch 1949 
Overall Loss: 11.328450
Rec Loss: 10.763089
KL Loss: 0.565361
Y Loss: 0.297343
T Loss: 10.614417
Epoch 1999 
Overall Loss: 11.309362
Rec Loss: 10.751379
KL Loss: 0.557983
Y Loss: 0.290272
T Loss: 10.606243
Epoch 2049 
Overall Loss: 11.312236
Rec Loss: 10.752973
KL Loss: 0.559263
Y Loss: 0.291555
T Loss: 10.607196
Epoch 2099 
Overall Loss: 11.336879
Rec Loss: 10.773290
KL Loss: 0.563588
Y Loss: 0.294469
T Loss: 10.626056
Epoch 2149 
Overall Loss: 11.316174
Rec Loss: 10.755272
KL Loss: 0.560902
Y Loss: 0.287850
T Loss: 10.611347
Epoch 2199 
Overall Loss: 11.310263
Rec Loss: 10.747378
KL Loss: 0.562886
Y Loss: 0.287370
T Loss: 10.603693
Epoch 2249 
Overall Loss: 11.319420
Rec Loss: 10.746748
KL Loss: 0.572671
Y Loss: 0.287099
T Loss: 10.603199
Epoch 2299 
Overall Loss: 11.311272
Rec Loss: 10.744833
KL Loss: 0.566439
Y Loss: 0.292656
T Loss: 10.598505
Epoch 2349 
Overall Loss: 11.294731
Rec Loss: 10.735313
KL Loss: 0.559418
Y Loss: 0.280255
T Loss: 10.595186
Epoch 2399 
Overall Loss: 11.286240
Rec Loss: 10.726314
KL Loss: 0.559926
Y Loss: 0.286474
T Loss: 10.583077
Epoch 2449 
Overall Loss: 11.317537
Rec Loss: 10.752577
KL Loss: 0.564960
Y Loss: 0.296261
T Loss: 10.604446
Epoch 2499 
Overall Loss: 11.287067
Rec Loss: 10.719371
KL Loss: 0.567695
Y Loss: 0.281750
T Loss: 10.578496
Epoch 2549 
Overall Loss: 11.290365
Rec Loss: 10.732849
KL Loss: 0.557516
Y Loss: 0.280587
T Loss: 10.592556
Epoch 2599 
Overall Loss: 11.285749
Rec Loss: 10.725092
KL Loss: 0.560657
Y Loss: 0.289121
T Loss: 10.580532
Epoch 2649 
Overall Loss: 11.266251
Rec Loss: 10.703972
KL Loss: 0.562279
Y Loss: 0.280334
T Loss: 10.563806
Epoch 2699 
Overall Loss: 11.291634
Rec Loss: 10.728651
KL Loss: 0.562983
Y Loss: 0.288103
T Loss: 10.584599
Epoch 2749 
Overall Loss: 11.299117
Rec Loss: 10.729111
KL Loss: 0.570005
Y Loss: 0.281435
T Loss: 10.588394
Epoch 2799 
Overall Loss: 11.282809
Rec Loss: 10.731743
KL Loss: 0.551067
Y Loss: 0.280713
T Loss: 10.591386
Epoch 2849 
Overall Loss: 11.273090
Rec Loss: 10.715920
KL Loss: 0.557169
Y Loss: 0.274285
T Loss: 10.578778
Epoch 2899 
Overall Loss: 11.282269
Rec Loss: 10.710861
KL Loss: 0.571408
Y Loss: 0.276660
T Loss: 10.572531
Epoch 2949 
Overall Loss: 11.270479
Rec Loss: 10.714794
KL Loss: 0.555685
Y Loss: 0.280696
T Loss: 10.574445
Epoch 2999 
Overall Loss: 11.273529
Rec Loss: 10.717072
KL Loss: 0.556457
Y Loss: 0.276742
T Loss: 10.578700
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.544907
Epoch 99
Rec Loss: 0.536531
Epoch 149
Rec Loss: 0.536799
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.019864
Epoch 99
Rec Loss: 9.987807
Epoch 149
Rec Loss: 9.977973
Epoch 199
Rec Loss: 9.973591
Epoch 249
Rec Loss: 9.958566
Epoch 299
Rec Loss: 9.936594
Epoch 349
Rec Loss: 9.928452
Epoch 399
Rec Loss: 9.936466
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.511211
Insample Error: 1.127140
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 20.690989
Rec Loss: 18.038088
KL Loss: 2.652901
Y Loss: 4.471250
T Loss: 13.372106
X Loss: 2.430357
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.501304
Epoch 99
Rec Loss: 3.498162
Epoch 149
Rec Loss: 3.501392
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 3.105300
Epoch 99
Rec Loss: 3.121824
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 1.602840
Insample Error 2.325879
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.423874
Epoch 99 
Prediction Loss: 0.374476
Epoch 149 
Prediction Loss: 0.346835
Epoch 199 
Prediction Loss: 0.313047
Epoch 249 
Prediction Loss: 0.313438
Epoch 299 
Prediction Loss: 0.295122
Epoch 349 
Prediction Loss: 0.291691
Epoch 399 
Prediction Loss: 0.283651
Epoch 449 
Prediction Loss: 0.280092
Epoch 499 
Prediction Loss: 0.273405
Epoch 549 
Prediction Loss: 0.271136
Epoch 599 
Prediction Loss: 0.262827
Epoch 649 
Prediction Loss: 0.260023
Epoch 699 
Prediction Loss: 0.247185
Epoch 749 
Prediction Loss: 0.243089
Epoch 799 
Prediction Loss: 0.244967
Epoch 849 
Prediction Loss: 0.237140
Epoch 899 
Prediction Loss: 0.226579
Epoch 949 
Prediction Loss: 0.220976
Epoch 999 
Prediction Loss: 0.242001
Epoch 1049 
Prediction Loss: 0.217629
Epoch 1099 
Prediction Loss: 0.226822
Epoch 1149 
Prediction Loss: 0.209446
Epoch 1199 
Prediction Loss: 0.205410
Epoch 1249 
Prediction Loss: 0.209310
Epoch 1299 
Prediction Loss: 0.199571
Epoch 1349 
Prediction Loss: 0.210909
Epoch 1399 
Prediction Loss: 0.191006
Epoch 1449 
Prediction Loss: 0.184294
Epoch 1499 
Prediction Loss: 0.178308
Epoch 1549 
Prediction Loss: 0.174664
Epoch 1599 
Prediction Loss: 0.181117
Epoch 1649 
Prediction Loss: 0.170891
Epoch 1699 
Prediction Loss: 0.170488
Epoch 1749 
Prediction Loss: 0.168193
Epoch 1799 
Prediction Loss: 0.162333
Epoch 1849 
Prediction Loss: 0.160462
Epoch 1899 
Prediction Loss: 0.157589
Epoch 1949 
Prediction Loss: 0.154078
Epoch 1999 
Prediction Loss: 0.152393
Epoch 2049 
Prediction Loss: 0.152312
Epoch 2099 
Prediction Loss: 0.145490
Epoch 2149 
Prediction Loss: 0.152550
Epoch 2199 
Prediction Loss: 0.144071
Epoch 2249 
Prediction Loss: 0.145395
Epoch 2299 
Prediction Loss: 0.142334
Epoch 2349 
Prediction Loss: 0.137090
Epoch 2399 
Prediction Loss: 0.136423
Epoch 2449 
Prediction Loss: 0.132134
Epoch 2499 
Prediction Loss: 0.129914
Epoch 2549 
Prediction Loss: 0.132163
Epoch 2599 
Prediction Loss: 0.132278
Epoch 2649 
Prediction Loss: 0.126262
Epoch 2699 
Prediction Loss: 0.124707
Epoch 2749 
Prediction Loss: 0.126953
Epoch 2799 
Prediction Loss: 0.123265
Epoch 2849 
Prediction Loss: 0.125418
Epoch 2899 
Prediction Loss: 0.122886
Epoch 2949 
Prediction Loss: 0.122798
Epoch 2999 
Prediction Loss: 0.126887
Epoch 3049 
Prediction Loss: 0.127639
Epoch 3099 
Prediction Loss: 0.118633
Epoch 3149 
Prediction Loss: 0.124297
Epoch 3199 
Prediction Loss: 0.118174
Epoch 3249 
Prediction Loss: 0.116070
Epoch 3299 
Prediction Loss: 0.117339
Epoch 3349 
Prediction Loss: 0.124339
Epoch 3399 
Prediction Loss: 0.126764
Epoch 3449 
Prediction Loss: 0.112888
Epoch 3499 
Prediction Loss: 0.110366
Epoch 3549 
Prediction Loss: 0.111447
Epoch 3599 
Prediction Loss: 0.109739
Epoch 3649 
Prediction Loss: 0.111405
Epoch 3699 
Prediction Loss: 0.109622
Epoch 3749 
Prediction Loss: 0.115267
Epoch 3799 
Prediction Loss: 0.108106
Epoch 3849 
Prediction Loss: 0.115538
Epoch 3899 
Prediction Loss: 0.108040
Epoch 3949 
Prediction Loss: 0.113538
Epoch 3999 
Prediction Loss: 0.111766
Epoch 4049 
Prediction Loss: 0.106211
Epoch 4099 
Prediction Loss: 0.107437
Epoch 4149 
Prediction Loss: 0.104985
Epoch 4199 
Prediction Loss: 0.103118
Epoch 4249 
Prediction Loss: 0.101477
Epoch 4299 
Prediction Loss: 0.102901
Epoch 4349 
Prediction Loss: 0.106922
Epoch 4399 
Prediction Loss: 0.100568
Epoch 4449 
Prediction Loss: 0.103415
Epoch 4499 
Prediction Loss: 0.103941
Epoch 4549 
Prediction Loss: 0.101330
Epoch 4599 
Prediction Loss: 0.111409
Epoch 4649 
Prediction Loss: 0.103463
Epoch 4699 
Prediction Loss: 0.101377
Epoch 4749 
Prediction Loss: 0.098738
Epoch 4799 
Prediction Loss: 0.100393
Epoch 4849 
Prediction Loss: 0.098432
Epoch 4899 
Prediction Loss: 0.108620
Epoch 4949 
Prediction Loss: 0.095532
Epoch 4999 
Prediction Loss: 0.100032
Epoch 5049 
Prediction Loss: 0.106837
Epoch 5099 
Prediction Loss: 0.111572
Epoch 5149 
Prediction Loss: 0.098070
Epoch 5199 
Prediction Loss: 0.100292
Epoch 5249 
Prediction Loss: 0.096599
Epoch 5299 
Prediction Loss: 0.099872
Epoch 5349 
Prediction Loss: 0.093281
Epoch 5399 
Prediction Loss: 0.094392
Epoch 5449 
Prediction Loss: 0.098793
Epoch 5499 
Prediction Loss: 0.094643
Epoch 5549 
Prediction Loss: 0.095984
Epoch 5599 
Prediction Loss: 0.095193
Epoch 5649 
Prediction Loss: 0.094016
Epoch 5699 
Prediction Loss: 0.104549
Epoch 5749 
Prediction Loss: 0.091011
Epoch 5799 
Prediction Loss: 0.089786
Epoch 5849 
Prediction Loss: 0.097859
Epoch 5899 
Prediction Loss: 0.089508
Epoch 5949 
Prediction Loss: 0.095443
Epoch 5999 
Prediction Loss: 0.107576
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.301225
Insample Error 1.267512
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.773105
Rec Loss: 11.010726
KL Loss: 0.762378
Y Loss: 0.631382
T Loss: 10.695035
Epoch 99 
Overall Loss: 11.596459
Rec Loss: 10.925707
KL Loss: 0.670752
Y Loss: 0.451808
T Loss: 10.699804
Epoch 149 
Overall Loss: 11.544300
Rec Loss: 10.904249
KL Loss: 0.640051
Y Loss: 0.389438
T Loss: 10.709530
Epoch 199 
Overall Loss: 11.513891
Rec Loss: 10.877110
KL Loss: 0.636781
Y Loss: 0.367471
T Loss: 10.693374
Epoch 249 
Overall Loss: 11.497751
Rec Loss: 10.885875
KL Loss: 0.611876
Y Loss: 0.359103
T Loss: 10.706324
Epoch 299 
Overall Loss: 11.473084
Rec Loss: 10.865028
KL Loss: 0.608057
Y Loss: 0.348582
T Loss: 10.690736
Epoch 349 
Overall Loss: 11.478665
Rec Loss: 10.877102
KL Loss: 0.601563
Y Loss: 0.346868
T Loss: 10.703669
Epoch 399 
Overall Loss: 11.459303
Rec Loss: 10.860767
KL Loss: 0.598536
Y Loss: 0.338048
T Loss: 10.691743
Epoch 449 
Overall Loss: 11.457752
Rec Loss: 10.855793
KL Loss: 0.601959
Y Loss: 0.336425
T Loss: 10.687581
Epoch 499 
Overall Loss: 11.448316
Rec Loss: 10.856022
KL Loss: 0.592294
Y Loss: 0.332691
T Loss: 10.689676
Epoch 549 
Overall Loss: 11.431987
Rec Loss: 10.838898
KL Loss: 0.593089
Y Loss: 0.327938
T Loss: 10.674929
Epoch 599 
Overall Loss: 11.436768
Rec Loss: 10.837265
KL Loss: 0.599504
Y Loss: 0.326069
T Loss: 10.674230
Epoch 649 
Overall Loss: 11.441143
Rec Loss: 10.840649
KL Loss: 0.600494
Y Loss: 0.321993
T Loss: 10.679653
Epoch 699 
Overall Loss: 11.429129
Rec Loss: 10.855045
KL Loss: 0.574084
Y Loss: 0.326769
T Loss: 10.691660
Epoch 749 
Overall Loss: 11.419363
Rec Loss: 10.833879
KL Loss: 0.585483
Y Loss: 0.317860
T Loss: 10.674949
Epoch 799 
Overall Loss: 11.409389
Rec Loss: 10.820860
KL Loss: 0.588529
Y Loss: 0.320811
T Loss: 10.660454
Epoch 849 
Overall Loss: 11.408310
Rec Loss: 10.827647
KL Loss: 0.580663
Y Loss: 0.320650
T Loss: 10.667322
Epoch 899 
Overall Loss: 11.401709
Rec Loss: 10.828792
KL Loss: 0.572917
Y Loss: 0.312112
T Loss: 10.672736
Epoch 949 
Overall Loss: 11.402678
Rec Loss: 10.811683
KL Loss: 0.590994
Y Loss: 0.312062
T Loss: 10.655653
Epoch 999 
Overall Loss: 11.394815
Rec Loss: 10.819158
KL Loss: 0.575658
Y Loss: 0.317963
T Loss: 10.660176
Epoch 1049 
Overall Loss: 11.390890
Rec Loss: 10.828369
KL Loss: 0.562520
Y Loss: 0.307052
T Loss: 10.674843
Epoch 1099 
Overall Loss: 11.393953
Rec Loss: 10.821276
KL Loss: 0.572677
Y Loss: 0.309447
T Loss: 10.666553
Epoch 1149 
Overall Loss: 11.394745
Rec Loss: 10.813824
KL Loss: 0.580921
Y Loss: 0.306258
T Loss: 10.660695
Epoch 1199 
Overall Loss: 11.370656
Rec Loss: 10.810260
KL Loss: 0.560396
Y Loss: 0.307503
T Loss: 10.656508
Epoch 1249 
Overall Loss: 11.366199
Rec Loss: 10.801608
KL Loss: 0.564592
Y Loss: 0.306920
T Loss: 10.648148
Epoch 1299 
Overall Loss: 11.367508
Rec Loss: 10.780916
KL Loss: 0.586592
Y Loss: 0.301861
T Loss: 10.629986
Epoch 1349 
Overall Loss: 11.360673
Rec Loss: 10.791147
KL Loss: 0.569526
Y Loss: 0.307427
T Loss: 10.637433
Epoch 1399 
Overall Loss: 11.351515
Rec Loss: 10.791169
KL Loss: 0.560346
Y Loss: 0.304405
T Loss: 10.638966
Epoch 1449 
Overall Loss: 11.363674
Rec Loss: 10.805758
KL Loss: 0.557916
Y Loss: 0.302366
T Loss: 10.654575
Epoch 1499 
Overall Loss: 11.352255
Rec Loss: 10.789136
KL Loss: 0.563119
Y Loss: 0.300517
T Loss: 10.638877
Epoch 1549 
Overall Loss: 11.359302
Rec Loss: 10.801900
KL Loss: 0.557401
Y Loss: 0.301734
T Loss: 10.651033
Epoch 1599 
Overall Loss: 11.375528
Rec Loss: 10.785799
KL Loss: 0.589729
Y Loss: 0.303274
T Loss: 10.634162
Epoch 1649 
Overall Loss: 11.359223
Rec Loss: 10.788345
KL Loss: 0.570878
Y Loss: 0.291113
T Loss: 10.642789
Epoch 1699 
Overall Loss: 11.347359
Rec Loss: 10.784902
KL Loss: 0.562457
Y Loss: 0.295362
T Loss: 10.637221
Epoch 1749 
Overall Loss: 11.334243
Rec Loss: 10.770633
KL Loss: 0.563610
Y Loss: 0.296986
T Loss: 10.622140
Epoch 1799 
Overall Loss: 11.320420
Rec Loss: 10.759340
KL Loss: 0.561080
Y Loss: 0.297884
T Loss: 10.610398
Epoch 1849 
Overall Loss: 11.307040
Rec Loss: 10.752432
KL Loss: 0.554609
Y Loss: 0.295504
T Loss: 10.604680
Epoch 1899 
Overall Loss: 11.331644
Rec Loss: 10.765800
KL Loss: 0.565843
Y Loss: 0.297599
T Loss: 10.617001
Epoch 1949 
Overall Loss: 11.316518
Rec Loss: 10.763468
KL Loss: 0.553050
Y Loss: 0.292877
T Loss: 10.617030
Epoch 1999 
Overall Loss: 11.299514
Rec Loss: 10.739905
KL Loss: 0.559609
Y Loss: 0.287889
T Loss: 10.595961
Epoch 2049 
Overall Loss: 11.314048
Rec Loss: 10.761554
KL Loss: 0.552494
Y Loss: 0.290484
T Loss: 10.616312
Epoch 2099 
Overall Loss: 11.299232
Rec Loss: 10.753063
KL Loss: 0.546169
Y Loss: 0.287047
T Loss: 10.609540
Epoch 2149 
Overall Loss: 11.305423
Rec Loss: 10.746012
KL Loss: 0.559411
Y Loss: 0.285082
T Loss: 10.603471
Epoch 2199 
Overall Loss: 11.302995
Rec Loss: 10.734998
KL Loss: 0.567997
Y Loss: 0.291703
T Loss: 10.589147
Epoch 2249 
Overall Loss: 11.290479
Rec Loss: 10.733768
KL Loss: 0.556711
Y Loss: 0.283917
T Loss: 10.591809
Epoch 2299 
Overall Loss: 11.295028
Rec Loss: 10.729887
KL Loss: 0.565141
Y Loss: 0.283971
T Loss: 10.587902
Epoch 2349 
Overall Loss: 11.306899
Rec Loss: 10.740486
KL Loss: 0.566413
Y Loss: 0.284313
T Loss: 10.598330
Epoch 2399 
Overall Loss: 11.290100
Rec Loss: 10.727623
KL Loss: 0.562477
Y Loss: 0.284138
T Loss: 10.585554
Epoch 2449 
Overall Loss: 11.297823
Rec Loss: 10.737887
KL Loss: 0.559937
Y Loss: 0.285809
T Loss: 10.594982
Epoch 2499 
Overall Loss: 11.281210
Rec Loss: 10.719582
KL Loss: 0.561628
Y Loss: 0.282993
T Loss: 10.578086
Epoch 2549 
Overall Loss: 11.283757
Rec Loss: 10.728797
KL Loss: 0.554960
Y Loss: 0.280943
T Loss: 10.588326
Epoch 2599 
Overall Loss: 11.297006
Rec Loss: 10.733991
KL Loss: 0.563015
Y Loss: 0.278956
T Loss: 10.594513
Epoch 2649 
Overall Loss: 11.268277
Rec Loss: 10.710419
KL Loss: 0.557858
Y Loss: 0.279646
T Loss: 10.570597
Epoch 2699 
Overall Loss: 11.270135
Rec Loss: 10.717237
KL Loss: 0.552898
Y Loss: 0.278091
T Loss: 10.578191
Epoch 2749 
Overall Loss: 11.272621
Rec Loss: 10.712315
KL Loss: 0.560306
Y Loss: 0.279971
T Loss: 10.572330
Epoch 2799 
Overall Loss: 11.264911
Rec Loss: 10.719207
KL Loss: 0.545704
Y Loss: 0.278324
T Loss: 10.580044
Epoch 2849 
Overall Loss: 11.271772
Rec Loss: 10.714874
KL Loss: 0.556898
Y Loss: 0.280560
T Loss: 10.574594
Epoch 2899 
Overall Loss: 11.269210
Rec Loss: 10.700654
KL Loss: 0.568556
Y Loss: 0.274038
T Loss: 10.563635
Epoch 2949 
Overall Loss: 11.274996
Rec Loss: 10.715997
KL Loss: 0.558998
Y Loss: 0.274013
T Loss: 10.578991
Epoch 2999 
Overall Loss: 11.249941
Rec Loss: 10.702665
KL Loss: 0.547276
Y Loss: 0.277615
T Loss: 10.563858
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.549378
Epoch 99
Rec Loss: 0.527792
Epoch 149
Rec Loss: 0.533811
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.981527
Epoch 99
Rec Loss: 9.966003
Epoch 149
Rec Loss: 9.942705
Epoch 199
Rec Loss: 9.943239
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.508122
Insample Error: 1.120063
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 20.707524
Rec Loss: 18.039014
KL Loss: 2.668510
Y Loss: 5.140279
T Loss: 13.410217
X Loss: 2.058657
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.506692
Epoch 99
Rec Loss: 3.502833
Epoch 149
Rec Loss: 3.502777
Epoch 199
Rec Loss: 3.491388
Epoch 249
Rec Loss: 3.507468
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 3.031839
Epoch 99
Rec Loss: 3.029823
Epoch 149
Rec Loss: 3.024144
Epoch 199
Rec Loss: 3.046059
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 1.726421
Insample Error 2.472596
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.401864
Epoch 99 
Prediction Loss: 0.346794
Epoch 149 
Prediction Loss: 0.315343
Epoch 199 
Prediction Loss: 0.319426
Epoch 249 
Prediction Loss: 0.308641
Epoch 299 
Prediction Loss: 0.299136
Epoch 349 
Prediction Loss: 0.303942
Epoch 399 
Prediction Loss: 0.281838
Epoch 449 
Prediction Loss: 0.289133
Epoch 499 
Prediction Loss: 0.265804
Epoch 549 
Prediction Loss: 0.266717
Epoch 599 
Prediction Loss: 0.255153
Epoch 649 
Prediction Loss: 0.269460
Epoch 699 
Prediction Loss: 0.256718
Epoch 749 
Prediction Loss: 0.248444
Epoch 799 
Prediction Loss: 0.233090
Epoch 849 
Prediction Loss: 0.233798
Epoch 899 
Prediction Loss: 0.218162
Epoch 949 
Prediction Loss: 0.212286
Epoch 999 
Prediction Loss: 0.210524
Epoch 1049 
Prediction Loss: 0.206191
Epoch 1099 
Prediction Loss: 0.205915
Epoch 1149 
Prediction Loss: 0.198976
Epoch 1199 
Prediction Loss: 0.200193
Epoch 1249 
Prediction Loss: 0.190189
Epoch 1299 
Prediction Loss: 0.193847
Epoch 1349 
Prediction Loss: 0.183380
Epoch 1399 
Prediction Loss: 0.179232
Epoch 1449 
Prediction Loss: 0.171168
Epoch 1499 
Prediction Loss: 0.166962
Epoch 1549 
Prediction Loss: 0.168463
Epoch 1599 
Prediction Loss: 0.166990
Epoch 1649 
Prediction Loss: 0.156796
Epoch 1699 
Prediction Loss: 0.163686
Epoch 1749 
Prediction Loss: 0.157542
Epoch 1799 
Prediction Loss: 0.152654
Epoch 1849 
Prediction Loss: 0.156479
Epoch 1899 
Prediction Loss: 0.152414
Epoch 1949 
Prediction Loss: 0.154943
Epoch 1999 
Prediction Loss: 0.140870
Epoch 2049 
Prediction Loss: 0.135094
Epoch 2099 
Prediction Loss: 0.142670
Epoch 2149 
Prediction Loss: 0.138334
Epoch 2199 
Prediction Loss: 0.130181
Epoch 2249 
Prediction Loss: 0.130284
Epoch 2299 
Prediction Loss: 0.132420
Epoch 2349 
Prediction Loss: 0.132701
Epoch 2399 
Prediction Loss: 0.143702
Epoch 2449 
Prediction Loss: 0.127010
Epoch 2499 
Prediction Loss: 0.126545
Epoch 2549 
Prediction Loss: 0.120913
Epoch 2599 
Prediction Loss: 0.127789
Epoch 2649 
Prediction Loss: 0.128082
Epoch 2699 
Prediction Loss: 0.123656
Epoch 2749 
Prediction Loss: 0.117188
Epoch 2799 
Prediction Loss: 0.118261
Epoch 2849 
Prediction Loss: 0.119927
Epoch 2899 
Prediction Loss: 0.118878
Epoch 2949 
Prediction Loss: 0.111698
Epoch 2999 
Prediction Loss: 0.116756
Epoch 3049 
Prediction Loss: 0.117868
Epoch 3099 
Prediction Loss: 0.111364
Epoch 3149 
Prediction Loss: 0.109715
Epoch 3199 
Prediction Loss: 0.108123
Epoch 3249 
Prediction Loss: 0.108679
Epoch 3299 
Prediction Loss: 0.106703
Epoch 3349 
Prediction Loss: 0.108355
Epoch 3399 
Prediction Loss: 0.109667
Epoch 3449 
Prediction Loss: 0.107490
Epoch 3499 
Prediction Loss: 0.103958
Epoch 3549 
Prediction Loss: 0.114150
Epoch 3599 
Prediction Loss: 0.108077
Epoch 3649 
Prediction Loss: 0.108273
Epoch 3699 
Prediction Loss: 0.104375
Epoch 3749 
Prediction Loss: 0.102553
Epoch 3799 
Prediction Loss: 0.105190
Epoch 3849 
Prediction Loss: 0.101925
Epoch 3899 
Prediction Loss: 0.101083
Epoch 3949 
Prediction Loss: 0.109347
Epoch 3999 
Prediction Loss: 0.103146
Epoch 4049 
Prediction Loss: 0.106680
Epoch 4099 
Prediction Loss: 0.102182
Epoch 4149 
Prediction Loss: 0.101224
Epoch 4199 
Prediction Loss: 0.104019
Epoch 4249 
Prediction Loss: 0.105580
Epoch 4299 
Prediction Loss: 0.111382
Epoch 4349 
Prediction Loss: 0.108496
Epoch 4399 
Prediction Loss: 0.099022
Epoch 4449 
Prediction Loss: 0.107704
Epoch 4499 
Prediction Loss: 0.094344
Epoch 4549 
Prediction Loss: 0.106704
Epoch 4599 
Prediction Loss: 0.108839
Epoch 4649 
Prediction Loss: 0.105542
Epoch 4699 
Prediction Loss: 0.095693
Epoch 4749 
Prediction Loss: 0.095908
Epoch 4799 
Prediction Loss: 0.095699
Epoch 4849 
Prediction Loss: 0.097583
Epoch 4899 
Prediction Loss: 0.093148
Epoch 4949 
Prediction Loss: 0.093177
Epoch 4999 
Prediction Loss: 0.098716
Epoch 5049 
Prediction Loss: 0.097802
Epoch 5099 
Prediction Loss: 0.090737
Epoch 5149 
Prediction Loss: 0.091935
Epoch 5199 
Prediction Loss: 0.102648
Epoch 5249 
Prediction Loss: 0.090645
Epoch 5299 
Prediction Loss: 0.091811
Epoch 5349 
Prediction Loss: 0.089268
Epoch 5399 
Prediction Loss: 0.092204
Epoch 5449 
Prediction Loss: 0.097099
Epoch 5499 
Prediction Loss: 0.092722
Epoch 5549 
Prediction Loss: 0.099765
Epoch 5599 
Prediction Loss: 0.089330
Epoch 5649 
Prediction Loss: 0.089687
Epoch 5699 
Prediction Loss: 0.096020
Epoch 5749 
Prediction Loss: 0.088210
Epoch 5799 
Prediction Loss: 0.098686
Epoch 5849 
Prediction Loss: 0.090809
Epoch 5899 
Prediction Loss: 0.086842
Epoch 5949 
Prediction Loss: 0.096574
Epoch 5999 
Prediction Loss: 0.086017
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.293750
Insample Error 1.307406
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.798878
Rec Loss: 11.032459
KL Loss: 0.766419
Y Loss: 0.652718
T Loss: 10.706100
Epoch 99 
Overall Loss: 11.637425
Rec Loss: 10.954694
KL Loss: 0.682731
Y Loss: 0.485290
T Loss: 10.712049
Epoch 149 
Overall Loss: 11.550690
Rec Loss: 10.916354
KL Loss: 0.634336
Y Loss: 0.404527
T Loss: 10.714091
Epoch 199 
Overall Loss: 11.512131
Rec Loss: 10.889615
KL Loss: 0.622516
Y Loss: 0.382141
T Loss: 10.698544
Epoch 249 
Overall Loss: 11.495005
Rec Loss: 10.879095
KL Loss: 0.615910
Y Loss: 0.365653
T Loss: 10.696268
Epoch 299 
Overall Loss: 11.476261
Rec Loss: 10.867309
KL Loss: 0.608951
Y Loss: 0.357835
T Loss: 10.688392
Epoch 349 
Overall Loss: 11.476628
Rec Loss: 10.863527
KL Loss: 0.613101
Y Loss: 0.356965
T Loss: 10.685045
Epoch 399 
Overall Loss: 11.469774
Rec Loss: 10.869136
KL Loss: 0.600638
Y Loss: 0.351412
T Loss: 10.693430
Epoch 449 
Overall Loss: 11.462545
Rec Loss: 10.860049
KL Loss: 0.602496
Y Loss: 0.351173
T Loss: 10.684463
Epoch 499 
Overall Loss: 11.460876
Rec Loss: 10.871438
KL Loss: 0.589437
Y Loss: 0.348780
T Loss: 10.697049
Epoch 549 
Overall Loss: 11.440460
Rec Loss: 10.852912
KL Loss: 0.587548
Y Loss: 0.337082
T Loss: 10.684371
Epoch 599 
Overall Loss: 11.444727
Rec Loss: 10.863240
KL Loss: 0.581487
Y Loss: 0.338740
T Loss: 10.693870
Epoch 649 
Overall Loss: 11.437187
Rec Loss: 10.860838
KL Loss: 0.576350
Y Loss: 0.332158
T Loss: 10.694759
Epoch 699 
Overall Loss: 11.430287
Rec Loss: 10.848936
KL Loss: 0.581351
Y Loss: 0.328663
T Loss: 10.684605
Epoch 749 
Overall Loss: 11.426482
Rec Loss: 10.854978
KL Loss: 0.571504
Y Loss: 0.327479
T Loss: 10.691238
Epoch 799 
Overall Loss: 11.417079
Rec Loss: 10.842865
KL Loss: 0.574214
Y Loss: 0.327938
T Loss: 10.678896
Epoch 849 
Overall Loss: 11.421705
Rec Loss: 10.855075
KL Loss: 0.566630
Y Loss: 0.324930
T Loss: 10.692610
Epoch 899 
Overall Loss: 11.410664
Rec Loss: 10.848501
KL Loss: 0.562164
Y Loss: 0.323403
T Loss: 10.686799
Epoch 949 
Overall Loss: 11.401248
Rec Loss: 10.843143
KL Loss: 0.558105
Y Loss: 0.323272
T Loss: 10.681508
Epoch 999 
Overall Loss: 11.406456
Rec Loss: 10.837931
KL Loss: 0.568525
Y Loss: 0.323495
T Loss: 10.676184
Epoch 1049 
Overall Loss: 11.390214
Rec Loss: 10.825259
KL Loss: 0.564955
Y Loss: 0.314518
T Loss: 10.668000
Epoch 1099 
Overall Loss: 11.398189
Rec Loss: 10.824502
KL Loss: 0.573687
Y Loss: 0.321213
T Loss: 10.663896
Epoch 1149 
Overall Loss: 11.370477
Rec Loss: 10.810313
KL Loss: 0.560164
Y Loss: 0.320592
T Loss: 10.650017
Epoch 1199 
Overall Loss: 11.377210
Rec Loss: 10.804380
KL Loss: 0.572830
Y Loss: 0.314373
T Loss: 10.647193
Epoch 1249 
Overall Loss: 11.366979
Rec Loss: 10.820029
KL Loss: 0.546950
Y Loss: 0.316231
T Loss: 10.661913
Epoch 1299 
Overall Loss: 11.399433
Rec Loss: 10.820199
KL Loss: 0.579234
Y Loss: 0.312042
T Loss: 10.664177
Epoch 1349 
Overall Loss: 11.351894
Rec Loss: 10.787034
KL Loss: 0.564861
Y Loss: 0.312402
T Loss: 10.630833
Epoch 1399 
Overall Loss: 11.402857
Rec Loss: 10.813848
KL Loss: 0.589009
Y Loss: 0.316524
T Loss: 10.655586
Epoch 1449 
Overall Loss: 11.353580
Rec Loss: 10.795481
KL Loss: 0.558099
Y Loss: 0.309211
T Loss: 10.640876
Epoch 1499 
Overall Loss: 11.355256
Rec Loss: 10.799193
KL Loss: 0.556062
Y Loss: 0.308900
T Loss: 10.644744
Epoch 1549 
Overall Loss: 11.353551
Rec Loss: 10.790880
KL Loss: 0.562671
Y Loss: 0.308900
T Loss: 10.636431
Epoch 1599 
Overall Loss: 11.355321
Rec Loss: 10.786723
KL Loss: 0.568599
Y Loss: 0.312014
T Loss: 10.630716
Epoch 1649 
Overall Loss: 11.364680
Rec Loss: 10.794256
KL Loss: 0.570423
Y Loss: 0.308173
T Loss: 10.640170
Epoch 1699 
Overall Loss: 11.358483
Rec Loss: 10.786289
KL Loss: 0.572194
Y Loss: 0.305354
T Loss: 10.633612
Epoch 1749 
Overall Loss: 11.350338
Rec Loss: 10.778429
KL Loss: 0.571909
Y Loss: 0.302459
T Loss: 10.627200
Epoch 1799 
Overall Loss: 11.350819
Rec Loss: 10.770886
KL Loss: 0.579933
Y Loss: 0.309940
T Loss: 10.615916
Epoch 1849 
Overall Loss: 11.342781
Rec Loss: 10.776815
KL Loss: 0.565966
Y Loss: 0.307453
T Loss: 10.623088
Epoch 1899 
Overall Loss: 11.348759
Rec Loss: 10.790827
KL Loss: 0.557932
Y Loss: 0.309810
T Loss: 10.635922
Epoch 1949 
Overall Loss: 11.325665
Rec Loss: 10.760520
KL Loss: 0.565145
Y Loss: 0.302331
T Loss: 10.609354
Epoch 1999 
Overall Loss: 11.310380
Rec Loss: 10.750295
KL Loss: 0.560085
Y Loss: 0.306301
T Loss: 10.597145
Epoch 2049 
Overall Loss: 11.335862
Rec Loss: 10.766298
KL Loss: 0.569565
Y Loss: 0.307655
T Loss: 10.612470
Epoch 2099 
Overall Loss: 11.319950
Rec Loss: 10.768452
KL Loss: 0.551498
Y Loss: 0.297515
T Loss: 10.619695
Epoch 2149 
Overall Loss: 11.338324
Rec Loss: 10.761955
KL Loss: 0.576369
Y Loss: 0.310224
T Loss: 10.606843
Epoch 2199 
Overall Loss: 11.310017
Rec Loss: 10.757539
KL Loss: 0.552479
Y Loss: 0.296561
T Loss: 10.609258
Epoch 2249 
Overall Loss: 11.286225
Rec Loss: 10.738869
KL Loss: 0.547356
Y Loss: 0.303706
T Loss: 10.587016
Epoch 2299 
Overall Loss: 11.300544
Rec Loss: 10.740824
KL Loss: 0.559719
Y Loss: 0.299275
T Loss: 10.591187
Epoch 2349 
Overall Loss: 11.309627
Rec Loss: 10.750837
KL Loss: 0.558790
Y Loss: 0.293531
T Loss: 10.604072
Epoch 2399 
Overall Loss: 11.310692
Rec Loss: 10.747846
KL Loss: 0.562846
Y Loss: 0.304789
T Loss: 10.595451
Epoch 2449 
Overall Loss: 11.305058
Rec Loss: 10.745419
KL Loss: 0.559639
Y Loss: 0.293372
T Loss: 10.598733
Epoch 2499 
Overall Loss: 11.301203
Rec Loss: 10.748279
KL Loss: 0.552924
Y Loss: 0.295001
T Loss: 10.600779
Epoch 2549 
Overall Loss: 11.293005
Rec Loss: 10.735112
KL Loss: 0.557892
Y Loss: 0.297476
T Loss: 10.586374
Epoch 2599 
Overall Loss: 11.277555
Rec Loss: 10.733389
KL Loss: 0.544165
Y Loss: 0.293995
T Loss: 10.586392
Epoch 2649 
Overall Loss: 11.291933
Rec Loss: 10.725459
KL Loss: 0.566474
Y Loss: 0.292280
T Loss: 10.579319
Epoch 2699 
Overall Loss: 11.288391
Rec Loss: 10.720368
KL Loss: 0.568023
Y Loss: 0.289735
T Loss: 10.575501
Epoch 2749 
Overall Loss: 11.285215
Rec Loss: 10.726775
KL Loss: 0.558440
Y Loss: 0.290399
T Loss: 10.581575
Epoch 2799 
Overall Loss: 11.274964
Rec Loss: 10.715920
KL Loss: 0.559044
Y Loss: 0.287152
T Loss: 10.572344
Epoch 2849 
Overall Loss: 11.299560
Rec Loss: 10.724776
KL Loss: 0.574785
Y Loss: 0.294426
T Loss: 10.577563
Epoch 2899 
Overall Loss: 11.279367
Rec Loss: 10.713908
KL Loss: 0.565459
Y Loss: 0.296827
T Loss: 10.565495
Epoch 2949 
Overall Loss: 11.266910
Rec Loss: 10.707810
KL Loss: 0.559101
Y Loss: 0.293053
T Loss: 10.561283
Epoch 2999 
Overall Loss: 11.273081
Rec Loss: 10.704762
KL Loss: 0.568319
Y Loss: 0.288479
T Loss: 10.560523
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.540926
Epoch 99
Rec Loss: 0.526638
Epoch 149
Rec Loss: 0.528231
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.014611
Epoch 99
Rec Loss: 9.996074
Epoch 149
Rec Loss: 9.965940
Epoch 199
Rec Loss: 9.962332
Epoch 249
Rec Loss: 9.950023
Epoch 299
Rec Loss: 9.942578
Epoch 349
Rec Loss: 9.931809
Epoch 399
Rec Loss: 9.942137
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.518036
Insample Error: 1.131209
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.106095
Rec Loss: 18.409921
KL Loss: 2.696174
Y Loss: 5.075477
T Loss: 13.393367
X Loss: 2.478815
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.501657
Epoch 99
Rec Loss: 3.512371
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 3.163152
Epoch 99
Rec Loss: 3.221569
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 1.696326
Insample Error 2.360491
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.402196
Epoch 99 
Prediction Loss: 0.359720
Epoch 149 
Prediction Loss: 0.334845
Epoch 199 
Prediction Loss: 0.311456
Epoch 249 
Prediction Loss: 0.295495
Epoch 299 
Prediction Loss: 0.298905
Epoch 349 
Prediction Loss: 0.297096
Epoch 399 
Prediction Loss: 0.275813
Epoch 449 
Prediction Loss: 0.267168
Epoch 499 
Prediction Loss: 0.259744
Epoch 549 
Prediction Loss: 0.269907
Epoch 599 
Prediction Loss: 0.259895
Epoch 649 
Prediction Loss: 0.244836
Epoch 699 
Prediction Loss: 0.240015
Epoch 749 
Prediction Loss: 0.232458
Epoch 799 
Prediction Loss: 0.233141
Epoch 849 
Prediction Loss: 0.224986
Epoch 899 
Prediction Loss: 0.213433
Epoch 949 
Prediction Loss: 0.214418
Epoch 999 
Prediction Loss: 0.207312
Epoch 1049 
Prediction Loss: 0.200222
Epoch 1099 
Prediction Loss: 0.195473
Epoch 1149 
Prediction Loss: 0.197392
Epoch 1199 
Prediction Loss: 0.184501
Epoch 1249 
Prediction Loss: 0.182578
Epoch 1299 
Prediction Loss: 0.175860
Epoch 1349 
Prediction Loss: 0.174578
Epoch 1399 
Prediction Loss: 0.173753
Epoch 1449 
Prediction Loss: 0.165038
Epoch 1499 
Prediction Loss: 0.163276
Epoch 1549 
Prediction Loss: 0.157138
Epoch 1599 
Prediction Loss: 0.159055
Epoch 1649 
Prediction Loss: 0.154631
Epoch 1699 
Prediction Loss: 0.151951
Epoch 1749 
Prediction Loss: 0.149222
Epoch 1799 
Prediction Loss: 0.147619
Epoch 1849 
Prediction Loss: 0.143413
Epoch 1899 
Prediction Loss: 0.138386
Epoch 1949 
Prediction Loss: 0.136779
Epoch 1999 
Prediction Loss: 0.132753
Epoch 2049 
Prediction Loss: 0.133178
Epoch 2099 
Prediction Loss: 0.132940
Epoch 2149 
Prediction Loss: 0.129806
Epoch 2199 
Prediction Loss: 0.123922
Epoch 2249 
Prediction Loss: 0.124862
Epoch 2299 
Prediction Loss: 0.135540
Epoch 2349 
Prediction Loss: 0.120677
Epoch 2399 
Prediction Loss: 0.119049
Epoch 2449 
Prediction Loss: 0.119611
Epoch 2499 
Prediction Loss: 0.130894
Epoch 2549 
Prediction Loss: 0.117440
Epoch 2599 
Prediction Loss: 0.116348
Epoch 2649 
Prediction Loss: 0.116736
Epoch 2699 
Prediction Loss: 0.114177
Epoch 2749 
Prediction Loss: 0.116555
Epoch 2799 
Prediction Loss: 0.109978
Epoch 2849 
Prediction Loss: 0.112258
Epoch 2899 
Prediction Loss: 0.108223
Epoch 2949 
Prediction Loss: 0.104208
Epoch 2999 
Prediction Loss: 0.109016
Epoch 3049 
Prediction Loss: 0.104430
Epoch 3099 
Prediction Loss: 0.104806
Epoch 3149 
Prediction Loss: 0.106523
Epoch 3199 
Prediction Loss: 0.115027
Epoch 3249 
Prediction Loss: 0.108749
Epoch 3299 
Prediction Loss: 0.105228
Epoch 3349 
Prediction Loss: 0.104328
Epoch 3399 
Prediction Loss: 0.103454
Epoch 3449 
Prediction Loss: 0.101269
Epoch 3499 
Prediction Loss: 0.110794
Epoch 3549 
Prediction Loss: 0.098303
Epoch 3599 
Prediction Loss: 0.099875
Epoch 3649 
Prediction Loss: 0.098564
Epoch 3699 
Prediction Loss: 0.097566
Epoch 3749 
Prediction Loss: 0.097515
Epoch 3799 
Prediction Loss: 0.107056
Epoch 3849 
Prediction Loss: 0.099500
Epoch 3899 
Prediction Loss: 0.094722
Epoch 3949 
Prediction Loss: 0.095302
Epoch 3999 
Prediction Loss: 0.098554
Epoch 4049 
Prediction Loss: 0.094808
Epoch 4099 
Prediction Loss: 0.107506
Epoch 4149 
Prediction Loss: 0.092145
Epoch 4199 
Prediction Loss: 0.095686
Epoch 4249 
Prediction Loss: 0.092700
Epoch 4299 
Prediction Loss: 0.092605
Epoch 4349 
Prediction Loss: 0.092533
Epoch 4399 
Prediction Loss: 0.090782
Epoch 4449 
Prediction Loss: 0.091883
Epoch 4499 
Prediction Loss: 0.090743
Epoch 4549 
Prediction Loss: 0.091339
Epoch 4599 
Prediction Loss: 0.091084
Epoch 4649 
Prediction Loss: 0.091369
Epoch 4699 
Prediction Loss: 0.087469
Epoch 4749 
Prediction Loss: 0.089447
Epoch 4799 
Prediction Loss: 0.097447
Epoch 4849 
Prediction Loss: 0.088610
Epoch 4899 
Prediction Loss: 0.089805
Epoch 4949 
Prediction Loss: 0.097406
Epoch 4999 
Prediction Loss: 0.098131
Epoch 5049 
Prediction Loss: 0.087612
Epoch 5099 
Prediction Loss: 0.089257
Epoch 5149 
Prediction Loss: 0.087818
Epoch 5199 
Prediction Loss: 0.089422
Epoch 5249 
Prediction Loss: 0.085997
Epoch 5299 
Prediction Loss: 0.084906
Epoch 5349 
Prediction Loss: 0.084857
Epoch 5399 
Prediction Loss: 0.081402
Epoch 5449 
Prediction Loss: 0.087221
Epoch 5499 
Prediction Loss: 0.090789
Epoch 5549 
Prediction Loss: 0.083960
Epoch 5599 
Prediction Loss: 0.084344
Epoch 5649 
Prediction Loss: 0.080789
Epoch 5699 
Prediction Loss: 0.095177
Epoch 5749 
Prediction Loss: 0.083837
Epoch 5799 
Prediction Loss: 0.092112
Epoch 5849 
Prediction Loss: 0.089626
Epoch 5899 
Prediction Loss: 0.081611
Epoch 5949 
Prediction Loss: 0.083742
Epoch 5999 
Prediction Loss: 0.085271
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.286165
Insample Error 1.264844
Ours, Train RMSE
0.5112, 
0.5081, 
0.5180, 
CEVAE, Train RMSE
1.6028, 
1.7264, 
1.6963, 
Ours, Insample RMSE
1.1271, 
1.1201, 
1.1312, 
CEVAE, Insample RMSE
2.3259, 
2.4726, 
2.3605, 
Direct Regression, Insample RMSE
1.2675, 
1.3074, 
1.2648, 
Train, RMSE mean 0.5125 std 0.0041
CEVAE, RMSE mean 1.6752 std 0.0526
Ours, RMSE mean 1.1261 std 0.0046, reconstruct confounder 0.5303 (0.0044) noise 9.9343 (0.0061)
CEVAE, RMSE mean 2.3863 std 0.0626, reconstruct confounder 3.4971 (0.0043) noise 3.0975 (0.0570)
Direct Regression, RMSE mean 1.2799 std 0.0195
Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=5, mask=0, nlayer=50, obsm=4, stop=5000, ycof=0.5, ylayer=50)
Y Mean 2.635484, Std 4.326354 
Test Y Mean 0.032706, Std 4.125860 
Observe confounder 4, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.869542
Rec Loss: 10.720041
KL Loss: 1.149500
Y Loss: 0.864154
T Loss: 10.287964
Epoch 99 
Overall Loss: 11.599583
Rec Loss: 10.696368
KL Loss: 0.903215
Y Loss: 0.665509
T Loss: 10.363613
Epoch 149 
Overall Loss: 11.525933
Rec Loss: 10.715218
KL Loss: 0.810715
Y Loss: 0.636897
T Loss: 10.396769
Epoch 199 
Overall Loss: 11.473342
Rec Loss: 10.704109
KL Loss: 0.769233
Y Loss: 0.608626
T Loss: 10.399795
Epoch 249 
Overall Loss: 11.446704
Rec Loss: 10.696895
KL Loss: 0.749809
Y Loss: 0.585235
T Loss: 10.404277
Epoch 299 
Overall Loss: 11.426611
Rec Loss: 10.688958
KL Loss: 0.737653
Y Loss: 0.565146
T Loss: 10.406385
Epoch 349 
Overall Loss: 11.417233
Rec Loss: 10.676787
KL Loss: 0.740446
Y Loss: 0.561560
T Loss: 10.396007
Epoch 399 
Overall Loss: 11.399521
Rec Loss: 10.688473
KL Loss: 0.711049
Y Loss: 0.561578
T Loss: 10.407684
Epoch 449 
Overall Loss: 11.392411
Rec Loss: 10.690093
KL Loss: 0.702317
Y Loss: 0.546243
T Loss: 10.416972
Epoch 499 
Overall Loss: 11.378196
Rec Loss: 10.658982
KL Loss: 0.719214
Y Loss: 0.529093
T Loss: 10.394436
Epoch 549 
Overall Loss: 11.357747
Rec Loss: 10.659403
KL Loss: 0.698344
Y Loss: 0.537274
T Loss: 10.390766
Epoch 599 
Overall Loss: 11.348235
Rec Loss: 10.661825
KL Loss: 0.686410
Y Loss: 0.516322
T Loss: 10.403664
Epoch 649 
Overall Loss: 11.353434
Rec Loss: 10.652716
KL Loss: 0.700718
Y Loss: 0.539325
T Loss: 10.383053
Epoch 699 
Overall Loss: 11.339647
Rec Loss: 10.651689
KL Loss: 0.687959
Y Loss: 0.526297
T Loss: 10.388540
Epoch 749 
Overall Loss: 11.330875
Rec Loss: 10.639156
KL Loss: 0.691719
Y Loss: 0.518053
T Loss: 10.380129
Epoch 799 
Overall Loss: 11.327842
Rec Loss: 10.644124
KL Loss: 0.683718
Y Loss: 0.514591
T Loss: 10.386828
Epoch 849 
Overall Loss: 11.317947
Rec Loss: 10.649098
KL Loss: 0.668849
Y Loss: 0.514502
T Loss: 10.391847
Epoch 899 
Overall Loss: 11.323409
Rec Loss: 10.647254
KL Loss: 0.676155
Y Loss: 0.515162
T Loss: 10.389673
Epoch 949 
Overall Loss: 11.307872
Rec Loss: 10.631230
KL Loss: 0.676642
Y Loss: 0.503987
T Loss: 10.379237
Epoch 999 
Overall Loss: 11.316177
Rec Loss: 10.631305
KL Loss: 0.684873
Y Loss: 0.496965
T Loss: 10.382822
Epoch 1049 
Overall Loss: 11.298072
Rec Loss: 10.608029
KL Loss: 0.690042
Y Loss: 0.484183
T Loss: 10.365938
Epoch 1099 
Overall Loss: 11.306765
Rec Loss: 10.628983
KL Loss: 0.677782
Y Loss: 0.498796
T Loss: 10.379585
Epoch 1149 
Overall Loss: 11.291956
Rec Loss: 10.609562
KL Loss: 0.682395
Y Loss: 0.490965
T Loss: 10.364079
Epoch 1199 
Overall Loss: 11.287216
Rec Loss: 10.613830
KL Loss: 0.673386
Y Loss: 0.502955
T Loss: 10.362353
Epoch 1249 
Overall Loss: 11.278376
Rec Loss: 10.596846
KL Loss: 0.681530
Y Loss: 0.493330
T Loss: 10.350181
Epoch 1299 
Overall Loss: 11.274663
Rec Loss: 10.612240
KL Loss: 0.662423
Y Loss: 0.484340
T Loss: 10.370070
Epoch 1349 
Overall Loss: 11.265303
Rec Loss: 10.589978
KL Loss: 0.675325
Y Loss: 0.487052
T Loss: 10.346452
Epoch 1399 
Overall Loss: 11.296338
Rec Loss: 10.615945
KL Loss: 0.680393
Y Loss: 0.494696
T Loss: 10.368597
Epoch 1449 
Overall Loss: 11.268016
Rec Loss: 10.583658
KL Loss: 0.684357
Y Loss: 0.479756
T Loss: 10.343781
Epoch 1499 
Overall Loss: 11.261341
Rec Loss: 10.583125
KL Loss: 0.678216
Y Loss: 0.469413
T Loss: 10.348418
Epoch 1549 
Overall Loss: 11.255238
Rec Loss: 10.581183
KL Loss: 0.674054
Y Loss: 0.475003
T Loss: 10.343682
Epoch 1599 
Overall Loss: 11.257930
Rec Loss: 10.584952
KL Loss: 0.672978
Y Loss: 0.485424
T Loss: 10.342240
Epoch 1649 
Overall Loss: 11.253099
Rec Loss: 10.594231
KL Loss: 0.658867
Y Loss: 0.470033
T Loss: 10.359215
Epoch 1699 
Overall Loss: 11.253122
Rec Loss: 10.564969
KL Loss: 0.688153
Y Loss: 0.465745
T Loss: 10.332096
Epoch 1749 
Overall Loss: 11.248231
Rec Loss: 10.582805
KL Loss: 0.665426
Y Loss: 0.474846
T Loss: 10.345382
Epoch 1799 
Overall Loss: 11.231524
Rec Loss: 10.562443
KL Loss: 0.669081
Y Loss: 0.461123
T Loss: 10.331882
Epoch 1849 
Overall Loss: 11.233215
Rec Loss: 10.566720
KL Loss: 0.666495
Y Loss: 0.467355
T Loss: 10.333043
Epoch 1899 
Overall Loss: 11.234613
Rec Loss: 10.571809
KL Loss: 0.662804
Y Loss: 0.472270
T Loss: 10.335674
Epoch 1949 
Overall Loss: 11.227058
Rec Loss: 10.545562
KL Loss: 0.681496
Y Loss: 0.456816
T Loss: 10.317154
Epoch 1999 
Overall Loss: 11.226852
Rec Loss: 10.557382
KL Loss: 0.669470
Y Loss: 0.464023
T Loss: 10.325370
Epoch 2049 
Overall Loss: 11.218979
Rec Loss: 10.558834
KL Loss: 0.660145
Y Loss: 0.456475
T Loss: 10.330596
Epoch 2099 
Overall Loss: 11.210728
Rec Loss: 10.552238
KL Loss: 0.658490
Y Loss: 0.456228
T Loss: 10.324124
Epoch 2149 
Overall Loss: 11.214138
Rec Loss: 10.544209
KL Loss: 0.669929
Y Loss: 0.459141
T Loss: 10.314638
Epoch 2199 
Overall Loss: 11.224397
Rec Loss: 10.543169
KL Loss: 0.681227
Y Loss: 0.453050
T Loss: 10.316645
Epoch 2249 
Overall Loss: 11.195233
Rec Loss: 10.540352
KL Loss: 0.654881
Y Loss: 0.455807
T Loss: 10.312449
Epoch 2299 
Overall Loss: 11.194911
Rec Loss: 10.527567
KL Loss: 0.667345
Y Loss: 0.457752
T Loss: 10.298691
Epoch 2349 
Overall Loss: 11.199253
Rec Loss: 10.551297
KL Loss: 0.647956
Y Loss: 0.452866
T Loss: 10.324864
Epoch 2399 
Overall Loss: 11.191345
Rec Loss: 10.530474
KL Loss: 0.660871
Y Loss: 0.447460
T Loss: 10.306745
Epoch 2449 
Overall Loss: 11.197371
Rec Loss: 10.523248
KL Loss: 0.674123
Y Loss: 0.448017
T Loss: 10.299239
Epoch 2499 
Overall Loss: 11.192203
Rec Loss: 10.533682
KL Loss: 0.658521
Y Loss: 0.445671
T Loss: 10.310846
Epoch 2549 
Overall Loss: 11.191725
Rec Loss: 10.525505
KL Loss: 0.666220
Y Loss: 0.446085
T Loss: 10.302463
Epoch 2599 
Overall Loss: 11.191899
Rec Loss: 10.530208
KL Loss: 0.661691
Y Loss: 0.452290
T Loss: 10.304063
Epoch 2649 
Overall Loss: 11.171682
Rec Loss: 10.513705
KL Loss: 0.657977
Y Loss: 0.436174
T Loss: 10.295618
Epoch 2699 
Overall Loss: 11.191848
Rec Loss: 10.517404
KL Loss: 0.674444
Y Loss: 0.447926
T Loss: 10.293441
Epoch 2749 
Overall Loss: 11.175796
Rec Loss: 10.522305
KL Loss: 0.653491
Y Loss: 0.446840
T Loss: 10.298885
Epoch 2799 
Overall Loss: 11.175383
Rec Loss: 10.516437
KL Loss: 0.658946
Y Loss: 0.438026
T Loss: 10.297424
Epoch 2849 
Overall Loss: 11.178717
Rec Loss: 10.512918
KL Loss: 0.665799
Y Loss: 0.445238
T Loss: 10.290299
Epoch 2899 
Overall Loss: 11.165069
Rec Loss: 10.501209
KL Loss: 0.663860
Y Loss: 0.435040
T Loss: 10.283689
Epoch 2949 
Overall Loss: 11.185282
Rec Loss: 10.510467
KL Loss: 0.674815
Y Loss: 0.447990
T Loss: 10.286472
Epoch 2999 
Overall Loss: 11.163566
Rec Loss: 10.496417
KL Loss: 0.667150
Y Loss: 0.426924
T Loss: 10.282955
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.428805
Epoch 99
Rec Loss: 0.420852
Epoch 149
Rec Loss: 0.415710
Epoch 199
Rec Loss: 0.419533
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.937440
Epoch 99
Rec Loss: 9.911376
Epoch 149
Rec Loss: 9.918724
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.612031
Insample Error: 1.449132
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.795792
Rec Loss: 19.786940
KL Loss: 3.008852
Y Loss: 8.445815
T Loss: 12.927035
X Loss: 2.636998
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.573690
Epoch 99
Rec Loss: 3.563253
Epoch 149
Rec Loss: 3.561516
Epoch 199
Rec Loss: 3.569696
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 3.221751
Epoch 99
Rec Loss: 3.227564
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.303373
Insample Error 3.467967
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.752124
Epoch 99 
Prediction Loss: 0.624236
Epoch 149 
Prediction Loss: 0.613498
Epoch 199 
Prediction Loss: 0.583125
Epoch 249 
Prediction Loss: 0.583654
Epoch 299 
Prediction Loss: 0.532600
Epoch 349 
Prediction Loss: 0.503548
Epoch 399 
Prediction Loss: 0.517817
Epoch 449 
Prediction Loss: 0.481195
Epoch 499 
Prediction Loss: 0.493822
Epoch 549 
Prediction Loss: 0.451061
Epoch 599 
Prediction Loss: 0.446269
Epoch 649 
Prediction Loss: 0.433370
Epoch 699 
Prediction Loss: 0.412121
Epoch 749 
Prediction Loss: 0.399801
Epoch 799 
Prediction Loss: 0.376392
Epoch 849 
Prediction Loss: 0.377773
Epoch 899 
Prediction Loss: 0.368888
Epoch 949 
Prediction Loss: 0.351357
Epoch 999 
Prediction Loss: 0.333848
Epoch 1049 
Prediction Loss: 0.326583
Epoch 1099 
Prediction Loss: 0.332414
Epoch 1149 
Prediction Loss: 0.308022
Epoch 1199 
Prediction Loss: 0.306897
Epoch 1249 
Prediction Loss: 0.289876
Epoch 1299 
Prediction Loss: 0.300503
Epoch 1349 
Prediction Loss: 0.276839
Epoch 1399 
Prediction Loss: 0.272484
Epoch 1449 
Prediction Loss: 0.267299
Epoch 1499 
Prediction Loss: 0.256227
Epoch 1549 
Prediction Loss: 0.250153
Epoch 1599 
Prediction Loss: 0.243414
Epoch 1649 
Prediction Loss: 0.239495
Epoch 1699 
Prediction Loss: 0.228724
Epoch 1749 
Prediction Loss: 0.263085
Epoch 1799 
Prediction Loss: 0.229101
Epoch 1849 
Prediction Loss: 0.225429
Epoch 1899 
Prediction Loss: 0.230494
Epoch 1949 
Prediction Loss: 0.222885
Epoch 1999 
Prediction Loss: 0.236913
Epoch 2049 
Prediction Loss: 0.208407
Epoch 2099 
Prediction Loss: 0.222573
Epoch 2149 
Prediction Loss: 0.209952
Epoch 2199 
Prediction Loss: 0.207184
Epoch 2249 
Prediction Loss: 0.200263
Epoch 2299 
Prediction Loss: 0.200180
Epoch 2349 
Prediction Loss: 0.192933
Epoch 2399 
Prediction Loss: 0.202905
Epoch 2449 
Prediction Loss: 0.183409
Epoch 2499 
Prediction Loss: 0.196923
Epoch 2549 
Prediction Loss: 0.197515
Epoch 2599 
Prediction Loss: 0.195874
Epoch 2649 
Prediction Loss: 0.177707
Epoch 2699 
Prediction Loss: 0.186684
Epoch 2749 
Prediction Loss: 0.177277
Epoch 2799 
Prediction Loss: 0.177109
Epoch 2849 
Prediction Loss: 0.177221
Epoch 2899 
Prediction Loss: 0.189070
Epoch 2949 
Prediction Loss: 0.177757
Epoch 2999 
Prediction Loss: 0.177476
Epoch 3049 
Prediction Loss: 0.171818
Epoch 3099 
Prediction Loss: 0.171217
Epoch 3149 
Prediction Loss: 0.169773
Epoch 3199 
Prediction Loss: 0.167009
Epoch 3249 
Prediction Loss: 0.177425
Epoch 3299 
Prediction Loss: 0.166342
Epoch 3349 
Prediction Loss: 0.194571
Epoch 3399 
Prediction Loss: 0.161295
Epoch 3449 
Prediction Loss: 0.162499
Epoch 3499 
Prediction Loss: 0.159824
Epoch 3549 
Prediction Loss: 0.160993
Epoch 3599 
Prediction Loss: 0.178293
Epoch 3649 
Prediction Loss: 0.155815
Epoch 3699 
Prediction Loss: 0.154873
Epoch 3749 
Prediction Loss: 0.153502
Epoch 3799 
Prediction Loss: 0.162946
Epoch 3849 
Prediction Loss: 0.154326
Epoch 3899 
Prediction Loss: 0.160382
Epoch 3949 
Prediction Loss: 0.155517
Epoch 3999 
Prediction Loss: 0.157725
Epoch 4049 
Prediction Loss: 0.158026
Epoch 4099 
Prediction Loss: 0.157076
Epoch 4149 
Prediction Loss: 0.149490
Epoch 4199 
Prediction Loss: 0.153339
Epoch 4249 
Prediction Loss: 0.148196
Epoch 4299 
Prediction Loss: 0.145797
Epoch 4349 
Prediction Loss: 0.144701
Epoch 4399 
Prediction Loss: 0.144664
Epoch 4449 
Prediction Loss: 0.146693
Epoch 4499 
Prediction Loss: 0.150985
Epoch 4549 
Prediction Loss: 0.149780
Epoch 4599 
Prediction Loss: 0.146975
Epoch 4649 
Prediction Loss: 0.165073
Epoch 4699 
Prediction Loss: 0.146798
Epoch 4749 
Prediction Loss: 0.150471
Epoch 4799 
Prediction Loss: 0.149200
Epoch 4849 
Prediction Loss: 0.145959
Epoch 4899 
Prediction Loss: 0.155001
Epoch 4949 
Prediction Loss: 0.140269
Epoch 4999 
Prediction Loss: 0.144200
Epoch 5049 
Prediction Loss: 0.142248
Epoch 5099 
Prediction Loss: 0.138810
Epoch 5149 
Prediction Loss: 0.150762
Epoch 5199 
Prediction Loss: 0.143726
Epoch 5249 
Prediction Loss: 0.145010
Epoch 5299 
Prediction Loss: 0.144582
Epoch 5349 
Prediction Loss: 0.139996
Epoch 5399 
Prediction Loss: 0.141590
Epoch 5449 
Prediction Loss: 0.139384
Epoch 5499 
Prediction Loss: 0.138336
Epoch 5549 
Prediction Loss: 0.135530
Epoch 5599 
Prediction Loss: 0.160460
Epoch 5649 
Prediction Loss: 0.135624
Epoch 5699 
Prediction Loss: 0.143030
Epoch 5749 
Prediction Loss: 0.131423
Epoch 5799 
Prediction Loss: 0.139074
Epoch 5849 
Prediction Loss: 0.133606
Epoch 5899 
Prediction Loss: 0.131140
Epoch 5949 
Prediction Loss: 0.135226
Epoch 5999 
Prediction Loss: 0.133190
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.364336
Insample Error 1.916319
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.845680
Rec Loss: 10.719623
KL Loss: 1.126057
Y Loss: 0.863103
T Loss: 10.288071
Epoch 99 
Overall Loss: 11.601543
Rec Loss: 10.727569
KL Loss: 0.873974
Y Loss: 0.695075
T Loss: 10.380032
Epoch 149 
Overall Loss: 11.507314
Rec Loss: 10.705640
KL Loss: 0.801674
Y Loss: 0.617474
T Loss: 10.396903
Epoch 199 
Overall Loss: 11.470264
Rec Loss: 10.694385
KL Loss: 0.775880
Y Loss: 0.587226
T Loss: 10.400771
Epoch 249 
Overall Loss: 11.441518
Rec Loss: 10.686480
KL Loss: 0.755038
Y Loss: 0.575623
T Loss: 10.398668
Epoch 299 
Overall Loss: 11.439177
Rec Loss: 10.684960
KL Loss: 0.754217
Y Loss: 0.582441
T Loss: 10.393739
Epoch 349 
Overall Loss: 11.430354
Rec Loss: 10.695239
KL Loss: 0.735115
Y Loss: 0.571983
T Loss: 10.409248
Epoch 399 
Overall Loss: 11.390647
Rec Loss: 10.672472
KL Loss: 0.718175
Y Loss: 0.558459
T Loss: 10.393243
Epoch 449 
Overall Loss: 11.380720
Rec Loss: 10.680988
KL Loss: 0.699733
Y Loss: 0.544726
T Loss: 10.408625
Epoch 499 
Overall Loss: 11.367411
Rec Loss: 10.667700
KL Loss: 0.699711
Y Loss: 0.554173
T Loss: 10.390614
Epoch 549 
Overall Loss: 11.381465
Rec Loss: 10.680718
KL Loss: 0.700747
Y Loss: 0.546049
T Loss: 10.407694
Epoch 599 
Overall Loss: 11.364983
Rec Loss: 10.666101
KL Loss: 0.698882
Y Loss: 0.537959
T Loss: 10.397121
Epoch 649 
Overall Loss: 11.356759
Rec Loss: 10.659621
KL Loss: 0.697138
Y Loss: 0.538349
T Loss: 10.390447
Epoch 699 
Overall Loss: 11.335980
Rec Loss: 10.641364
KL Loss: 0.694616
Y Loss: 0.520046
T Loss: 10.381341
Epoch 749 
Overall Loss: 11.345111
Rec Loss: 10.656676
KL Loss: 0.688434
Y Loss: 0.525593
T Loss: 10.393880
Epoch 799 
Overall Loss: 11.330740
Rec Loss: 10.645429
KL Loss: 0.685311
Y Loss: 0.515442
T Loss: 10.387708
Epoch 849 
Overall Loss: 11.335651
Rec Loss: 10.647379
KL Loss: 0.688272
Y Loss: 0.512056
T Loss: 10.391351
Epoch 899 
Overall Loss: 11.327816
Rec Loss: 10.642254
KL Loss: 0.685562
Y Loss: 0.520015
T Loss: 10.382246
Epoch 949 
Overall Loss: 11.318919
Rec Loss: 10.631648
KL Loss: 0.687271
Y Loss: 0.508839
T Loss: 10.377228
Epoch 999 
Overall Loss: 11.316678
Rec Loss: 10.636956
KL Loss: 0.679722
Y Loss: 0.509065
T Loss: 10.382424
Epoch 1049 
Overall Loss: 11.310879
Rec Loss: 10.627108
KL Loss: 0.683771
Y Loss: 0.508103
T Loss: 10.373057
Epoch 1099 
Overall Loss: 11.307958
Rec Loss: 10.631493
KL Loss: 0.676465
Y Loss: 0.518266
T Loss: 10.372360
Epoch 1149 
Overall Loss: 11.296895
Rec Loss: 10.626479
KL Loss: 0.670416
Y Loss: 0.496196
T Loss: 10.378380
Epoch 1199 
Overall Loss: 11.275246
Rec Loss: 10.606484
KL Loss: 0.668761
Y Loss: 0.485593
T Loss: 10.363688
Epoch 1249 
Overall Loss: 11.270284
Rec Loss: 10.603178
KL Loss: 0.667106
Y Loss: 0.488609
T Loss: 10.358873
Epoch 1299 
Overall Loss: 11.271474
Rec Loss: 10.610736
KL Loss: 0.660738
Y Loss: 0.493822
T Loss: 10.363825
Epoch 1349 
Overall Loss: 11.276954
Rec Loss: 10.610356
KL Loss: 0.666599
Y Loss: 0.492699
T Loss: 10.364007
Epoch 1399 
Overall Loss: 11.268317
Rec Loss: 10.595179
KL Loss: 0.673138
Y Loss: 0.491603
T Loss: 10.349377
Epoch 1449 
Overall Loss: 11.271078
Rec Loss: 10.594845
KL Loss: 0.676233
Y Loss: 0.483617
T Loss: 10.353037
Epoch 1499 
Overall Loss: 11.256191
Rec Loss: 10.567404
KL Loss: 0.688787
Y Loss: 0.476341
T Loss: 10.329234
Epoch 1549 
Overall Loss: 11.266411
Rec Loss: 10.587380
KL Loss: 0.679031
Y Loss: 0.482327
T Loss: 10.346217
Epoch 1599 
Overall Loss: 11.255509
Rec Loss: 10.588411
KL Loss: 0.667099
Y Loss: 0.478895
T Loss: 10.348963
Epoch 1649 
Overall Loss: 11.257532
Rec Loss: 10.579288
KL Loss: 0.678244
Y Loss: 0.471353
T Loss: 10.343611
Epoch 1699 
Overall Loss: 11.251371
Rec Loss: 10.570780
KL Loss: 0.680592
Y Loss: 0.475253
T Loss: 10.333154
Epoch 1749 
Overall Loss: 11.229135
Rec Loss: 10.567445
KL Loss: 0.661690
Y Loss: 0.473526
T Loss: 10.330683
Epoch 1799 
Overall Loss: 11.239928
Rec Loss: 10.573041
KL Loss: 0.666887
Y Loss: 0.475288
T Loss: 10.335396
Epoch 1849 
Overall Loss: 11.241014
Rec Loss: 10.572280
KL Loss: 0.668735
Y Loss: 0.463290
T Loss: 10.340635
Epoch 1899 
Overall Loss: 11.232119
Rec Loss: 10.563501
KL Loss: 0.668618
Y Loss: 0.471739
T Loss: 10.327632
Epoch 1949 
Overall Loss: 11.241659
Rec Loss: 10.571851
KL Loss: 0.669807
Y Loss: 0.471556
T Loss: 10.336073
Epoch 1999 
Overall Loss: 11.232513
Rec Loss: 10.555435
KL Loss: 0.677077
Y Loss: 0.467220
T Loss: 10.321825
Epoch 2049 
Overall Loss: 11.232330
Rec Loss: 10.556415
KL Loss: 0.675914
Y Loss: 0.473042
T Loss: 10.319894
Epoch 2099 
Overall Loss: 11.214841
Rec Loss: 10.548320
KL Loss: 0.666522
Y Loss: 0.467974
T Loss: 10.314333
Epoch 2149 
Overall Loss: 11.202181
Rec Loss: 10.548455
KL Loss: 0.653726
Y Loss: 0.459444
T Loss: 10.318733
Epoch 2199 
Overall Loss: 11.212757
Rec Loss: 10.549850
KL Loss: 0.662907
Y Loss: 0.456123
T Loss: 10.321789
Epoch 2249 
Overall Loss: 11.199890
Rec Loss: 10.529084
KL Loss: 0.670806
Y Loss: 0.451882
T Loss: 10.303143
Epoch 2299 
Overall Loss: 11.204638
Rec Loss: 10.529582
KL Loss: 0.675056
Y Loss: 0.458561
T Loss: 10.300302
Epoch 2349 
Overall Loss: 11.201896
Rec Loss: 10.523014
KL Loss: 0.678882
Y Loss: 0.450786
T Loss: 10.297621
Epoch 2399 
Overall Loss: 11.198411
Rec Loss: 10.541361
KL Loss: 0.657051
Y Loss: 0.459002
T Loss: 10.311860
Epoch 2449 
Overall Loss: 11.195487
Rec Loss: 10.533131
KL Loss: 0.662356
Y Loss: 0.454652
T Loss: 10.305805
Epoch 2499 
Overall Loss: 11.189292
Rec Loss: 10.525255
KL Loss: 0.664037
Y Loss: 0.450290
T Loss: 10.300110
Epoch 2549 
Overall Loss: 11.196165
Rec Loss: 10.519294
KL Loss: 0.676872
Y Loss: 0.451532
T Loss: 10.293528
Epoch 2599 
Overall Loss: 11.200600
Rec Loss: 10.523161
KL Loss: 0.677439
Y Loss: 0.447876
T Loss: 10.299223
Epoch 2649 
Overall Loss: 11.179099
Rec Loss: 10.520007
KL Loss: 0.659092
Y Loss: 0.446519
T Loss: 10.296748
Epoch 2699 
Overall Loss: 11.178540
Rec Loss: 10.510653
KL Loss: 0.667887
Y Loss: 0.443916
T Loss: 10.288695
Epoch 2749 
Overall Loss: 11.171961
Rec Loss: 10.518646
KL Loss: 0.653315
Y Loss: 0.448350
T Loss: 10.294470
Epoch 2799 
Overall Loss: 11.170533
Rec Loss: 10.509421
KL Loss: 0.661112
Y Loss: 0.453744
T Loss: 10.282548
Epoch 2849 
Overall Loss: 11.169119
Rec Loss: 10.513208
KL Loss: 0.655911
Y Loss: 0.447394
T Loss: 10.289511
Epoch 2899 
Overall Loss: 11.172510
Rec Loss: 10.515785
KL Loss: 0.656725
Y Loss: 0.445701
T Loss: 10.292935
Epoch 2949 
Overall Loss: 11.163997
Rec Loss: 10.512584
KL Loss: 0.651414
Y Loss: 0.446076
T Loss: 10.289546
Epoch 2999 
Overall Loss: 11.152713
Rec Loss: 10.503590
KL Loss: 0.649124
Y Loss: 0.442015
T Loss: 10.282582
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.446893
Epoch 99
Rec Loss: 0.434406
Epoch 149
Rec Loss: 0.420539
Epoch 199
Rec Loss: 0.423667
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.925591
Epoch 99
Rec Loss: 9.910374
Epoch 149
Rec Loss: 9.897458
Epoch 199
Rec Loss: 9.879207
Epoch 249
Rec Loss: 9.864326
Epoch 299
Rec Loss: 9.873461
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.613259
Insample Error: 1.470269
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.753580
Rec Loss: 19.696954
KL Loss: 3.056626
Y Loss: 9.522107
T Loss: 12.923583
X Loss: 2.012317
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.519670
Epoch 99
Rec Loss: 3.512885
Epoch 149
Rec Loss: 3.513079
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 3.017068
Epoch 99
Rec Loss: 3.014382
Epoch 149
Rec Loss: 2.999021
Epoch 199
Rec Loss: 3.059935
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.536890
Insample Error 3.618092
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.741983
Epoch 99 
Prediction Loss: 0.654325
Epoch 149 
Prediction Loss: 0.609878
Epoch 199 
Prediction Loss: 0.572969
Epoch 249 
Prediction Loss: 0.572279
Epoch 299 
Prediction Loss: 0.536715
Epoch 349 
Prediction Loss: 0.531930
Epoch 399 
Prediction Loss: 0.499186
Epoch 449 
Prediction Loss: 0.498497
Epoch 499 
Prediction Loss: 0.474623
Epoch 549 
Prediction Loss: 0.471251
Epoch 599 
Prediction Loss: 0.434430
Epoch 649 
Prediction Loss: 0.421178
Epoch 699 
Prediction Loss: 0.402989
Epoch 749 
Prediction Loss: 0.395999
Epoch 799 
Prediction Loss: 0.398917
Epoch 849 
Prediction Loss: 0.397997
Epoch 899 
Prediction Loss: 0.377825
Epoch 949 
Prediction Loss: 0.347025
Epoch 999 
Prediction Loss: 0.346016
Epoch 1049 
Prediction Loss: 0.330418
Epoch 1099 
Prediction Loss: 0.310575
Epoch 1149 
Prediction Loss: 0.302531
Epoch 1199 
Prediction Loss: 0.294155
Epoch 1249 
Prediction Loss: 0.300498
Epoch 1299 
Prediction Loss: 0.282590
Epoch 1349 
Prediction Loss: 0.271498
Epoch 1399 
Prediction Loss: 0.266451
Epoch 1449 
Prediction Loss: 0.252494
Epoch 1499 
Prediction Loss: 0.262966
Epoch 1549 
Prediction Loss: 0.242924
Epoch 1599 
Prediction Loss: 0.252647
Epoch 1649 
Prediction Loss: 0.238389
Epoch 1699 
Prediction Loss: 0.229854
Epoch 1749 
Prediction Loss: 0.226559
Epoch 1799 
Prediction Loss: 0.218604
Epoch 1849 
Prediction Loss: 0.216834
Epoch 1899 
Prediction Loss: 0.216726
Epoch 1949 
Prediction Loss: 0.213005
Epoch 1999 
Prediction Loss: 0.203771
Epoch 2049 
Prediction Loss: 0.203991
Epoch 2099 
Prediction Loss: 0.215547
Epoch 2149 
Prediction Loss: 0.194703
Epoch 2199 
Prediction Loss: 0.197406
Epoch 2249 
Prediction Loss: 0.190874
Epoch 2299 
Prediction Loss: 0.189572
Epoch 2349 
Prediction Loss: 0.194367
Epoch 2399 
Prediction Loss: 0.180194
Epoch 2449 
Prediction Loss: 0.177744
Epoch 2499 
Prediction Loss: 0.180736
Epoch 2549 
Prediction Loss: 0.172341
Epoch 2599 
Prediction Loss: 0.184278
Epoch 2649 
Prediction Loss: 0.169106
Epoch 2699 
Prediction Loss: 0.169908
Epoch 2749 
Prediction Loss: 0.168918
Epoch 2799 
Prediction Loss: 0.169437
Epoch 2849 
Prediction Loss: 0.168489
Epoch 2899 
Prediction Loss: 0.162776
Epoch 2949 
Prediction Loss: 0.166299
Epoch 2999 
Prediction Loss: 0.185202
Epoch 3049 
Prediction Loss: 0.161078
Epoch 3099 
Prediction Loss: 0.162529
Epoch 3149 
Prediction Loss: 0.154444
Epoch 3199 
Prediction Loss: 0.157527
Epoch 3249 
Prediction Loss: 0.154969
Epoch 3299 
Prediction Loss: 0.154474
Epoch 3349 
Prediction Loss: 0.154082
Epoch 3399 
Prediction Loss: 0.150329
Epoch 3449 
Prediction Loss: 0.159162
Epoch 3499 
Prediction Loss: 0.155789
Epoch 3549 
Prediction Loss: 0.156034
Epoch 3599 
Prediction Loss: 0.150847
Epoch 3649 
Prediction Loss: 0.148195
Epoch 3699 
Prediction Loss: 0.151560
Epoch 3749 
Prediction Loss: 0.151158
Epoch 3799 
Prediction Loss: 0.151111
Epoch 3849 
Prediction Loss: 0.150836
Epoch 3899 
Prediction Loss: 0.156694
Epoch 3949 
Prediction Loss: 0.151210
Epoch 3999 
Prediction Loss: 0.153889
Epoch 4049 
Prediction Loss: 0.144581
Epoch 4099 
Prediction Loss: 0.140581
Epoch 4149 
Prediction Loss: 0.140360
Epoch 4199 
Prediction Loss: 0.140235
Epoch 4249 
Prediction Loss: 0.144254
Epoch 4299 
Prediction Loss: 0.139168
Epoch 4349 
Prediction Loss: 0.141816
Epoch 4399 
Prediction Loss: 0.137117
Epoch 4449 
Prediction Loss: 0.159057
Epoch 4499 
Prediction Loss: 0.142682
Epoch 4549 
Prediction Loss: 0.150059
Epoch 4599 
Prediction Loss: 0.147359
Epoch 4649 
Prediction Loss: 0.143063
Epoch 4699 
Prediction Loss: 0.140317
Epoch 4749 
Prediction Loss: 0.142480
Epoch 4799 
Prediction Loss: 0.138022
Epoch 4849 
Prediction Loss: 0.144428
Epoch 4899 
Prediction Loss: 0.136295
Epoch 4949 
Prediction Loss: 0.134519
Epoch 4999 
Prediction Loss: 0.140068
Epoch 5049 
Prediction Loss: 0.139052
Epoch 5099 
Prediction Loss: 0.136745
Epoch 5149 
Prediction Loss: 0.130466
Epoch 5199 
Prediction Loss: 0.130718
Epoch 5249 
Prediction Loss: 0.143203
Epoch 5299 
Prediction Loss: 0.135360
Epoch 5349 
Prediction Loss: 0.134771
Epoch 5399 
Prediction Loss: 0.133337
Epoch 5449 
Prediction Loss: 0.131967
Epoch 5499 
Prediction Loss: 0.146745
Epoch 5549 
Prediction Loss: 0.131176
Epoch 5599 
Prediction Loss: 0.134896
Epoch 5649 
Prediction Loss: 0.134734
Epoch 5699 
Prediction Loss: 0.129493
Epoch 5749 
Prediction Loss: 0.128370
Epoch 5799 
Prediction Loss: 0.131148
Epoch 5849 
Prediction Loss: 0.130032
Epoch 5899 
Prediction Loss: 0.137806
Epoch 5949 
Prediction Loss: 0.134732
Epoch 5999 
Prediction Loss: 0.127328
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.355071
Insample Error 1.842936
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.932185
Rec Loss: 10.759233
KL Loss: 1.172952
Y Loss: 0.899540
T Loss: 10.309463
Epoch 99 
Overall Loss: 11.617146
Rec Loss: 10.722640
KL Loss: 0.894506
Y Loss: 0.704194
T Loss: 10.370543
Epoch 149 
Overall Loss: 11.514590
Rec Loss: 10.706789
KL Loss: 0.807801
Y Loss: 0.640053
T Loss: 10.386763
Epoch 199 
Overall Loss: 11.474207
Rec Loss: 10.714176
KL Loss: 0.760031
Y Loss: 0.616916
T Loss: 10.405718
Epoch 249 
Overall Loss: 11.438097
Rec Loss: 10.710370
KL Loss: 0.727726
Y Loss: 0.594017
T Loss: 10.413362
Epoch 299 
Overall Loss: 11.415688
Rec Loss: 10.686975
KL Loss: 0.728712
Y Loss: 0.578946
T Loss: 10.397502
Epoch 349 
Overall Loss: 11.410754
Rec Loss: 10.695497
KL Loss: 0.715257
Y Loss: 0.571312
T Loss: 10.409841
Epoch 399 
Overall Loss: 11.389255
Rec Loss: 10.685710
KL Loss: 0.703546
Y Loss: 0.557458
T Loss: 10.406981
Epoch 449 
Overall Loss: 11.375672
Rec Loss: 10.686580
KL Loss: 0.689092
Y Loss: 0.553440
T Loss: 10.409860
Epoch 499 
Overall Loss: 11.385183
Rec Loss: 10.672945
KL Loss: 0.712237
Y Loss: 0.546614
T Loss: 10.399639
Epoch 549 
Overall Loss: 11.377347
Rec Loss: 10.686117
KL Loss: 0.691230
Y Loss: 0.538218
T Loss: 10.417009
Epoch 599 
Overall Loss: 11.367115
Rec Loss: 10.669431
KL Loss: 0.697684
Y Loss: 0.530484
T Loss: 10.404189
Epoch 649 
Overall Loss: 11.350084
Rec Loss: 10.664025
KL Loss: 0.686060
Y Loss: 0.535353
T Loss: 10.396348
Epoch 699 
Overall Loss: 11.343076
Rec Loss: 10.654487
KL Loss: 0.688589
Y Loss: 0.538460
T Loss: 10.385257
Epoch 749 
Overall Loss: 11.340747
Rec Loss: 10.667359
KL Loss: 0.673387
Y Loss: 0.522047
T Loss: 10.406336
Epoch 799 
Overall Loss: 11.334905
Rec Loss: 10.655681
KL Loss: 0.679223
Y Loss: 0.533250
T Loss: 10.389057
Epoch 849 
Overall Loss: 11.337053
Rec Loss: 10.654863
KL Loss: 0.682190
Y Loss: 0.531970
T Loss: 10.388879
Epoch 899 
Overall Loss: 11.354732
Rec Loss: 10.634320
KL Loss: 0.720412
Y Loss: 0.521663
T Loss: 10.373488
Epoch 949 
Overall Loss: 11.316301
Rec Loss: 10.643565
KL Loss: 0.672736
Y Loss: 0.519948
T Loss: 10.383591
Epoch 999 
Overall Loss: 11.327473
Rec Loss: 10.648848
KL Loss: 0.678625
Y Loss: 0.514487
T Loss: 10.391604
Epoch 1049 
Overall Loss: 11.300963
Rec Loss: 10.626928
KL Loss: 0.674035
Y Loss: 0.514250
T Loss: 10.369803
Epoch 1099 
Overall Loss: 11.294180
Rec Loss: 10.621406
KL Loss: 0.672774
Y Loss: 0.510034
T Loss: 10.366389
Epoch 1149 
Overall Loss: 11.298605
Rec Loss: 10.625558
KL Loss: 0.673048
Y Loss: 0.514757
T Loss: 10.368179
Epoch 1199 
Overall Loss: 11.288282
Rec Loss: 10.609972
KL Loss: 0.678311
Y Loss: 0.502620
T Loss: 10.358661
Epoch 1249 
Overall Loss: 11.299337
Rec Loss: 10.623583
KL Loss: 0.675755
Y Loss: 0.490949
T Loss: 10.378108
Epoch 1299 
Overall Loss: 11.293760
Rec Loss: 10.621200
KL Loss: 0.672560
Y Loss: 0.498845
T Loss: 10.371777
Epoch 1349 
Overall Loss: 11.273902
Rec Loss: 10.601245
KL Loss: 0.672657
Y Loss: 0.492502
T Loss: 10.354994
Epoch 1399 
Overall Loss: 11.262941
Rec Loss: 10.592920
KL Loss: 0.670021
Y Loss: 0.492717
T Loss: 10.346561
Epoch 1449 
Overall Loss: 11.269549
Rec Loss: 10.596807
KL Loss: 0.672742
Y Loss: 0.492203
T Loss: 10.350705
Epoch 1499 
Overall Loss: 11.252479
Rec Loss: 10.572367
KL Loss: 0.680111
Y Loss: 0.481960
T Loss: 10.331388
Epoch 1549 
Overall Loss: 11.255400
Rec Loss: 10.584446
KL Loss: 0.670954
Y Loss: 0.480710
T Loss: 10.344091
Epoch 1599 
Overall Loss: 11.260331
Rec Loss: 10.593303
KL Loss: 0.667028
Y Loss: 0.481292
T Loss: 10.352657
Epoch 1649 
Overall Loss: 11.244931
Rec Loss: 10.569347
KL Loss: 0.675583
Y Loss: 0.469611
T Loss: 10.334542
Epoch 1699 
Overall Loss: 11.243155
Rec Loss: 10.581361
KL Loss: 0.661794
Y Loss: 0.472996
T Loss: 10.344863
Epoch 1749 
Overall Loss: 11.246382
Rec Loss: 10.578760
KL Loss: 0.667622
Y Loss: 0.474437
T Loss: 10.341542
Epoch 1799 
Overall Loss: 11.234444
Rec Loss: 10.565573
KL Loss: 0.668872
Y Loss: 0.462708
T Loss: 10.334218
Epoch 1849 
Overall Loss: 11.238830
Rec Loss: 10.555718
KL Loss: 0.683113
Y Loss: 0.460633
T Loss: 10.325401
Epoch 1899 
Overall Loss: 11.216727
Rec Loss: 10.553086
KL Loss: 0.663642
Y Loss: 0.464210
T Loss: 10.320981
Epoch 1949 
Overall Loss: 11.226639
Rec Loss: 10.555528
KL Loss: 0.671111
Y Loss: 0.466507
T Loss: 10.322275
Epoch 1999 
Overall Loss: 11.215082
Rec Loss: 10.551839
KL Loss: 0.663242
Y Loss: 0.460719
T Loss: 10.321480
Epoch 2049 
Overall Loss: 11.210640
Rec Loss: 10.545030
KL Loss: 0.665610
Y Loss: 0.466215
T Loss: 10.311922
Epoch 2099 
Overall Loss: 11.204579
Rec Loss: 10.540947
KL Loss: 0.663632
Y Loss: 0.457406
T Loss: 10.312244
Epoch 2149 
Overall Loss: 11.208884
Rec Loss: 10.545894
KL Loss: 0.662989
Y Loss: 0.457508
T Loss: 10.317141
Epoch 2199 
Overall Loss: 11.203741
Rec Loss: 10.547015
KL Loss: 0.656725
Y Loss: 0.469043
T Loss: 10.312494
Epoch 2249 
Overall Loss: 11.197861
Rec Loss: 10.541150
KL Loss: 0.656711
Y Loss: 0.464677
T Loss: 10.308812
Epoch 2299 
Overall Loss: 11.200864
Rec Loss: 10.549658
KL Loss: 0.651206
Y Loss: 0.453817
T Loss: 10.322749
Epoch 2349 
Overall Loss: 11.188059
Rec Loss: 10.526734
KL Loss: 0.661324
Y Loss: 0.453135
T Loss: 10.300167
Epoch 2399 
Overall Loss: 11.192252
Rec Loss: 10.543767
KL Loss: 0.648484
Y Loss: 0.452875
T Loss: 10.317330
Epoch 2449 
Overall Loss: 11.193010
Rec Loss: 10.518312
KL Loss: 0.674698
Y Loss: 0.445329
T Loss: 10.295647
Epoch 2499 
Overall Loss: 11.188987
Rec Loss: 10.535460
KL Loss: 0.653528
Y Loss: 0.449075
T Loss: 10.310922
Epoch 2549 
Overall Loss: 11.184787
Rec Loss: 10.520372
KL Loss: 0.664415
Y Loss: 0.450707
T Loss: 10.295019
Epoch 2599 
Overall Loss: 11.190648
Rec Loss: 10.529441
KL Loss: 0.661207
Y Loss: 0.443353
T Loss: 10.307764
Epoch 2649 
Overall Loss: 11.161709
Rec Loss: 10.511973
KL Loss: 0.649736
Y Loss: 0.445171
T Loss: 10.289387
Epoch 2699 
Overall Loss: 11.172752
Rec Loss: 10.515474
KL Loss: 0.657278
Y Loss: 0.440007
T Loss: 10.295471
Epoch 2749 
Overall Loss: 11.179132
Rec Loss: 10.527026
KL Loss: 0.652106
Y Loss: 0.459868
T Loss: 10.297092
Epoch 2799 
Overall Loss: 11.171313
Rec Loss: 10.508989
KL Loss: 0.662324
Y Loss: 0.435806
T Loss: 10.291086
Epoch 2849 
Overall Loss: 11.166009
Rec Loss: 10.500044
KL Loss: 0.665965
Y Loss: 0.434962
T Loss: 10.282563
Epoch 2899 
Overall Loss: 11.184928
Rec Loss: 10.514720
KL Loss: 0.670207
Y Loss: 0.444729
T Loss: 10.292356
Epoch 2949 
Overall Loss: 11.165921
Rec Loss: 10.505538
KL Loss: 0.660383
Y Loss: 0.440115
T Loss: 10.285481
Epoch 2999 
Overall Loss: 11.146325
Rec Loss: 10.503118
KL Loss: 0.643207
Y Loss: 0.441789
T Loss: 10.282224
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.443376
Epoch 99
Rec Loss: 0.431368
Epoch 149
Rec Loss: 0.434908
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.944951
Epoch 99
Rec Loss: 9.916313
Epoch 149
Rec Loss: 9.915045
Epoch 199
Rec Loss: 9.886902
Epoch 249
Rec Loss: 9.881927
Epoch 299
Rec Loss: 9.859625
Epoch 349
Rec Loss: 9.835710
Epoch 399
Rec Loss: 9.849425
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.612417
Insample Error: 1.412265
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 23.050734
Rec Loss: 19.907808
KL Loss: 3.142926
Y Loss: 8.960683
T Loss: 12.882778
X Loss: 2.544688
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.552190
Epoch 99
Rec Loss: 3.548053
Epoch 149
Rec Loss: 3.551808
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 3.318997
Epoch 99
Rec Loss: 3.249758
Epoch 149
Rec Loss: 3.294835
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.360270
Insample Error 3.420388
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.717795
Epoch 99 
Prediction Loss: 0.658409
Epoch 149 
Prediction Loss: 0.596132
Epoch 199 
Prediction Loss: 0.557544
Epoch 249 
Prediction Loss: 0.537704
Epoch 299 
Prediction Loss: 0.530685
Epoch 349 
Prediction Loss: 0.525117
Epoch 399 
Prediction Loss: 0.507502
Epoch 449 
Prediction Loss: 0.506740
Epoch 499 
Prediction Loss: 0.470081
Epoch 549 
Prediction Loss: 0.453812
Epoch 599 
Prediction Loss: 0.434196
Epoch 649 
Prediction Loss: 0.422960
Epoch 699 
Prediction Loss: 0.416309
Epoch 749 
Prediction Loss: 0.394675
Epoch 799 
Prediction Loss: 0.408801
Epoch 849 
Prediction Loss: 0.364946
Epoch 899 
Prediction Loss: 0.365748
Epoch 949 
Prediction Loss: 0.348973
Epoch 999 
Prediction Loss: 0.342324
Epoch 1049 
Prediction Loss: 0.329427
Epoch 1099 
Prediction Loss: 0.338359
Epoch 1149 
Prediction Loss: 0.338616
Epoch 1199 
Prediction Loss: 0.325151
Epoch 1249 
Prediction Loss: 0.316652
Epoch 1299 
Prediction Loss: 0.309250
Epoch 1349 
Prediction Loss: 0.291020
Epoch 1399 
Prediction Loss: 0.284294
Epoch 1449 
Prediction Loss: 0.292859
Epoch 1499 
Prediction Loss: 0.282526
Epoch 1549 
Prediction Loss: 0.266359
Epoch 1599 
Prediction Loss: 0.267007
Epoch 1649 
Prediction Loss: 0.253084
Epoch 1699 
Prediction Loss: 0.266352
Epoch 1749 
Prediction Loss: 0.249254
Epoch 1799 
Prediction Loss: 0.247706
Epoch 1849 
Prediction Loss: 0.232562
Epoch 1899 
Prediction Loss: 0.237504
Epoch 1949 
Prediction Loss: 0.244706
Epoch 1999 
Prediction Loss: 0.222041
Epoch 2049 
Prediction Loss: 0.224808
Epoch 2099 
Prediction Loss: 0.227586
Epoch 2149 
Prediction Loss: 0.218905
Epoch 2199 
Prediction Loss: 0.223707
Epoch 2249 
Prediction Loss: 0.209880
Epoch 2299 
Prediction Loss: 0.210760
Epoch 2349 
Prediction Loss: 0.212167
Epoch 2399 
Prediction Loss: 0.223135
Epoch 2449 
Prediction Loss: 0.210080
Epoch 2499 
Prediction Loss: 0.218118
Epoch 2549 
Prediction Loss: 0.197854
Epoch 2599 
Prediction Loss: 0.199921
Epoch 2649 
Prediction Loss: 0.196524
Epoch 2699 
Prediction Loss: 0.205172
Epoch 2749 
Prediction Loss: 0.195456
Epoch 2799 
Prediction Loss: 0.201955
Epoch 2849 
Prediction Loss: 0.199558
Epoch 2899 
Prediction Loss: 0.186443
Epoch 2949 
Prediction Loss: 0.188052
Epoch 2999 
Prediction Loss: 0.200225
Epoch 3049 
Prediction Loss: 0.188048
Epoch 3099 
Prediction Loss: 0.196932
Epoch 3149 
Prediction Loss: 0.183904
Epoch 3199 
Prediction Loss: 0.186466
Epoch 3249 
Prediction Loss: 0.184244
Epoch 3299 
Prediction Loss: 0.174405
Epoch 3349 
Prediction Loss: 0.175899
Epoch 3399 
Prediction Loss: 0.181805
Epoch 3449 
Prediction Loss: 0.174880
Epoch 3499 
Prediction Loss: 0.171301
Epoch 3549 
Prediction Loss: 0.176556
Epoch 3599 
Prediction Loss: 0.167861
Epoch 3649 
Prediction Loss: 0.167192
Epoch 3699 
Prediction Loss: 0.179557
Epoch 3749 
Prediction Loss: 0.161584
Epoch 3799 
Prediction Loss: 0.169345
Epoch 3849 
Prediction Loss: 0.168882
Epoch 3899 
Prediction Loss: 0.188433
Epoch 3949 
Prediction Loss: 0.158559
Epoch 3999 
Prediction Loss: 0.170382
Epoch 4049 
Prediction Loss: 0.159506
Epoch 4099 
Prediction Loss: 0.165438
Epoch 4149 
Prediction Loss: 0.164919
Epoch 4199 
Prediction Loss: 0.164553
Epoch 4249 
Prediction Loss: 0.156899
Epoch 4299 
Prediction Loss: 0.165085
Epoch 4349 
Prediction Loss: 0.173697
Epoch 4399 
Prediction Loss: 0.164578
Epoch 4449 
Prediction Loss: 0.157295
Epoch 4499 
Prediction Loss: 0.161329
Epoch 4549 
Prediction Loss: 0.164170
Epoch 4599 
Prediction Loss: 0.161531
Epoch 4649 
Prediction Loss: 0.149473
Epoch 4699 
Prediction Loss: 0.157187
Epoch 4749 
Prediction Loss: 0.150690
Epoch 4799 
Prediction Loss: 0.157797
Epoch 4849 
Prediction Loss: 0.154399
Epoch 4899 
Prediction Loss: 0.153709
Epoch 4949 
Prediction Loss: 0.155567
Epoch 4999 
Prediction Loss: 0.147482
Epoch 5049 
Prediction Loss: 0.154248
Epoch 5099 
Prediction Loss: 0.157769
Epoch 5149 
Prediction Loss: 0.151796
Epoch 5199 
Prediction Loss: 0.168963
Epoch 5249 
Prediction Loss: 0.145641
Epoch 5299 
Prediction Loss: 0.151258
Epoch 5349 
Prediction Loss: 0.148576
Epoch 5399 
Prediction Loss: 0.152788
Epoch 5449 
Prediction Loss: 0.144001
Epoch 5499 
Prediction Loss: 0.145835
Epoch 5549 
Prediction Loss: 0.153101
Epoch 5599 
Prediction Loss: 0.146513
Epoch 5649 
Prediction Loss: 0.159320
Epoch 5699 
Prediction Loss: 0.144818
Epoch 5749 
Prediction Loss: 0.154621
Epoch 5799 
Prediction Loss: 0.142930
Epoch 5849 
Prediction Loss: 0.162068
Epoch 5899 
Prediction Loss: 0.142311
Epoch 5949 
Prediction Loss: 0.146949
Epoch 5999 
Prediction Loss: 0.181777
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.383960
Insample Error 1.794252
Ours, Train RMSE
0.6120, 
0.6133, 
0.6124, 
CEVAE, Train RMSE
2.3034, 
2.5369, 
2.3603, 
Ours, Insample RMSE
1.4491, 
1.4703, 
1.4123, 
CEVAE, Insample RMSE
3.4680, 
3.6181, 
3.4204, 
Direct Regression, Insample RMSE
1.9163, 
1.8429, 
1.7943, 
Train, RMSE mean 0.6126 std 0.0005
CEVAE, RMSE mean 2.4002 std 0.0994
Ours, RMSE mean 1.4439 std 0.0240, reconstruct confounder 0.4225 (0.0065) noise 9.8705 (0.0312)
CEVAE, RMSE mean 3.5021 std 0.0843, reconstruct confounder 3.5408 (0.0205) noise 3.1568 (0.1122)
Direct Regression, RMSE mean 1.8512 std 0.0502
Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=5, mask=0, nlayer=50, obsm=4, stop=5000, ycof=0.5, ylayer=50)
Y Mean 2.635484, Std 4.326354 
Test Y Mean 0.032706, Std 4.125860 
Observe confounder 4, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.869542
Rec Loss: 10.720041
KL Loss: 1.149500
Y Loss: 0.864154
T Loss: 10.287964
Epoch 99 
Overall Loss: 11.599583
Rec Loss: 10.696368
KL Loss: 0.903215
Y Loss: 0.665509
T Loss: 10.363613
Epoch 149 
Overall Loss: 11.525933
Rec Loss: 10.715218
KL Loss: 0.810715
Y Loss: 0.636897
T Loss: 10.396769
Epoch 199 
Overall Loss: 11.473342
Rec Loss: 10.704109
KL Loss: 0.769233
Y Loss: 0.608626
T Loss: 10.399795
Epoch 249 
Overall Loss: 11.446704
Rec Loss: 10.696895
KL Loss: 0.749809
Y Loss: 0.585235
T Loss: 10.404277
Epoch 299 
Overall Loss: 11.426611
Rec Loss: 10.688958
KL Loss: 0.737653
Y Loss: 0.565146
T Loss: 10.406385
Epoch 349 
Overall Loss: 11.417233
Rec Loss: 10.676787
KL Loss: 0.740446
Y Loss: 0.561560
T Loss: 10.396007
Epoch 399 
Overall Loss: 11.399521
Rec Loss: 10.688473
KL Loss: 0.711049
Y Loss: 0.561578
T Loss: 10.407684
Epoch 449 
Overall Loss: 11.392411
Rec Loss: 10.690093
KL Loss: 0.702317
Y Loss: 0.546243
T Loss: 10.416972
Epoch 499 
Overall Loss: 11.378196
Rec Loss: 10.658982
KL Loss: 0.719214
Y Loss: 0.529093
T Loss: 10.394436
Epoch 549 
Overall Loss: 11.357747
Rec Loss: 10.659403
KL Loss: 0.698344
Y Loss: 0.537274
T Loss: 10.390766
Epoch 599 
Overall Loss: 11.348235
Rec Loss: 10.661825
KL Loss: 0.686410
Y Loss: 0.516322
T Loss: 10.403664
Epoch 649 
Overall Loss: 11.353434
Rec Loss: 10.652716
KL Loss: 0.700718
Y Loss: 0.539325
T Loss: 10.383053
Epoch 699 
Overall Loss: 11.339647
Rec Loss: 10.651689
KL Loss: 0.687959
Y Loss: 0.526297
T Loss: 10.388540
Epoch 749 
Overall Loss: 11.330875
Rec Loss: 10.639156
KL Loss: 0.691719
Y Loss: 0.518053
T Loss: 10.380129
Epoch 799 
Overall Loss: 11.327842
Rec Loss: 10.644124
KL Loss: 0.683718
Y Loss: 0.514591
T Loss: 10.386828
Epoch 849 
Overall Loss: 11.317947
Rec Loss: 10.649098
KL Loss: 0.668849
Y Loss: 0.514502
T Loss: 10.391847
Epoch 899 
Overall Loss: 11.323409
Rec Loss: 10.647254
KL Loss: 0.676155
Y Loss: 0.515162
T Loss: 10.389673
Epoch 949 
Overall Loss: 11.307872
Rec Loss: 10.631230
KL Loss: 0.676642
Y Loss: 0.503987
T Loss: 10.379237
Epoch 999 
Overall Loss: 11.316177
Rec Loss: 10.631305
KL Loss: 0.684873
Y Loss: 0.496965
T Loss: 10.382822
Epoch 1049 
Overall Loss: 11.298072
Rec Loss: 10.608029
KL Loss: 0.690042
Y Loss: 0.484183
T Loss: 10.365938
Epoch 1099 
Overall Loss: 11.306765
Rec Loss: 10.628983
KL Loss: 0.677782
Y Loss: 0.498796
T Loss: 10.379585
Epoch 1149 
Overall Loss: 11.291956
Rec Loss: 10.609562
KL Loss: 0.682395
Y Loss: 0.490965
T Loss: 10.364079
Epoch 1199 
Overall Loss: 11.287216
Rec Loss: 10.613830
KL Loss: 0.673386
Y Loss: 0.502955
T Loss: 10.362353
Epoch 1249 
Overall Loss: 11.278376
Rec Loss: 10.596846
KL Loss: 0.681530
Y Loss: 0.493330
T Loss: 10.350181
Epoch 1299 
Overall Loss: 11.274663
Rec Loss: 10.612240
KL Loss: 0.662423
Y Loss: 0.484340
T Loss: 10.370070
Epoch 1349 
Overall Loss: 11.265303
Rec Loss: 10.589978
KL Loss: 0.675325
Y Loss: 0.487052
T Loss: 10.346452
Epoch 1399 
Overall Loss: 11.296338
Rec Loss: 10.615945
KL Loss: 0.680393
Y Loss: 0.494696
T Loss: 10.368597
Epoch 1449 
Overall Loss: 11.268016
Rec Loss: 10.583658
KL Loss: 0.684357
Y Loss: 0.479756
T Loss: 10.343781
Epoch 1499 
Overall Loss: 11.261341
Rec Loss: 10.583125
KL Loss: 0.678216
Y Loss: 0.469413
T Loss: 10.348418
Epoch 1549 
Overall Loss: 11.255238
Rec Loss: 10.581183
KL Loss: 0.674054
Y Loss: 0.475003
T Loss: 10.343682
Epoch 1599 
Overall Loss: 11.257930
Rec Loss: 10.584952
KL Loss: 0.672978
Y Loss: 0.485424
T Loss: 10.342240
Epoch 1649 
Overall Loss: 11.253099
Rec Loss: 10.594231
KL Loss: 0.658867
Y Loss: 0.470033
T Loss: 10.359215
Epoch 1699 
Overall Loss: 11.253122
Rec Loss: 10.564969
KL Loss: 0.688153
Y Loss: 0.465745
T Loss: 10.332096
Epoch 1749 
Overall Loss: 11.248231
Rec Loss: 10.582805
KL Loss: 0.665426
Y Loss: 0.474846
T Loss: 10.345382
Epoch 1799 
Overall Loss: 11.231524
Rec Loss: 10.562443
KL Loss: 0.669081
Y Loss: 0.461123
T Loss: 10.331882
Epoch 1849 
Overall Loss: 11.233215
Rec Loss: 10.566720
KL Loss: 0.666495
Y Loss: 0.467355
T Loss: 10.333043
Epoch 1899 
Overall Loss: 11.234613
Rec Loss: 10.571809
KL Loss: 0.662804
Y Loss: 0.472270
T Loss: 10.335674
Epoch 1949 
Overall Loss: 11.227058
Rec Loss: 10.545562
KL Loss: 0.681496
Y Loss: 0.456816
T Loss: 10.317154
Epoch 1999 
Overall Loss: 11.226852
Rec Loss: 10.557382
KL Loss: 0.669470
Y Loss: 0.464023
T Loss: 10.325370
Epoch 2049 
Overall Loss: 11.218979
Rec Loss: 10.558834
KL Loss: 0.660145
Y Loss: 0.456475
T Loss: 10.330596
Epoch 2099 
Overall Loss: 11.210728
Rec Loss: 10.552238
KL Loss: 0.658490
Y Loss: 0.456228
T Loss: 10.324124
Epoch 2149 
Overall Loss: 11.214138
Rec Loss: 10.544209
KL Loss: 0.669929
Y Loss: 0.459141
T Loss: 10.314638
Epoch 2199 
Overall Loss: 11.224397
Rec Loss: 10.543169
KL Loss: 0.681227
Y Loss: 0.453050
T Loss: 10.316645
Epoch 2249 
Overall Loss: 11.195233
Rec Loss: 10.540352
KL Loss: 0.654881
Y Loss: 0.455807
T Loss: 10.312449
Epoch 2299 
Overall Loss: 11.194911
Rec Loss: 10.527567
KL Loss: 0.667345
Y Loss: 0.457752
T Loss: 10.298691
Epoch 2349 
Overall Loss: 11.199253
Rec Loss: 10.551297
KL Loss: 0.647956
Y Loss: 0.452866
T Loss: 10.324864
Epoch 2399 
Overall Loss: 11.191345
Rec Loss: 10.530474
KL Loss: 0.660871
Y Loss: 0.447460
T Loss: 10.306745
Epoch 2449 
Overall Loss: 11.197371
Rec Loss: 10.523248
KL Loss: 0.674123
Y Loss: 0.448017
T Loss: 10.299239
Epoch 2499 
Overall Loss: 11.192203
Rec Loss: 10.533682
KL Loss: 0.658521
Y Loss: 0.445671
T Loss: 10.310846
Epoch 2549 
Overall Loss: 11.191725
Rec Loss: 10.525505
KL Loss: 0.666220
Y Loss: 0.446085
T Loss: 10.302463
Epoch 2599 
Overall Loss: 11.191899
Rec Loss: 10.530208
KL Loss: 0.661691
Y Loss: 0.452290
T Loss: 10.304063
Epoch 2649 
Overall Loss: 11.171682
Rec Loss: 10.513705
KL Loss: 0.657977
Y Loss: 0.436174
T Loss: 10.295618
Epoch 2699 
Overall Loss: 11.191848
Rec Loss: 10.517404
KL Loss: 0.674444
Y Loss: 0.447926
T Loss: 10.293441
Epoch 2749 
Overall Loss: 11.175796
Rec Loss: 10.522305
KL Loss: 0.653491
Y Loss: 0.446840
T Loss: 10.298885
Epoch 2799 
Overall Loss: 11.175383
Rec Loss: 10.516437
KL Loss: 0.658946
Y Loss: 0.438026
T Loss: 10.297424
Epoch 2849 
Overall Loss: 11.178717
Rec Loss: 10.512918
KL Loss: 0.665799
Y Loss: 0.445238
T Loss: 10.290299
Epoch 2899 
Overall Loss: 11.165069
Rec Loss: 10.501209
KL Loss: 0.663860
Y Loss: 0.435040
T Loss: 10.283689
Epoch 2949 
Overall Loss: 11.185282
Rec Loss: 10.510467
KL Loss: 0.674815
Y Loss: 0.447990
T Loss: 10.286472
Epoch 2999 
Overall Loss: 11.163566
Rec Loss: 10.496417
KL Loss: 0.667150
Y Loss: 0.426924
T Loss: 10.282955
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.428805
Epoch 99
Rec Loss: 0.420852
Epoch 149
Rec Loss: 0.415710
Epoch 199
Rec Loss: 0.419533
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.937440
Epoch 99
Rec Loss: 9.911376
Epoch 149
Rec Loss: 9.918724
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.612031
Insample Error: 1.449132
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.795792
Rec Loss: 19.786940
KL Loss: 3.008852
Y Loss: 8.445815
T Loss: 12.927035
X Loss: 2.636998
Epoch 99 
Overall Loss: 17.630544
Rec Loss: 14.071351
KL Loss: 3.559193
Y Loss: 2.953932
T Loss: 12.884035
X Loss: -0.289650
Epoch 149 
Overall Loss: 16.214142
Rec Loss: 12.690192
KL Loss: 3.523950
Y Loss: 2.234973
T Loss: 12.801363
X Loss: -1.228658
Epoch 199 
Overall Loss: 15.000021
Rec Loss: 10.702024
KL Loss: 4.297998
Y Loss: 1.660386
T Loss: 12.016102
X Loss: -2.144271
Epoch 249 
Overall Loss: 14.444350
Rec Loss: 9.770206
KL Loss: 4.674144
Y Loss: 1.436235
T Loss: 11.657155
X Loss: -2.605067
Epoch 299 
Overall Loss: 14.217434
Rec Loss: 9.339734
KL Loss: 4.877700
Y Loss: 1.309178
T Loss: 11.552956
X Loss: -2.867810
Epoch 349 
Overall Loss: 14.036647
Rec Loss: 9.016518
KL Loss: 5.020129
Y Loss: 1.284697
T Loss: 11.474671
X Loss: -3.100502
Epoch 399 
Overall Loss: 13.887845
Rec Loss: 8.714572
KL Loss: 5.173273
Y Loss: 1.186946
T Loss: 11.411200
X Loss: -3.290101
Epoch 449 
Overall Loss: 13.771081
Rec Loss: 8.487145
KL Loss: 5.283936
Y Loss: 1.151595
T Loss: 11.374927
X Loss: -3.463579
Epoch 499 
Overall Loss: 13.696179
Rec Loss: 8.263874
KL Loss: 5.432305
Y Loss: 1.118233
T Loss: 11.312178
X Loss: -3.607421
Epoch 549 
Overall Loss: 13.546179
Rec Loss: 7.931444
KL Loss: 5.614735
Y Loss: 1.082436
T Loss: 11.160110
X Loss: -3.769885
Epoch 599 
Overall Loss: 13.329290
Rec Loss: 7.337194
KL Loss: 5.992096
Y Loss: 1.041507
T Loss: 10.873999
X Loss: -4.057558
Epoch 649 
Overall Loss: 13.274843
Rec Loss: 7.110699
KL Loss: 6.164145
Y Loss: 0.986028
T Loss: 10.806462
X Loss: -4.188778
Epoch 699 
Overall Loss: 13.213522
Rec Loss: 6.993265
KL Loss: 6.220256
Y Loss: 1.001170
T Loss: 10.769486
X Loss: -4.276806
Epoch 749 
Overall Loss: 13.134578
Rec Loss: 6.864249
KL Loss: 6.270328
Y Loss: 0.941125
T Loss: 10.739654
X Loss: -4.345968
Epoch 799 
Overall Loss: 13.103767
Rec Loss: 6.819820
KL Loss: 6.283947
Y Loss: 0.920150
T Loss: 10.728456
X Loss: -4.368711
Epoch 849 
Overall Loss: 13.087653
Rec Loss: 6.792811
KL Loss: 6.294841
Y Loss: 0.906329
T Loss: 10.717796
X Loss: -4.378149
Epoch 899 
Overall Loss: 13.100946
Rec Loss: 6.760305
KL Loss: 6.340641
Y Loss: 0.907797
T Loss: 10.728623
X Loss: -4.422216
Epoch 949 
Overall Loss: 13.053699
Rec Loss: 6.709623
KL Loss: 6.344076
Y Loss: 0.891947
T Loss: 10.714981
X Loss: -4.451332
Epoch 999 
Overall Loss: 13.032346
Rec Loss: 6.676135
KL Loss: 6.356211
Y Loss: 0.877004
T Loss: 10.732144
X Loss: -4.494511
Epoch 1049 
Overall Loss: 13.014781
Rec Loss: 6.649813
KL Loss: 6.364968
Y Loss: 0.885694
T Loss: 10.716421
X Loss: -4.509455
Epoch 1099 
Overall Loss: 13.015709
Rec Loss: 6.608013
KL Loss: 6.407696
Y Loss: 0.860213
T Loss: 10.695414
X Loss: -4.517508
Epoch 1149 
Overall Loss: 12.999358
Rec Loss: 6.579066
KL Loss: 6.420293
Y Loss: 0.852662
T Loss: 10.701394
X Loss: -4.548659
Epoch 1199 
Overall Loss: 12.963708
Rec Loss: 6.543239
KL Loss: 6.420470
Y Loss: 0.861735
T Loss: 10.714396
X Loss: -4.602025
Epoch 1249 
Overall Loss: 12.979454
Rec Loss: 6.522019
KL Loss: 6.457435
Y Loss: 0.871008
T Loss: 10.718499
X Loss: -4.631984
Epoch 1299 
Overall Loss: 12.932859
Rec Loss: 6.476662
KL Loss: 6.456196
Y Loss: 0.864961
T Loss: 10.711171
X Loss: -4.666988
Epoch 1349 
Overall Loss: 12.965509
Rec Loss: 6.489784
KL Loss: 6.475725
Y Loss: 0.847483
T Loss: 10.721264
X Loss: -4.655222
Epoch 1399 
Overall Loss: 12.915304
Rec Loss: 6.407311
KL Loss: 6.507992
Y Loss: 0.826001
T Loss: 10.704949
X Loss: -4.710638
Epoch 1449 
Overall Loss: 12.963276
Rec Loss: 6.443156
KL Loss: 6.520119
Y Loss: 0.835045
T Loss: 10.727318
X Loss: -4.701684
Epoch 1499 
Overall Loss: 12.932565
Rec Loss: 6.400675
KL Loss: 6.531889
Y Loss: 0.843408
T Loss: 10.717436
X Loss: -4.738465
Epoch 1549 
Overall Loss: 12.925735
Rec Loss: 6.392682
KL Loss: 6.533053
Y Loss: 0.828887
T Loss: 10.733926
X Loss: -4.755687
Epoch 1599 
Overall Loss: 12.893416
Rec Loss: 6.350462
KL Loss: 6.542954
Y Loss: 0.847524
T Loss: 10.719173
X Loss: -4.792473
Epoch 1649 
Overall Loss: 12.892639
Rec Loss: 6.340950
KL Loss: 6.551689
Y Loss: 0.839274
T Loss: 10.717301
X Loss: -4.795988
Epoch 1699 
Overall Loss: 12.888761
Rec Loss: 6.317975
KL Loss: 6.570786
Y Loss: 0.828978
T Loss: 10.741302
X Loss: -4.837817
Epoch 1749 
Overall Loss: 12.905481
Rec Loss: 6.281610
KL Loss: 6.623871
Y Loss: 0.841968
T Loss: 10.728005
X Loss: -4.867379
Epoch 1799 
Overall Loss: 12.881357
Rec Loss: 6.257347
KL Loss: 6.624010
Y Loss: 0.829639
T Loss: 10.741088
X Loss: -4.898560
Epoch 1849 
Overall Loss: 12.867248
Rec Loss: 6.254251
KL Loss: 6.612996
Y Loss: 0.826245
T Loss: 10.746636
X Loss: -4.905507
Epoch 1899 
Overall Loss: 12.880259
Rec Loss: 6.207648
KL Loss: 6.672611
Y Loss: 0.825668
T Loss: 10.736690
X Loss: -4.941876
Epoch 1949 
Overall Loss: 12.876274
Rec Loss: 6.192122
KL Loss: 6.684152
Y Loss: 0.828587
T Loss: 10.748143
X Loss: -4.970314
Epoch 1999 
Overall Loss: 12.862533
Rec Loss: 6.169067
KL Loss: 6.693466
Y Loss: 0.853065
T Loss: 10.735683
X Loss: -4.993148
Epoch 2049 
Overall Loss: 12.849212
Rec Loss: 6.133356
KL Loss: 6.715856
Y Loss: 0.842036
T Loss: 10.746393
X Loss: -5.034055
Epoch 2099 
Overall Loss: 12.840340
Rec Loss: 6.131940
KL Loss: 6.708400
Y Loss: 0.834638
T Loss: 10.759632
X Loss: -5.045011
Epoch 2149 
Overall Loss: 12.872723
Rec Loss: 6.136219
KL Loss: 6.736504
Y Loss: 0.834117
T Loss: 10.762428
X Loss: -5.043267
Epoch 2199 
Overall Loss: 12.833130
Rec Loss: 6.046714
KL Loss: 6.786416
Y Loss: 0.825490
T Loss: 10.755843
X Loss: -5.121874
Epoch 2249 
Overall Loss: 12.834767
Rec Loss: 6.048098
KL Loss: 6.786669
Y Loss: 0.819596
T Loss: 10.764404
X Loss: -5.126104
Epoch 2299 
Overall Loss: 12.812433
Rec Loss: 6.024890
KL Loss: 6.787542
Y Loss: 0.833911
T Loss: 10.761780
X Loss: -5.153845
Epoch 2349 
Overall Loss: 12.825440
Rec Loss: 5.999362
KL Loss: 6.826078
Y Loss: 0.816219
T Loss: 10.768665
X Loss: -5.177413
Epoch 2399 
Overall Loss: 12.814993
Rec Loss: 6.024410
KL Loss: 6.790584
Y Loss: 0.826657
T Loss: 10.774328
X Loss: -5.163247
Epoch 2449 
Overall Loss: 12.804990
Rec Loss: 5.957918
KL Loss: 6.847072
Y Loss: 0.830487
T Loss: 10.754500
X Loss: -5.211826
Epoch 2499 
Overall Loss: 12.833882
Rec Loss: 5.970871
KL Loss: 6.863010
Y Loss: 0.838796
T Loss: 10.767256
X Loss: -5.215783
Epoch 2549 
Overall Loss: 12.822512
Rec Loss: 5.955266
KL Loss: 6.867246
Y Loss: 0.827974
T Loss: 10.779602
X Loss: -5.238323
Epoch 2599 
Overall Loss: 12.813127
Rec Loss: 5.911918
KL Loss: 6.901209
Y Loss: 0.829327
T Loss: 10.761000
X Loss: -5.263745
Epoch 2649 
Overall Loss: 12.800639
Rec Loss: 5.887963
KL Loss: 6.912676
Y Loss: 0.808872
T Loss: 10.771291
X Loss: -5.287764
Epoch 2699 
Overall Loss: 12.808335
Rec Loss: 5.877893
KL Loss: 6.930442
Y Loss: 0.805262
T Loss: 10.775420
X Loss: -5.300157
Epoch 2749 
Overall Loss: 12.815683
Rec Loss: 5.859308
KL Loss: 6.956375
Y Loss: 0.803569
T Loss: 10.784150
X Loss: -5.326627
Epoch 2799 
Overall Loss: 12.797120
Rec Loss: 5.841374
KL Loss: 6.955746
Y Loss: 0.841977
T Loss: 10.785916
X Loss: -5.365530
Epoch 2849 
Overall Loss: 12.801016
Rec Loss: 5.833154
KL Loss: 6.967862
Y Loss: 0.817879
T Loss: 10.779536
X Loss: -5.355321
Epoch 2899 
Overall Loss: 12.791466
Rec Loss: 5.806712
KL Loss: 6.984754
Y Loss: 0.821870
T Loss: 10.777350
X Loss: -5.381574
Epoch 2949 
Overall Loss: 12.786818
Rec Loss: 5.779369
KL Loss: 7.007449
Y Loss: 0.819628
T Loss: 10.782920
X Loss: -5.413365
Epoch 2999 
Overall Loss: 12.778305
Rec Loss: 5.750181
KL Loss: 7.028123
Y Loss: 0.827242
T Loss: 10.787965
X Loss: -5.451405
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.399839
Epoch 99
Rec Loss: 1.382869
Epoch 149
Rec Loss: 1.400086
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.011021
Epoch 99
Rec Loss: 2.003297
Epoch 149
Rec Loss: 1.997777
Epoch 199
Rec Loss: 2.002743
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.667520
Insample Error 2.270975
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.752124
Epoch 99 
Prediction Loss: 0.624236
Epoch 149 
Prediction Loss: 0.613498
Epoch 199 
Prediction Loss: 0.583125
Epoch 249 
Prediction Loss: 0.583654
Epoch 299 
Prediction Loss: 0.532600
Epoch 349 
Prediction Loss: 0.503548
Epoch 399 
Prediction Loss: 0.517817
Epoch 449 
Prediction Loss: 0.481195
Epoch 499 
Prediction Loss: 0.493822
Epoch 549 
Prediction Loss: 0.451061
Epoch 599 
Prediction Loss: 0.446269
Epoch 649 
Prediction Loss: 0.433370
Epoch 699 
Prediction Loss: 0.412121
Epoch 749 
Prediction Loss: 0.399801
Epoch 799 
Prediction Loss: 0.376392
Epoch 849 
Prediction Loss: 0.377773
Epoch 899 
Prediction Loss: 0.368888
Epoch 949 
Prediction Loss: 0.351357
Epoch 999 
Prediction Loss: 0.333848
Epoch 1049 
Prediction Loss: 0.326583
Epoch 1099 
Prediction Loss: 0.332414
Epoch 1149 
Prediction Loss: 0.308022
Epoch 1199 
Prediction Loss: 0.306897
Epoch 1249 
Prediction Loss: 0.289876
Epoch 1299 
Prediction Loss: 0.300503
Epoch 1349 
Prediction Loss: 0.276839
Epoch 1399 
Prediction Loss: 0.272484
Epoch 1449 
Prediction Loss: 0.267299
Epoch 1499 
Prediction Loss: 0.256227
Epoch 1549 
Prediction Loss: 0.250153
Epoch 1599 
Prediction Loss: 0.243414
Epoch 1649 
Prediction Loss: 0.239495
Epoch 1699 
Prediction Loss: 0.228724
Epoch 1749 
Prediction Loss: 0.263085
Epoch 1799 
Prediction Loss: 0.229101
Epoch 1849 
Prediction Loss: 0.225429
Epoch 1899 
Prediction Loss: 0.230494
Epoch 1949 
Prediction Loss: 0.222885
Epoch 1999 
Prediction Loss: 0.236913
Epoch 2049 
Prediction Loss: 0.208407
Epoch 2099 
Prediction Loss: 0.222573
Epoch 2149 
Prediction Loss: 0.209952
Epoch 2199 
Prediction Loss: 0.207184
Epoch 2249 
Prediction Loss: 0.200263
Epoch 2299 
Prediction Loss: 0.200180
Epoch 2349 
Prediction Loss: 0.192933
Epoch 2399 
Prediction Loss: 0.202905
Epoch 2449 
Prediction Loss: 0.183409
Epoch 2499 
Prediction Loss: 0.196923
Epoch 2549 
Prediction Loss: 0.197515
Epoch 2599 
Prediction Loss: 0.195874
Epoch 2649 
Prediction Loss: 0.177707
Epoch 2699 
Prediction Loss: 0.186684
Epoch 2749 
Prediction Loss: 0.177277
Epoch 2799 
Prediction Loss: 0.177109
Epoch 2849 
Prediction Loss: 0.177221
Epoch 2899 
Prediction Loss: 0.189070
Epoch 2949 
Prediction Loss: 0.177757
Epoch 2999 
Prediction Loss: 0.177476
Epoch 3049 
Prediction Loss: 0.171818
Epoch 3099 
Prediction Loss: 0.171217
Epoch 3149 
Prediction Loss: 0.169773
Epoch 3199 
Prediction Loss: 0.167009
Epoch 3249 
Prediction Loss: 0.177425
Epoch 3299 
Prediction Loss: 0.166342
Epoch 3349 
Prediction Loss: 0.194571
Epoch 3399 
Prediction Loss: 0.161295
Epoch 3449 
Prediction Loss: 0.162499
Epoch 3499 
Prediction Loss: 0.159824
Epoch 3549 
Prediction Loss: 0.160993
Epoch 3599 
Prediction Loss: 0.178293
Epoch 3649 
Prediction Loss: 0.155815
Epoch 3699 
Prediction Loss: 0.154873
Epoch 3749 
Prediction Loss: 0.153502
Epoch 3799 
Prediction Loss: 0.162946
Epoch 3849 
Prediction Loss: 0.154326
Epoch 3899 
Prediction Loss: 0.160382
Epoch 3949 
Prediction Loss: 0.155517
Epoch 3999 
Prediction Loss: 0.157725
Epoch 4049 
Prediction Loss: 0.158026
Epoch 4099 
Prediction Loss: 0.157076
Epoch 4149 
Prediction Loss: 0.149490
Epoch 4199 
Prediction Loss: 0.153339
Epoch 4249 
Prediction Loss: 0.148196
Epoch 4299 
Prediction Loss: 0.145797
Epoch 4349 
Prediction Loss: 0.144701
Epoch 4399 
Prediction Loss: 0.144664
Epoch 4449 
Prediction Loss: 0.146693
Epoch 4499 
Prediction Loss: 0.150985
Epoch 4549 
Prediction Loss: 0.149780
Epoch 4599 
Prediction Loss: 0.146975
Epoch 4649 
Prediction Loss: 0.165073
Epoch 4699 
Prediction Loss: 0.146798
Epoch 4749 
Prediction Loss: 0.150471
Epoch 4799 
Prediction Loss: 0.149200
Epoch 4849 
Prediction Loss: 0.145959
Epoch 4899 
Prediction Loss: 0.155001
Epoch 4949 
Prediction Loss: 0.140269
Epoch 4999 
Prediction Loss: 0.144200
Epoch 5049 
Prediction Loss: 0.142248
Epoch 5099 
Prediction Loss: 0.138810
Epoch 5149 
Prediction Loss: 0.150762
Epoch 5199 
Prediction Loss: 0.143726
Epoch 5249 
Prediction Loss: 0.145010
Epoch 5299 
Prediction Loss: 0.144582
Epoch 5349 
Prediction Loss: 0.139996
Epoch 5399 
Prediction Loss: 0.141590
Epoch 5449 
Prediction Loss: 0.139384
Epoch 5499 
Prediction Loss: 0.138336
Epoch 5549 
Prediction Loss: 0.135530
Epoch 5599 
Prediction Loss: 0.160460
Epoch 5649 
Prediction Loss: 0.135624
Epoch 5699 
Prediction Loss: 0.143030
Epoch 5749 
Prediction Loss: 0.131423
Epoch 5799 
Prediction Loss: 0.139074
Epoch 5849 
Prediction Loss: 0.133606
Epoch 5899 
Prediction Loss: 0.131140
Epoch 5949 
Prediction Loss: 0.135226
Epoch 5999 
Prediction Loss: 0.133190
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.364336
Insample Error 1.916319
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.845680
Rec Loss: 10.719623
KL Loss: 1.126057
Y Loss: 0.863103
T Loss: 10.288071
Epoch 99 
Overall Loss: 11.601543
Rec Loss: 10.727569
KL Loss: 0.873974
Y Loss: 0.695075
T Loss: 10.380032
Epoch 149 
Overall Loss: 11.507314
Rec Loss: 10.705640
KL Loss: 0.801674
Y Loss: 0.617474
T Loss: 10.396903
Epoch 199 
Overall Loss: 11.470264
Rec Loss: 10.694385
KL Loss: 0.775880
Y Loss: 0.587226
T Loss: 10.400771
Epoch 249 
Overall Loss: 11.441518
Rec Loss: 10.686480
KL Loss: 0.755038
Y Loss: 0.575623
T Loss: 10.398668
Epoch 299 
Overall Loss: 11.439177
Rec Loss: 10.684960
KL Loss: 0.754217
Y Loss: 0.582441
T Loss: 10.393739
Epoch 349 
Overall Loss: 11.430354
Rec Loss: 10.695239
KL Loss: 0.735115
Y Loss: 0.571983
T Loss: 10.409248
Epoch 399 
Overall Loss: 11.390647
Rec Loss: 10.672472
KL Loss: 0.718175
Y Loss: 0.558459
T Loss: 10.393243
Epoch 449 
Overall Loss: 11.380720
Rec Loss: 10.680988
KL Loss: 0.699733
Y Loss: 0.544726
T Loss: 10.408625
Epoch 499 
Overall Loss: 11.367411
Rec Loss: 10.667700
KL Loss: 0.699711
Y Loss: 0.554173
T Loss: 10.390614
Epoch 549 
Overall Loss: 11.381465
Rec Loss: 10.680718
KL Loss: 0.700747
Y Loss: 0.546049
T Loss: 10.407694
Epoch 599 
Overall Loss: 11.364983
Rec Loss: 10.666101
KL Loss: 0.698882
Y Loss: 0.537959
T Loss: 10.397121
Epoch 649 
Overall Loss: 11.356759
Rec Loss: 10.659621
KL Loss: 0.697138
Y Loss: 0.538349
T Loss: 10.390447
Epoch 699 
Overall Loss: 11.335980
Rec Loss: 10.641364
KL Loss: 0.694616
Y Loss: 0.520046
T Loss: 10.381341
Epoch 749 
Overall Loss: 11.345111
Rec Loss: 10.656676
KL Loss: 0.688434
Y Loss: 0.525593
T Loss: 10.393880
Epoch 799 
Overall Loss: 11.330740
Rec Loss: 10.645429
KL Loss: 0.685311
Y Loss: 0.515442
T Loss: 10.387708
Epoch 849 
Overall Loss: 11.335651
Rec Loss: 10.647379
KL Loss: 0.688272
Y Loss: 0.512056
T Loss: 10.391351
Epoch 899 
Overall Loss: 11.327816
Rec Loss: 10.642254
KL Loss: 0.685562
Y Loss: 0.520015
T Loss: 10.382246
Epoch 949 
Overall Loss: 11.318919
Rec Loss: 10.631648
KL Loss: 0.687271
Y Loss: 0.508839
T Loss: 10.377228
Epoch 999 
Overall Loss: 11.316678
Rec Loss: 10.636956
KL Loss: 0.679722
Y Loss: 0.509065
T Loss: 10.382424
Epoch 1049 
Overall Loss: 11.310879
Rec Loss: 10.627108
KL Loss: 0.683771
Y Loss: 0.508103
T Loss: 10.373057
Epoch 1099 
Overall Loss: 11.307958
Rec Loss: 10.631493
KL Loss: 0.676465
Y Loss: 0.518266
T Loss: 10.372360
Epoch 1149 
Overall Loss: 11.296895
Rec Loss: 10.626479
KL Loss: 0.670416
Y Loss: 0.496196
T Loss: 10.378380
Epoch 1199 
Overall Loss: 11.275246
Rec Loss: 10.606484
KL Loss: 0.668761
Y Loss: 0.485593
T Loss: 10.363688
Epoch 1249 
Overall Loss: 11.270284
Rec Loss: 10.603178
KL Loss: 0.667106
Y Loss: 0.488609
T Loss: 10.358873
Epoch 1299 
Overall Loss: 11.271474
Rec Loss: 10.610736
KL Loss: 0.660738
Y Loss: 0.493822
T Loss: 10.363825
Epoch 1349 
Overall Loss: 11.276954
Rec Loss: 10.610356
KL Loss: 0.666599
Y Loss: 0.492699
T Loss: 10.364007
Epoch 1399 
Overall Loss: 11.268317
Rec Loss: 10.595179
KL Loss: 0.673138
Y Loss: 0.491603
T Loss: 10.349377
Epoch 1449 
Overall Loss: 11.271078
Rec Loss: 10.594845
KL Loss: 0.676233
Y Loss: 0.483617
T Loss: 10.353037
Epoch 1499 
Overall Loss: 11.256191
Rec Loss: 10.567404
KL Loss: 0.688787
Y Loss: 0.476341
T Loss: 10.329234
Epoch 1549 
Overall Loss: 11.266411
Rec Loss: 10.587380
KL Loss: 0.679031
Y Loss: 0.482327
T Loss: 10.346217
Epoch 1599 
Overall Loss: 11.255509
Rec Loss: 10.588411
KL Loss: 0.667099
Y Loss: 0.478895
T Loss: 10.348963
Epoch 1649 
Overall Loss: 11.257532
Rec Loss: 10.579288
KL Loss: 0.678244
Y Loss: 0.471353
T Loss: 10.343611
Epoch 1699 
Overall Loss: 11.251371
Rec Loss: 10.570780
KL Loss: 0.680592
Y Loss: 0.475253
T Loss: 10.333154
Epoch 1749 
Overall Loss: 11.229135
Rec Loss: 10.567445
KL Loss: 0.661690
Y Loss: 0.473526
T Loss: 10.330683
Epoch 1799 
Overall Loss: 11.239928
Rec Loss: 10.573041
KL Loss: 0.666887
Y Loss: 0.475288
T Loss: 10.335396
Epoch 1849 
Overall Loss: 11.241014
Rec Loss: 10.572280
KL Loss: 0.668735
Y Loss: 0.463290
T Loss: 10.340635
Epoch 1899 
Overall Loss: 11.232119
Rec Loss: 10.563501
KL Loss: 0.668618
Y Loss: 0.471739
T Loss: 10.327632
Epoch 1949 
Overall Loss: 11.241659
Rec Loss: 10.571851
KL Loss: 0.669807
Y Loss: 0.471556
T Loss: 10.336073
Epoch 1999 
Overall Loss: 11.232513
Rec Loss: 10.555435
KL Loss: 0.677077
Y Loss: 0.467220
T Loss: 10.321825
Epoch 2049 
Overall Loss: 11.232330
Rec Loss: 10.556415
KL Loss: 0.675914
Y Loss: 0.473042
T Loss: 10.319894
Epoch 2099 
Overall Loss: 11.214841
Rec Loss: 10.548320
KL Loss: 0.666522
Y Loss: 0.467974
T Loss: 10.314333
Epoch 2149 
Overall Loss: 11.202181
Rec Loss: 10.548455
KL Loss: 0.653726
Y Loss: 0.459444
T Loss: 10.318733
Epoch 2199 
Overall Loss: 11.212757
Rec Loss: 10.549850
KL Loss: 0.662907
Y Loss: 0.456123
T Loss: 10.321789
Epoch 2249 
Overall Loss: 11.199890
Rec Loss: 10.529084
KL Loss: 0.670806
Y Loss: 0.451882
T Loss: 10.303143
Epoch 2299 
Overall Loss: 11.204638
Rec Loss: 10.529582
KL Loss: 0.675056
Y Loss: 0.458561
T Loss: 10.300302
Epoch 2349 
Overall Loss: 11.201896
Rec Loss: 10.523014
KL Loss: 0.678882
Y Loss: 0.450786
T Loss: 10.297621
Epoch 2399 
Overall Loss: 11.198411
Rec Loss: 10.541361
KL Loss: 0.657051
Y Loss: 0.459002
T Loss: 10.311860
Epoch 2449 
Overall Loss: 11.195487
Rec Loss: 10.533131
KL Loss: 0.662356
Y Loss: 0.454652
T Loss: 10.305805
Epoch 2499 
Overall Loss: 11.189292
Rec Loss: 10.525255
KL Loss: 0.664037
Y Loss: 0.450290
T Loss: 10.300110
Epoch 2549 
Overall Loss: 11.196165
Rec Loss: 10.519294
KL Loss: 0.676872
Y Loss: 0.451532
T Loss: 10.293528
Epoch 2599 
Overall Loss: 11.200600
Rec Loss: 10.523161
KL Loss: 0.677439
Y Loss: 0.447876
T Loss: 10.299223
Epoch 2649 
Overall Loss: 11.179099
Rec Loss: 10.520007
KL Loss: 0.659092
Y Loss: 0.446519
T Loss: 10.296748
Epoch 2699 
Overall Loss: 11.178540
Rec Loss: 10.510653
KL Loss: 0.667887
Y Loss: 0.443916
T Loss: 10.288695
Epoch 2749 
Overall Loss: 11.171961
Rec Loss: 10.518646
KL Loss: 0.653315
Y Loss: 0.448350
T Loss: 10.294470
Epoch 2799 
Overall Loss: 11.170533
Rec Loss: 10.509421
KL Loss: 0.661112
Y Loss: 0.453744
T Loss: 10.282548
Epoch 2849 
Overall Loss: 11.169119
Rec Loss: 10.513208
KL Loss: 0.655911
Y Loss: 0.447394
T Loss: 10.289511
Epoch 2899 
Overall Loss: 11.172510
Rec Loss: 10.515785
KL Loss: 0.656725
Y Loss: 0.445701
T Loss: 10.292935
Epoch 2949 
Overall Loss: 11.163997
Rec Loss: 10.512584
KL Loss: 0.651414
Y Loss: 0.446076
T Loss: 10.289546
Epoch 2999 
Overall Loss: 11.152713
Rec Loss: 10.503590
KL Loss: 0.649124
Y Loss: 0.442015
T Loss: 10.282582
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.446893
Epoch 99
Rec Loss: 0.434406
Epoch 149
Rec Loss: 0.420539
Epoch 199
Rec Loss: 0.423667
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.925591
Epoch 99
Rec Loss: 9.910374
Epoch 149
Rec Loss: 9.897458
Epoch 199
Rec Loss: 9.879207
Epoch 249
Rec Loss: 9.864326
Epoch 299
Rec Loss: 9.873461
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.613259
Insample Error: 1.470269
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.753580
Rec Loss: 19.696954
KL Loss: 3.056626
Y Loss: 9.522107
T Loss: 12.923583
X Loss: 2.012317
Epoch 99 
Overall Loss: 17.560301
Rec Loss: 14.083731
KL Loss: 3.476570
Y Loss: 3.586118
T Loss: 12.761901
X Loss: -0.471229
Epoch 149 
Overall Loss: 15.921462
Rec Loss: 12.331661
KL Loss: 3.589801
Y Loss: 2.026058
T Loss: 12.537174
X Loss: -1.218543
Epoch 199 
Overall Loss: 15.159859
Rec Loss: 11.251105
KL Loss: 3.908754
Y Loss: 1.322102
T Loss: 12.172294
X Loss: -1.582239
Epoch 249 
Overall Loss: 14.596104
Rec Loss: 10.269261
KL Loss: 4.326844
Y Loss: 1.044995
T Loss: 11.616770
X Loss: -1.870006
Epoch 299 
Overall Loss: 14.321400
Rec Loss: 9.810994
KL Loss: 4.510406
Y Loss: 0.957511
T Loss: 11.490150
X Loss: -2.157911
Epoch 349 
Overall Loss: 14.099540
Rec Loss: 9.479713
KL Loss: 4.619827
Y Loss: 0.934847
T Loss: 11.405549
X Loss: -2.393259
Epoch 399 
Overall Loss: 13.908726
Rec Loss: 9.128301
KL Loss: 4.780425
Y Loss: 0.904862
T Loss: 11.317661
X Loss: -2.641791
Epoch 449 
Overall Loss: 13.721503
Rec Loss: 8.598429
KL Loss: 5.123074
Y Loss: 0.904648
T Loss: 11.130490
X Loss: -2.984385
Epoch 499 
Overall Loss: 13.531613
Rec Loss: 8.072030
KL Loss: 5.459583
Y Loss: 0.917417
T Loss: 10.919718
X Loss: -3.306397
Epoch 549 
Overall Loss: 13.402402
Rec Loss: 7.728847
KL Loss: 5.673555
Y Loss: 0.930534
T Loss: 10.789223
X Loss: -3.525643
Epoch 599 
Overall Loss: 13.293116
Rec Loss: 7.484250
KL Loss: 5.808866
Y Loss: 0.931799
T Loss: 10.715784
X Loss: -3.697433
Epoch 649 
Overall Loss: 13.266588
Rec Loss: 7.375322
KL Loss: 5.891266
Y Loss: 0.910034
T Loss: 10.708496
X Loss: -3.788191
Epoch 699 
Overall Loss: 13.189833
Rec Loss: 7.235449
KL Loss: 5.954384
Y Loss: 0.914999
T Loss: 10.660102
X Loss: -3.882153
Epoch 749 
Overall Loss: 13.186936
Rec Loss: 7.181779
KL Loss: 6.005157
Y Loss: 0.902630
T Loss: 10.665728
X Loss: -3.935264
Epoch 799 
Overall Loss: 13.123780
Rec Loss: 7.090086
KL Loss: 6.033693
Y Loss: 0.883947
T Loss: 10.663433
X Loss: -4.015320
Epoch 849 
Overall Loss: 13.128262
Rec Loss: 7.040777
KL Loss: 6.087486
Y Loss: 0.883919
T Loss: 10.674986
X Loss: -4.076169
Epoch 899 
Overall Loss: 13.082730
Rec Loss: 6.965224
KL Loss: 6.117506
Y Loss: 0.890046
T Loss: 10.649570
X Loss: -4.129369
Epoch 949 
Overall Loss: 13.054473
Rec Loss: 6.903783
KL Loss: 6.150690
Y Loss: 0.875924
T Loss: 10.656671
X Loss: -4.190850
Epoch 999 
Overall Loss: 13.064331
Rec Loss: 6.881722
KL Loss: 6.182609
Y Loss: 0.867323
T Loss: 10.669984
X Loss: -4.221924
Epoch 1049 
Overall Loss: 13.026445
Rec Loss: 6.824715
KL Loss: 6.201730
Y Loss: 0.841798
T Loss: 10.667588
X Loss: -4.263772
Epoch 1099 
Overall Loss: 13.032185
Rec Loss: 6.786256
KL Loss: 6.245929
Y Loss: 0.879732
T Loss: 10.683080
X Loss: -4.336690
Epoch 1149 
Overall Loss: 13.015432
Rec Loss: 6.739690
KL Loss: 6.275743
Y Loss: 0.821470
T Loss: 10.697783
X Loss: -4.368828
Epoch 1199 
Overall Loss: 12.963760
Rec Loss: 6.667261
KL Loss: 6.296499
Y Loss: 0.847741
T Loss: 10.675673
X Loss: -4.432283
Epoch 1249 
Overall Loss: 12.972612
Rec Loss: 6.673636
KL Loss: 6.298977
Y Loss: 0.861292
T Loss: 10.699372
X Loss: -4.456383
Epoch 1299 
Overall Loss: 12.948190
Rec Loss: 6.624883
KL Loss: 6.323307
Y Loss: 0.841618
T Loss: 10.684442
X Loss: -4.480368
Epoch 1349 
Overall Loss: 12.932821
Rec Loss: 6.572161
KL Loss: 6.360659
Y Loss: 0.831267
T Loss: 10.694977
X Loss: -4.538449
Epoch 1399 
Overall Loss: 12.950766
Rec Loss: 6.570261
KL Loss: 6.380505
Y Loss: 0.836659
T Loss: 10.710783
X Loss: -4.558851
Epoch 1449 
Overall Loss: 12.932710
Rec Loss: 6.522234
KL Loss: 6.410476
Y Loss: 0.831014
T Loss: 10.701164
X Loss: -4.594437
Epoch 1499 
Overall Loss: 12.930833
Rec Loss: 6.504728
KL Loss: 6.426105
Y Loss: 0.847349
T Loss: 10.705866
X Loss: -4.624812
Epoch 1549 
Overall Loss: 12.910278
Rec Loss: 6.440594
KL Loss: 6.469684
Y Loss: 0.826364
T Loss: 10.701850
X Loss: -4.674438
Epoch 1599 
Overall Loss: 12.870548
Rec Loss: 6.431825
KL Loss: 6.438723
Y Loss: 0.830997
T Loss: 10.710021
X Loss: -4.693695
Epoch 1649 
Overall Loss: 12.892865
Rec Loss: 6.389757
KL Loss: 6.503109
Y Loss: 0.831909
T Loss: 10.716273
X Loss: -4.742470
Epoch 1699 
Overall Loss: 12.890402
Rec Loss: 6.372126
KL Loss: 6.518275
Y Loss: 0.816541
T Loss: 10.706336
X Loss: -4.742480
Epoch 1749 
Overall Loss: 12.884720
Rec Loss: 6.340513
KL Loss: 6.544207
Y Loss: 0.838045
T Loss: 10.721236
X Loss: -4.799746
Epoch 1799 
Overall Loss: 12.864046
Rec Loss: 6.324033
KL Loss: 6.540013
Y Loss: 0.830277
T Loss: 10.729004
X Loss: -4.820110
Epoch 1849 
Overall Loss: 12.878844
Rec Loss: 6.291064
KL Loss: 6.587780
Y Loss: 0.825210
T Loss: 10.724770
X Loss: -4.846311
Epoch 1899 
Overall Loss: 12.887624
Rec Loss: 6.279069
KL Loss: 6.608554
Y Loss: 0.815209
T Loss: 10.739005
X Loss: -4.867540
Epoch 1949 
Overall Loss: 12.870004
Rec Loss: 6.247113
KL Loss: 6.622891
Y Loss: 0.834059
T Loss: 10.743568
X Loss: -4.913485
Epoch 1999 
Overall Loss: 12.850906
Rec Loss: 6.221222
KL Loss: 6.629684
Y Loss: 0.826246
T Loss: 10.732213
X Loss: -4.924114
Epoch 2049 
Overall Loss: 12.852466
Rec Loss: 6.197091
KL Loss: 6.655375
Y Loss: 0.836487
T Loss: 10.736225
X Loss: -4.957377
Epoch 2099 
Overall Loss: 12.845278
Rec Loss: 6.159257
KL Loss: 6.686021
Y Loss: 0.842013
T Loss: 10.742883
X Loss: -5.004632
Epoch 2149 
Overall Loss: 12.850199
Rec Loss: 6.173049
KL Loss: 6.677151
Y Loss: 0.835633
T Loss: 10.753708
X Loss: -4.998476
Epoch 2199 
Overall Loss: 12.840240
Rec Loss: 6.137214
KL Loss: 6.703025
Y Loss: 0.832072
T Loss: 10.750765
X Loss: -5.029586
Epoch 2249 
Overall Loss: 12.815310
Rec Loss: 6.105023
KL Loss: 6.710287
Y Loss: 0.845788
T Loss: 10.745827
X Loss: -5.063698
Epoch 2299 
Overall Loss: 12.830746
Rec Loss: 6.086290
KL Loss: 6.744456
Y Loss: 0.826656
T Loss: 10.752651
X Loss: -5.079689
Epoch 2349 
Overall Loss: 12.851702
Rec Loss: 6.084845
KL Loss: 6.766857
Y Loss: 0.826757
T Loss: 10.757268
X Loss: -5.085802
Epoch 2399 
Overall Loss: 12.811738
Rec Loss: 6.048968
KL Loss: 6.762770
Y Loss: 0.845467
T Loss: 10.747113
X Loss: -5.120879
Epoch 2449 
Overall Loss: 12.837113
Rec Loss: 6.035990
KL Loss: 6.801123
Y Loss: 0.856054
T Loss: 10.770484
X Loss: -5.162522
Epoch 2499 
Overall Loss: 12.815496
Rec Loss: 6.023063
KL Loss: 6.792433
Y Loss: 0.849731
T Loss: 10.775503
X Loss: -5.177306
Epoch 2549 
Overall Loss: 12.816302
Rec Loss: 6.011810
KL Loss: 6.804492
Y Loss: 0.844168
T Loss: 10.774266
X Loss: -5.184539
Epoch 2599 
Overall Loss: 12.844755
Rec Loss: 5.984198
KL Loss: 6.860557
Y Loss: 0.841097
T Loss: 10.770517
X Loss: -5.206868
Epoch 2649 
Overall Loss: 12.816564
Rec Loss: 5.953931
KL Loss: 6.862633
Y Loss: 0.830130
T Loss: 10.775718
X Loss: -5.236852
Epoch 2699 
Overall Loss: 12.806052
Rec Loss: 5.941578
KL Loss: 6.864474
Y Loss: 0.831663
T Loss: 10.767249
X Loss: -5.241503
Epoch 2749 
Overall Loss: 12.808584
Rec Loss: 5.922819
KL Loss: 6.885765
Y Loss: 0.848471
T Loss: 10.769513
X Loss: -5.270930
Epoch 2799 
Overall Loss: 12.806324
Rec Loss: 5.896160
KL Loss: 6.910165
Y Loss: 0.855815
T Loss: 10.769418
X Loss: -5.301166
Epoch 2849 
Overall Loss: 12.809316
Rec Loss: 5.889292
KL Loss: 6.920023
Y Loss: 0.843275
T Loss: 10.773057
X Loss: -5.305402
Epoch 2899 
Overall Loss: 12.815216
Rec Loss: 5.909734
KL Loss: 6.905482
Y Loss: 0.851547
T Loss: 10.786619
X Loss: -5.302659
Epoch 2949 
Overall Loss: 12.792176
Rec Loss: 5.857420
KL Loss: 6.934756
Y Loss: 0.842447
T Loss: 10.783353
X Loss: -5.347156
Epoch 2999 
Overall Loss: 12.795160
Rec Loss: 5.855443
KL Loss: 6.939717
Y Loss: 0.860953
T Loss: 10.777487
X Loss: -5.352520
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.424717
Epoch 99
Rec Loss: 1.414808
Epoch 149
Rec Loss: 1.411565
Epoch 199
Rec Loss: 1.402956
Epoch 249
Rec Loss: 1.412625
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.004197
Epoch 99
Rec Loss: 2.000050
Epoch 149
Rec Loss: 1.993269
Epoch 199
Rec Loss: 1.999095
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.680364
Insample Error 2.206810
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.741983
Epoch 99 
Prediction Loss: 0.654325
Epoch 149 
Prediction Loss: 0.609878
Epoch 199 
Prediction Loss: 0.572969
Epoch 249 
Prediction Loss: 0.572279
Epoch 299 
Prediction Loss: 0.536715
Epoch 349 
Prediction Loss: 0.531930
Epoch 399 
Prediction Loss: 0.499186
Epoch 449 
Prediction Loss: 0.498497
Epoch 499 
Prediction Loss: 0.474623
Epoch 549 
Prediction Loss: 0.471251
Epoch 599 
Prediction Loss: 0.434430
Epoch 649 
Prediction Loss: 0.421178
Epoch 699 
Prediction Loss: 0.402989
Epoch 749 
Prediction Loss: 0.395999
Epoch 799 
Prediction Loss: 0.398917
Epoch 849 
Prediction Loss: 0.397997
Epoch 899 
Prediction Loss: 0.377825
Epoch 949 
Prediction Loss: 0.347025
Epoch 999 
Prediction Loss: 0.346016
Epoch 1049 
Prediction Loss: 0.330418
Epoch 1099 
Prediction Loss: 0.310575
Epoch 1149 
Prediction Loss: 0.302531
Epoch 1199 
Prediction Loss: 0.294155
Epoch 1249 
Prediction Loss: 0.300498
Epoch 1299 
Prediction Loss: 0.282590
Epoch 1349 
Prediction Loss: 0.271498
Epoch 1399 
Prediction Loss: 0.266451
Epoch 1449 
Prediction Loss: 0.252494
Epoch 1499 
Prediction Loss: 0.262966
Epoch 1549 
Prediction Loss: 0.242924
Epoch 1599 
Prediction Loss: 0.252647
Epoch 1649 
Prediction Loss: 0.238389
Epoch 1699 
Prediction Loss: 0.229854
Epoch 1749 
Prediction Loss: 0.226559
Epoch 1799 
Prediction Loss: 0.218604
Epoch 1849 
Prediction Loss: 0.216834
Epoch 1899 
Prediction Loss: 0.216726
Epoch 1949 
Prediction Loss: 0.213005
Epoch 1999 
Prediction Loss: 0.203771
Epoch 2049 
Prediction Loss: 0.203991
Epoch 2099 
Prediction Loss: 0.215547
Epoch 2149 
Prediction Loss: 0.194703
Epoch 2199 
Prediction Loss: 0.197406
Epoch 2249 
Prediction Loss: 0.190874
Epoch 2299 
Prediction Loss: 0.189572
Epoch 2349 
Prediction Loss: 0.194367
Epoch 2399 
Prediction Loss: 0.180194
Epoch 2449 
Prediction Loss: 0.177744
Epoch 2499 
Prediction Loss: 0.180736
Epoch 2549 
Prediction Loss: 0.172341
Epoch 2599 
Prediction Loss: 0.184278
Epoch 2649 
Prediction Loss: 0.169106
Epoch 2699 
Prediction Loss: 0.169908
Epoch 2749 
Prediction Loss: 0.168918
Epoch 2799 
Prediction Loss: 0.169437
Epoch 2849 
Prediction Loss: 0.168489
Epoch 2899 
Prediction Loss: 0.162776
Epoch 2949 
Prediction Loss: 0.166299
Epoch 2999 
Prediction Loss: 0.185202
Epoch 3049 
Prediction Loss: 0.161078
Epoch 3099 
Prediction Loss: 0.162529
Epoch 3149 
Prediction Loss: 0.154444
Epoch 3199 
Prediction Loss: 0.157527
Epoch 3249 
Prediction Loss: 0.154969
Epoch 3299 
Prediction Loss: 0.154474
Epoch 3349 
Prediction Loss: 0.154082
Epoch 3399 
Prediction Loss: 0.150329
Epoch 3449 
Prediction Loss: 0.159162
Epoch 3499 
Prediction Loss: 0.155789
Epoch 3549 
Prediction Loss: 0.156034
Epoch 3599 
Prediction Loss: 0.150847
Epoch 3649 
Prediction Loss: 0.148195
Epoch 3699 
Prediction Loss: 0.151560
Epoch 3749 
Prediction Loss: 0.151158
Epoch 3799 
Prediction Loss: 0.151111
Epoch 3849 
Prediction Loss: 0.150836
Epoch 3899 
Prediction Loss: 0.156694
Epoch 3949 
Prediction Loss: 0.151210
Epoch 3999 
Prediction Loss: 0.153889
Epoch 4049 
Prediction Loss: 0.144581
Epoch 4099 
Prediction Loss: 0.140581
Epoch 4149 
Prediction Loss: 0.140360
Epoch 4199 
Prediction Loss: 0.140235
Epoch 4249 
Prediction Loss: 0.144254
Epoch 4299 
Prediction Loss: 0.139168
Epoch 4349 
Prediction Loss: 0.141816
Epoch 4399 
Prediction Loss: 0.137117
Epoch 4449 
Prediction Loss: 0.159057
Epoch 4499 
Prediction Loss: 0.142682
Epoch 4549 
Prediction Loss: 0.150059
Epoch 4599 
Prediction Loss: 0.147359
Epoch 4649 
Prediction Loss: 0.143063
Epoch 4699 
Prediction Loss: 0.140317
Epoch 4749 
Prediction Loss: 0.142480
Epoch 4799 
Prediction Loss: 0.138022
Epoch 4849 
Prediction Loss: 0.144428
Epoch 4899 
Prediction Loss: 0.136295
Epoch 4949 
Prediction Loss: 0.134519
Epoch 4999 
Prediction Loss: 0.140068
Epoch 5049 
Prediction Loss: 0.139052
Epoch 5099 
Prediction Loss: 0.136745
Epoch 5149 
Prediction Loss: 0.130466
Epoch 5199 
Prediction Loss: 0.130718
Epoch 5249 
Prediction Loss: 0.143203
Epoch 5299 
Prediction Loss: 0.135360
Epoch 5349 
Prediction Loss: 0.134771
Epoch 5399 
Prediction Loss: 0.133337
Epoch 5449 
Prediction Loss: 0.131967
Epoch 5499 
Prediction Loss: 0.146745
Epoch 5549 
Prediction Loss: 0.131176
Epoch 5599 
Prediction Loss: 0.134896
Epoch 5649 
Prediction Loss: 0.134734
Epoch 5699 
Prediction Loss: 0.129493
Epoch 5749 
Prediction Loss: 0.128370
Epoch 5799 
Prediction Loss: 0.131148
Epoch 5849 
Prediction Loss: 0.130032
Epoch 5899 
Prediction Loss: 0.137806
Epoch 5949 
Prediction Loss: 0.134732
Epoch 5999 
Prediction Loss: 0.127328
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.355071
Insample Error 1.842936
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.932185
Rec Loss: 10.759233
KL Loss: 1.172952
Y Loss: 0.899540
T Loss: 10.309463
Epoch 99 
Overall Loss: 11.617146
Rec Loss: 10.722640
KL Loss: 0.894506
Y Loss: 0.704194
T Loss: 10.370543
Epoch 149 
Overall Loss: 11.514590
Rec Loss: 10.706789
KL Loss: 0.807801
Y Loss: 0.640053
T Loss: 10.386763
Epoch 199 
Overall Loss: 11.474207
Rec Loss: 10.714176
KL Loss: 0.760031
Y Loss: 0.616916
T Loss: 10.405718
Epoch 249 
Overall Loss: 11.438097
Rec Loss: 10.710370
KL Loss: 0.727726
Y Loss: 0.594017
T Loss: 10.413362
Epoch 299 
Overall Loss: 11.415688
Rec Loss: 10.686975
KL Loss: 0.728712
Y Loss: 0.578946
T Loss: 10.397502
Epoch 349 
Overall Loss: 11.410754
Rec Loss: 10.695497
KL Loss: 0.715257
Y Loss: 0.571312
T Loss: 10.409841
Epoch 399 
Overall Loss: 11.389255
Rec Loss: 10.685710
KL Loss: 0.703546
Y Loss: 0.557458
T Loss: 10.406981
Epoch 449 
Overall Loss: 11.375672
Rec Loss: 10.686580
KL Loss: 0.689092
Y Loss: 0.553440
T Loss: 10.409860
Epoch 499 
Overall Loss: 11.385183
Rec Loss: 10.672945
KL Loss: 0.712237
Y Loss: 0.546614
T Loss: 10.399639
Epoch 549 
Overall Loss: 11.377347
Rec Loss: 10.686117
KL Loss: 0.691230
Y Loss: 0.538218
T Loss: 10.417009
Epoch 599 
Overall Loss: 11.367115
Rec Loss: 10.669431
KL Loss: 0.697684
Y Loss: 0.530484
T Loss: 10.404189
Epoch 649 
Overall Loss: 11.350084
Rec Loss: 10.664025
KL Loss: 0.686060
Y Loss: 0.535353
T Loss: 10.396348
Epoch 699 
Overall Loss: 11.343076
Rec Loss: 10.654487
KL Loss: 0.688589
Y Loss: 0.538460
T Loss: 10.385257
Epoch 749 
Overall Loss: 11.340747
Rec Loss: 10.667359
KL Loss: 0.673387
Y Loss: 0.522047
T Loss: 10.406336
Epoch 799 
Overall Loss: 11.334905
Rec Loss: 10.655681
KL Loss: 0.679223
Y Loss: 0.533250
T Loss: 10.389057
Epoch 849 
Overall Loss: 11.337053
Rec Loss: 10.654863
KL Loss: 0.682190
Y Loss: 0.531970
T Loss: 10.388879
Epoch 899 
Overall Loss: 11.354732
Rec Loss: 10.634320
KL Loss: 0.720412
Y Loss: 0.521663
T Loss: 10.373488
Epoch 949 
Overall Loss: 11.316301
Rec Loss: 10.643565
KL Loss: 0.672736
Y Loss: 0.519948
T Loss: 10.383591
Epoch 999 
Overall Loss: 11.327473
Rec Loss: 10.648848
KL Loss: 0.678625
Y Loss: 0.514487
T Loss: 10.391604
Epoch 1049 
Overall Loss: 11.300963
Rec Loss: 10.626928
KL Loss: 0.674035
Y Loss: 0.514250
T Loss: 10.369803
Epoch 1099 
Overall Loss: 11.294180
Rec Loss: 10.621406
KL Loss: 0.672774
Y Loss: 0.510034
T Loss: 10.366389
Epoch 1149 
Overall Loss: 11.298605
Rec Loss: 10.625558
KL Loss: 0.673048
Y Loss: 0.514757
T Loss: 10.368179
Epoch 1199 
Overall Loss: 11.288282
Rec Loss: 10.609972
KL Loss: 0.678311
Y Loss: 0.502620
T Loss: 10.358661
Epoch 1249 
Overall Loss: 11.299337
Rec Loss: 10.623583
KL Loss: 0.675755
Y Loss: 0.490949
T Loss: 10.378108
Epoch 1299 
Overall Loss: 11.293760
Rec Loss: 10.621200
KL Loss: 0.672560
Y Loss: 0.498845
T Loss: 10.371777
Epoch 1349 
Overall Loss: 11.273902
Rec Loss: 10.601245
KL Loss: 0.672657
Y Loss: 0.492502
T Loss: 10.354994
Epoch 1399 
Overall Loss: 11.262941
Rec Loss: 10.592920
KL Loss: 0.670021
Y Loss: 0.492717
T Loss: 10.346561
Epoch 1449 
Overall Loss: 11.269549
Rec Loss: 10.596807
KL Loss: 0.672742
Y Loss: 0.492203
T Loss: 10.350705
Epoch 1499 
Overall Loss: 11.252479
Rec Loss: 10.572367
KL Loss: 0.680111
Y Loss: 0.481960
T Loss: 10.331388
Epoch 1549 
Overall Loss: 11.255400
Rec Loss: 10.584446
KL Loss: 0.670954
Y Loss: 0.480710
T Loss: 10.344091
Epoch 1599 
Overall Loss: 11.260331
Rec Loss: 10.593303
KL Loss: 0.667028
Y Loss: 0.481292
T Loss: 10.352657
Epoch 1649 
Overall Loss: 11.244931
Rec Loss: 10.569347
KL Loss: 0.675583
Y Loss: 0.469611
T Loss: 10.334542
Epoch 1699 
Overall Loss: 11.243155
Rec Loss: 10.581361
KL Loss: 0.661794
Y Loss: 0.472996
T Loss: 10.344863
Epoch 1749 
Overall Loss: 11.246382
Rec Loss: 10.578760
KL Loss: 0.667622
Y Loss: 0.474437
T Loss: 10.341542
Epoch 1799 
Overall Loss: 11.234444
Rec Loss: 10.565573
KL Loss: 0.668872
Y Loss: 0.462708
T Loss: 10.334218
Epoch 1849 
Overall Loss: 11.238830
Rec Loss: 10.555718
KL Loss: 0.683113
Y Loss: 0.460633
T Loss: 10.325401
Epoch 1899 
Overall Loss: 11.216727
Rec Loss: 10.553086
KL Loss: 0.663642
Y Loss: 0.464210
T Loss: 10.320981
Epoch 1949 
Overall Loss: 11.226639
Rec Loss: 10.555528
KL Loss: 0.671111
Y Loss: 0.466507
T Loss: 10.322275
Epoch 1999 
Overall Loss: 11.215082
Rec Loss: 10.551839
KL Loss: 0.663242
Y Loss: 0.460719
T Loss: 10.321480
Epoch 2049 
Overall Loss: 11.210640
Rec Loss: 10.545030
KL Loss: 0.665610
Y Loss: 0.466215
T Loss: 10.311922
Epoch 2099 
Overall Loss: 11.204579
Rec Loss: 10.540947
KL Loss: 0.663632
Y Loss: 0.457406
T Loss: 10.312244
Epoch 2149 
Overall Loss: 11.208884
Rec Loss: 10.545894
KL Loss: 0.662989
Y Loss: 0.457508
T Loss: 10.317141
Epoch 2199 
Overall Loss: 11.203741
Rec Loss: 10.547015
KL Loss: 0.656725
Y Loss: 0.469043
T Loss: 10.312494
Epoch 2249 
Overall Loss: 11.197861
Rec Loss: 10.541150
KL Loss: 0.656711
Y Loss: 0.464677
T Loss: 10.308812
Epoch 2299 
Overall Loss: 11.200864
Rec Loss: 10.549658
KL Loss: 0.651206
Y Loss: 0.453817
T Loss: 10.322749
Epoch 2349 
Overall Loss: 11.188059
Rec Loss: 10.526734
KL Loss: 0.661324
Y Loss: 0.453135
T Loss: 10.300167
Epoch 2399 
Overall Loss: 11.192252
Rec Loss: 10.543767
KL Loss: 0.648484
Y Loss: 0.452875
T Loss: 10.317330
Epoch 2449 
Overall Loss: 11.193010
Rec Loss: 10.518312
KL Loss: 0.674698
Y Loss: 0.445329
T Loss: 10.295647
Epoch 2499 
Overall Loss: 11.188987
Rec Loss: 10.535460
KL Loss: 0.653528
Y Loss: 0.449075
T Loss: 10.310922
Epoch 2549 
Overall Loss: 11.184787
Rec Loss: 10.520372
KL Loss: 0.664415
Y Loss: 0.450707
T Loss: 10.295019
Epoch 2599 
Overall Loss: 11.190648
Rec Loss: 10.529441
KL Loss: 0.661207
Y Loss: 0.443353
T Loss: 10.307764
Epoch 2649 
Overall Loss: 11.161709
Rec Loss: 10.511973
KL Loss: 0.649736
Y Loss: 0.445171
T Loss: 10.289387
Epoch 2699 
Overall Loss: 11.172752
Rec Loss: 10.515474
KL Loss: 0.657278
Y Loss: 0.440007
T Loss: 10.295471
Epoch 2749 
Overall Loss: 11.179132
Rec Loss: 10.527026
KL Loss: 0.652106
Y Loss: 0.459868
T Loss: 10.297092
Epoch 2799 
Overall Loss: 11.171313
Rec Loss: 10.508989
KL Loss: 0.662324
Y Loss: 0.435806
T Loss: 10.291086
Epoch 2849 
Overall Loss: 11.166009
Rec Loss: 10.500044
KL Loss: 0.665965
Y Loss: 0.434962
T Loss: 10.282563
Epoch 2899 
Overall Loss: 11.184928
Rec Loss: 10.514720
KL Loss: 0.670207
Y Loss: 0.444729
T Loss: 10.292356
Epoch 2949 
Overall Loss: 11.165921
Rec Loss: 10.505538
KL Loss: 0.660383
Y Loss: 0.440115
T Loss: 10.285481
Epoch 2999 
Overall Loss: 11.146325
Rec Loss: 10.503118
KL Loss: 0.643207
Y Loss: 0.441789
T Loss: 10.282224
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.443376
Epoch 99
Rec Loss: 0.431368
Epoch 149
Rec Loss: 0.434908
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.944951
Epoch 99
Rec Loss: 9.916313
Epoch 149
Rec Loss: 9.915045
Epoch 199
Rec Loss: 9.886902
Epoch 249
Rec Loss: 9.881927
Epoch 299
Rec Loss: 9.859625
Epoch 349
Rec Loss: 9.835710
Epoch 399
Rec Loss: 9.849425
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.612417
Insample Error: 1.412265
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 23.050734
Rec Loss: 19.907808
KL Loss: 3.142926
Y Loss: 8.960683
T Loss: 12.882778
X Loss: 2.544688
Epoch 99 
Overall Loss: 17.916076
Rec Loss: 14.232800
KL Loss: 3.683276
Y Loss: 2.730254
T Loss: 12.857116
X Loss: 0.010558
Epoch 149 
Overall Loss: 16.392665
Rec Loss: 12.865416
KL Loss: 3.527250
Y Loss: 1.818311
T Loss: 12.879708
X Loss: -0.923447
Epoch 199 
Overall Loss: 15.661151
Rec Loss: 11.998768
KL Loss: 3.662383
Y Loss: 1.548070
T Loss: 12.609719
X Loss: -1.384986
Epoch 249 
Overall Loss: 15.046100
Rec Loss: 11.008443
KL Loss: 4.037656
Y Loss: 1.319100
T Loss: 12.081102
X Loss: -1.732209
Epoch 299 
Overall Loss: 14.564567
Rec Loss: 10.312643
KL Loss: 4.251924
Y Loss: 1.152530
T Loss: 11.799075
X Loss: -2.062697
Epoch 349 
Overall Loss: 14.154152
Rec Loss: 9.602807
KL Loss: 4.551345
Y Loss: 1.053808
T Loss: 11.509188
X Loss: -2.433286
Epoch 399 
Overall Loss: 13.687085
Rec Loss: 8.410755
KL Loss: 5.276331
Y Loss: 0.971850
T Loss: 11.032219
X Loss: -3.107389
Epoch 449 
Overall Loss: 13.466624
Rec Loss: 7.872367
KL Loss: 5.594256
Y Loss: 0.960658
T Loss: 10.851017
X Loss: -3.458979
Epoch 499 
Overall Loss: 13.368371
Rec Loss: 7.587295
KL Loss: 5.781076
Y Loss: 0.933410
T Loss: 10.796113
X Loss: -3.675523
Epoch 549 
Overall Loss: 13.329208
Rec Loss: 7.416908
KL Loss: 5.912300
Y Loss: 0.933481
T Loss: 10.770233
X Loss: -3.820065
Epoch 599 
Overall Loss: 13.264490
Rec Loss: 7.257293
KL Loss: 6.007198
Y Loss: 0.911314
T Loss: 10.771687
X Loss: -3.970052
Epoch 649 
Overall Loss: 13.235001
Rec Loss: 7.151986
KL Loss: 6.083014
Y Loss: 0.925116
T Loss: 10.759427
X Loss: -4.069999
Epoch 699 
Overall Loss: 13.174920
Rec Loss: 7.024068
KL Loss: 6.150852
Y Loss: 0.903648
T Loss: 10.763902
X Loss: -4.191659
Epoch 749 
Overall Loss: 13.176030
Rec Loss: 6.965178
KL Loss: 6.210852
Y Loss: 0.895031
T Loss: 10.770053
X Loss: -4.252391
Epoch 799 
Overall Loss: 13.101267
Rec Loss: 6.843239
KL Loss: 6.258029
Y Loss: 0.868854
T Loss: 10.758719
X Loss: -4.349907
Epoch 849 
Overall Loss: 13.099010
Rec Loss: 6.788370
KL Loss: 6.310641
Y Loss: 0.864938
T Loss: 10.770267
X Loss: -4.414365
Epoch 899 
Overall Loss: 13.071459
Rec Loss: 6.699008
KL Loss: 6.372451
Y Loss: 0.850377
T Loss: 10.781277
X Loss: -4.507458
Epoch 949 
Overall Loss: 13.054697
Rec Loss: 6.646742
KL Loss: 6.407955
Y Loss: 0.833143
T Loss: 10.781174
X Loss: -4.551003
Epoch 999 
Overall Loss: 13.047550
Rec Loss: 6.614359
KL Loss: 6.433191
Y Loss: 0.849616
T Loss: 10.784185
X Loss: -4.594634
Epoch 1049 
Overall Loss: 13.038740
Rec Loss: 6.552529
KL Loss: 6.486211
Y Loss: 0.848631
T Loss: 10.792438
X Loss: -4.664225
Epoch 1099 
Overall Loss: 12.979460
Rec Loss: 6.434457
KL Loss: 6.545003
Y Loss: 0.819154
T Loss: 10.786349
X Loss: -4.761469
Epoch 1149 
Overall Loss: 12.979118
Rec Loss: 6.394428
KL Loss: 6.584690
Y Loss: 0.809855
T Loss: 10.782083
X Loss: -4.792583
Epoch 1199 
Overall Loss: 12.955271
Rec Loss: 6.328947
KL Loss: 6.626323
Y Loss: 0.805877
T Loss: 10.781549
X Loss: -4.855539
Epoch 1249 
Overall Loss: 12.980737
Rec Loss: 6.338551
KL Loss: 6.642186
Y Loss: 0.832687
T Loss: 10.804831
X Loss: -4.882623
Epoch 1299 
Overall Loss: 12.972165
Rec Loss: 6.315153
KL Loss: 6.657013
Y Loss: 0.832343
T Loss: 10.813674
X Loss: -4.914693
Epoch 1349 
Overall Loss: 12.907227
Rec Loss: 6.178385
KL Loss: 6.728842
Y Loss: 0.826572
T Loss: 10.792688
X Loss: -5.027589
Epoch 1399 
Overall Loss: 12.920914
Rec Loss: 6.167012
KL Loss: 6.753903
Y Loss: 0.821298
T Loss: 10.808790
X Loss: -5.052427
Epoch 1449 
Overall Loss: 12.911383
Rec Loss: 6.094812
KL Loss: 6.816571
Y Loss: 0.791266
T Loss: 10.815423
X Loss: -5.116243
Epoch 1499 
Overall Loss: 12.896998
Rec Loss: 6.041234
KL Loss: 6.855764
Y Loss: 0.802723
T Loss: 10.801749
X Loss: -5.161877
Epoch 1549 
Overall Loss: 12.897540
Rec Loss: 6.019118
KL Loss: 6.878422
Y Loss: 0.795639
T Loss: 10.816545
X Loss: -5.195246
Epoch 1599 
Overall Loss: 12.891279
Rec Loss: 5.990003
KL Loss: 6.901276
Y Loss: 0.800934
T Loss: 10.829736
X Loss: -5.240200
Epoch 1649 
Overall Loss: 12.906471
Rec Loss: 5.943746
KL Loss: 6.962726
Y Loss: 0.803130
T Loss: 10.814728
X Loss: -5.272547
Epoch 1699 
Overall Loss: 12.871075
Rec Loss: 5.901699
KL Loss: 6.969375
Y Loss: 0.810496
T Loss: 10.808906
X Loss: -5.312455
Epoch 1749 
Overall Loss: 12.888273
Rec Loss: 5.888054
KL Loss: 7.000219
Y Loss: 0.800814
T Loss: 10.836895
X Loss: -5.349248
Epoch 1799 
Overall Loss: 12.867236
Rec Loss: 5.828386
KL Loss: 7.038849
Y Loss: 0.813947
T Loss: 10.828599
X Loss: -5.407185
Epoch 1849 
Overall Loss: 12.859477
Rec Loss: 5.793577
KL Loss: 7.065900
Y Loss: 0.818089
T Loss: 10.816642
X Loss: -5.432110
Epoch 1899 
Overall Loss: 12.830995
Rec Loss: 5.751575
KL Loss: 7.079420
Y Loss: 0.796753
T Loss: 10.820219
X Loss: -5.467020
Epoch 1949 
Overall Loss: 12.855865
Rec Loss: 5.751236
KL Loss: 7.104629
Y Loss: 0.801825
T Loss: 10.834435
X Loss: -5.484111
Epoch 1999 
Overall Loss: 12.813726
Rec Loss: 5.665814
KL Loss: 7.147911
Y Loss: 0.793369
T Loss: 10.822196
X Loss: -5.553066
Epoch 2049 
Overall Loss: 12.812972
Rec Loss: 5.662179
KL Loss: 7.150793
Y Loss: 0.795926
T Loss: 10.835003
X Loss: -5.570786
Epoch 2099 
Overall Loss: 12.831880
Rec Loss: 5.632367
KL Loss: 7.199513
Y Loss: 0.791968
T Loss: 10.855549
X Loss: -5.619166
Epoch 2149 
Overall Loss: 12.828753
Rec Loss: 5.595560
KL Loss: 7.233192
Y Loss: 0.805757
T Loss: 10.841779
X Loss: -5.649097
Epoch 2199 
Overall Loss: 12.820141
Rec Loss: 5.566819
KL Loss: 7.253322
Y Loss: 0.811069
T Loss: 10.848822
X Loss: -5.687538
Epoch 2249 
Overall Loss: 12.814936
Rec Loss: 5.537118
KL Loss: 7.277818
Y Loss: 0.797122
T Loss: 10.854016
X Loss: -5.715459
Epoch 2299 
Overall Loss: 12.830533
Rec Loss: 5.512638
KL Loss: 7.317895
Y Loss: 0.818588
T Loss: 10.848791
X Loss: -5.745447
Epoch 2349 
Overall Loss: 12.812385
Rec Loss: 5.466993
KL Loss: 7.345391
Y Loss: 0.806412
T Loss: 10.847950
X Loss: -5.784162
Epoch 2399 
Overall Loss: 12.797412
Rec Loss: 5.447880
KL Loss: 7.349532
Y Loss: 0.804342
T Loss: 10.858228
X Loss: -5.812519
Epoch 2449 
Overall Loss: 12.828274
Rec Loss: 5.456050
KL Loss: 7.372224
Y Loss: 0.802022
T Loss: 10.850667
X Loss: -5.795628
Epoch 2499 
Overall Loss: 12.787957
Rec Loss: 5.407354
KL Loss: 7.380604
Y Loss: 0.810050
T Loss: 10.855171
X Loss: -5.852843
Epoch 2549 
Overall Loss: 12.784479
Rec Loss: 5.365041
KL Loss: 7.419437
Y Loss: 0.792655
T Loss: 10.857820
X Loss: -5.889107
Epoch 2599 
Overall Loss: 12.796085
Rec Loss: 5.363600
KL Loss: 7.432485
Y Loss: 0.811738
T Loss: 10.857329
X Loss: -5.899598
Epoch 2649 
Overall Loss: 12.788510
Rec Loss: 5.337109
KL Loss: 7.451402
Y Loss: 0.816332
T Loss: 10.856228
X Loss: -5.927286
Epoch 2699 
Overall Loss: 12.800751
Rec Loss: 5.318011
KL Loss: 7.482740
Y Loss: 0.801684
T Loss: 10.872495
X Loss: -5.955325
Epoch 2749 
Overall Loss: 12.789608
Rec Loss: 5.289406
KL Loss: 7.500202
Y Loss: 0.813195
T Loss: 10.856054
X Loss: -5.973245
Epoch 2799 
Overall Loss: 12.765846
Rec Loss: 5.259106
KL Loss: 7.506740
Y Loss: 0.809030
T Loss: 10.859181
X Loss: -6.004589
Epoch 2849 
Overall Loss: 12.803962
Rec Loss: 5.271566
KL Loss: 7.532395
Y Loss: 0.832155
T Loss: 10.868635
X Loss: -6.013146
Epoch 2899 
Overall Loss: 12.787474
Rec Loss: 5.250612
KL Loss: 7.536862
Y Loss: 0.810759
T Loss: 10.872131
X Loss: -6.026899
Epoch 2949 
Overall Loss: 12.786435
Rec Loss: 5.211766
KL Loss: 7.574669
Y Loss: 0.808854
T Loss: 10.875392
X Loss: -6.068053
Epoch 2999 
Overall Loss: 12.784777
Rec Loss: 5.188978
KL Loss: 7.595799
Y Loss: 0.805400
T Loss: 10.863776
X Loss: -6.077497
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.286480
Epoch 99
Rec Loss: 1.285921
Epoch 149
Rec Loss: 1.268506
Epoch 199
Rec Loss: 1.275647
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 1.998208
Epoch 99
Rec Loss: 1.995055
Epoch 149
Rec Loss: 1.991983
Epoch 199
Rec Loss: 1.998259
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.640013
Insample Error 2.278393
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.717795
Epoch 99 
Prediction Loss: 0.658409
Epoch 149 
Prediction Loss: 0.596132
Epoch 199 
Prediction Loss: 0.557544
Epoch 249 
Prediction Loss: 0.537704
Epoch 299 
Prediction Loss: 0.530685
Epoch 349 
Prediction Loss: 0.525117
Epoch 399 
Prediction Loss: 0.507502
Epoch 449 
Prediction Loss: 0.506740
Epoch 499 
Prediction Loss: 0.470081
Epoch 549 
Prediction Loss: 0.453812
Epoch 599 
Prediction Loss: 0.434196
Epoch 649 
Prediction Loss: 0.422960
Epoch 699 
Prediction Loss: 0.416309
Epoch 749 
Prediction Loss: 0.394675
Epoch 799 
Prediction Loss: 0.408801
Epoch 849 
Prediction Loss: 0.364946
Epoch 899 
Prediction Loss: 0.365748
Epoch 949 
Prediction Loss: 0.348973
Epoch 999 
Prediction Loss: 0.342324
Epoch 1049 
Prediction Loss: 0.329427
Epoch 1099 
Prediction Loss: 0.338359
Epoch 1149 
Prediction Loss: 0.338616
Epoch 1199 
Prediction Loss: 0.325151
Epoch 1249 
Prediction Loss: 0.316652
Epoch 1299 
Prediction Loss: 0.309250
Epoch 1349 
Prediction Loss: 0.291020
Epoch 1399 
Prediction Loss: 0.284294
Epoch 1449 
Prediction Loss: 0.292859
Epoch 1499 
Prediction Loss: 0.282526
Epoch 1549 
Prediction Loss: 0.266359
Epoch 1599 
Prediction Loss: 0.267007
Epoch 1649 
Prediction Loss: 0.253084
Epoch 1699 
Prediction Loss: 0.266352
Epoch 1749 
Prediction Loss: 0.249254
Epoch 1799 
Prediction Loss: 0.247706
Epoch 1849 
Prediction Loss: 0.232562
Epoch 1899 
Prediction Loss: 0.237504
Epoch 1949 
Prediction Loss: 0.244706
Epoch 1999 
Prediction Loss: 0.222041
Epoch 2049 
Prediction Loss: 0.224808
Epoch 2099 
Prediction Loss: 0.227586
Epoch 2149 
Prediction Loss: 0.218905
Epoch 2199 
Prediction Loss: 0.223707
Epoch 2249 
Prediction Loss: 0.209880
Epoch 2299 
Prediction Loss: 0.210760
Epoch 2349 
Prediction Loss: 0.212167
Epoch 2399 
Prediction Loss: 0.223135
Epoch 2449 
Prediction Loss: 0.210080
Epoch 2499 
Prediction Loss: 0.218118
Epoch 2549 
Prediction Loss: 0.197854
Epoch 2599 
Prediction Loss: 0.199921
Epoch 2649 
Prediction Loss: 0.196524
Epoch 2699 
Prediction Loss: 0.205172
Epoch 2749 
Prediction Loss: 0.195456
Epoch 2799 
Prediction Loss: 0.201955
Epoch 2849 
Prediction Loss: 0.199558
Epoch 2899 
Prediction Loss: 0.186443
Epoch 2949 
Prediction Loss: 0.188052
Epoch 2999 
Prediction Loss: 0.200225
Epoch 3049 
Prediction Loss: 0.188048
Epoch 3099 
Prediction Loss: 0.196932
Epoch 3149 
Prediction Loss: 0.183904
Epoch 3199 
Prediction Loss: 0.186466
Epoch 3249 
Prediction Loss: 0.184244
Epoch 3299 
Prediction Loss: 0.174405
Epoch 3349 
Prediction Loss: 0.175899
Epoch 3399 
Prediction Loss: 0.181805
Epoch 3449 
Prediction Loss: 0.174880
Epoch 3499 
Prediction Loss: 0.171301
Epoch 3549 
Prediction Loss: 0.176556
Epoch 3599 
Prediction Loss: 0.167861
Epoch 3649 
Prediction Loss: 0.167192
Epoch 3699 
Prediction Loss: 0.179557
Epoch 3749 
Prediction Loss: 0.161584
Epoch 3799 
Prediction Loss: 0.169345
Epoch 3849 
Prediction Loss: 0.168882
Epoch 3899 
Prediction Loss: 0.188433
Epoch 3949 
Prediction Loss: 0.158559
Epoch 3999 
Prediction Loss: 0.170382
Epoch 4049 
Prediction Loss: 0.159506
Epoch 4099 
Prediction Loss: 0.165438
Epoch 4149 
Prediction Loss: 0.164919
Epoch 4199 
Prediction Loss: 0.164553
Epoch 4249 
Prediction Loss: 0.156899
Epoch 4299 
Prediction Loss: 0.165085
Epoch 4349 
Prediction Loss: 0.173697
Epoch 4399 
Prediction Loss: 0.164578
Epoch 4449 
Prediction Loss: 0.157295
Epoch 4499 
Prediction Loss: 0.161329
Epoch 4549 
Prediction Loss: 0.164170
Epoch 4599 
Prediction Loss: 0.161531
Epoch 4649 
Prediction Loss: 0.149473
Epoch 4699 
Prediction Loss: 0.157187
Epoch 4749 
Prediction Loss: 0.150690
Epoch 4799 
Prediction Loss: 0.157797
Epoch 4849 
Prediction Loss: 0.154399
Epoch 4899 
Prediction Loss: 0.153709
Epoch 4949 
Prediction Loss: 0.155567
Epoch 4999 
Prediction Loss: 0.147482
Epoch 5049 
Prediction Loss: 0.154248
Epoch 5099 
Prediction Loss: 0.157769
Epoch 5149 
Prediction Loss: 0.151796
Epoch 5199 
Prediction Loss: 0.168963
Epoch 5249 
Prediction Loss: 0.145641
Epoch 5299 
Prediction Loss: 0.151258
Epoch 5349 
Prediction Loss: 0.148576
Epoch 5399 
Prediction Loss: 0.152788
Epoch 5449 
Prediction Loss: 0.144001
Epoch 5499 
Prediction Loss: 0.145835
Epoch 5549 
Prediction Loss: 0.153101
Epoch 5599 
Prediction Loss: 0.146513
Epoch 5649 
Prediction Loss: 0.159320
Epoch 5699 
Prediction Loss: 0.144818
Epoch 5749 
Prediction Loss: 0.154621
Epoch 5799 
Prediction Loss: 0.142930
Epoch 5849 
Prediction Loss: 0.162068
Epoch 5899 
Prediction Loss: 0.142311
Epoch 5949 
Prediction Loss: 0.146949
Epoch 5999 
Prediction Loss: 0.181777
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.383960
Insample Error 1.794252
[31m========== repeat time 4 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.992465
Rec Loss: 10.935417
KL Loss: 1.057048
Y Loss: 0.928515
T Loss: 10.471159
Epoch 99 
Overall Loss: 11.616076
Rec Loss: 10.747285
KL Loss: 0.868791
Y Loss: 0.722957
T Loss: 10.385806
Epoch 149 
Overall Loss: 11.505987
Rec Loss: 10.721496
KL Loss: 0.784492
Y Loss: 0.630794
T Loss: 10.406098
Epoch 199 
Overall Loss: 11.458764
Rec Loss: 10.714753
KL Loss: 0.744011
Y Loss: 0.597732
T Loss: 10.415886
Epoch 249 
Overall Loss: 11.423518
Rec Loss: 10.688927
KL Loss: 0.734592
Y Loss: 0.579877
T Loss: 10.398989
Epoch 299 
Overall Loss: 11.427348
Rec Loss: 10.715614
KL Loss: 0.711734
Y Loss: 0.592129
T Loss: 10.419550
Epoch 349 
Overall Loss: 11.384730
Rec Loss: 10.685564
KL Loss: 0.699167
Y Loss: 0.568559
T Loss: 10.401284
Epoch 399 
Overall Loss: 11.392363
Rec Loss: 10.676810
KL Loss: 0.715553
Y Loss: 0.554314
T Loss: 10.399653
Epoch 449 
Overall Loss: 11.395097
Rec Loss: 10.696062
KL Loss: 0.699034
Y Loss: 0.552814
T Loss: 10.419655
Epoch 499 
Overall Loss: 11.381487
Rec Loss: 10.681524
KL Loss: 0.699963
Y Loss: 0.551196
T Loss: 10.405926
Epoch 549 
Overall Loss: 11.378412
Rec Loss: 10.666627
KL Loss: 0.711786
Y Loss: 0.541767
T Loss: 10.395743
Epoch 599 
Overall Loss: 11.370955
Rec Loss: 10.663063
KL Loss: 0.707892
Y Loss: 0.542794
T Loss: 10.391666
Epoch 649 
Overall Loss: 11.340399
Rec Loss: 10.656823
KL Loss: 0.683576
Y Loss: 0.528132
T Loss: 10.392757
Epoch 699 
Overall Loss: 11.343002
Rec Loss: 10.646981
KL Loss: 0.696021
Y Loss: 0.522003
T Loss: 10.385980
Epoch 749 
Overall Loss: 11.345563
Rec Loss: 10.668435
KL Loss: 0.677127
Y Loss: 0.517236
T Loss: 10.409817
Epoch 799 
Overall Loss: 11.324294
Rec Loss: 10.650307
KL Loss: 0.673988
Y Loss: 0.515844
T Loss: 10.392385
Epoch 849 
Overall Loss: 11.341760
Rec Loss: 10.655605
KL Loss: 0.686155
Y Loss: 0.515363
T Loss: 10.397923
Epoch 899 
Overall Loss: 11.319650
Rec Loss: 10.637528
KL Loss: 0.682122
Y Loss: 0.509555
T Loss: 10.382751
Epoch 949 
Overall Loss: 11.327648
Rec Loss: 10.640949
KL Loss: 0.686699
Y Loss: 0.515503
T Loss: 10.383198
Epoch 999 
Overall Loss: 11.309507
Rec Loss: 10.631784
KL Loss: 0.677723
Y Loss: 0.501603
T Loss: 10.380982
Epoch 1049 
Overall Loss: 11.299495
Rec Loss: 10.612331
KL Loss: 0.687163
Y Loss: 0.493884
T Loss: 10.365390
Epoch 1099 
Overall Loss: 11.296714
Rec Loss: 10.620354
KL Loss: 0.676361
Y Loss: 0.494388
T Loss: 10.373160
Epoch 1149 
Overall Loss: 11.295189
Rec Loss: 10.610833
KL Loss: 0.684356
Y Loss: 0.493377
T Loss: 10.364144
Epoch 1199 
Overall Loss: 11.290068
Rec Loss: 10.601778
KL Loss: 0.688290
Y Loss: 0.487751
T Loss: 10.357902
Epoch 1249 
Overall Loss: 11.289696
Rec Loss: 10.611896
KL Loss: 0.677800
Y Loss: 0.486383
T Loss: 10.368704
Epoch 1299 
Overall Loss: 11.280792
Rec Loss: 10.599576
KL Loss: 0.681216
Y Loss: 0.487393
T Loss: 10.355879
Epoch 1349 
Overall Loss: 11.280125
Rec Loss: 10.599639
KL Loss: 0.680486
Y Loss: 0.493540
T Loss: 10.352869
Epoch 1399 
Overall Loss: 11.256936
Rec Loss: 10.606539
KL Loss: 0.650397
Y Loss: 0.493000
T Loss: 10.360038
Epoch 1449 
Overall Loss: 11.276444
Rec Loss: 10.596002
KL Loss: 0.680442
Y Loss: 0.477269
T Loss: 10.357368
Epoch 1499 
Overall Loss: 11.252990
Rec Loss: 10.585378
KL Loss: 0.667612
Y Loss: 0.481405
T Loss: 10.344675
Epoch 1549 
Overall Loss: 11.248167
Rec Loss: 10.586602
KL Loss: 0.661565
Y Loss: 0.476319
T Loss: 10.348442
Epoch 1599 
Overall Loss: 11.248829
Rec Loss: 10.585637
KL Loss: 0.663192
Y Loss: 0.464618
T Loss: 10.353328
Epoch 1649 
Overall Loss: 11.247906
Rec Loss: 10.576340
KL Loss: 0.671566
Y Loss: 0.461350
T Loss: 10.345665
Epoch 1699 
Overall Loss: 11.240966
Rec Loss: 10.565646
KL Loss: 0.675320
Y Loss: 0.466965
T Loss: 10.332163
Epoch 1749 
Overall Loss: 11.234333
Rec Loss: 10.559756
KL Loss: 0.674577
Y Loss: 0.474544
T Loss: 10.322484
Epoch 1799 
Overall Loss: 11.230352
Rec Loss: 10.545550
KL Loss: 0.684802
Y Loss: 0.459243
T Loss: 10.315929
Epoch 1849 
Overall Loss: 11.232263
Rec Loss: 10.548785
KL Loss: 0.683477
Y Loss: 0.458914
T Loss: 10.319329
Epoch 1899 
Overall Loss: 11.228075
Rec Loss: 10.559929
KL Loss: 0.668146
Y Loss: 0.448825
T Loss: 10.335517
Epoch 1949 
Overall Loss: 11.209639
Rec Loss: 10.524847
KL Loss: 0.684793
Y Loss: 0.458391
T Loss: 10.295651
Epoch 1999 
Overall Loss: 11.207644
Rec Loss: 10.534140
KL Loss: 0.673505
Y Loss: 0.449352
T Loss: 10.309464
Epoch 2049 
Overall Loss: 11.211423
Rec Loss: 10.538481
KL Loss: 0.672942
Y Loss: 0.457749
T Loss: 10.309606
Epoch 2099 
Overall Loss: 11.204739
Rec Loss: 10.533934
KL Loss: 0.670804
Y Loss: 0.445752
T Loss: 10.311058
Epoch 2149 
Overall Loss: 11.206199
Rec Loss: 10.539605
KL Loss: 0.666594
Y Loss: 0.449098
T Loss: 10.315056
Epoch 2199 
Overall Loss: 11.196094
Rec Loss: 10.532531
KL Loss: 0.663563
Y Loss: 0.449049
T Loss: 10.308007
Epoch 2249 
Overall Loss: 11.191993
Rec Loss: 10.525066
KL Loss: 0.666928
Y Loss: 0.438123
T Loss: 10.306004
Epoch 2299 
Overall Loss: 11.194852
Rec Loss: 10.530365
KL Loss: 0.664487
Y Loss: 0.445120
T Loss: 10.307805
Epoch 2349 
Overall Loss: 11.198796
Rec Loss: 10.522085
KL Loss: 0.676710
Y Loss: 0.441756
T Loss: 10.301207
Epoch 2399 
Overall Loss: 11.185630
Rec Loss: 10.503318
KL Loss: 0.682313
Y Loss: 0.440084
T Loss: 10.283275
Epoch 2449 
Overall Loss: 11.188017
Rec Loss: 10.520628
KL Loss: 0.667390
Y Loss: 0.442452
T Loss: 10.299402
Epoch 2499 
Overall Loss: 11.178578
Rec Loss: 10.520546
KL Loss: 0.658032
Y Loss: 0.444728
T Loss: 10.298182
Epoch 2549 
Overall Loss: 11.185798
Rec Loss: 10.509662
KL Loss: 0.676136
Y Loss: 0.437404
T Loss: 10.290960
Epoch 2599 
Overall Loss: 11.180029
Rec Loss: 10.527972
KL Loss: 0.652057
Y Loss: 0.442215
T Loss: 10.306865
Epoch 2649 
Overall Loss: 11.170449
Rec Loss: 10.506007
KL Loss: 0.664442
Y Loss: 0.431145
T Loss: 10.290435
Epoch 2699 
Overall Loss: 11.190659
Rec Loss: 10.512787
KL Loss: 0.677872
Y Loss: 0.429847
T Loss: 10.297863
Epoch 2749 
Overall Loss: 11.158914
Rec Loss: 10.497507
KL Loss: 0.661407
Y Loss: 0.433707
T Loss: 10.280654
Epoch 2799 
Overall Loss: 11.156959
Rec Loss: 10.490627
KL Loss: 0.666332
Y Loss: 0.433938
T Loss: 10.273658
Epoch 2849 
Overall Loss: 11.164931
Rec Loss: 10.483326
KL Loss: 0.681605
Y Loss: 0.425392
T Loss: 10.270630
Epoch 2899 
Overall Loss: 11.151707
Rec Loss: 10.500245
KL Loss: 0.651462
Y Loss: 0.431222
T Loss: 10.284634
Epoch 2949 
Overall Loss: 11.152128
Rec Loss: 10.484258
KL Loss: 0.667870
Y Loss: 0.429513
T Loss: 10.269501
Epoch 2999 
Overall Loss: 11.167260
Rec Loss: 10.486484
KL Loss: 0.680776
Y Loss: 0.440700
T Loss: 10.266134
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.434909
Epoch 99
Rec Loss: 0.428028
Epoch 149
Rec Loss: 0.416384
Epoch 199
Rec Loss: 0.423988
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.924704
Epoch 99
Rec Loss: 9.918302
Epoch 149
Rec Loss: 9.902145
Epoch 199
Rec Loss: 9.884412
Epoch 249
Rec Loss: 9.875332
Epoch 299
Rec Loss: 9.872796
Epoch 349
Rec Loss: 9.863765
Epoch 399
Rec Loss: 9.854339
Epoch 449
Rec Loss: 9.857987
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.615098
Insample Error: 1.449308
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.688219
Rec Loss: 19.677119
KL Loss: 3.011100
Y Loss: 9.865568
T Loss: 12.875383
X Loss: 1.868952
Epoch 99 
Overall Loss: 17.565780
Rec Loss: 14.225483
KL Loss: 3.340297
Y Loss: 3.820455
T Loss: 12.846578
X Loss: -0.531323
Epoch 149 
Overall Loss: 16.227548
Rec Loss: 12.673535
KL Loss: 3.554013
Y Loss: 2.495880
T Loss: 12.707755
X Loss: -1.282160
Epoch 199 
Overall Loss: 15.400655
Rec Loss: 11.547812
KL Loss: 3.852844
Y Loss: 1.741591
T Loss: 12.355161
X Loss: -1.678145
Epoch 249 
Overall Loss: 14.889704
Rec Loss: 10.837484
KL Loss: 4.052220
Y Loss: 1.451683
T Loss: 12.078979
X Loss: -1.967337
Epoch 299 
Overall Loss: 14.514999
Rec Loss: 10.090595
KL Loss: 4.424403
Y Loss: 1.307557
T Loss: 11.695229
X Loss: -2.258413
Epoch 349 
Overall Loss: 14.254261
Rec Loss: 9.617351
KL Loss: 4.636910
Y Loss: 1.231191
T Loss: 11.573874
X Loss: -2.572118
Epoch 399 
Overall Loss: 13.985006
Rec Loss: 9.028331
KL Loss: 4.956674
Y Loss: 1.160363
T Loss: 11.430862
X Loss: -2.982712
Epoch 449 
Overall Loss: 13.722438
Rec Loss: 8.317866
KL Loss: 5.404572
Y Loss: 1.133289
T Loss: 11.239303
X Loss: -3.488082
Epoch 499 
Overall Loss: 13.575718
Rec Loss: 7.922836
KL Loss: 5.652882
Y Loss: 1.082172
T Loss: 11.195608
X Loss: -3.813858
Epoch 549 
Overall Loss: 13.462171
Rec Loss: 7.647568
KL Loss: 5.814603
Y Loss: 1.052486
T Loss: 11.161038
X Loss: -4.039714
Epoch 599 
Overall Loss: 13.373039
Rec Loss: 7.388485
KL Loss: 5.984554
Y Loss: 0.986424
T Loss: 11.174230
X Loss: -4.278957
Epoch 649 
Overall Loss: 13.308072
Rec Loss: 7.229593
KL Loss: 6.078479
Y Loss: 0.956008
T Loss: 11.175899
X Loss: -4.424310
Epoch 699 
Overall Loss: 13.270478
Rec Loss: 7.076143
KL Loss: 6.194335
Y Loss: 0.935926
T Loss: 11.186951
X Loss: -4.578771
Epoch 749 
Overall Loss: 13.238811
Rec Loss: 6.966782
KL Loss: 6.272029
Y Loss: 0.918098
T Loss: 11.217332
X Loss: -4.709599
Epoch 799 
Overall Loss: 13.188282
Rec Loss: 6.813355
KL Loss: 6.374927
Y Loss: 0.884098
T Loss: 11.241897
X Loss: -4.870591
Epoch 849 
Overall Loss: 13.184078
Rec Loss: 6.725987
KL Loss: 6.458090
Y Loss: 0.834514
T Loss: 11.248881
X Loss: -4.940150
Epoch 899 
Overall Loss: 13.118430
Rec Loss: 6.579833
KL Loss: 6.538597
Y Loss: 0.855177
T Loss: 11.271132
X Loss: -5.118887
Epoch 949 
Overall Loss: 13.086096
Rec Loss: 6.467987
KL Loss: 6.618108
Y Loss: 0.820552
T Loss: 11.294180
X Loss: -5.236469
Epoch 999 
Overall Loss: 13.083788
Rec Loss: 6.403442
KL Loss: 6.680345
Y Loss: 0.819895
T Loss: 11.296215
X Loss: -5.302721
Epoch 1049 
Overall Loss: 13.068098
Rec Loss: 6.307679
KL Loss: 6.760418
Y Loss: 0.799192
T Loss: 11.320318
X Loss: -5.412235
Epoch 1099 
Overall Loss: 13.016909
Rec Loss: 6.215156
KL Loss: 6.801754
Y Loss: 0.813975
T Loss: 11.330414
X Loss: -5.522246
Epoch 1149 
Overall Loss: 13.001809
Rec Loss: 6.103798
KL Loss: 6.898011
Y Loss: 0.792041
T Loss: 11.340544
X Loss: -5.632766
Epoch 1199 
Overall Loss: 12.977149
Rec Loss: 5.968560
KL Loss: 7.008589
Y Loss: 0.775624
T Loss: 11.354687
X Loss: -5.773938
Epoch 1249 
Overall Loss: 12.954647
Rec Loss: 5.890827
KL Loss: 7.063820
Y Loss: 0.780061
T Loss: 11.361578
X Loss: -5.860781
Epoch 1299 
Overall Loss: 12.938633
Rec Loss: 5.765905
KL Loss: 7.172728
Y Loss: 0.764046
T Loss: 11.376414
X Loss: -5.992532
Epoch 1349 
Overall Loss: 12.926235
Rec Loss: 5.706043
KL Loss: 7.220192
Y Loss: 0.770607
T Loss: 11.369405
X Loss: -6.048665
Epoch 1399 
Overall Loss: 12.864326
Rec Loss: 5.565696
KL Loss: 7.298629
Y Loss: 0.754361
T Loss: 11.386228
X Loss: -6.197713
Epoch 1449 
Overall Loss: 12.905648
Rec Loss: 5.499743
KL Loss: 7.405906
Y Loss: 0.745763
T Loss: 11.395499
X Loss: -6.268638
Epoch 1499 
Overall Loss: 12.876326
Rec Loss: 5.412843
KL Loss: 7.463484
Y Loss: 0.738081
T Loss: 11.394607
X Loss: -6.350805
Epoch 1549 
Overall Loss: 12.828064
Rec Loss: 5.290574
KL Loss: 7.537490
Y Loss: 0.729043
T Loss: 11.411604
X Loss: -6.485552
Epoch 1599 
Overall Loss: 12.841967
Rec Loss: 5.229729
KL Loss: 7.612238
Y Loss: 0.739963
T Loss: 11.415504
X Loss: -6.555757
Epoch 1649 
Overall Loss: 12.842049
Rec Loss: 5.144052
KL Loss: 7.697997
Y Loss: 0.701381
T Loss: 11.407081
X Loss: -6.613718
Epoch 1699 
Overall Loss: 12.839934
Rec Loss: 5.084781
KL Loss: 7.755153
Y Loss: 0.724267
T Loss: 11.426728
X Loss: -6.704081
Epoch 1749 
Overall Loss: 12.794318
Rec Loss: 4.934352
KL Loss: 7.859967
Y Loss: 0.721795
T Loss: 11.429216
X Loss: -6.855762
Epoch 1799 
Overall Loss: 12.773466
Rec Loss: 4.856579
KL Loss: 7.916887
Y Loss: 0.720607
T Loss: 11.424047
X Loss: -6.927772
Epoch 1849 
Overall Loss: 12.787285
Rec Loss: 4.757384
KL Loss: 8.029901
Y Loss: 0.711652
T Loss: 11.436907
X Loss: -7.035349
Epoch 1899 
Overall Loss: 12.787881
Rec Loss: 4.698527
KL Loss: 8.089354
Y Loss: 0.704020
T Loss: 11.438592
X Loss: -7.092075
Epoch 1949 
Overall Loss: 12.744766
Rec Loss: 4.610892
KL Loss: 8.133874
Y Loss: 0.689672
T Loss: 11.444599
X Loss: -7.178542
Epoch 1999 
Overall Loss: 12.755631
Rec Loss: 4.537432
KL Loss: 8.218199
Y Loss: 0.690415
T Loss: 11.445870
X Loss: -7.253646
Epoch 2049 
Overall Loss: 12.764743
Rec Loss: 4.474262
KL Loss: 8.290481
Y Loss: 0.679094
T Loss: 11.446618
X Loss: -7.311904
Epoch 2099 
Overall Loss: 12.717906
Rec Loss: 4.364027
KL Loss: 8.353879
Y Loss: 0.699013
T Loss: 11.453122
X Loss: -7.438601
Epoch 2149 
Overall Loss: 12.766554
Rec Loss: 4.280918
KL Loss: 8.485636
Y Loss: 0.681280
T Loss: 11.462974
X Loss: -7.522696
Epoch 2199 
Overall Loss: 12.707280
Rec Loss: 4.198052
KL Loss: 8.509228
Y Loss: 0.669812
T Loss: 11.458662
X Loss: -7.595516
Epoch 2249 
Overall Loss: 12.701258
Rec Loss: 4.138844
KL Loss: 8.562413
Y Loss: 0.672209
T Loss: 11.465315
X Loss: -7.662575
Epoch 2299 
Overall Loss: 12.705641
Rec Loss: 4.092929
KL Loss: 8.612712
Y Loss: 0.680768
T Loss: 11.466614
X Loss: -7.714068
Epoch 2349 
Overall Loss: 12.714224
Rec Loss: 4.044819
KL Loss: 8.669404
Y Loss: 0.690668
T Loss: 11.468768
X Loss: -7.769282
Epoch 2399 
Overall Loss: 12.719460
Rec Loss: 3.947064
KL Loss: 8.772395
Y Loss: 0.679029
T Loss: 11.467052
X Loss: -7.859503
Epoch 2449 
Overall Loss: 12.689251
Rec Loss: 3.890435
KL Loss: 8.798816
Y Loss: 0.674959
T Loss: 11.469211
X Loss: -7.916256
Epoch 2499 
Overall Loss: 12.682304
Rec Loss: 3.825995
KL Loss: 8.856309
Y Loss: 0.668902
T Loss: 11.478469
X Loss: -7.986926
Epoch 2549 
Overall Loss: 12.659749
Rec Loss: 3.745379
KL Loss: 8.914370
Y Loss: 0.673229
T Loss: 11.468756
X Loss: -8.059992
Epoch 2599 
Overall Loss: 12.682401
Rec Loss: 3.726866
KL Loss: 8.955535
Y Loss: 0.667356
T Loss: 11.471476
X Loss: -8.078288
Epoch 2649 
Overall Loss: 12.645092
Rec Loss: 3.647041
KL Loss: 8.998050
Y Loss: 0.657212
T Loss: 11.478723
X Loss: -8.160287
Epoch 2699 
Overall Loss: 12.651223
Rec Loss: 3.573268
KL Loss: 9.077955
Y Loss: 0.665371
T Loss: 11.475272
X Loss: -8.234688
Epoch 2749 
Overall Loss: 12.632834
Rec Loss: 3.506832
KL Loss: 9.126003
Y Loss: 0.654043
T Loss: 11.475069
X Loss: -8.295259
Epoch 2799 
Overall Loss: 12.647919
Rec Loss: 3.535054
KL Loss: 9.112864
Y Loss: 0.665590
T Loss: 11.475522
X Loss: -8.273263
Epoch 2849 
Overall Loss: 12.656175
Rec Loss: 3.460602
KL Loss: 9.195573
Y Loss: 0.647153
T Loss: 11.484058
X Loss: -8.347032
Epoch 2899 
Overall Loss: 12.635813
Rec Loss: 3.386182
KL Loss: 9.249630
Y Loss: 0.644397
T Loss: 11.481069
X Loss: -8.417085
Epoch 2949 
Overall Loss: 12.650842
Rec Loss: 3.389845
KL Loss: 9.260997
Y Loss: 0.657402
T Loss: 11.483143
X Loss: -8.421999
Epoch 2999 
Overall Loss: 12.652241
Rec Loss: 3.334318
KL Loss: 9.317923
Y Loss: 0.649732
T Loss: 11.479364
X Loss: -8.469911
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.978041
Epoch 99
Rec Loss: 0.973720
Epoch 149
Rec Loss: 0.972161
Epoch 199
Rec Loss: 0.971545
Epoch 249
Rec Loss: 0.967554
Epoch 299
Rec Loss: 0.967916
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 1.999442
Epoch 99
Rec Loss: 1.993624
Epoch 149
Rec Loss: 1.995891
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.692228
Insample Error 2.049494
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.750137
Epoch 99 
Prediction Loss: 0.663953
Epoch 149 
Prediction Loss: 0.589276
Epoch 199 
Prediction Loss: 0.545285
Epoch 249 
Prediction Loss: 0.554002
Epoch 299 
Prediction Loss: 0.521585
Epoch 349 
Prediction Loss: 0.489468
Epoch 399 
Prediction Loss: 0.490677
Epoch 449 
Prediction Loss: 0.448939
Epoch 499 
Prediction Loss: 0.443184
Epoch 549 
Prediction Loss: 0.427472
Epoch 599 
Prediction Loss: 0.412742
Epoch 649 
Prediction Loss: 0.392435
Epoch 699 
Prediction Loss: 0.367637
Epoch 749 
Prediction Loss: 0.359576
Epoch 799 
Prediction Loss: 0.349066
Epoch 849 
Prediction Loss: 0.332870
Epoch 899 
Prediction Loss: 0.354123
Epoch 949 
Prediction Loss: 0.320829
Epoch 999 
Prediction Loss: 0.311891
Epoch 1049 
Prediction Loss: 0.300536
Epoch 1099 
Prediction Loss: 0.295125
Epoch 1149 
Prediction Loss: 0.279658
Epoch 1199 
Prediction Loss: 0.268944
Epoch 1249 
Prediction Loss: 0.269176
Epoch 1299 
Prediction Loss: 0.267460
Epoch 1349 
Prediction Loss: 0.261814
Epoch 1399 
Prediction Loss: 0.251398
Epoch 1449 
Prediction Loss: 0.251671
Epoch 1499 
Prediction Loss: 0.246692
Epoch 1549 
Prediction Loss: 0.243349
Epoch 1599 
Prediction Loss: 0.239000
Epoch 1649 
Prediction Loss: 0.230350
Epoch 1699 
Prediction Loss: 0.235513
Epoch 1749 
Prediction Loss: 0.225993
Epoch 1799 
Prediction Loss: 0.228681
Epoch 1849 
Prediction Loss: 0.218304
Epoch 1899 
Prediction Loss: 0.212191
Epoch 1949 
Prediction Loss: 0.209587
Epoch 1999 
Prediction Loss: 0.210006
Epoch 2049 
Prediction Loss: 0.204746
Epoch 2099 
Prediction Loss: 0.208146
Epoch 2149 
Prediction Loss: 0.204888
Epoch 2199 
Prediction Loss: 0.206910
Epoch 2249 
Prediction Loss: 0.203857
Epoch 2299 
Prediction Loss: 0.196557
Epoch 2349 
Prediction Loss: 0.191590
Epoch 2399 
Prediction Loss: 0.187195
Epoch 2449 
Prediction Loss: 0.200985
Epoch 2499 
Prediction Loss: 0.201175
Epoch 2549 
Prediction Loss: 0.187087
Epoch 2599 
Prediction Loss: 0.200968
Epoch 2649 
Prediction Loss: 0.180043
Epoch 2699 
Prediction Loss: 0.174428
Epoch 2749 
Prediction Loss: 0.179787
Epoch 2799 
Prediction Loss: 0.174368
Epoch 2849 
Prediction Loss: 0.172084
Epoch 2899 
Prediction Loss: 0.182810
Epoch 2949 
Prediction Loss: 0.169713
Epoch 2999 
Prediction Loss: 0.166386
Epoch 3049 
Prediction Loss: 0.165543
Epoch 3099 
Prediction Loss: 0.169124
Epoch 3149 
Prediction Loss: 0.165808
Epoch 3199 
Prediction Loss: 0.170973
Epoch 3249 
Prediction Loss: 0.161302
Epoch 3299 
Prediction Loss: 0.160484
Epoch 3349 
Prediction Loss: 0.163765
Epoch 3399 
Prediction Loss: 0.167367
Epoch 3449 
Prediction Loss: 0.163800
Epoch 3499 
Prediction Loss: 0.181525
Epoch 3549 
Prediction Loss: 0.157464
Epoch 3599 
Prediction Loss: 0.160241
Epoch 3649 
Prediction Loss: 0.152366
Epoch 3699 
Prediction Loss: 0.163458
Epoch 3749 
Prediction Loss: 0.151979
Epoch 3799 
Prediction Loss: 0.154330
Epoch 3849 
Prediction Loss: 0.152199
Epoch 3899 
Prediction Loss: 0.150922
Epoch 3949 
Prediction Loss: 0.150795
Epoch 3999 
Prediction Loss: 0.161050
Epoch 4049 
Prediction Loss: 0.152389
Epoch 4099 
Prediction Loss: 0.147167
Epoch 4149 
Prediction Loss: 0.149152
Epoch 4199 
Prediction Loss: 0.147934
Epoch 4249 
Prediction Loss: 0.150017
Epoch 4299 
Prediction Loss: 0.151831
Epoch 4349 
Prediction Loss: 0.149826
Epoch 4399 
Prediction Loss: 0.145806
Epoch 4449 
Prediction Loss: 0.146821
Epoch 4499 
Prediction Loss: 0.154422
Epoch 4549 
Prediction Loss: 0.144130
Epoch 4599 
Prediction Loss: 0.154565
Epoch 4649 
Prediction Loss: 0.141217
Epoch 4699 
Prediction Loss: 0.142187
Epoch 4749 
Prediction Loss: 0.150400
Epoch 4799 
Prediction Loss: 0.139903
Epoch 4849 
Prediction Loss: 0.148002
Epoch 4899 
Prediction Loss: 0.144836
Epoch 4949 
Prediction Loss: 0.147849
Epoch 4999 
Prediction Loss: 0.139720
Epoch 5049 
Prediction Loss: 0.143883
Epoch 5099 
Prediction Loss: 0.137362
Epoch 5149 
Prediction Loss: 0.140777
Epoch 5199 
Prediction Loss: 0.150129
Epoch 5249 
Prediction Loss: 0.141651
Epoch 5299 
Prediction Loss: 0.142376
Epoch 5349 
Prediction Loss: 0.143315
Epoch 5399 
Prediction Loss: 0.135711
Epoch 5449 
Prediction Loss: 0.137955
Epoch 5499 
Prediction Loss: 0.139521
Epoch 5549 
Prediction Loss: 0.133492
Epoch 5599 
Prediction Loss: 0.141034
Epoch 5649 
Prediction Loss: 0.144656
Epoch 5699 
Prediction Loss: 0.137985
Epoch 5749 
Prediction Loss: 0.135668
Epoch 5799 
Prediction Loss: 0.132408
Epoch 5849 
Prediction Loss: 0.137204
Epoch 5899 
Prediction Loss: 0.132670
Epoch 5949 
Prediction Loss: 0.141273
Epoch 5999 
Prediction Loss: 0.134891
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.361012
Insample Error 1.887903
[31m========== repeat time 5 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.906234
Rec Loss: 10.795601
KL Loss: 1.110633
Y Loss: 0.944437
T Loss: 10.323383
Epoch 99 
Overall Loss: 11.625956
Rec Loss: 10.730601
KL Loss: 0.895355
Y Loss: 0.753188
T Loss: 10.354008
Epoch 149 
Overall Loss: 11.525808
Rec Loss: 10.736146
KL Loss: 0.789662
Y Loss: 0.707320
T Loss: 10.382486
Epoch 199 
Overall Loss: 11.493648
Rec Loss: 10.738682
KL Loss: 0.754967
Y Loss: 0.659111
T Loss: 10.409126
Epoch 249 
Overall Loss: 11.450687
Rec Loss: 10.721524
KL Loss: 0.729163
Y Loss: 0.637484
T Loss: 10.402782
Epoch 299 
Overall Loss: 11.436835
Rec Loss: 10.718487
KL Loss: 0.718348
Y Loss: 0.626380
T Loss: 10.405298
Epoch 349 
Overall Loss: 11.419043
Rec Loss: 10.695697
KL Loss: 0.723346
Y Loss: 0.612363
T Loss: 10.389515
Epoch 399 
Overall Loss: 11.392362
Rec Loss: 10.699534
KL Loss: 0.692828
Y Loss: 0.598132
T Loss: 10.400468
Epoch 449 
Overall Loss: 11.381669
Rec Loss: 10.689809
KL Loss: 0.691859
Y Loss: 0.592833
T Loss: 10.393393
Epoch 499 
Overall Loss: 11.376093
Rec Loss: 10.709835
KL Loss: 0.666258
Y Loss: 0.594835
T Loss: 10.412418
Epoch 549 
Overall Loss: 11.367924
Rec Loss: 10.681340
KL Loss: 0.686584
Y Loss: 0.578243
T Loss: 10.392219
Epoch 599 
Overall Loss: 11.369174
Rec Loss: 10.691049
KL Loss: 0.678126
Y Loss: 0.576629
T Loss: 10.402735
Epoch 649 
Overall Loss: 11.346583
Rec Loss: 10.668837
KL Loss: 0.677747
Y Loss: 0.566359
T Loss: 10.385657
Epoch 699 
Overall Loss: 11.346168
Rec Loss: 10.657127
KL Loss: 0.689041
Y Loss: 0.563056
T Loss: 10.375599
Epoch 749 
Overall Loss: 11.355859
Rec Loss: 10.679902
KL Loss: 0.675957
Y Loss: 0.566714
T Loss: 10.396546
Epoch 799 
Overall Loss: 11.325205
Rec Loss: 10.666604
KL Loss: 0.658602
Y Loss: 0.564687
T Loss: 10.384261
Epoch 849 
Overall Loss: 11.327868
Rec Loss: 10.644035
KL Loss: 0.683833
Y Loss: 0.548175
T Loss: 10.369948
Epoch 899 
Overall Loss: 11.323230
Rec Loss: 10.651850
KL Loss: 0.671380
Y Loss: 0.543508
T Loss: 10.380096
Epoch 949 
Overall Loss: 11.309828
Rec Loss: 10.646320
KL Loss: 0.663508
Y Loss: 0.544776
T Loss: 10.373932
Epoch 999 
Overall Loss: 11.317070
Rec Loss: 10.659092
KL Loss: 0.657977
Y Loss: 0.544592
T Loss: 10.386796
Epoch 1049 
Overall Loss: 11.307110
Rec Loss: 10.634183
KL Loss: 0.672927
Y Loss: 0.549479
T Loss: 10.359443
Epoch 1099 
Overall Loss: 11.302367
Rec Loss: 10.618445
KL Loss: 0.683923
Y Loss: 0.537080
T Loss: 10.349905
Epoch 1149 
Overall Loss: 11.283808
Rec Loss: 10.620053
KL Loss: 0.663755
Y Loss: 0.533796
T Loss: 10.353155
Epoch 1199 
Overall Loss: 11.287747
Rec Loss: 10.617343
KL Loss: 0.670404
Y Loss: 0.531889
T Loss: 10.351398
Epoch 1249 
Overall Loss: 11.281993
Rec Loss: 10.611730
KL Loss: 0.670263
Y Loss: 0.527737
T Loss: 10.347861
Epoch 1299 
Overall Loss: 11.295765
Rec Loss: 10.623008
KL Loss: 0.672757
Y Loss: 0.536332
T Loss: 10.354841
Epoch 1349 
Overall Loss: 11.274392
Rec Loss: 10.608668
KL Loss: 0.665725
Y Loss: 0.521684
T Loss: 10.347826
Epoch 1399 
Overall Loss: 11.270351
Rec Loss: 10.608056
KL Loss: 0.662295
Y Loss: 0.523105
T Loss: 10.346504
Epoch 1449 
Overall Loss: 11.257009
Rec Loss: 10.597506
KL Loss: 0.659503
Y Loss: 0.517697
T Loss: 10.338657
Epoch 1499 
Overall Loss: 11.254388
Rec Loss: 10.576818
KL Loss: 0.677571
Y Loss: 0.513013
T Loss: 10.320311
Epoch 1549 
Overall Loss: 11.242671
Rec Loss: 10.587089
KL Loss: 0.655582
Y Loss: 0.513101
T Loss: 10.330538
Epoch 1599 
Overall Loss: 11.240494
Rec Loss: 10.579411
KL Loss: 0.661084
Y Loss: 0.505676
T Loss: 10.326573
Epoch 1649 
Overall Loss: 11.251095
Rec Loss: 10.582560
KL Loss: 0.668536
Y Loss: 0.501325
T Loss: 10.331898
Epoch 1699 
Overall Loss: 11.267276
Rec Loss: 10.601898
KL Loss: 0.665378
Y Loss: 0.523916
T Loss: 10.339940
Epoch 1749 
Overall Loss: 11.244585
Rec Loss: 10.575534
KL Loss: 0.669051
Y Loss: 0.512116
T Loss: 10.319475
Epoch 1799 
Overall Loss: 11.242130
Rec Loss: 10.564112
KL Loss: 0.678017
Y Loss: 0.496164
T Loss: 10.316031
Epoch 1849 
Overall Loss: 11.218426
Rec Loss: 10.547719
KL Loss: 0.670707
Y Loss: 0.485260
T Loss: 10.305089
Epoch 1899 
Overall Loss: 11.229086
Rec Loss: 10.563418
KL Loss: 0.665669
Y Loss: 0.496012
T Loss: 10.315412
Epoch 1949 
Overall Loss: 11.240730
Rec Loss: 10.564876
KL Loss: 0.675855
Y Loss: 0.492909
T Loss: 10.318421
Epoch 1999 
Overall Loss: 11.227088
Rec Loss: 10.562385
KL Loss: 0.664704
Y Loss: 0.502759
T Loss: 10.311006
Epoch 2049 
Overall Loss: 11.221560
Rec Loss: 10.553285
KL Loss: 0.668275
Y Loss: 0.488933
T Loss: 10.308818
Epoch 2099 
Overall Loss: 11.212692
Rec Loss: 10.548981
KL Loss: 0.663711
Y Loss: 0.483341
T Loss: 10.307310
Epoch 2149 
Overall Loss: 11.222610
Rec Loss: 10.549989
KL Loss: 0.672620
Y Loss: 0.483691
T Loss: 10.308144
Epoch 2199 
Overall Loss: 11.204938
Rec Loss: 10.538834
KL Loss: 0.666104
Y Loss: 0.487120
T Loss: 10.295274
Epoch 2249 
Overall Loss: 11.203645
Rec Loss: 10.543549
KL Loss: 0.660095
Y Loss: 0.487491
T Loss: 10.299804
Epoch 2299 
Overall Loss: 11.205279
Rec Loss: 10.552525
KL Loss: 0.652754
Y Loss: 0.487572
T Loss: 10.308740
Epoch 2349 
Overall Loss: 11.208412
Rec Loss: 10.533494
KL Loss: 0.674918
Y Loss: 0.481739
T Loss: 10.292624
Epoch 2399 
Overall Loss: 11.189932
Rec Loss: 10.528152
KL Loss: 0.661780
Y Loss: 0.471597
T Loss: 10.292353
Epoch 2449 
Overall Loss: 11.188803
Rec Loss: 10.526171
KL Loss: 0.662632
Y Loss: 0.480269
T Loss: 10.286037
Epoch 2499 
Overall Loss: 11.184667
Rec Loss: 10.522171
KL Loss: 0.662497
Y Loss: 0.467808
T Loss: 10.288266
Epoch 2549 
Overall Loss: 11.186622
Rec Loss: 10.518680
KL Loss: 0.667942
Y Loss: 0.469538
T Loss: 10.283911
Epoch 2599 
Overall Loss: 11.177925
Rec Loss: 10.527347
KL Loss: 0.650577
Y Loss: 0.473176
T Loss: 10.290759
Epoch 2649 
Overall Loss: 11.179064
Rec Loss: 10.517718
KL Loss: 0.661346
Y Loss: 0.469541
T Loss: 10.282948
Epoch 2699 
Overall Loss: 11.180810
Rec Loss: 10.512983
KL Loss: 0.667827
Y Loss: 0.460677
T Loss: 10.282644
Epoch 2749 
Overall Loss: 11.179110
Rec Loss: 10.498532
KL Loss: 0.680578
Y Loss: 0.458673
T Loss: 10.269195
Epoch 2799 
Overall Loss: 11.171525
Rec Loss: 10.519133
KL Loss: 0.652393
Y Loss: 0.472093
T Loss: 10.283086
Epoch 2849 
Overall Loss: 11.172511
Rec Loss: 10.516041
KL Loss: 0.656470
Y Loss: 0.462973
T Loss: 10.284555
Epoch 2899 
Overall Loss: 11.164255
Rec Loss: 10.512484
KL Loss: 0.651772
Y Loss: 0.463232
T Loss: 10.280867
Epoch 2949 
Overall Loss: 11.149502
Rec Loss: 10.490122
KL Loss: 0.659379
Y Loss: 0.459511
T Loss: 10.260367
Epoch 2999 
Overall Loss: 11.149679
Rec Loss: 10.491536
KL Loss: 0.658142
Y Loss: 0.458922
T Loss: 10.262075
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.435105
Epoch 99
Rec Loss: 0.433473
Epoch 149
Rec Loss: 0.432196
Epoch 199
Rec Loss: 0.431865
Epoch 249
Rec Loss: 0.436396
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.935013
Epoch 99
Rec Loss: 9.923501
Epoch 149
Rec Loss: 9.892875
Epoch 199
Rec Loss: 9.887162
Epoch 249
Rec Loss: 9.866486
Epoch 299
Rec Loss: 9.867521
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.634640
Insample Error: 1.445081
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.369932
Rec Loss: 19.238417
KL Loss: 3.131515
Y Loss: 8.081786
T Loss: 12.893434
X Loss: 2.304090
Epoch 99 
Overall Loss: 17.270701
Rec Loss: 13.791805
KL Loss: 3.478896
Y Loss: 2.976529
T Loss: 12.893848
X Loss: -0.590307
Epoch 149 
Overall Loss: 16.097949
Rec Loss: 12.650373
KL Loss: 3.447576
Y Loss: 2.287851
T Loss: 12.786463
X Loss: -1.280015
Epoch 199 
Overall Loss: 15.346747
Rec Loss: 11.556711
KL Loss: 3.790036
Y Loss: 1.749478
T Loss: 12.422939
X Loss: -1.740967
Epoch 249 
Overall Loss: 14.753539
Rec Loss: 10.528734
KL Loss: 4.224805
Y Loss: 1.474268
T Loss: 12.003250
X Loss: -2.211650
Epoch 299 
Overall Loss: 14.295704
Rec Loss: 9.715628
KL Loss: 4.580076
Y Loss: 1.344393
T Loss: 11.631220
X Loss: -2.587789
Epoch 349 
Overall Loss: 13.799681
Rec Loss: 8.589348
KL Loss: 5.210334
Y Loss: 1.240189
T Loss: 10.962048
X Loss: -2.992795
Epoch 399 
Overall Loss: 13.602213
Rec Loss: 8.160184
KL Loss: 5.442029
Y Loss: 1.153464
T Loss: 10.791763
X Loss: -3.208311
Epoch 449 
Overall Loss: 13.459044
Rec Loss: 7.908257
KL Loss: 5.550787
Y Loss: 1.115665
T Loss: 10.716603
X Loss: -3.366178
Epoch 499 
Overall Loss: 13.371447
Rec Loss: 7.714194
KL Loss: 5.657252
Y Loss: 1.066325
T Loss: 10.664489
X Loss: -3.483457
Epoch 549 
Overall Loss: 13.310126
Rec Loss: 7.595335
KL Loss: 5.714791
Y Loss: 1.029108
T Loss: 10.654832
X Loss: -3.574051
Epoch 599 
Overall Loss: 13.239940
Rec Loss: 7.468919
KL Loss: 5.771022
Y Loss: 0.987660
T Loss: 10.622825
X Loss: -3.647736
Epoch 649 
Overall Loss: 13.220984
Rec Loss: 7.395411
KL Loss: 5.825573
Y Loss: 0.955340
T Loss: 10.612848
X Loss: -3.695107
Epoch 699 
Overall Loss: 13.156327
Rec Loss: 7.301097
KL Loss: 5.855230
Y Loss: 0.933138
T Loss: 10.600767
X Loss: -3.766239
Epoch 749 
Overall Loss: 13.149418
Rec Loss: 7.257513
KL Loss: 5.891906
Y Loss: 0.919529
T Loss: 10.606555
X Loss: -3.808807
Epoch 799 
Overall Loss: 13.080017
Rec Loss: 7.200872
KL Loss: 5.879145
Y Loss: 0.903692
T Loss: 10.590569
X Loss: -3.841543
Epoch 849 
Overall Loss: 13.084629
Rec Loss: 7.132889
KL Loss: 5.951740
Y Loss: 0.872436
T Loss: 10.606041
X Loss: -3.909369
Epoch 899 
Overall Loss: 13.037987
Rec Loss: 7.055445
KL Loss: 5.982542
Y Loss: 0.853216
T Loss: 10.577864
X Loss: -3.949027
Epoch 949 
Overall Loss: 13.005874
Rec Loss: 7.028883
KL Loss: 5.976991
Y Loss: 0.841000
T Loss: 10.594960
X Loss: -3.986577
Epoch 999 
Overall Loss: 13.007371
Rec Loss: 6.990666
KL Loss: 6.016706
Y Loss: 0.864319
T Loss: 10.590788
X Loss: -4.032281
Epoch 1049 
Overall Loss: 13.008161
Rec Loss: 6.973481
KL Loss: 6.034679
Y Loss: 0.854867
T Loss: 10.603043
X Loss: -4.056996
Epoch 1099 
Overall Loss: 12.966689
Rec Loss: 6.914341
KL Loss: 6.052348
Y Loss: 0.816451
T Loss: 10.588113
X Loss: -4.081997
Epoch 1149 
Overall Loss: 12.971690
Rec Loss: 6.886637
KL Loss: 6.085053
Y Loss: 0.840982
T Loss: 10.601697
X Loss: -4.135552
Epoch 1199 
Overall Loss: 12.954622
Rec Loss: 6.830470
KL Loss: 6.124151
Y Loss: 0.823155
T Loss: 10.598531
X Loss: -4.179639
Epoch 1249 
Overall Loss: 12.934797
Rec Loss: 6.805882
KL Loss: 6.128915
Y Loss: 0.846543
T Loss: 10.600846
X Loss: -4.218236
Epoch 1299 
Overall Loss: 12.955496
Rec Loss: 6.786234
KL Loss: 6.169262
Y Loss: 0.822729
T Loss: 10.608071
X Loss: -4.233202
Epoch 1349 
Overall Loss: 12.928722
Rec Loss: 6.785806
KL Loss: 6.142916
Y Loss: 0.821273
T Loss: 10.616576
X Loss: -4.241406
Epoch 1399 
Overall Loss: 12.915604
Rec Loss: 6.736556
KL Loss: 6.179048
Y Loss: 0.840074
T Loss: 10.631301
X Loss: -4.314782
Epoch 1449 
Overall Loss: 12.923574
Rec Loss: 6.710996
KL Loss: 6.212578
Y Loss: 0.829449
T Loss: 10.633150
X Loss: -4.336879
Epoch 1499 
Overall Loss: 12.925724
Rec Loss: 6.663515
KL Loss: 6.262209
Y Loss: 0.821161
T Loss: 10.635327
X Loss: -4.382393
Epoch 1549 
Overall Loss: 12.911190
Rec Loss: 6.680783
KL Loss: 6.230407
Y Loss: 0.821286
T Loss: 10.652650
X Loss: -4.382510
Epoch 1599 
Overall Loss: 12.889666
Rec Loss: 6.586848
KL Loss: 6.302818
Y Loss: 0.802404
T Loss: 10.658960
X Loss: -4.473314
Epoch 1649 
Overall Loss: 12.901341
Rec Loss: 6.599493
KL Loss: 6.301849
Y Loss: 0.831755
T Loss: 10.667686
X Loss: -4.484070
Epoch 1699 
Overall Loss: 12.896737
Rec Loss: 6.554546
KL Loss: 6.342191
Y Loss: 0.808130
T Loss: 10.687559
X Loss: -4.537078
Epoch 1749 
Overall Loss: 12.895495
Rec Loss: 6.522805
KL Loss: 6.372690
Y Loss: 0.824887
T Loss: 10.676749
X Loss: -4.566387
Epoch 1799 
Overall Loss: 12.866831
Rec Loss: 6.471401
KL Loss: 6.395430
Y Loss: 0.803016
T Loss: 10.691718
X Loss: -4.621826
Epoch 1849 
Overall Loss: 12.879957
Rec Loss: 6.480205
KL Loss: 6.399752
Y Loss: 0.828736
T Loss: 10.683819
X Loss: -4.617982
Epoch 1899 
Overall Loss: 12.842791
Rec Loss: 6.407118
KL Loss: 6.435673
Y Loss: 0.834133
T Loss: 10.683945
X Loss: -4.693894
Epoch 1949 
Overall Loss: 12.823963
Rec Loss: 6.367833
KL Loss: 6.456130
Y Loss: 0.831697
T Loss: 10.689419
X Loss: -4.737435
Epoch 1999 
Overall Loss: 12.818514
Rec Loss: 6.317627
KL Loss: 6.500886
Y Loss: 0.797769
T Loss: 10.690222
X Loss: -4.771479
Epoch 2049 
Overall Loss: 12.835901
Rec Loss: 6.318745
KL Loss: 6.517155
Y Loss: 0.807342
T Loss: 10.706241
X Loss: -4.791167
Epoch 2099 
Overall Loss: 12.842565
Rec Loss: 6.316042
KL Loss: 6.526523
Y Loss: 0.825289
T Loss: 10.698530
X Loss: -4.795132
Epoch 2149 
Overall Loss: 12.843692
Rec Loss: 6.272294
KL Loss: 6.571397
Y Loss: 0.801780
T Loss: 10.698023
X Loss: -4.826619
Epoch 2199 
Overall Loss: 12.790754
Rec Loss: 6.223968
KL Loss: 6.566786
Y Loss: 0.819368
T Loss: 10.706905
X Loss: -4.892620
Epoch 2249 
Overall Loss: 12.812348
Rec Loss: 6.216871
KL Loss: 6.595477
Y Loss: 0.807579
T Loss: 10.728907
X Loss: -4.915825
Epoch 2299 
Overall Loss: 12.804705
Rec Loss: 6.183214
KL Loss: 6.621491
Y Loss: 0.816877
T Loss: 10.715353
X Loss: -4.940578
Epoch 2349 
Overall Loss: 12.825342
Rec Loss: 6.196352
KL Loss: 6.628989
Y Loss: 0.814962
T Loss: 10.729112
X Loss: -4.940241
Epoch 2399 
Overall Loss: 12.843291
Rec Loss: 6.171959
KL Loss: 6.671332
Y Loss: 0.825844
T Loss: 10.740587
X Loss: -4.981550
Epoch 2449 
Overall Loss: 12.801324
Rec Loss: 6.126817
KL Loss: 6.674507
Y Loss: 0.831739
T Loss: 10.722507
X Loss: -5.011559
Epoch 2499 
Overall Loss: 12.797358
Rec Loss: 6.092970
KL Loss: 6.704388
Y Loss: 0.818005
T Loss: 10.728284
X Loss: -5.044316
Epoch 2549 
Overall Loss: 12.807225
Rec Loss: 6.070765
KL Loss: 6.736459
Y Loss: 0.825487
T Loss: 10.722752
X Loss: -5.064730
Epoch 2599 
Overall Loss: 12.784661
Rec Loss: 6.053751
KL Loss: 6.730909
Y Loss: 0.809547
T Loss: 10.739411
X Loss: -5.090433
Epoch 2649 
Overall Loss: 12.818341
Rec Loss: 6.084916
KL Loss: 6.733426
Y Loss: 0.820789
T Loss: 10.735973
X Loss: -5.061453
Epoch 2699 
Overall Loss: 12.816237
Rec Loss: 6.054239
KL Loss: 6.761999
Y Loss: 0.839173
T Loss: 10.752771
X Loss: -5.118119
Epoch 2749 
Overall Loss: 12.811085
Rec Loss: 6.005322
KL Loss: 6.805764
Y Loss: 0.819014
T Loss: 10.749414
X Loss: -5.153600
Epoch 2799 
Overall Loss: 12.794907
Rec Loss: 5.988783
KL Loss: 6.806124
Y Loss: 0.811215
T Loss: 10.748588
X Loss: -5.165412
Epoch 2849 
Overall Loss: 12.770106
Rec Loss: 5.943019
KL Loss: 6.827086
Y Loss: 0.813237
T Loss: 10.739496
X Loss: -5.203096
Epoch 2899 
Overall Loss: 12.788350
Rec Loss: 5.965615
KL Loss: 6.822735
Y Loss: 0.811279
T Loss: 10.764647
X Loss: -5.204672
Epoch 2949 
Overall Loss: 12.774281
Rec Loss: 5.930286
KL Loss: 6.843995
Y Loss: 0.810902
T Loss: 10.767360
X Loss: -5.242525
Epoch 2999 
Overall Loss: 12.767999
Rec Loss: 5.888291
KL Loss: 6.879708
Y Loss: 0.823342
T Loss: 10.757825
X Loss: -5.281205
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.426140
Epoch 99
Rec Loss: 1.439690
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.003948
Epoch 99
Rec Loss: 2.002862
Epoch 149
Rec Loss: 1.996612
Epoch 199
Rec Loss: 2.000864
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.667758
Insample Error 2.218112
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.733449
Epoch 99 
Prediction Loss: 0.631161
Epoch 149 
Prediction Loss: 0.593445
Epoch 199 
Prediction Loss: 0.573485
Epoch 249 
Prediction Loss: 0.549355
Epoch 299 
Prediction Loss: 0.535858
Epoch 349 
Prediction Loss: 0.521069
Epoch 399 
Prediction Loss: 0.491213
Epoch 449 
Prediction Loss: 0.476553
Epoch 499 
Prediction Loss: 0.450478
Epoch 549 
Prediction Loss: 0.443221
Epoch 599 
Prediction Loss: 0.448443
Epoch 649 
Prediction Loss: 0.401872
Epoch 699 
Prediction Loss: 0.399392
Epoch 749 
Prediction Loss: 0.376803
Epoch 799 
Prediction Loss: 0.367873
Epoch 849 
Prediction Loss: 0.364200
Epoch 899 
Prediction Loss: 0.354220
Epoch 949 
Prediction Loss: 0.330222
Epoch 999 
Prediction Loss: 0.324320
Epoch 1049 
Prediction Loss: 0.315936
Epoch 1099 
Prediction Loss: 0.308843
Epoch 1149 
Prediction Loss: 0.301845
Epoch 1199 
Prediction Loss: 0.296379
Epoch 1249 
Prediction Loss: 0.276082
Epoch 1299 
Prediction Loss: 0.289252
Epoch 1349 
Prediction Loss: 0.270907
Epoch 1399 
Prediction Loss: 0.260041
Epoch 1449 
Prediction Loss: 0.251494
Epoch 1499 
Prediction Loss: 0.257509
Epoch 1549 
Prediction Loss: 0.256876
Epoch 1599 
Prediction Loss: 0.241294
Epoch 1649 
Prediction Loss: 0.236155
Epoch 1699 
Prediction Loss: 0.235437
Epoch 1749 
Prediction Loss: 0.238564
Epoch 1799 
Prediction Loss: 0.225941
Epoch 1849 
Prediction Loss: 0.228059
Epoch 1899 
Prediction Loss: 0.223998
Epoch 1949 
Prediction Loss: 0.213644
Epoch 1999 
Prediction Loss: 0.221195
Epoch 2049 
Prediction Loss: 0.202956
Epoch 2099 
Prediction Loss: 0.211033
Epoch 2149 
Prediction Loss: 0.202755
Epoch 2199 
Prediction Loss: 0.201811
Epoch 2249 
Prediction Loss: 0.197875
Epoch 2299 
Prediction Loss: 0.208775
Epoch 2349 
Prediction Loss: 0.210726
Epoch 2399 
Prediction Loss: 0.201699
Epoch 2449 
Prediction Loss: 0.192780
Epoch 2499 
Prediction Loss: 0.195713
Epoch 2549 
Prediction Loss: 0.186549
Epoch 2599 
Prediction Loss: 0.188824
Epoch 2649 
Prediction Loss: 0.189206
Epoch 2699 
Prediction Loss: 0.182893
Epoch 2749 
Prediction Loss: 0.188173
Epoch 2799 
Prediction Loss: 0.183011
Epoch 2849 
Prediction Loss: 0.177420
Epoch 2899 
Prediction Loss: 0.177061
Epoch 2949 
Prediction Loss: 0.179481
Epoch 2999 
Prediction Loss: 0.175973
Epoch 3049 
Prediction Loss: 0.175471
Epoch 3099 
Prediction Loss: 0.173087
Epoch 3149 
Prediction Loss: 0.171447
Epoch 3199 
Prediction Loss: 0.174921
Epoch 3249 
Prediction Loss: 0.172738
Epoch 3299 
Prediction Loss: 0.170617
Epoch 3349 
Prediction Loss: 0.165857
Epoch 3399 
Prediction Loss: 0.170169
Epoch 3449 
Prediction Loss: 0.175475
Epoch 3499 
Prediction Loss: 0.162889
Epoch 3549 
Prediction Loss: 0.168790
Epoch 3599 
Prediction Loss: 0.162511
Epoch 3649 
Prediction Loss: 0.163302
Epoch 3699 
Prediction Loss: 0.164680
Epoch 3749 
Prediction Loss: 0.164868
Epoch 3799 
Prediction Loss: 0.161347
Epoch 3849 
Prediction Loss: 0.162012
Epoch 3899 
Prediction Loss: 0.158133
Epoch 3949 
Prediction Loss: 0.161717
Epoch 3999 
Prediction Loss: 0.179977
Epoch 4049 
Prediction Loss: 0.156210
Epoch 4099 
Prediction Loss: 0.160611
Epoch 4149 
Prediction Loss: 0.152135
Epoch 4199 
Prediction Loss: 0.161408
Epoch 4249 
Prediction Loss: 0.156393
Epoch 4299 
Prediction Loss: 0.159400
Epoch 4349 
Prediction Loss: 0.164823
Epoch 4399 
Prediction Loss: 0.160521
Epoch 4449 
Prediction Loss: 0.150184
Epoch 4499 
Prediction Loss: 0.154836
Epoch 4549 
Prediction Loss: 0.155333
Epoch 4599 
Prediction Loss: 0.159759
Epoch 4649 
Prediction Loss: 0.150154
Epoch 4699 
Prediction Loss: 0.151368
Epoch 4749 
Prediction Loss: 0.151666
Epoch 4799 
Prediction Loss: 0.154303
Epoch 4849 
Prediction Loss: 0.160635
Epoch 4899 
Prediction Loss: 0.153384
Epoch 4949 
Prediction Loss: 0.146797
Epoch 4999 
Prediction Loss: 0.147007
Epoch 5049 
Prediction Loss: 0.147783
Epoch 5099 
Prediction Loss: 0.151463
Epoch 5149 
Prediction Loss: 0.146392
Epoch 5199 
Prediction Loss: 0.143276
Epoch 5249 
Prediction Loss: 0.144283
Epoch 5299 
Prediction Loss: 0.149966
Epoch 5349 
Prediction Loss: 0.149516
Epoch 5399 
Prediction Loss: 0.145800
Epoch 5449 
Prediction Loss: 0.145233
Epoch 5499 
Prediction Loss: 0.146539
Epoch 5549 
Prediction Loss: 0.141775
Epoch 5599 
Prediction Loss: 0.150264
Epoch 5649 
Prediction Loss: 0.153760
Epoch 5699 
Prediction Loss: 0.143320
Epoch 5749 
Prediction Loss: 0.147354
Epoch 5799 
Prediction Loss: 0.138687
Epoch 5849 
Prediction Loss: 0.142991
Epoch 5899 
Prediction Loss: 0.144364
Epoch 5949 
Prediction Loss: 0.140120
Epoch 5999 
Prediction Loss: 0.148212
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.380026
Insample Error 1.807267
[31m========== repeat time 6 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.877235
Rec Loss: 10.782189
KL Loss: 1.095046
Y Loss: 0.978125
T Loss: 10.293127
Epoch 99 
Overall Loss: 11.619963
Rec Loss: 10.720846
KL Loss: 0.899117
Y Loss: 0.729750
T Loss: 10.355971
Epoch 149 
Overall Loss: 11.545569
Rec Loss: 10.716745
KL Loss: 0.828824
Y Loss: 0.668007
T Loss: 10.382742
Epoch 199 
Overall Loss: 11.477462
Rec Loss: 10.712498
KL Loss: 0.764964
Y Loss: 0.618110
T Loss: 10.403443
Epoch 249 
Overall Loss: 11.447223
Rec Loss: 10.701907
KL Loss: 0.745317
Y Loss: 0.600749
T Loss: 10.401533
Epoch 299 
Overall Loss: 11.440562
Rec Loss: 10.692493
KL Loss: 0.748069
Y Loss: 0.586327
T Loss: 10.399329
Epoch 349 
Overall Loss: 11.422604
Rec Loss: 10.689099
KL Loss: 0.733505
Y Loss: 0.569199
T Loss: 10.404499
Epoch 399 
Overall Loss: 11.407581
Rec Loss: 10.686977
KL Loss: 0.720604
Y Loss: 0.559614
T Loss: 10.407170
Epoch 449 
Overall Loss: 11.380902
Rec Loss: 10.670222
KL Loss: 0.710680
Y Loss: 0.552303
T Loss: 10.394070
Epoch 499 
Overall Loss: 11.375445
Rec Loss: 10.671752
KL Loss: 0.703693
Y Loss: 0.546177
T Loss: 10.398663
Epoch 549 
Overall Loss: 11.377831
Rec Loss: 10.671379
KL Loss: 0.706452
Y Loss: 0.552239
T Loss: 10.395259
Epoch 599 
Overall Loss: 11.363628
Rec Loss: 10.656750
KL Loss: 0.706878
Y Loss: 0.545550
T Loss: 10.383975
Epoch 649 
Overall Loss: 11.379327
Rec Loss: 10.681707
KL Loss: 0.697621
Y Loss: 0.539929
T Loss: 10.411742
Epoch 699 
Overall Loss: 11.336426
Rec Loss: 10.650531
KL Loss: 0.685895
Y Loss: 0.530517
T Loss: 10.385272
Epoch 749 
Overall Loss: 11.348954
Rec Loss: 10.662244
KL Loss: 0.686710
Y Loss: 0.536246
T Loss: 10.394121
Epoch 799 
Overall Loss: 11.357423
Rec Loss: 10.657557
KL Loss: 0.699866
Y Loss: 0.519034
T Loss: 10.398040
Epoch 849 
Overall Loss: 11.332292
Rec Loss: 10.641438
KL Loss: 0.690854
Y Loss: 0.526769
T Loss: 10.378053
Epoch 899 
Overall Loss: 11.327491
Rec Loss: 10.650012
KL Loss: 0.677479
Y Loss: 0.520187
T Loss: 10.389918
Epoch 949 
Overall Loss: 11.314310
Rec Loss: 10.648541
KL Loss: 0.665769
Y Loss: 0.520075
T Loss: 10.388504
Epoch 999 
Overall Loss: 11.318149
Rec Loss: 10.627742
KL Loss: 0.690407
Y Loss: 0.497516
T Loss: 10.378984
Epoch 1049 
Overall Loss: 11.321705
Rec Loss: 10.636741
KL Loss: 0.684963
Y Loss: 0.512481
T Loss: 10.380501
Epoch 1099 
Overall Loss: 11.297512
Rec Loss: 10.632406
KL Loss: 0.665106
Y Loss: 0.503718
T Loss: 10.380547
Epoch 1149 
Overall Loss: 11.300825
Rec Loss: 10.621145
KL Loss: 0.679680
Y Loss: 0.500850
T Loss: 10.370719
Epoch 1199 
Overall Loss: 11.312477
Rec Loss: 10.633646
KL Loss: 0.678831
Y Loss: 0.506904
T Loss: 10.380194
Epoch 1249 
Overall Loss: 11.291804
Rec Loss: 10.616342
KL Loss: 0.675462
Y Loss: 0.495497
T Loss: 10.368593
Epoch 1299 
Overall Loss: 11.281880
Rec Loss: 10.593224
KL Loss: 0.688656
Y Loss: 0.501117
T Loss: 10.342665
Epoch 1349 
Overall Loss: 11.286101
Rec Loss: 10.617457
KL Loss: 0.668644
Y Loss: 0.494338
T Loss: 10.370288
Epoch 1399 
Overall Loss: 11.279760
Rec Loss: 10.596070
KL Loss: 0.683690
Y Loss: 0.494278
T Loss: 10.348931
Epoch 1449 
Overall Loss: 11.265519
Rec Loss: 10.594903
KL Loss: 0.670616
Y Loss: 0.478907
T Loss: 10.355450
Epoch 1499 
Overall Loss: 11.270588
Rec Loss: 10.587152
KL Loss: 0.683436
Y Loss: 0.486413
T Loss: 10.343945
Epoch 1549 
Overall Loss: 11.273614
Rec Loss: 10.585330
KL Loss: 0.688284
Y Loss: 0.477947
T Loss: 10.346356
Epoch 1599 
Overall Loss: 11.255308
Rec Loss: 10.581732
KL Loss: 0.673576
Y Loss: 0.484564
T Loss: 10.339450
Epoch 1649 
Overall Loss: 11.248999
Rec Loss: 10.568648
KL Loss: 0.680351
Y Loss: 0.463765
T Loss: 10.336766
Epoch 1699 
Overall Loss: 11.255427
Rec Loss: 10.563652
KL Loss: 0.691775
Y Loss: 0.473336
T Loss: 10.326984
Epoch 1749 
Overall Loss: 11.250918
Rec Loss: 10.581012
KL Loss: 0.669906
Y Loss: 0.473302
T Loss: 10.344361
Epoch 1799 
Overall Loss: 11.236427
Rec Loss: 10.558827
KL Loss: 0.677600
Y Loss: 0.471220
T Loss: 10.323217
Epoch 1849 
Overall Loss: 11.236342
Rec Loss: 10.574614
KL Loss: 0.661728
Y Loss: 0.473067
T Loss: 10.338080
Epoch 1899 
Overall Loss: 11.215238
Rec Loss: 10.549316
KL Loss: 0.665922
Y Loss: 0.471129
T Loss: 10.313751
Epoch 1949 
Overall Loss: 11.225150
Rec Loss: 10.553738
KL Loss: 0.671412
Y Loss: 0.467103
T Loss: 10.320187
Epoch 1999 
Overall Loss: 11.231356
Rec Loss: 10.553659
KL Loss: 0.677697
Y Loss: 0.454891
T Loss: 10.326213
Epoch 2049 
Overall Loss: 11.228057
Rec Loss: 10.561666
KL Loss: 0.666390
Y Loss: 0.461175
T Loss: 10.331079
Epoch 2099 
Overall Loss: 11.231848
Rec Loss: 10.549571
KL Loss: 0.682277
Y Loss: 0.464977
T Loss: 10.317083
Epoch 2149 
Overall Loss: 11.220551
Rec Loss: 10.548221
KL Loss: 0.672330
Y Loss: 0.465036
T Loss: 10.315703
Epoch 2199 
Overall Loss: 11.222554
Rec Loss: 10.551405
KL Loss: 0.671150
Y Loss: 0.458147
T Loss: 10.322332
Epoch 2249 
Overall Loss: 11.211148
Rec Loss: 10.543963
KL Loss: 0.667185
Y Loss: 0.466682
T Loss: 10.310623
Epoch 2299 
Overall Loss: 11.205359
Rec Loss: 10.549130
KL Loss: 0.656229
Y Loss: 0.453892
T Loss: 10.322183
Epoch 2349 
Overall Loss: 11.213678
Rec Loss: 10.532953
KL Loss: 0.680725
Y Loss: 0.442312
T Loss: 10.311797
Epoch 2399 
Overall Loss: 11.199200
Rec Loss: 10.524170
KL Loss: 0.675030
Y Loss: 0.449449
T Loss: 10.299445
Epoch 2449 
Overall Loss: 11.187045
Rec Loss: 10.516248
KL Loss: 0.670796
Y Loss: 0.457922
T Loss: 10.287287
Epoch 2499 
Overall Loss: 11.189143
Rec Loss: 10.522536
KL Loss: 0.666608
Y Loss: 0.440274
T Loss: 10.302399
Epoch 2549 
Overall Loss: 11.195325
Rec Loss: 10.524667
KL Loss: 0.670658
Y Loss: 0.462490
T Loss: 10.293422
Epoch 2599 
Overall Loss: 11.209633
Rec Loss: 10.519310
KL Loss: 0.690323
Y Loss: 0.449747
T Loss: 10.294437
Epoch 2649 
Overall Loss: 11.170223
Rec Loss: 10.503089
KL Loss: 0.667134
Y Loss: 0.436466
T Loss: 10.284856
Epoch 2699 
Overall Loss: 11.190366
Rec Loss: 10.508239
KL Loss: 0.682126
Y Loss: 0.454259
T Loss: 10.281110
Epoch 2749 
Overall Loss: 11.168799
Rec Loss: 10.505822
KL Loss: 0.662977
Y Loss: 0.448292
T Loss: 10.281676
Epoch 2799 
Overall Loss: 11.173984
Rec Loss: 10.502077
KL Loss: 0.671908
Y Loss: 0.439301
T Loss: 10.282426
Epoch 2849 
Overall Loss: 11.165829
Rec Loss: 10.490870
KL Loss: 0.674959
Y Loss: 0.435129
T Loss: 10.273306
Epoch 2899 
Overall Loss: 11.174111
Rec Loss: 10.523947
KL Loss: 0.650164
Y Loss: 0.442607
T Loss: 10.302644
Epoch 2949 
Overall Loss: 11.172454
Rec Loss: 10.503342
KL Loss: 0.669113
Y Loss: 0.457908
T Loss: 10.274388
Epoch 2999 
Overall Loss: 11.154283
Rec Loss: 10.505873
KL Loss: 0.648410
Y Loss: 0.440038
T Loss: 10.285854
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.424237
Epoch 99
Rec Loss: 0.414934
Epoch 149
Rec Loss: 0.410723
Epoch 199
Rec Loss: 0.413464
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.914458
Epoch 99
Rec Loss: 9.904465
Epoch 149
Rec Loss: 9.877524
Epoch 199
Rec Loss: 9.872821
Epoch 249
Rec Loss: 9.852201
Epoch 299
Rec Loss: 9.871919
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.609914
Insample Error: 1.403452
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 23.421233
Rec Loss: 20.430289
KL Loss: 2.990944
Y Loss: 10.269412
T Loss: 12.946557
X Loss: 2.349026
Epoch 99 
Overall Loss: 18.001279
Rec Loss: 14.334006
KL Loss: 3.667273
Y Loss: 3.337037
T Loss: 12.826330
X Loss: -0.160841
Epoch 149 
Overall Loss: 16.565828
Rec Loss: 12.827035
KL Loss: 3.738793
Y Loss: 2.366591
T Loss: 12.699563
X Loss: -1.055824
Epoch 199 
Overall Loss: 15.492440
Rec Loss: 11.566443
KL Loss: 3.925997
Y Loss: 1.977667
T Loss: 12.339373
X Loss: -1.761764
Epoch 249 
Overall Loss: 14.671216
Rec Loss: 10.164655
KL Loss: 4.506560
Y Loss: 1.574857
T Loss: 11.646345
X Loss: -2.269119
Epoch 299 
Overall Loss: 14.112684
Rec Loss: 9.018314
KL Loss: 5.094370
Y Loss: 1.320044
T Loss: 11.046660
X Loss: -2.688368
Epoch 349 
Overall Loss: 13.919689
Rec Loss: 8.613696
KL Loss: 5.305993
Y Loss: 1.311280
T Loss: 10.880614
X Loss: -2.922558
Epoch 399 
Overall Loss: 13.691852
Rec Loss: 8.254430
KL Loss: 5.437422
Y Loss: 1.219924
T Loss: 10.774281
X Loss: -3.129813
Epoch 449 
Overall Loss: 13.515552
Rec Loss: 7.946203
KL Loss: 5.569349
Y Loss: 1.135849
T Loss: 10.705392
X Loss: -3.327114
Epoch 499 
Overall Loss: 13.442768
Rec Loss: 7.797585
KL Loss: 5.645183
Y Loss: 1.105206
T Loss: 10.657523
X Loss: -3.412541
Epoch 549 
Overall Loss: 13.361135
Rec Loss: 7.616157
KL Loss: 5.744978
Y Loss: 1.052109
T Loss: 10.634981
X Loss: -3.544879
Epoch 599 
Overall Loss: 13.295521
Rec Loss: 7.517572
KL Loss: 5.777949
Y Loss: 0.977642
T Loss: 10.637535
X Loss: -3.608784
Epoch 649 
Overall Loss: 13.240834
Rec Loss: 7.415767
KL Loss: 5.825067
Y Loss: 0.971365
T Loss: 10.621459
X Loss: -3.691375
Epoch 699 
Overall Loss: 13.184436
Rec Loss: 7.316129
KL Loss: 5.868307
Y Loss: 0.949246
T Loss: 10.619553
X Loss: -3.778046
Epoch 749 
Overall Loss: 13.128391
Rec Loss: 7.222261
KL Loss: 5.906130
Y Loss: 0.934902
T Loss: 10.617700
X Loss: -3.862891
Epoch 799 
Overall Loss: 13.127127
Rec Loss: 7.192101
KL Loss: 5.935026
Y Loss: 0.931653
T Loss: 10.625875
X Loss: -3.899600
Epoch 849 
Overall Loss: 13.095526
Rec Loss: 7.104714
KL Loss: 5.990812
Y Loss: 0.895255
T Loss: 10.614102
X Loss: -3.957015
Epoch 899 
Overall Loss: 13.050551
Rec Loss: 7.031684
KL Loss: 6.018868
Y Loss: 0.874105
T Loss: 10.611580
X Loss: -4.016949
Epoch 949 
Overall Loss: 13.034135
Rec Loss: 7.006895
KL Loss: 6.027239
Y Loss: 0.858960
T Loss: 10.625410
X Loss: -4.047995
Epoch 999 
Overall Loss: 13.027752
Rec Loss: 6.952795
KL Loss: 6.074957
Y Loss: 0.861213
T Loss: 10.620125
X Loss: -4.097937
Epoch 1049 
Overall Loss: 13.011816
Rec Loss: 6.911489
KL Loss: 6.100327
Y Loss: 0.874228
T Loss: 10.638985
X Loss: -4.164610
Epoch 1099 
Overall Loss: 12.980760
Rec Loss: 6.839333
KL Loss: 6.141427
Y Loss: 0.849635
T Loss: 10.634248
X Loss: -4.219732
Epoch 1149 
Overall Loss: 12.966095
Rec Loss: 6.800971
KL Loss: 6.165124
Y Loss: 0.870374
T Loss: 10.641901
X Loss: -4.276117
Epoch 1199 
Overall Loss: 12.972765
Rec Loss: 6.779832
KL Loss: 6.192933
Y Loss: 0.876680
T Loss: 10.647781
X Loss: -4.306288
Epoch 1249 
Overall Loss: 12.932238
Rec Loss: 6.723344
KL Loss: 6.208894
Y Loss: 0.843215
T Loss: 10.659117
X Loss: -4.357381
Epoch 1299 
Overall Loss: 12.920546
Rec Loss: 6.670443
KL Loss: 6.250103
Y Loss: 0.823527
T Loss: 10.656067
X Loss: -4.397387
Epoch 1349 
Overall Loss: 12.912262
Rec Loss: 6.607774
KL Loss: 6.304487
Y Loss: 0.835916
T Loss: 10.659344
X Loss: -4.469528
Epoch 1399 
Overall Loss: 12.923627
Rec Loss: 6.646581
KL Loss: 6.277047
Y Loss: 0.838319
T Loss: 10.684580
X Loss: -4.457159
Epoch 1449 
Overall Loss: 12.884880
Rec Loss: 6.562346
KL Loss: 6.322534
Y Loss: 0.827825
T Loss: 10.678354
X Loss: -4.529920
Epoch 1499 
Overall Loss: 12.915739
Rec Loss: 6.556227
KL Loss: 6.359511
Y Loss: 0.835979
T Loss: 10.674130
X Loss: -4.535892
Epoch 1549 
Overall Loss: 12.905699
Rec Loss: 6.502889
KL Loss: 6.402809
Y Loss: 0.829950
T Loss: 10.698468
X Loss: -4.610554
Epoch 1599 
Overall Loss: 12.880321
Rec Loss: 6.469091
KL Loss: 6.411230
Y Loss: 0.832856
T Loss: 10.697469
X Loss: -4.644806
Epoch 1649 
Overall Loss: 12.881729
Rec Loss: 6.436697
KL Loss: 6.445032
Y Loss: 0.826648
T Loss: 10.707926
X Loss: -4.684553
Epoch 1699 
Overall Loss: 12.898208
Rec Loss: 6.429466
KL Loss: 6.468742
Y Loss: 0.838160
T Loss: 10.703540
X Loss: -4.693154
Epoch 1749 
Overall Loss: 12.887750
Rec Loss: 6.412171
KL Loss: 6.475579
Y Loss: 0.828301
T Loss: 10.724633
X Loss: -4.726612
Epoch 1799 
Overall Loss: 12.891036
Rec Loss: 6.381754
KL Loss: 6.509282
Y Loss: 0.828253
T Loss: 10.719418
X Loss: -4.751790
Epoch 1849 
Overall Loss: 12.861846
Rec Loss: 6.337732
KL Loss: 6.524114
Y Loss: 0.841366
T Loss: 10.716561
X Loss: -4.799512
Epoch 1899 
Overall Loss: 12.861237
Rec Loss: 6.296408
KL Loss: 6.564829
Y Loss: 0.835815
T Loss: 10.707843
X Loss: -4.829342
Epoch 1949 
Overall Loss: 12.833280
Rec Loss: 6.269062
KL Loss: 6.564218
Y Loss: 0.811341
T Loss: 10.720418
X Loss: -4.857027
Epoch 1999 
Overall Loss: 12.859852
Rec Loss: 6.268280
KL Loss: 6.591572
Y Loss: 0.831279
T Loss: 10.719185
X Loss: -4.866544
Epoch 2049 
Overall Loss: 12.832198
Rec Loss: 6.246666
KL Loss: 6.585532
Y Loss: 0.816611
T Loss: 10.733979
X Loss: -4.895618
Epoch 2099 
Overall Loss: 12.820592
Rec Loss: 6.222819
KL Loss: 6.597773
Y Loss: 0.840775
T Loss: 10.730260
X Loss: -4.927828
Epoch 2149 
Overall Loss: 12.852963
Rec Loss: 6.213363
KL Loss: 6.639600
Y Loss: 0.818522
T Loss: 10.733184
X Loss: -4.929082
Epoch 2199 
Overall Loss: 12.850090
Rec Loss: 6.193949
KL Loss: 6.656141
Y Loss: 0.836706
T Loss: 10.745714
X Loss: -4.970118
Epoch 2249 
Overall Loss: 12.809037
Rec Loss: 6.143609
KL Loss: 6.665429
Y Loss: 0.836458
T Loss: 10.734645
X Loss: -5.009266
Epoch 2299 
Overall Loss: 12.839817
Rec Loss: 6.169903
KL Loss: 6.669914
Y Loss: 0.855761
T Loss: 10.749168
X Loss: -5.007145
Epoch 2349 
Overall Loss: 12.825544
Rec Loss: 6.119657
KL Loss: 6.705887
Y Loss: 0.838139
T Loss: 10.751155
X Loss: -5.050567
Epoch 2399 
Overall Loss: 12.790651
Rec Loss: 6.072204
KL Loss: 6.718447
Y Loss: 0.829838
T Loss: 10.738387
X Loss: -5.081103
Epoch 2449 
Overall Loss: 12.782228
Rec Loss: 6.051879
KL Loss: 6.730348
Y Loss: 0.824528
T Loss: 10.733609
X Loss: -5.093994
Epoch 2499 
Overall Loss: 12.769037
Rec Loss: 6.023722
KL Loss: 6.745314
Y Loss: 0.841942
T Loss: 10.732094
X Loss: -5.129342
Epoch 2549 
Overall Loss: 12.825535
Rec Loss: 6.067091
KL Loss: 6.758444
Y Loss: 0.839640
T Loss: 10.763417
X Loss: -5.116146
Epoch 2599 
Overall Loss: 12.804109
Rec Loss: 6.012159
KL Loss: 6.791950
Y Loss: 0.821066
T Loss: 10.772623
X Loss: -5.170997
Epoch 2649 
Overall Loss: 12.780218
Rec Loss: 5.971675
KL Loss: 6.808543
Y Loss: 0.811002
T Loss: 10.750699
X Loss: -5.184525
Epoch 2699 
Overall Loss: 12.793068
Rec Loss: 5.995675
KL Loss: 6.797393
Y Loss: 0.828412
T Loss: 10.772015
X Loss: -5.190546
Epoch 2749 
Overall Loss: 12.764709
Rec Loss: 5.955364
KL Loss: 6.809345
Y Loss: 0.848785
T Loss: 10.759164
X Loss: -5.228193
Epoch 2799 
Overall Loss: 12.807261
Rec Loss: 5.944761
KL Loss: 6.862500
Y Loss: 0.829864
T Loss: 10.762217
X Loss: -5.232388
Epoch 2849 
Overall Loss: 12.793035
Rec Loss: 5.921826
KL Loss: 6.871210
Y Loss: 0.843550
T Loss: 10.778799
X Loss: -5.278748
Epoch 2899 
Overall Loss: 12.796944
Rec Loss: 5.920107
KL Loss: 6.876837
Y Loss: 0.834012
T Loss: 10.764871
X Loss: -5.261769
Epoch 2949 
Overall Loss: 12.780238
Rec Loss: 5.883382
KL Loss: 6.896856
Y Loss: 0.834474
T Loss: 10.774555
X Loss: -5.308410
Epoch 2999 
Overall Loss: 12.733803
Rec Loss: 5.834613
KL Loss: 6.899190
Y Loss: 0.813467
T Loss: 10.770694
X Loss: -5.342814
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.428078
Epoch 99
Rec Loss: 1.432740
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.009803
Epoch 99
Rec Loss: 2.004675
Epoch 149
Rec Loss: 2.000857
Epoch 199
Rec Loss: 2.001495
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.675231
Insample Error 2.263843
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.722277
Epoch 99 
Prediction Loss: 0.627545
Epoch 149 
Prediction Loss: 0.605338
Epoch 199 
Prediction Loss: 0.608296
Epoch 249 
Prediction Loss: 0.549904
Epoch 299 
Prediction Loss: 0.547764
Epoch 349 
Prediction Loss: 0.514785
Epoch 399 
Prediction Loss: 0.505276
Epoch 449 
Prediction Loss: 0.500042
Epoch 499 
Prediction Loss: 0.465184
Epoch 549 
Prediction Loss: 0.441318
Epoch 599 
Prediction Loss: 0.432015
Epoch 649 
Prediction Loss: 0.426661
Epoch 699 
Prediction Loss: 0.423585
Epoch 749 
Prediction Loss: 0.417248
Epoch 799 
Prediction Loss: 0.367504
Epoch 849 
Prediction Loss: 0.380545
Epoch 899 
Prediction Loss: 0.352589
Epoch 949 
Prediction Loss: 0.342883
Epoch 999 
Prediction Loss: 0.327638
Epoch 1049 
Prediction Loss: 0.317814
Epoch 1099 
Prediction Loss: 0.311471
Epoch 1149 
Prediction Loss: 0.290489
Epoch 1199 
Prediction Loss: 0.295928
Epoch 1249 
Prediction Loss: 0.291276
Epoch 1299 
Prediction Loss: 0.271390
Epoch 1349 
Prediction Loss: 0.258931
Epoch 1399 
Prediction Loss: 0.265592
Epoch 1449 
Prediction Loss: 0.261784
Epoch 1499 
Prediction Loss: 0.250996
Epoch 1549 
Prediction Loss: 0.238052
Epoch 1599 
Prediction Loss: 0.252175
Epoch 1649 
Prediction Loss: 0.232577
Epoch 1699 
Prediction Loss: 0.233557
Epoch 1749 
Prediction Loss: 0.219638
Epoch 1799 
Prediction Loss: 0.223121
Epoch 1849 
Prediction Loss: 0.219414
Epoch 1899 
Prediction Loss: 0.204516
Epoch 1949 
Prediction Loss: 0.217551
Epoch 1999 
Prediction Loss: 0.196315
Epoch 2049 
Prediction Loss: 0.196157
Epoch 2099 
Prediction Loss: 0.196015
Epoch 2149 
Prediction Loss: 0.196763
Epoch 2199 
Prediction Loss: 0.190923
Epoch 2249 
Prediction Loss: 0.189471
Epoch 2299 
Prediction Loss: 0.183978
Epoch 2349 
Prediction Loss: 0.186400
Epoch 2399 
Prediction Loss: 0.183589
Epoch 2449 
Prediction Loss: 0.195518
Epoch 2499 
Prediction Loss: 0.185907
Epoch 2549 
Prediction Loss: 0.183612
Epoch 2599 
Prediction Loss: 0.173017
Epoch 2649 
Prediction Loss: 0.175288
Epoch 2699 
Prediction Loss: 0.174344
Epoch 2749 
Prediction Loss: 0.185704
Epoch 2799 
Prediction Loss: 0.169611
Epoch 2849 
Prediction Loss: 0.167310
Epoch 2899 
Prediction Loss: 0.164825
Epoch 2949 
Prediction Loss: 0.172176
Epoch 2999 
Prediction Loss: 0.178990
Epoch 3049 
Prediction Loss: 0.157784
Epoch 3099 
Prediction Loss: 0.166724
Epoch 3149 
Prediction Loss: 0.166107
Epoch 3199 
Prediction Loss: 0.160763
Epoch 3249 
Prediction Loss: 0.153853
Epoch 3299 
Prediction Loss: 0.159250
Epoch 3349 
Prediction Loss: 0.157649
Epoch 3399 
Prediction Loss: 0.169823
Epoch 3449 
Prediction Loss: 0.166386
Epoch 3499 
Prediction Loss: 0.162590
Epoch 3549 
Prediction Loss: 0.153888
Epoch 3599 
Prediction Loss: 0.159406
Epoch 3649 
Prediction Loss: 0.153214
Epoch 3699 
Prediction Loss: 0.161826
Epoch 3749 
Prediction Loss: 0.157922
Epoch 3799 
Prediction Loss: 0.141562
Epoch 3849 
Prediction Loss: 0.149841
Epoch 3899 
Prediction Loss: 0.144292
Epoch 3949 
Prediction Loss: 0.142474
Epoch 3999 
Prediction Loss: 0.143759
Epoch 4049 
Prediction Loss: 0.160597
Epoch 4099 
Prediction Loss: 0.143915
Epoch 4149 
Prediction Loss: 0.151970
Epoch 4199 
Prediction Loss: 0.144183
Epoch 4249 
Prediction Loss: 0.148769
Epoch 4299 
Prediction Loss: 0.145075
Epoch 4349 
Prediction Loss: 0.155262
Epoch 4399 
Prediction Loss: 0.141167
Epoch 4449 
Prediction Loss: 0.139147
Epoch 4499 
Prediction Loss: 0.153233
Epoch 4549 
Prediction Loss: 0.138799
Epoch 4599 
Prediction Loss: 0.142205
Epoch 4649 
Prediction Loss: 0.139505
Epoch 4699 
Prediction Loss: 0.145620
Epoch 4749 
Prediction Loss: 0.144006
Epoch 4799 
Prediction Loss: 0.133094
Epoch 4849 
Prediction Loss: 0.136366
Epoch 4899 
Prediction Loss: 0.139351
Epoch 4949 
Prediction Loss: 0.133173
Epoch 4999 
Prediction Loss: 0.139120
Epoch 5049 
Prediction Loss: 0.146013
Epoch 5099 
Prediction Loss: 0.133235
Epoch 5149 
Prediction Loss: 0.142287
Epoch 5199 
Prediction Loss: 0.129176
Epoch 5249 
Prediction Loss: 0.129012
Epoch 5299 
Prediction Loss: 0.131226
Epoch 5349 
Prediction Loss: 0.130020
Epoch 5399 
Prediction Loss: 0.126096
Epoch 5449 
Prediction Loss: 0.131028
Epoch 5499 
Prediction Loss: 0.134601
Epoch 5549 
Prediction Loss: 0.136560
Epoch 5599 
Prediction Loss: 0.127380
Epoch 5649 
Prediction Loss: 0.127669
Epoch 5699 
Prediction Loss: 0.125867
Epoch 5749 
Prediction Loss: 0.141306
Epoch 5799 
Prediction Loss: 0.122961
Epoch 5849 
Prediction Loss: 0.132260
Epoch 5899 
Prediction Loss: 0.140863
Epoch 5949 
Prediction Loss: 0.134318
Epoch 5999 
Prediction Loss: 0.129999
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.351173
Insample Error 1.879977
[31m========== repeat time 7 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.889827
Rec Loss: 10.793520
KL Loss: 1.096307
Y Loss: 0.996729
T Loss: 10.295156
Epoch 99 
Overall Loss: 11.638771
Rec Loss: 10.733361
KL Loss: 0.905411
Y Loss: 0.754799
T Loss: 10.355961
Epoch 149 
Overall Loss: 11.518479
Rec Loss: 10.722278
KL Loss: 0.796200
Y Loss: 0.643746
T Loss: 10.400406
Epoch 199 
Overall Loss: 11.472809
Rec Loss: 10.707838
KL Loss: 0.764971
Y Loss: 0.604176
T Loss: 10.405750
Epoch 249 
Overall Loss: 11.431616
Rec Loss: 10.693900
KL Loss: 0.737716
Y Loss: 0.578890
T Loss: 10.404455
Epoch 299 
Overall Loss: 11.440022
Rec Loss: 10.715902
KL Loss: 0.724121
Y Loss: 0.578776
T Loss: 10.426514
Epoch 349 
Overall Loss: 11.406031
Rec Loss: 10.695425
KL Loss: 0.710606
Y Loss: 0.573782
T Loss: 10.408534
Epoch 399 
Overall Loss: 11.387095
Rec Loss: 10.671496
KL Loss: 0.715599
Y Loss: 0.559176
T Loss: 10.391908
Epoch 449 
Overall Loss: 11.384293
Rec Loss: 10.679215
KL Loss: 0.705078
Y Loss: 0.552532
T Loss: 10.402949
Epoch 499 
Overall Loss: 11.381732
Rec Loss: 10.672376
KL Loss: 0.709356
Y Loss: 0.546695
T Loss: 10.399029
Epoch 549 
Overall Loss: 11.359449
Rec Loss: 10.671085
KL Loss: 0.688364
Y Loss: 0.541257
T Loss: 10.400456
Epoch 599 
Overall Loss: 11.346768
Rec Loss: 10.654110
KL Loss: 0.692658
Y Loss: 0.539868
T Loss: 10.384176
Epoch 649 
Overall Loss: 11.343663
Rec Loss: 10.655626
KL Loss: 0.688037
Y Loss: 0.531073
T Loss: 10.390089
Epoch 699 
Overall Loss: 11.346357
Rec Loss: 10.652258
KL Loss: 0.694099
Y Loss: 0.540418
T Loss: 10.382049
Epoch 749 
Overall Loss: 11.337180
Rec Loss: 10.660517
KL Loss: 0.676663
Y Loss: 0.521415
T Loss: 10.399809
Epoch 799 
Overall Loss: 11.337763
Rec Loss: 10.651926
KL Loss: 0.685837
Y Loss: 0.516387
T Loss: 10.393733
Epoch 849 
Overall Loss: 11.327535
Rec Loss: 10.650606
KL Loss: 0.676929
Y Loss: 0.513504
T Loss: 10.393853
Epoch 899 
Overall Loss: 11.320196
Rec Loss: 10.624923
KL Loss: 0.695273
Y Loss: 0.506115
T Loss: 10.371865
Epoch 949 
Overall Loss: 11.300300
Rec Loss: 10.622260
KL Loss: 0.678040
Y Loss: 0.505422
T Loss: 10.369549
Epoch 999 
Overall Loss: 11.307872
Rec Loss: 10.628045
KL Loss: 0.679827
Y Loss: 0.519058
T Loss: 10.368516
Epoch 1049 
Overall Loss: 11.301834
Rec Loss: 10.622884
KL Loss: 0.678951
Y Loss: 0.498740
T Loss: 10.373514
Epoch 1099 
Overall Loss: 11.287785
Rec Loss: 10.613886
KL Loss: 0.673898
Y Loss: 0.499025
T Loss: 10.364374
Epoch 1149 
Overall Loss: 11.275451
Rec Loss: 10.596680
KL Loss: 0.678772
Y Loss: 0.489318
T Loss: 10.352020
Epoch 1199 
Overall Loss: 11.288488
Rec Loss: 10.614533
KL Loss: 0.673955
Y Loss: 0.501733
T Loss: 10.363667
Epoch 1249 
Overall Loss: 11.286824
Rec Loss: 10.609555
KL Loss: 0.677269
Y Loss: 0.506342
T Loss: 10.356384
Epoch 1299 
Overall Loss: 11.272244
Rec Loss: 10.599407
KL Loss: 0.672837
Y Loss: 0.500937
T Loss: 10.348939
Epoch 1349 
Overall Loss: 11.254615
Rec Loss: 10.592388
KL Loss: 0.662228
Y Loss: 0.481476
T Loss: 10.351649
Epoch 1399 
Overall Loss: 11.265267
Rec Loss: 10.584979
KL Loss: 0.680287
Y Loss: 0.479113
T Loss: 10.345423
Epoch 1449 
Overall Loss: 11.250176
Rec Loss: 10.582779
KL Loss: 0.667397
Y Loss: 0.476742
T Loss: 10.344408
Epoch 1499 
Overall Loss: 11.236482
Rec Loss: 10.577625
KL Loss: 0.658858
Y Loss: 0.482833
T Loss: 10.336209
Epoch 1549 
Overall Loss: 11.238231
Rec Loss: 10.564830
KL Loss: 0.673401
Y Loss: 0.475044
T Loss: 10.327308
Epoch 1599 
Overall Loss: 11.248954
Rec Loss: 10.577916
KL Loss: 0.671038
Y Loss: 0.482190
T Loss: 10.336821
Epoch 1649 
Overall Loss: 11.267717
Rec Loss: 10.584016
KL Loss: 0.683700
Y Loss: 0.480794
T Loss: 10.343619
Epoch 1699 
Overall Loss: 11.234560
Rec Loss: 10.560093
KL Loss: 0.674466
Y Loss: 0.478093
T Loss: 10.321047
Epoch 1749 
Overall Loss: 11.222428
Rec Loss: 10.558063
KL Loss: 0.664365
Y Loss: 0.470892
T Loss: 10.322617
Epoch 1799 
Overall Loss: 11.237332
Rec Loss: 10.563762
KL Loss: 0.673570
Y Loss: 0.465874
T Loss: 10.330825
Epoch 1849 
Overall Loss: 11.223546
Rec Loss: 10.553190
KL Loss: 0.670356
Y Loss: 0.468177
T Loss: 10.319102
Epoch 1899 
Overall Loss: 11.227805
Rec Loss: 10.550401
KL Loss: 0.677404
Y Loss: 0.470549
T Loss: 10.315127
Epoch 1949 
Overall Loss: 11.217177
Rec Loss: 10.550350
KL Loss: 0.666827
Y Loss: 0.461133
T Loss: 10.319783
Epoch 1999 
Overall Loss: 11.216817
Rec Loss: 10.551394
KL Loss: 0.665423
Y Loss: 0.460272
T Loss: 10.321258
Epoch 2049 
Overall Loss: 11.216051
Rec Loss: 10.542436
KL Loss: 0.673615
Y Loss: 0.463980
T Loss: 10.310446
Epoch 2099 
Overall Loss: 11.204846
Rec Loss: 10.534106
KL Loss: 0.670741
Y Loss: 0.454071
T Loss: 10.307070
Epoch 2149 
Overall Loss: 11.206204
Rec Loss: 10.529249
KL Loss: 0.676955
Y Loss: 0.456614
T Loss: 10.300942
Epoch 2199 
Overall Loss: 11.199899
Rec Loss: 10.544113
KL Loss: 0.655787
Y Loss: 0.453807
T Loss: 10.317209
Epoch 2249 
Overall Loss: 11.204684
Rec Loss: 10.523696
KL Loss: 0.680988
Y Loss: 0.450041
T Loss: 10.298675
Epoch 2299 
Overall Loss: 11.192966
Rec Loss: 10.527365
KL Loss: 0.665601
Y Loss: 0.451304
T Loss: 10.301713
Epoch 2349 
Overall Loss: 11.184673
Rec Loss: 10.517156
KL Loss: 0.667517
Y Loss: 0.446402
T Loss: 10.293955
Epoch 2399 
Overall Loss: 11.196283
Rec Loss: 10.523109
KL Loss: 0.673174
Y Loss: 0.457342
T Loss: 10.294438
Epoch 2449 
Overall Loss: 11.179622
Rec Loss: 10.511013
KL Loss: 0.668609
Y Loss: 0.440372
T Loss: 10.290828
Epoch 2499 
Overall Loss: 11.194244
Rec Loss: 10.530775
KL Loss: 0.663469
Y Loss: 0.452215
T Loss: 10.304667
Epoch 2549 
Overall Loss: 11.185990
Rec Loss: 10.519202
KL Loss: 0.666788
Y Loss: 0.453015
T Loss: 10.292694
Epoch 2599 
Overall Loss: 11.183517
Rec Loss: 10.504272
KL Loss: 0.679245
Y Loss: 0.443138
T Loss: 10.282703
Epoch 2649 
Overall Loss: 11.166020
Rec Loss: 10.516021
KL Loss: 0.649999
Y Loss: 0.451798
T Loss: 10.290121
Epoch 2699 
Overall Loss: 11.177850
Rec Loss: 10.513164
KL Loss: 0.664686
Y Loss: 0.441493
T Loss: 10.292417
Epoch 2749 
Overall Loss: 11.163176
Rec Loss: 10.504227
KL Loss: 0.658949
Y Loss: 0.435235
T Loss: 10.286609
Epoch 2799 
Overall Loss: 11.184361
Rec Loss: 10.499822
KL Loss: 0.684539
Y Loss: 0.457239
T Loss: 10.271202
Epoch 2849 
Overall Loss: 11.156011
Rec Loss: 10.508152
KL Loss: 0.647859
Y Loss: 0.439885
T Loss: 10.288209
Epoch 2899 
Overall Loss: 11.160536
Rec Loss: 10.499283
KL Loss: 0.661253
Y Loss: 0.436090
T Loss: 10.281238
Epoch 2949 
Overall Loss: 11.162433
Rec Loss: 10.497487
KL Loss: 0.664947
Y Loss: 0.446078
T Loss: 10.274447
Epoch 2999 
Overall Loss: 11.148278
Rec Loss: 10.479436
KL Loss: 0.668842
Y Loss: 0.433150
T Loss: 10.262861
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.437635
Epoch 99
Rec Loss: 0.427432
Epoch 149
Rec Loss: 0.417351
Epoch 199
Rec Loss: 0.419605
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.932093
Epoch 99
Rec Loss: 9.907925
Epoch 149
Rec Loss: 9.894486
Epoch 199
Rec Loss: 9.877773
Epoch 249
Rec Loss: 9.889275
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.619740
Insample Error: 1.479238
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.671200
Rec Loss: 19.746507
KL Loss: 2.924692
Y Loss: 9.471235
T Loss: 12.896338
X Loss: 2.114552
Epoch 99 
Overall Loss: 17.488098
Rec Loss: 14.025669
KL Loss: 3.462428
Y Loss: 3.604612
T Loss: 12.911427
X Loss: -0.688063
Epoch 149 
Overall Loss: 16.260724
Rec Loss: 12.715152
KL Loss: 3.545572
Y Loss: 2.632974
T Loss: 12.766439
X Loss: -1.367774
Epoch 199 
Overall Loss: 15.546849
Rec Loss: 11.655925
KL Loss: 3.890924
Y Loss: 2.002260
T Loss: 12.399415
X Loss: -1.744620
Epoch 249 
Overall Loss: 14.822323
Rec Loss: 10.469264
KL Loss: 4.353059
Y Loss: 1.629035
T Loss: 11.828440
X Loss: -2.173694
Epoch 299 
Overall Loss: 14.372428
Rec Loss: 9.755237
KL Loss: 4.617191
Y Loss: 1.440229
T Loss: 11.527092
X Loss: -2.491969
Epoch 349 
Overall Loss: 14.170310
Rec Loss: 9.298860
KL Loss: 4.871450
Y Loss: 1.346645
T Loss: 11.356467
X Loss: -2.730929
Epoch 399 
Overall Loss: 13.919600
Rec Loss: 8.769458
KL Loss: 5.150143
Y Loss: 1.255900
T Loss: 11.111129
X Loss: -2.969621
Epoch 449 
Overall Loss: 13.721719
Rec Loss: 8.328102
KL Loss: 5.393617
Y Loss: 1.218834
T Loss: 10.898213
X Loss: -3.179528
Epoch 499 
Overall Loss: 13.603951
Rec Loss: 8.057059
KL Loss: 5.546892
Y Loss: 1.188878
T Loss: 10.810871
X Loss: -3.348251
Epoch 549 
Overall Loss: 13.473207
Rec Loss: 7.802449
KL Loss: 5.670757
Y Loss: 1.151200
T Loss: 10.733095
X Loss: -3.506245
Epoch 599 
Overall Loss: 13.439943
Rec Loss: 7.664058
KL Loss: 5.775884
Y Loss: 1.137997
T Loss: 10.708573
X Loss: -3.613513
Epoch 649 
Overall Loss: 13.330691
Rec Loss: 7.466734
KL Loss: 5.863957
Y Loss: 1.067690
T Loss: 10.681831
X Loss: -3.748942
Epoch 699 
Overall Loss: 13.275520
Rec Loss: 7.350533
KL Loss: 5.924987
Y Loss: 1.042770
T Loss: 10.661694
X Loss: -3.832547
Epoch 749 
Overall Loss: 13.248201
Rec Loss: 7.307216
KL Loss: 5.940985
Y Loss: 1.039702
T Loss: 10.660409
X Loss: -3.873044
Epoch 799 
Overall Loss: 13.197492
Rec Loss: 7.201812
KL Loss: 5.995680
Y Loss: 0.983549
T Loss: 10.648550
X Loss: -3.938512
Epoch 849 
Overall Loss: 13.166499
Rec Loss: 7.162192
KL Loss: 6.004307
Y Loss: 0.972558
T Loss: 10.654653
X Loss: -3.978741
Epoch 899 
Overall Loss: 13.126657
Rec Loss: 7.106952
KL Loss: 6.019705
Y Loss: 0.936815
T Loss: 10.648941
X Loss: -4.010397
Epoch 949 
Overall Loss: 13.110973
Rec Loss: 7.050922
KL Loss: 6.060051
Y Loss: 0.933187
T Loss: 10.644234
X Loss: -4.059906
Epoch 999 
Overall Loss: 13.074982
Rec Loss: 7.002374
KL Loss: 6.072607
Y Loss: 0.919693
T Loss: 10.630305
X Loss: -4.087777
Epoch 1049 
Overall Loss: 13.062090
Rec Loss: 6.954952
KL Loss: 6.107138
Y Loss: 0.895397
T Loss: 10.642928
X Loss: -4.135675
Epoch 1099 
Overall Loss: 13.059298
Rec Loss: 6.933364
KL Loss: 6.125934
Y Loss: 0.891699
T Loss: 10.645103
X Loss: -4.157589
Epoch 1149 
Overall Loss: 13.005163
Rec Loss: 6.878147
KL Loss: 6.127016
Y Loss: 0.891852
T Loss: 10.646523
X Loss: -4.214302
Epoch 1199 
Overall Loss: 13.003959
Rec Loss: 6.841096
KL Loss: 6.162864
Y Loss: 0.877602
T Loss: 10.649233
X Loss: -4.246939
Epoch 1249 
Overall Loss: 13.034971
Rec Loss: 6.831793
KL Loss: 6.203178
Y Loss: 0.877158
T Loss: 10.655560
X Loss: -4.262346
Epoch 1299 
Overall Loss: 12.974693
Rec Loss: 6.781962
KL Loss: 6.192732
Y Loss: 0.884106
T Loss: 10.646088
X Loss: -4.306179
Epoch 1349 
Overall Loss: 12.978521
Rec Loss: 6.760758
KL Loss: 6.217763
Y Loss: 0.886656
T Loss: 10.667178
X Loss: -4.349749
Epoch 1399 
Overall Loss: 12.960676
Rec Loss: 6.676964
KL Loss: 6.283711
Y Loss: 0.866110
T Loss: 10.666216
X Loss: -4.422307
Epoch 1449 
Overall Loss: 12.916133
Rec Loss: 6.626643
KL Loss: 6.289490
Y Loss: 0.855356
T Loss: 10.670577
X Loss: -4.471612
Epoch 1499 
Overall Loss: 12.905986
Rec Loss: 6.593936
KL Loss: 6.312051
Y Loss: 0.838376
T Loss: 10.660280
X Loss: -4.485533
Epoch 1549 
Overall Loss: 12.902473
Rec Loss: 6.576620
KL Loss: 6.325854
Y Loss: 0.852051
T Loss: 10.677192
X Loss: -4.526598
Epoch 1599 
Overall Loss: 12.915843
Rec Loss: 6.559646
KL Loss: 6.356197
Y Loss: 0.849094
T Loss: 10.685705
X Loss: -4.550607
Epoch 1649 
Overall Loss: 12.879480
Rec Loss: 6.498250
KL Loss: 6.381231
Y Loss: 0.846266
T Loss: 10.677163
X Loss: -4.602047
Epoch 1699 
Overall Loss: 12.900962
Rec Loss: 6.477496
KL Loss: 6.423466
Y Loss: 0.835315
T Loss: 10.683268
X Loss: -4.623430
Epoch 1749 
Overall Loss: 12.868669
Rec Loss: 6.445959
KL Loss: 6.422711
Y Loss: 0.847841
T Loss: 10.685784
X Loss: -4.663746
Epoch 1799 
Overall Loss: 12.844574
Rec Loss: 6.419044
KL Loss: 6.425531
Y Loss: 0.817478
T Loss: 10.693133
X Loss: -4.682828
Epoch 1849 
Overall Loss: 12.854618
Rec Loss: 6.415197
KL Loss: 6.439421
Y Loss: 0.827579
T Loss: 10.706196
X Loss: -4.704788
Epoch 1899 
Overall Loss: 12.863962
Rec Loss: 6.379222
KL Loss: 6.484741
Y Loss: 0.843555
T Loss: 10.707640
X Loss: -4.750196
Epoch 1949 
Overall Loss: 12.856058
Rec Loss: 6.340753
KL Loss: 6.515305
Y Loss: 0.824757
T Loss: 10.705723
X Loss: -4.777349
Epoch 1999 
Overall Loss: 12.869633
Rec Loss: 6.333356
KL Loss: 6.536278
Y Loss: 0.832997
T Loss: 10.707151
X Loss: -4.790293
Epoch 2049 
Overall Loss: 12.852494
Rec Loss: 6.303858
KL Loss: 6.548636
Y Loss: 0.858665
T Loss: 10.711376
X Loss: -4.836850
Epoch 2099 
Overall Loss: 12.834409
Rec Loss: 6.271870
KL Loss: 6.562539
Y Loss: 0.827980
T Loss: 10.713623
X Loss: -4.855743
Epoch 2149 
Overall Loss: 12.818646
Rec Loss: 6.217191
KL Loss: 6.601455
Y Loss: 0.825510
T Loss: 10.713686
X Loss: -4.909250
Epoch 2199 
Overall Loss: 12.863786
Rec Loss: 6.241735
KL Loss: 6.622051
Y Loss: 0.822494
T Loss: 10.724226
X Loss: -4.893739
Epoch 2249 
Overall Loss: 12.838692
Rec Loss: 6.198122
KL Loss: 6.640570
Y Loss: 0.815916
T Loss: 10.728867
X Loss: -4.938703
Epoch 2299 
Overall Loss: 12.833834
Rec Loss: 6.192208
KL Loss: 6.641626
Y Loss: 0.843849
T Loss: 10.749670
X Loss: -4.979386
Epoch 2349 
Overall Loss: 12.813278
Rec Loss: 6.110372
KL Loss: 6.702906
Y Loss: 0.828705
T Loss: 10.721597
X Loss: -5.025577
Epoch 2399 
Overall Loss: 12.821375
Rec Loss: 6.118608
KL Loss: 6.702767
Y Loss: 0.809316
T Loss: 10.743639
X Loss: -5.029689
Epoch 2449 
Overall Loss: 12.818659
Rec Loss: 6.126602
KL Loss: 6.692057
Y Loss: 0.839071
T Loss: 10.757591
X Loss: -5.050525
Epoch 2499 
Overall Loss: 12.825928
Rec Loss: 6.076134
KL Loss: 6.749793
Y Loss: 0.812933
T Loss: 10.742984
X Loss: -5.073316
Epoch 2549 
Overall Loss: 12.805364
Rec Loss: 6.058642
KL Loss: 6.746722
Y Loss: 0.832081
T Loss: 10.747146
X Loss: -5.104545
Epoch 2599 
Overall Loss: 12.810918
Rec Loss: 6.045943
KL Loss: 6.764975
Y Loss: 0.832951
T Loss: 10.745424
X Loss: -5.115957
Epoch 2649 
Overall Loss: 12.791744
Rec Loss: 5.992883
KL Loss: 6.798862
Y Loss: 0.828084
T Loss: 10.739366
X Loss: -5.160526
Epoch 2699 
Overall Loss: 12.782156
Rec Loss: 5.989995
KL Loss: 6.792161
Y Loss: 0.816455
T Loss: 10.754845
X Loss: -5.173078
Epoch 2749 
Overall Loss: 12.797537
Rec Loss: 5.970634
KL Loss: 6.826904
Y Loss: 0.805255
T Loss: 10.765273
X Loss: -5.197266
Epoch 2799 
Overall Loss: 12.770871
Rec Loss: 5.939765
KL Loss: 6.831106
Y Loss: 0.810702
T Loss: 10.760473
X Loss: -5.226059
Epoch 2849 
Overall Loss: 12.775784
Rec Loss: 5.920288
KL Loss: 6.855496
Y Loss: 0.811059
T Loss: 10.743220
X Loss: -5.228461
Epoch 2899 
Overall Loss: 12.795236
Rec Loss: 5.915733
KL Loss: 6.879503
Y Loss: 0.810969
T Loss: 10.757172
X Loss: -5.246923
Epoch 2949 
Overall Loss: 12.798656
Rec Loss: 5.895865
KL Loss: 6.902791
Y Loss: 0.806288
T Loss: 10.772786
X Loss: -5.280064
Epoch 2999 
Overall Loss: 12.765417
Rec Loss: 5.880714
KL Loss: 6.884702
Y Loss: 0.823346
T Loss: 10.770720
X Loss: -5.301679
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.429066
Epoch 99
Rec Loss: 1.431954
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.001013
Epoch 99
Rec Loss: 1.993180
Epoch 149
Rec Loss: 2.000048
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.662096
Insample Error 2.276242
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.722677
Epoch 99 
Prediction Loss: 0.642608
Epoch 149 
Prediction Loss: 0.582584
Epoch 199 
Prediction Loss: 0.564383
Epoch 249 
Prediction Loss: 0.549444
Epoch 299 
Prediction Loss: 0.523715
Epoch 349 
Prediction Loss: 0.511370
Epoch 399 
Prediction Loss: 0.518967
Epoch 449 
Prediction Loss: 0.459624
Epoch 499 
Prediction Loss: 0.457839
Epoch 549 
Prediction Loss: 0.437045
Epoch 599 
Prediction Loss: 0.455016
Epoch 649 
Prediction Loss: 0.446082
Epoch 699 
Prediction Loss: 0.399288
Epoch 749 
Prediction Loss: 0.380345
Epoch 799 
Prediction Loss: 0.368145
Epoch 849 
Prediction Loss: 0.356526
Epoch 899 
Prediction Loss: 0.331892
Epoch 949 
Prediction Loss: 0.326622
Epoch 999 
Prediction Loss: 0.325877
Epoch 1049 
Prediction Loss: 0.317991
Epoch 1099 
Prediction Loss: 0.302586
Epoch 1149 
Prediction Loss: 0.296846
Epoch 1199 
Prediction Loss: 0.281655
Epoch 1249 
Prediction Loss: 0.276268
Epoch 1299 
Prediction Loss: 0.269340
Epoch 1349 
Prediction Loss: 0.260850
Epoch 1399 
Prediction Loss: 0.260796
Epoch 1449 
Prediction Loss: 0.261125
Epoch 1499 
Prediction Loss: 0.244376
Epoch 1549 
Prediction Loss: 0.251374
Epoch 1599 
Prediction Loss: 0.236042
Epoch 1649 
Prediction Loss: 0.233677
Epoch 1699 
Prediction Loss: 0.260704
Epoch 1749 
Prediction Loss: 0.220685
Epoch 1799 
Prediction Loss: 0.225442
Epoch 1849 
Prediction Loss: 0.215188
Epoch 1899 
Prediction Loss: 0.211030
Epoch 1949 
Prediction Loss: 0.211916
Epoch 1999 
Prediction Loss: 0.201642
Epoch 2049 
Prediction Loss: 0.204336
Epoch 2099 
Prediction Loss: 0.206189
Epoch 2149 
Prediction Loss: 0.197981
Epoch 2199 
Prediction Loss: 0.201096
Epoch 2249 
Prediction Loss: 0.190162
Epoch 2299 
Prediction Loss: 0.192297
Epoch 2349 
Prediction Loss: 0.193688
Epoch 2399 
Prediction Loss: 0.184835
Epoch 2449 
Prediction Loss: 0.193205
Epoch 2499 
Prediction Loss: 0.181755
Epoch 2549 
Prediction Loss: 0.177307
Epoch 2599 
Prediction Loss: 0.185685
Epoch 2649 
Prediction Loss: 0.175358
Epoch 2699 
Prediction Loss: 0.171932
Epoch 2749 
Prediction Loss: 0.170484
Epoch 2799 
Prediction Loss: 0.174804
Epoch 2849 
Prediction Loss: 0.168189
Epoch 2899 
Prediction Loss: 0.168383
Epoch 2949 
Prediction Loss: 0.167790
Epoch 2999 
Prediction Loss: 0.162094
Epoch 3049 
Prediction Loss: 0.167442
Epoch 3099 
Prediction Loss: 0.163578
Epoch 3149 
Prediction Loss: 0.175517
Epoch 3199 
Prediction Loss: 0.172312
Epoch 3249 
Prediction Loss: 0.167626
Epoch 3299 
Prediction Loss: 0.164117
Epoch 3349 
Prediction Loss: 0.161483
Epoch 3399 
Prediction Loss: 0.155555
Epoch 3449 
Prediction Loss: 0.157510
Epoch 3499 
Prediction Loss: 0.151343
Epoch 3549 
Prediction Loss: 0.162176
Epoch 3599 
Prediction Loss: 0.159953
Epoch 3649 
Prediction Loss: 0.166038
Epoch 3699 
Prediction Loss: 0.151977
Epoch 3749 
Prediction Loss: 0.148665
Epoch 3799 
Prediction Loss: 0.153195
Epoch 3849 
Prediction Loss: 0.149535
Epoch 3899 
Prediction Loss: 0.178930
Epoch 3949 
Prediction Loss: 0.152017
Epoch 3999 
Prediction Loss: 0.151352
Epoch 4049 
Prediction Loss: 0.143354
Epoch 4099 
Prediction Loss: 0.153640
Epoch 4149 
Prediction Loss: 0.147586
Epoch 4199 
Prediction Loss: 0.143410
Epoch 4249 
Prediction Loss: 0.148147
Epoch 4299 
Prediction Loss: 0.143301
Epoch 4349 
Prediction Loss: 0.150821
Epoch 4399 
Prediction Loss: 0.159108
Epoch 4449 
Prediction Loss: 0.156345
Epoch 4499 
Prediction Loss: 0.147968
Epoch 4549 
Prediction Loss: 0.140037
Epoch 4599 
Prediction Loss: 0.144153
Epoch 4649 
Prediction Loss: 0.136199
Epoch 4699 
Prediction Loss: 0.154049
Epoch 4749 
Prediction Loss: 0.141817
Epoch 4799 
Prediction Loss: 0.138002
Epoch 4849 
Prediction Loss: 0.138995
Epoch 4899 
Prediction Loss: 0.133295
Epoch 4949 
Prediction Loss: 0.135584
Epoch 4999 
Prediction Loss: 0.156478
Epoch 5049 
Prediction Loss: 0.136698
Epoch 5099 
Prediction Loss: 0.133742
Epoch 5149 
Prediction Loss: 0.137260
Epoch 5199 
Prediction Loss: 0.133415
Epoch 5249 
Prediction Loss: 0.133079
Epoch 5299 
Prediction Loss: 0.136270
Epoch 5349 
Prediction Loss: 0.133013
Epoch 5399 
Prediction Loss: 0.141955
Epoch 5449 
Prediction Loss: 0.130453
Epoch 5499 
Prediction Loss: 0.135977
Epoch 5549 
Prediction Loss: 0.136757
Epoch 5599 
Prediction Loss: 0.138756
Epoch 5649 
Prediction Loss: 0.144479
Epoch 5699 
Prediction Loss: 0.141129
Epoch 5749 
Prediction Loss: 0.135627
Epoch 5799 
Prediction Loss: 0.133703
Epoch 5849 
Prediction Loss: 0.129821
Epoch 5899 
Prediction Loss: 0.134400
Epoch 5949 
Prediction Loss: 0.133555
Epoch 5999 
Prediction Loss: 0.130257
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.350188
Insample Error 1.853640
[31m========== repeat time 8 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.142423
Rec Loss: 11.182565
KL Loss: 0.959858
Y Loss: 1.047662
T Loss: 10.658734
Epoch 99 
Overall Loss: 11.639296
Rec Loss: 10.754191
KL Loss: 0.885106
Y Loss: 0.773008
T Loss: 10.367686
Epoch 149 
Overall Loss: 11.525556
Rec Loss: 10.750081
KL Loss: 0.775475
Y Loss: 0.698311
T Loss: 10.400925
Epoch 199 
Overall Loss: 11.455660
Rec Loss: 10.729471
KL Loss: 0.726190
Y Loss: 0.653046
T Loss: 10.402948
Epoch 249 
Overall Loss: 11.454480
Rec Loss: 10.735921
KL Loss: 0.718559
Y Loss: 0.629777
T Loss: 10.421033
Epoch 299 
Overall Loss: 11.448716
Rec Loss: 10.751960
KL Loss: 0.696756
Y Loss: 0.626196
T Loss: 10.438862
Epoch 349 
Overall Loss: 11.416261
Rec Loss: 10.715336
KL Loss: 0.700924
Y Loss: 0.607138
T Loss: 10.411768
Epoch 399 
Overall Loss: 11.396469
Rec Loss: 10.700441
KL Loss: 0.696028
Y Loss: 0.591434
T Loss: 10.404723
Epoch 449 
Overall Loss: 11.399901
Rec Loss: 10.707319
KL Loss: 0.692582
Y Loss: 0.588698
T Loss: 10.412970
Epoch 499 
Overall Loss: 11.373949
Rec Loss: 10.694029
KL Loss: 0.679920
Y Loss: 0.584577
T Loss: 10.401740
Epoch 549 
Overall Loss: 11.387782
Rec Loss: 10.701327
KL Loss: 0.686456
Y Loss: 0.574326
T Loss: 10.414164
Epoch 599 
Overall Loss: 11.368126
Rec Loss: 10.695916
KL Loss: 0.672211
Y Loss: 0.574315
T Loss: 10.408758
Epoch 649 
Overall Loss: 11.348374
Rec Loss: 10.686508
KL Loss: 0.661866
Y Loss: 0.571205
T Loss: 10.400906
Epoch 699 
Overall Loss: 11.351040
Rec Loss: 10.675008
KL Loss: 0.676032
Y Loss: 0.558446
T Loss: 10.395784
Epoch 749 
Overall Loss: 11.340212
Rec Loss: 10.670309
KL Loss: 0.669903
Y Loss: 0.553723
T Loss: 10.393447
Epoch 799 
Overall Loss: 11.326081
Rec Loss: 10.652850
KL Loss: 0.673230
Y Loss: 0.548482
T Loss: 10.378610
Epoch 849 
Overall Loss: 11.327804
Rec Loss: 10.658853
KL Loss: 0.668951
Y Loss: 0.551724
T Loss: 10.382991
Epoch 899 
Overall Loss: 11.325171
Rec Loss: 10.660042
KL Loss: 0.665129
Y Loss: 0.541346
T Loss: 10.389369
Epoch 949 
Overall Loss: 11.318158
Rec Loss: 10.657175
KL Loss: 0.660983
Y Loss: 0.538171
T Loss: 10.388090
Epoch 999 
Overall Loss: 11.321223
Rec Loss: 10.659201
KL Loss: 0.662022
Y Loss: 0.544344
T Loss: 10.387028
Epoch 1049 
Overall Loss: 11.300199
Rec Loss: 10.634424
KL Loss: 0.665776
Y Loss: 0.531223
T Loss: 10.368812
Epoch 1099 
Overall Loss: 11.310956
Rec Loss: 10.641236
KL Loss: 0.669720
Y Loss: 0.542703
T Loss: 10.369884
Epoch 1149 
Overall Loss: 11.300733
Rec Loss: 10.630854
KL Loss: 0.669878
Y Loss: 0.525910
T Loss: 10.367899
Epoch 1199 
Overall Loss: 11.311260
Rec Loss: 10.648779
KL Loss: 0.662481
Y Loss: 0.528758
T Loss: 10.384400
Epoch 1249 
Overall Loss: 11.291799
Rec Loss: 10.635022
KL Loss: 0.656777
Y Loss: 0.531240
T Loss: 10.369402
Epoch 1299 
Overall Loss: 11.281939
Rec Loss: 10.617859
KL Loss: 0.664080
Y Loss: 0.530481
T Loss: 10.352618
Epoch 1349 
Overall Loss: 11.282788
Rec Loss: 10.620720
KL Loss: 0.662068
Y Loss: 0.529080
T Loss: 10.356180
Epoch 1399 
Overall Loss: 11.277555
Rec Loss: 10.620897
KL Loss: 0.656658
Y Loss: 0.515072
T Loss: 10.363361
Epoch 1449 
Overall Loss: 11.270950
Rec Loss: 10.597446
KL Loss: 0.673504
Y Loss: 0.505753
T Loss: 10.344569
Epoch 1499 
Overall Loss: 11.265728
Rec Loss: 10.607051
KL Loss: 0.658677
Y Loss: 0.509246
T Loss: 10.352428
Epoch 1549 
Overall Loss: 11.262302
Rec Loss: 10.606144
KL Loss: 0.656158
Y Loss: 0.514976
T Loss: 10.348656
Epoch 1599 
Overall Loss: 11.250148
Rec Loss: 10.592442
KL Loss: 0.657706
Y Loss: 0.503098
T Loss: 10.340893
Epoch 1649 
Overall Loss: 11.235847
Rec Loss: 10.580998
KL Loss: 0.654849
Y Loss: 0.493785
T Loss: 10.334105
Epoch 1699 
Overall Loss: 11.251507
Rec Loss: 10.595557
KL Loss: 0.655950
Y Loss: 0.507997
T Loss: 10.341558
Epoch 1749 
Overall Loss: 11.240899
Rec Loss: 10.595769
KL Loss: 0.645130
Y Loss: 0.500448
T Loss: 10.345545
Epoch 1799 
Overall Loss: 11.242999
Rec Loss: 10.573612
KL Loss: 0.669386
Y Loss: 0.489876
T Loss: 10.328675
Epoch 1849 
Overall Loss: 11.235737
Rec Loss: 10.577749
KL Loss: 0.657988
Y Loss: 0.486947
T Loss: 10.334275
Epoch 1899 
Overall Loss: 11.229605
Rec Loss: 10.561537
KL Loss: 0.668068
Y Loss: 0.491958
T Loss: 10.315558
Epoch 1949 
Overall Loss: 11.217866
Rec Loss: 10.556379
KL Loss: 0.661486
Y Loss: 0.488507
T Loss: 10.312126
Epoch 1999 
Overall Loss: 11.208148
Rec Loss: 10.553329
KL Loss: 0.654819
Y Loss: 0.482564
T Loss: 10.312048
Epoch 2049 
Overall Loss: 11.205069
Rec Loss: 10.546258
KL Loss: 0.658811
Y Loss: 0.487858
T Loss: 10.302329
Epoch 2099 
Overall Loss: 11.209884
Rec Loss: 10.554250
KL Loss: 0.655635
Y Loss: 0.477685
T Loss: 10.315407
Epoch 2149 
Overall Loss: 11.209452
Rec Loss: 10.549483
KL Loss: 0.659969
Y Loss: 0.479277
T Loss: 10.309845
Epoch 2199 
Overall Loss: 11.188125
Rec Loss: 10.541377
KL Loss: 0.646748
Y Loss: 0.478637
T Loss: 10.302058
Epoch 2249 
Overall Loss: 11.202842
Rec Loss: 10.529078
KL Loss: 0.673764
Y Loss: 0.469081
T Loss: 10.294537
Epoch 2299 
Overall Loss: 11.217427
Rec Loss: 10.554678
KL Loss: 0.662749
Y Loss: 0.487999
T Loss: 10.310679
Epoch 2349 
Overall Loss: 11.193528
Rec Loss: 10.531487
KL Loss: 0.662040
Y Loss: 0.462034
T Loss: 10.300471
Epoch 2399 
Overall Loss: 11.195174
Rec Loss: 10.529375
KL Loss: 0.665799
Y Loss: 0.470020
T Loss: 10.294365
Epoch 2449 
Overall Loss: 11.179676
Rec Loss: 10.527522
KL Loss: 0.652154
Y Loss: 0.468502
T Loss: 10.293271
Epoch 2499 
Overall Loss: 11.187133
Rec Loss: 10.552082
KL Loss: 0.635052
Y Loss: 0.465747
T Loss: 10.319208
Epoch 2549 
Overall Loss: 11.178775
Rec Loss: 10.526229
KL Loss: 0.652546
Y Loss: 0.462139
T Loss: 10.295159
Epoch 2599 
Overall Loss: 11.172538
Rec Loss: 10.516247
KL Loss: 0.656291
Y Loss: 0.452022
T Loss: 10.290236
Epoch 2649 
Overall Loss: 11.171174
Rec Loss: 10.524573
KL Loss: 0.646601
Y Loss: 0.457927
T Loss: 10.295609
Epoch 2699 
Overall Loss: 11.161928
Rec Loss: 10.505552
KL Loss: 0.656376
Y Loss: 0.452319
T Loss: 10.279392
Epoch 2749 
Overall Loss: 11.165103
Rec Loss: 10.513768
KL Loss: 0.651335
Y Loss: 0.450427
T Loss: 10.288554
Epoch 2799 
Overall Loss: 11.170888
Rec Loss: 10.509063
KL Loss: 0.661824
Y Loss: 0.451859
T Loss: 10.283134
Epoch 2849 
Overall Loss: 11.153713
Rec Loss: 10.499635
KL Loss: 0.654078
Y Loss: 0.436455
T Loss: 10.281407
Epoch 2899 
Overall Loss: 11.149041
Rec Loss: 10.497668
KL Loss: 0.651373
Y Loss: 0.449516
T Loss: 10.272910
Epoch 2949 
Overall Loss: 11.147422
Rec Loss: 10.496203
KL Loss: 0.651219
Y Loss: 0.445010
T Loss: 10.273698
Epoch 2999 
Overall Loss: 11.154310
Rec Loss: 10.496758
KL Loss: 0.657552
Y Loss: 0.439120
T Loss: 10.277198
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.449432
Epoch 99
Rec Loss: 0.439052
Epoch 149
Rec Loss: 0.438701
Epoch 199
Rec Loss: 0.430582
Epoch 249
Rec Loss: 0.429653
Epoch 299
Rec Loss: 0.428467
Epoch 349
Rec Loss: 0.428421
Epoch 399
Rec Loss: 0.426676
Epoch 449
Rec Loss: 0.425163
Epoch 499
Rec Loss: 0.434814
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.932637
Epoch 99
Rec Loss: 9.919596
Epoch 149
Rec Loss: 9.911056
Epoch 199
Rec Loss: 9.883185
Epoch 249
Rec Loss: 9.875789
Epoch 299
Rec Loss: 9.855925
Epoch 349
Rec Loss: 9.859554
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.627740
Insample Error: 1.514756
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.952016
Rec Loss: 18.594100
KL Loss: 3.357916
Y Loss: 7.836830
T Loss: 12.814801
X Loss: 1.860884
Epoch 99 
Overall Loss: 17.871350
Rec Loss: 14.005744
KL Loss: 3.865606
Y Loss: 2.624138
T Loss: 12.807936
X Loss: -0.114261
Epoch 149 
Overall Loss: 16.655857
Rec Loss: 12.823609
KL Loss: 3.832248
Y Loss: 1.916825
T Loss: 12.659723
X Loss: -0.794527
Epoch 199 
Overall Loss: 15.328390
Rec Loss: 11.192768
KL Loss: 4.135623
Y Loss: 1.630523
T Loss: 12.033448
X Loss: -1.655942
Epoch 249 
Overall Loss: 14.661360
Rec Loss: 10.214633
KL Loss: 4.446728
Y Loss: 1.318283
T Loss: 11.760507
X Loss: -2.205016
Epoch 299 
Overall Loss: 14.296882
Rec Loss: 9.525107
KL Loss: 4.771775
Y Loss: 1.150291
T Loss: 11.592127
X Loss: -2.642166
Epoch 349 
Overall Loss: 14.045511
Rec Loss: 9.050097
KL Loss: 4.995415
Y Loss: 1.091177
T Loss: 11.470848
X Loss: -2.966340
Epoch 399 
Overall Loss: 13.861742
Rec Loss: 8.669185
KL Loss: 5.192557
Y Loss: 1.021864
T Loss: 11.376971
X Loss: -3.218718
Epoch 449 
Overall Loss: 13.772814
Rec Loss: 8.427557
KL Loss: 5.345257
Y Loss: 1.005920
T Loss: 11.329251
X Loss: -3.404655
Epoch 499 
Overall Loss: 13.661370
Rec Loss: 8.171595
KL Loss: 5.489775
Y Loss: 0.979230
T Loss: 11.242618
X Loss: -3.560639
Epoch 549 
Overall Loss: 13.466679
Rec Loss: 7.658323
KL Loss: 5.808356
Y Loss: 0.969781
T Loss: 10.999005
X Loss: -3.825573
Epoch 599 
Overall Loss: 13.358300
Rec Loss: 7.347670
KL Loss: 6.010630
Y Loss: 0.959160
T Loss: 10.842030
X Loss: -3.973940
Epoch 649 
Overall Loss: 13.278278
Rec Loss: 7.161215
KL Loss: 6.117063
Y Loss: 0.933069
T Loss: 10.800438
X Loss: -4.105758
Epoch 699 
Overall Loss: 13.213828
Rec Loss: 7.016831
KL Loss: 6.196997
Y Loss: 0.922757
T Loss: 10.769043
X Loss: -4.213591
Epoch 749 
Overall Loss: 13.206723
Rec Loss: 6.880119
KL Loss: 6.326604
Y Loss: 0.925727
T Loss: 10.753711
X Loss: -4.336455
Epoch 799 
Overall Loss: 13.136810
Rec Loss: 6.758152
KL Loss: 6.378658
Y Loss: 0.909353
T Loss: 10.758909
X Loss: -4.455434
Epoch 849 
Overall Loss: 13.132803
Rec Loss: 6.700942
KL Loss: 6.431861
Y Loss: 0.899768
T Loss: 10.765688
X Loss: -4.514631
Epoch 899 
Overall Loss: 13.085408
Rec Loss: 6.595701
KL Loss: 6.489707
Y Loss: 0.852826
T Loss: 10.770674
X Loss: -4.601385
Epoch 949 
Overall Loss: 13.066144
Rec Loss: 6.540592
KL Loss: 6.525552
Y Loss: 0.850594
T Loss: 10.779644
X Loss: -4.664350
Epoch 999 
Overall Loss: 13.065108
Rec Loss: 6.490846
KL Loss: 6.574262
Y Loss: 0.846863
T Loss: 10.769689
X Loss: -4.702274
Epoch 1049 
Overall Loss: 13.029724
Rec Loss: 6.424910
KL Loss: 6.604814
Y Loss: 0.833172
T Loss: 10.777057
X Loss: -4.768732
Epoch 1099 
Overall Loss: 13.012402
Rec Loss: 6.391371
KL Loss: 6.621031
Y Loss: 0.852702
T Loss: 10.769673
X Loss: -4.804653
Epoch 1149 
Overall Loss: 12.993853
Rec Loss: 6.312132
KL Loss: 6.681720
Y Loss: 0.827242
T Loss: 10.776509
X Loss: -4.877998
Epoch 1199 
Overall Loss: 13.012242
Rec Loss: 6.321595
KL Loss: 6.690648
Y Loss: 0.837370
T Loss: 10.781755
X Loss: -4.878846
Epoch 1249 
Overall Loss: 12.953875
Rec Loss: 6.264271
KL Loss: 6.689604
Y Loss: 0.821246
T Loss: 10.776881
X Loss: -4.923233
Epoch 1299 
Overall Loss: 12.959828
Rec Loss: 6.233919
KL Loss: 6.725909
Y Loss: 0.819979
T Loss: 10.772602
X Loss: -4.948672
Epoch 1349 
Overall Loss: 12.956567
Rec Loss: 6.230361
KL Loss: 6.726205
Y Loss: 0.842873
T Loss: 10.789103
X Loss: -4.980178
Epoch 1399 
Overall Loss: 12.896268
Rec Loss: 6.152880
KL Loss: 6.743388
Y Loss: 0.808444
T Loss: 10.775056
X Loss: -5.026398
Epoch 1449 
Overall Loss: 12.907516
Rec Loss: 6.114965
KL Loss: 6.792550
Y Loss: 0.813524
T Loss: 10.765697
X Loss: -5.057494
Epoch 1499 
Overall Loss: 12.924213
Rec Loss: 6.129771
KL Loss: 6.794442
Y Loss: 0.841355
T Loss: 10.772317
X Loss: -5.063223
Epoch 1549 
Overall Loss: 12.907345
Rec Loss: 6.088841
KL Loss: 6.818503
Y Loss: 0.819336
T Loss: 10.779680
X Loss: -5.100507
Epoch 1599 
Overall Loss: 12.883756
Rec Loss: 6.082091
KL Loss: 6.801665
Y Loss: 0.817231
T Loss: 10.769851
X Loss: -5.096376
Epoch 1649 
Overall Loss: 12.859890
Rec Loss: 6.007359
KL Loss: 6.852531
Y Loss: 0.794949
T Loss: 10.773211
X Loss: -5.163327
Epoch 1699 
Overall Loss: 12.888619
Rec Loss: 6.053709
KL Loss: 6.834910
Y Loss: 0.829388
T Loss: 10.781020
X Loss: -5.142005
Epoch 1749 
Overall Loss: 12.867635
Rec Loss: 6.013816
KL Loss: 6.853819
Y Loss: 0.817172
T Loss: 10.774172
X Loss: -5.168942
Epoch 1799 
Overall Loss: 12.897035
Rec Loss: 6.026715
KL Loss: 6.870321
Y Loss: 0.809973
T Loss: 10.801377
X Loss: -5.179648
Epoch 1849 
Overall Loss: 12.888673
Rec Loss: 6.018624
KL Loss: 6.870049
Y Loss: 0.822029
T Loss: 10.791349
X Loss: -5.183739
Epoch 1899 
Overall Loss: 12.875103
Rec Loss: 5.972965
KL Loss: 6.902137
Y Loss: 0.795591
T Loss: 10.771112
X Loss: -5.195942
Epoch 1949 
Overall Loss: 12.882789
Rec Loss: 5.954656
KL Loss: 6.928134
Y Loss: 0.818967
T Loss: 10.778894
X Loss: -5.233721
Epoch 1999 
Overall Loss: 12.857513
Rec Loss: 5.935086
KL Loss: 6.922427
Y Loss: 0.795436
T Loss: 10.778735
X Loss: -5.241367
Epoch 2049 
Overall Loss: 12.819472
Rec Loss: 5.909503
KL Loss: 6.909968
Y Loss: 0.806342
T Loss: 10.759864
X Loss: -5.253532
Epoch 2099 
Overall Loss: 12.875217
Rec Loss: 5.920694
KL Loss: 6.954523
Y Loss: 0.808758
T Loss: 10.799649
X Loss: -5.283334
Epoch 2149 
Overall Loss: 12.845008
Rec Loss: 5.890366
KL Loss: 6.954643
Y Loss: 0.818512
T Loss: 10.785067
X Loss: -5.303957
Epoch 2199 
Overall Loss: 12.848944
Rec Loss: 5.851746
KL Loss: 6.997198
Y Loss: 0.800707
T Loss: 10.792263
X Loss: -5.340871
Epoch 2249 
Overall Loss: 12.841462
Rec Loss: 5.850191
KL Loss: 6.991271
Y Loss: 0.800104
T Loss: 10.791953
X Loss: -5.341814
Epoch 2299 
Overall Loss: 12.848326
Rec Loss: 5.844246
KL Loss: 7.004080
Y Loss: 0.798895
T Loss: 10.797739
X Loss: -5.352941
Epoch 2349 
Overall Loss: 12.836957
Rec Loss: 5.819181
KL Loss: 7.017776
Y Loss: 0.803214
T Loss: 10.805018
X Loss: -5.387443
Epoch 2399 
Overall Loss: 12.838500
Rec Loss: 5.817390
KL Loss: 7.021110
Y Loss: 0.819077
T Loss: 10.810811
X Loss: -5.402960
Epoch 2449 
Overall Loss: 12.816289
Rec Loss: 5.748192
KL Loss: 7.068097
Y Loss: 0.768384
T Loss: 10.804979
X Loss: -5.440979
Epoch 2499 
Overall Loss: 12.799907
Rec Loss: 5.751422
KL Loss: 7.048485
Y Loss: 0.799495
T Loss: 10.803225
X Loss: -5.451551
Epoch 2549 
Overall Loss: 12.814466
Rec Loss: 5.753782
KL Loss: 7.060684
Y Loss: 0.812397
T Loss: 10.809288
X Loss: -5.461704
Epoch 2599 
Overall Loss: 12.809165
Rec Loss: 5.710103
KL Loss: 7.099062
Y Loss: 0.813212
T Loss: 10.808403
X Loss: -5.504905
Epoch 2649 
Overall Loss: 12.814226
Rec Loss: 5.711950
KL Loss: 7.102277
Y Loss: 0.806802
T Loss: 10.819800
X Loss: -5.511252
Epoch 2699 
Overall Loss: 12.822573
Rec Loss: 5.684146
KL Loss: 7.138427
Y Loss: 0.793565
T Loss: 10.814005
X Loss: -5.526641
Epoch 2749 
Overall Loss: 12.813613
Rec Loss: 5.672266
KL Loss: 7.141347
Y Loss: 0.798008
T Loss: 10.823998
X Loss: -5.550736
Epoch 2799 
Overall Loss: 12.790224
Rec Loss: 5.663218
KL Loss: 7.127006
Y Loss: 0.807567
T Loss: 10.822101
X Loss: -5.562666
Epoch 2849 
Overall Loss: 12.798158
Rec Loss: 5.639906
KL Loss: 7.158253
Y Loss: 0.811014
T Loss: 10.814808
X Loss: -5.580409
Epoch 2899 
Overall Loss: 12.803999
Rec Loss: 5.643782
KL Loss: 7.160217
Y Loss: 0.795865
T Loss: 10.840364
X Loss: -5.594514
Epoch 2949 
Overall Loss: 12.801450
Rec Loss: 5.617170
KL Loss: 7.184281
Y Loss: 0.808651
T Loss: 10.832019
X Loss: -5.619175
Epoch 2999 
Overall Loss: 12.798652
Rec Loss: 5.596181
KL Loss: 7.202471
Y Loss: 0.807925
T Loss: 10.812847
X Loss: -5.620629
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.355004
Epoch 99
Rec Loss: 1.340494
Epoch 149
Rec Loss: 1.342780
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 1.994631
Epoch 99
Rec Loss: 1.987145
Epoch 149
Rec Loss: 1.988023
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.599041
Insample Error 2.246137
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.726344
Epoch 99 
Prediction Loss: 0.639444
Epoch 149 
Prediction Loss: 0.603855
Epoch 199 
Prediction Loss: 0.587337
Epoch 249 
Prediction Loss: 0.539904
Epoch 299 
Prediction Loss: 0.516847
Epoch 349 
Prediction Loss: 0.511636
Epoch 399 
Prediction Loss: 0.494765
Epoch 449 
Prediction Loss: 0.486474
Epoch 499 
Prediction Loss: 0.451028
Epoch 549 
Prediction Loss: 0.449500
Epoch 599 
Prediction Loss: 0.427924
Epoch 649 
Prediction Loss: 0.412837
Epoch 699 
Prediction Loss: 0.399165
Epoch 749 
Prediction Loss: 0.400479
Epoch 799 
Prediction Loss: 0.372214
Epoch 849 
Prediction Loss: 0.359797
Epoch 899 
Prediction Loss: 0.362019
Epoch 949 
Prediction Loss: 0.337743
Epoch 999 
Prediction Loss: 0.338363
Epoch 1049 
Prediction Loss: 0.339186
Epoch 1099 
Prediction Loss: 0.313286
Epoch 1149 
Prediction Loss: 0.322953
Epoch 1199 
Prediction Loss: 0.301144
Epoch 1249 
Prediction Loss: 0.298788
Epoch 1299 
Prediction Loss: 0.279481
Epoch 1349 
Prediction Loss: 0.279837
Epoch 1399 
Prediction Loss: 0.280646
Epoch 1449 
Prediction Loss: 0.260827
Epoch 1499 
Prediction Loss: 0.272552
Epoch 1549 
Prediction Loss: 0.262301
Epoch 1599 
Prediction Loss: 0.243945
Epoch 1649 
Prediction Loss: 0.276990
Epoch 1699 
Prediction Loss: 0.238084
Epoch 1749 
Prediction Loss: 0.250923
Epoch 1799 
Prediction Loss: 0.235177
Epoch 1849 
Prediction Loss: 0.241397
Epoch 1899 
Prediction Loss: 0.240628
Epoch 1949 
Prediction Loss: 0.220023
Epoch 1999 
Prediction Loss: 0.220473
Epoch 2049 
Prediction Loss: 0.223784
Epoch 2099 
Prediction Loss: 0.218328
Epoch 2149 
Prediction Loss: 0.238418
Epoch 2199 
Prediction Loss: 0.223557
Epoch 2249 
Prediction Loss: 0.210728
Epoch 2299 
Prediction Loss: 0.200593
Epoch 2349 
Prediction Loss: 0.206789
Epoch 2399 
Prediction Loss: 0.219064
Epoch 2449 
Prediction Loss: 0.199176
Epoch 2499 
Prediction Loss: 0.220387
Epoch 2549 
Prediction Loss: 0.190071
Epoch 2599 
Prediction Loss: 0.186143
Epoch 2649 
Prediction Loss: 0.190143
Epoch 2699 
Prediction Loss: 0.192176
Epoch 2749 
Prediction Loss: 0.192131
Epoch 2799 
Prediction Loss: 0.180396
Epoch 2849 
Prediction Loss: 0.180768
Epoch 2899 
Prediction Loss: 0.184461
Epoch 2949 
Prediction Loss: 0.188766
Epoch 2999 
Prediction Loss: 0.176984
Epoch 3049 
Prediction Loss: 0.192692
Epoch 3099 
Prediction Loss: 0.184464
Epoch 3149 
Prediction Loss: 0.177391
Epoch 3199 
Prediction Loss: 0.171373
Epoch 3249 
Prediction Loss: 0.180663
Epoch 3299 
Prediction Loss: 0.171444
Epoch 3349 
Prediction Loss: 0.174370
Epoch 3399 
Prediction Loss: 0.178212
Epoch 3449 
Prediction Loss: 0.178842
Epoch 3499 
Prediction Loss: 0.179899
Epoch 3549 
Prediction Loss: 0.169556
Epoch 3599 
Prediction Loss: 0.167826
Epoch 3649 
Prediction Loss: 0.170975
Epoch 3699 
Prediction Loss: 0.164590
Epoch 3749 
Prediction Loss: 0.156596
Epoch 3799 
Prediction Loss: 0.163305
Epoch 3849 
Prediction Loss: 0.163678
Epoch 3899 
Prediction Loss: 0.157016
Epoch 3949 
Prediction Loss: 0.155114
Epoch 3999 
Prediction Loss: 0.178937
Epoch 4049 
Prediction Loss: 0.160749
Epoch 4099 
Prediction Loss: 0.156085
Epoch 4149 
Prediction Loss: 0.153930
Epoch 4199 
Prediction Loss: 0.174072
Epoch 4249 
Prediction Loss: 0.177385
Epoch 4299 
Prediction Loss: 0.153339
Epoch 4349 
Prediction Loss: 0.162427
Epoch 4399 
Prediction Loss: 0.155097
Epoch 4449 
Prediction Loss: 0.150895
Epoch 4499 
Prediction Loss: 0.156483
Epoch 4549 
Prediction Loss: 0.156951
Epoch 4599 
Prediction Loss: 0.156542
Epoch 4649 
Prediction Loss: 0.160214
Epoch 4699 
Prediction Loss: 0.149713
Epoch 4749 
Prediction Loss: 0.149007
Epoch 4799 
Prediction Loss: 0.152922
Epoch 4849 
Prediction Loss: 0.156193
Epoch 4899 
Prediction Loss: 0.153115
Epoch 4949 
Prediction Loss: 0.158238
Epoch 4999 
Prediction Loss: 0.149171
Epoch 5049 
Prediction Loss: 0.157702
Epoch 5099 
Prediction Loss: 0.149885
Epoch 5149 
Prediction Loss: 0.148549
Epoch 5199 
Prediction Loss: 0.145708
Epoch 5249 
Prediction Loss: 0.147538
Epoch 5299 
Prediction Loss: 0.152804
Epoch 5349 
Prediction Loss: 0.143198
Epoch 5399 
Prediction Loss: 0.158067
Epoch 5449 
Prediction Loss: 0.165862
Epoch 5499 
Prediction Loss: 0.151498
Epoch 5549 
Prediction Loss: 0.145913
Epoch 5599 
Prediction Loss: 0.148353
Epoch 5649 
Prediction Loss: 0.142623
Epoch 5699 
Prediction Loss: 0.139220
Epoch 5749 
Prediction Loss: 0.140143
Epoch 5799 
Prediction Loss: 0.142374
Epoch 5849 
Prediction Loss: 0.139298
Epoch 5899 
Prediction Loss: 0.142743
Epoch 5949 
Prediction Loss: 0.143125
Epoch 5999 
Prediction Loss: 0.138725
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.377291
Insample Error 1.940418
[31m========== repeat time 9 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.833449
Rec Loss: 10.734060
KL Loss: 1.099389
Y Loss: 0.902259
T Loss: 10.282930
Epoch 99 
Overall Loss: 11.591781
Rec Loss: 10.712003
KL Loss: 0.879779
Y Loss: 0.687079
T Loss: 10.368463
Epoch 149 
Overall Loss: 11.506483
Rec Loss: 10.706639
KL Loss: 0.799844
Y Loss: 0.622851
T Loss: 10.395214
Epoch 199 
Overall Loss: 11.465749
Rec Loss: 10.686872
KL Loss: 0.778877
Y Loss: 0.587801
T Loss: 10.392971
Epoch 249 
Overall Loss: 11.452486
Rec Loss: 10.694708
KL Loss: 0.757779
Y Loss: 0.580602
T Loss: 10.404407
Epoch 299 
Overall Loss: 11.427886
Rec Loss: 10.691745
KL Loss: 0.736142
Y Loss: 0.568872
T Loss: 10.407309
Epoch 349 
Overall Loss: 11.409911
Rec Loss: 10.696922
KL Loss: 0.712989
Y Loss: 0.570413
T Loss: 10.411716
Epoch 399 
Overall Loss: 11.397506
Rec Loss: 10.687527
KL Loss: 0.709979
Y Loss: 0.543017
T Loss: 10.416018
Epoch 449 
Overall Loss: 11.372142
Rec Loss: 10.668056
KL Loss: 0.704086
Y Loss: 0.541536
T Loss: 10.397289
Epoch 499 
Overall Loss: 11.371806
Rec Loss: 10.674120
KL Loss: 0.697687
Y Loss: 0.550728
T Loss: 10.398756
Epoch 549 
Overall Loss: 11.366285
Rec Loss: 10.672440
KL Loss: 0.693846
Y Loss: 0.533424
T Loss: 10.405727
Epoch 599 
Overall Loss: 11.356248
Rec Loss: 10.665961
KL Loss: 0.690288
Y Loss: 0.530862
T Loss: 10.400530
Epoch 649 
Overall Loss: 11.348681
Rec Loss: 10.650587
KL Loss: 0.698094
Y Loss: 0.525528
T Loss: 10.387823
Epoch 699 
Overall Loss: 11.354628
Rec Loss: 10.669796
KL Loss: 0.684832
Y Loss: 0.532206
T Loss: 10.403694
Epoch 749 
Overall Loss: 11.333021
Rec Loss: 10.650168
KL Loss: 0.682852
Y Loss: 0.518857
T Loss: 10.390740
Epoch 799 
Overall Loss: 11.349095
Rec Loss: 10.648742
KL Loss: 0.700353
Y Loss: 0.517478
T Loss: 10.390003
Epoch 849 
Overall Loss: 11.321161
Rec Loss: 10.636712
KL Loss: 0.684448
Y Loss: 0.516610
T Loss: 10.378408
Epoch 899 
Overall Loss: 11.322324
Rec Loss: 10.638974
KL Loss: 0.683349
Y Loss: 0.516514
T Loss: 10.380718
Epoch 949 
Overall Loss: 11.309499
Rec Loss: 10.633320
KL Loss: 0.676179
Y Loss: 0.509090
T Loss: 10.378775
Epoch 999 
Overall Loss: 11.298490
Rec Loss: 10.630951
KL Loss: 0.667539
Y Loss: 0.505469
T Loss: 10.378217
Epoch 1049 
Overall Loss: 11.307311
Rec Loss: 10.618779
KL Loss: 0.688532
Y Loss: 0.498684
T Loss: 10.369437
Epoch 1099 
Overall Loss: 11.297517
Rec Loss: 10.617384
KL Loss: 0.680134
Y Loss: 0.494386
T Loss: 10.370191
Epoch 1149 
Overall Loss: 11.305096
Rec Loss: 10.612831
KL Loss: 0.692265
Y Loss: 0.510712
T Loss: 10.357475
Epoch 1199 
Overall Loss: 11.283980
Rec Loss: 10.618970
KL Loss: 0.665010
Y Loss: 0.504593
T Loss: 10.366674
Epoch 1249 
Overall Loss: 11.280929
Rec Loss: 10.601240
KL Loss: 0.679689
Y Loss: 0.493771
T Loss: 10.354354
Epoch 1299 
Overall Loss: 11.279910
Rec Loss: 10.613488
KL Loss: 0.666422
Y Loss: 0.508686
T Loss: 10.359145
Epoch 1349 
Overall Loss: 11.286821
Rec Loss: 10.613076
KL Loss: 0.673746
Y Loss: 0.497004
T Loss: 10.364574
Epoch 1399 
Overall Loss: 11.256744
Rec Loss: 10.586195
KL Loss: 0.670549
Y Loss: 0.481067
T Loss: 10.345661
Epoch 1449 
Overall Loss: 11.271620
Rec Loss: 10.603399
KL Loss: 0.668221
Y Loss: 0.486048
T Loss: 10.360374
Epoch 1499 
Overall Loss: 11.267386
Rec Loss: 10.597180
KL Loss: 0.670206
Y Loss: 0.502830
T Loss: 10.345765
Epoch 1549 
Overall Loss: 11.256035
Rec Loss: 10.576997
KL Loss: 0.679038
Y Loss: 0.478717
T Loss: 10.337639
Epoch 1599 
Overall Loss: 11.247015
Rec Loss: 10.576386
KL Loss: 0.670629
Y Loss: 0.478850
T Loss: 10.336961
Epoch 1649 
Overall Loss: 11.239161
Rec Loss: 10.567322
KL Loss: 0.671839
Y Loss: 0.480974
T Loss: 10.326835
Epoch 1699 
Overall Loss: 11.249111
Rec Loss: 10.580675
KL Loss: 0.668436
Y Loss: 0.480932
T Loss: 10.340209
Epoch 1749 
Overall Loss: 11.246680
Rec Loss: 10.576905
KL Loss: 0.669775
Y Loss: 0.478631
T Loss: 10.337590
Epoch 1799 
Overall Loss: 11.240844
Rec Loss: 10.573081
KL Loss: 0.667763
Y Loss: 0.478372
T Loss: 10.333895
Epoch 1849 
Overall Loss: 11.236720
Rec Loss: 10.564991
KL Loss: 0.671729
Y Loss: 0.470248
T Loss: 10.329867
Epoch 1899 
Overall Loss: 11.228066
Rec Loss: 10.562171
KL Loss: 0.665895
Y Loss: 0.465940
T Loss: 10.329201
Epoch 1949 
Overall Loss: 11.224928
Rec Loss: 10.551098
KL Loss: 0.673830
Y Loss: 0.469587
T Loss: 10.316304
Epoch 1999 
Overall Loss: 11.232035
Rec Loss: 10.555250
KL Loss: 0.676785
Y Loss: 0.469042
T Loss: 10.320729
Epoch 2049 
Overall Loss: 11.217408
Rec Loss: 10.558332
KL Loss: 0.659076
Y Loss: 0.474637
T Loss: 10.321013
Epoch 2099 
Overall Loss: 11.226858
Rec Loss: 10.570985
KL Loss: 0.655873
Y Loss: 0.463763
T Loss: 10.339103
Epoch 2149 
Overall Loss: 11.211352
Rec Loss: 10.536670
KL Loss: 0.674683
Y Loss: 0.471877
T Loss: 10.300731
Epoch 2199 
Overall Loss: 11.212404
Rec Loss: 10.559973
KL Loss: 0.652431
Y Loss: 0.461384
T Loss: 10.329281
Epoch 2249 
Overall Loss: 11.200342
Rec Loss: 10.540910
KL Loss: 0.659432
Y Loss: 0.456830
T Loss: 10.312496
Epoch 2299 
Overall Loss: 11.206904
Rec Loss: 10.542704
KL Loss: 0.664200
Y Loss: 0.450455
T Loss: 10.317476
Epoch 2349 
Overall Loss: 11.210697
Rec Loss: 10.546948
KL Loss: 0.663749
Y Loss: 0.454882
T Loss: 10.319507
Epoch 2399 
Overall Loss: 11.199280
Rec Loss: 10.531606
KL Loss: 0.667674
Y Loss: 0.463553
T Loss: 10.299830
Epoch 2449 
Overall Loss: 11.196436
Rec Loss: 10.519059
KL Loss: 0.677377
Y Loss: 0.451843
T Loss: 10.293137
Epoch 2499 
Overall Loss: 11.185088
Rec Loss: 10.525733
KL Loss: 0.659354
Y Loss: 0.448734
T Loss: 10.301366
Epoch 2549 
Overall Loss: 11.184135
Rec Loss: 10.512710
KL Loss: 0.671425
Y Loss: 0.441614
T Loss: 10.291903
Epoch 2599 
Overall Loss: 11.177070
Rec Loss: 10.519549
KL Loss: 0.657521
Y Loss: 0.451339
T Loss: 10.293880
Epoch 2649 
Overall Loss: 11.182313
Rec Loss: 10.514734
KL Loss: 0.667578
Y Loss: 0.459416
T Loss: 10.285027
Epoch 2699 
Overall Loss: 11.168527
Rec Loss: 10.504193
KL Loss: 0.664334
Y Loss: 0.442781
T Loss: 10.282803
Epoch 2749 
Overall Loss: 11.183175
Rec Loss: 10.502225
KL Loss: 0.680949
Y Loss: 0.443871
T Loss: 10.280289
Epoch 2799 
Overall Loss: 11.167149
Rec Loss: 10.503253
KL Loss: 0.663895
Y Loss: 0.438976
T Loss: 10.283765
Epoch 2849 
Overall Loss: 11.177570
Rec Loss: 10.509701
KL Loss: 0.667868
Y Loss: 0.452756
T Loss: 10.283324
Epoch 2899 
Overall Loss: 11.162780
Rec Loss: 10.508077
KL Loss: 0.654704
Y Loss: 0.448792
T Loss: 10.283681
Epoch 2949 
Overall Loss: 11.154372
Rec Loss: 10.497460
KL Loss: 0.656912
Y Loss: 0.445882
T Loss: 10.274519
Epoch 2999 
Overall Loss: 11.169236
Rec Loss: 10.500402
KL Loss: 0.668834
Y Loss: 0.442886
T Loss: 10.278959
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.425661
Epoch 99
Rec Loss: 0.417504
Epoch 149
Rec Loss: 0.420204
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.918458
Epoch 99
Rec Loss: 9.897457
Epoch 149
Rec Loss: 9.888148
Epoch 199
Rec Loss: 9.862155
Epoch 249
Rec Loss: 9.860539
Epoch 299
Rec Loss: 9.861388
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.608630
Insample Error: 1.426411
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.875850
Rec Loss: 19.799572
KL Loss: 3.076279
Y Loss: 10.404085
T Loss: 12.887496
X Loss: 1.710033
Epoch 99 
Overall Loss: 17.471551
Rec Loss: 13.860371
KL Loss: 3.611180
Y Loss: 3.062442
T Loss: 12.798251
X Loss: -0.469101
Epoch 149 
Overall Loss: 16.126117
Rec Loss: 12.420410
KL Loss: 3.705706
Y Loss: 2.136607
T Loss: 12.579592
X Loss: -1.227485
Epoch 199 
Overall Loss: 15.179316
Rec Loss: 11.045462
KL Loss: 4.133855
Y Loss: 1.736557
T Loss: 12.065965
X Loss: -1.888782
Epoch 249 
Overall Loss: 14.534573
Rec Loss: 10.040168
KL Loss: 4.494405
Y Loss: 1.467362
T Loss: 11.636776
X Loss: -2.330289
Epoch 299 
Overall Loss: 14.304931
Rec Loss: 9.658334
KL Loss: 4.646597
Y Loss: 1.348649
T Loss: 11.530606
X Loss: -2.546596
Epoch 349 
Overall Loss: 14.131237
Rec Loss: 9.364517
KL Loss: 4.766719
Y Loss: 1.328717
T Loss: 11.476819
X Loss: -2.776660
Epoch 399 
Overall Loss: 13.935148
Rec Loss: 8.996310
KL Loss: 4.938838
Y Loss: 1.239289
T Loss: 11.407643
X Loss: -3.030977
Epoch 449 
Overall Loss: 13.692249
Rec Loss: 8.512690
KL Loss: 5.179559
Y Loss: 1.124223
T Loss: 11.208352
X Loss: -3.257774
Epoch 499 
Overall Loss: 13.406543
Rec Loss: 7.781849
KL Loss: 5.624694
Y Loss: 1.072845
T Loss: 10.791513
X Loss: -3.546086
Epoch 549 
Overall Loss: 13.343568
Rec Loss: 7.555202
KL Loss: 5.788366
Y Loss: 1.033336
T Loss: 10.720163
X Loss: -3.681629
Epoch 599 
Overall Loss: 13.219373
Rec Loss: 7.361920
KL Loss: 5.857453
Y Loss: 0.981473
T Loss: 10.687712
X Loss: -3.816530
Epoch 649 
Overall Loss: 13.176772
Rec Loss: 7.234125
KL Loss: 5.942646
Y Loss: 0.961482
T Loss: 10.671949
X Loss: -3.918564
Epoch 699 
Overall Loss: 13.143289
Rec Loss: 7.170528
KL Loss: 5.972761
Y Loss: 0.966916
T Loss: 10.642893
X Loss: -3.955823
Epoch 749 
Overall Loss: 13.127488
Rec Loss: 7.068048
KL Loss: 6.059440
Y Loss: 0.903736
T Loss: 10.656632
X Loss: -4.040453
Epoch 799 
Overall Loss: 13.098854
Rec Loss: 7.059873
KL Loss: 6.038981
Y Loss: 0.906316
T Loss: 10.668512
X Loss: -4.061797
Epoch 849 
Overall Loss: 13.066719
Rec Loss: 6.990086
KL Loss: 6.076633
Y Loss: 0.903779
T Loss: 10.662752
X Loss: -4.124555
Epoch 899 
Overall Loss: 13.067768
Rec Loss: 6.980644
KL Loss: 6.087124
Y Loss: 0.882497
T Loss: 10.686581
X Loss: -4.147185
Epoch 949 
Overall Loss: 12.997588
Rec Loss: 6.891270
KL Loss: 6.106318
Y Loss: 0.889365
T Loss: 10.670119
X Loss: -4.223531
Epoch 999 
Overall Loss: 12.998673
Rec Loss: 6.823300
KL Loss: 6.175374
Y Loss: 0.865390
T Loss: 10.665763
X Loss: -4.275158
Epoch 1049 
Overall Loss: 13.011579
Rec Loss: 6.821398
KL Loss: 6.190180
Y Loss: 0.866756
T Loss: 10.677173
X Loss: -4.289153
Epoch 1099 
Overall Loss: 12.989222
Rec Loss: 6.774934
KL Loss: 6.214288
Y Loss: 0.878192
T Loss: 10.694340
X Loss: -4.358501
Epoch 1149 
Overall Loss: 12.982953
Rec Loss: 6.739083
KL Loss: 6.243871
Y Loss: 0.862730
T Loss: 10.686969
X Loss: -4.379251
Epoch 1199 
Overall Loss: 12.972346
Rec Loss: 6.713073
KL Loss: 6.259273
Y Loss: 0.865450
T Loss: 10.680964
X Loss: -4.400616
Epoch 1249 
Overall Loss: 12.990004
Rec Loss: 6.669638
KL Loss: 6.320366
Y Loss: 0.863333
T Loss: 10.693844
X Loss: -4.455873
Epoch 1299 
Overall Loss: 12.966762
Rec Loss: 6.668964
KL Loss: 6.297797
Y Loss: 0.885483
T Loss: 10.681881
X Loss: -4.455658
Epoch 1349 
Overall Loss: 12.936728
Rec Loss: 6.551844
KL Loss: 6.384884
Y Loss: 0.845979
T Loss: 10.688712
X Loss: -4.559858
Epoch 1399 
Overall Loss: 12.921668
Rec Loss: 6.544196
KL Loss: 6.377472
Y Loss: 0.844002
T Loss: 10.697392
X Loss: -4.575197
Epoch 1449 
Overall Loss: 12.929511
Rec Loss: 6.538597
KL Loss: 6.390914
Y Loss: 0.856590
T Loss: 10.718096
X Loss: -4.607794
Epoch 1499 
Overall Loss: 12.909459
Rec Loss: 6.505539
KL Loss: 6.403920
Y Loss: 0.862154
T Loss: 10.709984
X Loss: -4.635522
Epoch 1549 
Overall Loss: 12.906418
Rec Loss: 6.464891
KL Loss: 6.441527
Y Loss: 0.843632
T Loss: 10.724104
X Loss: -4.681029
Epoch 1599 
Overall Loss: 12.912243
Rec Loss: 6.454247
KL Loss: 6.457995
Y Loss: 0.870770
T Loss: 10.731754
X Loss: -4.712892
Epoch 1649 
Overall Loss: 12.880493
Rec Loss: 6.405196
KL Loss: 6.475297
Y Loss: 0.831745
T Loss: 10.721064
X Loss: -4.731740
Epoch 1699 
Overall Loss: 12.887046
Rec Loss: 6.397300
KL Loss: 6.489746
Y Loss: 0.865218
T Loss: 10.722067
X Loss: -4.757376
Epoch 1749 
Overall Loss: 12.856405
Rec Loss: 6.337986
KL Loss: 6.518419
Y Loss: 0.839672
T Loss: 10.721356
X Loss: -4.803205
Epoch 1799 
Overall Loss: 12.882646
Rec Loss: 6.360169
KL Loss: 6.522477
Y Loss: 0.822031
T Loss: 10.740790
X Loss: -4.791637
Epoch 1849 
Overall Loss: 12.860698
Rec Loss: 6.310190
KL Loss: 6.550508
Y Loss: 0.828780
T Loss: 10.739477
X Loss: -4.843677
Epoch 1899 
Overall Loss: 12.877859
Rec Loss: 6.273782
KL Loss: 6.604076
Y Loss: 0.826888
T Loss: 10.731191
X Loss: -4.870853
Epoch 1949 
Overall Loss: 12.864596
Rec Loss: 6.248050
KL Loss: 6.616547
Y Loss: 0.840050
T Loss: 10.746471
X Loss: -4.918447
Epoch 1999 
Overall Loss: 12.866335
Rec Loss: 6.252721
KL Loss: 6.613615
Y Loss: 0.835557
T Loss: 10.739819
X Loss: -4.904877
Epoch 2049 
Overall Loss: 12.813379
Rec Loss: 6.196286
KL Loss: 6.617092
Y Loss: 0.844028
T Loss: 10.748327
X Loss: -4.974055
Epoch 2099 
Overall Loss: 12.838220
Rec Loss: 6.185626
KL Loss: 6.652594
Y Loss: 0.831946
T Loss: 10.752090
X Loss: -4.982436
Epoch 2149 
Overall Loss: 12.826321
Rec Loss: 6.122050
KL Loss: 6.704272
Y Loss: 0.826461
T Loss: 10.735715
X Loss: -5.026896
Epoch 2199 
Overall Loss: 12.807888
Rec Loss: 6.091916
KL Loss: 6.715972
Y Loss: 0.828758
T Loss: 10.741773
X Loss: -5.064236
Epoch 2249 
Overall Loss: 12.777881
Rec Loss: 6.083351
KL Loss: 6.694530
Y Loss: 0.813153
T Loss: 10.753136
X Loss: -5.076361
Epoch 2299 
Overall Loss: 12.859477
Rec Loss: 6.117855
KL Loss: 6.741622
Y Loss: 0.824810
T Loss: 10.758062
X Loss: -5.052612
Epoch 2349 
Overall Loss: 12.861365
Rec Loss: 6.095689
KL Loss: 6.765676
Y Loss: 0.828664
T Loss: 10.765060
X Loss: -5.083702
Epoch 2399 
Overall Loss: 12.789718
Rec Loss: 6.050086
KL Loss: 6.739632
Y Loss: 0.823644
T Loss: 10.758399
X Loss: -5.120135
Epoch 2449 
Overall Loss: 12.806183
Rec Loss: 6.005097
KL Loss: 6.801086
Y Loss: 0.817245
T Loss: 10.749930
X Loss: -5.153456
Epoch 2499 
Overall Loss: 12.819251
Rec Loss: 6.002421
KL Loss: 6.816830
Y Loss: 0.811976
T Loss: 10.766633
X Loss: -5.170200
Epoch 2549 
Overall Loss: 12.792696
Rec Loss: 5.946710
KL Loss: 6.845985
Y Loss: 0.824911
T Loss: 10.772980
X Loss: -5.238725
Epoch 2599 
Overall Loss: 12.797628
Rec Loss: 5.949651
KL Loss: 6.847976
Y Loss: 0.817738
T Loss: 10.779019
X Loss: -5.238237
Epoch 2649 
Overall Loss: 12.798627
Rec Loss: 5.917911
KL Loss: 6.880715
Y Loss: 0.829912
T Loss: 10.762429
X Loss: -5.259474
Epoch 2699 
Overall Loss: 12.782384
Rec Loss: 5.909890
KL Loss: 6.872494
Y Loss: 0.834165
T Loss: 10.783493
X Loss: -5.290686
Epoch 2749 
Overall Loss: 12.790882
Rec Loss: 5.895874
KL Loss: 6.895008
Y Loss: 0.835694
T Loss: 10.772574
X Loss: -5.294547
Epoch 2799 
Overall Loss: 12.757208
Rec Loss: 5.834337
KL Loss: 6.922871
Y Loss: 0.836365
T Loss: 10.776289
X Loss: -5.360135
Epoch 2849 
Overall Loss: 12.757176
Rec Loss: 5.822333
KL Loss: 6.934843
Y Loss: 0.833149
T Loss: 10.780783
X Loss: -5.375025
Epoch 2899 
Overall Loss: 12.761476
Rec Loss: 5.820041
KL Loss: 6.941435
Y Loss: 0.835017
T Loss: 10.781705
X Loss: -5.379172
Epoch 2949 
Overall Loss: 12.798492
Rec Loss: 5.814465
KL Loss: 6.984027
Y Loss: 0.822946
T Loss: 10.783679
X Loss: -5.380687
Epoch 2999 
Overall Loss: 12.782159
Rec Loss: 5.794752
KL Loss: 6.987407
Y Loss: 0.819814
T Loss: 10.789081
X Loss: -5.404236
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.411021
Epoch 99
Rec Loss: 1.399061
Epoch 149
Rec Loss: 1.402147
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.015026
Epoch 99
Rec Loss: 1.999084
Epoch 149
Rec Loss: 1.998333
Epoch 199
Rec Loss: 1.996773
Epoch 249
Rec Loss: 1.998354
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.675877
Insample Error 2.216974
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.756312
Epoch 99 
Prediction Loss: 0.648120
Epoch 149 
Prediction Loss: 0.605045
Epoch 199 
Prediction Loss: 0.571300
Epoch 249 
Prediction Loss: 0.557752
Epoch 299 
Prediction Loss: 0.538499
Epoch 349 
Prediction Loss: 0.537001
Epoch 399 
Prediction Loss: 0.511687
Epoch 449 
Prediction Loss: 0.479414
Epoch 499 
Prediction Loss: 0.463685
Epoch 549 
Prediction Loss: 0.479795
Epoch 599 
Prediction Loss: 0.442916
Epoch 649 
Prediction Loss: 0.422075
Epoch 699 
Prediction Loss: 0.425792
Epoch 749 
Prediction Loss: 0.450800
Epoch 799 
Prediction Loss: 0.393404
Epoch 849 
Prediction Loss: 0.392485
Epoch 899 
Prediction Loss: 0.369366
Epoch 949 
Prediction Loss: 0.354516
Epoch 999 
Prediction Loss: 0.355243
Epoch 1049 
Prediction Loss: 0.337870
Epoch 1099 
Prediction Loss: 0.346448
Epoch 1149 
Prediction Loss: 0.322029
Epoch 1199 
Prediction Loss: 0.326911
Epoch 1249 
Prediction Loss: 0.298652
Epoch 1299 
Prediction Loss: 0.301092
Epoch 1349 
Prediction Loss: 0.295836
Epoch 1399 
Prediction Loss: 0.281318
Epoch 1449 
Prediction Loss: 0.279137
Epoch 1499 
Prediction Loss: 0.277484
Epoch 1549 
Prediction Loss: 0.265171
Epoch 1599 
Prediction Loss: 0.258696
Epoch 1649 
Prediction Loss: 0.253751
Epoch 1699 
Prediction Loss: 0.248389
Epoch 1749 
Prediction Loss: 0.250093
Epoch 1799 
Prediction Loss: 0.265559
Epoch 1849 
Prediction Loss: 0.233075
Epoch 1899 
Prediction Loss: 0.237613
Epoch 1949 
Prediction Loss: 0.227718
Epoch 1999 
Prediction Loss: 0.228657
Epoch 2049 
Prediction Loss: 0.226734
Epoch 2099 
Prediction Loss: 0.224741
Epoch 2149 
Prediction Loss: 0.213714
Epoch 2199 
Prediction Loss: 0.211762
Epoch 2249 
Prediction Loss: 0.230851
Epoch 2299 
Prediction Loss: 0.222020
Epoch 2349 
Prediction Loss: 0.206797
Epoch 2399 
Prediction Loss: 0.214883
Epoch 2449 
Prediction Loss: 0.213599
Epoch 2499 
Prediction Loss: 0.195348
Epoch 2549 
Prediction Loss: 0.195658
Epoch 2599 
Prediction Loss: 0.200964
Epoch 2649 
Prediction Loss: 0.205633
Epoch 2699 
Prediction Loss: 0.202582
Epoch 2749 
Prediction Loss: 0.201087
Epoch 2799 
Prediction Loss: 0.196046
Epoch 2849 
Prediction Loss: 0.192741
Epoch 2899 
Prediction Loss: 0.193425
Epoch 2949 
Prediction Loss: 0.181253
Epoch 2999 
Prediction Loss: 0.183885
Epoch 3049 
Prediction Loss: 0.181149
Epoch 3099 
Prediction Loss: 0.178183
Epoch 3149 
Prediction Loss: 0.179933
Epoch 3199 
Prediction Loss: 0.177646
Epoch 3249 
Prediction Loss: 0.173791
Epoch 3299 
Prediction Loss: 0.175645
Epoch 3349 
Prediction Loss: 0.168724
Epoch 3399 
Prediction Loss: 0.167075
Epoch 3449 
Prediction Loss: 0.169387
Epoch 3499 
Prediction Loss: 0.170356
Epoch 3549 
Prediction Loss: 0.170259
Epoch 3599 
Prediction Loss: 0.168254
Epoch 3649 
Prediction Loss: 0.172240
Epoch 3699 
Prediction Loss: 0.172485
Epoch 3749 
Prediction Loss: 0.164795
Epoch 3799 
Prediction Loss: 0.162324
Epoch 3849 
Prediction Loss: 0.160683
Epoch 3899 
Prediction Loss: 0.156811
Epoch 3949 
Prediction Loss: 0.161646
Epoch 3999 
Prediction Loss: 0.156120
Epoch 4049 
Prediction Loss: 0.152865
Epoch 4099 
Prediction Loss: 0.157416
Epoch 4149 
Prediction Loss: 0.170592
Epoch 4199 
Prediction Loss: 0.156209
Epoch 4249 
Prediction Loss: 0.159108
Epoch 4299 
Prediction Loss: 0.154867
Epoch 4349 
Prediction Loss: 0.164261
Epoch 4399 
Prediction Loss: 0.153798
Epoch 4449 
Prediction Loss: 0.157687
Epoch 4499 
Prediction Loss: 0.163871
Epoch 4549 
Prediction Loss: 0.160782
Epoch 4599 
Prediction Loss: 0.149520
Epoch 4649 
Prediction Loss: 0.153014
Epoch 4699 
Prediction Loss: 0.151270
Epoch 4749 
Prediction Loss: 0.147360
Epoch 4799 
Prediction Loss: 0.143757
Epoch 4849 
Prediction Loss: 0.145701
Epoch 4899 
Prediction Loss: 0.152019
Epoch 4949 
Prediction Loss: 0.158919
Epoch 4999 
Prediction Loss: 0.152625
Epoch 5049 
Prediction Loss: 0.146617
Epoch 5099 
Prediction Loss: 0.141459
Epoch 5149 
Prediction Loss: 0.141787
Epoch 5199 
Prediction Loss: 0.149274
Epoch 5249 
Prediction Loss: 0.150076
Epoch 5299 
Prediction Loss: 0.140359
Epoch 5349 
Prediction Loss: 0.142278
Epoch 5399 
Prediction Loss: 0.145426
Epoch 5449 
Prediction Loss: 0.144143
Epoch 5499 
Prediction Loss: 0.141993
Epoch 5549 
Prediction Loss: 0.144151
Epoch 5599 
Prediction Loss: 0.152248
Epoch 5649 
Prediction Loss: 0.143933
Epoch 5699 
Prediction Loss: 0.141954
Epoch 5749 
Prediction Loss: 0.147512
Epoch 5799 
Prediction Loss: 0.146209
Epoch 5849 
Prediction Loss: 0.142489
Epoch 5899 
Prediction Loss: 0.140122
Epoch 5949 
Prediction Loss: 0.137940
Epoch 5999 
Prediction Loss: 0.137918
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.362422
Insample Error 1.824533
[31m========== repeat time 10 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.895633
Rec Loss: 10.807745
KL Loss: 1.087887
Y Loss: 0.986057
T Loss: 10.314717
Epoch 99 
Overall Loss: 11.651110
Rec Loss: 10.721596
KL Loss: 0.929513
Y Loss: 0.722831
T Loss: 10.360181
Epoch 149 
Overall Loss: 11.518274
Rec Loss: 10.696068
KL Loss: 0.822206
Y Loss: 0.614656
T Loss: 10.388740
Epoch 199 
Overall Loss: 11.469693
Rec Loss: 10.698828
KL Loss: 0.770864
Y Loss: 0.577915
T Loss: 10.409870
Epoch 249 
Overall Loss: 11.440176
Rec Loss: 10.691503
KL Loss: 0.748673
Y Loss: 0.578882
T Loss: 10.402062
Epoch 299 
Overall Loss: 11.437677
Rec Loss: 10.692161
KL Loss: 0.745516
Y Loss: 0.569878
T Loss: 10.407222
Epoch 349 
Overall Loss: 11.415718
Rec Loss: 10.701815
KL Loss: 0.713903
Y Loss: 0.564914
T Loss: 10.419358
Epoch 399 
Overall Loss: 11.388774
Rec Loss: 10.675650
KL Loss: 0.713125
Y Loss: 0.543352
T Loss: 10.403974
Epoch 449 
Overall Loss: 11.365971
Rec Loss: 10.664104
KL Loss: 0.701866
Y Loss: 0.546745
T Loss: 10.390732
Epoch 499 
Overall Loss: 11.382625
Rec Loss: 10.669142
KL Loss: 0.713482
Y Loss: 0.540501
T Loss: 10.398892
Epoch 549 
Overall Loss: 11.367701
Rec Loss: 10.669560
KL Loss: 0.698141
Y Loss: 0.535546
T Loss: 10.401787
Epoch 599 
Overall Loss: 11.357893
Rec Loss: 10.674625
KL Loss: 0.683268
Y Loss: 0.528350
T Loss: 10.410450
Epoch 649 
Overall Loss: 11.352670
Rec Loss: 10.658784
KL Loss: 0.693885
Y Loss: 0.536667
T Loss: 10.390451
Epoch 699 
Overall Loss: 11.323422
Rec Loss: 10.653060
KL Loss: 0.670362
Y Loss: 0.521475
T Loss: 10.392322
Epoch 749 
Overall Loss: 11.333726
Rec Loss: 10.625810
KL Loss: 0.707915
Y Loss: 0.519475
T Loss: 10.366073
Epoch 799 
Overall Loss: 11.340749
Rec Loss: 10.650025
KL Loss: 0.690724
Y Loss: 0.521556
T Loss: 10.389247
Epoch 849 
Overall Loss: 11.322708
Rec Loss: 10.623915
KL Loss: 0.698793
Y Loss: 0.506586
T Loss: 10.370621
Epoch 899 
Overall Loss: 11.315399
Rec Loss: 10.628697
KL Loss: 0.686702
Y Loss: 0.501293
T Loss: 10.378051
Epoch 949 
Overall Loss: 11.306949
Rec Loss: 10.628698
KL Loss: 0.678252
Y Loss: 0.500994
T Loss: 10.378200
Epoch 999 
Overall Loss: 11.311238
Rec Loss: 10.628235
KL Loss: 0.683003
Y Loss: 0.500148
T Loss: 10.378161
Epoch 1049 
Overall Loss: 11.304570
Rec Loss: 10.619012
KL Loss: 0.685558
Y Loss: 0.498534
T Loss: 10.369745
Epoch 1099 
Overall Loss: 11.302367
Rec Loss: 10.624215
KL Loss: 0.678152
Y Loss: 0.503583
T Loss: 10.372423
Epoch 1149 
Overall Loss: 11.292783
Rec Loss: 10.606093
KL Loss: 0.686691
Y Loss: 0.478022
T Loss: 10.367082
Epoch 1199 
Overall Loss: 11.284120
Rec Loss: 10.607910
KL Loss: 0.676209
Y Loss: 0.486716
T Loss: 10.364552
Epoch 1249 
Overall Loss: 11.278392
Rec Loss: 10.591463
KL Loss: 0.686929
Y Loss: 0.491734
T Loss: 10.345596
Epoch 1299 
Overall Loss: 11.269336
Rec Loss: 10.580695
KL Loss: 0.688642
Y Loss: 0.475849
T Loss: 10.342770
Epoch 1349 
Overall Loss: 11.277683
Rec Loss: 10.590702
KL Loss: 0.686980
Y Loss: 0.476825
T Loss: 10.352290
Epoch 1399 
Overall Loss: 11.256370
Rec Loss: 10.586521
KL Loss: 0.669849
Y Loss: 0.477708
T Loss: 10.347667
Epoch 1449 
Overall Loss: 11.255011
Rec Loss: 10.583501
KL Loss: 0.671511
Y Loss: 0.482482
T Loss: 10.342260
Epoch 1499 
Overall Loss: 11.246131
Rec Loss: 10.578146
KL Loss: 0.667985
Y Loss: 0.471378
T Loss: 10.342458
Epoch 1549 
Overall Loss: 11.262983
Rec Loss: 10.565572
KL Loss: 0.697411
Y Loss: 0.470680
T Loss: 10.330232
Epoch 1599 
Overall Loss: 11.238252
Rec Loss: 10.576626
KL Loss: 0.661626
Y Loss: 0.472606
T Loss: 10.340323
Epoch 1649 
Overall Loss: 11.228965
Rec Loss: 10.562723
KL Loss: 0.666242
Y Loss: 0.468516
T Loss: 10.328465
Epoch 1699 
Overall Loss: 11.238619
Rec Loss: 10.557442
KL Loss: 0.681177
Y Loss: 0.464977
T Loss: 10.324954
Epoch 1749 
Overall Loss: 11.244664
Rec Loss: 10.567647
KL Loss: 0.677017
Y Loss: 0.464610
T Loss: 10.335342
Epoch 1799 
Overall Loss: 11.225333
Rec Loss: 10.536408
KL Loss: 0.688925
Y Loss: 0.456049
T Loss: 10.308384
Epoch 1849 
Overall Loss: 11.224116
Rec Loss: 10.560173
KL Loss: 0.663943
Y Loss: 0.456345
T Loss: 10.332000
Epoch 1899 
Overall Loss: 11.225607
Rec Loss: 10.558703
KL Loss: 0.666904
Y Loss: 0.464962
T Loss: 10.326221
Epoch 1949 
Overall Loss: 11.208965
Rec Loss: 10.546979
KL Loss: 0.661986
Y Loss: 0.456422
T Loss: 10.318768
Epoch 1999 
Overall Loss: 11.223378
Rec Loss: 10.548356
KL Loss: 0.675022
Y Loss: 0.460970
T Loss: 10.317871
Epoch 2049 
Overall Loss: 11.238609
Rec Loss: 10.543922
KL Loss: 0.694687
Y Loss: 0.462134
T Loss: 10.312856
Epoch 2099 
Overall Loss: 11.202050
Rec Loss: 10.541559
KL Loss: 0.660492
Y Loss: 0.458461
T Loss: 10.312328
Epoch 2149 
Overall Loss: 11.202973
Rec Loss: 10.529259
KL Loss: 0.673714
Y Loss: 0.448204
T Loss: 10.305157
Epoch 2199 
Overall Loss: 11.207417
Rec Loss: 10.540212
KL Loss: 0.667204
Y Loss: 0.455176
T Loss: 10.312624
Epoch 2249 
Overall Loss: 11.207899
Rec Loss: 10.513878
KL Loss: 0.694021
Y Loss: 0.452311
T Loss: 10.287722
Epoch 2299 
Overall Loss: 11.190761
Rec Loss: 10.522863
KL Loss: 0.667898
Y Loss: 0.443532
T Loss: 10.301097
Epoch 2349 
Overall Loss: 11.192138
Rec Loss: 10.516488
KL Loss: 0.675650
Y Loss: 0.441865
T Loss: 10.295555
Epoch 2399 
Overall Loss: 11.190082
Rec Loss: 10.522505
KL Loss: 0.667577
Y Loss: 0.440976
T Loss: 10.302017
Epoch 2449 
Overall Loss: 11.182076
Rec Loss: 10.514284
KL Loss: 0.667791
Y Loss: 0.439783
T Loss: 10.294393
Epoch 2499 
Overall Loss: 11.171222
Rec Loss: 10.500939
KL Loss: 0.670283
Y Loss: 0.430076
T Loss: 10.285901
Epoch 2549 
Overall Loss: 11.181283
Rec Loss: 10.508722
KL Loss: 0.672561
Y Loss: 0.424161
T Loss: 10.296641
Epoch 2599 
Overall Loss: 11.183997
Rec Loss: 10.507673
KL Loss: 0.676323
Y Loss: 0.437976
T Loss: 10.288686
Epoch 2649 
Overall Loss: 11.175656
Rec Loss: 10.507201
KL Loss: 0.668455
Y Loss: 0.442126
T Loss: 10.286138
Epoch 2699 
Overall Loss: 11.155996
Rec Loss: 10.486540
KL Loss: 0.669455
Y Loss: 0.437905
T Loss: 10.267587
Epoch 2749 
Overall Loss: 11.170293
Rec Loss: 10.492142
KL Loss: 0.678151
Y Loss: 0.431571
T Loss: 10.276356
Epoch 2799 
Overall Loss: 11.162164
Rec Loss: 10.487759
KL Loss: 0.674404
Y Loss: 0.426171
T Loss: 10.274674
Epoch 2849 
Overall Loss: 11.142629
Rec Loss: 10.479506
KL Loss: 0.663123
Y Loss: 0.426565
T Loss: 10.266223
Epoch 2899 
Overall Loss: 11.159427
Rec Loss: 10.497013
KL Loss: 0.662414
Y Loss: 0.427550
T Loss: 10.283238
Epoch 2949 
Overall Loss: 11.155749
Rec Loss: 10.481209
KL Loss: 0.674540
Y Loss: 0.418996
T Loss: 10.271711
Epoch 2999 
Overall Loss: 11.150505
Rec Loss: 10.477007
KL Loss: 0.673498
Y Loss: 0.436393
T Loss: 10.258810
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.443908
Epoch 99
Rec Loss: 0.432591
Epoch 149
Rec Loss: 0.426241
Epoch 199
Rec Loss: 0.423904
Epoch 249
Rec Loss: 0.422948
Epoch 299
Rec Loss: 0.426912
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.919002
Epoch 99
Rec Loss: 9.909180
Epoch 149
Rec Loss: 9.894358
Epoch 199
Rec Loss: 9.889149
Epoch 249
Rec Loss: 9.873419
Epoch 299
Rec Loss: 9.867548
Epoch 349
Rec Loss: 9.890669
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.601187
Insample Error: 1.448777
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.787847
Rec Loss: 19.780307
KL Loss: 3.007541
Y Loss: 9.863043
T Loss: 12.917905
X Loss: 1.930879
Epoch 99 
Overall Loss: 17.315908
Rec Loss: 13.929072
KL Loss: 3.386836
Y Loss: 3.240682
T Loss: 12.827402
X Loss: -0.518670
Epoch 149 
Overall Loss: 15.882235
Rec Loss: 12.356555
KL Loss: 3.525680
Y Loss: 1.999108
T Loss: 12.708169
X Loss: -1.351168
Epoch 199 
Overall Loss: 15.188946
Rec Loss: 11.310905
KL Loss: 3.878041
Y Loss: 1.487948
T Loss: 12.359567
X Loss: -1.792636
Epoch 249 
Overall Loss: 14.776253
Rec Loss: 10.761226
KL Loss: 4.015027
Y Loss: 1.225451
T Loss: 12.113387
X Loss: -1.964887
Epoch 299 
Overall Loss: 14.415404
Rec Loss: 10.077909
KL Loss: 4.337495
Y Loss: 1.099069
T Loss: 11.745098
X Loss: -2.216724
Epoch 349 
Overall Loss: 14.095451
Rec Loss: 9.505839
KL Loss: 4.589612
Y Loss: 1.037200
T Loss: 11.520748
X Loss: -2.533509
Epoch 399 
Overall Loss: 13.941334
Rec Loss: 9.247620
KL Loss: 4.693715
Y Loss: 0.976244
T Loss: 11.470909
X Loss: -2.711411
Epoch 449 
Overall Loss: 13.816757
Rec Loss: 8.986566
KL Loss: 4.830191
Y Loss: 0.962381
T Loss: 11.429647
X Loss: -2.924272
Epoch 499 
Overall Loss: 13.722114
Rec Loss: 8.771828
KL Loss: 4.950286
Y Loss: 0.963625
T Loss: 11.416354
X Loss: -3.126338
Epoch 549 
Overall Loss: 13.529121
Rec Loss: 8.253965
KL Loss: 5.275156
Y Loss: 0.920176
T Loss: 11.284253
X Loss: -3.490377
Epoch 599 
Overall Loss: 13.366920
Rec Loss: 7.652909
KL Loss: 5.714012
Y Loss: 0.900369
T Loss: 11.160736
X Loss: -3.958012
Epoch 649 
Overall Loss: 13.310869
Rec Loss: 7.417247
KL Loss: 5.893623
Y Loss: 0.888046
T Loss: 11.175449
X Loss: -4.202225
Epoch 699 
Overall Loss: 13.228845
Rec Loss: 7.173935
KL Loss: 6.054910
Y Loss: 0.889858
T Loss: 11.213858
X Loss: -4.484852
Epoch 749 
Overall Loss: 13.206644
Rec Loss: 7.027379
KL Loss: 6.179265
Y Loss: 0.890187
T Loss: 11.226704
X Loss: -4.644419
Epoch 799 
Overall Loss: 13.166438
Rec Loss: 6.814379
KL Loss: 6.352059
Y Loss: 0.831552
T Loss: 11.258321
X Loss: -4.859719
Epoch 849 
Overall Loss: 13.147593
Rec Loss: 6.685930
KL Loss: 6.461663
Y Loss: 0.847931
T Loss: 11.295899
X Loss: -5.033935
Epoch 899 
Overall Loss: 13.086871
Rec Loss: 6.529671
KL Loss: 6.557200
Y Loss: 0.846553
T Loss: 11.309995
X Loss: -5.203601
Epoch 949 
Overall Loss: 13.049721
Rec Loss: 6.363819
KL Loss: 6.685901
Y Loss: 0.831088
T Loss: 11.319358
X Loss: -5.371083
Epoch 999 
Overall Loss: 13.036184
Rec Loss: 6.197615
KL Loss: 6.838569
Y Loss: 0.811444
T Loss: 11.333688
X Loss: -5.541795
Epoch 1049 
Overall Loss: 13.012217
Rec Loss: 6.108527
KL Loss: 6.903690
Y Loss: 0.787434
T Loss: 11.356228
X Loss: -5.641417
Epoch 1099 
Overall Loss: 12.975840
Rec Loss: 5.954370
KL Loss: 7.021469
Y Loss: 0.775910
T Loss: 11.370819
X Loss: -5.804404
Epoch 1149 
Overall Loss: 12.957723
Rec Loss: 5.823176
KL Loss: 7.134547
Y Loss: 0.769445
T Loss: 11.359953
X Loss: -5.921500
Epoch 1199 
Overall Loss: 12.940912
Rec Loss: 5.740294
KL Loss: 7.200619
Y Loss: 0.761909
T Loss: 11.391527
X Loss: -6.032188
Epoch 1249 
Overall Loss: 12.931410
Rec Loss: 5.612087
KL Loss: 7.319323
Y Loss: 0.744381
T Loss: 11.390430
X Loss: -6.150534
Epoch 1299 
Overall Loss: 12.915249
Rec Loss: 5.526348
KL Loss: 7.388902
Y Loss: 0.748459
T Loss: 11.396540
X Loss: -6.244422
Epoch 1349 
Overall Loss: 12.856088
Rec Loss: 5.381694
KL Loss: 7.474394
Y Loss: 0.736885
T Loss: 11.405642
X Loss: -6.392391
Epoch 1399 
Overall Loss: 12.873412
Rec Loss: 5.334325
KL Loss: 7.539086
Y Loss: 0.749964
T Loss: 11.413271
X Loss: -6.453927
Epoch 1449 
Overall Loss: 12.868134
Rec Loss: 5.257490
KL Loss: 7.610644
Y Loss: 0.731728
T Loss: 11.411817
X Loss: -6.520192
Epoch 1499 
Overall Loss: 12.833454
Rec Loss: 5.107193
KL Loss: 7.726261
Y Loss: 0.732767
T Loss: 11.423203
X Loss: -6.682394
Epoch 1549 
Overall Loss: 12.828695
Rec Loss: 5.049071
KL Loss: 7.779625
Y Loss: 0.727778
T Loss: 11.430592
X Loss: -6.745410
Epoch 1599 
Overall Loss: 12.780648
Rec Loss: 4.969246
KL Loss: 7.811402
Y Loss: 0.720734
T Loss: 11.430996
X Loss: -6.822117
Epoch 1649 
Overall Loss: 12.791812
Rec Loss: 4.874731
KL Loss: 7.917081
Y Loss: 0.711688
T Loss: 11.435284
X Loss: -6.916398
Epoch 1699 
Overall Loss: 12.807512
Rec Loss: 4.836356
KL Loss: 7.971156
Y Loss: 0.736460
T Loss: 11.431749
X Loss: -6.963623
Epoch 1749 
Overall Loss: 12.781577
Rec Loss: 4.781200
KL Loss: 8.000377
Y Loss: 0.717485
T Loss: 11.441383
X Loss: -7.018925
Epoch 1799 
Overall Loss: 12.799449
Rec Loss: 4.716127
KL Loss: 8.083322
Y Loss: 0.714249
T Loss: 11.444833
X Loss: -7.085830
Epoch 1849 
Overall Loss: 12.786789
Rec Loss: 4.642394
KL Loss: 8.144395
Y Loss: 0.714708
T Loss: 11.442384
X Loss: -7.157345
Epoch 1899 
Overall Loss: 12.743971
Rec Loss: 4.551733
KL Loss: 8.192239
Y Loss: 0.712086
T Loss: 11.450771
X Loss: -7.255082
Epoch 1949 
Overall Loss: 12.736034
Rec Loss: 4.485785
KL Loss: 8.250249
Y Loss: 0.701680
T Loss: 11.454040
X Loss: -7.319095
Epoch 1999 
Overall Loss: 12.786564
Rec Loss: 4.479068
KL Loss: 8.307496
Y Loss: 0.706612
T Loss: 11.450139
X Loss: -7.324377
Epoch 2049 
Overall Loss: 12.752185
Rec Loss: 4.423243
KL Loss: 8.328942
Y Loss: 0.719807
T Loss: 11.460172
X Loss: -7.396832
Epoch 2099 
Overall Loss: 12.732617
Rec Loss: 4.359572
KL Loss: 8.373046
Y Loss: 0.721096
T Loss: 11.448653
X Loss: -7.449629
Epoch 2149 
Overall Loss: 12.710400
Rec Loss: 4.287454
KL Loss: 8.422946
Y Loss: 0.705025
T Loss: 11.461548
X Loss: -7.526606
Epoch 2199 
Overall Loss: 12.691550
Rec Loss: 4.213737
KL Loss: 8.477813
Y Loss: 0.706521
T Loss: 11.460406
X Loss: -7.599930
Epoch 2249 
Overall Loss: 12.719625
Rec Loss: 4.188847
KL Loss: 8.530778
Y Loss: 0.699005
T Loss: 11.461846
X Loss: -7.622501
Epoch 2299 
Overall Loss: 12.684314
Rec Loss: 4.099947
KL Loss: 8.584368
Y Loss: 0.694984
T Loss: 11.469479
X Loss: -7.717024
Epoch 2349 
Overall Loss: 12.696711
Rec Loss: 4.070455
KL Loss: 8.626256
Y Loss: 0.695745
T Loss: 11.469102
X Loss: -7.746520
Epoch 2399 
Overall Loss: 12.713566
Rec Loss: 4.040246
KL Loss: 8.673321
Y Loss: 0.701765
T Loss: 11.462595
X Loss: -7.773231
Epoch 2449 
Overall Loss: 12.703016
Rec Loss: 3.977927
KL Loss: 8.725089
Y Loss: 0.672449
T Loss: 11.475817
X Loss: -7.834114
Epoch 2499 
Overall Loss: 12.710354
Rec Loss: 3.951890
KL Loss: 8.758464
Y Loss: 0.691369
T Loss: 11.467547
X Loss: -7.861342
Epoch 2549 
Overall Loss: 12.683617
Rec Loss: 3.900600
KL Loss: 8.783018
Y Loss: 0.706793
T Loss: 11.474858
X Loss: -7.927655
Epoch 2599 
Overall Loss: 12.658441
Rec Loss: 3.826737
KL Loss: 8.831704
Y Loss: 0.683260
T Loss: 11.470588
X Loss: -7.985480
Epoch 2649 
Overall Loss: 12.679478
Rec Loss: 3.818015
KL Loss: 8.861463
Y Loss: 0.692614
T Loss: 11.477188
X Loss: -8.005479
Epoch 2699 
Overall Loss: 12.644268
Rec Loss: 3.755022
KL Loss: 8.889246
Y Loss: 0.671198
T Loss: 11.480658
X Loss: -8.061236
Epoch 2749 
Overall Loss: 12.679540
Rec Loss: 3.708402
KL Loss: 8.971138
Y Loss: 0.667945
T Loss: 11.473203
X Loss: -8.098773
Epoch 2799 
Overall Loss: 12.658963
Rec Loss: 3.618787
KL Loss: 9.040176
Y Loss: 0.667685
T Loss: 11.476103
X Loss: -8.191158
Epoch 2849 
Overall Loss: 12.662533
Rec Loss: 3.599409
KL Loss: 9.063124
Y Loss: 0.657049
T Loss: 11.481175
X Loss: -8.210291
Epoch 2899 
Overall Loss: 12.661001
Rec Loss: 3.542461
KL Loss: 9.118541
Y Loss: 0.666184
T Loss: 11.474634
X Loss: -8.265265
Epoch 2949 
Overall Loss: 12.639063
Rec Loss: 3.502277
KL Loss: 9.136786
Y Loss: 0.663643
T Loss: 11.476787
X Loss: -8.306331
Epoch 2999 
Overall Loss: 12.654596
Rec Loss: 3.481966
KL Loss: 9.172630
Y Loss: 0.671157
T Loss: 11.478480
X Loss: -8.332093
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.987393
Epoch 99
Rec Loss: 0.979803
Epoch 149
Rec Loss: 0.976276
Epoch 199
Rec Loss: 0.978333
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.002370
Epoch 99
Rec Loss: 1.989717
Epoch 149
Rec Loss: 1.991243
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.687016
Insample Error 2.129586
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.722311
Epoch 99 
Prediction Loss: 0.631428
Epoch 149 
Prediction Loss: 0.583575
Epoch 199 
Prediction Loss: 0.567079
Epoch 249 
Prediction Loss: 0.559159
Epoch 299 
Prediction Loss: 0.509526
Epoch 349 
Prediction Loss: 0.515826
Epoch 399 
Prediction Loss: 0.506661
Epoch 449 
Prediction Loss: 0.475251
Epoch 499 
Prediction Loss: 0.462787
Epoch 549 
Prediction Loss: 0.450701
Epoch 599 
Prediction Loss: 0.437692
Epoch 649 
Prediction Loss: 0.432408
Epoch 699 
Prediction Loss: 0.408874
Epoch 749 
Prediction Loss: 0.401535
Epoch 799 
Prediction Loss: 0.418036
Epoch 849 
Prediction Loss: 0.400412
Epoch 899 
Prediction Loss: 0.380810
Epoch 949 
Prediction Loss: 0.359291
Epoch 999 
Prediction Loss: 0.358016
Epoch 1049 
Prediction Loss: 0.339868
Epoch 1099 
Prediction Loss: 0.327220
Epoch 1149 
Prediction Loss: 0.327243
Epoch 1199 
Prediction Loss: 0.324191
Epoch 1249 
Prediction Loss: 0.318381
Epoch 1299 
Prediction Loss: 0.298781
Epoch 1349 
Prediction Loss: 0.303650
Epoch 1399 
Prediction Loss: 0.295292
Epoch 1449 
Prediction Loss: 0.296222
Epoch 1499 
Prediction Loss: 0.275678
Epoch 1549 
Prediction Loss: 0.282756
Epoch 1599 
Prediction Loss: 0.266264
Epoch 1649 
Prediction Loss: 0.264045
Epoch 1699 
Prediction Loss: 0.271087
Epoch 1749 
Prediction Loss: 0.269190
Epoch 1799 
Prediction Loss: 0.288937
Epoch 1849 
Prediction Loss: 0.258440
Epoch 1899 
Prediction Loss: 0.246567
Epoch 1949 
Prediction Loss: 0.239923
Epoch 1999 
Prediction Loss: 0.245588
Epoch 2049 
Prediction Loss: 0.237294
Epoch 2099 
Prediction Loss: 0.245749
Epoch 2149 
Prediction Loss: 0.240523
Epoch 2199 
Prediction Loss: 0.228737
Epoch 2249 
Prediction Loss: 0.241245
Epoch 2299 
Prediction Loss: 0.234496
Epoch 2349 
Prediction Loss: 0.227573
Epoch 2399 
Prediction Loss: 0.219808
Epoch 2449 
Prediction Loss: 0.216674
Epoch 2499 
Prediction Loss: 0.217959
Epoch 2549 
Prediction Loss: 0.224506
Epoch 2599 
Prediction Loss: 0.215049
Epoch 2649 
Prediction Loss: 0.209406
Epoch 2699 
Prediction Loss: 0.203112
Epoch 2749 
Prediction Loss: 0.211006
Epoch 2799 
Prediction Loss: 0.204792
Epoch 2849 
Prediction Loss: 0.210797
Epoch 2899 
Prediction Loss: 0.205824
Epoch 2949 
Prediction Loss: 0.206620
Epoch 2999 
Prediction Loss: 0.206318
Epoch 3049 
Prediction Loss: 0.200761
Epoch 3099 
Prediction Loss: 0.203090
Epoch 3149 
Prediction Loss: 0.201796
Epoch 3199 
Prediction Loss: 0.195285
Epoch 3249 
Prediction Loss: 0.197048
Epoch 3299 
Prediction Loss: 0.188243
Epoch 3349 
Prediction Loss: 0.182723
Epoch 3399 
Prediction Loss: 0.200005
Epoch 3449 
Prediction Loss: 0.187170
Epoch 3499 
Prediction Loss: 0.187910
Epoch 3549 
Prediction Loss: 0.183724
Epoch 3599 
Prediction Loss: 0.185103
Epoch 3649 
Prediction Loss: 0.183648
Epoch 3699 
Prediction Loss: 0.184808
Epoch 3749 
Prediction Loss: 0.176925
Epoch 3799 
Prediction Loss: 0.181079
Epoch 3849 
Prediction Loss: 0.187044
Epoch 3899 
Prediction Loss: 0.179203
Epoch 3949 
Prediction Loss: 0.182985
Epoch 3999 
Prediction Loss: 0.185794
Epoch 4049 
Prediction Loss: 0.174273
Epoch 4099 
Prediction Loss: 0.177972
Epoch 4149 
Prediction Loss: 0.188962
Epoch 4199 
Prediction Loss: 0.172027
Epoch 4249 
Prediction Loss: 0.178347
Epoch 4299 
Prediction Loss: 0.170202
Epoch 4349 
Prediction Loss: 0.170126
Epoch 4399 
Prediction Loss: 0.171430
Epoch 4449 
Prediction Loss: 0.181534
Epoch 4499 
Prediction Loss: 0.166660
Epoch 4549 
Prediction Loss: 0.169099
Epoch 4599 
Prediction Loss: 0.172131
Epoch 4649 
Prediction Loss: 0.171949
Epoch 4699 
Prediction Loss: 0.167155
Epoch 4749 
Prediction Loss: 0.173598
Epoch 4799 
Prediction Loss: 0.164687
Epoch 4849 
Prediction Loss: 0.167535
Epoch 4899 
Prediction Loss: 0.163907
Epoch 4949 
Prediction Loss: 0.170306
Epoch 4999 
Prediction Loss: 0.163124
Epoch 5049 
Prediction Loss: 0.168859
Epoch 5099 
Prediction Loss: 0.163627
Epoch 5149 
Prediction Loss: 0.162330
Epoch 5199 
Prediction Loss: 0.158963
Epoch 5249 
Prediction Loss: 0.185303
Epoch 5299 
Prediction Loss: 0.186077
Epoch 5349 
Prediction Loss: 0.156226
Epoch 5399 
Prediction Loss: 0.166282
Epoch 5449 
Prediction Loss: 0.155381
Epoch 5499 
Prediction Loss: 0.162057
Epoch 5549 
Prediction Loss: 0.162495
Epoch 5599 
Prediction Loss: 0.154225
Epoch 5649 
Prediction Loss: 0.164339
Epoch 5699 
Prediction Loss: 0.171301
Epoch 5749 
Prediction Loss: 0.158502
Epoch 5799 
Prediction Loss: 0.154670
Epoch 5849 
Prediction Loss: 0.164442
Epoch 5899 
Prediction Loss: 0.156831
Epoch 5949 
Prediction Loss: 0.156896
Epoch 5999 
Prediction Loss: 0.156886
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.392217
Insample Error 1.819353
Ours, Train RMSE
0.6120, 
0.6133, 
0.6124, 
0.6151, 
0.6346, 
0.6099, 
0.6197, 
0.6277, 
0.6086, 
0.6012, 
CEVAE, Train RMSE
0.6675, 
0.6804, 
0.6400, 
0.6922, 
0.6678, 
0.6752, 
0.6621, 
0.5990, 
0.6759, 
0.6870, 
Ours, Insample RMSE
1.4491, 
1.4703, 
1.4123, 
1.4493, 
1.4451, 
1.4035, 
1.4792, 
1.5148, 
1.4264, 
1.4488, 
CEVAE, Insample RMSE
2.2710, 
2.2068, 
2.2784, 
2.0495, 
2.2181, 
2.2638, 
2.2762, 
2.2461, 
2.2170, 
2.1296, 
Direct Regression, Insample RMSE
1.9163, 
1.8429, 
1.7943, 
1.8879, 
1.8073, 
1.8800, 
1.8536, 
1.9404, 
1.8245, 
1.8194, 
Train, RMSE mean 0.6155 std 0.0092
CEVAE, RMSE mean 0.6647 std 0.0258
Ours, RMSE mean 1.4499 std 0.0310, reconstruct confounder 0.4210 (0.0065) noise 9.8646 (0.0189)
CEVAE, RMSE mean 2.2157 std 0.0700, reconstruct confounder 1.3021 (0.1715) noise 1.9941 (0.0038)
Direct Regression, RMSE mean 1.8567 std 0.0459
