Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=4, mask=0, nlayer=50, obsm=4, stop=2000, ycof=0.5, ylayer=50)
Y Mean 0.467551, Std 3.004609 
Test Y Mean 0.015136, Std 2.801871 
Observe confounder 4, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.324961
Rec Loss: 9.787569
KL Loss: 0.537392
Y Loss: 0.949243
T Loss: 9.312947
Epoch 99 
Overall Loss: 9.737506
Rec Loss: 9.623588
KL Loss: 0.113918
Y Loss: 0.259937
T Loss: 9.493619
Epoch 149 
Overall Loss: 9.647975
Rec Loss: 9.569723
KL Loss: 0.078252
Y Loss: 0.152197
T Loss: 9.493624
Epoch 199 
Overall Loss: 9.621466
Rec Loss: 9.554162
KL Loss: 0.067304
Y Loss: 0.113211
T Loss: 9.497557
Epoch 249 
Overall Loss: 9.598468
Rec Loss: 9.539285
KL Loss: 0.059183
Y Loss: 0.092501
T Loss: 9.493034
Epoch 299 
Overall Loss: 9.586222
Rec Loss: 9.531605
KL Loss: 0.054617
Y Loss: 0.081621
T Loss: 9.490794
Epoch 349 
Overall Loss: 9.575816
Rec Loss: 9.525485
KL Loss: 0.050330
Y Loss: 0.069321
T Loss: 9.490825
Epoch 399 
Overall Loss: 9.562533
Rec Loss: 9.515982
KL Loss: 0.046551
Y Loss: 0.060772
T Loss: 9.485596
Epoch 449 
Overall Loss: 9.552142
Rec Loss: 9.506332
KL Loss: 0.045811
Y Loss: 0.057712
T Loss: 9.477476
Epoch 499 
Overall Loss: 9.552295
Rec Loss: 9.507832
KL Loss: 0.044462
Y Loss: 0.050791
T Loss: 9.482437
Epoch 549 
Overall Loss: 9.542039
Rec Loss: 9.501760
KL Loss: 0.040279
Y Loss: 0.049181
T Loss: 9.477170
Epoch 599 
Overall Loss: 9.536060
Rec Loss: 9.497334
KL Loss: 0.038726
Y Loss: 0.042078
T Loss: 9.476295
Epoch 649 
Overall Loss: 9.525420
Rec Loss: 9.488189
KL Loss: 0.037231
Y Loss: 0.041300
T Loss: 9.467539
Epoch 699 
Overall Loss: 9.520299
Rec Loss: 9.485175
KL Loss: 0.035124
Y Loss: 0.037423
T Loss: 9.466464
Epoch 749 
Overall Loss: 9.518912
Rec Loss: 9.481277
KL Loss: 0.037634
Y Loss: 0.033695
T Loss: 9.464430
Epoch 799 
Overall Loss: 9.516224
Rec Loss: 9.484441
KL Loss: 0.031783
Y Loss: 0.037716
T Loss: 9.465583
Epoch 849 
Overall Loss: 9.504036
Rec Loss: 9.472791
KL Loss: 0.031245
Y Loss: 0.031344
T Loss: 9.457119
Epoch 899 
Overall Loss: 9.502465
Rec Loss: 9.469448
KL Loss: 0.033017
Y Loss: 0.032784
T Loss: 9.453057
Epoch 949 
Overall Loss: 9.500483
Rec Loss: 9.466971
KL Loss: 0.033511
Y Loss: 0.030502
T Loss: 9.451720
Epoch 999 
Overall Loss: 9.493717
Rec Loss: 9.462744
KL Loss: 0.030973
Y Loss: 0.028555
T Loss: 9.448467
Epoch 1049 
Overall Loss: 9.490533
Rec Loss: 9.461225
KL Loss: 0.029308
Y Loss: 0.028942
T Loss: 9.446754
Epoch 1099 
Overall Loss: 9.487496
Rec Loss: 9.459598
KL Loss: 0.027897
Y Loss: 0.030528
T Loss: 9.444335
Epoch 1149 
Overall Loss: 9.488869
Rec Loss: 9.455128
KL Loss: 0.033741
Y Loss: 0.034185
T Loss: 9.438035
Epoch 1199 
Overall Loss: 9.479224
Rec Loss: 9.452688
KL Loss: 0.026536
Y Loss: 0.026468
T Loss: 9.439454
Epoch 1249 
Overall Loss: 9.477654
Rec Loss: 9.448328
KL Loss: 0.029326
Y Loss: 0.026302
T Loss: 9.435177
Epoch 1299 
Overall Loss: 9.476463
Rec Loss: 9.447566
KL Loss: 0.028897
Y Loss: 0.026019
T Loss: 9.434556
Epoch 1349 
Overall Loss: 9.474001
Rec Loss: 9.444325
KL Loss: 0.029675
Y Loss: 0.027410
T Loss: 9.430620
Epoch 1399 
Overall Loss: 9.467670
Rec Loss: 9.443145
KL Loss: 0.024524
Y Loss: 0.024446
T Loss: 9.430923
Epoch 1449 
Overall Loss: 9.469965
Rec Loss: 9.443376
KL Loss: 0.026589
Y Loss: 0.022496
T Loss: 9.432128
Epoch 1499 
Overall Loss: 9.470808
Rec Loss: 9.440277
KL Loss: 0.030531
Y Loss: 0.025008
T Loss: 9.427773
Epoch 1549 
Overall Loss: 9.464657
Rec Loss: 9.433919
KL Loss: 0.030737
Y Loss: 0.023841
T Loss: 9.421999
Epoch 1599 
Overall Loss: 9.462435
Rec Loss: 9.433940
KL Loss: 0.028495
Y Loss: 0.022939
T Loss: 9.422470
Epoch 1649 
Overall Loss: 9.452647
Rec Loss: 9.429093
KL Loss: 0.023554
Y Loss: 0.021443
T Loss: 9.418371
Epoch 1699 
Overall Loss: 9.456890
Rec Loss: 9.431538
KL Loss: 0.025353
Y Loss: 0.021290
T Loss: 9.420893
Epoch 1749 
Overall Loss: 9.450824
Rec Loss: 9.427019
KL Loss: 0.023805
Y Loss: 0.021083
T Loss: 9.416477
Epoch 1799 
Overall Loss: 9.451713
Rec Loss: 9.429417
KL Loss: 0.022296
Y Loss: 0.023775
T Loss: 9.417530
Epoch 1849 
Overall Loss: 9.460778
Rec Loss: 9.426101
KL Loss: 0.034677
Y Loss: 0.024226
T Loss: 9.413987
Epoch 1899 
Overall Loss: 9.447763
Rec Loss: 9.420598
KL Loss: 0.027165
Y Loss: 0.020085
T Loss: 9.410556
Epoch 1949 
Overall Loss: 9.461108
Rec Loss: 9.421841
KL Loss: 0.039267
Y Loss: 0.021873
T Loss: 9.410904
Epoch 1999 
Overall Loss: 9.446456
Rec Loss: 9.417119
KL Loss: 0.029336
Y Loss: 0.019808
T Loss: 9.407216
Epoch 2049 
Overall Loss: 9.438208
Rec Loss: 9.413669
KL Loss: 0.024539
Y Loss: 0.021127
T Loss: 9.403105
Epoch 2099 
Overall Loss: 9.446236
Rec Loss: 9.417777
KL Loss: 0.028458
Y Loss: 0.020401
T Loss: 9.407576
Epoch 2149 
Overall Loss: 9.436591
Rec Loss: 9.411112
KL Loss: 0.025479
Y Loss: 0.019450
T Loss: 9.401387
Epoch 2199 
Overall Loss: 9.443117
Rec Loss: 9.418743
KL Loss: 0.024374
Y Loss: 0.028006
T Loss: 9.404740
Epoch 2249 
Overall Loss: 9.432238
Rec Loss: 9.411391
KL Loss: 0.020847
Y Loss: 0.020567
T Loss: 9.401108
Epoch 2299 
Overall Loss: 9.433778
Rec Loss: 9.412031
KL Loss: 0.021747
Y Loss: 0.019573
T Loss: 9.402245
Epoch 2349 
Overall Loss: 9.429314
Rec Loss: 9.407843
KL Loss: 0.021471
Y Loss: 0.020815
T Loss: 9.397436
Epoch 2399 
Overall Loss: 9.431227
Rec Loss: 9.407309
KL Loss: 0.023918
Y Loss: 0.022162
T Loss: 9.396228
Epoch 2449 
Overall Loss: 9.435666
Rec Loss: 9.407592
KL Loss: 0.028074
Y Loss: 0.020515
T Loss: 9.397335
Epoch 2499 
Overall Loss: 9.430571
Rec Loss: 9.403859
KL Loss: 0.026713
Y Loss: 0.019374
T Loss: 9.394172
Epoch 2549 
Overall Loss: 9.423400
Rec Loss: 9.401321
KL Loss: 0.022078
Y Loss: 0.021559
T Loss: 9.390542
Epoch 2599 
Overall Loss: 9.425740
Rec Loss: 9.402779
KL Loss: 0.022960
Y Loss: 0.019154
T Loss: 9.393203
Epoch 2649 
Overall Loss: 9.425882
Rec Loss: 9.401187
KL Loss: 0.024696
Y Loss: 0.019095
T Loss: 9.391639
Epoch 2699 
Overall Loss: 9.412933
Rec Loss: 9.392752
KL Loss: 0.020181
Y Loss: 0.017471
T Loss: 9.384017
Epoch 2749 
Overall Loss: 9.417046
Rec Loss: 9.394082
KL Loss: 0.022965
Y Loss: 0.019051
T Loss: 9.384556
Epoch 2799 
Overall Loss: 9.411391
Rec Loss: 9.390126
KL Loss: 0.021264
Y Loss: 0.018030
T Loss: 9.381111
Epoch 2849 
Overall Loss: 9.414619
Rec Loss: 9.392994
KL Loss: 0.021625
Y Loss: 0.017248
T Loss: 9.384370
Epoch 2899 
Overall Loss: 9.422650
Rec Loss: 9.390908
KL Loss: 0.031742
Y Loss: 0.016981
T Loss: 9.382417
Epoch 2949 
Overall Loss: 9.411607
Rec Loss: 9.389359
KL Loss: 0.022248
Y Loss: 0.017534
T Loss: 9.380591
Epoch 2999 
Overall Loss: 9.411620
Rec Loss: 9.392077
KL Loss: 0.019543
Y Loss: 0.016637
T Loss: 9.383758
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.016669
Epoch 99
Rec Loss: 0.012702
Epoch 149
Rec Loss: 0.011198
Epoch 199
Rec Loss: 0.010488
Epoch 249
Rec Loss: 0.010004
Epoch 299
Rec Loss: 0.009720
Epoch 349
Rec Loss: 0.009703
Epoch 399
Rec Loss: 0.009517
Epoch 449
Rec Loss: 0.009489
Epoch 499
Rec Loss: 0.009535
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.733798
Epoch 99
Rec Loss: 9.709700
Epoch 149
Rec Loss: 9.675387
Epoch 199
Rec Loss: 9.649510
Epoch 249
Rec Loss: 9.618317
Epoch 299
Rec Loss: 9.613753
Epoch 349
Rec Loss: 9.587400
Epoch 399
Rec Loss: 9.582836
Epoch 449
Rec Loss: 9.528284
Epoch 499
Rec Loss: 9.537274
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.065089
Insample Error: 0.223124
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.065909
Epoch 99
Rec Loss: 4.057534
Epoch 149
Rec Loss: 4.064613
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.520223
Epoch 99
Rec Loss: 9.592903
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.006097
Insample Error 2.803547
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.406012
Epoch 99 
Prediction Loss: 0.135119
Epoch 149 
Prediction Loss: 0.070429
Epoch 199 
Prediction Loss: 0.050585
Epoch 249 
Prediction Loss: 0.039141
Epoch 299 
Prediction Loss: 0.032998
Epoch 349 
Prediction Loss: 0.029821
Epoch 399 
Prediction Loss: 0.025816
Epoch 449 
Prediction Loss: 0.022725
Epoch 499 
Prediction Loss: 0.025363
Epoch 549 
Prediction Loss: 0.019610
Epoch 599 
Prediction Loss: 0.017681
Epoch 649 
Prediction Loss: 0.015114
Epoch 699 
Prediction Loss: 0.013711
Epoch 749 
Prediction Loss: 0.016332
Epoch 799 
Prediction Loss: 0.013597
Epoch 849 
Prediction Loss: 0.011417
Epoch 899 
Prediction Loss: 0.009636
Epoch 949 
Prediction Loss: 0.010314
Epoch 999 
Prediction Loss: 0.010370
Epoch 1049 
Prediction Loss: 0.010335
Epoch 1099 
Prediction Loss: 0.007964
Epoch 1149 
Prediction Loss: 0.007538
Epoch 1199 
Prediction Loss: 0.011021
Epoch 1249 
Prediction Loss: 0.006860
Epoch 1299 
Prediction Loss: 0.008937
Epoch 1349 
Prediction Loss: 0.006521
Epoch 1399 
Prediction Loss: 0.007375
Epoch 1449 
Prediction Loss: 0.006549
Epoch 1499 
Prediction Loss: 0.005813
Epoch 1549 
Prediction Loss: 0.007127
Epoch 1599 
Prediction Loss: 0.005226
Epoch 1649 
Prediction Loss: 0.005696
Epoch 1699 
Prediction Loss: 0.004787
Epoch 1749 
Prediction Loss: 0.005105
Epoch 1799 
Prediction Loss: 0.004933
Epoch 1849 
Prediction Loss: 0.004985
Epoch 1899 
Prediction Loss: 0.004806
Epoch 1949 
Prediction Loss: 0.005140
Epoch 1999 
Prediction Loss: 0.005385
Epoch 2049 
Prediction Loss: 0.003932
Epoch 2099 
Prediction Loss: 0.004414
Epoch 2149 
Prediction Loss: 0.004679
Epoch 2199 
Prediction Loss: 0.003847
Epoch 2249 
Prediction Loss: 0.004964
Epoch 2299 
Prediction Loss: 0.005150
Epoch 2349 
Prediction Loss: 0.003817
Epoch 2399 
Prediction Loss: 0.004461
Epoch 2449 
Prediction Loss: 0.004563
Epoch 2499 
Prediction Loss: 0.003159
Epoch 2549 
Prediction Loss: 0.003141
Epoch 2599 
Prediction Loss: 0.003562
Epoch 2649 
Prediction Loss: 0.006215
Epoch 2699 
Prediction Loss: 0.003080
Epoch 2749 
Prediction Loss: 0.003314
Epoch 2799 
Prediction Loss: 0.006697
Epoch 2849 
Prediction Loss: 0.003282
Epoch 2899 
Prediction Loss: 0.003006
Epoch 2949 
Prediction Loss: 0.003137
Epoch 2999 
Prediction Loss: 0.004170
Epoch 3049 
Prediction Loss: 0.002800
Epoch 3099 
Prediction Loss: 0.005069
Epoch 3149 
Prediction Loss: 0.003873
Epoch 3199 
Prediction Loss: 0.002894
Epoch 3249 
Prediction Loss: 0.002945
Epoch 3299 
Prediction Loss: 0.003534
Epoch 3349 
Prediction Loss: 0.002505
Epoch 3399 
Prediction Loss: 0.002752
Epoch 3449 
Prediction Loss: 0.003280
Epoch 3499 
Prediction Loss: 0.002887
Epoch 3549 
Prediction Loss: 0.002579
Epoch 3599 
Prediction Loss: 0.002506
Epoch 3649 
Prediction Loss: 0.003942
Epoch 3699 
Prediction Loss: 0.003258
Epoch 3749 
Prediction Loss: 0.002668
Epoch 3799 
Prediction Loss: 0.002790
Epoch 3849 
Prediction Loss: 0.002654
Epoch 3899 
Prediction Loss: 0.002403
Epoch 3949 
Prediction Loss: 0.002716
Epoch 3999 
Prediction Loss: 0.004033
Epoch 4049 
Prediction Loss: 0.002315
Epoch 4099 
Prediction Loss: 0.002275
Epoch 4149 
Prediction Loss: 0.002065
Epoch 4199 
Prediction Loss: 0.003193
Epoch 4249 
Prediction Loss: 0.002434
Epoch 4299 
Prediction Loss: 0.002437
Epoch 4349 
Prediction Loss: 0.002599
Epoch 4399 
Prediction Loss: 0.002511
Epoch 4449 
Prediction Loss: 0.002364
Epoch 4499 
Prediction Loss: 0.002354
Epoch 4549 
Prediction Loss: 0.002609
Epoch 4599 
Prediction Loss: 0.003786
Epoch 4649 
Prediction Loss: 0.002536
Epoch 4699 
Prediction Loss: 0.002320
Epoch 4749 
Prediction Loss: 0.003654
Epoch 4799 
Prediction Loss: 0.002251
Epoch 4849 
Prediction Loss: 0.002654
Epoch 4899 
Prediction Loss: 0.003432
Epoch 4949 
Prediction Loss: 0.001948
Epoch 4999 
Prediction Loss: 0.002606
Epoch 5049 
Prediction Loss: 0.003323
Epoch 5099 
Prediction Loss: 0.001884
Epoch 5149 
Prediction Loss: 0.002369
Epoch 5199 
Prediction Loss: 0.002489
Epoch 5249 
Prediction Loss: 0.003369
Epoch 5299 
Prediction Loss: 0.002329
Epoch 5349 
Prediction Loss: 0.004875
Epoch 5399 
Prediction Loss: 0.002249
Epoch 5449 
Prediction Loss: 0.001975
Epoch 5499 
Prediction Loss: 0.001899
Epoch 5549 
Prediction Loss: 0.001813
Epoch 5599 
Prediction Loss: 0.002794
Epoch 5649 
Prediction Loss: 0.001952
Epoch 5699 
Prediction Loss: 0.001742
Epoch 5749 
Prediction Loss: 0.003057
Epoch 5799 
Prediction Loss: 0.002162
Epoch 5849 
Prediction Loss: 0.002857
Epoch 5899 
Prediction Loss: 0.001861
Epoch 5949 
Prediction Loss: 0.002399
Epoch 5999 
Prediction Loss: 0.002121
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.044640
Insample Error 0.169342
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.319483
Rec Loss: 9.778110
KL Loss: 0.541372
Y Loss: 0.913725
T Loss: 9.321248
Epoch 99 
Overall Loss: 9.752829
Rec Loss: 9.636179
KL Loss: 0.116649
Y Loss: 0.281949
T Loss: 9.495205
Epoch 149 
Overall Loss: 9.653318
Rec Loss: 9.569899
KL Loss: 0.083418
Y Loss: 0.161411
T Loss: 9.489194
Epoch 199 
Overall Loss: 9.622204
Rec Loss: 9.549203
KL Loss: 0.073002
Y Loss: 0.119168
T Loss: 9.489619
Epoch 249 
Overall Loss: 9.610717
Rec Loss: 9.542449
KL Loss: 0.068268
Y Loss: 0.099023
T Loss: 9.492938
Epoch 299 
Overall Loss: 9.586977
Rec Loss: 9.529999
KL Loss: 0.056978
Y Loss: 0.080317
T Loss: 9.489840
Epoch 349 
Overall Loss: 9.580755
Rec Loss: 9.527064
KL Loss: 0.053691
Y Loss: 0.071601
T Loss: 9.491263
Epoch 399 
Overall Loss: 9.565399
Rec Loss: 9.515012
KL Loss: 0.050387
Y Loss: 0.061557
T Loss: 9.484233
Epoch 449 
Overall Loss: 9.562458
Rec Loss: 9.514585
KL Loss: 0.047872
Y Loss: 0.053883
T Loss: 9.487644
Epoch 499 
Overall Loss: 9.554914
Rec Loss: 9.507778
KL Loss: 0.047136
Y Loss: 0.051172
T Loss: 9.482192
Epoch 549 
Overall Loss: 9.545318
Rec Loss: 9.502116
KL Loss: 0.043203
Y Loss: 0.044865
T Loss: 9.479683
Epoch 599 
Overall Loss: 9.556492
Rec Loss: 9.502935
KL Loss: 0.053557
Y Loss: 0.045413
T Loss: 9.480228
Epoch 649 
Overall Loss: 9.529981
Rec Loss: 9.492518
KL Loss: 0.037463
Y Loss: 0.042248
T Loss: 9.471393
Epoch 699 
Overall Loss: 9.527447
Rec Loss: 9.489797
KL Loss: 0.037650
Y Loss: 0.037516
T Loss: 9.471040
Epoch 749 
Overall Loss: 9.529113
Rec Loss: 9.490522
KL Loss: 0.038590
Y Loss: 0.036926
T Loss: 9.472059
Epoch 799 
Overall Loss: 9.520961
Rec Loss: 9.485631
KL Loss: 0.035330
Y Loss: 0.032811
T Loss: 9.469225
Epoch 849 
Overall Loss: 9.507026
Rec Loss: 9.474999
KL Loss: 0.032027
Y Loss: 0.034245
T Loss: 9.457876
Epoch 899 
Overall Loss: 9.503635
Rec Loss: 9.472587
KL Loss: 0.031047
Y Loss: 0.032932
T Loss: 9.456121
Epoch 949 
Overall Loss: 9.502676
Rec Loss: 9.472279
KL Loss: 0.030398
Y Loss: 0.031208
T Loss: 9.456675
Epoch 999 
Overall Loss: 9.499520
Rec Loss: 9.468317
KL Loss: 0.031203
Y Loss: 0.033515
T Loss: 9.451559
Epoch 1049 
Overall Loss: 9.497852
Rec Loss: 9.467015
KL Loss: 0.030837
Y Loss: 0.029788
T Loss: 9.452121
Epoch 1099 
Overall Loss: 9.497141
Rec Loss: 9.463886
KL Loss: 0.033255
Y Loss: 0.029973
T Loss: 9.448900
Epoch 1149 
Overall Loss: 9.487500
Rec Loss: 9.457236
KL Loss: 0.030264
Y Loss: 0.027541
T Loss: 9.443466
Epoch 1199 
Overall Loss: 9.540137
Rec Loss: 9.465391
KL Loss: 0.074747
Y Loss: 0.035845
T Loss: 9.447468
Epoch 1249 
Overall Loss: 9.482431
Rec Loss: 9.455406
KL Loss: 0.027026
Y Loss: 0.027110
T Loss: 9.441851
Epoch 1299 
Overall Loss: 9.483362
Rec Loss: 9.453995
KL Loss: 0.029366
Y Loss: 0.027281
T Loss: 9.440355
Epoch 1349 
Overall Loss: 9.478287
Rec Loss: 9.450510
KL Loss: 0.027777
Y Loss: 0.026647
T Loss: 9.437187
Epoch 1399 
Overall Loss: 9.475776
Rec Loss: 9.448569
KL Loss: 0.027207
Y Loss: 0.027136
T Loss: 9.435001
Epoch 1449 
Overall Loss: 9.471799
Rec Loss: 9.444086
KL Loss: 0.027713
Y Loss: 0.023561
T Loss: 9.432305
Epoch 1499 
Overall Loss: 9.475234
Rec Loss: 9.445166
KL Loss: 0.030067
Y Loss: 0.026154
T Loss: 9.432089
Epoch 1549 
Overall Loss: 9.468057
Rec Loss: 9.440154
KL Loss: 0.027902
Y Loss: 0.028088
T Loss: 9.426110
Epoch 1599 
Overall Loss: 9.463542
Rec Loss: 9.436322
KL Loss: 0.027220
Y Loss: 0.024382
T Loss: 9.424131
Epoch 1649 
Overall Loss: 9.456399
Rec Loss: 9.431691
KL Loss: 0.024708
Y Loss: 0.024025
T Loss: 9.419679
Epoch 1699 
Overall Loss: 9.452981
Rec Loss: 9.426751
KL Loss: 0.026230
Y Loss: 0.028647
T Loss: 9.412428
Epoch 1749 
Overall Loss: 9.452894
Rec Loss: 9.428637
KL Loss: 0.024257
Y Loss: 0.022820
T Loss: 9.417228
Epoch 1799 
Overall Loss: 9.450535
Rec Loss: 9.424825
KL Loss: 0.025711
Y Loss: 0.020717
T Loss: 9.414466
Epoch 1849 
Overall Loss: 9.469592
Rec Loss: 9.427562
KL Loss: 0.042030
Y Loss: 0.021809
T Loss: 9.416657
Epoch 1899 
Overall Loss: 9.452918
Rec Loss: 9.425029
KL Loss: 0.027888
Y Loss: 0.024022
T Loss: 9.413019
Epoch 1949 
Overall Loss: 9.441013
Rec Loss: 9.418559
KL Loss: 0.022454
Y Loss: 0.021105
T Loss: 9.408007
Epoch 1999 
Overall Loss: 9.450669
Rec Loss: 9.419581
KL Loss: 0.031088
Y Loss: 0.034343
T Loss: 9.402410
Epoch 2049 
Overall Loss: 9.440325
Rec Loss: 9.415301
KL Loss: 0.025024
Y Loss: 0.020447
T Loss: 9.405077
Epoch 2099 
Overall Loss: 9.448673
Rec Loss: 9.420655
KL Loss: 0.028018
Y Loss: 0.023412
T Loss: 9.408949
Epoch 2149 
Overall Loss: 9.440302
Rec Loss: 9.414636
KL Loss: 0.025666
Y Loss: 0.020655
T Loss: 9.404309
Epoch 2199 
Overall Loss: 9.436772
Rec Loss: 9.411200
KL Loss: 0.025573
Y Loss: 0.019951
T Loss: 9.401224
Epoch 2249 
Overall Loss: 9.448596
Rec Loss: 9.415297
KL Loss: 0.033298
Y Loss: 0.019420
T Loss: 9.405587
Epoch 2299 
Overall Loss: 9.433186
Rec Loss: 9.405889
KL Loss: 0.027297
Y Loss: 0.018849
T Loss: 9.396465
Epoch 2349 
Overall Loss: 9.465982
Rec Loss: 9.410554
KL Loss: 0.055428
Y Loss: 0.020020
T Loss: 9.400544
Epoch 2399 
Overall Loss: 9.428852
Rec Loss: 9.404314
KL Loss: 0.024538
Y Loss: 0.018621
T Loss: 9.395004
Epoch 2449 
Overall Loss: 9.423001
Rec Loss: 9.400609
KL Loss: 0.022392
Y Loss: 0.019277
T Loss: 9.390971
Epoch 2499 
Overall Loss: 9.428424
Rec Loss: 9.400971
KL Loss: 0.027453
Y Loss: 0.017496
T Loss: 9.392223
Epoch 2549 
Overall Loss: 9.430959
Rec Loss: 9.402125
KL Loss: 0.028834
Y Loss: 0.018853
T Loss: 9.392699
Epoch 2599 
Overall Loss: 9.419933
Rec Loss: 9.395820
KL Loss: 0.024113
Y Loss: 0.018425
T Loss: 9.386608
Epoch 2649 
Overall Loss: 9.423721
Rec Loss: 9.397636
KL Loss: 0.026085
Y Loss: 0.018063
T Loss: 9.388604
Epoch 2699 
Overall Loss: 9.413658
Rec Loss: 9.393833
KL Loss: 0.019825
Y Loss: 0.017906
T Loss: 9.384880
Epoch 2749 
Overall Loss: 9.420515
Rec Loss: 9.398293
KL Loss: 0.022222
Y Loss: 0.018528
T Loss: 9.389029
Epoch 2799 
Overall Loss: 9.426839
Rec Loss: 9.398642
KL Loss: 0.028197
Y Loss: 0.019757
T Loss: 9.388764
Epoch 2849 
Overall Loss: 9.415492
Rec Loss: 9.395493
KL Loss: 0.019999
Y Loss: 0.017739
T Loss: 9.386624
Epoch 2899 
Overall Loss: 9.414736
Rec Loss: 9.391964
KL Loss: 0.022772
Y Loss: 0.016958
T Loss: 9.383485
Epoch 2949 
Overall Loss: 9.409502
Rec Loss: 9.389117
KL Loss: 0.020386
Y Loss: 0.018755
T Loss: 9.379739
Epoch 2999 
Overall Loss: 9.411185
Rec Loss: 9.390379
KL Loss: 0.020806
Y Loss: 0.018419
T Loss: 9.381170
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.017294
Epoch 99
Rec Loss: 0.013155
Epoch 149
Rec Loss: 0.011795
Epoch 199
Rec Loss: 0.011023
Epoch 249
Rec Loss: 0.010566
Epoch 299
Rec Loss: 0.010414
Epoch 349
Rec Loss: 0.010248
Epoch 399
Rec Loss: 0.009870
Epoch 449
Rec Loss: 0.009973
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.733605
Epoch 99
Rec Loss: 9.714233
Epoch 149
Rec Loss: 9.694923
Epoch 199
Rec Loss: 9.640586
Epoch 249
Rec Loss: 9.631127
Epoch 299
Rec Loss: 9.588703
Epoch 349
Rec Loss: 9.582691
Epoch 399
Rec Loss: 9.580729
Epoch 449
Rec Loss: 9.552802
Epoch 499
Rec Loss: 9.527853
Epoch 549
Rec Loss: 9.522855
Epoch 599
Rec Loss: 9.518046
Epoch 649
Rec Loss: 9.532847
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.071286
Insample Error: 0.206306
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.039708
Epoch 99
Rec Loss: 4.040573
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 8.895773
Epoch 99
Rec Loss: 8.799610
Epoch 149
Rec Loss: 8.849190
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.990005
Insample Error 2.797692
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.509819
Epoch 99 
Prediction Loss: 0.187899
Epoch 149 
Prediction Loss: 0.091598
Epoch 199 
Prediction Loss: 0.055261
Epoch 249 
Prediction Loss: 0.042386
Epoch 299 
Prediction Loss: 0.034851
Epoch 349 
Prediction Loss: 0.031445
Epoch 399 
Prediction Loss: 0.028778
Epoch 449 
Prediction Loss: 0.024991
Epoch 499 
Prediction Loss: 0.023609
Epoch 549 
Prediction Loss: 0.021661
Epoch 599 
Prediction Loss: 0.020939
Epoch 649 
Prediction Loss: 0.019996
Epoch 699 
Prediction Loss: 0.019567
Epoch 749 
Prediction Loss: 0.019719
Epoch 799 
Prediction Loss: 0.015942
Epoch 849 
Prediction Loss: 0.014691
Epoch 899 
Prediction Loss: 0.014742
Epoch 949 
Prediction Loss: 0.013920
Epoch 999 
Prediction Loss: 0.012966
Epoch 1049 
Prediction Loss: 0.014057
Epoch 1099 
Prediction Loss: 0.012643
Epoch 1149 
Prediction Loss: 0.011259
Epoch 1199 
Prediction Loss: 0.011314
Epoch 1249 
Prediction Loss: 0.011271
Epoch 1299 
Prediction Loss: 0.009765
Epoch 1349 
Prediction Loss: 0.009630
Epoch 1399 
Prediction Loss: 0.009583
Epoch 1449 
Prediction Loss: 0.009563
Epoch 1499 
Prediction Loss: 0.009871
Epoch 1549 
Prediction Loss: 0.009879
Epoch 1599 
Prediction Loss: 0.008235
Epoch 1649 
Prediction Loss: 0.008378
Epoch 1699 
Prediction Loss: 0.007649
Epoch 1749 
Prediction Loss: 0.010901
Epoch 1799 
Prediction Loss: 0.009155
Epoch 1849 
Prediction Loss: 0.007704
Epoch 1899 
Prediction Loss: 0.006830
Epoch 1949 
Prediction Loss: 0.007386
Epoch 1999 
Prediction Loss: 0.006611
Epoch 2049 
Prediction Loss: 0.007406
Epoch 2099 
Prediction Loss: 0.006184
Epoch 2149 
Prediction Loss: 0.006375
Epoch 2199 
Prediction Loss: 0.007460
Epoch 2249 
Prediction Loss: 0.005983
Epoch 2299 
Prediction Loss: 0.005801
Epoch 2349 
Prediction Loss: 0.006710
Epoch 2399 
Prediction Loss: 0.006567
Epoch 2449 
Prediction Loss: 0.006001
Epoch 2499 
Prediction Loss: 0.006727
Epoch 2549 
Prediction Loss: 0.007109
Epoch 2599 
Prediction Loss: 0.007198
Epoch 2649 
Prediction Loss: 0.005189
Epoch 2699 
Prediction Loss: 0.006451
Epoch 2749 
Prediction Loss: 0.004946
Epoch 2799 
Prediction Loss: 0.005121
Epoch 2849 
Prediction Loss: 0.005103
Epoch 2899 
Prediction Loss: 0.007373
Epoch 2949 
Prediction Loss: 0.007421
Epoch 2999 
Prediction Loss: 0.006591
Epoch 3049 
Prediction Loss: 0.006258
Epoch 3099 
Prediction Loss: 0.004888
Epoch 3149 
Prediction Loss: 0.004684
Epoch 3199 
Prediction Loss: 0.004948
Epoch 3249 
Prediction Loss: 0.004324
Epoch 3299 
Prediction Loss: 0.004347
Epoch 3349 
Prediction Loss: 0.004658
Epoch 3399 
Prediction Loss: 0.004443
Epoch 3449 
Prediction Loss: 0.007819
Epoch 3499 
Prediction Loss: 0.006031
Epoch 3549 
Prediction Loss: 0.004050
Epoch 3599 
Prediction Loss: 0.005615
Epoch 3649 
Prediction Loss: 0.004158
Epoch 3699 
Prediction Loss: 0.003877
Epoch 3749 
Prediction Loss: 0.005029
Epoch 3799 
Prediction Loss: 0.004395
Epoch 3849 
Prediction Loss: 0.005501
Epoch 3899 
Prediction Loss: 0.003684
Epoch 3949 
Prediction Loss: 0.003697
Epoch 3999 
Prediction Loss: 0.004855
Epoch 4049 
Prediction Loss: 0.004277
Epoch 4099 
Prediction Loss: 0.006587
Epoch 4149 
Prediction Loss: 0.003622
Epoch 4199 
Prediction Loss: 0.003710
Epoch 4249 
Prediction Loss: 0.005174
Epoch 4299 
Prediction Loss: 0.003732
Epoch 4349 
Prediction Loss: 0.004752
Epoch 4399 
Prediction Loss: 0.003634
Epoch 4449 
Prediction Loss: 0.005116
Epoch 4499 
Prediction Loss: 0.006873
Epoch 4549 
Prediction Loss: 0.006640
Epoch 4599 
Prediction Loss: 0.005736
Epoch 4649 
Prediction Loss: 0.004130
Epoch 4699 
Prediction Loss: 0.007263
Epoch 4749 
Prediction Loss: 0.003712
Epoch 4799 
Prediction Loss: 0.004793
Epoch 4849 
Prediction Loss: 0.003745
Epoch 4899 
Prediction Loss: 0.003504
Epoch 4949 
Prediction Loss: 0.004904
Epoch 4999 
Prediction Loss: 0.003640
Epoch 5049 
Prediction Loss: 0.002744
Epoch 5099 
Prediction Loss: 0.004787
Epoch 5149 
Prediction Loss: 0.003106
Epoch 5199 
Prediction Loss: 0.003241
Epoch 5249 
Prediction Loss: 0.004413
Epoch 5299 
Prediction Loss: 0.004031
Epoch 5349 
Prediction Loss: 0.002796
Epoch 5399 
Prediction Loss: 0.004393
Epoch 5449 
Prediction Loss: 0.003377
Epoch 5499 
Prediction Loss: 0.004690
Epoch 5549 
Prediction Loss: 0.004040
Epoch 5599 
Prediction Loss: 0.003029
Epoch 5649 
Prediction Loss: 0.005329
Epoch 5699 
Prediction Loss: 0.005292
Epoch 5749 
Prediction Loss: 0.003889
Epoch 5799 
Prediction Loss: 0.002718
Epoch 5849 
Prediction Loss: 0.002734
Epoch 5899 
Prediction Loss: 0.002896
Epoch 5949 
Prediction Loss: 0.003062
Epoch 5999 
Prediction Loss: 0.003057
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.055524
Insample Error 0.233808
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.222156
Rec Loss: 9.771700
KL Loss: 0.450456
Y Loss: 0.890465
T Loss: 9.326467
Epoch 99 
Overall Loss: 9.740774
Rec Loss: 9.628509
KL Loss: 0.112265
Y Loss: 0.267504
T Loss: 9.494757
Epoch 149 
Overall Loss: 9.661154
Rec Loss: 9.577930
KL Loss: 0.083224
Y Loss: 0.162981
T Loss: 9.496439
Epoch 199 
Overall Loss: 9.627957
Rec Loss: 9.557454
KL Loss: 0.070504
Y Loss: 0.121372
T Loss: 9.496768
Epoch 249 
Overall Loss: 9.599723
Rec Loss: 9.539758
KL Loss: 0.059966
Y Loss: 0.097992
T Loss: 9.490761
Epoch 299 
Overall Loss: 9.590302
Rec Loss: 9.535982
KL Loss: 0.054320
Y Loss: 0.086278
T Loss: 9.492843
Epoch 349 
Overall Loss: 9.578791
Rec Loss: 9.526918
KL Loss: 0.051872
Y Loss: 0.080003
T Loss: 9.486917
Epoch 399 
Overall Loss: 9.573962
Rec Loss: 9.519876
KL Loss: 0.054086
Y Loss: 0.068774
T Loss: 9.485490
Epoch 449 
Overall Loss: 9.569244
Rec Loss: 9.520790
KL Loss: 0.048454
Y Loss: 0.066592
T Loss: 9.487494
Epoch 499 
Overall Loss: 9.560765
Rec Loss: 9.516930
KL Loss: 0.043835
Y Loss: 0.060112
T Loss: 9.486874
Epoch 549 
Overall Loss: 9.547989
Rec Loss: 9.504850
KL Loss: 0.043139
Y Loss: 0.057228
T Loss: 9.476236
Epoch 599 
Overall Loss: 9.540343
Rec Loss: 9.499622
KL Loss: 0.040721
Y Loss: 0.051252
T Loss: 9.473996
Epoch 649 
Overall Loss: 9.532003
Rec Loss: 9.495365
KL Loss: 0.036638
Y Loss: 0.049516
T Loss: 9.470607
Epoch 699 
Overall Loss: 9.525261
Rec Loss: 9.491957
KL Loss: 0.033304
Y Loss: 0.045745
T Loss: 9.469085
Epoch 749 
Overall Loss: 9.532280
Rec Loss: 9.487796
KL Loss: 0.044484
Y Loss: 0.044947
T Loss: 9.465322
Epoch 799 
Overall Loss: 9.511907
Rec Loss: 9.476615
KL Loss: 0.035293
Y Loss: 0.040245
T Loss: 9.456492
Epoch 849 
Overall Loss: 9.514825
Rec Loss: 9.482758
KL Loss: 0.032067
Y Loss: 0.039520
T Loss: 9.462998
Epoch 899 
Overall Loss: 9.506579
Rec Loss: 9.473519
KL Loss: 0.033061
Y Loss: 0.038362
T Loss: 9.454338
Epoch 949 
Overall Loss: 9.504304
Rec Loss: 9.469095
KL Loss: 0.035209
Y Loss: 0.038601
T Loss: 9.449795
Epoch 999 
Overall Loss: 9.496322
Rec Loss: 9.465843
KL Loss: 0.030479
Y Loss: 0.033964
T Loss: 9.448861
Epoch 1049 
Overall Loss: 9.492129
Rec Loss: 9.461859
KL Loss: 0.030270
Y Loss: 0.037999
T Loss: 9.442860
Epoch 1099 
Overall Loss: 9.498844
Rec Loss: 9.461830
KL Loss: 0.037014
Y Loss: 0.031845
T Loss: 9.445908
Epoch 1149 
Overall Loss: 9.485778
Rec Loss: 9.456060
KL Loss: 0.029719
Y Loss: 0.030509
T Loss: 9.440805
Epoch 1199 
Overall Loss: 9.478266
Rec Loss: 9.450832
KL Loss: 0.027434
Y Loss: 0.030965
T Loss: 9.435350
Epoch 1249 
Overall Loss: 9.482599
Rec Loss: 9.453682
KL Loss: 0.028916
Y Loss: 0.029710
T Loss: 9.438827
Epoch 1299 
Overall Loss: 9.481187
Rec Loss: 9.453165
KL Loss: 0.028022
Y Loss: 0.028853
T Loss: 9.438739
Epoch 1349 
Overall Loss: 9.471250
Rec Loss: 9.443611
KL Loss: 0.027639
Y Loss: 0.028515
T Loss: 9.429354
Epoch 1399 
Overall Loss: 9.470232
Rec Loss: 9.444666
KL Loss: 0.025566
Y Loss: 0.029560
T Loss: 9.429886
Epoch 1449 
Overall Loss: 9.472062
Rec Loss: 9.444089
KL Loss: 0.027973
Y Loss: 0.031473
T Loss: 9.428352
Epoch 1499 
Overall Loss: 9.474394
Rec Loss: 9.441233
KL Loss: 0.033160
Y Loss: 0.025804
T Loss: 9.428332
Epoch 1549 
Overall Loss: 9.469549
Rec Loss: 9.433843
KL Loss: 0.035707
Y Loss: 0.026538
T Loss: 9.420573
Epoch 1599 
Overall Loss: 9.456123
Rec Loss: 9.431491
KL Loss: 0.024631
Y Loss: 0.027398
T Loss: 9.417792
Epoch 1649 
Overall Loss: 9.457589
Rec Loss: 9.432685
KL Loss: 0.024904
Y Loss: 0.026365
T Loss: 9.419502
Epoch 1699 
Overall Loss: 9.454049
Rec Loss: 9.426097
KL Loss: 0.027953
Y Loss: 0.029196
T Loss: 9.411498
Epoch 1749 
Overall Loss: 9.451908
Rec Loss: 9.425352
KL Loss: 0.026555
Y Loss: 0.025006
T Loss: 9.412850
Epoch 1799 
Overall Loss: 9.451265
Rec Loss: 9.425565
KL Loss: 0.025700
Y Loss: 0.024136
T Loss: 9.413497
Epoch 1849 
Overall Loss: 9.454061
Rec Loss: 9.426984
KL Loss: 0.027077
Y Loss: 0.029185
T Loss: 9.412391
Epoch 1899 
Overall Loss: 9.445716
Rec Loss: 9.422057
KL Loss: 0.023659
Y Loss: 0.023983
T Loss: 9.410065
Epoch 1949 
Overall Loss: 9.445416
Rec Loss: 9.421989
KL Loss: 0.023427
Y Loss: 0.024363
T Loss: 9.409807
Epoch 1999 
Overall Loss: 9.442432
Rec Loss: 9.418045
KL Loss: 0.024386
Y Loss: 0.023389
T Loss: 9.406351
Epoch 2049 
Overall Loss: 9.441256
Rec Loss: 9.416699
KL Loss: 0.024557
Y Loss: 0.023032
T Loss: 9.405183
Epoch 2099 
Overall Loss: 9.433431
Rec Loss: 9.410722
KL Loss: 0.022710
Y Loss: 0.023063
T Loss: 9.399190
Epoch 2149 
Overall Loss: 9.438810
Rec Loss: 9.413244
KL Loss: 0.025567
Y Loss: 0.023396
T Loss: 9.401545
Epoch 2199 
Overall Loss: 9.437071
Rec Loss: 9.411708
KL Loss: 0.025363
Y Loss: 0.022608
T Loss: 9.400404
Epoch 2249 
Overall Loss: 9.438221
Rec Loss: 9.413656
KL Loss: 0.024564
Y Loss: 0.024474
T Loss: 9.401419
Epoch 2299 
Overall Loss: 9.431868
Rec Loss: 9.407548
KL Loss: 0.024319
Y Loss: 0.022750
T Loss: 9.396174
Epoch 2349 
Overall Loss: 9.428677
Rec Loss: 9.404455
KL Loss: 0.024222
Y Loss: 0.022149
T Loss: 9.393380
Epoch 2399 
Overall Loss: 9.425768
Rec Loss: 9.403531
KL Loss: 0.022236
Y Loss: 0.022013
T Loss: 9.392525
Epoch 2449 
Overall Loss: 9.421269
Rec Loss: 9.399871
KL Loss: 0.021398
Y Loss: 0.020510
T Loss: 9.389616
Epoch 2499 
Overall Loss: 9.425139
Rec Loss: 9.399233
KL Loss: 0.025905
Y Loss: 0.021420
T Loss: 9.388523
Epoch 2549 
Overall Loss: 9.425579
Rec Loss: 9.397113
KL Loss: 0.028467
Y Loss: 0.019626
T Loss: 9.387300
Epoch 2599 
Overall Loss: 9.417782
Rec Loss: 9.396690
KL Loss: 0.021093
Y Loss: 0.022528
T Loss: 9.385426
Epoch 2649 
Overall Loss: 9.421233
Rec Loss: 9.395158
KL Loss: 0.026074
Y Loss: 0.019694
T Loss: 9.385312
Epoch 2699 
Overall Loss: 9.419290
Rec Loss: 9.395536
KL Loss: 0.023754
Y Loss: 0.020291
T Loss: 9.385390
Epoch 2749 
Overall Loss: 9.414850
Rec Loss: 9.393989
KL Loss: 0.020861
Y Loss: 0.020148
T Loss: 9.383915
Epoch 2799 
Overall Loss: 9.411493
Rec Loss: 9.389900
KL Loss: 0.021593
Y Loss: 0.019436
T Loss: 9.380182
Epoch 2849 
Overall Loss: 9.424957
Rec Loss: 9.393571
KL Loss: 0.031387
Y Loss: 0.020247
T Loss: 9.383448
Epoch 2899 
Overall Loss: 9.414139
Rec Loss: 9.387889
KL Loss: 0.026250
Y Loss: 0.018275
T Loss: 9.378751
Epoch 2949 
Overall Loss: 9.412628
Rec Loss: 9.386677
KL Loss: 0.025951
Y Loss: 0.020127
T Loss: 9.376614
Epoch 2999 
Overall Loss: 9.404760
Rec Loss: 9.384401
KL Loss: 0.020359
Y Loss: 0.020824
T Loss: 9.373989
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.019721
Epoch 99
Rec Loss: 0.015419
Epoch 149
Rec Loss: 0.014379
Epoch 199
Rec Loss: 0.013165
Epoch 249
Rec Loss: 0.012611
Epoch 299
Rec Loss: 0.012208
Epoch 349
Rec Loss: 0.011888
Epoch 399
Rec Loss: 0.011807
Epoch 449
Rec Loss: 0.011889
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.732620
Epoch 99
Rec Loss: 9.719426
Epoch 149
Rec Loss: 9.691873
Epoch 199
Rec Loss: 9.663379
Epoch 249
Rec Loss: 9.645620
Epoch 299
Rec Loss: 9.607594
Epoch 349
Rec Loss: 9.576074
Epoch 399
Rec Loss: 9.580469
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.077165
Insample Error: 0.242007
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.052677
Epoch 99
Rec Loss: 4.056608
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.101225
Epoch 99
Rec Loss: 9.096094
Epoch 149
Rec Loss: 9.157935
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.986611
Insample Error 2.807667
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.433708
Epoch 99 
Prediction Loss: 0.162625
Epoch 149 
Prediction Loss: 0.070915
Epoch 199 
Prediction Loss: 0.048727
Epoch 249 
Prediction Loss: 0.041493
Epoch 299 
Prediction Loss: 0.033901
Epoch 349 
Prediction Loss: 0.034769
Epoch 399 
Prediction Loss: 0.026672
Epoch 449 
Prediction Loss: 0.025846
Epoch 499 
Prediction Loss: 0.023571
Epoch 549 
Prediction Loss: 0.020049
Epoch 599 
Prediction Loss: 0.021063
Epoch 649 
Prediction Loss: 0.016788
Epoch 699 
Prediction Loss: 0.014944
Epoch 749 
Prediction Loss: 0.013787
Epoch 799 
Prediction Loss: 0.014746
Epoch 849 
Prediction Loss: 0.013443
Epoch 899 
Prediction Loss: 0.011825
Epoch 949 
Prediction Loss: 0.010604
Epoch 999 
Prediction Loss: 0.008982
Epoch 1049 
Prediction Loss: 0.009478
Epoch 1099 
Prediction Loss: 0.008478
Epoch 1149 
Prediction Loss: 0.010500
Epoch 1199 
Prediction Loss: 0.008653
Epoch 1249 
Prediction Loss: 0.009560
Epoch 1299 
Prediction Loss: 0.009430
Epoch 1349 
Prediction Loss: 0.006822
Epoch 1399 
Prediction Loss: 0.006618
Epoch 1449 
Prediction Loss: 0.006084
Epoch 1499 
Prediction Loss: 0.006799
Epoch 1549 
Prediction Loss: 0.005393
Epoch 1599 
Prediction Loss: 0.005566
Epoch 1649 
Prediction Loss: 0.006852
Epoch 1699 
Prediction Loss: 0.005132
Epoch 1749 
Prediction Loss: 0.005350
Epoch 1799 
Prediction Loss: 0.005399
Epoch 1849 
Prediction Loss: 0.004711
Epoch 1899 
Prediction Loss: 0.006417
Epoch 1949 
Prediction Loss: 0.005274
Epoch 1999 
Prediction Loss: 0.006101
Epoch 2049 
Prediction Loss: 0.004572
Epoch 2099 
Prediction Loss: 0.004272
Epoch 2149 
Prediction Loss: 0.003848
Epoch 2199 
Prediction Loss: 0.004698
Epoch 2249 
Prediction Loss: 0.005997
Epoch 2299 
Prediction Loss: 0.003622
Epoch 2349 
Prediction Loss: 0.003853
Epoch 2399 
Prediction Loss: 0.004016
Epoch 2449 
Prediction Loss: 0.003857
Epoch 2499 
Prediction Loss: 0.005007
Epoch 2549 
Prediction Loss: 0.003399
Epoch 2599 
Prediction Loss: 0.003722
Epoch 2649 
Prediction Loss: 0.003868
Epoch 2699 
Prediction Loss: 0.003687
Epoch 2749 
Prediction Loss: 0.004225
Epoch 2799 
Prediction Loss: 0.003905
Epoch 2849 
Prediction Loss: 0.003787
Epoch 2899 
Prediction Loss: 0.003350
Epoch 2949 
Prediction Loss: 0.003442
Epoch 2999 
Prediction Loss: 0.002997
Epoch 3049 
Prediction Loss: 0.003115
Epoch 3099 
Prediction Loss: 0.003181
Epoch 3149 
Prediction Loss: 0.003308
Epoch 3199 
Prediction Loss: 0.003569
Epoch 3249 
Prediction Loss: 0.003555
Epoch 3299 
Prediction Loss: 0.004695
Epoch 3349 
Prediction Loss: 0.003046
Epoch 3399 
Prediction Loss: 0.002761
Epoch 3449 
Prediction Loss: 0.002783
Epoch 3499 
Prediction Loss: 0.003488
Epoch 3549 
Prediction Loss: 0.003258
Epoch 3599 
Prediction Loss: 0.002375
Epoch 3649 
Prediction Loss: 0.004498
Epoch 3699 
Prediction Loss: 0.003352
Epoch 3749 
Prediction Loss: 0.002698
Epoch 3799 
Prediction Loss: 0.002791
Epoch 3849 
Prediction Loss: 0.003061
Epoch 3899 
Prediction Loss: 0.002497
Epoch 3949 
Prediction Loss: 0.002575
Epoch 3999 
Prediction Loss: 0.002284
Epoch 4049 
Prediction Loss: 0.003190
Epoch 4099 
Prediction Loss: 0.002339
Epoch 4149 
Prediction Loss: 0.002063
Epoch 4199 
Prediction Loss: 0.002166
Epoch 4249 
Prediction Loss: 0.002334
Epoch 4299 
Prediction Loss: 0.003510
Epoch 4349 
Prediction Loss: 0.002951
Epoch 4399 
Prediction Loss: 0.002079
Epoch 4449 
Prediction Loss: 0.002901
Epoch 4499 
Prediction Loss: 0.001929
Epoch 4549 
Prediction Loss: 0.002009
Epoch 4599 
Prediction Loss: 0.002629
Epoch 4649 
Prediction Loss: 0.002402
Epoch 4699 
Prediction Loss: 0.004972
Epoch 4749 
Prediction Loss: 0.002171
Epoch 4799 
Prediction Loss: 0.003745
Epoch 4849 
Prediction Loss: 0.002708
Epoch 4899 
Prediction Loss: 0.001861
Epoch 4949 
Prediction Loss: 0.003008
Epoch 4999 
Prediction Loss: 0.001830
Epoch 5049 
Prediction Loss: 0.001815
Epoch 5099 
Prediction Loss: 0.002745
Epoch 5149 
Prediction Loss: 0.002665
Epoch 5199 
Prediction Loss: 0.001975
Epoch 5249 
Prediction Loss: 0.002030
Epoch 5299 
Prediction Loss: 0.002808
Epoch 5349 
Prediction Loss: 0.002081
Epoch 5399 
Prediction Loss: 0.002308
Epoch 5449 
Prediction Loss: 0.002054
Epoch 5499 
Prediction Loss: 0.002797
Epoch 5549 
Prediction Loss: 0.003937
Epoch 5599 
Prediction Loss: 0.002452
Epoch 5649 
Prediction Loss: 0.001819
Epoch 5699 
Prediction Loss: 0.002731
Epoch 5749 
Prediction Loss: 0.002273
Epoch 5799 
Prediction Loss: 0.001715
Epoch 5849 
Prediction Loss: 0.001827
Epoch 5899 
Prediction Loss: 0.001898
Epoch 5949 
Prediction Loss: 0.002533
Epoch 5999 
Prediction Loss: 0.002280
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.045936
Insample Error 0.163285
[31m========== repeat time 4 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.367015
Rec Loss: 9.767871
KL Loss: 0.599143
Y Loss: 0.943466
T Loss: 9.296138
Epoch 99 
Overall Loss: 9.753182
Rec Loss: 9.635737
KL Loss: 0.117445
Y Loss: 0.286868
T Loss: 9.492304
Epoch 149 
Overall Loss: 9.653349
Rec Loss: 9.569709
KL Loss: 0.083639
Y Loss: 0.158169
T Loss: 9.490625
Epoch 199 
Overall Loss: 9.619335
Rec Loss: 9.549958
KL Loss: 0.069377
Y Loss: 0.114647
T Loss: 9.492635
Epoch 249 
Overall Loss: 9.598819
Rec Loss: 9.537697
KL Loss: 0.061121
Y Loss: 0.095580
T Loss: 9.489908
Epoch 299 
Overall Loss: 9.583458
Rec Loss: 9.529381
KL Loss: 0.054077
Y Loss: 0.077733
T Loss: 9.490515
Epoch 349 
Overall Loss: 9.575973
Rec Loss: 9.520973
KL Loss: 0.055000
Y Loss: 0.069231
T Loss: 9.486357
Epoch 399 
Overall Loss: 9.569771
Rec Loss: 9.521367
KL Loss: 0.048404
Y Loss: 0.065291
T Loss: 9.488722
Epoch 449 
Overall Loss: 9.560137
Rec Loss: 9.514338
KL Loss: 0.045799
Y Loss: 0.056959
T Loss: 9.485858
Epoch 499 
Overall Loss: 9.547932
Rec Loss: 9.507070
KL Loss: 0.040862
Y Loss: 0.048162
T Loss: 9.482988
Epoch 549 
Overall Loss: 9.539479
Rec Loss: 9.500125
KL Loss: 0.039354
Y Loss: 0.046346
T Loss: 9.476952
Epoch 599 
Overall Loss: 9.543868
Rec Loss: 9.500487
KL Loss: 0.043381
Y Loss: 0.048242
T Loss: 9.476366
Epoch 649 
Overall Loss: 9.525922
Rec Loss: 9.491203
KL Loss: 0.034719
Y Loss: 0.038499
T Loss: 9.471954
Epoch 699 
Overall Loss: 9.521734
Rec Loss: 9.486543
KL Loss: 0.035191
Y Loss: 0.036696
T Loss: 9.468195
Epoch 749 
Overall Loss: 9.519040
Rec Loss: 9.486318
KL Loss: 0.032722
Y Loss: 0.036938
T Loss: 9.467849
Epoch 799 
Overall Loss: 9.510923
Rec Loss: 9.478990
KL Loss: 0.031934
Y Loss: 0.036241
T Loss: 9.460869
Epoch 849 
Overall Loss: 9.519251
Rec Loss: 9.476262
KL Loss: 0.042989
Y Loss: 0.031120
T Loss: 9.460702
Epoch 899 
Overall Loss: 9.503041
Rec Loss: 9.471564
KL Loss: 0.031477
Y Loss: 0.031124
T Loss: 9.456002
Epoch 949 
Overall Loss: 9.495898
Rec Loss: 9.466195
KL Loss: 0.029702
Y Loss: 0.030003
T Loss: 9.451194
Epoch 999 
Overall Loss: 9.498896
Rec Loss: 9.462476
KL Loss: 0.036419
Y Loss: 0.030040
T Loss: 9.447456
Epoch 1049 
Overall Loss: 9.495575
Rec Loss: 9.465584
KL Loss: 0.029991
Y Loss: 0.029956
T Loss: 9.450606
Epoch 1099 
Overall Loss: 9.483336
Rec Loss: 9.456694
KL Loss: 0.026642
Y Loss: 0.027436
T Loss: 9.442976
Epoch 1149 
Overall Loss: 9.483460
Rec Loss: 9.453981
KL Loss: 0.029478
Y Loss: 0.026513
T Loss: 9.440725
Epoch 1199 
Overall Loss: 9.486167
Rec Loss: 9.452856
KL Loss: 0.033312
Y Loss: 0.027589
T Loss: 9.439061
Epoch 1249 
Overall Loss: 9.492267
Rec Loss: 9.453006
KL Loss: 0.039261
Y Loss: 0.025080
T Loss: 9.440466
Epoch 1299 
Overall Loss: 9.484015
Rec Loss: 9.449896
KL Loss: 0.034119
Y Loss: 0.029571
T Loss: 9.435110
Epoch 1349 
Overall Loss: 9.471026
Rec Loss: 9.443682
KL Loss: 0.027344
Y Loss: 0.023974
T Loss: 9.431695
Epoch 1399 
Overall Loss: 9.467539
Rec Loss: 9.442172
KL Loss: 0.025367
Y Loss: 0.024353
T Loss: 9.429995
Epoch 1449 
Overall Loss: 9.468007
Rec Loss: 9.439413
KL Loss: 0.028593
Y Loss: 0.023221
T Loss: 9.427802
Epoch 1499 
Overall Loss: 9.477157
Rec Loss: 9.441389
KL Loss: 0.035768
Y Loss: 0.023201
T Loss: 9.429788
Epoch 1549 
Overall Loss: 9.462764
Rec Loss: 9.435850
KL Loss: 0.026914
Y Loss: 0.023612
T Loss: 9.424044
Epoch 1599 
Overall Loss: 9.464338
Rec Loss: 9.434421
KL Loss: 0.029916
Y Loss: 0.024298
T Loss: 9.422272
Epoch 1649 
Overall Loss: 9.452494
Rec Loss: 9.428818
KL Loss: 0.023676
Y Loss: 0.023139
T Loss: 9.417249
Epoch 1699 
Overall Loss: 9.451194
Rec Loss: 9.426919
KL Loss: 0.024276
Y Loss: 0.022942
T Loss: 9.415448
Epoch 1749 
Overall Loss: 9.447432
Rec Loss: 9.423043
KL Loss: 0.024389
Y Loss: 0.025121
T Loss: 9.410482
Epoch 1799 
Overall Loss: 9.448732
Rec Loss: 9.424432
KL Loss: 0.024299
Y Loss: 0.022457
T Loss: 9.413204
Epoch 1849 
Overall Loss: 9.448682
Rec Loss: 9.425130
KL Loss: 0.023552
Y Loss: 0.021840
T Loss: 9.414210
Epoch 1899 
Overall Loss: 9.445280
Rec Loss: 9.422738
KL Loss: 0.022542
Y Loss: 0.020386
T Loss: 9.412545
Epoch 1949 
Overall Loss: 9.445355
Rec Loss: 9.422460
KL Loss: 0.022896
Y Loss: 0.021679
T Loss: 9.411620
Epoch 1999 
Overall Loss: 9.440702
Rec Loss: 9.418399
KL Loss: 0.022303
Y Loss: 0.022091
T Loss: 9.407353
Epoch 2049 
Overall Loss: 9.444355
Rec Loss: 9.417047
KL Loss: 0.027308
Y Loss: 0.020713
T Loss: 9.406691
Epoch 2099 
Overall Loss: 9.436823
Rec Loss: 9.413406
KL Loss: 0.023417
Y Loss: 0.018810
T Loss: 9.404001
Epoch 2149 
Overall Loss: 9.444372
Rec Loss: 9.414438
KL Loss: 0.029935
Y Loss: 0.020418
T Loss: 9.404229
Epoch 2199 
Overall Loss: 9.450780
Rec Loss: 9.412373
KL Loss: 0.038407
Y Loss: 0.019621
T Loss: 9.402563
Epoch 2249 
Overall Loss: 9.433349
Rec Loss: 9.410461
KL Loss: 0.022888
Y Loss: 0.019072
T Loss: 9.400925
Epoch 2299 
Overall Loss: 9.430508
Rec Loss: 9.405269
KL Loss: 0.025239
Y Loss: 0.018915
T Loss: 9.395811
Epoch 2349 
Overall Loss: 9.429497
Rec Loss: 9.406538
KL Loss: 0.022959
Y Loss: 0.021349
T Loss: 9.395864
Epoch 2399 
Overall Loss: 9.423622
Rec Loss: 9.400255
KL Loss: 0.023366
Y Loss: 0.018760
T Loss: 9.390875
Epoch 2449 
Overall Loss: 9.426544
Rec Loss: 9.401153
KL Loss: 0.025391
Y Loss: 0.019209
T Loss: 9.391549
Epoch 2499 
Overall Loss: 9.423547
Rec Loss: 9.399783
KL Loss: 0.023764
Y Loss: 0.017873
T Loss: 9.390846
Epoch 2549 
Overall Loss: 9.427499
Rec Loss: 9.400352
KL Loss: 0.027147
Y Loss: 0.017855
T Loss: 9.391424
Epoch 2599 
Overall Loss: 9.421855
Rec Loss: 9.397203
KL Loss: 0.024652
Y Loss: 0.018052
T Loss: 9.388177
Epoch 2649 
Overall Loss: 9.416398
Rec Loss: 9.393994
KL Loss: 0.022403
Y Loss: 0.019341
T Loss: 9.384323
Epoch 2699 
Overall Loss: 9.417300
Rec Loss: 9.395509
KL Loss: 0.021791
Y Loss: 0.019516
T Loss: 9.385751
Epoch 2749 
Overall Loss: 9.413871
Rec Loss: 9.392672
KL Loss: 0.021199
Y Loss: 0.018037
T Loss: 9.383654
Epoch 2799 
Overall Loss: 9.407324
Rec Loss: 9.387968
KL Loss: 0.019356
Y Loss: 0.021286
T Loss: 9.377325
Epoch 2849 
Overall Loss: 9.457609
Rec Loss: 9.389952
KL Loss: 0.067656
Y Loss: 0.019382
T Loss: 9.380261
Epoch 2899 
Overall Loss: 9.409040
Rec Loss: 9.387423
KL Loss: 0.021618
Y Loss: 0.018110
T Loss: 9.378368
Epoch 2949 
Overall Loss: 9.406120
Rec Loss: 9.384792
KL Loss: 0.021328
Y Loss: 0.016986
T Loss: 9.376299
Epoch 2999 
Overall Loss: 9.413903
Rec Loss: 9.390331
KL Loss: 0.023572
Y Loss: 0.017414
T Loss: 9.381624
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.015480
Epoch 99
Rec Loss: 0.012160
Epoch 149
Rec Loss: 0.010837
Epoch 199
Rec Loss: 0.010033
Epoch 249
Rec Loss: 0.009800
Epoch 299
Rec Loss: 0.009577
Epoch 349
Rec Loss: 0.009494
Epoch 399
Rec Loss: 0.009386
Epoch 449
Rec Loss: 0.009195
Epoch 499
Rec Loss: 0.009093
Epoch 549
Rec Loss: 0.009209
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.736339
Epoch 99
Rec Loss: 9.719660
Epoch 149
Rec Loss: 9.708216
Epoch 199
Rec Loss: 9.685244
Epoch 249
Rec Loss: 9.680678
Epoch 299
Rec Loss: 9.653344
Epoch 349
Rec Loss: 9.654871
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.068507
Insample Error: 0.209895
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.049971
Epoch 99
Rec Loss: 4.043583
Epoch 149
Rec Loss: 4.048899
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.297860
Epoch 99
Rec Loss: 9.260684
Epoch 149
Rec Loss: 9.210860
Epoch 199
Rec Loss: 9.280741
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.007667
Insample Error 2.810357
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.437965
Epoch 99 
Prediction Loss: 0.177038
Epoch 149 
Prediction Loss: 0.087369
Epoch 199 
Prediction Loss: 0.055416
Epoch 249 
Prediction Loss: 0.044105
Epoch 299 
Prediction Loss: 0.040241
Epoch 349 
Prediction Loss: 0.029521
Epoch 399 
Prediction Loss: 0.027202
Epoch 449 
Prediction Loss: 0.024397
Epoch 499 
Prediction Loss: 0.024494
Epoch 549 
Prediction Loss: 0.019894
Epoch 599 
Prediction Loss: 0.017670
Epoch 649 
Prediction Loss: 0.015601
Epoch 699 
Prediction Loss: 0.013927
Epoch 749 
Prediction Loss: 0.014709
Epoch 799 
Prediction Loss: 0.013491
Epoch 849 
Prediction Loss: 0.011420
Epoch 899 
Prediction Loss: 0.011212
Epoch 949 
Prediction Loss: 0.009778
Epoch 999 
Prediction Loss: 0.010407
Epoch 1049 
Prediction Loss: 0.010165
Epoch 1099 
Prediction Loss: 0.008536
Epoch 1149 
Prediction Loss: 0.009264
Epoch 1199 
Prediction Loss: 0.007395
Epoch 1249 
Prediction Loss: 0.007277
Epoch 1299 
Prediction Loss: 0.007059
Epoch 1349 
Prediction Loss: 0.007155
Epoch 1399 
Prediction Loss: 0.006937
Epoch 1449 
Prediction Loss: 0.006122
Epoch 1499 
Prediction Loss: 0.005974
Epoch 1549 
Prediction Loss: 0.005715
Epoch 1599 
Prediction Loss: 0.005404
Epoch 1649 
Prediction Loss: 0.005218
Epoch 1699 
Prediction Loss: 0.005235
Epoch 1749 
Prediction Loss: 0.007066
Epoch 1799 
Prediction Loss: 0.004472
Epoch 1849 
Prediction Loss: 0.004802
Epoch 1899 
Prediction Loss: 0.005729
Epoch 1949 
Prediction Loss: 0.004953
Epoch 1999 
Prediction Loss: 0.006200
Epoch 2049 
Prediction Loss: 0.004678
Epoch 2099 
Prediction Loss: 0.003960
Epoch 2149 
Prediction Loss: 0.004366
Epoch 2199 
Prediction Loss: 0.006112
Epoch 2249 
Prediction Loss: 0.003976
Epoch 2299 
Prediction Loss: 0.003700
Epoch 2349 
Prediction Loss: 0.004397
Epoch 2399 
Prediction Loss: 0.004191
Epoch 2449 
Prediction Loss: 0.004594
Epoch 2499 
Prediction Loss: 0.003227
Epoch 2549 
Prediction Loss: 0.004265
Epoch 2599 
Prediction Loss: 0.003791
Epoch 2649 
Prediction Loss: 0.003551
Epoch 2699 
Prediction Loss: 0.003787
Epoch 2749 
Prediction Loss: 0.003586
Epoch 2799 
Prediction Loss: 0.002966
Epoch 2849 
Prediction Loss: 0.003975
Epoch 2899 
Prediction Loss: 0.003604
Epoch 2949 
Prediction Loss: 0.004343
Epoch 2999 
Prediction Loss: 0.002905
Epoch 3049 
Prediction Loss: 0.002497
Epoch 3099 
Prediction Loss: 0.003140
Epoch 3149 
Prediction Loss: 0.002584
Epoch 3199 
Prediction Loss: 0.005228
Epoch 3249 
Prediction Loss: 0.003453
Epoch 3299 
Prediction Loss: 0.002769
Epoch 3349 
Prediction Loss: 0.002990
Epoch 3399 
Prediction Loss: 0.002426
Epoch 3449 
Prediction Loss: 0.002451
Epoch 3499 
Prediction Loss: 0.002753
Epoch 3549 
Prediction Loss: 0.002664
Epoch 3599 
Prediction Loss: 0.003055
Epoch 3649 
Prediction Loss: 0.004761
Epoch 3699 
Prediction Loss: 0.002635
Epoch 3749 
Prediction Loss: 0.004015
Epoch 3799 
Prediction Loss: 0.002348
Epoch 3849 
Prediction Loss: 0.002575
Epoch 3899 
Prediction Loss: 0.002414
Epoch 3949 
Prediction Loss: 0.002113
Epoch 3999 
Prediction Loss: 0.002196
Epoch 4049 
Prediction Loss: 0.001953
Epoch 4099 
Prediction Loss: 0.001925
Epoch 4149 
Prediction Loss: 0.002359
Epoch 4199 
Prediction Loss: 0.002316
Epoch 4249 
Prediction Loss: 0.003461
Epoch 4299 
Prediction Loss: 0.002393
Epoch 4349 
Prediction Loss: 0.001881
Epoch 4399 
Prediction Loss: 0.002890
Epoch 4449 
Prediction Loss: 0.001847
Epoch 4499 
Prediction Loss: 0.002620
Epoch 4549 
Prediction Loss: 0.003535
Epoch 4599 
Prediction Loss: 0.003872
Epoch 4649 
Prediction Loss: 0.001727
Epoch 4699 
Prediction Loss: 0.002257
Epoch 4749 
Prediction Loss: 0.004147
Epoch 4799 
Prediction Loss: 0.001924
Epoch 4849 
Prediction Loss: 0.002348
Epoch 4899 
Prediction Loss: 0.002973
Epoch 4949 
Prediction Loss: 0.002901
Epoch 4999 
Prediction Loss: 0.002203
Epoch 5049 
Prediction Loss: 0.001867
Epoch 5099 
Prediction Loss: 0.003377
Epoch 5149 
Prediction Loss: 0.002909
Epoch 5199 
Prediction Loss: 0.002389
Epoch 5249 
Prediction Loss: 0.001635
Epoch 5299 
Prediction Loss: 0.002130
Epoch 5349 
Prediction Loss: 0.002039
Epoch 5399 
Prediction Loss: 0.002632
Epoch 5449 
Prediction Loss: 0.001646
Epoch 5499 
Prediction Loss: 0.001853
Epoch 5549 
Prediction Loss: 0.001616
Epoch 5599 
Prediction Loss: 0.004464
Epoch 5649 
Prediction Loss: 0.001985
Epoch 5699 
Prediction Loss: 0.002101
Epoch 5749 
Prediction Loss: 0.002265
Epoch 5799 
Prediction Loss: 0.002245
Epoch 5849 
Prediction Loss: 0.002442
Epoch 5899 
Prediction Loss: 0.003386
Epoch 5949 
Prediction Loss: 0.001585
Epoch 5999 
Prediction Loss: 0.001661
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.036640
Insample Error 0.162126
[31m========== repeat time 5 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.401679
Rec Loss: 9.782535
KL Loss: 0.619144
Y Loss: 0.968044
T Loss: 9.298514
Epoch 99 
Overall Loss: 9.780849
Rec Loss: 9.649665
KL Loss: 0.131184
Y Loss: 0.324043
T Loss: 9.487644
Epoch 149 
Overall Loss: 9.683731
Rec Loss: 9.590070
KL Loss: 0.093661
Y Loss: 0.189102
T Loss: 9.495519
Epoch 199 
Overall Loss: 9.633137
Rec Loss: 9.556851
KL Loss: 0.076286
Y Loss: 0.134952
T Loss: 9.489376
Epoch 249 
Overall Loss: 9.612633
Rec Loss: 9.548979
KL Loss: 0.063654
Y Loss: 0.107776
T Loss: 9.495091
Epoch 299 
Overall Loss: 9.591097
Rec Loss: 9.532423
KL Loss: 0.058674
Y Loss: 0.095602
T Loss: 9.484621
Epoch 349 
Overall Loss: 9.581535
Rec Loss: 9.528327
KL Loss: 0.053207
Y Loss: 0.083283
T Loss: 9.486685
Epoch 399 
Overall Loss: 9.574329
Rec Loss: 9.523005
KL Loss: 0.051324
Y Loss: 0.072425
T Loss: 9.486792
Epoch 449 
Overall Loss: 9.566177
Rec Loss: 9.519080
KL Loss: 0.047096
Y Loss: 0.062895
T Loss: 9.487633
Epoch 499 
Overall Loss: 9.554043
Rec Loss: 9.509797
KL Loss: 0.044246
Y Loss: 0.058934
T Loss: 9.480330
Epoch 549 
Overall Loss: 9.549942
Rec Loss: 9.508428
KL Loss: 0.041514
Y Loss: 0.054960
T Loss: 9.480948
Epoch 599 
Overall Loss: 9.541922
Rec Loss: 9.504252
KL Loss: 0.037670
Y Loss: 0.054478
T Loss: 9.477013
Epoch 649 
Overall Loss: 9.531472
Rec Loss: 9.494641
KL Loss: 0.036831
Y Loss: 0.045415
T Loss: 9.471933
Epoch 699 
Overall Loss: 9.529220
Rec Loss: 9.490722
KL Loss: 0.038498
Y Loss: 0.045739
T Loss: 9.467853
Epoch 749 
Overall Loss: 9.536763
Rec Loss: 9.489784
KL Loss: 0.046980
Y Loss: 0.042262
T Loss: 9.468653
Epoch 799 
Overall Loss: 9.520893
Rec Loss: 9.484951
KL Loss: 0.035942
Y Loss: 0.039693
T Loss: 9.465105
Epoch 849 
Overall Loss: 9.518203
Rec Loss: 9.481128
KL Loss: 0.037075
Y Loss: 0.039885
T Loss: 9.461185
Epoch 899 
Overall Loss: 9.511762
Rec Loss: 9.478368
KL Loss: 0.033394
Y Loss: 0.035830
T Loss: 9.460453
Epoch 949 
Overall Loss: 9.508138
Rec Loss: 9.474774
KL Loss: 0.033365
Y Loss: 0.034636
T Loss: 9.457456
Epoch 999 
Overall Loss: 9.501857
Rec Loss: 9.469717
KL Loss: 0.032140
Y Loss: 0.034256
T Loss: 9.452588
Epoch 1049 
Overall Loss: 9.494651
Rec Loss: 9.462283
KL Loss: 0.032368
Y Loss: 0.031703
T Loss: 9.446431
Epoch 1099 
Overall Loss: 9.492903
Rec Loss: 9.463491
KL Loss: 0.029412
Y Loss: 0.030517
T Loss: 9.448233
Epoch 1149 
Overall Loss: 9.490509
Rec Loss: 9.460080
KL Loss: 0.030429
Y Loss: 0.030733
T Loss: 9.444714
Epoch 1199 
Overall Loss: 9.488121
Rec Loss: 9.455530
KL Loss: 0.032592
Y Loss: 0.039765
T Loss: 9.435648
Epoch 1249 
Overall Loss: 9.486266
Rec Loss: 9.457277
KL Loss: 0.028989
Y Loss: 0.028820
T Loss: 9.442867
Epoch 1299 
Overall Loss: 9.480028
Rec Loss: 9.452086
KL Loss: 0.027942
Y Loss: 0.028636
T Loss: 9.437768
Epoch 1349 
Overall Loss: 9.492986
Rec Loss: 9.456215
KL Loss: 0.036771
Y Loss: 0.047697
T Loss: 9.432366
Epoch 1399 
Overall Loss: 9.477088
Rec Loss: 9.449552
KL Loss: 0.027535
Y Loss: 0.027067
T Loss: 9.436019
Epoch 1449 
Overall Loss: 9.471902
Rec Loss: 9.443851
KL Loss: 0.028051
Y Loss: 0.027823
T Loss: 9.429940
Epoch 1499 
Overall Loss: 9.478782
Rec Loss: 9.442809
KL Loss: 0.035973
Y Loss: 0.027038
T Loss: 9.429290
Epoch 1549 
Overall Loss: 9.463884
Rec Loss: 9.436787
KL Loss: 0.027097
Y Loss: 0.027865
T Loss: 9.422855
Epoch 1599 
Overall Loss: 9.489638
Rec Loss: 9.447865
KL Loss: 0.041773
Y Loss: 0.059563
T Loss: 9.418083
Epoch 1649 
Overall Loss: 9.464371
Rec Loss: 9.435575
KL Loss: 0.028795
Y Loss: 0.024523
T Loss: 9.423313
Epoch 1699 
Overall Loss: 9.460570
Rec Loss: 9.431646
KL Loss: 0.028924
Y Loss: 0.025746
T Loss: 9.418773
Epoch 1749 
Overall Loss: 9.454099
Rec Loss: 9.428663
KL Loss: 0.025436
Y Loss: 0.023491
T Loss: 9.416918
Epoch 1799 
Overall Loss: 9.450504
Rec Loss: 9.426398
KL Loss: 0.024106
Y Loss: 0.024392
T Loss: 9.414202
Epoch 1849 
Overall Loss: 9.453948
Rec Loss: 9.428859
KL Loss: 0.025090
Y Loss: 0.022711
T Loss: 9.417503
Epoch 1899 
Overall Loss: 9.452563
Rec Loss: 9.426139
KL Loss: 0.026424
Y Loss: 0.024388
T Loss: 9.413945
Epoch 1949 
Overall Loss: 9.443627
Rec Loss: 9.419005
KL Loss: 0.024622
Y Loss: 0.023148
T Loss: 9.407432
Epoch 1999 
Overall Loss: 9.444613
Rec Loss: 9.418382
KL Loss: 0.026230
Y Loss: 0.029524
T Loss: 9.403621
Epoch 2049 
Overall Loss: 9.451926
Rec Loss: 9.423574
KL Loss: 0.028353
Y Loss: 0.031751
T Loss: 9.407698
Epoch 2099 
Overall Loss: 9.441046
Rec Loss: 9.416401
KL Loss: 0.024645
Y Loss: 0.024434
T Loss: 9.404184
Epoch 2149 
Overall Loss: 9.438177
Rec Loss: 9.410763
KL Loss: 0.027413
Y Loss: 0.021378
T Loss: 9.400075
Epoch 2199 
Overall Loss: 9.439016
Rec Loss: 9.412391
KL Loss: 0.026625
Y Loss: 0.022235
T Loss: 9.401274
Epoch 2249 
Overall Loss: 9.435003
Rec Loss: 9.411776
KL Loss: 0.023227
Y Loss: 0.021363
T Loss: 9.401095
Epoch 2299 
Overall Loss: 9.437159
Rec Loss: 9.411034
KL Loss: 0.026124
Y Loss: 0.021240
T Loss: 9.400414
Epoch 2349 
Overall Loss: 9.433872
Rec Loss: 9.408211
KL Loss: 0.025662
Y Loss: 0.020868
T Loss: 9.397777
Epoch 2399 
Overall Loss: 9.428101
Rec Loss: 9.405710
KL Loss: 0.022390
Y Loss: 0.020850
T Loss: 9.395285
Epoch 2449 
Overall Loss: 9.435431
Rec Loss: 9.403897
KL Loss: 0.031534
Y Loss: 0.021513
T Loss: 9.393140
Epoch 2499 
Overall Loss: 9.423171
Rec Loss: 9.402600
KL Loss: 0.020571
Y Loss: 0.019843
T Loss: 9.392678
Epoch 2549 
Overall Loss: 9.439820
Rec Loss: 9.405260
KL Loss: 0.034560
Y Loss: 0.019514
T Loss: 9.395503
Epoch 2599 
Overall Loss: 9.430927
Rec Loss: 9.404900
KL Loss: 0.026027
Y Loss: 0.019276
T Loss: 9.395262
Epoch 2649 
Overall Loss: 9.421029
Rec Loss: 9.398646
KL Loss: 0.022383
Y Loss: 0.019606
T Loss: 9.388843
Epoch 2699 
Overall Loss: 9.425800
Rec Loss: 9.403587
KL Loss: 0.022213
Y Loss: 0.025022
T Loss: 9.391076
Epoch 2749 
Overall Loss: 9.418142
Rec Loss: 9.395048
KL Loss: 0.023094
Y Loss: 0.018901
T Loss: 9.385597
Epoch 2799 
Overall Loss: 9.420531
Rec Loss: 9.397814
KL Loss: 0.022718
Y Loss: 0.018765
T Loss: 9.388432
Epoch 2849 
Overall Loss: 9.417283
Rec Loss: 9.393839
KL Loss: 0.023444
Y Loss: 0.017912
T Loss: 9.384883
Epoch 2899 
Overall Loss: 9.411904
Rec Loss: 9.392240
KL Loss: 0.019664
Y Loss: 0.021606
T Loss: 9.381438
Epoch 2949 
Overall Loss: 9.417877
Rec Loss: 9.393526
KL Loss: 0.024351
Y Loss: 0.021031
T Loss: 9.383011
Epoch 2999 
Overall Loss: 9.432169
Rec Loss: 9.397158
KL Loss: 0.035011
Y Loss: 0.019590
T Loss: 9.387363
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.021944
Epoch 99
Rec Loss: 0.015076
Epoch 149
Rec Loss: 0.013687
Epoch 199
Rec Loss: 0.012835
Epoch 249
Rec Loss: 0.011995
Epoch 299
Rec Loss: 0.011757
Epoch 349
Rec Loss: 0.011584
Epoch 399
Rec Loss: 0.011506
Epoch 449
Rec Loss: 0.011697
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.732995
Epoch 99
Rec Loss: 9.704981
Epoch 149
Rec Loss: 9.668332
Epoch 199
Rec Loss: 9.636345
Epoch 249
Rec Loss: 9.613236
Epoch 299
Rec Loss: 9.604659
Epoch 349
Rec Loss: 9.595321
Epoch 399
Rec Loss: 9.594763
Epoch 449
Rec Loss: 9.571855
Epoch 499
Rec Loss: 9.579727
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.074654
Insample Error: 0.218315
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.060803
Epoch 99
Rec Loss: 4.061670
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.417592
Epoch 99
Rec Loss: 9.393997
Epoch 149
Rec Loss: 9.324182
Epoch 199
Rec Loss: 9.338306
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.994837
Insample Error 2.804851
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.488686
Epoch 99 
Prediction Loss: 0.183860
Epoch 149 
Prediction Loss: 0.086756
Epoch 199 
Prediction Loss: 0.055029
Epoch 249 
Prediction Loss: 0.041782
Epoch 299 
Prediction Loss: 0.037339
Epoch 349 
Prediction Loss: 0.031776
Epoch 399 
Prediction Loss: 0.028447
Epoch 449 
Prediction Loss: 0.026034
Epoch 499 
Prediction Loss: 0.023227
Epoch 549 
Prediction Loss: 0.021213
Epoch 599 
Prediction Loss: 0.018976
Epoch 649 
Prediction Loss: 0.016348
Epoch 699 
Prediction Loss: 0.015215
Epoch 749 
Prediction Loss: 0.015416
Epoch 799 
Prediction Loss: 0.013248
Epoch 849 
Prediction Loss: 0.011646
Epoch 899 
Prediction Loss: 0.011805
Epoch 949 
Prediction Loss: 0.011892
Epoch 999 
Prediction Loss: 0.010961
Epoch 1049 
Prediction Loss: 0.010239
Epoch 1099 
Prediction Loss: 0.009308
Epoch 1149 
Prediction Loss: 0.009471
Epoch 1199 
Prediction Loss: 0.009305
Epoch 1249 
Prediction Loss: 0.008470
Epoch 1299 
Prediction Loss: 0.007919
Epoch 1349 
Prediction Loss: 0.008322
Epoch 1399 
Prediction Loss: 0.008134
Epoch 1449 
Prediction Loss: 0.007611
Epoch 1499 
Prediction Loss: 0.006891
Epoch 1549 
Prediction Loss: 0.006914
Epoch 1599 
Prediction Loss: 0.006181
Epoch 1649 
Prediction Loss: 0.005916
Epoch 1699 
Prediction Loss: 0.006658
Epoch 1749 
Prediction Loss: 0.006262
Epoch 1799 
Prediction Loss: 0.005578
Epoch 1849 
Prediction Loss: 0.006967
Epoch 1899 
Prediction Loss: 0.006993
Epoch 1949 
Prediction Loss: 0.005922
Epoch 1999 
Prediction Loss: 0.006400
Epoch 2049 
Prediction Loss: 0.006087
Epoch 2099 
Prediction Loss: 0.006337
Epoch 2149 
Prediction Loss: 0.005070
Epoch 2199 
Prediction Loss: 0.004568
Epoch 2249 
Prediction Loss: 0.004819
Epoch 2299 
Prediction Loss: 0.004804
Epoch 2349 
Prediction Loss: 0.004285
Epoch 2399 
Prediction Loss: 0.006171
Epoch 2449 
Prediction Loss: 0.003934
Epoch 2499 
Prediction Loss: 0.004494
Epoch 2549 
Prediction Loss: 0.006371
Epoch 2599 
Prediction Loss: 0.004470
Epoch 2649 
Prediction Loss: 0.004007
Epoch 2699 
Prediction Loss: 0.003750
Epoch 2749 
Prediction Loss: 0.004091
Epoch 2799 
Prediction Loss: 0.004931
Epoch 2849 
Prediction Loss: 0.006505
Epoch 2899 
Prediction Loss: 0.003668
Epoch 2949 
Prediction Loss: 0.007608
Epoch 2999 
Prediction Loss: 0.003671
Epoch 3049 
Prediction Loss: 0.003819
Epoch 3099 
Prediction Loss: 0.004087
Epoch 3149 
Prediction Loss: 0.004587
Epoch 3199 
Prediction Loss: 0.003782
Epoch 3249 
Prediction Loss: 0.003875
Epoch 3299 
Prediction Loss: 0.005448
Epoch 3349 
Prediction Loss: 0.003232
Epoch 3399 
Prediction Loss: 0.002831
Epoch 3449 
Prediction Loss: 0.003433
Epoch 3499 
Prediction Loss: 0.003137
Epoch 3549 
Prediction Loss: 0.003027
Epoch 3599 
Prediction Loss: 0.003923
Epoch 3649 
Prediction Loss: 0.003950
Epoch 3699 
Prediction Loss: 0.003175
Epoch 3749 
Prediction Loss: 0.003310
Epoch 3799 
Prediction Loss: 0.003866
Epoch 3849 
Prediction Loss: 0.002714
Epoch 3899 
Prediction Loss: 0.003458
Epoch 3949 
Prediction Loss: 0.003239
Epoch 3999 
Prediction Loss: 0.002728
Epoch 4049 
Prediction Loss: 0.005013
Epoch 4099 
Prediction Loss: 0.004756
Epoch 4149 
Prediction Loss: 0.002721
Epoch 4199 
Prediction Loss: 0.003249
Epoch 4249 
Prediction Loss: 0.002666
Epoch 4299 
Prediction Loss: 0.003426
Epoch 4349 
Prediction Loss: 0.003164
Epoch 4399 
Prediction Loss: 0.003115
Epoch 4449 
Prediction Loss: 0.002478
Epoch 4499 
Prediction Loss: 0.002221
Epoch 4549 
Prediction Loss: 0.002480
Epoch 4599 
Prediction Loss: 0.004310
Epoch 4649 
Prediction Loss: 0.002151
Epoch 4699 
Prediction Loss: 0.002235
Epoch 4749 
Prediction Loss: 0.003551
Epoch 4799 
Prediction Loss: 0.003625
Epoch 4849 
Prediction Loss: 0.002585
Epoch 4899 
Prediction Loss: 0.002384
Epoch 4949 
Prediction Loss: 0.002631
Epoch 4999 
Prediction Loss: 0.002347
Epoch 5049 
Prediction Loss: 0.003419
Epoch 5099 
Prediction Loss: 0.006651
Epoch 5149 
Prediction Loss: 0.002771
Epoch 5199 
Prediction Loss: 0.002976
Epoch 5249 
Prediction Loss: 0.002334
Epoch 5299 
Prediction Loss: 0.002092
Epoch 5349 
Prediction Loss: 0.002253
Epoch 5399 
Prediction Loss: 0.003800
Epoch 5449 
Prediction Loss: 0.002708
Epoch 5499 
Prediction Loss: 0.001903
Epoch 5549 
Prediction Loss: 0.003099
Epoch 5599 
Prediction Loss: 0.005057
Epoch 5649 
Prediction Loss: 0.002394
Epoch 5699 
Prediction Loss: 0.001847
Epoch 5749 
Prediction Loss: 0.002868
Epoch 5799 
Prediction Loss: 0.002748
Epoch 5849 
Prediction Loss: 0.002174
Epoch 5899 
Prediction Loss: 0.001987
Epoch 5949 
Prediction Loss: 0.002549
Epoch 5999 
Prediction Loss: 0.002533
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.039799
Insample Error 0.166045
Ours, Train RMSE
0.0651, 
0.0713, 
0.0772, 
0.0685, 
0.0747, 
CEVAE, Train RMSE
3.0061, 
2.9900, 
2.9866, 
3.0077, 
2.9948, 
Ours, Insample RMSE
0.2231, 
0.2063, 
0.2420, 
0.2099, 
0.2183, 
CEVAE, Insample RMSE
2.8035, 
2.7977, 
2.8077, 
2.8104, 
2.8049, 
Direct Regression, Insample RMSE
0.1693, 
0.2338, 
0.1633, 
0.1621, 
0.1660, 
Train, RMSE mean 0.0713 std 0.0043
CEVAE, RMSE mean 2.9970 std 0.0085
Ours, RMSE mean 0.2199 std 0.0125, reconstruct confounder 0.0104 (0.0011) noise 9.5695 (0.0478)
CEVAE, RMSE mean 2.8048 std 0.0043, reconstruct confounder 4.0509 (0.0081) noise 9.1902 (0.2403)
Direct Regression, RMSE mean 0.1789 std 0.0276
Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=4, mask=0, nlayer=50, obsm=4, stop=2000, ycof=0.5, ylayer=50)
Y Mean 1.776465, Std 3.501489 
Test Y Mean -0.006496, Std 3.341313 
Observe confounder 4, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.091420
Rec Loss: 9.843287
KL Loss: 0.248134
Y Loss: 0.592011
T Loss: 9.547281
Epoch 99 
Overall Loss: 9.841494
Rec Loss: 9.713861
KL Loss: 0.127634
Y Loss: 0.271391
T Loss: 9.578166
Epoch 149 
Overall Loss: 9.763934
Rec Loss: 9.661862
KL Loss: 0.102072
Y Loss: 0.165922
T Loss: 9.578902
Epoch 199 
Overall Loss: 9.725229
Rec Loss: 9.633140
KL Loss: 0.092089
Y Loss: 0.114478
T Loss: 9.575901
Epoch 249 
Overall Loss: 9.701840
Rec Loss: 9.623482
KL Loss: 0.078358
Y Loss: 0.084998
T Loss: 9.580983
Epoch 299 
Overall Loss: 9.679581
Rec Loss: 9.606798
KL Loss: 0.072783
Y Loss: 0.072480
T Loss: 9.570558
Epoch 349 
Overall Loss: 9.674313
Rec Loss: 9.605331
KL Loss: 0.068981
Y Loss: 0.066029
T Loss: 9.572317
Epoch 399 
Overall Loss: 9.664017
Rec Loss: 9.599796
KL Loss: 0.064222
Y Loss: 0.057475
T Loss: 9.571058
Epoch 449 
Overall Loss: 9.656161
Rec Loss: 9.595887
KL Loss: 0.060274
Y Loss: 0.048369
T Loss: 9.571702
Epoch 499 
Overall Loss: 9.653965
Rec Loss: 9.591233
KL Loss: 0.062732
Y Loss: 0.048718
T Loss: 9.566874
Epoch 549 
Overall Loss: 9.643678
Rec Loss: 9.587875
KL Loss: 0.055803
Y Loss: 0.043644
T Loss: 9.566053
Epoch 599 
Overall Loss: 9.633731
Rec Loss: 9.582010
KL Loss: 0.051721
Y Loss: 0.040465
T Loss: 9.561777
Epoch 649 
Overall Loss: 9.634662
Rec Loss: 9.582931
KL Loss: 0.051731
Y Loss: 0.039237
T Loss: 9.563312
Epoch 699 
Overall Loss: 9.634478
Rec Loss: 9.584043
KL Loss: 0.050434
Y Loss: 0.041209
T Loss: 9.563439
Epoch 749 
Overall Loss: 9.624240
Rec Loss: 9.577441
KL Loss: 0.046800
Y Loss: 0.037006
T Loss: 9.558937
Epoch 799 
Overall Loss: 9.649947
Rec Loss: 9.577278
KL Loss: 0.072669
Y Loss: 0.037218
T Loss: 9.558669
Epoch 849 
Overall Loss: 9.614647
Rec Loss: 9.572576
KL Loss: 0.042071
Y Loss: 0.033782
T Loss: 9.555685
Epoch 899 
Overall Loss: 9.609396
Rec Loss: 9.568127
KL Loss: 0.041269
Y Loss: 0.030620
T Loss: 9.552816
Epoch 949 
Overall Loss: 9.607216
Rec Loss: 9.565132
KL Loss: 0.042084
Y Loss: 0.030696
T Loss: 9.549783
Epoch 999 
Overall Loss: 9.623904
Rec Loss: 9.567570
KL Loss: 0.056335
Y Loss: 0.032731
T Loss: 9.551204
Epoch 1049 
Overall Loss: 9.599452
Rec Loss: 9.558419
KL Loss: 0.041032
Y Loss: 0.028729
T Loss: 9.544055
Epoch 1099 
Overall Loss: 9.602882
Rec Loss: 9.562664
KL Loss: 0.040219
Y Loss: 0.026891
T Loss: 9.549219
Epoch 1149 
Overall Loss: 9.591564
Rec Loss: 9.551014
KL Loss: 0.040550
Y Loss: 0.029940
T Loss: 9.536044
Epoch 1199 
Overall Loss: 9.599610
Rec Loss: 9.559443
KL Loss: 0.040166
Y Loss: 0.028141
T Loss: 9.545373
Epoch 1249 
Overall Loss: 9.581306
Rec Loss: 9.546693
KL Loss: 0.034613
Y Loss: 0.026999
T Loss: 9.533194
Epoch 1299 
Overall Loss: 9.581639
Rec Loss: 9.544519
KL Loss: 0.037120
Y Loss: 0.026623
T Loss: 9.531208
Epoch 1349 
Overall Loss: 9.576639
Rec Loss: 9.542856
KL Loss: 0.033783
Y Loss: 0.024451
T Loss: 9.530631
Epoch 1399 
Overall Loss: 9.607701
Rec Loss: 9.548267
KL Loss: 0.059434
Y Loss: 0.025698
T Loss: 9.535418
Epoch 1449 
Overall Loss: 9.569416
Rec Loss: 9.537191
KL Loss: 0.032225
Y Loss: 0.026447
T Loss: 9.523968
Epoch 1499 
Overall Loss: 9.574084
Rec Loss: 9.538931
KL Loss: 0.035153
Y Loss: 0.024225
T Loss: 9.526818
Epoch 1549 
Overall Loss: 9.589330
Rec Loss: 9.546208
KL Loss: 0.043121
Y Loss: 0.043360
T Loss: 9.524528
Epoch 1599 
Overall Loss: 9.562843
Rec Loss: 9.531771
KL Loss: 0.031072
Y Loss: 0.024934
T Loss: 9.519303
Epoch 1649 
Overall Loss: 9.581998
Rec Loss: 9.536726
KL Loss: 0.045272
Y Loss: 0.022845
T Loss: 9.525303
Epoch 1699 
Overall Loss: 9.562560
Rec Loss: 9.532640
KL Loss: 0.029920
Y Loss: 0.022337
T Loss: 9.521471
Epoch 1749 
Overall Loss: 9.555114
Rec Loss: 9.526133
KL Loss: 0.028981
Y Loss: 0.022271
T Loss: 9.514998
Epoch 1799 
Overall Loss: 9.554675
Rec Loss: 9.524276
KL Loss: 0.030399
Y Loss: 0.021268
T Loss: 9.513643
Epoch 1849 
Overall Loss: 9.553879
Rec Loss: 9.524394
KL Loss: 0.029484
Y Loss: 0.023655
T Loss: 9.512567
Epoch 1899 
Overall Loss: 9.561322
Rec Loss: 9.522385
KL Loss: 0.038937
Y Loss: 0.034284
T Loss: 9.505243
Epoch 1949 
Overall Loss: 9.548935
Rec Loss: 9.520199
KL Loss: 0.028736
Y Loss: 0.021070
T Loss: 9.509664
Epoch 1999 
Overall Loss: 9.548355
Rec Loss: 9.517742
KL Loss: 0.030613
Y Loss: 0.019832
T Loss: 9.507826
Epoch 2049 
Overall Loss: 9.551026
Rec Loss: 9.519849
KL Loss: 0.031177
Y Loss: 0.021056
T Loss: 9.509321
Epoch 2099 
Overall Loss: 9.546705
Rec Loss: 9.516142
KL Loss: 0.030563
Y Loss: 0.019651
T Loss: 9.506316
Epoch 2149 
Overall Loss: 9.545270
Rec Loss: 9.514827
KL Loss: 0.030443
Y Loss: 0.019358
T Loss: 9.505148
Epoch 2199 
Overall Loss: 9.552331
Rec Loss: 9.518832
KL Loss: 0.033498
Y Loss: 0.019990
T Loss: 9.508837
Epoch 2249 
Overall Loss: 9.542418
Rec Loss: 9.513880
KL Loss: 0.028538
Y Loss: 0.019576
T Loss: 9.504092
Epoch 2299 
Overall Loss: 9.538097
Rec Loss: 9.512713
KL Loss: 0.025383
Y Loss: 0.020507
T Loss: 9.502460
Epoch 2349 
Overall Loss: 9.559610
Rec Loss: 9.512124
KL Loss: 0.047486
Y Loss: 0.020180
T Loss: 9.502034
Epoch 2399 
Overall Loss: 9.532112
Rec Loss: 9.507055
KL Loss: 0.025057
Y Loss: 0.018848
T Loss: 9.497631
Epoch 2449 
Overall Loss: 9.530896
Rec Loss: 9.502741
KL Loss: 0.028155
Y Loss: 0.018623
T Loss: 9.493429
Epoch 2499 
Overall Loss: 9.529714
Rec Loss: 9.500130
KL Loss: 0.029583
Y Loss: 0.018124
T Loss: 9.491068
Epoch 2549 
Overall Loss: 9.526960
Rec Loss: 9.500488
KL Loss: 0.026472
Y Loss: 0.018162
T Loss: 9.491407
Epoch 2599 
Overall Loss: 9.529362
Rec Loss: 9.503831
KL Loss: 0.025531
Y Loss: 0.017847
T Loss: 9.494908
Epoch 2649 
Overall Loss: 9.531382
Rec Loss: 9.501644
KL Loss: 0.029738
Y Loss: 0.018954
T Loss: 9.492166
Epoch 2699 
Overall Loss: 9.520168
Rec Loss: 9.495663
KL Loss: 0.024505
Y Loss: 0.019337
T Loss: 9.485995
Epoch 2749 
Overall Loss: 9.527751
Rec Loss: 9.503041
KL Loss: 0.024710
Y Loss: 0.019304
T Loss: 9.493389
Epoch 2799 
Overall Loss: 9.521441
Rec Loss: 9.496503
KL Loss: 0.024938
Y Loss: 0.017629
T Loss: 9.487688
Epoch 2849 
Overall Loss: 9.521975
Rec Loss: 9.496088
KL Loss: 0.025887
Y Loss: 0.019449
T Loss: 9.486364
Epoch 2899 
Overall Loss: 9.520368
Rec Loss: 9.495694
KL Loss: 0.024674
Y Loss: 0.020399
T Loss: 9.485495
Epoch 2949 
Overall Loss: 9.514312
Rec Loss: 9.490160
KL Loss: 0.024153
Y Loss: 0.016872
T Loss: 9.481723
Epoch 2999 
Overall Loss: 9.518501
Rec Loss: 9.492223
KL Loss: 0.026278
Y Loss: 0.019753
T Loss: 9.482347
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.021352
Epoch 99
Rec Loss: 0.018162
Epoch 149
Rec Loss: 0.016928
Epoch 199
Rec Loss: 0.016292
Epoch 249
Rec Loss: 0.015882
Epoch 299
Rec Loss: 0.015342
Epoch 349
Rec Loss: 0.015320
Epoch 399
Rec Loss: 0.015682
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.183574
Epoch 99
Rec Loss: 10.174926
Epoch 149
Rec Loss: 10.146852
Epoch 199
Rec Loss: 10.139585
Epoch 249
Rec Loss: 10.129045
Epoch 299
Rec Loss: 10.132897
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.063022
Insample Error: 0.227018
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.977230
Epoch 99
Rec Loss: 3.981953
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.064839
Epoch 99
Rec Loss: 10.033312
Epoch 149
Rec Loss: 10.027232
Epoch 199
Rec Loss: 10.023464
Epoch 249
Rec Loss: 10.031011
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.837108
Insample Error 3.343984
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.483157
Epoch 99 
Prediction Loss: 0.149569
Epoch 149 
Prediction Loss: 0.078264
Epoch 199 
Prediction Loss: 0.046557
Epoch 249 
Prediction Loss: 0.035032
Epoch 299 
Prediction Loss: 0.025762
Epoch 349 
Prediction Loss: 0.020806
Epoch 399 
Prediction Loss: 0.017877
Epoch 449 
Prediction Loss: 0.015404
Epoch 499 
Prediction Loss: 0.014187
Epoch 549 
Prediction Loss: 0.012670
Epoch 599 
Prediction Loss: 0.011348
Epoch 649 
Prediction Loss: 0.015024
Epoch 699 
Prediction Loss: 0.009475
Epoch 749 
Prediction Loss: 0.009011
Epoch 799 
Prediction Loss: 0.008704
Epoch 849 
Prediction Loss: 0.008995
Epoch 899 
Prediction Loss: 0.007265
Epoch 949 
Prediction Loss: 0.006875
Epoch 999 
Prediction Loss: 0.008178
Epoch 1049 
Prediction Loss: 0.007973
Epoch 1099 
Prediction Loss: 0.005468
Epoch 1149 
Prediction Loss: 0.005441
Epoch 1199 
Prediction Loss: 0.004762
Epoch 1249 
Prediction Loss: 0.006517
Epoch 1299 
Prediction Loss: 0.004944
Epoch 1349 
Prediction Loss: 0.004752
Epoch 1399 
Prediction Loss: 0.004497
Epoch 1449 
Prediction Loss: 0.005406
Epoch 1499 
Prediction Loss: 0.004793
Epoch 1549 
Prediction Loss: 0.004081
Epoch 1599 
Prediction Loss: 0.003930
Epoch 1649 
Prediction Loss: 0.004705
Epoch 1699 
Prediction Loss: 0.003654
Epoch 1749 
Prediction Loss: 0.003617
Epoch 1799 
Prediction Loss: 0.003830
Epoch 1849 
Prediction Loss: 0.004285
Epoch 1899 
Prediction Loss: 0.002871
Epoch 1949 
Prediction Loss: 0.003943
Epoch 1999 
Prediction Loss: 0.004038
Epoch 2049 
Prediction Loss: 0.004058
Epoch 2099 
Prediction Loss: 0.003488
Epoch 2149 
Prediction Loss: 0.003549
Epoch 2199 
Prediction Loss: 0.002467
Epoch 2249 
Prediction Loss: 0.003061
Epoch 2299 
Prediction Loss: 0.002751
Epoch 2349 
Prediction Loss: 0.004643
Epoch 2399 
Prediction Loss: 0.002919
Epoch 2449 
Prediction Loss: 0.002547
Epoch 2499 
Prediction Loss: 0.002219
Epoch 2549 
Prediction Loss: 0.003210
Epoch 2599 
Prediction Loss: 0.002041
Epoch 2649 
Prediction Loss: 0.002227
Epoch 2699 
Prediction Loss: 0.002697
Epoch 2749 
Prediction Loss: 0.002786
Epoch 2799 
Prediction Loss: 0.001971
Epoch 2849 
Prediction Loss: 0.002203
Epoch 2899 
Prediction Loss: 0.002139
Epoch 2949 
Prediction Loss: 0.002585
Epoch 2999 
Prediction Loss: 0.002899
Epoch 3049 
Prediction Loss: 0.003240
Epoch 3099 
Prediction Loss: 0.003249
Epoch 3149 
Prediction Loss: 0.002044
Epoch 3199 
Prediction Loss: 0.002695
Epoch 3249 
Prediction Loss: 0.001889
Epoch 3299 
Prediction Loss: 0.003336
Epoch 3349 
Prediction Loss: 0.002252
Epoch 3399 
Prediction Loss: 0.001989
Epoch 3449 
Prediction Loss: 0.001858
Epoch 3499 
Prediction Loss: 0.002426
Epoch 3549 
Prediction Loss: 0.001818
Epoch 3599 
Prediction Loss: 0.001468
Epoch 3649 
Prediction Loss: 0.003176
Epoch 3699 
Prediction Loss: 0.001516
Epoch 3749 
Prediction Loss: 0.001966
Epoch 3799 
Prediction Loss: 0.001373
Epoch 3849 
Prediction Loss: 0.001673
Epoch 3899 
Prediction Loss: 0.002269
Epoch 3949 
Prediction Loss: 0.002049
Epoch 3999 
Prediction Loss: 0.002419
Epoch 4049 
Prediction Loss: 0.002941
Epoch 4099 
Prediction Loss: 0.002621
Epoch 4149 
Prediction Loss: 0.001275
Epoch 4199 
Prediction Loss: 0.001375
Epoch 4249 
Prediction Loss: 0.001889
Epoch 4299 
Prediction Loss: 0.002273
Epoch 4349 
Prediction Loss: 0.001211
Epoch 4399 
Prediction Loss: 0.002060
Epoch 4449 
Prediction Loss: 0.001596
Epoch 4499 
Prediction Loss: 0.001914
Epoch 4549 
Prediction Loss: 0.001360
Epoch 4599 
Prediction Loss: 0.001590
Epoch 4649 
Prediction Loss: 0.002004
Epoch 4699 
Prediction Loss: 0.001113
Epoch 4749 
Prediction Loss: 0.001458
Epoch 4799 
Prediction Loss: 0.001991
Epoch 4849 
Prediction Loss: 0.001231
Epoch 4899 
Prediction Loss: 0.001290
Epoch 4949 
Prediction Loss: 0.001382
Epoch 4999 
Prediction Loss: 0.001034
Epoch 5049 
Prediction Loss: 0.001394
Epoch 5099 
Prediction Loss: 0.000931
Epoch 5149 
Prediction Loss: 0.002264
Epoch 5199 
Prediction Loss: 0.001195
Epoch 5249 
Prediction Loss: 0.001032
Epoch 5299 
Prediction Loss: 0.001247
Epoch 5349 
Prediction Loss: 0.001460
Epoch 5399 
Prediction Loss: 0.001330
Epoch 5449 
Prediction Loss: 0.001148
Epoch 5499 
Prediction Loss: 0.001081
Epoch 5549 
Prediction Loss: 0.001357
Epoch 5599 
Prediction Loss: 0.003520
Epoch 5649 
Prediction Loss: 0.001716
Epoch 5699 
Prediction Loss: 0.001130
Epoch 5749 
Prediction Loss: 0.001382
Epoch 5799 
Prediction Loss: 0.001015
Epoch 5849 
Prediction Loss: 0.001234
Epoch 5899 
Prediction Loss: 0.001406
Epoch 5949 
Prediction Loss: 0.003183
Epoch 5999 
Prediction Loss: 0.001137
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.028233
Insample Error 0.143058
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.077843
Rec Loss: 9.844680
KL Loss: 0.233162
Y Loss: 0.576646
T Loss: 9.556357
Epoch 99 
Overall Loss: 9.821505
Rec Loss: 9.701913
KL Loss: 0.119592
Y Loss: 0.228967
T Loss: 9.587430
Epoch 149 
Overall Loss: 9.752329
Rec Loss: 9.656536
KL Loss: 0.095793
Y Loss: 0.143316
T Loss: 9.584878
Epoch 199 
Overall Loss: 9.713127
Rec Loss: 9.632677
KL Loss: 0.080450
Y Loss: 0.101124
T Loss: 9.582115
Epoch 249 
Overall Loss: 9.695854
Rec Loss: 9.617238
KL Loss: 0.078615
Y Loss: 0.078736
T Loss: 9.577871
Epoch 299 
Overall Loss: 9.690729
Rec Loss: 9.619417
KL Loss: 0.071313
Y Loss: 0.069657
T Loss: 9.584589
Epoch 349 
Overall Loss: 9.668320
Rec Loss: 9.607323
KL Loss: 0.060996
Y Loss: 0.058327
T Loss: 9.578160
Epoch 399 
Overall Loss: 9.663721
Rec Loss: 9.604768
KL Loss: 0.058953
Y Loss: 0.055036
T Loss: 9.577250
Epoch 449 
Overall Loss: 9.656285
Rec Loss: 9.596289
KL Loss: 0.059996
Y Loss: 0.054084
T Loss: 9.569247
Epoch 499 
Overall Loss: 9.641570
Rec Loss: 9.592036
KL Loss: 0.049534
Y Loss: 0.046330
T Loss: 9.568871
Epoch 549 
Overall Loss: 9.643851
Rec Loss: 9.591810
KL Loss: 0.052041
Y Loss: 0.046745
T Loss: 9.568438
Epoch 599 
Overall Loss: 9.643811
Rec Loss: 9.594045
KL Loss: 0.049766
Y Loss: 0.040555
T Loss: 9.573768
Epoch 649 
Overall Loss: 9.640280
Rec Loss: 9.590055
KL Loss: 0.050225
Y Loss: 0.041024
T Loss: 9.569543
Epoch 699 
Overall Loss: 9.624388
Rec Loss: 9.577370
KL Loss: 0.047018
Y Loss: 0.041182
T Loss: 9.556779
Epoch 749 
Overall Loss: 9.620850
Rec Loss: 9.579003
KL Loss: 0.041847
Y Loss: 0.039945
T Loss: 9.559030
Epoch 799 
Overall Loss: 9.629427
Rec Loss: 9.586704
KL Loss: 0.042723
Y Loss: 0.047920
T Loss: 9.562744
Epoch 849 
Overall Loss: 9.620102
Rec Loss: 9.570634
KL Loss: 0.049468
Y Loss: 0.033215
T Loss: 9.554026
Epoch 899 
Overall Loss: 9.609261
Rec Loss: 9.567215
KL Loss: 0.042046
Y Loss: 0.034710
T Loss: 9.549860
Epoch 949 
Overall Loss: 9.603034
Rec Loss: 9.565271
KL Loss: 0.037763
Y Loss: 0.030685
T Loss: 9.549928
Epoch 999 
Overall Loss: 9.594698
Rec Loss: 9.559211
KL Loss: 0.035487
Y Loss: 0.029373
T Loss: 9.544525
Epoch 1049 
Overall Loss: 9.594414
Rec Loss: 9.558460
KL Loss: 0.035954
Y Loss: 0.029031
T Loss: 9.543944
Epoch 1099 
Overall Loss: 9.589785
Rec Loss: 9.554733
KL Loss: 0.035052
Y Loss: 0.027559
T Loss: 9.540953
Epoch 1149 
Overall Loss: 9.601149
Rec Loss: 9.558179
KL Loss: 0.042970
Y Loss: 0.040413
T Loss: 9.537972
Epoch 1199 
Overall Loss: 9.591619
Rec Loss: 9.556206
KL Loss: 0.035412
Y Loss: 0.026850
T Loss: 9.542782
Epoch 1249 
Overall Loss: 9.579851
Rec Loss: 9.546826
KL Loss: 0.033025
Y Loss: 0.028495
T Loss: 9.532579
Epoch 1299 
Overall Loss: 9.578997
Rec Loss: 9.540166
KL Loss: 0.038831
Y Loss: 0.033383
T Loss: 9.523474
Epoch 1349 
Overall Loss: 9.574695
Rec Loss: 9.542808
KL Loss: 0.031887
Y Loss: 0.026225
T Loss: 9.529696
Epoch 1399 
Overall Loss: 9.575664
Rec Loss: 9.542694
KL Loss: 0.032970
Y Loss: 0.028851
T Loss: 9.528269
Epoch 1449 
Overall Loss: 9.572198
Rec Loss: 9.541837
KL Loss: 0.030361
Y Loss: 0.023254
T Loss: 9.530211
Epoch 1499 
Overall Loss: 9.570302
Rec Loss: 9.540021
KL Loss: 0.030281
Y Loss: 0.024379
T Loss: 9.527831
Epoch 1549 
Overall Loss: 9.565797
Rec Loss: 9.536976
KL Loss: 0.028821
Y Loss: 0.024348
T Loss: 9.524802
Epoch 1599 
Overall Loss: 9.571028
Rec Loss: 9.538825
KL Loss: 0.032204
Y Loss: 0.026607
T Loss: 9.525521
Epoch 1649 
Overall Loss: 9.557955
Rec Loss: 9.528007
KL Loss: 0.029948
Y Loss: 0.024392
T Loss: 9.515811
Epoch 1699 
Overall Loss: 9.570689
Rec Loss: 9.532516
KL Loss: 0.038173
Y Loss: 0.021498
T Loss: 9.521767
Epoch 1749 
Overall Loss: 9.554627
Rec Loss: 9.526725
KL Loss: 0.027901
Y Loss: 0.020689
T Loss: 9.516381
Epoch 1799 
Overall Loss: 9.552424
Rec Loss: 9.525578
KL Loss: 0.026846
Y Loss: 0.022979
T Loss: 9.514088
Epoch 1849 
Overall Loss: 9.554426
Rec Loss: 9.522527
KL Loss: 0.031900
Y Loss: 0.020378
T Loss: 9.512338
Epoch 1899 
Overall Loss: 9.545903
Rec Loss: 9.519589
KL Loss: 0.026314
Y Loss: 0.022215
T Loss: 9.508481
Epoch 1949 
Overall Loss: 9.557109
Rec Loss: 9.522459
KL Loss: 0.034650
Y Loss: 0.029705
T Loss: 9.507606
Epoch 1999 
Overall Loss: 9.548347
Rec Loss: 9.517447
KL Loss: 0.030900
Y Loss: 0.027064
T Loss: 9.503916
Epoch 2049 
Overall Loss: 9.550415
Rec Loss: 9.513979
KL Loss: 0.036436
Y Loss: 0.021145
T Loss: 9.503407
Epoch 2099 
Overall Loss: 9.547287
Rec Loss: 9.514087
KL Loss: 0.033199
Y Loss: 0.020129
T Loss: 9.504023
Epoch 2149 
Overall Loss: 9.534867
Rec Loss: 9.509580
KL Loss: 0.025287
Y Loss: 0.020443
T Loss: 9.499359
Epoch 2199 
Overall Loss: 9.536256
Rec Loss: 9.511209
KL Loss: 0.025047
Y Loss: 0.022324
T Loss: 9.500047
Epoch 2249 
Overall Loss: 9.535335
Rec Loss: 9.507881
KL Loss: 0.027454
Y Loss: 0.019333
T Loss: 9.498214
Epoch 2299 
Overall Loss: 9.528991
Rec Loss: 9.505199
KL Loss: 0.023792
Y Loss: 0.020286
T Loss: 9.495056
Epoch 2349 
Overall Loss: 9.540958
Rec Loss: 9.501702
KL Loss: 0.039256
Y Loss: 0.020395
T Loss: 9.491505
Epoch 2399 
Overall Loss: 9.526897
Rec Loss: 9.503956
KL Loss: 0.022941
Y Loss: 0.020155
T Loss: 9.493878
Epoch 2449 
Overall Loss: 9.525186
Rec Loss: 9.502876
KL Loss: 0.022310
Y Loss: 0.019540
T Loss: 9.493106
Epoch 2499 
Overall Loss: 9.524891
Rec Loss: 9.500471
KL Loss: 0.024419
Y Loss: 0.020853
T Loss: 9.490045
Epoch 2549 
Overall Loss: 9.522028
Rec Loss: 9.498023
KL Loss: 0.024005
Y Loss: 0.017128
T Loss: 9.489459
Epoch 2599 
Overall Loss: 9.520748
Rec Loss: 9.497127
KL Loss: 0.023621
Y Loss: 0.017608
T Loss: 9.488322
Epoch 2649 
Overall Loss: 9.522784
Rec Loss: 9.496547
KL Loss: 0.026238
Y Loss: 0.017530
T Loss: 9.487782
Epoch 2699 
Overall Loss: 9.526846
Rec Loss: 9.496706
KL Loss: 0.030140
Y Loss: 0.018060
T Loss: 9.487676
Epoch 2749 
Overall Loss: 9.514019
Rec Loss: 9.491000
KL Loss: 0.023018
Y Loss: 0.018223
T Loss: 9.481889
Epoch 2799 
Overall Loss: 9.517245
Rec Loss: 9.494507
KL Loss: 0.022738
Y Loss: 0.019788
T Loss: 9.484613
Epoch 2849 
Overall Loss: 9.534309
Rec Loss: 9.491956
KL Loss: 0.042353
Y Loss: 0.018665
T Loss: 9.482624
Epoch 2899 
Overall Loss: 9.521683
Rec Loss: 9.494311
KL Loss: 0.027372
Y Loss: 0.021873
T Loss: 9.483374
Epoch 2949 
Overall Loss: 9.515749
Rec Loss: 9.490696
KL Loss: 0.025053
Y Loss: 0.016299
T Loss: 9.482547
Epoch 2999 
Overall Loss: 9.513310
Rec Loss: 9.487536
KL Loss: 0.025774
Y Loss: 0.016402
T Loss: 9.479336
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.019574
Epoch 99
Rec Loss: 0.015865
Epoch 149
Rec Loss: 0.015062
Epoch 199
Rec Loss: 0.014140
Epoch 249
Rec Loss: 0.013928
Epoch 299
Rec Loss: 0.013481
Epoch 349
Rec Loss: 0.013277
Epoch 399
Rec Loss: 0.012838
Epoch 449
Rec Loss: 0.012875
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.181311
Epoch 99
Rec Loss: 10.178577
Epoch 149
Rec Loss: 10.147482
Epoch 199
Rec Loss: 10.114361
Epoch 249
Rec Loss: 10.097445
Epoch 299
Rec Loss: 10.079817
Epoch 349
Rec Loss: 10.056548
Epoch 399
Rec Loss: 10.050201
Epoch 449
Rec Loss: 10.052301
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.073249
Insample Error: 0.223010
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.989199
Epoch 99
Rec Loss: 3.986397
Epoch 149
Rec Loss: 3.983751
Epoch 199
Rec Loss: 3.984537
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.375590
Epoch 99
Rec Loss: 9.298657
Epoch 149
Rec Loss: 9.380388
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.792182
Insample Error 3.344827
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.374219
Epoch 99 
Prediction Loss: 0.146659
Epoch 149 
Prediction Loss: 0.098589
Epoch 199 
Prediction Loss: 0.066864
Epoch 249 
Prediction Loss: 0.044819
Epoch 299 
Prediction Loss: 0.033692
Epoch 349 
Prediction Loss: 0.026944
Epoch 399 
Prediction Loss: 0.026081
Epoch 449 
Prediction Loss: 0.020341
Epoch 499 
Prediction Loss: 0.019608
Epoch 549 
Prediction Loss: 0.016575
Epoch 599 
Prediction Loss: 0.015299
Epoch 649 
Prediction Loss: 0.016833
Epoch 699 
Prediction Loss: 0.013388
Epoch 749 
Prediction Loss: 0.014182
Epoch 799 
Prediction Loss: 0.011925
Epoch 849 
Prediction Loss: 0.010705
Epoch 899 
Prediction Loss: 0.013958
Epoch 949 
Prediction Loss: 0.009551
Epoch 999 
Prediction Loss: 0.009981
Epoch 1049 
Prediction Loss: 0.009274
Epoch 1099 
Prediction Loss: 0.009311
Epoch 1149 
Prediction Loss: 0.010206
Epoch 1199 
Prediction Loss: 0.009621
Epoch 1249 
Prediction Loss: 0.010159
Epoch 1299 
Prediction Loss: 0.007618
Epoch 1349 
Prediction Loss: 0.008958
Epoch 1399 
Prediction Loss: 0.008494
Epoch 1449 
Prediction Loss: 0.007718
Epoch 1499 
Prediction Loss: 0.007879
Epoch 1549 
Prediction Loss: 0.007172
Epoch 1599 
Prediction Loss: 0.008124
Epoch 1649 
Prediction Loss: 0.006358
Epoch 1699 
Prediction Loss: 0.007808
Epoch 1749 
Prediction Loss: 0.006717
Epoch 1799 
Prediction Loss: 0.007059
Epoch 1849 
Prediction Loss: 0.006453
Epoch 1899 
Prediction Loss: 0.005901
Epoch 1949 
Prediction Loss: 0.005893
Epoch 1999 
Prediction Loss: 0.005669
Epoch 2049 
Prediction Loss: 0.007372
Epoch 2099 
Prediction Loss: 0.007897
Epoch 2149 
Prediction Loss: 0.007066
Epoch 2199 
Prediction Loss: 0.007656
Epoch 2249 
Prediction Loss: 0.007872
Epoch 2299 
Prediction Loss: 0.006511
Epoch 2349 
Prediction Loss: 0.006817
Epoch 2399 
Prediction Loss: 0.005188
Epoch 2449 
Prediction Loss: 0.009520
Epoch 2499 
Prediction Loss: 0.006763
Epoch 2549 
Prediction Loss: 0.004944
Epoch 2599 
Prediction Loss: 0.005149
Epoch 2649 
Prediction Loss: 0.007429
Epoch 2699 
Prediction Loss: 0.004639
Epoch 2749 
Prediction Loss: 0.006220
Epoch 2799 
Prediction Loss: 0.005095
Epoch 2849 
Prediction Loss: 0.006511
Epoch 2899 
Prediction Loss: 0.006543
Epoch 2949 
Prediction Loss: 0.004711
Epoch 2999 
Prediction Loss: 0.006279
Epoch 3049 
Prediction Loss: 0.009875
Epoch 3099 
Prediction Loss: 0.004523
Epoch 3149 
Prediction Loss: 0.005045
Epoch 3199 
Prediction Loss: 0.005047
Epoch 3249 
Prediction Loss: 0.004807
Epoch 3299 
Prediction Loss: 0.004809
Epoch 3349 
Prediction Loss: 0.006732
Epoch 3399 
Prediction Loss: 0.004155
Epoch 3449 
Prediction Loss: 0.003998
Epoch 3499 
Prediction Loss: 0.003976
Epoch 3549 
Prediction Loss: 0.004355
Epoch 3599 
Prediction Loss: 0.004315
Epoch 3649 
Prediction Loss: 0.005085
Epoch 3699 
Prediction Loss: 0.003854
Epoch 3749 
Prediction Loss: 0.004776
Epoch 3799 
Prediction Loss: 0.003895
Epoch 3849 
Prediction Loss: 0.006988
Epoch 3899 
Prediction Loss: 0.005369
Epoch 3949 
Prediction Loss: 0.003587
Epoch 3999 
Prediction Loss: 0.006384
Epoch 4049 
Prediction Loss: 0.004135
Epoch 4099 
Prediction Loss: 0.005223
Epoch 4149 
Prediction Loss: 0.006192
Epoch 4199 
Prediction Loss: 0.006111
Epoch 4249 
Prediction Loss: 0.003860
Epoch 4299 
Prediction Loss: 0.005780
Epoch 4349 
Prediction Loss: 0.003980
Epoch 4399 
Prediction Loss: 0.004168
Epoch 4449 
Prediction Loss: 0.006546
Epoch 4499 
Prediction Loss: 0.004635
Epoch 4549 
Prediction Loss: 0.004146
Epoch 4599 
Prediction Loss: 0.006970
Epoch 4649 
Prediction Loss: 0.003779
Epoch 4699 
Prediction Loss: 0.003852
Epoch 4749 
Prediction Loss: 0.003284
Epoch 4799 
Prediction Loss: 0.004422
Epoch 4849 
Prediction Loss: 0.003512
Epoch 4899 
Prediction Loss: 0.004119
Epoch 4949 
Prediction Loss: 0.011180
Epoch 4999 
Prediction Loss: 0.003692
Epoch 5049 
Prediction Loss: 0.005551
Epoch 5099 
Prediction Loss: 0.007404
Epoch 5149 
Prediction Loss: 0.004201
Epoch 5199 
Prediction Loss: 0.004510
Epoch 5249 
Prediction Loss: 0.004622
Epoch 5299 
Prediction Loss: 0.003337
Epoch 5349 
Prediction Loss: 0.004260
Epoch 5399 
Prediction Loss: 0.006336
Epoch 5449 
Prediction Loss: 0.004180
Epoch 5499 
Prediction Loss: 0.004808
Epoch 5549 
Prediction Loss: 0.006135
Epoch 5599 
Prediction Loss: 0.004578
Epoch 5649 
Prediction Loss: 0.003630
Epoch 5699 
Prediction Loss: 0.005618
Epoch 5749 
Prediction Loss: 0.002972
Epoch 5799 
Prediction Loss: 0.004382
Epoch 5849 
Prediction Loss: 0.003708
Epoch 5899 
Prediction Loss: 0.003692
Epoch 5949 
Prediction Loss: 0.003289
Epoch 5999 
Prediction Loss: 0.005204
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.075060
Insample Error 0.246019
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.089903
Rec Loss: 9.843195
KL Loss: 0.246708
Y Loss: 0.590883
T Loss: 9.547754
Epoch 99 
Overall Loss: 9.839183
Rec Loss: 9.705649
KL Loss: 0.133535
Y Loss: 0.265232
T Loss: 9.573032
Epoch 149 
Overall Loss: 9.759571
Rec Loss: 9.654313
KL Loss: 0.105257
Y Loss: 0.146258
T Loss: 9.581185
Epoch 199 
Overall Loss: 9.725113
Rec Loss: 9.634174
KL Loss: 0.090939
Y Loss: 0.103829
T Loss: 9.582260
Epoch 249 
Overall Loss: 9.695113
Rec Loss: 9.619177
KL Loss: 0.075936
Y Loss: 0.077341
T Loss: 9.580507
Epoch 299 
Overall Loss: 9.682116
Rec Loss: 9.611071
KL Loss: 0.071045
Y Loss: 0.071536
T Loss: 9.575303
Epoch 349 
Overall Loss: 9.679347
Rec Loss: 9.611381
KL Loss: 0.067966
Y Loss: 0.061350
T Loss: 9.580706
Epoch 399 
Overall Loss: 9.665413
Rec Loss: 9.600648
KL Loss: 0.064765
Y Loss: 0.054748
T Loss: 9.573274
Epoch 449 
Overall Loss: 9.656565
Rec Loss: 9.596426
KL Loss: 0.060139
Y Loss: 0.052798
T Loss: 9.570027
Epoch 499 
Overall Loss: 9.679582
Rec Loss: 9.607150
KL Loss: 0.072432
Y Loss: 0.088672
T Loss: 9.562814
Epoch 549 
Overall Loss: 9.642472
Rec Loss: 9.590773
KL Loss: 0.051699
Y Loss: 0.043197
T Loss: 9.569175
Epoch 599 
Overall Loss: 9.635406
Rec Loss: 9.587856
KL Loss: 0.047549
Y Loss: 0.043475
T Loss: 9.566119
Epoch 649 
Overall Loss: 9.638371
Rec Loss: 9.587040
KL Loss: 0.051331
Y Loss: 0.039894
T Loss: 9.567093
Epoch 699 
Overall Loss: 9.631477
Rec Loss: 9.582965
KL Loss: 0.048512
Y Loss: 0.042018
T Loss: 9.561956
Epoch 749 
Overall Loss: 9.625542
Rec Loss: 9.577105
KL Loss: 0.048437
Y Loss: 0.038770
T Loss: 9.557720
Epoch 799 
Overall Loss: 9.614582
Rec Loss: 9.572908
KL Loss: 0.041674
Y Loss: 0.036984
T Loss: 9.554416
Epoch 849 
Overall Loss: 9.621470
Rec Loss: 9.578226
KL Loss: 0.043244
Y Loss: 0.039767
T Loss: 9.558342
Epoch 899 
Overall Loss: 9.624544
Rec Loss: 9.572692
KL Loss: 0.051853
Y Loss: 0.035256
T Loss: 9.555064
Epoch 949 
Overall Loss: 9.609614
Rec Loss: 9.564935
KL Loss: 0.044679
Y Loss: 0.037141
T Loss: 9.546365
Epoch 999 
Overall Loss: 9.599382
Rec Loss: 9.561164
KL Loss: 0.038217
Y Loss: 0.031065
T Loss: 9.545632
Epoch 1049 
Overall Loss: 9.603983
Rec Loss: 9.564082
KL Loss: 0.039901
Y Loss: 0.031249
T Loss: 9.548457
Epoch 1099 
Overall Loss: 9.624642
Rec Loss: 9.573332
KL Loss: 0.051310
Y Loss: 0.048821
T Loss: 9.548922
Epoch 1149 
Overall Loss: 9.590801
Rec Loss: 9.553548
KL Loss: 0.037252
Y Loss: 0.032825
T Loss: 9.537136
Epoch 1199 
Overall Loss: 9.584448
Rec Loss: 9.548277
KL Loss: 0.036171
Y Loss: 0.029571
T Loss: 9.533491
Epoch 1249 
Overall Loss: 9.587346
Rec Loss: 9.550093
KL Loss: 0.037253
Y Loss: 0.027106
T Loss: 9.536540
Epoch 1299 
Overall Loss: 9.583721
Rec Loss: 9.546924
KL Loss: 0.036797
Y Loss: 0.027966
T Loss: 9.532941
Epoch 1349 
Overall Loss: 9.580396
Rec Loss: 9.541396
KL Loss: 0.039000
Y Loss: 0.026199
T Loss: 9.528297
Epoch 1399 
Overall Loss: 9.576197
Rec Loss: 9.544039
KL Loss: 0.032158
Y Loss: 0.026604
T Loss: 9.530737
Epoch 1449 
Overall Loss: 9.575549
Rec Loss: 9.542143
KL Loss: 0.033406
Y Loss: 0.028435
T Loss: 9.527926
Epoch 1499 
Overall Loss: 9.566796
Rec Loss: 9.534992
KL Loss: 0.031804
Y Loss: 0.028160
T Loss: 9.520911
Epoch 1549 
Overall Loss: 9.570832
Rec Loss: 9.537457
KL Loss: 0.033375
Y Loss: 0.024880
T Loss: 9.525018
Epoch 1599 
Overall Loss: 9.574545
Rec Loss: 9.535477
KL Loss: 0.039067
Y Loss: 0.023197
T Loss: 9.523880
Epoch 1649 
Overall Loss: 9.568640
Rec Loss: 9.536556
KL Loss: 0.032083
Y Loss: 0.027060
T Loss: 9.523026
Epoch 1699 
Overall Loss: 9.562167
Rec Loss: 9.533693
KL Loss: 0.028473
Y Loss: 0.023090
T Loss: 9.522148
Epoch 1749 
Overall Loss: 9.553418
Rec Loss: 9.524304
KL Loss: 0.029114
Y Loss: 0.023933
T Loss: 9.512338
Epoch 1799 
Overall Loss: 9.554290
Rec Loss: 9.525804
KL Loss: 0.028487
Y Loss: 0.024772
T Loss: 9.513417
Epoch 1849 
Overall Loss: 9.553258
Rec Loss: 9.524524
KL Loss: 0.028734
Y Loss: 0.022887
T Loss: 9.513081
Epoch 1899 
Overall Loss: 9.556067
Rec Loss: 9.526094
KL Loss: 0.029973
Y Loss: 0.021653
T Loss: 9.515268
Epoch 1949 
Overall Loss: 9.551716
Rec Loss: 9.523519
KL Loss: 0.028197
Y Loss: 0.021544
T Loss: 9.512746
Epoch 1999 
Overall Loss: 9.547176
Rec Loss: 9.518821
KL Loss: 0.028355
Y Loss: 0.023797
T Loss: 9.506923
Epoch 2049 
Overall Loss: 9.552738
Rec Loss: 9.522519
KL Loss: 0.030219
Y Loss: 0.022023
T Loss: 9.511507
Epoch 2099 
Overall Loss: 9.595172
Rec Loss: 9.524136
KL Loss: 0.071037
Y Loss: 0.030734
T Loss: 9.508768
Epoch 2149 
Overall Loss: 9.549463
Rec Loss: 9.514537
KL Loss: 0.034926
Y Loss: 0.022012
T Loss: 9.503531
Epoch 2199 
Overall Loss: 9.561019
Rec Loss: 9.516385
KL Loss: 0.044634
Y Loss: 0.023037
T Loss: 9.504866
Epoch 2249 
Overall Loss: 9.540564
Rec Loss: 9.510962
KL Loss: 0.029602
Y Loss: 0.025479
T Loss: 9.498223
Epoch 2299 
Overall Loss: 9.536558
Rec Loss: 9.509509
KL Loss: 0.027049
Y Loss: 0.019904
T Loss: 9.499557
Epoch 2349 
Overall Loss: 9.535390
Rec Loss: 9.509228
KL Loss: 0.026161
Y Loss: 0.019137
T Loss: 9.499659
Epoch 2399 
Overall Loss: 9.538958
Rec Loss: 9.513034
KL Loss: 0.025924
Y Loss: 0.023609
T Loss: 9.501230
Epoch 2449 
Overall Loss: 9.532426
Rec Loss: 9.508625
KL Loss: 0.023801
Y Loss: 0.021465
T Loss: 9.497892
Epoch 2499 
Overall Loss: 9.533214
Rec Loss: 9.504977
KL Loss: 0.028237
Y Loss: 0.018487
T Loss: 9.495734
Epoch 2549 
Overall Loss: 9.546455
Rec Loss: 9.514374
KL Loss: 0.032081
Y Loss: 0.033657
T Loss: 9.497546
Epoch 2599 
Overall Loss: 9.530890
Rec Loss: 9.503061
KL Loss: 0.027829
Y Loss: 0.023159
T Loss: 9.491481
Epoch 2649 
Overall Loss: 9.524809
Rec Loss: 9.501632
KL Loss: 0.023176
Y Loss: 0.018432
T Loss: 9.492416
Epoch 2699 
Overall Loss: 9.525306
Rec Loss: 9.502877
KL Loss: 0.022429
Y Loss: 0.018780
T Loss: 9.493487
Epoch 2749 
Overall Loss: 9.529070
Rec Loss: 9.497103
KL Loss: 0.031967
Y Loss: 0.019452
T Loss: 9.487376
Epoch 2799 
Overall Loss: 9.525044
Rec Loss: 9.495991
KL Loss: 0.029053
Y Loss: 0.018872
T Loss: 9.486556
Epoch 2849 
Overall Loss: 9.524627
Rec Loss: 9.496086
KL Loss: 0.028541
Y Loss: 0.018098
T Loss: 9.487038
Epoch 2899 
Overall Loss: 9.524299
Rec Loss: 9.496842
KL Loss: 0.027457
Y Loss: 0.017296
T Loss: 9.488194
Epoch 2949 
Overall Loss: 9.516600
Rec Loss: 9.493031
KL Loss: 0.023569
Y Loss: 0.023137
T Loss: 9.481462
Epoch 2999 
Overall Loss: 9.551629
Rec Loss: 9.494598
KL Loss: 0.057031
Y Loss: 0.019252
T Loss: 9.484972
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.020617
Epoch 99
Rec Loss: 0.016364
Epoch 149
Rec Loss: 0.015389
Epoch 199
Rec Loss: 0.014508
Epoch 249
Rec Loss: 0.014166
Epoch 299
Rec Loss: 0.013575
Epoch 349
Rec Loss: 0.013578
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.196444
Epoch 99
Rec Loss: 10.199333
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.086327
Insample Error: 0.237272
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.014600
Epoch 99
Rec Loss: 4.013235
Epoch 149
Rec Loss: 4.002087
Epoch 199
Rec Loss: 4.010465
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.644204
Epoch 99
Rec Loss: 9.515797
Epoch 149
Rec Loss: 9.497197
Epoch 199
Rec Loss: 9.502702
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.780604
Insample Error 3.356021
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.386696
Epoch 99 
Prediction Loss: 0.132994
Epoch 149 
Prediction Loss: 0.077152
Epoch 199 
Prediction Loss: 0.048751
Epoch 249 
Prediction Loss: 0.033566
Epoch 299 
Prediction Loss: 0.026339
Epoch 349 
Prediction Loss: 0.021875
Epoch 399 
Prediction Loss: 0.017412
Epoch 449 
Prediction Loss: 0.015234
Epoch 499 
Prediction Loss: 0.015231
Epoch 549 
Prediction Loss: 0.012419
Epoch 599 
Prediction Loss: 0.011012
Epoch 649 
Prediction Loss: 0.015009
Epoch 699 
Prediction Loss: 0.011071
Epoch 749 
Prediction Loss: 0.009211
Epoch 799 
Prediction Loss: 0.009141
Epoch 849 
Prediction Loss: 0.013069
Epoch 899 
Prediction Loss: 0.007455
Epoch 949 
Prediction Loss: 0.007836
Epoch 999 
Prediction Loss: 0.007139
Epoch 1049 
Prediction Loss: 0.006082
Epoch 1099 
Prediction Loss: 0.006583
Epoch 1149 
Prediction Loss: 0.006167
Epoch 1199 
Prediction Loss: 0.006715
Epoch 1249 
Prediction Loss: 0.005450
Epoch 1299 
Prediction Loss: 0.007275
Epoch 1349 
Prediction Loss: 0.005126
Epoch 1399 
Prediction Loss: 0.005756
Epoch 1449 
Prediction Loss: 0.005501
Epoch 1499 
Prediction Loss: 0.004888
Epoch 1549 
Prediction Loss: 0.004278
Epoch 1599 
Prediction Loss: 0.004178
Epoch 1649 
Prediction Loss: 0.005064
Epoch 1699 
Prediction Loss: 0.004146
Epoch 1749 
Prediction Loss: 0.004469
Epoch 1799 
Prediction Loss: 0.004769
Epoch 1849 
Prediction Loss: 0.004108
Epoch 1899 
Prediction Loss: 0.005414
Epoch 1949 
Prediction Loss: 0.004803
Epoch 1999 
Prediction Loss: 0.003992
Epoch 2049 
Prediction Loss: 0.004314
Epoch 2099 
Prediction Loss: 0.006874
Epoch 2149 
Prediction Loss: 0.003099
Epoch 2199 
Prediction Loss: 0.003256
Epoch 2249 
Prediction Loss: 0.004400
Epoch 2299 
Prediction Loss: 0.003157
Epoch 2349 
Prediction Loss: 0.003504
Epoch 2399 
Prediction Loss: 0.002935
Epoch 2449 
Prediction Loss: 0.003871
Epoch 2499 
Prediction Loss: 0.002662
Epoch 2549 
Prediction Loss: 0.003822
Epoch 2599 
Prediction Loss: 0.002703
Epoch 2649 
Prediction Loss: 0.002606
Epoch 2699 
Prediction Loss: 0.003108
Epoch 2749 
Prediction Loss: 0.002633
Epoch 2799 
Prediction Loss: 0.003127
Epoch 2849 
Prediction Loss: 0.002146
Epoch 2899 
Prediction Loss: 0.003039
Epoch 2949 
Prediction Loss: 0.002518
Epoch 2999 
Prediction Loss: 0.002994
Epoch 3049 
Prediction Loss: 0.003627
Epoch 3099 
Prediction Loss: 0.002756
Epoch 3149 
Prediction Loss: 0.002895
Epoch 3199 
Prediction Loss: 0.003095
Epoch 3249 
Prediction Loss: 0.006829
Epoch 3299 
Prediction Loss: 0.001981
Epoch 3349 
Prediction Loss: 0.002080
Epoch 3399 
Prediction Loss: 0.001919
Epoch 3449 
Prediction Loss: 0.001924
Epoch 3499 
Prediction Loss: 0.001887
Epoch 3549 
Prediction Loss: 0.002402
Epoch 3599 
Prediction Loss: 0.002378
Epoch 3649 
Prediction Loss: 0.001822
Epoch 3699 
Prediction Loss: 0.002277
Epoch 3749 
Prediction Loss: 0.002158
Epoch 3799 
Prediction Loss: 0.001859
Epoch 3849 
Prediction Loss: 0.003428
Epoch 3899 
Prediction Loss: 0.001855
Epoch 3949 
Prediction Loss: 0.003755
Epoch 3999 
Prediction Loss: 0.001744
Epoch 4049 
Prediction Loss: 0.002108
Epoch 4099 
Prediction Loss: 0.002936
Epoch 4149 
Prediction Loss: 0.002394
Epoch 4199 
Prediction Loss: 0.002330
Epoch 4249 
Prediction Loss: 0.002458
Epoch 4299 
Prediction Loss: 0.002164
Epoch 4349 
Prediction Loss: 0.002108
Epoch 4399 
Prediction Loss: 0.002046
Epoch 4449 
Prediction Loss: 0.001699
Epoch 4499 
Prediction Loss: 0.003018
Epoch 4549 
Prediction Loss: 0.001801
Epoch 4599 
Prediction Loss: 0.001712
Epoch 4649 
Prediction Loss: 0.001920
Epoch 4699 
Prediction Loss: 0.003063
Epoch 4749 
Prediction Loss: 0.002132
Epoch 4799 
Prediction Loss: 0.002222
Epoch 4849 
Prediction Loss: 0.001398
Epoch 4899 
Prediction Loss: 0.003681
Epoch 4949 
Prediction Loss: 0.002657
Epoch 4999 
Prediction Loss: 0.002954
Epoch 5049 
Prediction Loss: 0.001752
Epoch 5099 
Prediction Loss: 0.001711
Epoch 5149 
Prediction Loss: 0.001360
Epoch 5199 
Prediction Loss: 0.001486
Epoch 5249 
Prediction Loss: 0.001280
Epoch 5299 
Prediction Loss: 0.001235
Epoch 5349 
Prediction Loss: 0.001952
Epoch 5399 
Prediction Loss: 0.001960
Epoch 5449 
Prediction Loss: 0.002775
Epoch 5499 
Prediction Loss: 0.001240
Epoch 5549 
Prediction Loss: 0.001618
Epoch 5599 
Prediction Loss: 0.001223
Epoch 5649 
Prediction Loss: 0.001906
Epoch 5699 
Prediction Loss: 0.001412
Epoch 5749 
Prediction Loss: 0.001239
Epoch 5799 
Prediction Loss: 0.001855
Epoch 5849 
Prediction Loss: 0.002531
Epoch 5899 
Prediction Loss: 0.001929
Epoch 5949 
Prediction Loss: 0.001719
Epoch 5999 
Prediction Loss: 0.001577
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.040234
Insample Error 0.181850
[31m========== repeat time 4 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.071860
Rec Loss: 9.844931
KL Loss: 0.226929
Y Loss: 0.562287
T Loss: 9.563788
Epoch 99 
Overall Loss: 9.857054
Rec Loss: 9.730827
KL Loss: 0.126226
Y Loss: 0.286249
T Loss: 9.587703
Epoch 149 
Overall Loss: 9.764782
Rec Loss: 9.671976
KL Loss: 0.092806
Y Loss: 0.170813
T Loss: 9.586570
Epoch 199 
Overall Loss: 9.722742
Rec Loss: 9.638115
KL Loss: 0.084627
Y Loss: 0.109978
T Loss: 9.583126
Epoch 249 
Overall Loss: 9.702239
Rec Loss: 9.627752
KL Loss: 0.074486
Y Loss: 0.086604
T Loss: 9.584451
Epoch 299 
Overall Loss: 9.695622
Rec Loss: 9.620900
KL Loss: 0.074722
Y Loss: 0.074232
T Loss: 9.583784
Epoch 349 
Overall Loss: 9.679095
Rec Loss: 9.611168
KL Loss: 0.067927
Y Loss: 0.066308
T Loss: 9.578014
Epoch 399 
Overall Loss: 9.688146
Rec Loss: 9.615739
KL Loss: 0.072407
Y Loss: 0.057186
T Loss: 9.587146
Epoch 449 
Overall Loss: 9.652823
Rec Loss: 9.599134
KL Loss: 0.053689
Y Loss: 0.050610
T Loss: 9.573829
Epoch 499 
Overall Loss: 9.652832
Rec Loss: 9.597664
KL Loss: 0.055168
Y Loss: 0.047750
T Loss: 9.573789
Epoch 549 
Overall Loss: 9.645921
Rec Loss: 9.592472
KL Loss: 0.053449
Y Loss: 0.047227
T Loss: 9.568859
Epoch 599 
Overall Loss: 9.639169
Rec Loss: 9.588435
KL Loss: 0.050735
Y Loss: 0.041446
T Loss: 9.567712
Epoch 649 
Overall Loss: 9.633665
Rec Loss: 9.584849
KL Loss: 0.048816
Y Loss: 0.039274
T Loss: 9.565212
Epoch 699 
Overall Loss: 9.628971
Rec Loss: 9.577457
KL Loss: 0.051514
Y Loss: 0.037369
T Loss: 9.558773
Epoch 749 
Overall Loss: 9.618725
Rec Loss: 9.578403
KL Loss: 0.040322
Y Loss: 0.036090
T Loss: 9.560358
Epoch 799 
Overall Loss: 9.618805
Rec Loss: 9.578916
KL Loss: 0.039890
Y Loss: 0.035682
T Loss: 9.561075
Epoch 849 
Overall Loss: 9.615668
Rec Loss: 9.574148
KL Loss: 0.041520
Y Loss: 0.032631
T Loss: 9.557832
Epoch 899 
Overall Loss: 9.611074
Rec Loss: 9.572742
KL Loss: 0.038332
Y Loss: 0.030916
T Loss: 9.557284
Epoch 949 
Overall Loss: 9.611266
Rec Loss: 9.569915
KL Loss: 0.041351
Y Loss: 0.035456
T Loss: 9.552187
Epoch 999 
Overall Loss: 9.615407
Rec Loss: 9.571823
KL Loss: 0.043584
Y Loss: 0.039095
T Loss: 9.552276
Epoch 1049 
Overall Loss: 9.603028
Rec Loss: 9.564699
KL Loss: 0.038329
Y Loss: 0.027975
T Loss: 9.550711
Epoch 1099 
Overall Loss: 9.590263
Rec Loss: 9.555897
KL Loss: 0.034366
Y Loss: 0.029555
T Loss: 9.541120
Epoch 1149 
Overall Loss: 9.592323
Rec Loss: 9.556723
KL Loss: 0.035600
Y Loss: 0.029945
T Loss: 9.541751
Epoch 1199 
Overall Loss: 9.589235
Rec Loss: 9.552694
KL Loss: 0.036541
Y Loss: 0.030702
T Loss: 9.537343
Epoch 1249 
Overall Loss: 9.588682
Rec Loss: 9.549915
KL Loss: 0.038767
Y Loss: 0.027649
T Loss: 9.536090
Epoch 1299 
Overall Loss: 9.580025
Rec Loss: 9.547365
KL Loss: 0.032660
Y Loss: 0.027840
T Loss: 9.533445
Epoch 1349 
Overall Loss: 9.576570
Rec Loss: 9.542328
KL Loss: 0.034242
Y Loss: 0.026237
T Loss: 9.529209
Epoch 1399 
Overall Loss: 9.577091
Rec Loss: 9.547886
KL Loss: 0.029205
Y Loss: 0.025203
T Loss: 9.535284
Epoch 1449 
Overall Loss: 9.567651
Rec Loss: 9.534334
KL Loss: 0.033318
Y Loss: 0.024356
T Loss: 9.522156
Epoch 1499 
Overall Loss: 9.570972
Rec Loss: 9.538289
KL Loss: 0.032684
Y Loss: 0.026345
T Loss: 9.525117
Epoch 1549 
Overall Loss: 9.570765
Rec Loss: 9.538131
KL Loss: 0.032634
Y Loss: 0.027135
T Loss: 9.524563
Epoch 1599 
Overall Loss: 9.578941
Rec Loss: 9.535334
KL Loss: 0.043607
Y Loss: 0.022488
T Loss: 9.524089
Epoch 1649 
Overall Loss: 9.559978
Rec Loss: 9.531143
KL Loss: 0.028835
Y Loss: 0.022949
T Loss: 9.519669
Epoch 1699 
Overall Loss: 9.563568
Rec Loss: 9.529855
KL Loss: 0.033713
Y Loss: 0.028888
T Loss: 9.515410
Epoch 1749 
Overall Loss: 9.558256
Rec Loss: 9.529591
KL Loss: 0.028666
Y Loss: 0.023069
T Loss: 9.518056
Epoch 1799 
Overall Loss: 9.556071
Rec Loss: 9.526371
KL Loss: 0.029700
Y Loss: 0.024956
T Loss: 9.513893
Epoch 1849 
Overall Loss: 9.553293
Rec Loss: 9.526657
KL Loss: 0.026636
Y Loss: 0.024339
T Loss: 9.514487
Epoch 1899 
Overall Loss: 9.552953
Rec Loss: 9.526605
KL Loss: 0.026347
Y Loss: 0.021087
T Loss: 9.516062
Epoch 1949 
Overall Loss: 9.545587
Rec Loss: 9.518826
KL Loss: 0.026761
Y Loss: 0.020673
T Loss: 9.508490
Epoch 1999 
Overall Loss: 9.545887
Rec Loss: 9.521273
KL Loss: 0.024614
Y Loss: 0.020932
T Loss: 9.510807
Epoch 2049 
Overall Loss: 9.549316
Rec Loss: 9.521855
KL Loss: 0.027462
Y Loss: 0.019943
T Loss: 9.511883
Epoch 2099 
Overall Loss: 9.548797
Rec Loss: 9.515723
KL Loss: 0.033074
Y Loss: 0.019656
T Loss: 9.505895
Epoch 2149 
Overall Loss: 9.546213
Rec Loss: 9.514608
KL Loss: 0.031605
Y Loss: 0.020390
T Loss: 9.504413
Epoch 2199 
Overall Loss: 9.539336
Rec Loss: 9.514312
KL Loss: 0.025024
Y Loss: 0.021845
T Loss: 9.503390
Epoch 2249 
Overall Loss: 9.540819
Rec Loss: 9.514287
KL Loss: 0.026531
Y Loss: 0.019139
T Loss: 9.504718
Epoch 2299 
Overall Loss: 9.533583
Rec Loss: 9.508484
KL Loss: 0.025099
Y Loss: 0.019169
T Loss: 9.498900
Epoch 2349 
Overall Loss: 9.533467
Rec Loss: 9.507629
KL Loss: 0.025839
Y Loss: 0.017953
T Loss: 9.498653
Epoch 2399 
Overall Loss: 9.542759
Rec Loss: 9.506978
KL Loss: 0.035781
Y Loss: 0.019307
T Loss: 9.497325
Epoch 2449 
Overall Loss: 9.543506
Rec Loss: 9.510717
KL Loss: 0.032788
Y Loss: 0.024808
T Loss: 9.498314
Epoch 2499 
Overall Loss: 9.529002
Rec Loss: 9.505060
KL Loss: 0.023942
Y Loss: 0.017997
T Loss: 9.496061
Epoch 2549 
Overall Loss: 9.562636
Rec Loss: 9.508884
KL Loss: 0.053752
Y Loss: 0.023060
T Loss: 9.497354
Epoch 2599 
Overall Loss: 9.523570
Rec Loss: 9.499334
KL Loss: 0.024236
Y Loss: 0.019152
T Loss: 9.489758
Epoch 2649 
Overall Loss: 9.522910
Rec Loss: 9.498827
KL Loss: 0.024083
Y Loss: 0.021013
T Loss: 9.488321
Epoch 2699 
Overall Loss: 9.520021
Rec Loss: 9.495495
KL Loss: 0.024527
Y Loss: 0.022698
T Loss: 9.484146
Epoch 2749 
Overall Loss: 9.519460
Rec Loss: 9.497086
KL Loss: 0.022373
Y Loss: 0.017668
T Loss: 9.488252
Epoch 2799 
Overall Loss: 9.510754
Rec Loss: 9.490222
KL Loss: 0.020533
Y Loss: 0.017853
T Loss: 9.481295
Epoch 2849 
Overall Loss: 9.517533
Rec Loss: 9.492933
KL Loss: 0.024601
Y Loss: 0.016830
T Loss: 9.484518
Epoch 2899 
Overall Loss: 9.520993
Rec Loss: 9.495713
KL Loss: 0.025280
Y Loss: 0.018143
T Loss: 9.486642
Epoch 2949 
Overall Loss: 9.511747
Rec Loss: 9.487165
KL Loss: 0.024582
Y Loss: 0.016443
T Loss: 9.478944
Epoch 2999 
Overall Loss: 9.511020
Rec Loss: 9.486892
KL Loss: 0.024129
Y Loss: 0.018686
T Loss: 9.477549
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.021234
Epoch 99
Rec Loss: 0.016428
Epoch 149
Rec Loss: 0.015191
Epoch 199
Rec Loss: 0.014170
Epoch 249
Rec Loss: 0.013966
Epoch 299
Rec Loss: 0.013772
Epoch 349
Rec Loss: 0.013487
Epoch 399
Rec Loss: 0.013294
Epoch 449
Rec Loss: 0.013279
Epoch 499
Rec Loss: 0.012968
Epoch 549
Rec Loss: 0.013243
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.192852
Epoch 99
Rec Loss: 10.174887
Epoch 149
Rec Loss: 10.165584
Epoch 199
Rec Loss: 10.149589
Epoch 249
Rec Loss: 10.134243
Epoch 299
Rec Loss: 10.117948
Epoch 349
Rec Loss: 10.102428
Epoch 399
Rec Loss: 10.093277
Epoch 449
Rec Loss: 10.081419
Epoch 499
Rec Loss: 10.072741
Epoch 549
Rec Loss: 10.074230
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.074372
Insample Error: 0.211055
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.998904
Epoch 99
Rec Loss: 4.006802
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.822979
Epoch 99
Rec Loss: 9.792678
Epoch 149
Rec Loss: 9.729340
Epoch 199
Rec Loss: 9.777093
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.706928
Insample Error 3.365364
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.406785
Epoch 99 
Prediction Loss: 0.131196
Epoch 149 
Prediction Loss: 0.074312
Epoch 199 
Prediction Loss: 0.047945
Epoch 249 
Prediction Loss: 0.034055
Epoch 299 
Prediction Loss: 0.025464
Epoch 349 
Prediction Loss: 0.021465
Epoch 399 
Prediction Loss: 0.018735
Epoch 449 
Prediction Loss: 0.015744
Epoch 499 
Prediction Loss: 0.013539
Epoch 549 
Prediction Loss: 0.012661
Epoch 599 
Prediction Loss: 0.012661
Epoch 649 
Prediction Loss: 0.012522
Epoch 699 
Prediction Loss: 0.009380
Epoch 749 
Prediction Loss: 0.010086
Epoch 799 
Prediction Loss: 0.012711
Epoch 849 
Prediction Loss: 0.007459
Epoch 899 
Prediction Loss: 0.006592
Epoch 949 
Prediction Loss: 0.006388
Epoch 999 
Prediction Loss: 0.006321
Epoch 1049 
Prediction Loss: 0.005777
Epoch 1099 
Prediction Loss: 0.007232
Epoch 1149 
Prediction Loss: 0.004692
Epoch 1199 
Prediction Loss: 0.005495
Epoch 1249 
Prediction Loss: 0.005072
Epoch 1299 
Prediction Loss: 0.004211
Epoch 1349 
Prediction Loss: 0.004773
Epoch 1399 
Prediction Loss: 0.004436
Epoch 1449 
Prediction Loss: 0.004590
Epoch 1499 
Prediction Loss: 0.005014
Epoch 1549 
Prediction Loss: 0.004408
Epoch 1599 
Prediction Loss: 0.005159
Epoch 1649 
Prediction Loss: 0.003642
Epoch 1699 
Prediction Loss: 0.003450
Epoch 1749 
Prediction Loss: 0.003264
Epoch 1799 
Prediction Loss: 0.005489
Epoch 1849 
Prediction Loss: 0.003272
Epoch 1899 
Prediction Loss: 0.003043
Epoch 1949 
Prediction Loss: 0.003671
Epoch 1999 
Prediction Loss: 0.003960
Epoch 2049 
Prediction Loss: 0.005354
Epoch 2099 
Prediction Loss: 0.002910
Epoch 2149 
Prediction Loss: 0.004528
Epoch 2199 
Prediction Loss: 0.003133
Epoch 2249 
Prediction Loss: 0.003108
Epoch 2299 
Prediction Loss: 0.002565
Epoch 2349 
Prediction Loss: 0.003736
Epoch 2399 
Prediction Loss: 0.002463
Epoch 2449 
Prediction Loss: 0.003341
Epoch 2499 
Prediction Loss: 0.003534
Epoch 2549 
Prediction Loss: 0.003443
Epoch 2599 
Prediction Loss: 0.001985
Epoch 2649 
Prediction Loss: 0.002566
Epoch 2699 
Prediction Loss: 0.003621
Epoch 2749 
Prediction Loss: 0.004727
Epoch 2799 
Prediction Loss: 0.003380
Epoch 2849 
Prediction Loss: 0.004118
Epoch 2899 
Prediction Loss: 0.002365
Epoch 2949 
Prediction Loss: 0.002072
Epoch 2999 
Prediction Loss: 0.002136
Epoch 3049 
Prediction Loss: 0.002044
Epoch 3099 
Prediction Loss: 0.001951
Epoch 3149 
Prediction Loss: 0.002738
Epoch 3199 
Prediction Loss: 0.002626
Epoch 3249 
Prediction Loss: 0.003143
Epoch 3299 
Prediction Loss: 0.002328
Epoch 3349 
Prediction Loss: 0.001972
Epoch 3399 
Prediction Loss: 0.002553
Epoch 3449 
Prediction Loss: 0.002611
Epoch 3499 
Prediction Loss: 0.002272
Epoch 3549 
Prediction Loss: 0.002699
Epoch 3599 
Prediction Loss: 0.001622
Epoch 3649 
Prediction Loss: 0.002210
Epoch 3699 
Prediction Loss: 0.002094
Epoch 3749 
Prediction Loss: 0.003209
Epoch 3799 
Prediction Loss: 0.002364
Epoch 3849 
Prediction Loss: 0.001835
Epoch 3899 
Prediction Loss: 0.002260
Epoch 3949 
Prediction Loss: 0.002812
Epoch 3999 
Prediction Loss: 0.001578
Epoch 4049 
Prediction Loss: 0.001732
Epoch 4099 
Prediction Loss: 0.001812
Epoch 4149 
Prediction Loss: 0.001854
Epoch 4199 
Prediction Loss: 0.002041
Epoch 4249 
Prediction Loss: 0.001872
Epoch 4299 
Prediction Loss: 0.002264
Epoch 4349 
Prediction Loss: 0.001524
Epoch 4399 
Prediction Loss: 0.002056
Epoch 4449 
Prediction Loss: 0.002972
Epoch 4499 
Prediction Loss: 0.001463
Epoch 4549 
Prediction Loss: 0.002227
Epoch 4599 
Prediction Loss: 0.001821
Epoch 4649 
Prediction Loss: 0.005223
Epoch 4699 
Prediction Loss: 0.001325
Epoch 4749 
Prediction Loss: 0.001677
Epoch 4799 
Prediction Loss: 0.001395
Epoch 4849 
Prediction Loss: 0.001844
Epoch 4899 
Prediction Loss: 0.001987
Epoch 4949 
Prediction Loss: 0.001468
Epoch 4999 
Prediction Loss: 0.001240
Epoch 5049 
Prediction Loss: 0.001311
Epoch 5099 
Prediction Loss: 0.001508
Epoch 5149 
Prediction Loss: 0.001772
Epoch 5199 
Prediction Loss: 0.001297
Epoch 5249 
Prediction Loss: 0.002658
Epoch 5299 
Prediction Loss: 0.001348
Epoch 5349 
Prediction Loss: 0.001703
Epoch 5399 
Prediction Loss: 0.001525
Epoch 5449 
Prediction Loss: 0.001594
Epoch 5499 
Prediction Loss: 0.001201
Epoch 5549 
Prediction Loss: 0.001102
Epoch 5599 
Prediction Loss: 0.002016
Epoch 5649 
Prediction Loss: 0.002172
Epoch 5699 
Prediction Loss: 0.002362
Epoch 5749 
Prediction Loss: 0.001459
Epoch 5799 
Prediction Loss: 0.003901
Epoch 5849 
Prediction Loss: 0.002174
Epoch 5899 
Prediction Loss: 0.001282
Epoch 5949 
Prediction Loss: 0.001072
Epoch 5999 
Prediction Loss: 0.001742
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.045760
Insample Error 0.216299
[31m========== repeat time 5 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.110485
Rec Loss: 9.849226
KL Loss: 0.261258
Y Loss: 0.604334
T Loss: 9.547059
Epoch 99 
Overall Loss: 9.836209
Rec Loss: 9.698039
KL Loss: 0.138170
Y Loss: 0.255205
T Loss: 9.570436
Epoch 149 
Overall Loss: 9.755390
Rec Loss: 9.643628
KL Loss: 0.111762
Y Loss: 0.144782
T Loss: 9.571237
Epoch 199 
Overall Loss: 9.725736
Rec Loss: 9.632307
KL Loss: 0.093429
Y Loss: 0.103191
T Loss: 9.580711
Epoch 249 
Overall Loss: 9.695772
Rec Loss: 9.612802
KL Loss: 0.082969
Y Loss: 0.081188
T Loss: 9.572208
Epoch 299 
Overall Loss: 9.692375
Rec Loss: 9.612546
KL Loss: 0.079829
Y Loss: 0.070512
T Loss: 9.577290
Epoch 349 
Overall Loss: 9.679934
Rec Loss: 9.611219
KL Loss: 0.068716
Y Loss: 0.055923
T Loss: 9.583257
Epoch 399 
Overall Loss: 9.665899
Rec Loss: 9.601842
KL Loss: 0.064057
Y Loss: 0.052909
T Loss: 9.575388
Epoch 449 
Overall Loss: 9.658412
Rec Loss: 9.598508
KL Loss: 0.059904
Y Loss: 0.047342
T Loss: 9.574836
Epoch 499 
Overall Loss: 9.648375
Rec Loss: 9.585492
KL Loss: 0.062884
Y Loss: 0.046689
T Loss: 9.562147
Epoch 549 
Overall Loss: 9.648168
Rec Loss: 9.585257
KL Loss: 0.062911
Y Loss: 0.039829
T Loss: 9.565342
Epoch 599 
Overall Loss: 9.638258
Rec Loss: 9.587938
KL Loss: 0.050319
Y Loss: 0.036676
T Loss: 9.569600
Epoch 649 
Overall Loss: 9.654929
Rec Loss: 9.584433
KL Loss: 0.070496
Y Loss: 0.034530
T Loss: 9.567168
Epoch 699 
Overall Loss: 9.626646
Rec Loss: 9.579427
KL Loss: 0.047218
Y Loss: 0.033431
T Loss: 9.562712
Epoch 749 
Overall Loss: 9.620223
Rec Loss: 9.576426
KL Loss: 0.043797
Y Loss: 0.031443
T Loss: 9.560704
Epoch 799 
Overall Loss: 9.637151
Rec Loss: 9.578379
KL Loss: 0.058772
Y Loss: 0.033958
T Loss: 9.561400
Epoch 849 
Overall Loss: 9.611276
Rec Loss: 9.568989
KL Loss: 0.042287
Y Loss: 0.030163
T Loss: 9.553908
Epoch 899 
Overall Loss: 9.630010
Rec Loss: 9.583117
KL Loss: 0.046892
Y Loss: 0.052142
T Loss: 9.557047
Epoch 949 
Overall Loss: 9.612444
Rec Loss: 9.563330
KL Loss: 0.049115
Y Loss: 0.034534
T Loss: 9.546063
Epoch 999 
Overall Loss: 9.596288
Rec Loss: 9.559564
KL Loss: 0.036724
Y Loss: 0.026020
T Loss: 9.546553
Epoch 1049 
Overall Loss: 9.615562
Rec Loss: 9.564616
KL Loss: 0.050946
Y Loss: 0.025670
T Loss: 9.551780
Epoch 1099 
Overall Loss: 9.591340
Rec Loss: 9.555534
KL Loss: 0.035807
Y Loss: 0.025222
T Loss: 9.542922
Epoch 1149 
Overall Loss: 9.597403
Rec Loss: 9.554280
KL Loss: 0.043123
Y Loss: 0.025888
T Loss: 9.541336
Epoch 1199 
Overall Loss: 9.615948
Rec Loss: 9.569423
KL Loss: 0.046525
Y Loss: 0.053895
T Loss: 9.542476
Epoch 1249 
Overall Loss: 9.582325
Rec Loss: 9.549655
KL Loss: 0.032670
Y Loss: 0.022842
T Loss: 9.538234
Epoch 1299 
Overall Loss: 9.579450
Rec Loss: 9.545051
KL Loss: 0.034398
Y Loss: 0.024297
T Loss: 9.532903
Epoch 1349 
Overall Loss: 9.574801
Rec Loss: 9.539066
KL Loss: 0.035735
Y Loss: 0.028610
T Loss: 9.524762
Epoch 1399 
Overall Loss: 9.575899
Rec Loss: 9.543350
KL Loss: 0.032549
Y Loss: 0.021824
T Loss: 9.532438
Epoch 1449 
Overall Loss: 9.578270
Rec Loss: 9.542089
KL Loss: 0.036181
Y Loss: 0.022751
T Loss: 9.530714
Epoch 1499 
Overall Loss: 9.568903
Rec Loss: 9.537485
KL Loss: 0.031418
Y Loss: 0.023084
T Loss: 9.525943
Epoch 1549 
Overall Loss: 9.568740
Rec Loss: 9.538941
KL Loss: 0.029798
Y Loss: 0.020346
T Loss: 9.528768
Epoch 1599 
Overall Loss: 9.566018
Rec Loss: 9.531315
KL Loss: 0.034703
Y Loss: 0.022988
T Loss: 9.519821
Epoch 1649 
Overall Loss: 9.574535
Rec Loss: 9.539241
KL Loss: 0.035294
Y Loss: 0.027860
T Loss: 9.525311
Epoch 1699 
Overall Loss: 9.566249
Rec Loss: 9.533253
KL Loss: 0.032995
Y Loss: 0.022631
T Loss: 9.521938
Epoch 1749 
Overall Loss: 9.565399
Rec Loss: 9.532840
KL Loss: 0.032559
Y Loss: 0.019291
T Loss: 9.523195
Epoch 1799 
Overall Loss: 9.578830
Rec Loss: 9.533501
KL Loss: 0.045329
Y Loss: 0.019895
T Loss: 9.523554
Epoch 1849 
Overall Loss: 9.564714
Rec Loss: 9.530443
KL Loss: 0.034271
Y Loss: 0.029391
T Loss: 9.515747
Epoch 1899 
Overall Loss: 9.562846
Rec Loss: 9.531726
KL Loss: 0.031120
Y Loss: 0.027828
T Loss: 9.517812
Epoch 1949 
Overall Loss: 9.557115
Rec Loss: 9.526038
KL Loss: 0.031077
Y Loss: 0.020242
T Loss: 9.515917
Epoch 1999 
Overall Loss: 9.549343
Rec Loss: 9.522556
KL Loss: 0.026786
Y Loss: 0.021206
T Loss: 9.511953
Epoch 2049 
Overall Loss: 9.547304
Rec Loss: 9.521182
KL Loss: 0.026122
Y Loss: 0.019840
T Loss: 9.511263
Epoch 2099 
Overall Loss: 9.558288
Rec Loss: 9.520821
KL Loss: 0.037467
Y Loss: 0.020516
T Loss: 9.510564
Epoch 2149 
Overall Loss: 9.549039
Rec Loss: 9.519743
KL Loss: 0.029296
Y Loss: 0.022843
T Loss: 9.508321
Epoch 2199 
Overall Loss: 9.573976
Rec Loss: 9.522325
KL Loss: 0.051651
Y Loss: 0.025620
T Loss: 9.509515
Epoch 2249 
Overall Loss: 9.542119
Rec Loss: 9.514838
KL Loss: 0.027281
Y Loss: 0.020100
T Loss: 9.504788
Epoch 2299 
Overall Loss: 9.546910
Rec Loss: 9.513027
KL Loss: 0.033883
Y Loss: 0.018084
T Loss: 9.503985
Epoch 2349 
Overall Loss: 9.537174
Rec Loss: 9.511656
KL Loss: 0.025518
Y Loss: 0.019249
T Loss: 9.502031
Epoch 2399 
Overall Loss: 9.537441
Rec Loss: 9.506560
KL Loss: 0.030881
Y Loss: 0.017486
T Loss: 9.497817
Epoch 2449 
Overall Loss: 9.532513
Rec Loss: 9.505869
KL Loss: 0.026644
Y Loss: 0.017705
T Loss: 9.497016
Epoch 2499 
Overall Loss: 9.531372
Rec Loss: 9.504493
KL Loss: 0.026879
Y Loss: 0.017838
T Loss: 9.495574
Epoch 2549 
Overall Loss: 9.529091
Rec Loss: 9.504527
KL Loss: 0.024564
Y Loss: 0.018371
T Loss: 9.495341
Epoch 2599 
Overall Loss: 9.530344
Rec Loss: 9.505213
KL Loss: 0.025131
Y Loss: 0.018009
T Loss: 9.496208
Epoch 2649 
Overall Loss: 9.537165
Rec Loss: 9.503042
KL Loss: 0.034123
Y Loss: 0.017512
T Loss: 9.494286
Epoch 2699 
Overall Loss: 9.528131
Rec Loss: 9.500008
KL Loss: 0.028123
Y Loss: 0.017638
T Loss: 9.491189
Epoch 2749 
Overall Loss: 9.521308
Rec Loss: 9.496998
KL Loss: 0.024310
Y Loss: 0.018725
T Loss: 9.487636
Epoch 2799 
Overall Loss: 9.523102
Rec Loss: 9.497396
KL Loss: 0.025706
Y Loss: 0.018427
T Loss: 9.488182
Epoch 2849 
Overall Loss: 9.534770
Rec Loss: 9.502637
KL Loss: 0.032133
Y Loss: 0.021977
T Loss: 9.491648
Epoch 2899 
Overall Loss: 9.522236
Rec Loss: 9.495979
KL Loss: 0.026257
Y Loss: 0.015492
T Loss: 9.488233
Epoch 2949 
Overall Loss: 9.519021
Rec Loss: 9.494031
KL Loss: 0.024990
Y Loss: 0.019336
T Loss: 9.484363
Epoch 2999 
Overall Loss: 9.524549
Rec Loss: 9.496035
KL Loss: 0.028515
Y Loss: 0.016529
T Loss: 9.487770
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.022796
Epoch 99
Rec Loss: 0.017836
Epoch 149
Rec Loss: 0.016413
Epoch 199
Rec Loss: 0.015471
Epoch 249
Rec Loss: 0.015050
Epoch 299
Rec Loss: 0.015201
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.187959
Epoch 99
Rec Loss: 10.160979
Epoch 149
Rec Loss: 10.133576
Epoch 199
Rec Loss: 10.140576
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.059468
Insample Error: 0.209336
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.988186
Epoch 99
Rec Loss: 3.995746
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.789441
Epoch 99
Rec Loss: 9.755376
Epoch 149
Rec Loss: 9.749991
Epoch 199
Rec Loss: 9.761434
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.806302
Insample Error 3.344466
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.401064
Epoch 99 
Prediction Loss: 0.140469
Epoch 149 
Prediction Loss: 0.084520
Epoch 199 
Prediction Loss: 0.060855
Epoch 249 
Prediction Loss: 0.041290
Epoch 299 
Prediction Loss: 0.031976
Epoch 349 
Prediction Loss: 0.027179
Epoch 399 
Prediction Loss: 0.020017
Epoch 449 
Prediction Loss: 0.020188
Epoch 499 
Prediction Loss: 0.013629
Epoch 549 
Prediction Loss: 0.011616
Epoch 599 
Prediction Loss: 0.010553
Epoch 649 
Prediction Loss: 0.009541
Epoch 699 
Prediction Loss: 0.008724
Epoch 749 
Prediction Loss: 0.008034
Epoch 799 
Prediction Loss: 0.007727
Epoch 849 
Prediction Loss: 0.006660
Epoch 899 
Prediction Loss: 0.007691
Epoch 949 
Prediction Loss: 0.007711
Epoch 999 
Prediction Loss: 0.006506
Epoch 1049 
Prediction Loss: 0.005527
Epoch 1099 
Prediction Loss: 0.006695
Epoch 1149 
Prediction Loss: 0.005431
Epoch 1199 
Prediction Loss: 0.004392
Epoch 1249 
Prediction Loss: 0.004607
Epoch 1299 
Prediction Loss: 0.004975
Epoch 1349 
Prediction Loss: 0.004402
Epoch 1399 
Prediction Loss: 0.004060
Epoch 1449 
Prediction Loss: 0.004273
Epoch 1499 
Prediction Loss: 0.003348
Epoch 1549 
Prediction Loss: 0.005242
Epoch 1599 
Prediction Loss: 0.004289
Epoch 1649 
Prediction Loss: 0.003999
Epoch 1699 
Prediction Loss: 0.002847
Epoch 1749 
Prediction Loss: 0.003700
Epoch 1799 
Prediction Loss: 0.006391
Epoch 1849 
Prediction Loss: 0.003584
Epoch 1899 
Prediction Loss: 0.002842
Epoch 1949 
Prediction Loss: 0.002546
Epoch 1999 
Prediction Loss: 0.002805
Epoch 2049 
Prediction Loss: 0.007002
Epoch 2099 
Prediction Loss: 0.002967
Epoch 2149 
Prediction Loss: 0.002409
Epoch 2199 
Prediction Loss: 0.003424
Epoch 2249 
Prediction Loss: 0.004244
Epoch 2299 
Prediction Loss: 0.004720
Epoch 2349 
Prediction Loss: 0.002146
Epoch 2399 
Prediction Loss: 0.002466
Epoch 2449 
Prediction Loss: 0.002258
Epoch 2499 
Prediction Loss: 0.001920
Epoch 2549 
Prediction Loss: 0.002649
Epoch 2599 
Prediction Loss: 0.001893
Epoch 2649 
Prediction Loss: 0.001920
Epoch 2699 
Prediction Loss: 0.001884
Epoch 2749 
Prediction Loss: 0.002342
Epoch 2799 
Prediction Loss: 0.002631
Epoch 2849 
Prediction Loss: 0.002513
Epoch 2899 
Prediction Loss: 0.001831
Epoch 2949 
Prediction Loss: 0.001906
Epoch 2999 
Prediction Loss: 0.002994
Epoch 3049 
Prediction Loss: 0.001771
Epoch 3099 
Prediction Loss: 0.003330
Epoch 3149 
Prediction Loss: 0.001529
Epoch 3199 
Prediction Loss: 0.001989
Epoch 3249 
Prediction Loss: 0.001620
Epoch 3299 
Prediction Loss: 0.002020
Epoch 3349 
Prediction Loss: 0.001551
Epoch 3399 
Prediction Loss: 0.001960
Epoch 3449 
Prediction Loss: 0.001478
Epoch 3499 
Prediction Loss: 0.002460
Epoch 3549 
Prediction Loss: 0.001909
Epoch 3599 
Prediction Loss: 0.001881
Epoch 3649 
Prediction Loss: 0.001654
Epoch 3699 
Prediction Loss: 0.002242
Epoch 3749 
Prediction Loss: 0.001456
Epoch 3799 
Prediction Loss: 0.001620
Epoch 3849 
Prediction Loss: 0.002070
Epoch 3899 
Prediction Loss: 0.003256
Epoch 3949 
Prediction Loss: 0.001813
Epoch 3999 
Prediction Loss: 0.001503
Epoch 4049 
Prediction Loss: 0.002106
Epoch 4099 
Prediction Loss: 0.001394
Epoch 4149 
Prediction Loss: 0.001672
Epoch 4199 
Prediction Loss: 0.001841
Epoch 4249 
Prediction Loss: 0.001220
Epoch 4299 
Prediction Loss: 0.001922
Epoch 4349 
Prediction Loss: 0.001193
Epoch 4399 
Prediction Loss: 0.001426
Epoch 4449 
Prediction Loss: 0.002238
Epoch 4499 
Prediction Loss: 0.001091
Epoch 4549 
Prediction Loss: 0.002444
Epoch 4599 
Prediction Loss: 0.001168
Epoch 4649 
Prediction Loss: 0.001560
Epoch 4699 
Prediction Loss: 0.003606
Epoch 4749 
Prediction Loss: 0.001550
Epoch 4799 
Prediction Loss: 0.001201
Epoch 4849 
Prediction Loss: 0.001783
Epoch 4899 
Prediction Loss: 0.001153
Epoch 4949 
Prediction Loss: 0.001121
Epoch 4999 
Prediction Loss: 0.002332
Epoch 5049 
Prediction Loss: 0.000987
Epoch 5099 
Prediction Loss: 0.001648
Epoch 5149 
Prediction Loss: 0.001797
Epoch 5199 
Prediction Loss: 0.001257
Epoch 5249 
Prediction Loss: 0.001001
Epoch 5299 
Prediction Loss: 0.001292
Epoch 5349 
Prediction Loss: 0.001349
Epoch 5399 
Prediction Loss: 0.001057
Epoch 5449 
Prediction Loss: 0.000852
Epoch 5499 
Prediction Loss: 0.001391
Epoch 5549 
Prediction Loss: 0.001277
Epoch 5599 
Prediction Loss: 0.001106
Epoch 5649 
Prediction Loss: 0.001899
Epoch 5699 
Prediction Loss: 0.002094
Epoch 5749 
Prediction Loss: 0.000975
Epoch 5799 
Prediction Loss: 0.001463
Epoch 5849 
Prediction Loss: 0.000853
Epoch 5899 
Prediction Loss: 0.001215
Epoch 5949 
Prediction Loss: 0.001247
Epoch 5999 
Prediction Loss: 0.000950
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.044506
Insample Error 0.217306
Ours, Train RMSE
0.0630, 
0.0732, 
0.0863, 
0.0744, 
0.0595, 
CEVAE, Train RMSE
3.8371, 
3.7922, 
3.7806, 
3.7069, 
3.8063, 
Ours, Insample RMSE
0.2270, 
0.2230, 
0.2373, 
0.2111, 
0.2093, 
CEVAE, Insample RMSE
3.3440, 
3.3448, 
3.3560, 
3.3654, 
3.3445, 
Direct Regression, Insample RMSE
0.1431, 
0.2460, 
0.1819, 
0.2163, 
0.2173, 
Train, RMSE mean 0.0713 std 0.0095
CEVAE, RMSE mean 3.7846 std 0.0432
Ours, RMSE mean 0.2215 std 0.0104, reconstruct confounder 0.0139 (0.0010) noise 10.1164 (0.0513)
CEVAE, RMSE mean 3.3509 std 0.0085, reconstruct confounder 3.9900 (0.0093) noise 9.6597 (0.2458)
Direct Regression, RMSE mean 0.2009 std 0.0354
Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=4, mask=0, nlayer=50, obsm=4, stop=2000, ycof=0.5, ylayer=50)
Y Mean 1.776465, Std 3.501489 
Test Y Mean -0.006496, Std 3.341313 
Observe confounder 4, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.091420
Rec Loss: 9.843287
KL Loss: 0.248134
Y Loss: 0.592011
T Loss: 9.547281
Epoch 99 
Overall Loss: 9.841494
Rec Loss: 9.713861
KL Loss: 0.127634
Y Loss: 0.271391
T Loss: 9.578166
Epoch 149 
Overall Loss: 9.763934
Rec Loss: 9.661862
KL Loss: 0.102072
Y Loss: 0.165922
T Loss: 9.578902
Epoch 199 
Overall Loss: 9.725229
Rec Loss: 9.633140
KL Loss: 0.092089
Y Loss: 0.114478
T Loss: 9.575901
Epoch 249 
Overall Loss: 9.701840
Rec Loss: 9.623482
KL Loss: 0.078358
Y Loss: 0.084998
T Loss: 9.580983
Epoch 299 
Overall Loss: 9.679581
Rec Loss: 9.606798
KL Loss: 0.072783
Y Loss: 0.072480
T Loss: 9.570558
Epoch 349 
Overall Loss: 9.674313
Rec Loss: 9.605331
KL Loss: 0.068981
Y Loss: 0.066029
T Loss: 9.572317
Epoch 399 
Overall Loss: 9.664017
Rec Loss: 9.599796
KL Loss: 0.064222
Y Loss: 0.057475
T Loss: 9.571058
Epoch 449 
Overall Loss: 9.656161
Rec Loss: 9.595887
KL Loss: 0.060274
Y Loss: 0.048369
T Loss: 9.571702
Epoch 499 
Overall Loss: 9.653965
Rec Loss: 9.591233
KL Loss: 0.062732
Y Loss: 0.048718
T Loss: 9.566874
Epoch 549 
Overall Loss: 9.643678
Rec Loss: 9.587875
KL Loss: 0.055803
Y Loss: 0.043644
T Loss: 9.566053
Epoch 599 
Overall Loss: 9.633731
Rec Loss: 9.582010
KL Loss: 0.051721
Y Loss: 0.040465
T Loss: 9.561777
Epoch 649 
Overall Loss: 9.634662
Rec Loss: 9.582931
KL Loss: 0.051731
Y Loss: 0.039237
T Loss: 9.563312
Epoch 699 
Overall Loss: 9.634478
Rec Loss: 9.584043
KL Loss: 0.050434
Y Loss: 0.041209
T Loss: 9.563439
Epoch 749 
Overall Loss: 9.624240
Rec Loss: 9.577441
KL Loss: 0.046800
Y Loss: 0.037006
T Loss: 9.558937
Epoch 799 
Overall Loss: 9.649947
Rec Loss: 9.577278
KL Loss: 0.072669
Y Loss: 0.037218
T Loss: 9.558669
Epoch 849 
Overall Loss: 9.614647
Rec Loss: 9.572576
KL Loss: 0.042071
Y Loss: 0.033782
T Loss: 9.555685
Epoch 899 
Overall Loss: 9.609396
Rec Loss: 9.568127
KL Loss: 0.041269
Y Loss: 0.030620
T Loss: 9.552816
Epoch 949 
Overall Loss: 9.607216
Rec Loss: 9.565132
KL Loss: 0.042084
Y Loss: 0.030696
T Loss: 9.549783
Epoch 999 
Overall Loss: 9.623904
Rec Loss: 9.567570
KL Loss: 0.056335
Y Loss: 0.032731
T Loss: 9.551204
Epoch 1049 
Overall Loss: 9.599452
Rec Loss: 9.558419
KL Loss: 0.041032
Y Loss: 0.028729
T Loss: 9.544055
Epoch 1099 
Overall Loss: 9.602882
Rec Loss: 9.562664
KL Loss: 0.040219
Y Loss: 0.026891
T Loss: 9.549219
Epoch 1149 
Overall Loss: 9.591564
Rec Loss: 9.551014
KL Loss: 0.040550
Y Loss: 0.029940
T Loss: 9.536044
Epoch 1199 
Overall Loss: 9.599610
Rec Loss: 9.559443
KL Loss: 0.040166
Y Loss: 0.028141
T Loss: 9.545373
Epoch 1249 
Overall Loss: 9.581306
Rec Loss: 9.546693
KL Loss: 0.034613
Y Loss: 0.026999
T Loss: 9.533194
Epoch 1299 
Overall Loss: 9.581639
Rec Loss: 9.544519
KL Loss: 0.037120
Y Loss: 0.026623
T Loss: 9.531208
Epoch 1349 
Overall Loss: 9.576639
Rec Loss: 9.542856
KL Loss: 0.033783
Y Loss: 0.024451
T Loss: 9.530631
Epoch 1399 
Overall Loss: 9.607701
Rec Loss: 9.548267
KL Loss: 0.059434
Y Loss: 0.025698
T Loss: 9.535418
Epoch 1449 
Overall Loss: 9.569416
Rec Loss: 9.537191
KL Loss: 0.032225
Y Loss: 0.026447
T Loss: 9.523968
Epoch 1499 
Overall Loss: 9.574084
Rec Loss: 9.538931
KL Loss: 0.035153
Y Loss: 0.024225
T Loss: 9.526818
Epoch 1549 
Overall Loss: 9.589330
Rec Loss: 9.546208
KL Loss: 0.043121
Y Loss: 0.043360
T Loss: 9.524528
Epoch 1599 
Overall Loss: 9.562843
Rec Loss: 9.531771
KL Loss: 0.031072
Y Loss: 0.024934
T Loss: 9.519303
Epoch 1649 
Overall Loss: 9.581998
Rec Loss: 9.536726
KL Loss: 0.045272
Y Loss: 0.022845
T Loss: 9.525303
Epoch 1699 
Overall Loss: 9.562560
Rec Loss: 9.532640
KL Loss: 0.029920
Y Loss: 0.022337
T Loss: 9.521471
Epoch 1749 
Overall Loss: 9.555114
Rec Loss: 9.526133
KL Loss: 0.028981
Y Loss: 0.022271
T Loss: 9.514998
Epoch 1799 
Overall Loss: 9.554675
Rec Loss: 9.524276
KL Loss: 0.030399
Y Loss: 0.021268
T Loss: 9.513643
Epoch 1849 
Overall Loss: 9.553879
Rec Loss: 9.524394
KL Loss: 0.029484
Y Loss: 0.023655
T Loss: 9.512567
Epoch 1899 
Overall Loss: 9.561322
Rec Loss: 9.522385
KL Loss: 0.038937
Y Loss: 0.034284
T Loss: 9.505243
Epoch 1949 
Overall Loss: 9.548935
Rec Loss: 9.520199
KL Loss: 0.028736
Y Loss: 0.021070
T Loss: 9.509664
Epoch 1999 
Overall Loss: 9.548355
Rec Loss: 9.517742
KL Loss: 0.030613
Y Loss: 0.019832
T Loss: 9.507826
Epoch 2049 
Overall Loss: 9.551026
Rec Loss: 9.519849
KL Loss: 0.031177
Y Loss: 0.021056
T Loss: 9.509321
Epoch 2099 
Overall Loss: 9.546705
Rec Loss: 9.516142
KL Loss: 0.030563
Y Loss: 0.019651
T Loss: 9.506316
Epoch 2149 
Overall Loss: 9.545270
Rec Loss: 9.514827
KL Loss: 0.030443
Y Loss: 0.019358
T Loss: 9.505148
Epoch 2199 
Overall Loss: 9.552331
Rec Loss: 9.518832
KL Loss: 0.033498
Y Loss: 0.019990
T Loss: 9.508837
Epoch 2249 
Overall Loss: 9.542418
Rec Loss: 9.513880
KL Loss: 0.028538
Y Loss: 0.019576
T Loss: 9.504092
Epoch 2299 
Overall Loss: 9.538097
Rec Loss: 9.512713
KL Loss: 0.025383
Y Loss: 0.020507
T Loss: 9.502460
Epoch 2349 
Overall Loss: 9.559610
Rec Loss: 9.512124
KL Loss: 0.047486
Y Loss: 0.020180
T Loss: 9.502034
Epoch 2399 
Overall Loss: 9.532112
Rec Loss: 9.507055
KL Loss: 0.025057
Y Loss: 0.018848
T Loss: 9.497631
Epoch 2449 
Overall Loss: 9.530896
Rec Loss: 9.502741
KL Loss: 0.028155
Y Loss: 0.018623
T Loss: 9.493429
Epoch 2499 
Overall Loss: 9.529714
Rec Loss: 9.500130
KL Loss: 0.029583
Y Loss: 0.018124
T Loss: 9.491068
Epoch 2549 
Overall Loss: 9.526960
Rec Loss: 9.500488
KL Loss: 0.026472
Y Loss: 0.018162
T Loss: 9.491407
Epoch 2599 
Overall Loss: 9.529362
Rec Loss: 9.503831
KL Loss: 0.025531
Y Loss: 0.017847
T Loss: 9.494908
Epoch 2649 
Overall Loss: 9.531382
Rec Loss: 9.501644
KL Loss: 0.029738
Y Loss: 0.018954
T Loss: 9.492166
Epoch 2699 
Overall Loss: 9.520168
Rec Loss: 9.495663
KL Loss: 0.024505
Y Loss: 0.019337
T Loss: 9.485995
Epoch 2749 
Overall Loss: 9.527751
Rec Loss: 9.503041
KL Loss: 0.024710
Y Loss: 0.019304
T Loss: 9.493389
Epoch 2799 
Overall Loss: 9.521441
Rec Loss: 9.496503
KL Loss: 0.024938
Y Loss: 0.017629
T Loss: 9.487688
Epoch 2849 
Overall Loss: 9.521975
Rec Loss: 9.496088
KL Loss: 0.025887
Y Loss: 0.019449
T Loss: 9.486364
Epoch 2899 
Overall Loss: 9.520368
Rec Loss: 9.495694
KL Loss: 0.024674
Y Loss: 0.020399
T Loss: 9.485495
Epoch 2949 
Overall Loss: 9.514312
Rec Loss: 9.490160
KL Loss: 0.024153
Y Loss: 0.016872
T Loss: 9.481723
Epoch 2999 
Overall Loss: 9.518501
Rec Loss: 9.492223
KL Loss: 0.026278
Y Loss: 0.019753
T Loss: 9.482347
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.021352
Epoch 99
Rec Loss: 0.018162
Epoch 149
Rec Loss: 0.016928
Epoch 199
Rec Loss: 0.016292
Epoch 249
Rec Loss: 0.015882
Epoch 299
Rec Loss: 0.015342
Epoch 349
Rec Loss: 0.015320
Epoch 399
Rec Loss: 0.015682
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.183574
Epoch 99
Rec Loss: 10.174926
Epoch 149
Rec Loss: 10.146852
Epoch 199
Rec Loss: 10.139585
Epoch 249
Rec Loss: 10.129045
Epoch 299
Rec Loss: 10.132897
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.063022
Insample Error: 0.227018
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 20.922574
Rec Loss: 18.293463
KL Loss: 2.629111
Y Loss: 7.814102
T Loss: 13.417615
X Loss: 0.968797
Epoch 99 
Overall Loss: 3.074462
Rec Loss: -7.941332
KL Loss: 11.015794
Y Loss: 2.138112
T Loss: 13.047710
X Loss: -22.058098
Epoch 149 
Overall Loss: -3.611336
Rec Loss: -16.478057
KL Loss: 12.866721
Y Loss: 1.267385
T Loss: 12.500622
X Loss: -29.612372
Epoch 199 
Overall Loss: -8.009642
Rec Loss: -22.597992
KL Loss: 14.588350
Y Loss: 0.651492
T Loss: 11.880516
X Loss: -34.804255
Epoch 249 
Overall Loss: -10.150598
Rec Loss: -25.804870
KL Loss: 15.654272
Y Loss: 0.428825
T Loss: 11.667664
X Loss: -37.686947
Epoch 299 
Overall Loss: -11.647519
Rec Loss: -27.629612
KL Loss: 15.982093
Y Loss: 0.355647
T Loss: 11.591133
X Loss: -39.398569
Epoch 349 
Overall Loss: -12.707288
Rec Loss: -29.011937
KL Loss: 16.304648
Y Loss: 0.306026
T Loss: 11.532384
X Loss: -40.697332
Epoch 399 
Overall Loss: -13.384211
Rec Loss: -29.949549
KL Loss: 16.565338
Y Loss: 0.275227
T Loss: 11.479966
X Loss: -41.567128
Epoch 449 
Overall Loss: -14.300361
Rec Loss: -31.083918
KL Loss: 16.783558
Y Loss: 0.267712
T Loss: 11.470518
X Loss: -42.688293
Epoch 499 
Overall Loss: -14.972283
Rec Loss: -31.884373
KL Loss: 16.912090
Y Loss: 0.244669
T Loss: 11.451900
X Loss: -43.458608
Epoch 549 
Overall Loss: -15.704381
Rec Loss: -32.734272
KL Loss: 17.029891
Y Loss: 0.235035
T Loss: 11.404395
X Loss: -44.256184
Epoch 599 
Overall Loss: -16.128376
Rec Loss: -33.327564
KL Loss: 17.199188
Y Loss: 0.229900
T Loss: 11.383749
X Loss: -44.826263
Epoch 649 
Overall Loss: -16.776751
Rec Loss: -34.087991
KL Loss: 17.311238
Y Loss: 0.219405
T Loss: 11.341152
X Loss: -45.538844
Epoch 699 
Overall Loss: -17.119087
Rec Loss: -34.516327
KL Loss: 17.397242
Y Loss: 0.218492
T Loss: 11.314666
X Loss: -45.940240
Epoch 749 
Overall Loss: -17.534013
Rec Loss: -35.049667
KL Loss: 17.515653
Y Loss: 0.209012
T Loss: 11.272629
X Loss: -46.426800
Epoch 799 
Overall Loss: -17.877901
Rec Loss: -35.439488
KL Loss: 17.561586
Y Loss: 0.196345
T Loss: 11.273936
X Loss: -46.811595
Epoch 849 
Overall Loss: -18.407967
Rec Loss: -36.129189
KL Loss: 17.721222
Y Loss: 0.206618
T Loss: 11.229850
X Loss: -47.462347
Epoch 899 
Overall Loss: -18.752108
Rec Loss: -36.558939
KL Loss: 17.806831
Y Loss: 0.189940
T Loss: 11.218592
X Loss: -47.872501
Epoch 949 
Overall Loss: -19.029763
Rec Loss: -36.860860
KL Loss: 17.831097
Y Loss: 0.190999
T Loss: 11.194208
X Loss: -48.150568
Epoch 999 
Overall Loss: -19.161149
Rec Loss: -36.968952
KL Loss: 17.807803
Y Loss: 0.193405
T Loss: 11.183737
X Loss: -48.249391
Epoch 1049 
Overall Loss: -19.493545
Rec Loss: -37.478477
KL Loss: 17.984933
Y Loss: 0.174208
T Loss: 11.160302
X Loss: -48.725884
Epoch 1099 
Overall Loss: -19.856568
Rec Loss: -37.752133
KL Loss: 17.895566
Y Loss: 0.186207
T Loss: 11.147918
X Loss: -48.993155
Epoch 1149 
Overall Loss: -20.142913
Rec Loss: -38.241893
KL Loss: 18.098980
Y Loss: 0.174586
T Loss: 11.128583
X Loss: -49.457769
Epoch 1199 
Overall Loss: -20.244314
Rec Loss: -38.315815
KL Loss: 18.071501
Y Loss: 0.169534
T Loss: 11.092209
X Loss: -49.492790
Epoch 1249 
Overall Loss: -20.546420
Rec Loss: -38.615139
KL Loss: 18.068719
Y Loss: 0.164792
T Loss: 11.084175
X Loss: -49.781710
Epoch 1299 
Overall Loss: -20.516796
Rec Loss: -38.855390
KL Loss: 18.338594
Y Loss: 0.167703
T Loss: 11.058682
X Loss: -49.997922
Epoch 1349 
Overall Loss: -20.921081
Rec Loss: -39.264410
KL Loss: 18.343329
Y Loss: 0.155981
T Loss: 11.030004
X Loss: -50.372404
Epoch 1399 
Overall Loss: -21.199728
Rec Loss: -39.617678
KL Loss: 18.417950
Y Loss: 0.159048
T Loss: 11.020338
X Loss: -50.717540
Epoch 1449 
Overall Loss: -21.369023
Rec Loss: -39.865455
KL Loss: 18.496430
Y Loss: 0.153402
T Loss: 10.996348
X Loss: -50.938502
Epoch 1499 
Overall Loss: -21.252217
Rec Loss: -39.784766
KL Loss: 18.532548
Y Loss: 0.145444
T Loss: 10.969700
X Loss: -50.827188
Epoch 1549 
Overall Loss: -21.574063
Rec Loss: -40.198623
KL Loss: 18.624559
Y Loss: 0.156594
T Loss: 10.965131
X Loss: -51.242050
Epoch 1599 
Overall Loss: -21.848989
Rec Loss: -40.491830
KL Loss: 18.642842
Y Loss: 0.155289
T Loss: 10.945634
X Loss: -51.515110
Epoch 1649 
Overall Loss: -21.449600
Rec Loss: -40.159204
KL Loss: 18.709605
Y Loss: 0.152432
T Loss: 10.935829
X Loss: -51.171251
Epoch 1699 
Overall Loss: -21.898518
Rec Loss: -40.576571
KL Loss: 18.678052
Y Loss: 0.142215
T Loss: 10.929980
X Loss: -51.577657
Epoch 1749 
Overall Loss: -22.232271
Rec Loss: -40.982450
KL Loss: 18.750180
Y Loss: 0.153309
T Loss: 10.912749
X Loss: -51.971856
Epoch 1799 
Overall Loss: -22.056016
Rec Loss: -40.885981
KL Loss: 18.829965
Y Loss: 0.138305
T Loss: 10.908630
X Loss: -51.863763
Epoch 1849 
Overall Loss: -22.560393
Rec Loss: -41.392013
KL Loss: 18.831618
Y Loss: 0.143245
T Loss: 10.905837
X Loss: -52.369472
Epoch 1899 
Overall Loss: -22.621874
Rec Loss: -41.607612
KL Loss: 18.985738
Y Loss: 0.144097
T Loss: 10.897204
X Loss: -52.576865
Epoch 1949 
Overall Loss: -22.764865
Rec Loss: -41.696187
KL Loss: 18.931321
Y Loss: 0.140085
T Loss: 10.884911
X Loss: -52.651141
Epoch 1999 
Overall Loss: -22.976274
Rec Loss: -41.987570
KL Loss: 19.011296
Y Loss: 0.138927
T Loss: 10.888721
X Loss: -52.945754
Epoch 2049 
Overall Loss: -23.087987
Rec Loss: -41.958618
KL Loss: 18.870632
Y Loss: 0.139182
T Loss: 10.882435
X Loss: -52.910645
Epoch 2099 
Overall Loss: -22.930632
Rec Loss: -42.007748
KL Loss: 19.077116
Y Loss: 0.134681
T Loss: 10.866560
X Loss: -52.941650
Epoch 2149 
Overall Loss: -23.217018
Rec Loss: -42.325717
KL Loss: 19.108701
Y Loss: 0.138152
T Loss: 10.865377
X Loss: -53.260171
Epoch 2199 
Overall Loss: -23.371715
Rec Loss: -42.505095
KL Loss: 19.133381
Y Loss: 0.135723
T Loss: 10.861611
X Loss: -53.434568
Epoch 2249 
Overall Loss: -23.667677
Rec Loss: -42.879317
KL Loss: 19.211640
Y Loss: 0.144309
T Loss: 10.844559
X Loss: -53.796030
Epoch 2299 
Overall Loss: -23.656684
Rec Loss: -42.756523
KL Loss: 19.099840
Y Loss: 0.136351
T Loss: 10.842819
X Loss: -53.667518
Epoch 2349 
Overall Loss: -23.602551
Rec Loss: -42.890500
KL Loss: 19.287949
Y Loss: 0.134834
T Loss: 10.842264
X Loss: -53.800181
Epoch 2399 
Overall Loss: -23.363360
Rec Loss: -42.508941
KL Loss: 19.145582
Y Loss: 0.147346
T Loss: 10.852456
X Loss: -53.435071
Epoch 2449 
Overall Loss: -23.544488
Rec Loss: -42.768739
KL Loss: 19.224252
Y Loss: 0.151210
T Loss: 10.837742
X Loss: -53.682087
Epoch 2499 
Overall Loss: -23.707441
Rec Loss: -43.138461
KL Loss: 19.431020
Y Loss: 0.136792
T Loss: 10.840719
X Loss: -54.047577
Epoch 2549 
Overall Loss: -23.816301
Rec Loss: -42.933176
KL Loss: 19.116875
Y Loss: 0.156346
T Loss: 10.835663
X Loss: -53.847013
Epoch 2599 
Overall Loss: -24.161190
Rec Loss: -43.544032
KL Loss: 19.382843
Y Loss: 0.138036
T Loss: 10.826442
X Loss: -54.439492
Epoch 2649 
Overall Loss: -23.749357
Rec Loss: -43.154921
KL Loss: 19.405564
Y Loss: 0.140063
T Loss: 10.827667
X Loss: -54.052620
Epoch 2699 
Overall Loss: -24.173945
Rec Loss: -43.630341
KL Loss: 19.456397
Y Loss: 0.143371
T Loss: 10.822232
X Loss: -54.524258
Epoch 2749 
Overall Loss: -24.337493
Rec Loss: -43.644422
KL Loss: 19.306929
Y Loss: 0.139745
T Loss: 10.820104
X Loss: -54.534398
Epoch 2799 
Overall Loss: -24.487973
Rec Loss: -43.984652
KL Loss: 19.496680
Y Loss: 0.125592
T Loss: 10.814647
X Loss: -54.862096
Epoch 2849 
Overall Loss: -24.457097
Rec Loss: -43.872975
KL Loss: 19.415878
Y Loss: 0.143541
T Loss: 10.807035
X Loss: -54.751780
Epoch 2899 
Overall Loss: -24.307657
Rec Loss: -43.870307
KL Loss: 19.562650
Y Loss: 0.135872
T Loss: 10.806117
X Loss: -54.744360
Epoch 2949 
Overall Loss: -24.543667
Rec Loss: -44.140116
KL Loss: 19.596449
Y Loss: 0.134300
T Loss: 10.805426
X Loss: -55.012691
Epoch 2999 
Overall Loss: -24.532887
Rec Loss: -44.125536
KL Loss: 19.592649
Y Loss: 0.138612
T Loss: 10.803360
X Loss: -54.998202
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.346660
Epoch 99
Rec Loss: 2.322110
Epoch 149
Rec Loss: 2.312956
Epoch 199
Rec Loss: 2.307034
Epoch 249
Rec Loss: 2.298291
Epoch 299
Rec Loss: 2.303582
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.002120
Epoch 99
Rec Loss: 0.000890
Epoch 149
Rec Loss: 0.000791
Epoch 199
Rec Loss: 0.000548
Epoch 249
Rec Loss: 0.000464
Epoch 299
Rec Loss: 0.000604
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.241164
Insample Error 3.558214
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.483157
Epoch 99 
Prediction Loss: 0.149569
Epoch 149 
Prediction Loss: 0.078264
Epoch 199 
Prediction Loss: 0.046557
Epoch 249 
Prediction Loss: 0.035032
Epoch 299 
Prediction Loss: 0.025762
Epoch 349 
Prediction Loss: 0.020806
Epoch 399 
Prediction Loss: 0.017877
Epoch 449 
Prediction Loss: 0.015404
Epoch 499 
Prediction Loss: 0.014187
Epoch 549 
Prediction Loss: 0.012670
Epoch 599 
Prediction Loss: 0.011348
Epoch 649 
Prediction Loss: 0.015024
Epoch 699 
Prediction Loss: 0.009475
Epoch 749 
Prediction Loss: 0.009011
Epoch 799 
Prediction Loss: 0.008704
Epoch 849 
Prediction Loss: 0.008995
Epoch 899 
Prediction Loss: 0.007265
Epoch 949 
Prediction Loss: 0.006875
Epoch 999 
Prediction Loss: 0.008178
Epoch 1049 
Prediction Loss: 0.007973
Epoch 1099 
Prediction Loss: 0.005468
Epoch 1149 
Prediction Loss: 0.005441
Epoch 1199 
Prediction Loss: 0.004762
Epoch 1249 
Prediction Loss: 0.006517
Epoch 1299 
Prediction Loss: 0.004944
Epoch 1349 
Prediction Loss: 0.004752
Epoch 1399 
Prediction Loss: 0.004497
Epoch 1449 
Prediction Loss: 0.005406
Epoch 1499 
Prediction Loss: 0.004793
Epoch 1549 
Prediction Loss: 0.004081
Epoch 1599 
Prediction Loss: 0.003930
Epoch 1649 
Prediction Loss: 0.004705
Epoch 1699 
Prediction Loss: 0.003654
Epoch 1749 
Prediction Loss: 0.003617
Epoch 1799 
Prediction Loss: 0.003830
Epoch 1849 
Prediction Loss: 0.004285
Epoch 1899 
Prediction Loss: 0.002871
Epoch 1949 
Prediction Loss: 0.003943
Epoch 1999 
Prediction Loss: 0.004038
Epoch 2049 
Prediction Loss: 0.004058
Epoch 2099 
Prediction Loss: 0.003488
Epoch 2149 
Prediction Loss: 0.003549
Epoch 2199 
Prediction Loss: 0.002467
Epoch 2249 
Prediction Loss: 0.003061
Epoch 2299 
Prediction Loss: 0.002751
Epoch 2349 
Prediction Loss: 0.004643
Epoch 2399 
Prediction Loss: 0.002919
Epoch 2449 
Prediction Loss: 0.002547
Epoch 2499 
Prediction Loss: 0.002219
Epoch 2549 
Prediction Loss: 0.003210
Epoch 2599 
Prediction Loss: 0.002041
Epoch 2649 
Prediction Loss: 0.002227
Epoch 2699 
Prediction Loss: 0.002697
Epoch 2749 
Prediction Loss: 0.002786
Epoch 2799 
Prediction Loss: 0.001971
Epoch 2849 
Prediction Loss: 0.002203
Epoch 2899 
Prediction Loss: 0.002139
Epoch 2949 
Prediction Loss: 0.002585
Epoch 2999 
Prediction Loss: 0.002899
Epoch 3049 
Prediction Loss: 0.003240
Epoch 3099 
Prediction Loss: 0.003249
Epoch 3149 
Prediction Loss: 0.002044
Epoch 3199 
Prediction Loss: 0.002695
Epoch 3249 
Prediction Loss: 0.001889
Epoch 3299 
Prediction Loss: 0.003336
Epoch 3349 
Prediction Loss: 0.002252
Epoch 3399 
Prediction Loss: 0.001989
Epoch 3449 
Prediction Loss: 0.001858
Epoch 3499 
Prediction Loss: 0.002426
Epoch 3549 
Prediction Loss: 0.001818
Epoch 3599 
Prediction Loss: 0.001468
Epoch 3649 
Prediction Loss: 0.003176
Epoch 3699 
Prediction Loss: 0.001516
Epoch 3749 
Prediction Loss: 0.001966
Epoch 3799 
Prediction Loss: 0.001373
Epoch 3849 
Prediction Loss: 0.001673
Epoch 3899 
Prediction Loss: 0.002269
Epoch 3949 
Prediction Loss: 0.002049
Epoch 3999 
Prediction Loss: 0.002419
Epoch 4049 
Prediction Loss: 0.002941
Epoch 4099 
Prediction Loss: 0.002621
Epoch 4149 
Prediction Loss: 0.001275
Epoch 4199 
Prediction Loss: 0.001375
Epoch 4249 
Prediction Loss: 0.001889
Epoch 4299 
Prediction Loss: 0.002273
Epoch 4349 
Prediction Loss: 0.001211
Epoch 4399 
Prediction Loss: 0.002060
Epoch 4449 
Prediction Loss: 0.001596
Epoch 4499 
Prediction Loss: 0.001914
Epoch 4549 
Prediction Loss: 0.001360
Epoch 4599 
Prediction Loss: 0.001590
Epoch 4649 
Prediction Loss: 0.002004
Epoch 4699 
Prediction Loss: 0.001113
Epoch 4749 
Prediction Loss: 0.001458
Epoch 4799 
Prediction Loss: 0.001991
Epoch 4849 
Prediction Loss: 0.001231
Epoch 4899 
Prediction Loss: 0.001290
Epoch 4949 
Prediction Loss: 0.001382
Epoch 4999 
Prediction Loss: 0.001034
Epoch 5049 
Prediction Loss: 0.001394
Epoch 5099 
Prediction Loss: 0.000931
Epoch 5149 
Prediction Loss: 0.002264
Epoch 5199 
Prediction Loss: 0.001195
Epoch 5249 
Prediction Loss: 0.001032
Epoch 5299 
Prediction Loss: 0.001247
Epoch 5349 
Prediction Loss: 0.001460
Epoch 5399 
Prediction Loss: 0.001330
Epoch 5449 
Prediction Loss: 0.001148
Epoch 5499 
Prediction Loss: 0.001081
Epoch 5549 
Prediction Loss: 0.001357
Epoch 5599 
Prediction Loss: 0.003520
Epoch 5649 
Prediction Loss: 0.001716
Epoch 5699 
Prediction Loss: 0.001130
Epoch 5749 
Prediction Loss: 0.001382
Epoch 5799 
Prediction Loss: 0.001015
Epoch 5849 
Prediction Loss: 0.001234
Epoch 5899 
Prediction Loss: 0.001406
Epoch 5949 
Prediction Loss: 0.003183
Epoch 5999 
Prediction Loss: 0.001137
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.028233
Insample Error 0.143058
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.077843
Rec Loss: 9.844680
KL Loss: 0.233162
Y Loss: 0.576646
T Loss: 9.556357
Epoch 99 
Overall Loss: 9.821505
Rec Loss: 9.701913
KL Loss: 0.119592
Y Loss: 0.228967
T Loss: 9.587430
Epoch 149 
Overall Loss: 9.752329
Rec Loss: 9.656536
KL Loss: 0.095793
Y Loss: 0.143316
T Loss: 9.584878
Epoch 199 
Overall Loss: 9.713127
Rec Loss: 9.632677
KL Loss: 0.080450
Y Loss: 0.101124
T Loss: 9.582115
Epoch 249 
Overall Loss: 9.695854
Rec Loss: 9.617238
KL Loss: 0.078615
Y Loss: 0.078736
T Loss: 9.577871
Epoch 299 
Overall Loss: 9.690729
Rec Loss: 9.619417
KL Loss: 0.071313
Y Loss: 0.069657
T Loss: 9.584589
Epoch 349 
Overall Loss: 9.668320
Rec Loss: 9.607323
KL Loss: 0.060996
Y Loss: 0.058327
T Loss: 9.578160
Epoch 399 
Overall Loss: 9.663721
Rec Loss: 9.604768
KL Loss: 0.058953
Y Loss: 0.055036
T Loss: 9.577250
Epoch 449 
Overall Loss: 9.656285
Rec Loss: 9.596289
KL Loss: 0.059996
Y Loss: 0.054084
T Loss: 9.569247
Epoch 499 
Overall Loss: 9.641570
Rec Loss: 9.592036
KL Loss: 0.049534
Y Loss: 0.046330
T Loss: 9.568871
Epoch 549 
Overall Loss: 9.643851
Rec Loss: 9.591810
KL Loss: 0.052041
Y Loss: 0.046745
T Loss: 9.568438
Epoch 599 
Overall Loss: 9.643811
Rec Loss: 9.594045
KL Loss: 0.049766
Y Loss: 0.040555
T Loss: 9.573768
Epoch 649 
Overall Loss: 9.640280
Rec Loss: 9.590055
KL Loss: 0.050225
Y Loss: 0.041024
T Loss: 9.569543
Epoch 699 
Overall Loss: 9.624388
Rec Loss: 9.577370
KL Loss: 0.047018
Y Loss: 0.041182
T Loss: 9.556779
Epoch 749 
Overall Loss: 9.620850
Rec Loss: 9.579003
KL Loss: 0.041847
Y Loss: 0.039945
T Loss: 9.559030
Epoch 799 
Overall Loss: 9.629427
Rec Loss: 9.586704
KL Loss: 0.042723
Y Loss: 0.047920
T Loss: 9.562744
Epoch 849 
Overall Loss: 9.620102
Rec Loss: 9.570634
KL Loss: 0.049468
Y Loss: 0.033215
T Loss: 9.554026
Epoch 899 
Overall Loss: 9.609261
Rec Loss: 9.567215
KL Loss: 0.042046
Y Loss: 0.034710
T Loss: 9.549860
Epoch 949 
Overall Loss: 9.603034
Rec Loss: 9.565271
KL Loss: 0.037763
Y Loss: 0.030685
T Loss: 9.549928
Epoch 999 
Overall Loss: 9.594698
Rec Loss: 9.559211
KL Loss: 0.035487
Y Loss: 0.029373
T Loss: 9.544525
Epoch 1049 
Overall Loss: 9.594414
Rec Loss: 9.558460
KL Loss: 0.035954
Y Loss: 0.029031
T Loss: 9.543944
Epoch 1099 
Overall Loss: 9.589785
Rec Loss: 9.554733
KL Loss: 0.035052
Y Loss: 0.027559
T Loss: 9.540953
Epoch 1149 
Overall Loss: 9.601149
Rec Loss: 9.558179
KL Loss: 0.042970
Y Loss: 0.040413
T Loss: 9.537972
Epoch 1199 
Overall Loss: 9.591619
Rec Loss: 9.556206
KL Loss: 0.035412
Y Loss: 0.026850
T Loss: 9.542782
Epoch 1249 
Overall Loss: 9.579851
Rec Loss: 9.546826
KL Loss: 0.033025
Y Loss: 0.028495
T Loss: 9.532579
Epoch 1299 
Overall Loss: 9.578997
Rec Loss: 9.540166
KL Loss: 0.038831
Y Loss: 0.033383
T Loss: 9.523474
Epoch 1349 
Overall Loss: 9.574695
Rec Loss: 9.542808
KL Loss: 0.031887
Y Loss: 0.026225
T Loss: 9.529696
Epoch 1399 
Overall Loss: 9.575664
Rec Loss: 9.542694
KL Loss: 0.032970
Y Loss: 0.028851
T Loss: 9.528269
Epoch 1449 
Overall Loss: 9.572198
Rec Loss: 9.541837
KL Loss: 0.030361
Y Loss: 0.023254
T Loss: 9.530211
Epoch 1499 
Overall Loss: 9.570302
Rec Loss: 9.540021
KL Loss: 0.030281
Y Loss: 0.024379
T Loss: 9.527831
Epoch 1549 
Overall Loss: 9.565797
Rec Loss: 9.536976
KL Loss: 0.028821
Y Loss: 0.024348
T Loss: 9.524802
Epoch 1599 
Overall Loss: 9.571028
Rec Loss: 9.538825
KL Loss: 0.032204
Y Loss: 0.026607
T Loss: 9.525521
Epoch 1649 
Overall Loss: 9.557955
Rec Loss: 9.528007
KL Loss: 0.029948
Y Loss: 0.024392
T Loss: 9.515811
Epoch 1699 
Overall Loss: 9.570689
Rec Loss: 9.532516
KL Loss: 0.038173
Y Loss: 0.021498
T Loss: 9.521767
Epoch 1749 
Overall Loss: 9.554627
Rec Loss: 9.526725
KL Loss: 0.027901
Y Loss: 0.020689
T Loss: 9.516381
Epoch 1799 
Overall Loss: 9.552424
Rec Loss: 9.525578
KL Loss: 0.026846
Y Loss: 0.022979
T Loss: 9.514088
Epoch 1849 
Overall Loss: 9.554426
Rec Loss: 9.522527
KL Loss: 0.031900
Y Loss: 0.020378
T Loss: 9.512338
Epoch 1899 
Overall Loss: 9.545903
Rec Loss: 9.519589
KL Loss: 0.026314
Y Loss: 0.022215
T Loss: 9.508481
Epoch 1949 
Overall Loss: 9.557109
Rec Loss: 9.522459
KL Loss: 0.034650
Y Loss: 0.029705
T Loss: 9.507606
Epoch 1999 
Overall Loss: 9.548347
Rec Loss: 9.517447
KL Loss: 0.030900
Y Loss: 0.027064
T Loss: 9.503916
Epoch 2049 
Overall Loss: 9.550415
Rec Loss: 9.513979
KL Loss: 0.036436
Y Loss: 0.021145
T Loss: 9.503407
Epoch 2099 
Overall Loss: 9.547287
Rec Loss: 9.514087
KL Loss: 0.033199
Y Loss: 0.020129
T Loss: 9.504023
Epoch 2149 
Overall Loss: 9.534867
Rec Loss: 9.509580
KL Loss: 0.025287
Y Loss: 0.020443
T Loss: 9.499359
Epoch 2199 
Overall Loss: 9.536256
Rec Loss: 9.511209
KL Loss: 0.025047
Y Loss: 0.022324
T Loss: 9.500047
Epoch 2249 
Overall Loss: 9.535335
Rec Loss: 9.507881
KL Loss: 0.027454
Y Loss: 0.019333
T Loss: 9.498214
Epoch 2299 
Overall Loss: 9.528991
Rec Loss: 9.505199
KL Loss: 0.023792
Y Loss: 0.020286
T Loss: 9.495056
Epoch 2349 
Overall Loss: 9.540958
Rec Loss: 9.501702
KL Loss: 0.039256
Y Loss: 0.020395
T Loss: 9.491505
Epoch 2399 
Overall Loss: 9.526897
Rec Loss: 9.503956
KL Loss: 0.022941
Y Loss: 0.020155
T Loss: 9.493878
Epoch 2449 
Overall Loss: 9.525186
Rec Loss: 9.502876
KL Loss: 0.022310
Y Loss: 0.019540
T Loss: 9.493106
Epoch 2499 
Overall Loss: 9.524891
Rec Loss: 9.500471
KL Loss: 0.024419
Y Loss: 0.020853
T Loss: 9.490045
Epoch 2549 
Overall Loss: 9.522028
Rec Loss: 9.498023
KL Loss: 0.024005
Y Loss: 0.017128
T Loss: 9.489459
Epoch 2599 
Overall Loss: 9.520748
Rec Loss: 9.497127
KL Loss: 0.023621
Y Loss: 0.017608
T Loss: 9.488322
Epoch 2649 
Overall Loss: 9.522784
Rec Loss: 9.496547
KL Loss: 0.026238
Y Loss: 0.017530
T Loss: 9.487782
Epoch 2699 
Overall Loss: 9.526846
Rec Loss: 9.496706
KL Loss: 0.030140
Y Loss: 0.018060
T Loss: 9.487676
Epoch 2749 
Overall Loss: 9.514019
Rec Loss: 9.491000
KL Loss: 0.023018
Y Loss: 0.018223
T Loss: 9.481889
Epoch 2799 
Overall Loss: 9.517245
Rec Loss: 9.494507
KL Loss: 0.022738
Y Loss: 0.019788
T Loss: 9.484613
Epoch 2849 
Overall Loss: 9.534309
Rec Loss: 9.491956
KL Loss: 0.042353
Y Loss: 0.018665
T Loss: 9.482624
Epoch 2899 
Overall Loss: 9.521683
Rec Loss: 9.494311
KL Loss: 0.027372
Y Loss: 0.021873
T Loss: 9.483374
Epoch 2949 
Overall Loss: 9.515749
Rec Loss: 9.490696
KL Loss: 0.025053
Y Loss: 0.016299
T Loss: 9.482547
Epoch 2999 
Overall Loss: 9.513310
Rec Loss: 9.487536
KL Loss: 0.025774
Y Loss: 0.016402
T Loss: 9.479336
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.019574
Epoch 99
Rec Loss: 0.015865
Epoch 149
Rec Loss: 0.015062
Epoch 199
Rec Loss: 0.014140
Epoch 249
Rec Loss: 0.013928
Epoch 299
Rec Loss: 0.013481
Epoch 349
Rec Loss: 0.013277
Epoch 399
Rec Loss: 0.012838
Epoch 449
Rec Loss: 0.012875
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.181311
Epoch 99
Rec Loss: 10.178577
Epoch 149
Rec Loss: 10.147482
Epoch 199
Rec Loss: 10.114361
Epoch 249
Rec Loss: 10.097445
Epoch 299
Rec Loss: 10.079817
Epoch 349
Rec Loss: 10.056548
Epoch 399
Rec Loss: 10.050201
Epoch 449
Rec Loss: 10.052301
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.073249
Insample Error: 0.223010
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 18.033152
Rec Loss: 14.387171
KL Loss: 3.645981
Y Loss: 6.567822
T Loss: 13.523457
X Loss: -2.420198
Epoch 99 
Overall Loss: 1.418450
Rec Loss: -8.743417
KL Loss: 10.161867
Y Loss: 2.505415
T Loss: 13.207264
X Loss: -23.203388
Epoch 149 
Overall Loss: -3.674844
Rec Loss: -14.894446
KL Loss: 11.219602
Y Loss: 1.880709
T Loss: 13.180972
X Loss: -29.015772
Epoch 199 
Overall Loss: -6.954997
Rec Loss: -19.005881
KL Loss: 12.050884
Y Loss: 1.137315
T Loss: 13.149752
X Loss: -32.724292
Epoch 249 
Overall Loss: -9.330257
Rec Loss: -21.934095
KL Loss: 12.603837
Y Loss: 0.633182
T Loss: 13.112254
X Loss: -35.362938
Epoch 299 
Overall Loss: -10.887152
Rec Loss: -24.156990
KL Loss: 13.269838
Y Loss: 0.451349
T Loss: 13.040487
X Loss: -37.423153
Epoch 349 
Overall Loss: -12.133486
Rec Loss: -25.709158
KL Loss: 13.575672
Y Loss: 0.415506
T Loss: 12.966608
X Loss: -38.883519
Epoch 399 
Overall Loss: -12.964514
Rec Loss: -26.851001
KL Loss: 13.886488
Y Loss: 0.392678
T Loss: 12.851727
X Loss: -39.899069
Epoch 449 
Overall Loss: -13.915076
Rec Loss: -28.084711
KL Loss: 14.169635
Y Loss: 0.370702
T Loss: 12.649934
X Loss: -40.919997
Epoch 499 
Overall Loss: -14.680300
Rec Loss: -29.111200
KL Loss: 14.430900
Y Loss: 0.377043
T Loss: 12.430030
X Loss: -41.729752
Epoch 549 
Overall Loss: -15.567942
Rec Loss: -30.297124
KL Loss: 14.729181
Y Loss: 0.354573
T Loss: 12.207643
X Loss: -42.682052
Epoch 599 
Overall Loss: -16.214254
Rec Loss: -31.080299
KL Loss: 14.866045
Y Loss: 0.366464
T Loss: 12.039040
X Loss: -43.302571
Epoch 649 
Overall Loss: -16.758439
Rec Loss: -31.630601
KL Loss: 14.872161
Y Loss: 0.373145
T Loss: 11.952228
X Loss: -43.769402
Epoch 699 
Overall Loss: -17.362301
Rec Loss: -32.430519
KL Loss: 15.068217
Y Loss: 0.366870
T Loss: 11.816653
X Loss: -44.430606
Epoch 749 
Overall Loss: -17.992244
Rec Loss: -33.139495
KL Loss: 15.147250
Y Loss: 0.383330
T Loss: 11.741323
X Loss: -45.072482
Epoch 799 
Overall Loss: -18.305062
Rec Loss: -33.412997
KL Loss: 15.107935
Y Loss: 0.409071
T Loss: 11.684531
X Loss: -45.302064
Epoch 849 
Overall Loss: -19.032400
Rec Loss: -34.322696
KL Loss: 15.290296
Y Loss: 0.408113
T Loss: 11.600475
X Loss: -46.127227
Epoch 899 
Overall Loss: -19.304846
Rec Loss: -34.524457
KL Loss: 15.219611
Y Loss: 0.441310
T Loss: 11.548329
X Loss: -46.293442
Epoch 949 
Overall Loss: -19.693980
Rec Loss: -35.040529
KL Loss: 15.346549
Y Loss: 0.445338
T Loss: 11.482530
X Loss: -46.745728
Epoch 999 
Overall Loss: -19.797573
Rec Loss: -35.202085
KL Loss: 15.404513
Y Loss: 0.438785
T Loss: 11.428023
X Loss: -46.849502
Epoch 1049 
Overall Loss: -20.734058
Rec Loss: -36.187284
KL Loss: 15.453225
Y Loss: 0.467052
T Loss: 11.394733
X Loss: -47.815542
Epoch 1099 
Overall Loss: -21.037349
Rec Loss: -36.444071
KL Loss: 15.406723
Y Loss: 0.470536
T Loss: 11.351021
X Loss: -48.030361
Epoch 1149 
Overall Loss: -21.245330
Rec Loss: -36.780084
KL Loss: 15.534754
Y Loss: 0.453313
T Loss: 11.315785
X Loss: -48.322527
Epoch 1199 
Overall Loss: -21.754685
Rec Loss: -37.339618
KL Loss: 15.584933
Y Loss: 0.472252
T Loss: 11.282280
X Loss: -48.858024
Epoch 1249 
Overall Loss: -21.881782
Rec Loss: -37.480953
KL Loss: 15.599171
Y Loss: 0.466027
T Loss: 11.254309
X Loss: -48.968275
Epoch 1299 
Overall Loss: -22.049456
Rec Loss: -37.756584
KL Loss: 15.707128
Y Loss: 0.469525
T Loss: 11.224160
X Loss: -49.215506
Epoch 1349 
Overall Loss: -22.301799
Rec Loss: -37.927746
KL Loss: 15.625946
Y Loss: 0.470716
T Loss: 11.215779
X Loss: -49.378883
Epoch 1399 
Overall Loss: -21.755541
Rec Loss: -37.493205
KL Loss: 15.737664
Y Loss: 0.481155
T Loss: 11.181006
X Loss: -48.914788
Epoch 1449 
Overall Loss: -23.045995
Rec Loss: -38.826891
KL Loss: 15.780896
Y Loss: 0.453406
T Loss: 11.160848
X Loss: -50.214441
Epoch 1499 
Overall Loss: -22.839795
Rec Loss: -38.641866
KL Loss: 15.802072
Y Loss: 0.452863
T Loss: 11.151375
X Loss: -50.019673
Epoch 1549 
Overall Loss: -23.336167
Rec Loss: -39.141061
KL Loss: 15.804894
Y Loss: 0.451506
T Loss: 11.143956
X Loss: -50.510770
Epoch 1599 
Overall Loss: -22.990784
Rec Loss: -38.860177
KL Loss: 15.869392
Y Loss: 0.437476
T Loss: 11.120901
X Loss: -50.199816
Epoch 1649 
Overall Loss: -23.539812
Rec Loss: -39.398419
KL Loss: 15.858607
Y Loss: 0.446678
T Loss: 11.109120
X Loss: -50.730878
Epoch 1699 
Overall Loss: -24.020407
Rec Loss: -39.889191
KL Loss: 15.868784
Y Loss: 0.453770
T Loss: 11.112530
X Loss: -51.228605
Epoch 1749 
Overall Loss: -24.038067
Rec Loss: -39.927589
KL Loss: 15.889522
Y Loss: 0.448689
T Loss: 11.087388
X Loss: -51.239321
Epoch 1799 
Overall Loss: -23.855867
Rec Loss: -39.896858
KL Loss: 16.040990
Y Loss: 0.420938
T Loss: 11.075321
X Loss: -51.182648
Epoch 1849 
Overall Loss: -23.530701
Rec Loss: -39.602907
KL Loss: 16.072206
Y Loss: 0.416195
T Loss: 11.071864
X Loss: -50.882868
Epoch 1899 
Overall Loss: -23.633736
Rec Loss: -39.703162
KL Loss: 16.069426
Y Loss: 0.405523
T Loss: 11.059964
X Loss: -50.965888
Epoch 1949 
Overall Loss: -24.846520
Rec Loss: -40.928484
KL Loss: 16.081963
Y Loss: 0.418493
T Loss: 11.043047
X Loss: -52.180776
Epoch 1999 
Overall Loss: -24.699090
Rec Loss: -40.782517
KL Loss: 16.083427
Y Loss: 0.410755
T Loss: 11.032941
X Loss: -52.020834
Epoch 2049 
Overall Loss: -24.835095
Rec Loss: -40.854748
KL Loss: 16.019653
Y Loss: 0.418716
T Loss: 11.049599
X Loss: -52.113705
Epoch 2099 
Overall Loss: -24.261953
Rec Loss: -40.340886
KL Loss: 16.078933
Y Loss: 0.388273
T Loss: 11.031859
X Loss: -51.566881
Epoch 2149 
Overall Loss: -24.814337
Rec Loss: -40.898239
KL Loss: 16.083901
Y Loss: 0.382971
T Loss: 11.021224
X Loss: -52.110947
Epoch 2199 
Overall Loss: -25.530975
Rec Loss: -41.593045
KL Loss: 16.062070
Y Loss: 0.377999
T Loss: 11.031359
X Loss: -52.813404
Epoch 2249 
Overall Loss: -25.712623
Rec Loss: -41.814387
KL Loss: 16.101765
Y Loss: 0.373932
T Loss: 11.026222
X Loss: -53.027575
Epoch 2299 
Overall Loss: -25.504268
Rec Loss: -41.693678
KL Loss: 16.189410
Y Loss: 0.357701
T Loss: 11.002346
X Loss: -52.874875
Epoch 2349 
Overall Loss: -25.545994
Rec Loss: -41.488116
KL Loss: 15.942122
Y Loss: 0.369506
T Loss: 11.022257
X Loss: -52.695126
Epoch 2399 
Overall Loss: -25.458757
Rec Loss: -41.713699
KL Loss: 16.254943
Y Loss: 0.346378
T Loss: 10.985542
X Loss: -52.872429
Epoch 2449 
Overall Loss: -25.348641
Rec Loss: -41.468811
KL Loss: 16.120171
Y Loss: 0.338349
T Loss: 10.994688
X Loss: -52.632674
Epoch 2499 
Overall Loss: -26.238981
Rec Loss: -42.512681
KL Loss: 16.273701
Y Loss: 0.325933
T Loss: 10.990717
X Loss: -53.666365
Epoch 2549 
Overall Loss: -25.685548
Rec Loss: -42.017688
KL Loss: 16.332141
Y Loss: 0.330112
T Loss: 10.963689
X Loss: -53.146434
Epoch 2599 
Overall Loss: -25.994398
Rec Loss: -42.409286
KL Loss: 16.414888
Y Loss: 0.307779
T Loss: 10.946773
X Loss: -53.509948
Epoch 2649 
Overall Loss: -26.168922
Rec Loss: -42.348982
KL Loss: 16.180059
Y Loss: 0.322385
T Loss: 10.986129
X Loss: -53.496302
Epoch 2699 
Overall Loss: -25.876603
Rec Loss: -42.313588
KL Loss: 16.436986
Y Loss: 0.317926
T Loss: 10.955924
X Loss: -53.428475
Epoch 2749 
Overall Loss: -26.473464
Rec Loss: -42.803626
KL Loss: 16.330163
Y Loss: 0.304248
T Loss: 10.942450
X Loss: -53.898198
Epoch 2799 
Overall Loss: -26.214442
Rec Loss: -42.631834
KL Loss: 16.417393
Y Loss: 0.299012
T Loss: 10.931643
X Loss: -53.712985
Epoch 2849 
Overall Loss: -26.647417
Rec Loss: -43.024397
KL Loss: 16.376979
Y Loss: 0.285133
T Loss: 10.921099
X Loss: -54.088063
Epoch 2899 
Overall Loss: -27.119802
Rec Loss: -43.579128
KL Loss: 16.459326
Y Loss: 0.293179
T Loss: 10.912063
X Loss: -54.637781
Epoch 2949 
Overall Loss: -26.867183
Rec Loss: -43.253214
KL Loss: 16.386032
Y Loss: 0.285553
T Loss: 10.913105
X Loss: -54.309095
Epoch 2999 
Overall Loss: -27.184890
Rec Loss: -43.478803
KL Loss: 16.293913
Y Loss: 0.288503
T Loss: 10.901136
X Loss: -54.524191
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.262130
Epoch 99
Rec Loss: 2.230149
Epoch 149
Rec Loss: 2.215222
Epoch 199
Rec Loss: 2.218763
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.004966
Epoch 99
Rec Loss: 0.002554
Epoch 149
Rec Loss: 0.001939
Epoch 199
Rec Loss: 0.001581
Epoch 249
Rec Loss: 0.001133
Epoch 299
Rec Loss: 0.001752
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.322294
Insample Error 3.378227
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.374219
Epoch 99 
Prediction Loss: 0.146659
Epoch 149 
Prediction Loss: 0.098589
Epoch 199 
Prediction Loss: 0.066864
Epoch 249 
Prediction Loss: 0.044819
Epoch 299 
Prediction Loss: 0.033692
Epoch 349 
Prediction Loss: 0.026944
Epoch 399 
Prediction Loss: 0.026081
Epoch 449 
Prediction Loss: 0.020341
Epoch 499 
Prediction Loss: 0.019608
Epoch 549 
Prediction Loss: 0.016575
Epoch 599 
Prediction Loss: 0.015299
Epoch 649 
Prediction Loss: 0.016833
Epoch 699 
Prediction Loss: 0.013388
Epoch 749 
Prediction Loss: 0.014182
Epoch 799 
Prediction Loss: 0.011925
Epoch 849 
Prediction Loss: 0.010705
Epoch 899 
Prediction Loss: 0.013958
Epoch 949 
Prediction Loss: 0.009551
Epoch 999 
Prediction Loss: 0.009981
Epoch 1049 
Prediction Loss: 0.009274
Epoch 1099 
Prediction Loss: 0.009311
Epoch 1149 
Prediction Loss: 0.010206
Epoch 1199 
Prediction Loss: 0.009621
Epoch 1249 
Prediction Loss: 0.010159
Epoch 1299 
Prediction Loss: 0.007618
Epoch 1349 
Prediction Loss: 0.008958
Epoch 1399 
Prediction Loss: 0.008494
Epoch 1449 
Prediction Loss: 0.007718
Epoch 1499 
Prediction Loss: 0.007879
Epoch 1549 
Prediction Loss: 0.007172
Epoch 1599 
Prediction Loss: 0.008124
Epoch 1649 
Prediction Loss: 0.006358
Epoch 1699 
Prediction Loss: 0.007808
Epoch 1749 
Prediction Loss: 0.006717
Epoch 1799 
Prediction Loss: 0.007059
Epoch 1849 
Prediction Loss: 0.006453
Epoch 1899 
Prediction Loss: 0.005901
Epoch 1949 
Prediction Loss: 0.005893
Epoch 1999 
Prediction Loss: 0.005669
Epoch 2049 
Prediction Loss: 0.007372
Epoch 2099 
Prediction Loss: 0.007897
Epoch 2149 
Prediction Loss: 0.007066
Epoch 2199 
Prediction Loss: 0.007656
Epoch 2249 
Prediction Loss: 0.007872
Epoch 2299 
Prediction Loss: 0.006511
Epoch 2349 
Prediction Loss: 0.006817
Epoch 2399 
Prediction Loss: 0.005188
Epoch 2449 
Prediction Loss: 0.009520
Epoch 2499 
Prediction Loss: 0.006763
Epoch 2549 
Prediction Loss: 0.004944
Epoch 2599 
Prediction Loss: 0.005149
Epoch 2649 
Prediction Loss: 0.007429
Epoch 2699 
Prediction Loss: 0.004639
Epoch 2749 
Prediction Loss: 0.006220
Epoch 2799 
Prediction Loss: 0.005095
Epoch 2849 
Prediction Loss: 0.006511
Epoch 2899 
Prediction Loss: 0.006543
Epoch 2949 
Prediction Loss: 0.004711
Epoch 2999 
Prediction Loss: 0.006279
Epoch 3049 
Prediction Loss: 0.009875
Epoch 3099 
Prediction Loss: 0.004523
Epoch 3149 
Prediction Loss: 0.005045
Epoch 3199 
Prediction Loss: 0.005047
Epoch 3249 
Prediction Loss: 0.004807
Epoch 3299 
Prediction Loss: 0.004809
Epoch 3349 
Prediction Loss: 0.006732
Epoch 3399 
Prediction Loss: 0.004155
Epoch 3449 
Prediction Loss: 0.003998
Epoch 3499 
Prediction Loss: 0.003976
Epoch 3549 
Prediction Loss: 0.004355
Epoch 3599 
Prediction Loss: 0.004315
Epoch 3649 
Prediction Loss: 0.005085
Epoch 3699 
Prediction Loss: 0.003854
Epoch 3749 
Prediction Loss: 0.004776
Epoch 3799 
Prediction Loss: 0.003895
Epoch 3849 
Prediction Loss: 0.006988
Epoch 3899 
Prediction Loss: 0.005369
Epoch 3949 
Prediction Loss: 0.003587
Epoch 3999 
Prediction Loss: 0.006384
Epoch 4049 
Prediction Loss: 0.004135
Epoch 4099 
Prediction Loss: 0.005223
Epoch 4149 
Prediction Loss: 0.006192
Epoch 4199 
Prediction Loss: 0.006111
Epoch 4249 
Prediction Loss: 0.003860
Epoch 4299 
Prediction Loss: 0.005780
Epoch 4349 
Prediction Loss: 0.003980
Epoch 4399 
Prediction Loss: 0.004168
Epoch 4449 
Prediction Loss: 0.006546
Epoch 4499 
Prediction Loss: 0.004635
Epoch 4549 
Prediction Loss: 0.004146
Epoch 4599 
Prediction Loss: 0.006970
Epoch 4649 
Prediction Loss: 0.003779
Epoch 4699 
Prediction Loss: 0.003852
Epoch 4749 
Prediction Loss: 0.003284
Epoch 4799 
Prediction Loss: 0.004422
Epoch 4849 
Prediction Loss: 0.003512
Epoch 4899 
Prediction Loss: 0.004119
Epoch 4949 
Prediction Loss: 0.011180
Epoch 4999 
Prediction Loss: 0.003692
Epoch 5049 
Prediction Loss: 0.005551
Epoch 5099 
Prediction Loss: 0.007404
Epoch 5149 
Prediction Loss: 0.004201
Epoch 5199 
Prediction Loss: 0.004510
Epoch 5249 
Prediction Loss: 0.004622
Epoch 5299 
Prediction Loss: 0.003337
Epoch 5349 
Prediction Loss: 0.004260
Epoch 5399 
Prediction Loss: 0.006336
Epoch 5449 
Prediction Loss: 0.004180
Epoch 5499 
Prediction Loss: 0.004808
Epoch 5549 
Prediction Loss: 0.006135
Epoch 5599 
Prediction Loss: 0.004578
Epoch 5649 
Prediction Loss: 0.003630
Epoch 5699 
Prediction Loss: 0.005618
Epoch 5749 
Prediction Loss: 0.002972
Epoch 5799 
Prediction Loss: 0.004382
Epoch 5849 
Prediction Loss: 0.003708
Epoch 5899 
Prediction Loss: 0.003692
Epoch 5949 
Prediction Loss: 0.003289
Epoch 5999 
Prediction Loss: 0.005204
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.075060
Insample Error 0.246019
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.089903
Rec Loss: 9.843195
KL Loss: 0.246708
Y Loss: 0.590883
T Loss: 9.547754
Epoch 99 
Overall Loss: 9.839183
Rec Loss: 9.705649
KL Loss: 0.133535
Y Loss: 0.265232
T Loss: 9.573032
Epoch 149 
Overall Loss: 9.759571
Rec Loss: 9.654313
KL Loss: 0.105257
Y Loss: 0.146258
T Loss: 9.581185
Epoch 199 
Overall Loss: 9.725113
Rec Loss: 9.634174
KL Loss: 0.090939
Y Loss: 0.103829
T Loss: 9.582260
Epoch 249 
Overall Loss: 9.695113
Rec Loss: 9.619177
KL Loss: 0.075936
Y Loss: 0.077341
T Loss: 9.580507
Epoch 299 
Overall Loss: 9.682116
Rec Loss: 9.611071
KL Loss: 0.071045
Y Loss: 0.071536
T Loss: 9.575303
Epoch 349 
Overall Loss: 9.679347
Rec Loss: 9.611381
KL Loss: 0.067966
Y Loss: 0.061350
T Loss: 9.580706
Epoch 399 
Overall Loss: 9.665413
Rec Loss: 9.600648
KL Loss: 0.064765
Y Loss: 0.054748
T Loss: 9.573274
Epoch 449 
Overall Loss: 9.656565
Rec Loss: 9.596426
KL Loss: 0.060139
Y Loss: 0.052798
T Loss: 9.570027
Epoch 499 
Overall Loss: 9.679582
Rec Loss: 9.607150
KL Loss: 0.072432
Y Loss: 0.088672
T Loss: 9.562814
Epoch 549 
Overall Loss: 9.642472
Rec Loss: 9.590773
KL Loss: 0.051699
Y Loss: 0.043197
T Loss: 9.569175
Epoch 599 
Overall Loss: 9.635406
Rec Loss: 9.587856
KL Loss: 0.047549
Y Loss: 0.043475
T Loss: 9.566119
Epoch 649 
Overall Loss: 9.638371
Rec Loss: 9.587040
KL Loss: 0.051331
Y Loss: 0.039894
T Loss: 9.567093
Epoch 699 
Overall Loss: 9.631477
Rec Loss: 9.582965
KL Loss: 0.048512
Y Loss: 0.042018
T Loss: 9.561956
Epoch 749 
Overall Loss: 9.625542
Rec Loss: 9.577105
KL Loss: 0.048437
Y Loss: 0.038770
T Loss: 9.557720
Epoch 799 
Overall Loss: 9.614582
Rec Loss: 9.572908
KL Loss: 0.041674
Y Loss: 0.036984
T Loss: 9.554416
Epoch 849 
Overall Loss: 9.621470
Rec Loss: 9.578226
KL Loss: 0.043244
Y Loss: 0.039767
T Loss: 9.558342
Epoch 899 
Overall Loss: 9.624544
Rec Loss: 9.572692
KL Loss: 0.051853
Y Loss: 0.035256
T Loss: 9.555064
Epoch 949 
Overall Loss: 9.609614
Rec Loss: 9.564935
KL Loss: 0.044679
Y Loss: 0.037141
T Loss: 9.546365
Epoch 999 
Overall Loss: 9.599382
Rec Loss: 9.561164
KL Loss: 0.038217
Y Loss: 0.031065
T Loss: 9.545632
Epoch 1049 
Overall Loss: 9.603983
Rec Loss: 9.564082
KL Loss: 0.039901
Y Loss: 0.031249
T Loss: 9.548457
Epoch 1099 
Overall Loss: 9.624642
Rec Loss: 9.573332
KL Loss: 0.051310
Y Loss: 0.048821
T Loss: 9.548922
Epoch 1149 
Overall Loss: 9.590801
Rec Loss: 9.553548
KL Loss: 0.037252
Y Loss: 0.032825
T Loss: 9.537136
Epoch 1199 
Overall Loss: 9.584448
Rec Loss: 9.548277
KL Loss: 0.036171
Y Loss: 0.029571
T Loss: 9.533491
Epoch 1249 
Overall Loss: 9.587346
Rec Loss: 9.550093
KL Loss: 0.037253
Y Loss: 0.027106
T Loss: 9.536540
Epoch 1299 
Overall Loss: 9.583721
Rec Loss: 9.546924
KL Loss: 0.036797
Y Loss: 0.027966
T Loss: 9.532941
Epoch 1349 
Overall Loss: 9.580396
Rec Loss: 9.541396
KL Loss: 0.039000
Y Loss: 0.026199
T Loss: 9.528297
Epoch 1399 
Overall Loss: 9.576197
Rec Loss: 9.544039
KL Loss: 0.032158
Y Loss: 0.026604
T Loss: 9.530737
Epoch 1449 
Overall Loss: 9.575549
Rec Loss: 9.542143
KL Loss: 0.033406
Y Loss: 0.028435
T Loss: 9.527926
Epoch 1499 
Overall Loss: 9.566796
Rec Loss: 9.534992
KL Loss: 0.031804
Y Loss: 0.028160
T Loss: 9.520911
Epoch 1549 
Overall Loss: 9.570832
Rec Loss: 9.537457
KL Loss: 0.033375
Y Loss: 0.024880
T Loss: 9.525018
Epoch 1599 
Overall Loss: 9.574545
Rec Loss: 9.535477
KL Loss: 0.039067
Y Loss: 0.023197
T Loss: 9.523880
Epoch 1649 
Overall Loss: 9.568640
Rec Loss: 9.536556
KL Loss: 0.032083
Y Loss: 0.027060
T Loss: 9.523026
Epoch 1699 
Overall Loss: 9.562167
Rec Loss: 9.533693
KL Loss: 0.028473
Y Loss: 0.023090
T Loss: 9.522148
Epoch 1749 
Overall Loss: 9.553418
Rec Loss: 9.524304
KL Loss: 0.029114
Y Loss: 0.023933
T Loss: 9.512338
Epoch 1799 
Overall Loss: 9.554290
Rec Loss: 9.525804
KL Loss: 0.028487
Y Loss: 0.024772
T Loss: 9.513417
Epoch 1849 
Overall Loss: 9.553258
Rec Loss: 9.524524
KL Loss: 0.028734
Y Loss: 0.022887
T Loss: 9.513081
Epoch 1899 
Overall Loss: 9.556067
Rec Loss: 9.526094
KL Loss: 0.029973
Y Loss: 0.021653
T Loss: 9.515268
Epoch 1949 
Overall Loss: 9.551716
Rec Loss: 9.523519
KL Loss: 0.028197
Y Loss: 0.021544
T Loss: 9.512746
Epoch 1999 
Overall Loss: 9.547176
Rec Loss: 9.518821
KL Loss: 0.028355
Y Loss: 0.023797
T Loss: 9.506923
Epoch 2049 
Overall Loss: 9.552738
Rec Loss: 9.522519
KL Loss: 0.030219
Y Loss: 0.022023
T Loss: 9.511507
Epoch 2099 
Overall Loss: 9.595172
Rec Loss: 9.524136
KL Loss: 0.071037
Y Loss: 0.030734
T Loss: 9.508768
Epoch 2149 
Overall Loss: 9.549463
Rec Loss: 9.514537
KL Loss: 0.034926
Y Loss: 0.022012
T Loss: 9.503531
Epoch 2199 
Overall Loss: 9.561019
Rec Loss: 9.516385
KL Loss: 0.044634
Y Loss: 0.023037
T Loss: 9.504866
Epoch 2249 
Overall Loss: 9.540564
Rec Loss: 9.510962
KL Loss: 0.029602
Y Loss: 0.025479
T Loss: 9.498223
Epoch 2299 
Overall Loss: 9.536558
Rec Loss: 9.509509
KL Loss: 0.027049
Y Loss: 0.019904
T Loss: 9.499557
Epoch 2349 
Overall Loss: 9.535390
Rec Loss: 9.509228
KL Loss: 0.026161
Y Loss: 0.019137
T Loss: 9.499659
Epoch 2399 
Overall Loss: 9.538958
Rec Loss: 9.513034
KL Loss: 0.025924
Y Loss: 0.023609
T Loss: 9.501230
Epoch 2449 
Overall Loss: 9.532426
Rec Loss: 9.508625
KL Loss: 0.023801
Y Loss: 0.021465
T Loss: 9.497892
Epoch 2499 
Overall Loss: 9.533214
Rec Loss: 9.504977
KL Loss: 0.028237
Y Loss: 0.018487
T Loss: 9.495734
Epoch 2549 
Overall Loss: 9.546455
Rec Loss: 9.514374
KL Loss: 0.032081
Y Loss: 0.033657
T Loss: 9.497546
Epoch 2599 
Overall Loss: 9.530890
Rec Loss: 9.503061
KL Loss: 0.027829
Y Loss: 0.023159
T Loss: 9.491481
Epoch 2649 
Overall Loss: 9.524809
Rec Loss: 9.501632
KL Loss: 0.023176
Y Loss: 0.018432
T Loss: 9.492416
Epoch 2699 
Overall Loss: 9.525306
Rec Loss: 9.502877
KL Loss: 0.022429
Y Loss: 0.018780
T Loss: 9.493487
Epoch 2749 
Overall Loss: 9.529070
Rec Loss: 9.497103
KL Loss: 0.031967
Y Loss: 0.019452
T Loss: 9.487376
Epoch 2799 
Overall Loss: 9.525044
Rec Loss: 9.495991
KL Loss: 0.029053
Y Loss: 0.018872
T Loss: 9.486556
Epoch 2849 
Overall Loss: 9.524627
Rec Loss: 9.496086
KL Loss: 0.028541
Y Loss: 0.018098
T Loss: 9.487038
Epoch 2899 
Overall Loss: 9.524299
Rec Loss: 9.496842
KL Loss: 0.027457
Y Loss: 0.017296
T Loss: 9.488194
Epoch 2949 
Overall Loss: 9.516600
Rec Loss: 9.493031
KL Loss: 0.023569
Y Loss: 0.023137
T Loss: 9.481462
Epoch 2999 
Overall Loss: 9.551629
Rec Loss: 9.494598
KL Loss: 0.057031
Y Loss: 0.019252
T Loss: 9.484972
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.020617
Epoch 99
Rec Loss: 0.016364
Epoch 149
Rec Loss: 0.015389
Epoch 199
Rec Loss: 0.014508
Epoch 249
Rec Loss: 0.014166
Epoch 299
Rec Loss: 0.013575
Epoch 349
Rec Loss: 0.013578
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.196444
Epoch 99
Rec Loss: 10.199333
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.086327
Insample Error: 0.237272
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 17.393349
Rec Loss: 13.254691
KL Loss: 4.138658
Y Loss: 7.649106
T Loss: 13.499434
X Loss: -4.069296
Epoch 99 
Overall Loss: 1.780134
Rec Loss: -8.112778
KL Loss: 9.892911
Y Loss: 2.690928
T Loss: 13.189845
X Loss: -22.648086
Epoch 149 
Overall Loss: -3.263962
Rec Loss: -14.379349
KL Loss: 11.115387
Y Loss: 2.146277
T Loss: 12.891527
X Loss: -28.344014
Epoch 199 
Overall Loss: -6.893287
Rec Loss: -19.367166
KL Loss: 12.473878
Y Loss: 1.509805
T Loss: 12.508177
X Loss: -32.630245
Epoch 249 
Overall Loss: -9.523839
Rec Loss: -23.072406
KL Loss: 13.548569
Y Loss: 1.029216
T Loss: 12.171725
X Loss: -35.758741
Epoch 299 
Overall Loss: -11.134941
Rec Loss: -25.286592
KL Loss: 14.151651
Y Loss: 0.897151
T Loss: 11.982936
X Loss: -37.718103
Epoch 349 
Overall Loss: -12.430779
Rec Loss: -27.047016
KL Loss: 14.616237
Y Loss: 0.815484
T Loss: 11.877367
X Loss: -39.332123
Epoch 399 
Overall Loss: -13.517620
Rec Loss: -28.447074
KL Loss: 14.929454
Y Loss: 0.777138
T Loss: 11.793892
X Loss: -40.629535
Epoch 449 
Overall Loss: -14.212451
Rec Loss: -29.300632
KL Loss: 15.088181
Y Loss: 0.765573
T Loss: 11.737758
X Loss: -41.421177
Epoch 499 
Overall Loss: -15.046738
Rec Loss: -30.328066
KL Loss: 15.281328
Y Loss: 0.742352
T Loss: 11.693395
X Loss: -42.392637
Epoch 549 
Overall Loss: -15.598421
Rec Loss: -31.008073
KL Loss: 15.409652
Y Loss: 0.719898
T Loss: 11.636486
X Loss: -43.004509
Epoch 599 
Overall Loss: -16.091597
Rec Loss: -31.594037
KL Loss: 15.502440
Y Loss: 0.729100
T Loss: 11.598593
X Loss: -43.557181
Epoch 649 
Overall Loss: -16.783535
Rec Loss: -32.418482
KL Loss: 15.634949
Y Loss: 0.708279
T Loss: 11.553167
X Loss: -44.325790
Epoch 699 
Overall Loss: -16.908995
Rec Loss: -32.646318
KL Loss: 15.737324
Y Loss: 0.675445
T Loss: 11.512738
X Loss: -44.496779
Epoch 749 
Overall Loss: -17.667272
Rec Loss: -33.509882
KL Loss: 15.842610
Y Loss: 0.677590
T Loss: 11.464907
X Loss: -45.313584
Epoch 799 
Overall Loss: -17.996527
Rec Loss: -33.909560
KL Loss: 15.913034
Y Loss: 0.693678
T Loss: 11.416437
X Loss: -45.672837
Epoch 849 
Overall Loss: -18.461291
Rec Loss: -34.425118
KL Loss: 15.963827
Y Loss: 0.683692
T Loss: 11.392561
X Loss: -46.159526
Epoch 899 
Overall Loss: -18.723414
Rec Loss: -34.833002
KL Loss: 16.109588
Y Loss: 0.689936
T Loss: 11.333978
X Loss: -46.511949
Epoch 949 
Overall Loss: -19.304419
Rec Loss: -35.442392
KL Loss: 16.137974
Y Loss: 0.662191
T Loss: 11.303640
X Loss: -47.077128
Epoch 999 
Overall Loss: -19.500946
Rec Loss: -35.760027
KL Loss: 16.259081
Y Loss: 0.667492
T Loss: 11.259144
X Loss: -47.352917
Epoch 1049 
Overall Loss: -19.965218
Rec Loss: -36.253923
KL Loss: 16.288705
Y Loss: 0.661507
T Loss: 11.233870
X Loss: -47.818546
Epoch 1099 
Overall Loss: -20.203136
Rec Loss: -36.614963
KL Loss: 16.411826
Y Loss: 0.660392
T Loss: 11.191515
X Loss: -48.136674
Epoch 1149 
Overall Loss: -20.508072
Rec Loss: -36.996152
KL Loss: 16.488080
Y Loss: 0.640325
T Loss: 11.160084
X Loss: -48.476399
Epoch 1199 
Overall Loss: -20.742935
Rec Loss: -37.325716
KL Loss: 16.582780
Y Loss: 0.643468
T Loss: 11.129858
X Loss: -48.777308
Epoch 1249 
Overall Loss: -20.950008
Rec Loss: -37.594447
KL Loss: 16.644439
Y Loss: 0.636826
T Loss: 11.111568
X Loss: -49.024427
Epoch 1299 
Overall Loss: -21.228305
Rec Loss: -37.994139
KL Loss: 16.765835
Y Loss: 0.619432
T Loss: 11.089267
X Loss: -49.393123
Epoch 1349 
Overall Loss: -21.306065
Rec Loss: -38.086623
KL Loss: 16.780557
Y Loss: 0.619735
T Loss: 11.089564
X Loss: -49.486053
Epoch 1399 
Overall Loss: -21.660481
Rec Loss: -38.491695
KL Loss: 16.831215
Y Loss: 0.632036
T Loss: 11.072754
X Loss: -49.880467
Epoch 1449 
Overall Loss: -21.647159
Rec Loss: -38.541021
KL Loss: 16.893862
Y Loss: 0.605548
T Loss: 11.046583
X Loss: -49.890380
Epoch 1499 
Overall Loss: -22.057526
Rec Loss: -38.999806
KL Loss: 16.942281
Y Loss: 0.603969
T Loss: 11.041116
X Loss: -50.342907
Epoch 1549 
Overall Loss: -22.227397
Rec Loss: -39.237532
KL Loss: 17.010134
Y Loss: 0.597880
T Loss: 11.033474
X Loss: -50.569946
Epoch 1599 
Overall Loss: -22.108063
Rec Loss: -39.121888
KL Loss: 17.013825
Y Loss: 0.615312
T Loss: 11.026719
X Loss: -50.456263
Epoch 1649 
Overall Loss: -22.592334
Rec Loss: -39.736063
KL Loss: 17.143729
Y Loss: 0.577865
T Loss: 11.013916
X Loss: -51.038912
Epoch 1699 
Overall Loss: -22.623369
Rec Loss: -39.797938
KL Loss: 17.174568
Y Loss: 0.572110
T Loss: 11.019484
X Loss: -51.103475
Epoch 1749 
Overall Loss: -22.897308
Rec Loss: -40.115076
KL Loss: 17.217768
Y Loss: 0.597145
T Loss: 11.001577
X Loss: -51.415224
Epoch 1799 
Overall Loss: -23.040623
Rec Loss: -40.142795
KL Loss: 17.102171
Y Loss: 0.591513
T Loss: 11.013713
X Loss: -51.452264
Epoch 1849 
Overall Loss: -23.116127
Rec Loss: -40.178235
KL Loss: 17.062110
Y Loss: 0.582303
T Loss: 11.023530
X Loss: -51.492918
Epoch 1899 
Overall Loss: -23.198380
Rec Loss: -40.359951
KL Loss: 17.161573
Y Loss: 0.586665
T Loss: 10.996756
X Loss: -51.650041
Epoch 1949 
Overall Loss: -23.315730
Rec Loss: -40.467489
KL Loss: 17.151760
Y Loss: 0.599875
T Loss: 11.003441
X Loss: -51.770868
Epoch 1999 
Overall Loss: -23.423127
Rec Loss: -40.848374
KL Loss: 17.425246
Y Loss: 0.571382
T Loss: 10.990142
X Loss: -52.124206
Epoch 2049 
Overall Loss: -23.641546
Rec Loss: -41.045448
KL Loss: 17.403903
Y Loss: 0.563919
T Loss: 10.986808
X Loss: -52.314216
Epoch 2099 
Overall Loss: -23.907818
Rec Loss: -41.227317
KL Loss: 17.319502
Y Loss: 0.572092
T Loss: 10.990706
X Loss: -52.504070
Epoch 2149 
Overall Loss: -23.584637
Rec Loss: -41.043424
KL Loss: 17.458787
Y Loss: 0.552531
T Loss: 10.975464
X Loss: -52.295154
Epoch 2199 
Overall Loss: -24.000878
Rec Loss: -41.460303
KL Loss: 17.459425
Y Loss: 0.554764
T Loss: 10.982949
X Loss: -52.720636
Epoch 2249 
Overall Loss: -23.879442
Rec Loss: -41.414088
KL Loss: 17.534647
Y Loss: 0.564027
T Loss: 10.983893
X Loss: -52.679995
Epoch 2299 
Overall Loss: -24.237269
Rec Loss: -41.802449
KL Loss: 17.565181
Y Loss: 0.538511
T Loss: 10.977706
X Loss: -53.049412
Epoch 2349 
Overall Loss: -24.291528
Rec Loss: -41.873048
KL Loss: 17.581521
Y Loss: 0.541136
T Loss: 10.989934
X Loss: -53.133550
Epoch 2399 
Overall Loss: -24.570869
Rec Loss: -42.116416
KL Loss: 17.545547
Y Loss: 0.554800
T Loss: 10.974494
X Loss: -53.368309
Epoch 2449 
Overall Loss: -24.057437
Rec Loss: -41.536771
KL Loss: 17.479334
Y Loss: 0.562488
T Loss: 10.982305
X Loss: -52.800319
Epoch 2499 
Overall Loss: -24.248492
Rec Loss: -41.900895
KL Loss: 17.652404
Y Loss: 0.534078
T Loss: 10.965883
X Loss: -53.133818
Epoch 2549 
Overall Loss: -24.578962
Rec Loss: -42.179202
KL Loss: 17.600239
Y Loss: 0.529638
T Loss: 10.974651
X Loss: -53.418672
Epoch 2599 
Overall Loss: -24.886253
Rec Loss: -42.568623
KL Loss: 17.682371
Y Loss: 0.514015
T Loss: 10.958836
X Loss: -53.784466
Epoch 2649 
Overall Loss: -24.758318
Rec Loss: -42.416593
KL Loss: 17.658275
Y Loss: 0.509349
T Loss: 10.969535
X Loss: -53.640804
Epoch 2699 
Overall Loss: -24.513855
Rec Loss: -42.144088
KL Loss: 17.630234
Y Loss: 0.506473
T Loss: 10.976359
X Loss: -53.373684
Epoch 2749 
Overall Loss: -24.960512
Rec Loss: -42.747062
KL Loss: 17.786551
Y Loss: 0.497680
T Loss: 10.965561
X Loss: -53.961463
Epoch 2799 
Overall Loss: -24.878676
Rec Loss: -42.549335
KL Loss: 17.670659
Y Loss: 0.502827
T Loss: 10.986430
X Loss: -53.787179
Epoch 2849 
Overall Loss: -24.500586
Rec Loss: -42.267636
KL Loss: 17.767051
Y Loss: 0.487326
T Loss: 10.968860
X Loss: -53.480160
Epoch 2899 
Overall Loss: -25.387444
Rec Loss: -43.310073
KL Loss: 17.922629
Y Loss: 0.472169
T Loss: 10.974672
X Loss: -54.520830
Epoch 2949 
Overall Loss: -25.504087
Rec Loss: -43.289926
KL Loss: 17.785838
Y Loss: 0.493892
T Loss: 10.960825
X Loss: -54.497698
Epoch 2999 
Overall Loss: -25.192231
Rec Loss: -43.099775
KL Loss: 17.907545
Y Loss: 0.453022
T Loss: 10.958720
X Loss: -54.285007
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.360336
Epoch 99
Rec Loss: 2.346766
Epoch 149
Rec Loss: 2.340471
Epoch 199
Rec Loss: 2.315747
Epoch 249
Rec Loss: 2.312199
Epoch 299
Rec Loss: 2.309380
Epoch 349
Rec Loss: 2.304978
Epoch 399
Rec Loss: 2.298200
Epoch 449
Rec Loss: 2.297250
Epoch 499
Rec Loss: 2.301364
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.002586
Epoch 99
Rec Loss: 0.001348
Epoch 149
Rec Loss: 0.000822
Epoch 199
Rec Loss: 0.000535
Epoch 249
Rec Loss: 0.000805
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.389741
Insample Error 2.769798
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.386696
Epoch 99 
Prediction Loss: 0.132994
Epoch 149 
Prediction Loss: 0.077152
Epoch 199 
Prediction Loss: 0.048751
Epoch 249 
Prediction Loss: 0.033566
Epoch 299 
Prediction Loss: 0.026339
Epoch 349 
Prediction Loss: 0.021875
Epoch 399 
Prediction Loss: 0.017412
Epoch 449 
Prediction Loss: 0.015234
Epoch 499 
Prediction Loss: 0.015231
Epoch 549 
Prediction Loss: 0.012419
Epoch 599 
Prediction Loss: 0.011012
Epoch 649 
Prediction Loss: 0.015009
Epoch 699 
Prediction Loss: 0.011071
Epoch 749 
Prediction Loss: 0.009211
Epoch 799 
Prediction Loss: 0.009141
Epoch 849 
Prediction Loss: 0.013069
Epoch 899 
Prediction Loss: 0.007455
Epoch 949 
Prediction Loss: 0.007836
Epoch 999 
Prediction Loss: 0.007139
Epoch 1049 
Prediction Loss: 0.006082
Epoch 1099 
Prediction Loss: 0.006583
Epoch 1149 
Prediction Loss: 0.006167
Epoch 1199 
Prediction Loss: 0.006715
Epoch 1249 
Prediction Loss: 0.005450
Epoch 1299 
Prediction Loss: 0.007275
Epoch 1349 
Prediction Loss: 0.005126
Epoch 1399 
Prediction Loss: 0.005756
Epoch 1449 
Prediction Loss: 0.005501
Epoch 1499 
Prediction Loss: 0.004888
Epoch 1549 
Prediction Loss: 0.004278
Epoch 1599 
Prediction Loss: 0.004178
Epoch 1649 
Prediction Loss: 0.005064
Epoch 1699 
Prediction Loss: 0.004146
Epoch 1749 
Prediction Loss: 0.004469
Epoch 1799 
Prediction Loss: 0.004769
Epoch 1849 
Prediction Loss: 0.004108
Epoch 1899 
Prediction Loss: 0.005414
Epoch 1949 
Prediction Loss: 0.004803
Epoch 1999 
Prediction Loss: 0.003992
Epoch 2049 
Prediction Loss: 0.004314
Epoch 2099 
Prediction Loss: 0.006874
Epoch 2149 
Prediction Loss: 0.003099
Epoch 2199 
Prediction Loss: 0.003256
Epoch 2249 
Prediction Loss: 0.004400
Epoch 2299 
Prediction Loss: 0.003157
Epoch 2349 
Prediction Loss: 0.003504
Epoch 2399 
Prediction Loss: 0.002935
Epoch 2449 
Prediction Loss: 0.003871
Epoch 2499 
Prediction Loss: 0.002662
Epoch 2549 
Prediction Loss: 0.003822
Epoch 2599 
Prediction Loss: 0.002703
Epoch 2649 
Prediction Loss: 0.002606
Epoch 2699 
Prediction Loss: 0.003108
Epoch 2749 
Prediction Loss: 0.002633
Epoch 2799 
Prediction Loss: 0.003127
Epoch 2849 
Prediction Loss: 0.002146
Epoch 2899 
Prediction Loss: 0.003039
Epoch 2949 
Prediction Loss: 0.002518
Epoch 2999 
Prediction Loss: 0.002994
Epoch 3049 
Prediction Loss: 0.003627
Epoch 3099 
Prediction Loss: 0.002756
Epoch 3149 
Prediction Loss: 0.002895
Epoch 3199 
Prediction Loss: 0.003095
Epoch 3249 
Prediction Loss: 0.006829
Epoch 3299 
Prediction Loss: 0.001981
Epoch 3349 
Prediction Loss: 0.002080
Epoch 3399 
Prediction Loss: 0.001919
Epoch 3449 
Prediction Loss: 0.001924
Epoch 3499 
Prediction Loss: 0.001887
Epoch 3549 
Prediction Loss: 0.002402
Epoch 3599 
Prediction Loss: 0.002378
Epoch 3649 
Prediction Loss: 0.001822
Epoch 3699 
Prediction Loss: 0.002277
Epoch 3749 
Prediction Loss: 0.002158
Epoch 3799 
Prediction Loss: 0.001859
Epoch 3849 
Prediction Loss: 0.003428
Epoch 3899 
Prediction Loss: 0.001855
Epoch 3949 
Prediction Loss: 0.003755
Epoch 3999 
Prediction Loss: 0.001744
Epoch 4049 
Prediction Loss: 0.002108
Epoch 4099 
Prediction Loss: 0.002936
Epoch 4149 
Prediction Loss: 0.002394
Epoch 4199 
Prediction Loss: 0.002330
Epoch 4249 
Prediction Loss: 0.002458
Epoch 4299 
Prediction Loss: 0.002164
Epoch 4349 
Prediction Loss: 0.002108
Epoch 4399 
Prediction Loss: 0.002046
Epoch 4449 
Prediction Loss: 0.001699
Epoch 4499 
Prediction Loss: 0.003018
Epoch 4549 
Prediction Loss: 0.001801
Epoch 4599 
Prediction Loss: 0.001712
Epoch 4649 
Prediction Loss: 0.001920
Epoch 4699 
Prediction Loss: 0.003063
Epoch 4749 
Prediction Loss: 0.002132
Epoch 4799 
Prediction Loss: 0.002222
Epoch 4849 
Prediction Loss: 0.001398
Epoch 4899 
Prediction Loss: 0.003681
Epoch 4949 
Prediction Loss: 0.002657
Epoch 4999 
Prediction Loss: 0.002954
Epoch 5049 
Prediction Loss: 0.001752
Epoch 5099 
Prediction Loss: 0.001711
Epoch 5149 
Prediction Loss: 0.001360
Epoch 5199 
Prediction Loss: 0.001486
Epoch 5249 
Prediction Loss: 0.001280
Epoch 5299 
Prediction Loss: 0.001235
Epoch 5349 
Prediction Loss: 0.001952
Epoch 5399 
Prediction Loss: 0.001960
Epoch 5449 
Prediction Loss: 0.002775
Epoch 5499 
Prediction Loss: 0.001240
Epoch 5549 
Prediction Loss: 0.001618
Epoch 5599 
Prediction Loss: 0.001223
Epoch 5649 
Prediction Loss: 0.001906
Epoch 5699 
Prediction Loss: 0.001412
Epoch 5749 
Prediction Loss: 0.001239
Epoch 5799 
Prediction Loss: 0.001855
Epoch 5849 
Prediction Loss: 0.002531
Epoch 5899 
Prediction Loss: 0.001929
Epoch 5949 
Prediction Loss: 0.001719
Epoch 5999 
Prediction Loss: 0.001577
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.040234
Insample Error 0.181850
[31m========== repeat time 4 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.071860
Rec Loss: 9.844931
KL Loss: 0.226929
Y Loss: 0.562287
T Loss: 9.563788
Epoch 99 
Overall Loss: 9.857054
Rec Loss: 9.730827
KL Loss: 0.126226
Y Loss: 0.286249
T Loss: 9.587703
Epoch 149 
Overall Loss: 9.764782
Rec Loss: 9.671976
KL Loss: 0.092806
Y Loss: 0.170813
T Loss: 9.586570
Epoch 199 
Overall Loss: 9.722742
Rec Loss: 9.638115
KL Loss: 0.084627
Y Loss: 0.109978
T Loss: 9.583126
Epoch 249 
Overall Loss: 9.702239
Rec Loss: 9.627752
KL Loss: 0.074486
Y Loss: 0.086604
T Loss: 9.584451
Epoch 299 
Overall Loss: 9.695622
Rec Loss: 9.620900
KL Loss: 0.074722
Y Loss: 0.074232
T Loss: 9.583784
Epoch 349 
Overall Loss: 9.679095
Rec Loss: 9.611168
KL Loss: 0.067927
Y Loss: 0.066308
T Loss: 9.578014
Epoch 399 
Overall Loss: 9.688146
Rec Loss: 9.615739
KL Loss: 0.072407
Y Loss: 0.057186
T Loss: 9.587146
Epoch 449 
Overall Loss: 9.652823
Rec Loss: 9.599134
KL Loss: 0.053689
Y Loss: 0.050610
T Loss: 9.573829
Epoch 499 
Overall Loss: 9.652832
Rec Loss: 9.597664
KL Loss: 0.055168
Y Loss: 0.047750
T Loss: 9.573789
Epoch 549 
Overall Loss: 9.645921
Rec Loss: 9.592472
KL Loss: 0.053449
Y Loss: 0.047227
T Loss: 9.568859
Epoch 599 
Overall Loss: 9.639169
Rec Loss: 9.588435
KL Loss: 0.050735
Y Loss: 0.041446
T Loss: 9.567712
Epoch 649 
Overall Loss: 9.633665
Rec Loss: 9.584849
KL Loss: 0.048816
Y Loss: 0.039274
T Loss: 9.565212
Epoch 699 
Overall Loss: 9.628971
Rec Loss: 9.577457
KL Loss: 0.051514
Y Loss: 0.037369
T Loss: 9.558773
Epoch 749 
Overall Loss: 9.618725
Rec Loss: 9.578403
KL Loss: 0.040322
Y Loss: 0.036090
T Loss: 9.560358
Epoch 799 
Overall Loss: 9.618805
Rec Loss: 9.578916
KL Loss: 0.039890
Y Loss: 0.035682
T Loss: 9.561075
Epoch 849 
Overall Loss: 9.615668
Rec Loss: 9.574148
KL Loss: 0.041520
Y Loss: 0.032631
T Loss: 9.557832
Epoch 899 
Overall Loss: 9.611074
Rec Loss: 9.572742
KL Loss: 0.038332
Y Loss: 0.030916
T Loss: 9.557284
Epoch 949 
Overall Loss: 9.611266
Rec Loss: 9.569915
KL Loss: 0.041351
Y Loss: 0.035456
T Loss: 9.552187
Epoch 999 
Overall Loss: 9.615407
Rec Loss: 9.571823
KL Loss: 0.043584
Y Loss: 0.039095
T Loss: 9.552276
Epoch 1049 
Overall Loss: 9.603028
Rec Loss: 9.564699
KL Loss: 0.038329
Y Loss: 0.027975
T Loss: 9.550711
Epoch 1099 
Overall Loss: 9.590263
Rec Loss: 9.555897
KL Loss: 0.034366
Y Loss: 0.029555
T Loss: 9.541120
Epoch 1149 
Overall Loss: 9.592323
Rec Loss: 9.556723
KL Loss: 0.035600
Y Loss: 0.029945
T Loss: 9.541751
Epoch 1199 
Overall Loss: 9.589235
Rec Loss: 9.552694
KL Loss: 0.036541
Y Loss: 0.030702
T Loss: 9.537343
Epoch 1249 
Overall Loss: 9.588682
Rec Loss: 9.549915
KL Loss: 0.038767
Y Loss: 0.027649
T Loss: 9.536090
Epoch 1299 
Overall Loss: 9.580025
Rec Loss: 9.547365
KL Loss: 0.032660
Y Loss: 0.027840
T Loss: 9.533445
Epoch 1349 
Overall Loss: 9.576570
Rec Loss: 9.542328
KL Loss: 0.034242
Y Loss: 0.026237
T Loss: 9.529209
Epoch 1399 
Overall Loss: 9.577091
Rec Loss: 9.547886
KL Loss: 0.029205
Y Loss: 0.025203
T Loss: 9.535284
Epoch 1449 
Overall Loss: 9.567651
Rec Loss: 9.534334
KL Loss: 0.033318
Y Loss: 0.024356
T Loss: 9.522156
Epoch 1499 
Overall Loss: 9.570972
Rec Loss: 9.538289
KL Loss: 0.032684
Y Loss: 0.026345
T Loss: 9.525117
Epoch 1549 
Overall Loss: 9.570765
Rec Loss: 9.538131
KL Loss: 0.032634
Y Loss: 0.027135
T Loss: 9.524563
Epoch 1599 
Overall Loss: 9.578941
Rec Loss: 9.535334
KL Loss: 0.043607
Y Loss: 0.022488
T Loss: 9.524089
Epoch 1649 
Overall Loss: 9.559978
Rec Loss: 9.531143
KL Loss: 0.028835
Y Loss: 0.022949
T Loss: 9.519669
Epoch 1699 
Overall Loss: 9.563568
Rec Loss: 9.529855
KL Loss: 0.033713
Y Loss: 0.028888
T Loss: 9.515410
Epoch 1749 
Overall Loss: 9.558256
Rec Loss: 9.529591
KL Loss: 0.028666
Y Loss: 0.023069
T Loss: 9.518056
Epoch 1799 
Overall Loss: 9.556071
Rec Loss: 9.526371
KL Loss: 0.029700
Y Loss: 0.024956
T Loss: 9.513893
Epoch 1849 
Overall Loss: 9.553293
Rec Loss: 9.526657
KL Loss: 0.026636
Y Loss: 0.024339
T Loss: 9.514487
Epoch 1899 
Overall Loss: 9.552953
Rec Loss: 9.526605
KL Loss: 0.026347
Y Loss: 0.021087
T Loss: 9.516062
Epoch 1949 
Overall Loss: 9.545587
Rec Loss: 9.518826
KL Loss: 0.026761
Y Loss: 0.020673
T Loss: 9.508490
Epoch 1999 
Overall Loss: 9.545887
Rec Loss: 9.521273
KL Loss: 0.024614
Y Loss: 0.020932
T Loss: 9.510807
Epoch 2049 
Overall Loss: 9.549316
Rec Loss: 9.521855
KL Loss: 0.027462
Y Loss: 0.019943
T Loss: 9.511883
Epoch 2099 
Overall Loss: 9.548797
Rec Loss: 9.515723
KL Loss: 0.033074
Y Loss: 0.019656
T Loss: 9.505895
Epoch 2149 
Overall Loss: 9.546213
Rec Loss: 9.514608
KL Loss: 0.031605
Y Loss: 0.020390
T Loss: 9.504413
Epoch 2199 
Overall Loss: 9.539336
Rec Loss: 9.514312
KL Loss: 0.025024
Y Loss: 0.021845
T Loss: 9.503390
Epoch 2249 
Overall Loss: 9.540819
Rec Loss: 9.514287
KL Loss: 0.026531
Y Loss: 0.019139
T Loss: 9.504718
Epoch 2299 
Overall Loss: 9.533583
Rec Loss: 9.508484
KL Loss: 0.025099
Y Loss: 0.019169
T Loss: 9.498900
Epoch 2349 
Overall Loss: 9.533467
Rec Loss: 9.507629
KL Loss: 0.025839
Y Loss: 0.017953
T Loss: 9.498653
Epoch 2399 
Overall Loss: 9.542759
Rec Loss: 9.506978
KL Loss: 0.035781
Y Loss: 0.019307
T Loss: 9.497325
Epoch 2449 
Overall Loss: 9.543506
Rec Loss: 9.510717
KL Loss: 0.032788
Y Loss: 0.024808
T Loss: 9.498314
Epoch 2499 
Overall Loss: 9.529002
Rec Loss: 9.505060
KL Loss: 0.023942
Y Loss: 0.017997
T Loss: 9.496061
Epoch 2549 
Overall Loss: 9.562636
Rec Loss: 9.508884
KL Loss: 0.053752
Y Loss: 0.023060
T Loss: 9.497354
Epoch 2599 
Overall Loss: 9.523570
Rec Loss: 9.499334
KL Loss: 0.024236
Y Loss: 0.019152
T Loss: 9.489758
Epoch 2649 
Overall Loss: 9.522910
Rec Loss: 9.498827
KL Loss: 0.024083
Y Loss: 0.021013
T Loss: 9.488321
Epoch 2699 
Overall Loss: 9.520021
Rec Loss: 9.495495
KL Loss: 0.024527
Y Loss: 0.022698
T Loss: 9.484146
Epoch 2749 
Overall Loss: 9.519460
Rec Loss: 9.497086
KL Loss: 0.022373
Y Loss: 0.017668
T Loss: 9.488252
Epoch 2799 
Overall Loss: 9.510754
Rec Loss: 9.490222
KL Loss: 0.020533
Y Loss: 0.017853
T Loss: 9.481295
Epoch 2849 
Overall Loss: 9.517533
Rec Loss: 9.492933
KL Loss: 0.024601
Y Loss: 0.016830
T Loss: 9.484518
Epoch 2899 
Overall Loss: 9.520993
Rec Loss: 9.495713
KL Loss: 0.025280
Y Loss: 0.018143
T Loss: 9.486642
Epoch 2949 
Overall Loss: 9.511747
Rec Loss: 9.487165
KL Loss: 0.024582
Y Loss: 0.016443
T Loss: 9.478944
Epoch 2999 
Overall Loss: 9.511020
Rec Loss: 9.486892
KL Loss: 0.024129
Y Loss: 0.018686
T Loss: 9.477549
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.021234
Epoch 99
Rec Loss: 0.016428
Epoch 149
Rec Loss: 0.015191
Epoch 199
Rec Loss: 0.014170
Epoch 249
Rec Loss: 0.013966
Epoch 299
Rec Loss: 0.013772
Epoch 349
Rec Loss: 0.013487
Epoch 399
Rec Loss: 0.013294
Epoch 449
Rec Loss: 0.013279
Epoch 499
Rec Loss: 0.012968
Epoch 549
Rec Loss: 0.013243
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.192852
Epoch 99
Rec Loss: 10.174887
Epoch 149
Rec Loss: 10.165584
Epoch 199
Rec Loss: 10.149589
Epoch 249
Rec Loss: 10.134243
Epoch 299
Rec Loss: 10.117948
Epoch 349
Rec Loss: 10.102428
Epoch 399
Rec Loss: 10.093277
Epoch 449
Rec Loss: 10.081419
Epoch 499
Rec Loss: 10.072741
Epoch 549
Rec Loss: 10.074230
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.074372
Insample Error: 0.211055
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 19.199508
Rec Loss: 15.976733
KL Loss: 3.222775
Y Loss: 5.606102
T Loss: 13.428965
X Loss: -0.255284
Epoch 99 
Overall Loss: 2.021461
Rec Loss: -8.845756
KL Loss: 10.867217
Y Loss: 2.292483
T Loss: 13.271287
X Loss: -23.263285
Epoch 149 
Overall Loss: -2.729497
Rec Loss: -14.699220
KL Loss: 11.969723
Y Loss: 1.703020
T Loss: 13.210330
X Loss: -28.761059
Epoch 199 
Overall Loss: -5.329228
Rec Loss: -18.324410
KL Loss: 12.995182
Y Loss: 1.109062
T Loss: 13.159881
X Loss: -32.038821
Epoch 249 
Overall Loss: -7.159838
Rec Loss: -20.941631
KL Loss: 13.781791
Y Loss: 0.653460
T Loss: 13.099623
X Loss: -34.367984
Epoch 299 
Overall Loss: -8.531800
Rec Loss: -22.860878
KL Loss: 14.329078
Y Loss: 0.347572
T Loss: 13.023419
X Loss: -36.058084
Epoch 349 
Overall Loss: -9.566143
Rec Loss: -24.319754
KL Loss: 14.753611
Y Loss: 0.264821
T Loss: 12.930788
X Loss: -37.382952
Epoch 399 
Overall Loss: -10.522084
Rec Loss: -25.682758
KL Loss: 15.160673
Y Loss: 0.220481
T Loss: 12.818179
X Loss: -38.611178
Epoch 449 
Overall Loss: -11.136546
Rec Loss: -26.624932
KL Loss: 15.488387
Y Loss: 0.210697
T Loss: 12.625302
X Loss: -39.355583
Epoch 499 
Overall Loss: -11.876777
Rec Loss: -27.685615
KL Loss: 15.808839
Y Loss: 0.230511
T Loss: 12.432870
X Loss: -40.233740
Epoch 549 
Overall Loss: -12.576298
Rec Loss: -28.644680
KL Loss: 16.068382
Y Loss: 0.205801
T Loss: 12.235532
X Loss: -40.983112
Epoch 599 
Overall Loss: -13.369761
Rec Loss: -29.619113
KL Loss: 16.249352
Y Loss: 0.241615
T Loss: 12.083286
X Loss: -41.823207
Epoch 649 
Overall Loss: -13.850169
Rec Loss: -30.271996
KL Loss: 16.421827
Y Loss: 0.234744
T Loss: 11.924492
X Loss: -42.313860
Epoch 699 
Overall Loss: -14.430616
Rec Loss: -30.967499
KL Loss: 16.536884
Y Loss: 0.267240
T Loss: 11.793900
X Loss: -42.895020
Epoch 749 
Overall Loss: -15.013667
Rec Loss: -31.729305
KL Loss: 16.715639
Y Loss: 0.248327
T Loss: 11.680001
X Loss: -43.533472
Epoch 799 
Overall Loss: -15.413172
Rec Loss: -32.298498
KL Loss: 16.885326
Y Loss: 0.247692
T Loss: 11.588385
X Loss: -44.010728
Epoch 849 
Overall Loss: -15.690924
Rec Loss: -32.715657
KL Loss: 17.024734
Y Loss: 0.253640
T Loss: 11.505903
X Loss: -44.348381
Epoch 899 
Overall Loss: -16.045598
Rec Loss: -33.055459
KL Loss: 17.009860
Y Loss: 0.271116
T Loss: 11.432831
X Loss: -44.623848
Epoch 949 
Overall Loss: -16.561594
Rec Loss: -33.743322
KL Loss: 17.181729
Y Loss: 0.238068
T Loss: 11.371083
X Loss: -45.233439
Epoch 999 
Overall Loss: -16.835141
Rec Loss: -34.093206
KL Loss: 17.258063
Y Loss: 0.240960
T Loss: 11.335698
X Loss: -45.549383
Epoch 1049 
Overall Loss: -17.212437
Rec Loss: -34.699630
KL Loss: 17.487193
Y Loss: 0.236482
T Loss: 11.272096
X Loss: -46.089967
Epoch 1099 
Overall Loss: -17.560530
Rec Loss: -35.036210
KL Loss: 17.475681
Y Loss: 0.240667
T Loss: 11.243054
X Loss: -46.399599
Epoch 1149 
Overall Loss: -17.769850
Rec Loss: -35.353823
KL Loss: 17.583972
Y Loss: 0.252946
T Loss: 11.181306
X Loss: -46.661602
Epoch 1199 
Overall Loss: -18.202138
Rec Loss: -35.883936
KL Loss: 17.681798
Y Loss: 0.237180
T Loss: 11.136983
X Loss: -47.139509
Epoch 1249 
Overall Loss: -18.423492
Rec Loss: -36.145994
KL Loss: 17.722502
Y Loss: 0.242146
T Loss: 11.123922
X Loss: -47.390989
Epoch 1299 
Overall Loss: -18.709321
Rec Loss: -36.600200
KL Loss: 17.890880
Y Loss: 0.242274
T Loss: 11.073766
X Loss: -47.795103
Epoch 1349 
Overall Loss: -18.907885
Rec Loss: -36.867297
KL Loss: 17.959412
Y Loss: 0.239008
T Loss: 11.048162
X Loss: -48.034963
Epoch 1399 
Overall Loss: -19.026809
Rec Loss: -36.880966
KL Loss: 17.854156
Y Loss: 0.231504
T Loss: 11.028088
X Loss: -48.024807
Epoch 1449 
Overall Loss: -18.615472
Rec Loss: -36.775137
KL Loss: 18.159666
Y Loss: 0.237982
T Loss: 10.978007
X Loss: -47.872134
Epoch 1499 
Overall Loss: -19.331114
Rec Loss: -37.383053
KL Loss: 18.051938
Y Loss: 0.224324
T Loss: 10.960178
X Loss: -48.455392
Epoch 1549 
Overall Loss: -19.669106
Rec Loss: -37.922557
KL Loss: 18.253451
Y Loss: 0.223555
T Loss: 10.943752
X Loss: -48.978086
Epoch 1599 
Overall Loss: -19.432637
Rec Loss: -37.535259
KL Loss: 18.102622
Y Loss: 0.229178
T Loss: 10.930163
X Loss: -48.580010
Epoch 1649 
Overall Loss: -20.001233
Rec Loss: -38.284031
KL Loss: 18.282799
Y Loss: 0.219817
T Loss: 10.902302
X Loss: -49.296242
Epoch 1699 
Overall Loss: -20.043653
Rec Loss: -38.485296
KL Loss: 18.441642
Y Loss: 0.221681
T Loss: 10.874093
X Loss: -49.470229
Epoch 1749 
Overall Loss: -20.194406
Rec Loss: -38.648359
KL Loss: 18.453954
Y Loss: 0.234955
T Loss: 10.869765
X Loss: -49.635601
Epoch 1799 
Overall Loss: -20.591397
Rec Loss: -39.044345
KL Loss: 18.452949
Y Loss: 0.222904
T Loss: 10.842547
X Loss: -49.998343
Epoch 1849 
Overall Loss: -20.393700
Rec Loss: -38.891663
KL Loss: 18.497963
Y Loss: 0.229333
T Loss: 10.833228
X Loss: -49.839556
Epoch 1899 
Overall Loss: -20.810061
Rec Loss: -39.493200
KL Loss: 18.683139
Y Loss: 0.219513
T Loss: 10.817716
X Loss: -50.420673
Epoch 1949 
Overall Loss: -20.885459
Rec Loss: -39.525779
KL Loss: 18.640320
Y Loss: 0.220202
T Loss: 10.798537
X Loss: -50.434417
Epoch 1999 
Overall Loss: -20.966674
Rec Loss: -39.696590
KL Loss: 18.729914
Y Loss: 0.214174
T Loss: 10.797708
X Loss: -50.601384
Epoch 2049 
Overall Loss: -21.004851
Rec Loss: -39.728526
KL Loss: 18.723675
Y Loss: 0.216568
T Loss: 10.783243
X Loss: -50.620052
Epoch 2099 
Overall Loss: -21.287915
Rec Loss: -40.127681
KL Loss: 18.839767
Y Loss: 0.228952
T Loss: 10.761037
X Loss: -51.003195
Epoch 2149 
Overall Loss: -21.091084
Rec Loss: -39.852369
KL Loss: 18.761285
Y Loss: 0.218339
T Loss: 10.764599
X Loss: -50.726138
Epoch 2199 
Overall Loss: -21.601340
Rec Loss: -40.393724
KL Loss: 18.792385
Y Loss: 0.216686
T Loss: 10.752096
X Loss: -51.254163
Epoch 2249 
Overall Loss: -21.284201
Rec Loss: -40.228577
KL Loss: 18.944376
Y Loss: 0.207025
T Loss: 10.742574
X Loss: -51.074664
Epoch 2299 
Overall Loss: -21.725605
Rec Loss: -40.610614
KL Loss: 18.885010
Y Loss: 0.223199
T Loss: 10.749256
X Loss: -51.471471
Epoch 2349 
Overall Loss: -21.862973
Rec Loss: -40.773874
KL Loss: 18.910901
Y Loss: 0.215417
T Loss: 10.729671
X Loss: -51.611253
Epoch 2399 
Overall Loss: -22.066029
Rec Loss: -41.110847
KL Loss: 19.044816
Y Loss: 0.212474
T Loss: 10.723718
X Loss: -51.940800
Epoch 2449 
Overall Loss: -21.811390
Rec Loss: -40.874840
KL Loss: 19.063451
Y Loss: 0.215670
T Loss: 10.719265
X Loss: -51.701941
Epoch 2499 
Overall Loss: -22.103455
Rec Loss: -41.157892
KL Loss: 19.054436
Y Loss: 0.207464
T Loss: 10.714018
X Loss: -51.975643
Epoch 2549 
Overall Loss: -22.201279
Rec Loss: -41.130847
KL Loss: 18.929568
Y Loss: 0.216110
T Loss: 10.696111
X Loss: -51.935012
Epoch 2599 
Overall Loss: -22.174201
Rec Loss: -41.265142
KL Loss: 19.090941
Y Loss: 0.209516
T Loss: 10.699409
X Loss: -52.069309
Epoch 2649 
Overall Loss: -22.630206
Rec Loss: -41.703827
KL Loss: 19.073621
Y Loss: 0.219880
T Loss: 10.703907
X Loss: -52.517675
Epoch 2699 
Overall Loss: -22.562269
Rec Loss: -41.639469
KL Loss: 19.077200
Y Loss: 0.214819
T Loss: 10.683034
X Loss: -52.429913
Epoch 2749 
Overall Loss: -22.767607
Rec Loss: -42.003958
KL Loss: 19.236352
Y Loss: 0.215843
T Loss: 10.686737
X Loss: -52.798617
Epoch 2799 
Overall Loss: -22.790792
Rec Loss: -41.995499
KL Loss: 19.204706
Y Loss: 0.213991
T Loss: 10.666844
X Loss: -52.769338
Epoch 2849 
Overall Loss: -22.971106
Rec Loss: -42.234850
KL Loss: 19.263744
Y Loss: 0.211646
T Loss: 10.664234
X Loss: -53.004907
Epoch 2899 
Overall Loss: -22.791851
Rec Loss: -41.896987
KL Loss: 19.105136
Y Loss: 0.210821
T Loss: 10.670583
X Loss: -52.672980
Epoch 2949 
Overall Loss: -22.440095
Rec Loss: -41.732485
KL Loss: 19.292392
Y Loss: 0.213148
T Loss: 10.663399
X Loss: -52.502459
Epoch 2999 
Overall Loss: -22.868865
Rec Loss: -42.097984
KL Loss: 19.229120
Y Loss: 0.218254
T Loss: 10.661889
X Loss: -52.869002
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.220725
Epoch 99
Rec Loss: 2.194235
Epoch 149
Rec Loss: 2.186743
Epoch 199
Rec Loss: 2.180362
Epoch 249
Rec Loss: 2.175747
Epoch 299
Rec Loss: 2.170931
Epoch 349
Rec Loss: 2.157310
Epoch 399
Rec Loss: 2.158790
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.003019
Epoch 99
Rec Loss: 0.002069
Epoch 149
Rec Loss: 0.001493
Epoch 199
Rec Loss: 0.001234
Epoch 249
Rec Loss: 0.000949
Epoch 299
Rec Loss: 0.001017
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.395278
Insample Error 6.889911
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.406785
Epoch 99 
Prediction Loss: 0.131196
Epoch 149 
Prediction Loss: 0.074312
Epoch 199 
Prediction Loss: 0.047945
Epoch 249 
Prediction Loss: 0.034055
Epoch 299 
Prediction Loss: 0.025464
Epoch 349 
Prediction Loss: 0.021465
Epoch 399 
Prediction Loss: 0.018735
Epoch 449 
Prediction Loss: 0.015744
Epoch 499 
Prediction Loss: 0.013539
Epoch 549 
Prediction Loss: 0.012661
Epoch 599 
Prediction Loss: 0.012661
Epoch 649 
Prediction Loss: 0.012522
Epoch 699 
Prediction Loss: 0.009380
Epoch 749 
Prediction Loss: 0.010086
Epoch 799 
Prediction Loss: 0.012711
Epoch 849 
Prediction Loss: 0.007459
Epoch 899 
Prediction Loss: 0.006592
Epoch 949 
Prediction Loss: 0.006388
Epoch 999 
Prediction Loss: 0.006321
Epoch 1049 
Prediction Loss: 0.005777
Epoch 1099 
Prediction Loss: 0.007232
Epoch 1149 
Prediction Loss: 0.004692
Epoch 1199 
Prediction Loss: 0.005495
Epoch 1249 
Prediction Loss: 0.005072
Epoch 1299 
Prediction Loss: 0.004211
Epoch 1349 
Prediction Loss: 0.004773
Epoch 1399 
Prediction Loss: 0.004436
Epoch 1449 
Prediction Loss: 0.004590
Epoch 1499 
Prediction Loss: 0.005014
Epoch 1549 
Prediction Loss: 0.004408
Epoch 1599 
Prediction Loss: 0.005159
Epoch 1649 
Prediction Loss: 0.003642
Epoch 1699 
Prediction Loss: 0.003450
Epoch 1749 
Prediction Loss: 0.003264
Epoch 1799 
Prediction Loss: 0.005489
Epoch 1849 
Prediction Loss: 0.003272
Epoch 1899 
Prediction Loss: 0.003043
Epoch 1949 
Prediction Loss: 0.003671
Epoch 1999 
Prediction Loss: 0.003960
Epoch 2049 
Prediction Loss: 0.005354
Epoch 2099 
Prediction Loss: 0.002910
Epoch 2149 
Prediction Loss: 0.004528
Epoch 2199 
Prediction Loss: 0.003133
Epoch 2249 
Prediction Loss: 0.003108
Epoch 2299 
Prediction Loss: 0.002565
Epoch 2349 
Prediction Loss: 0.003736
Epoch 2399 
Prediction Loss: 0.002463
Epoch 2449 
Prediction Loss: 0.003341
Epoch 2499 
Prediction Loss: 0.003534
Epoch 2549 
Prediction Loss: 0.003443
Epoch 2599 
Prediction Loss: 0.001985
Epoch 2649 
Prediction Loss: 0.002566
Epoch 2699 
Prediction Loss: 0.003621
Epoch 2749 
Prediction Loss: 0.004727
Epoch 2799 
Prediction Loss: 0.003380
Epoch 2849 
Prediction Loss: 0.004118
Epoch 2899 
Prediction Loss: 0.002365
Epoch 2949 
Prediction Loss: 0.002072
Epoch 2999 
Prediction Loss: 0.002136
Epoch 3049 
Prediction Loss: 0.002044
Epoch 3099 
Prediction Loss: 0.001951
Epoch 3149 
Prediction Loss: 0.002738
Epoch 3199 
Prediction Loss: 0.002626
Epoch 3249 
Prediction Loss: 0.003143
Epoch 3299 
Prediction Loss: 0.002328
Epoch 3349 
Prediction Loss: 0.001972
Epoch 3399 
Prediction Loss: 0.002553
Epoch 3449 
Prediction Loss: 0.002611
Epoch 3499 
Prediction Loss: 0.002272
Epoch 3549 
Prediction Loss: 0.002699
Epoch 3599 
Prediction Loss: 0.001622
Epoch 3649 
Prediction Loss: 0.002210
Epoch 3699 
Prediction Loss: 0.002094
Epoch 3749 
Prediction Loss: 0.003209
Epoch 3799 
Prediction Loss: 0.002364
Epoch 3849 
Prediction Loss: 0.001835
Epoch 3899 
Prediction Loss: 0.002260
Epoch 3949 
Prediction Loss: 0.002812
Epoch 3999 
Prediction Loss: 0.001578
Epoch 4049 
Prediction Loss: 0.001732
Epoch 4099 
Prediction Loss: 0.001812
Epoch 4149 
Prediction Loss: 0.001854
Epoch 4199 
Prediction Loss: 0.002041
Epoch 4249 
Prediction Loss: 0.001872
Epoch 4299 
Prediction Loss: 0.002264
Epoch 4349 
Prediction Loss: 0.001524
Epoch 4399 
Prediction Loss: 0.002056
Epoch 4449 
Prediction Loss: 0.002972
Epoch 4499 
Prediction Loss: 0.001463
Epoch 4549 
Prediction Loss: 0.002227
Epoch 4599 
Prediction Loss: 0.001821
Epoch 4649 
Prediction Loss: 0.005223
Epoch 4699 
Prediction Loss: 0.001325
Epoch 4749 
Prediction Loss: 0.001677
Epoch 4799 
Prediction Loss: 0.001395
Epoch 4849 
Prediction Loss: 0.001844
Epoch 4899 
Prediction Loss: 0.001987
Epoch 4949 
Prediction Loss: 0.001468
Epoch 4999 
Prediction Loss: 0.001240
Epoch 5049 
Prediction Loss: 0.001311
Epoch 5099 
Prediction Loss: 0.001508
Epoch 5149 
Prediction Loss: 0.001772
Epoch 5199 
Prediction Loss: 0.001297
Epoch 5249 
Prediction Loss: 0.002658
Epoch 5299 
Prediction Loss: 0.001348
Epoch 5349 
Prediction Loss: 0.001703
Epoch 5399 
Prediction Loss: 0.001525
Epoch 5449 
Prediction Loss: 0.001594
Epoch 5499 
Prediction Loss: 0.001201
Epoch 5549 
Prediction Loss: 0.001102
Epoch 5599 
Prediction Loss: 0.002016
Epoch 5649 
Prediction Loss: 0.002172
Epoch 5699 
Prediction Loss: 0.002362
Epoch 5749 
Prediction Loss: 0.001459
Epoch 5799 
Prediction Loss: 0.003901
Epoch 5849 
Prediction Loss: 0.002174
Epoch 5899 
Prediction Loss: 0.001282
Epoch 5949 
Prediction Loss: 0.001072
Epoch 5999 
Prediction Loss: 0.001742
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.045760
Insample Error 0.216299
[31m========== repeat time 5 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.110485
Rec Loss: 9.849226
KL Loss: 0.261258
Y Loss: 0.604334
T Loss: 9.547059
Epoch 99 
Overall Loss: 9.836209
Rec Loss: 9.698039
KL Loss: 0.138170
Y Loss: 0.255205
T Loss: 9.570436
Epoch 149 
Overall Loss: 9.755390
Rec Loss: 9.643628
KL Loss: 0.111762
Y Loss: 0.144782
T Loss: 9.571237
Epoch 199 
Overall Loss: 9.725736
Rec Loss: 9.632307
KL Loss: 0.093429
Y Loss: 0.103191
T Loss: 9.580711
Epoch 249 
Overall Loss: 9.695772
Rec Loss: 9.612802
KL Loss: 0.082969
Y Loss: 0.081188
T Loss: 9.572208
Epoch 299 
Overall Loss: 9.692375
Rec Loss: 9.612546
KL Loss: 0.079829
Y Loss: 0.070512
T Loss: 9.577290
Epoch 349 
Overall Loss: 9.679934
Rec Loss: 9.611219
KL Loss: 0.068716
Y Loss: 0.055923
T Loss: 9.583257
Epoch 399 
Overall Loss: 9.665899
Rec Loss: 9.601842
KL Loss: 0.064057
Y Loss: 0.052909
T Loss: 9.575388
Epoch 449 
Overall Loss: 9.658412
Rec Loss: 9.598508
KL Loss: 0.059904
Y Loss: 0.047342
T Loss: 9.574836
Epoch 499 
Overall Loss: 9.648375
Rec Loss: 9.585492
KL Loss: 0.062884
Y Loss: 0.046689
T Loss: 9.562147
Epoch 549 
Overall Loss: 9.648168
Rec Loss: 9.585257
KL Loss: 0.062911
Y Loss: 0.039829
T Loss: 9.565342
Epoch 599 
Overall Loss: 9.638258
Rec Loss: 9.587938
KL Loss: 0.050319
Y Loss: 0.036676
T Loss: 9.569600
Epoch 649 
Overall Loss: 9.654929
Rec Loss: 9.584433
KL Loss: 0.070496
Y Loss: 0.034530
T Loss: 9.567168
Epoch 699 
Overall Loss: 9.626646
Rec Loss: 9.579427
KL Loss: 0.047218
Y Loss: 0.033431
T Loss: 9.562712
Epoch 749 
Overall Loss: 9.620223
Rec Loss: 9.576426
KL Loss: 0.043797
Y Loss: 0.031443
T Loss: 9.560704
Epoch 799 
Overall Loss: 9.637151
Rec Loss: 9.578379
KL Loss: 0.058772
Y Loss: 0.033958
T Loss: 9.561400
Epoch 849 
Overall Loss: 9.611276
Rec Loss: 9.568989
KL Loss: 0.042287
Y Loss: 0.030163
T Loss: 9.553908
Epoch 899 
Overall Loss: 9.630010
Rec Loss: 9.583117
KL Loss: 0.046892
Y Loss: 0.052142
T Loss: 9.557047
Epoch 949 
Overall Loss: 9.612444
Rec Loss: 9.563330
KL Loss: 0.049115
Y Loss: 0.034534
T Loss: 9.546063
Epoch 999 
Overall Loss: 9.596288
Rec Loss: 9.559564
KL Loss: 0.036724
Y Loss: 0.026020
T Loss: 9.546553
Epoch 1049 
Overall Loss: 9.615562
Rec Loss: 9.564616
KL Loss: 0.050946
Y Loss: 0.025670
T Loss: 9.551780
Epoch 1099 
Overall Loss: 9.591340
Rec Loss: 9.555534
KL Loss: 0.035807
Y Loss: 0.025222
T Loss: 9.542922
Epoch 1149 
Overall Loss: 9.597403
Rec Loss: 9.554280
KL Loss: 0.043123
Y Loss: 0.025888
T Loss: 9.541336
Epoch 1199 
Overall Loss: 9.615948
Rec Loss: 9.569423
KL Loss: 0.046525
Y Loss: 0.053895
T Loss: 9.542476
Epoch 1249 
Overall Loss: 9.582325
Rec Loss: 9.549655
KL Loss: 0.032670
Y Loss: 0.022842
T Loss: 9.538234
Epoch 1299 
Overall Loss: 9.579450
Rec Loss: 9.545051
KL Loss: 0.034398
Y Loss: 0.024297
T Loss: 9.532903
Epoch 1349 
Overall Loss: 9.574801
Rec Loss: 9.539066
KL Loss: 0.035735
Y Loss: 0.028610
T Loss: 9.524762
Epoch 1399 
Overall Loss: 9.575899
Rec Loss: 9.543350
KL Loss: 0.032549
Y Loss: 0.021824
T Loss: 9.532438
Epoch 1449 
Overall Loss: 9.578270
Rec Loss: 9.542089
KL Loss: 0.036181
Y Loss: 0.022751
T Loss: 9.530714
Epoch 1499 
Overall Loss: 9.568903
Rec Loss: 9.537485
KL Loss: 0.031418
Y Loss: 0.023084
T Loss: 9.525943
Epoch 1549 
Overall Loss: 9.568740
Rec Loss: 9.538941
KL Loss: 0.029798
Y Loss: 0.020346
T Loss: 9.528768
Epoch 1599 
Overall Loss: 9.566018
Rec Loss: 9.531315
KL Loss: 0.034703
Y Loss: 0.022988
T Loss: 9.519821
Epoch 1649 
Overall Loss: 9.574535
Rec Loss: 9.539241
KL Loss: 0.035294
Y Loss: 0.027860
T Loss: 9.525311
Epoch 1699 
Overall Loss: 9.566249
Rec Loss: 9.533253
KL Loss: 0.032995
Y Loss: 0.022631
T Loss: 9.521938
Epoch 1749 
Overall Loss: 9.565399
Rec Loss: 9.532840
KL Loss: 0.032559
Y Loss: 0.019291
T Loss: 9.523195
Epoch 1799 
Overall Loss: 9.578830
Rec Loss: 9.533501
KL Loss: 0.045329
Y Loss: 0.019895
T Loss: 9.523554
Epoch 1849 
Overall Loss: 9.564714
Rec Loss: 9.530443
KL Loss: 0.034271
Y Loss: 0.029391
T Loss: 9.515747
Epoch 1899 
Overall Loss: 9.562846
Rec Loss: 9.531726
KL Loss: 0.031120
Y Loss: 0.027828
T Loss: 9.517812
Epoch 1949 
Overall Loss: 9.557115
Rec Loss: 9.526038
KL Loss: 0.031077
Y Loss: 0.020242
T Loss: 9.515917
Epoch 1999 
Overall Loss: 9.549343
Rec Loss: 9.522556
KL Loss: 0.026786
Y Loss: 0.021206
T Loss: 9.511953
Epoch 2049 
Overall Loss: 9.547304
Rec Loss: 9.521182
KL Loss: 0.026122
Y Loss: 0.019840
T Loss: 9.511263
Epoch 2099 
Overall Loss: 9.558288
Rec Loss: 9.520821
KL Loss: 0.037467
Y Loss: 0.020516
T Loss: 9.510564
Epoch 2149 
Overall Loss: 9.549039
Rec Loss: 9.519743
KL Loss: 0.029296
Y Loss: 0.022843
T Loss: 9.508321
Epoch 2199 
Overall Loss: 9.573976
Rec Loss: 9.522325
KL Loss: 0.051651
Y Loss: 0.025620
T Loss: 9.509515
Epoch 2249 
Overall Loss: 9.542119
Rec Loss: 9.514838
KL Loss: 0.027281
Y Loss: 0.020100
T Loss: 9.504788
Epoch 2299 
Overall Loss: 9.546910
Rec Loss: 9.513027
KL Loss: 0.033883
Y Loss: 0.018084
T Loss: 9.503985
Epoch 2349 
Overall Loss: 9.537174
Rec Loss: 9.511656
KL Loss: 0.025518
Y Loss: 0.019249
T Loss: 9.502031
Epoch 2399 
Overall Loss: 9.537441
Rec Loss: 9.506560
KL Loss: 0.030881
Y Loss: 0.017486
T Loss: 9.497817
Epoch 2449 
Overall Loss: 9.532513
Rec Loss: 9.505869
KL Loss: 0.026644
Y Loss: 0.017705
T Loss: 9.497016
Epoch 2499 
Overall Loss: 9.531372
Rec Loss: 9.504493
KL Loss: 0.026879
Y Loss: 0.017838
T Loss: 9.495574
Epoch 2549 
Overall Loss: 9.529091
Rec Loss: 9.504527
KL Loss: 0.024564
Y Loss: 0.018371
T Loss: 9.495341
Epoch 2599 
Overall Loss: 9.530344
Rec Loss: 9.505213
KL Loss: 0.025131
Y Loss: 0.018009
T Loss: 9.496208
Epoch 2649 
Overall Loss: 9.537165
Rec Loss: 9.503042
KL Loss: 0.034123
Y Loss: 0.017512
T Loss: 9.494286
Epoch 2699 
Overall Loss: 9.528131
Rec Loss: 9.500008
KL Loss: 0.028123
Y Loss: 0.017638
T Loss: 9.491189
Epoch 2749 
Overall Loss: 9.521308
Rec Loss: 9.496998
KL Loss: 0.024310
Y Loss: 0.018725
T Loss: 9.487636
Epoch 2799 
Overall Loss: 9.523102
Rec Loss: 9.497396
KL Loss: 0.025706
Y Loss: 0.018427
T Loss: 9.488182
Epoch 2849 
Overall Loss: 9.534770
Rec Loss: 9.502637
KL Loss: 0.032133
Y Loss: 0.021977
T Loss: 9.491648
Epoch 2899 
Overall Loss: 9.522236
Rec Loss: 9.495979
KL Loss: 0.026257
Y Loss: 0.015492
T Loss: 9.488233
Epoch 2949 
Overall Loss: 9.519021
Rec Loss: 9.494031
KL Loss: 0.024990
Y Loss: 0.019336
T Loss: 9.484363
Epoch 2999 
Overall Loss: 9.524549
Rec Loss: 9.496035
KL Loss: 0.028515
Y Loss: 0.016529
T Loss: 9.487770
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.022796
Epoch 99
Rec Loss: 0.017836
Epoch 149
Rec Loss: 0.016413
Epoch 199
Rec Loss: 0.015471
Epoch 249
Rec Loss: 0.015050
Epoch 299
Rec Loss: 0.015201
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.187959
Epoch 99
Rec Loss: 10.160979
Epoch 149
Rec Loss: 10.133576
Epoch 199
Rec Loss: 10.140576
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.059468
Insample Error: 0.209336
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 18.556399
Rec Loss: 14.811194
KL Loss: 3.745206
Y Loss: 6.369945
T Loss: 13.400797
X Loss: -1.774575
Epoch 99 
Overall Loss: 1.137387
Rec Loss: -8.475575
KL Loss: 9.612963
Y Loss: 2.408020
T Loss: 13.177379
X Loss: -22.856964
Epoch 149 
Overall Loss: -3.976196
Rec Loss: -14.281578
KL Loss: 10.305383
Y Loss: 1.612386
T Loss: 13.129387
X Loss: -28.217158
Epoch 199 
Overall Loss: -6.391645
Rec Loss: -17.458112
KL Loss: 11.066467
Y Loss: 0.954835
T Loss: 13.081108
X Loss: -31.016638
Epoch 249 
Overall Loss: -8.516611
Rec Loss: -20.353817
KL Loss: 11.837207
Y Loss: 0.620814
T Loss: 13.024317
X Loss: -33.688542
Epoch 299 
Overall Loss: -10.018863
Rec Loss: -22.459341
KL Loss: 12.440478
Y Loss: 0.510553
T Loss: 12.953888
X Loss: -35.668505
Epoch 349 
Overall Loss: -10.999698
Rec Loss: -23.968901
KL Loss: 12.969202
Y Loss: 0.487548
T Loss: 12.849486
X Loss: -37.062160
Epoch 399 
Overall Loss: -12.262889
Rec Loss: -25.658637
KL Loss: 13.395748
Y Loss: 0.449715
T Loss: 12.682435
X Loss: -38.565930
Epoch 449 
Overall Loss: -13.271406
Rec Loss: -27.122743
KL Loss: 13.851337
Y Loss: 0.434574
T Loss: 12.400233
X Loss: -39.740264
Epoch 499 
Overall Loss: -14.287409
Rec Loss: -28.506299
KL Loss: 14.218890
Y Loss: 0.418547
T Loss: 12.038885
X Loss: -40.754457
Epoch 549 
Overall Loss: -14.995437
Rec Loss: -29.469310
KL Loss: 14.473874
Y Loss: 0.420226
T Loss: 11.809372
X Loss: -41.488796
Epoch 599 
Overall Loss: -15.630380
Rec Loss: -30.207587
KL Loss: 14.577207
Y Loss: 0.413452
T Loss: 11.713454
X Loss: -42.127768
Epoch 649 
Overall Loss: -16.280630
Rec Loss: -30.974562
KL Loss: 14.693932
Y Loss: 0.439165
T Loss: 11.601334
X Loss: -42.795479
Epoch 699 
Overall Loss: -17.083133
Rec Loss: -31.842219
KL Loss: 14.759087
Y Loss: 0.441672
T Loss: 11.541676
X Loss: -43.604732
Epoch 749 
Overall Loss: -17.583760
Rec Loss: -32.462776
KL Loss: 14.879014
Y Loss: 0.452591
T Loss: 11.478976
X Loss: -44.168046
Epoch 799 
Overall Loss: -18.133757
Rec Loss: -33.062306
KL Loss: 14.928548
Y Loss: 0.460301
T Loss: 11.437688
X Loss: -44.730145
Epoch 849 
Overall Loss: -18.462373
Rec Loss: -33.420731
KL Loss: 14.958358
Y Loss: 0.492016
T Loss: 11.364416
X Loss: -45.031155
Epoch 899 
Overall Loss: -19.138748
Rec Loss: -34.199557
KL Loss: 15.060809
Y Loss: 0.496564
T Loss: 11.323944
X Loss: -45.771783
Epoch 949 
Overall Loss: -19.396572
Rec Loss: -34.463170
KL Loss: 15.066599
Y Loss: 0.479188
T Loss: 11.273541
X Loss: -45.976306
Epoch 999 
Overall Loss: -19.942361
Rec Loss: -35.035023
KL Loss: 15.092660
Y Loss: 0.468486
T Loss: 11.263924
X Loss: -46.533188
Epoch 1049 
Overall Loss: -20.221925
Rec Loss: -35.382366
KL Loss: 15.160440
Y Loss: 0.462714
T Loss: 11.221225
X Loss: -46.834947
Epoch 1099 
Overall Loss: -20.539115
Rec Loss: -35.683648
KL Loss: 15.144534
Y Loss: 0.471054
T Loss: 11.207631
X Loss: -47.126807
Epoch 1149 
Overall Loss: -20.257604
Rec Loss: -35.524011
KL Loss: 15.266408
Y Loss: 0.448655
T Loss: 11.173518
X Loss: -46.921856
Epoch 1199 
Overall Loss: -21.067933
Rec Loss: -36.430673
KL Loss: 15.362742
Y Loss: 0.441706
T Loss: 11.155737
X Loss: -47.807263
Epoch 1249 
Overall Loss: -21.176764
Rec Loss: -36.606900
KL Loss: 15.430137
Y Loss: 0.442091
T Loss: 11.133535
X Loss: -47.961481
Epoch 1299 
Overall Loss: -21.291164
Rec Loss: -36.523448
KL Loss: 15.232284
Y Loss: 0.450369
T Loss: 11.115456
X Loss: -47.864089
Epoch 1349 
Overall Loss: -21.885885
Rec Loss: -37.337999
KL Loss: 15.452114
Y Loss: 0.412865
T Loss: 11.108045
X Loss: -48.652476
Epoch 1399 
Overall Loss: -21.422126
Rec Loss: -36.940871
KL Loss: 15.518744
Y Loss: 0.419178
T Loss: 11.092792
X Loss: -48.243251
Epoch 1449 
Overall Loss: -22.022801
Rec Loss: -37.396094
KL Loss: 15.373293
Y Loss: 0.419556
T Loss: 11.092800
X Loss: -48.698672
Epoch 1499 
Overall Loss: -22.457028
Rec Loss: -38.086723
KL Loss: 15.629695
Y Loss: 0.382588
T Loss: 11.064097
X Loss: -49.342114
Epoch 1549 
Overall Loss: -22.723706
Rec Loss: -38.299191
KL Loss: 15.575484
Y Loss: 0.390913
T Loss: 11.066196
X Loss: -49.560843
Epoch 1599 
Overall Loss: -22.726269
Rec Loss: -38.470170
KL Loss: 15.743902
Y Loss: 0.388578
T Loss: 11.049800
X Loss: -49.714259
Epoch 1649 
Overall Loss: -22.712970
Rec Loss: -38.481973
KL Loss: 15.769004
Y Loss: 0.372280
T Loss: 11.038211
X Loss: -49.706324
Epoch 1699 
Overall Loss: -23.123986
Rec Loss: -38.972999
KL Loss: 15.849013
Y Loss: 0.358456
T Loss: 11.041302
X Loss: -50.193530
Epoch 1749 
Overall Loss: -23.294297
Rec Loss: -39.051670
KL Loss: 15.757372
Y Loss: 0.359761
T Loss: 11.032031
X Loss: -50.263582
Epoch 1799 
Overall Loss: -23.196762
Rec Loss: -39.062300
KL Loss: 15.865539
Y Loss: 0.349986
T Loss: 11.010437
X Loss: -50.247730
Epoch 1849 
Overall Loss: -23.511809
Rec Loss: -39.352708
KL Loss: 15.840898
Y Loss: 0.344911
T Loss: 11.017328
X Loss: -50.542492
Epoch 1899 
Overall Loss: -23.618203
Rec Loss: -39.404058
KL Loss: 15.785856
Y Loss: 0.341866
T Loss: 11.010001
X Loss: -50.584991
Epoch 1949 
Overall Loss: -23.926673
Rec Loss: -39.689224
KL Loss: 15.762550
Y Loss: 0.335614
T Loss: 11.006166
X Loss: -50.863196
Epoch 1999 
Overall Loss: -23.801837
Rec Loss: -39.810030
KL Loss: 16.008192
Y Loss: 0.318125
T Loss: 10.971678
X Loss: -50.940770
Epoch 2049 
Overall Loss: -24.153419
Rec Loss: -40.217733
KL Loss: 16.064314
Y Loss: 0.304970
T Loss: 10.968205
X Loss: -51.338423
Epoch 2099 
Overall Loss: -24.153466
Rec Loss: -40.162571
KL Loss: 16.009106
Y Loss: 0.294844
T Loss: 10.984845
X Loss: -51.294838
Epoch 2149 
Overall Loss: -24.433343
Rec Loss: -40.488421
KL Loss: 16.055076
Y Loss: 0.291141
T Loss: 10.972882
X Loss: -51.606873
Epoch 2199 
Overall Loss: -24.063198
Rec Loss: -40.165490
KL Loss: 16.102293
Y Loss: 0.288356
T Loss: 10.956636
X Loss: -51.266305
Epoch 2249 
Overall Loss: -24.470778
Rec Loss: -40.464629
KL Loss: 15.993852
Y Loss: 0.289106
T Loss: 10.955497
X Loss: -51.564680
Epoch 2299 
Overall Loss: -24.764400
Rec Loss: -40.829877
KL Loss: 16.065479
Y Loss: 0.274562
T Loss: 10.948856
X Loss: -51.916014
Epoch 2349 
Overall Loss: -24.975295
Rec Loss: -41.143258
KL Loss: 16.167962
Y Loss: 0.272012
T Loss: 10.931588
X Loss: -52.210851
Epoch 2399 
Overall Loss: -24.737535
Rec Loss: -40.880960
KL Loss: 16.143424
Y Loss: 0.269053
T Loss: 10.936720
X Loss: -51.952206
Epoch 2449 
Overall Loss: -24.513231
Rec Loss: -40.657595
KL Loss: 16.144365
Y Loss: 0.264121
T Loss: 10.932386
X Loss: -51.722043
Epoch 2499 
Overall Loss: -25.306422
Rec Loss: -41.453628
KL Loss: 16.147206
Y Loss: 0.258854
T Loss: 10.930453
X Loss: -52.513509
Epoch 2549 
Overall Loss: -25.213751
Rec Loss: -41.295963
KL Loss: 16.082212
Y Loss: 0.257240
T Loss: 10.929810
X Loss: -52.354393
Epoch 2599 
Overall Loss: -25.388293
Rec Loss: -41.406266
KL Loss: 16.017973
Y Loss: 0.249661
T Loss: 10.923563
X Loss: -52.454659
Epoch 2649 
Overall Loss: -25.199180
Rec Loss: -41.425826
KL Loss: 16.226646
Y Loss: 0.236993
T Loss: 10.900481
X Loss: -52.444806
Epoch 2699 
Overall Loss: -25.652108
Rec Loss: -41.901409
KL Loss: 16.249302
Y Loss: 0.237429
T Loss: 10.898484
X Loss: -52.918610
Epoch 2749 
Overall Loss: -25.728753
Rec Loss: -41.931980
KL Loss: 16.203227
Y Loss: 0.234063
T Loss: 10.890500
X Loss: -52.939511
Epoch 2799 
Overall Loss: -25.280280
Rec Loss: -41.638340
KL Loss: 16.358060
Y Loss: 0.220646
T Loss: 10.878990
X Loss: -52.627653
Epoch 2849 
Overall Loss: -25.585814
Rec Loss: -41.908540
KL Loss: 16.322724
Y Loss: 0.216725
T Loss: 10.885336
X Loss: -52.902237
Epoch 2899 
Overall Loss: -25.989515
Rec Loss: -42.345826
KL Loss: 16.356312
Y Loss: 0.217362
T Loss: 10.862233
X Loss: -53.316740
Epoch 2949 
Overall Loss: -25.983455
Rec Loss: -42.413285
KL Loss: 16.429829
Y Loss: 0.208839
T Loss: 10.860248
X Loss: -53.377952
Epoch 2999 
Overall Loss: -25.396210
Rec Loss: -41.735446
KL Loss: 16.339237
Y Loss: 0.213924
T Loss: 10.859874
X Loss: -52.702283
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.258549
Epoch 99
Rec Loss: 2.234085
Epoch 149
Rec Loss: 2.223490
Epoch 199
Rec Loss: 2.204538
Epoch 249
Rec Loss: 2.208239
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.002613
Epoch 99
Rec Loss: 0.002177
Epoch 149
Rec Loss: 0.001623
Epoch 199
Rec Loss: 0.001048
Epoch 249
Rec Loss: 0.001651
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.293033
Insample Error 3.378202
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.401064
Epoch 99 
Prediction Loss: 0.140469
Epoch 149 
Prediction Loss: 0.084520
Epoch 199 
Prediction Loss: 0.060855
Epoch 249 
Prediction Loss: 0.041290
Epoch 299 
Prediction Loss: 0.031976
Epoch 349 
Prediction Loss: 0.027179
Epoch 399 
Prediction Loss: 0.020017
Epoch 449 
Prediction Loss: 0.020188
Epoch 499 
Prediction Loss: 0.013629
Epoch 549 
Prediction Loss: 0.011616
Epoch 599 
Prediction Loss: 0.010553
Epoch 649 
Prediction Loss: 0.009541
Epoch 699 
Prediction Loss: 0.008724
Epoch 749 
Prediction Loss: 0.008034
Epoch 799 
Prediction Loss: 0.007727
Epoch 849 
Prediction Loss: 0.006660
Epoch 899 
Prediction Loss: 0.007691
Epoch 949 
Prediction Loss: 0.007711
Epoch 999 
Prediction Loss: 0.006506
Epoch 1049 
Prediction Loss: 0.005527
Epoch 1099 
Prediction Loss: 0.006695
Epoch 1149 
Prediction Loss: 0.005431
Epoch 1199 
Prediction Loss: 0.004392
Epoch 1249 
Prediction Loss: 0.004607
Epoch 1299 
Prediction Loss: 0.004975
Epoch 1349 
Prediction Loss: 0.004402
Epoch 1399 
Prediction Loss: 0.004060
Epoch 1449 
Prediction Loss: 0.004273
Epoch 1499 
Prediction Loss: 0.003348
Epoch 1549 
Prediction Loss: 0.005242
Epoch 1599 
Prediction Loss: 0.004289
Epoch 1649 
Prediction Loss: 0.003999
Epoch 1699 
Prediction Loss: 0.002847
Epoch 1749 
Prediction Loss: 0.003700
Epoch 1799 
Prediction Loss: 0.006391
Epoch 1849 
Prediction Loss: 0.003584
Epoch 1899 
Prediction Loss: 0.002842
Epoch 1949 
Prediction Loss: 0.002546
Epoch 1999 
Prediction Loss: 0.002805
Epoch 2049 
Prediction Loss: 0.007002
Epoch 2099 
Prediction Loss: 0.002967
Epoch 2149 
Prediction Loss: 0.002409
Epoch 2199 
Prediction Loss: 0.003424
Epoch 2249 
Prediction Loss: 0.004244
Epoch 2299 
Prediction Loss: 0.004720
Epoch 2349 
Prediction Loss: 0.002146
Epoch 2399 
Prediction Loss: 0.002466
Epoch 2449 
Prediction Loss: 0.002258
Epoch 2499 
Prediction Loss: 0.001920
Epoch 2549 
Prediction Loss: 0.002649
Epoch 2599 
Prediction Loss: 0.001893
Epoch 2649 
Prediction Loss: 0.001920
Epoch 2699 
Prediction Loss: 0.001884
Epoch 2749 
Prediction Loss: 0.002342
Epoch 2799 
Prediction Loss: 0.002631
Epoch 2849 
Prediction Loss: 0.002513
Epoch 2899 
Prediction Loss: 0.001831
Epoch 2949 
Prediction Loss: 0.001906
Epoch 2999 
Prediction Loss: 0.002994
Epoch 3049 
Prediction Loss: 0.001771
Epoch 3099 
Prediction Loss: 0.003330
Epoch 3149 
Prediction Loss: 0.001529
Epoch 3199 
Prediction Loss: 0.001989
Epoch 3249 
Prediction Loss: 0.001620
Epoch 3299 
Prediction Loss: 0.002020
Epoch 3349 
Prediction Loss: 0.001551
Epoch 3399 
Prediction Loss: 0.001960
Epoch 3449 
Prediction Loss: 0.001478
Epoch 3499 
Prediction Loss: 0.002460
Epoch 3549 
Prediction Loss: 0.001909
Epoch 3599 
Prediction Loss: 0.001881
Epoch 3649 
Prediction Loss: 0.001654
Epoch 3699 
Prediction Loss: 0.002242
Epoch 3749 
Prediction Loss: 0.001456
Epoch 3799 
Prediction Loss: 0.001620
Epoch 3849 
Prediction Loss: 0.002070
Epoch 3899 
Prediction Loss: 0.003256
Epoch 3949 
Prediction Loss: 0.001813
Epoch 3999 
Prediction Loss: 0.001503
Epoch 4049 
Prediction Loss: 0.002106
Epoch 4099 
Prediction Loss: 0.001394
Epoch 4149 
Prediction Loss: 0.001672
Epoch 4199 
Prediction Loss: 0.001841
Epoch 4249 
Prediction Loss: 0.001220
Epoch 4299 
Prediction Loss: 0.001922
Epoch 4349 
Prediction Loss: 0.001193
Epoch 4399 
Prediction Loss: 0.001426
Epoch 4449 
Prediction Loss: 0.002238
Epoch 4499 
Prediction Loss: 0.001091
Epoch 4549 
Prediction Loss: 0.002444
Epoch 4599 
Prediction Loss: 0.001168
Epoch 4649 
Prediction Loss: 0.001560
Epoch 4699 
Prediction Loss: 0.003606
Epoch 4749 
Prediction Loss: 0.001550
Epoch 4799 
Prediction Loss: 0.001201
Epoch 4849 
Prediction Loss: 0.001783
Epoch 4899 
Prediction Loss: 0.001153
Epoch 4949 
Prediction Loss: 0.001121
Epoch 4999 
Prediction Loss: 0.002332
Epoch 5049 
Prediction Loss: 0.000987
Epoch 5099 
Prediction Loss: 0.001648
Epoch 5149 
Prediction Loss: 0.001797
Epoch 5199 
Prediction Loss: 0.001257
Epoch 5249 
Prediction Loss: 0.001001
Epoch 5299 
Prediction Loss: 0.001292
Epoch 5349 
Prediction Loss: 0.001349
Epoch 5399 
Prediction Loss: 0.001057
Epoch 5449 
Prediction Loss: 0.000852
Epoch 5499 
Prediction Loss: 0.001391
Epoch 5549 
Prediction Loss: 0.001277
Epoch 5599 
Prediction Loss: 0.001106
Epoch 5649 
Prediction Loss: 0.001899
Epoch 5699 
Prediction Loss: 0.002094
Epoch 5749 
Prediction Loss: 0.000975
Epoch 5799 
Prediction Loss: 0.001463
Epoch 5849 
Prediction Loss: 0.000853
Epoch 5899 
Prediction Loss: 0.001215
Epoch 5949 
Prediction Loss: 0.001247
Epoch 5999 
Prediction Loss: 0.000950
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.044506
Insample Error 0.217306
Ours, Train RMSE
0.0630, 
0.0732, 
0.0863, 
0.0744, 
0.0595, 
CEVAE, Train RMSE
0.2412, 
0.3223, 
0.3897, 
0.3953, 
0.2930, 
Ours, Insample RMSE
0.2270, 
0.2230, 
0.2373, 
0.2111, 
0.2093, 
CEVAE, Insample RMSE
3.5582, 
3.3782, 
2.7698, 
6.8899, 
3.3782, 
Direct Regression, Insample RMSE
0.1431, 
0.2460, 
0.1819, 
0.2163, 
0.2173, 
Train, RMSE mean 0.0713 std 0.0095
CEVAE, RMSE mean 0.3283 std 0.0585
Ours, RMSE mean 0.2215 std 0.0104, reconstruct confounder 0.0139 (0.0010) noise 10.1164 (0.0513)
CEVAE, RMSE mean 3.9949 std 1.4720, reconstruct confounder 2.2345 (0.0552) noise 0.0008 (0.0003)
Direct Regression, RMSE mean 0.2009 std 0.0354
