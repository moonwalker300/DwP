Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=4, mask=0, nlayer=50, obsm=1, stop=2000, ycof=0.5, ylayer=50)
Y Mean 0.467551, Std 3.004609 
Test Y Mean 0.015136, Std 2.801871 
Observe confounder 1, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.912975
Rec Loss: 10.756575
KL Loss: 2.156399
Y Loss: 1.044206
T Loss: 10.234473
Epoch 99 
Overall Loss: 12.579797
Rec Loss: 10.179675
KL Loss: 2.400122
Y Loss: 1.059132
T Loss: 9.650109
Epoch 149 
Overall Loss: 12.470316
Rec Loss: 10.188650
KL Loss: 2.281666
Y Loss: 1.117570
T Loss: 9.629865
Epoch 199 
Overall Loss: 12.374603
Rec Loss: 10.184751
KL Loss: 2.189852
Y Loss: 1.077670
T Loss: 9.645916
Epoch 249 
Overall Loss: 12.338468
Rec Loss: 10.164390
KL Loss: 2.174078
Y Loss: 1.031686
T Loss: 9.648547
Epoch 299 
Overall Loss: 12.291363
Rec Loss: 10.118023
KL Loss: 2.173340
Y Loss: 1.030782
T Loss: 9.602632
Epoch 349 
Overall Loss: 12.291722
Rec Loss: 10.144400
KL Loss: 2.147322
Y Loss: 0.997692
T Loss: 9.645555
Epoch 399 
Overall Loss: 12.293033
Rec Loss: 10.125204
KL Loss: 2.167829
Y Loss: 1.009585
T Loss: 9.620412
Epoch 449 
Overall Loss: 12.267036
Rec Loss: 10.124037
KL Loss: 2.142999
Y Loss: 0.991521
T Loss: 9.628277
Epoch 499 
Overall Loss: 12.260481
Rec Loss: 10.088921
KL Loss: 2.171560
Y Loss: 0.960447
T Loss: 9.608697
Epoch 549 
Overall Loss: 12.259629
Rec Loss: 10.081814
KL Loss: 2.177815
Y Loss: 0.952726
T Loss: 9.605451
Epoch 599 
Overall Loss: 12.243766
Rec Loss: 10.081654
KL Loss: 2.162111
Y Loss: 0.937579
T Loss: 9.612865
Epoch 649 
Overall Loss: 12.258548
Rec Loss: 10.086298
KL Loss: 2.172250
Y Loss: 0.970437
T Loss: 9.601080
Epoch 699 
Overall Loss: 12.242986
Rec Loss: 10.077027
KL Loss: 2.165959
Y Loss: 0.928618
T Loss: 9.612718
Epoch 749 
Overall Loss: 12.219820
Rec Loss: 10.073329
KL Loss: 2.146490
Y Loss: 0.939754
T Loss: 9.603453
Epoch 799 
Overall Loss: 12.234128
Rec Loss: 10.089818
KL Loss: 2.144310
Y Loss: 0.942886
T Loss: 9.618375
Epoch 849 
Overall Loss: 12.213067
Rec Loss: 10.059776
KL Loss: 2.153290
Y Loss: 0.902053
T Loss: 9.608750
Epoch 899 
Overall Loss: 12.213979
Rec Loss: 10.046825
KL Loss: 2.167155
Y Loss: 0.922532
T Loss: 9.585559
Epoch 949 
Overall Loss: 12.203630
Rec Loss: 10.033523
KL Loss: 2.170107
Y Loss: 0.921407
T Loss: 9.572819
Epoch 999 
Overall Loss: 12.224690
Rec Loss: 10.049407
KL Loss: 2.175282
Y Loss: 0.930664
T Loss: 9.584076
Epoch 1049 
Overall Loss: 12.202582
Rec Loss: 10.042181
KL Loss: 2.160401
Y Loss: 0.901753
T Loss: 9.591304
Epoch 1099 
Overall Loss: 12.224722
Rec Loss: 10.058945
KL Loss: 2.165777
Y Loss: 0.929947
T Loss: 9.593971
Epoch 1149 
Overall Loss: 12.218664
Rec Loss: 10.007982
KL Loss: 2.210681
Y Loss: 0.909620
T Loss: 9.553172
Epoch 1199 
Overall Loss: 12.205405
Rec Loss: 10.036690
KL Loss: 2.168715
Y Loss: 0.918422
T Loss: 9.577479
Epoch 1249 
Overall Loss: 12.198175
Rec Loss: 10.029464
KL Loss: 2.168711
Y Loss: 0.925381
T Loss: 9.566773
Epoch 1299 
Overall Loss: 12.204767
Rec Loss: 10.020581
KL Loss: 2.184186
Y Loss: 0.897187
T Loss: 9.571987
Epoch 1349 
Overall Loss: 12.218705
Rec Loss: 10.024931
KL Loss: 2.193774
Y Loss: 0.903708
T Loss: 9.573077
Epoch 1399 
Overall Loss: 12.217225
Rec Loss: 10.034893
KL Loss: 2.182332
Y Loss: 0.920704
T Loss: 9.574541
Epoch 1449 
Overall Loss: 12.193439
Rec Loss: 9.983139
KL Loss: 2.210299
Y Loss: 0.898344
T Loss: 9.533967
Epoch 1499 
Overall Loss: 12.162903
Rec Loss: 9.972108
KL Loss: 2.190794
Y Loss: 0.898015
T Loss: 9.523101
Epoch 1549 
Overall Loss: 12.192275
Rec Loss: 9.981324
KL Loss: 2.210951
Y Loss: 0.880959
T Loss: 9.540844
Epoch 1599 
Overall Loss: 12.202733
Rec Loss: 10.007643
KL Loss: 2.195091
Y Loss: 0.916678
T Loss: 9.549304
Epoch 1649 
Overall Loss: 12.200730
Rec Loss: 9.979695
KL Loss: 2.221035
Y Loss: 0.887832
T Loss: 9.535779
Epoch 1699 
Overall Loss: 12.168719
Rec Loss: 9.994296
KL Loss: 2.174422
Y Loss: 0.910670
T Loss: 9.538961
Epoch 1749 
Overall Loss: 12.165023
Rec Loss: 9.999122
KL Loss: 2.165901
Y Loss: 0.907202
T Loss: 9.545521
Epoch 1799 
Overall Loss: 12.175467
Rec Loss: 9.967802
KL Loss: 2.207666
Y Loss: 0.868615
T Loss: 9.533494
Epoch 1849 
Overall Loss: 12.182307
Rec Loss: 9.969076
KL Loss: 2.213231
Y Loss: 0.887343
T Loss: 9.525404
Epoch 1899 
Overall Loss: 12.193301
Rec Loss: 9.999889
KL Loss: 2.193412
Y Loss: 0.907864
T Loss: 9.545957
Epoch 1949 
Overall Loss: 12.187695
Rec Loss: 10.005491
KL Loss: 2.182204
Y Loss: 0.893213
T Loss: 9.558885
Epoch 1999 
Overall Loss: 12.183726
Rec Loss: 10.013662
KL Loss: 2.170063
Y Loss: 0.903579
T Loss: 9.561874
Epoch 2049 
Overall Loss: 12.165543
Rec Loss: 9.994193
KL Loss: 2.171350
Y Loss: 0.880408
T Loss: 9.553989
Epoch 2099 
Overall Loss: 12.157941
Rec Loss: 9.981668
KL Loss: 2.176274
Y Loss: 0.907821
T Loss: 9.527757
Epoch 2149 
Overall Loss: 12.183250
Rec Loss: 9.987386
KL Loss: 2.195864
Y Loss: 0.911059
T Loss: 9.531856
Epoch 2199 
Overall Loss: 12.177806
Rec Loss: 9.984500
KL Loss: 2.193306
Y Loss: 0.875569
T Loss: 9.546715
Epoch 2249 
Overall Loss: 12.205467
Rec Loss: 9.995759
KL Loss: 2.209708
Y Loss: 0.909250
T Loss: 9.541134
Epoch 2299 
Overall Loss: 12.194228
Rec Loss: 10.028485
KL Loss: 2.165743
Y Loss: 0.909595
T Loss: 9.573687
Epoch 2349 
Overall Loss: 12.160795
Rec Loss: 9.973894
KL Loss: 2.186901
Y Loss: 0.873012
T Loss: 9.537388
Epoch 2399 
Overall Loss: 12.173775
Rec Loss: 10.004861
KL Loss: 2.168915
Y Loss: 0.914792
T Loss: 9.547465
Epoch 2449 
Overall Loss: 12.164097
Rec Loss: 9.962410
KL Loss: 2.201687
Y Loss: 0.889550
T Loss: 9.517634
Epoch 2499 
Overall Loss: 12.177335
Rec Loss: 9.956531
KL Loss: 2.220803
Y Loss: 0.879038
T Loss: 9.517012
Epoch 2549 
Overall Loss: 12.141217
Rec Loss: 9.974849
KL Loss: 2.166368
Y Loss: 0.888186
T Loss: 9.530756
Epoch 2599 
Overall Loss: 12.141010
Rec Loss: 9.973759
KL Loss: 2.167251
Y Loss: 0.875006
T Loss: 9.536256
Epoch 2649 
Overall Loss: 12.166380
Rec Loss: 9.981744
KL Loss: 2.184636
Y Loss: 0.898458
T Loss: 9.532515
Epoch 2699 
Overall Loss: 12.176607
Rec Loss: 10.013450
KL Loss: 2.163158
Y Loss: 0.910707
T Loss: 9.558096
Epoch 2749 
Overall Loss: 12.139905
Rec Loss: 9.942037
KL Loss: 2.197867
Y Loss: 0.885100
T Loss: 9.499488
Epoch 2799 
Overall Loss: 12.130746
Rec Loss: 9.963580
KL Loss: 2.167166
Y Loss: 0.894439
T Loss: 9.516361
Epoch 2849 
Overall Loss: 12.167261
Rec Loss: 9.968313
KL Loss: 2.198949
Y Loss: 0.900361
T Loss: 9.518132
Epoch 2899 
Overall Loss: 12.157622
Rec Loss: 9.966863
KL Loss: 2.190760
Y Loss: 0.868984
T Loss: 9.532370
Epoch 2949 
Overall Loss: 12.174731
Rec Loss: 10.015514
KL Loss: 2.159217
Y Loss: 0.911078
T Loss: 9.559975
Epoch 2999 
Overall Loss: 12.153904
Rec Loss: 9.977611
KL Loss: 2.176293
Y Loss: 0.878755
T Loss: 9.538233
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.415100
Epoch 99
Rec Loss: 1.412348
Epoch 149
Rec Loss: 1.427775
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.743965
Epoch 99
Rec Loss: 9.737730
Epoch 149
Rec Loss: 9.736268
Epoch 199
Rec Loss: 9.740371
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.752546
Insample Error: 2.609009
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.072917
Epoch 99
Rec Loss: 4.073274
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 8.664068
Epoch 99
Rec Loss: 8.582744
Epoch 149
Rec Loss: 8.652965
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.964182
Insample Error 2.802641
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.494269
Epoch 99 
Prediction Loss: 2.212657
Epoch 149 
Prediction Loss: 2.096943
Epoch 199 
Prediction Loss: 2.053499
Epoch 249 
Prediction Loss: 2.011340
Epoch 299 
Prediction Loss: 1.989120
Epoch 349 
Prediction Loss: 1.974798
Epoch 399 
Prediction Loss: 1.966968
Epoch 449 
Prediction Loss: 1.944337
Epoch 499 
Prediction Loss: 1.925271
Epoch 549 
Prediction Loss: 1.912938
Epoch 599 
Prediction Loss: 1.908869
Epoch 649 
Prediction Loss: 1.910117
Epoch 699 
Prediction Loss: 1.901906
Epoch 749 
Prediction Loss: 1.882424
Epoch 799 
Prediction Loss: 1.861727
Epoch 849 
Prediction Loss: 1.859005
Epoch 899 
Prediction Loss: 1.844190
Epoch 949 
Prediction Loss: 1.831207
Epoch 999 
Prediction Loss: 1.829117
Epoch 1049 
Prediction Loss: 1.804741
Epoch 1099 
Prediction Loss: 1.812093
Epoch 1149 
Prediction Loss: 1.795078
Epoch 1199 
Prediction Loss: 1.810781
Epoch 1249 
Prediction Loss: 1.770396
Epoch 1299 
Prediction Loss: 1.759980
Epoch 1349 
Prediction Loss: 1.755664
Epoch 1399 
Prediction Loss: 1.753581
Epoch 1449 
Prediction Loss: 1.758785
Epoch 1499 
Prediction Loss: 1.722361
Epoch 1549 
Prediction Loss: 1.709685
Epoch 1599 
Prediction Loss: 1.711246
Epoch 1649 
Prediction Loss: 1.696791
Epoch 1699 
Prediction Loss: 1.685214
Epoch 1749 
Prediction Loss: 1.676090
Epoch 1799 
Prediction Loss: 1.667429
Epoch 1849 
Prediction Loss: 1.675170
Epoch 1899 
Prediction Loss: 1.652836
Epoch 1949 
Prediction Loss: 1.639730
Epoch 1999 
Prediction Loss: 1.642464
Epoch 2049 
Prediction Loss: 1.628531
Epoch 2099 
Prediction Loss: 1.611239
Epoch 2149 
Prediction Loss: 1.615514
Epoch 2199 
Prediction Loss: 1.619276
Epoch 2249 
Prediction Loss: 1.595588
Epoch 2299 
Prediction Loss: 1.595035
Epoch 2349 
Prediction Loss: 1.571135
Epoch 2399 
Prediction Loss: 1.582151
Epoch 2449 
Prediction Loss: 1.561560
Epoch 2499 
Prediction Loss: 1.559481
Epoch 2549 
Prediction Loss: 1.550543
Epoch 2599 
Prediction Loss: 1.560836
Epoch 2649 
Prediction Loss: 1.533405
Epoch 2699 
Prediction Loss: 1.522297
Epoch 2749 
Prediction Loss: 1.528015
Epoch 2799 
Prediction Loss: 1.529704
Epoch 2849 
Prediction Loss: 1.511896
Epoch 2899 
Prediction Loss: 1.510559
Epoch 2949 
Prediction Loss: 1.507266
Epoch 2999 
Prediction Loss: 1.489482
Epoch 3049 
Prediction Loss: 1.471031
Epoch 3099 
Prediction Loss: 1.482058
Epoch 3149 
Prediction Loss: 1.478495
Epoch 3199 
Prediction Loss: 1.463255
Epoch 3249 
Prediction Loss: 1.459363
Epoch 3299 
Prediction Loss: 1.449802
Epoch 3349 
Prediction Loss: 1.450703
Epoch 3399 
Prediction Loss: 1.440093
Epoch 3449 
Prediction Loss: 1.433411
Epoch 3499 
Prediction Loss: 1.423425
Epoch 3549 
Prediction Loss: 1.414671
Epoch 3599 
Prediction Loss: 1.433357
Epoch 3649 
Prediction Loss: 1.411892
Epoch 3699 
Prediction Loss: 1.401621
Epoch 3749 
Prediction Loss: 1.409181
Epoch 3799 
Prediction Loss: 1.386270
Epoch 3849 
Prediction Loss: 1.379186
Epoch 3899 
Prediction Loss: 1.379420
Epoch 3949 
Prediction Loss: 1.387092
Epoch 3999 
Prediction Loss: 1.364341
Epoch 4049 
Prediction Loss: 1.360946
Epoch 4099 
Prediction Loss: 1.351849
Epoch 4149 
Prediction Loss: 1.352613
Epoch 4199 
Prediction Loss: 1.347712
Epoch 4249 
Prediction Loss: 1.356018
Epoch 4299 
Prediction Loss: 1.336822
Epoch 4349 
Prediction Loss: 1.334683
Epoch 4399 
Prediction Loss: 1.319882
Epoch 4449 
Prediction Loss: 1.319138
Epoch 4499 
Prediction Loss: 1.310706
Epoch 4549 
Prediction Loss: 1.313192
Epoch 4599 
Prediction Loss: 1.303955
Epoch 4649 
Prediction Loss: 1.323905
Epoch 4699 
Prediction Loss: 1.317241
Epoch 4749 
Prediction Loss: 1.300025
Epoch 4799 
Prediction Loss: 1.287475
Epoch 4849 
Prediction Loss: 1.285596
Epoch 4899 
Prediction Loss: 1.281254
Epoch 4949 
Prediction Loss: 1.281054
Epoch 4999 
Prediction Loss: 1.296724
Epoch 5049 
Prediction Loss: 1.280870
Epoch 5099 
Prediction Loss: 1.265180
Epoch 5149 
Prediction Loss: 1.259075
Epoch 5199 
Prediction Loss: 1.252088
Epoch 5249 
Prediction Loss: 1.245985
Epoch 5299 
Prediction Loss: 1.255480
Epoch 5349 
Prediction Loss: 1.245000
Epoch 5399 
Prediction Loss: 1.234465
Epoch 5449 
Prediction Loss: 1.248888
Epoch 5499 
Prediction Loss: 1.237165
Epoch 5549 
Prediction Loss: 1.225219
Epoch 5599 
Prediction Loss: 1.214901
Epoch 5649 
Prediction Loss: 1.222403
Epoch 5699 
Prediction Loss: 1.227562
Epoch 5749 
Prediction Loss: 1.233326
Epoch 5799 
Prediction Loss: 1.209077
Epoch 5849 
Prediction Loss: 1.224350
Epoch 5899 
Prediction Loss: 1.199688
Epoch 5949 
Prediction Loss: 1.198537
Epoch 5999 
Prediction Loss: 1.197133
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.087553
Insample Error 2.951941
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.715220
Rec Loss: 10.251026
KL Loss: 2.464194
Y Loss: 1.053586
T Loss: 9.724233
Epoch 99 
Overall Loss: 12.529714
Rec Loss: 10.199736
KL Loss: 2.329979
Y Loss: 1.082357
T Loss: 9.658557
Epoch 149 
Overall Loss: 12.434245
Rec Loss: 10.212492
KL Loss: 2.221752
Y Loss: 1.073675
T Loss: 9.675654
Epoch 199 
Overall Loss: 12.339088
Rec Loss: 10.182252
KL Loss: 2.156837
Y Loss: 1.057185
T Loss: 9.653659
Epoch 249 
Overall Loss: 12.337923
Rec Loss: 10.155052
KL Loss: 2.182871
Y Loss: 1.024707
T Loss: 9.642699
Epoch 299 
Overall Loss: 12.361155
Rec Loss: 10.138772
KL Loss: 2.222383
Y Loss: 1.031110
T Loss: 9.623217
Epoch 349 
Overall Loss: 12.307003
Rec Loss: 10.138255
KL Loss: 2.168748
Y Loss: 0.998569
T Loss: 9.638971
Epoch 399 
Overall Loss: 12.295490
Rec Loss: 10.116959
KL Loss: 2.178530
Y Loss: 0.992736
T Loss: 9.620591
Epoch 449 
Overall Loss: 12.256489
Rec Loss: 10.069414
KL Loss: 2.187075
Y Loss: 0.953732
T Loss: 9.592548
Epoch 499 
Overall Loss: 12.258351
Rec Loss: 10.109299
KL Loss: 2.149052
Y Loss: 0.953826
T Loss: 9.632386
Epoch 549 
Overall Loss: 12.255320
Rec Loss: 10.061442
KL Loss: 2.193878
Y Loss: 0.950567
T Loss: 9.586159
Epoch 599 
Overall Loss: 12.268738
Rec Loss: 10.084711
KL Loss: 2.184026
Y Loss: 0.918983
T Loss: 9.625219
Epoch 649 
Overall Loss: 12.259002
Rec Loss: 10.104149
KL Loss: 2.154853
Y Loss: 0.949323
T Loss: 9.629487
Epoch 699 
Overall Loss: 12.249806
Rec Loss: 10.096844
KL Loss: 2.152962
Y Loss: 0.956084
T Loss: 9.618802
Epoch 749 
Overall Loss: 12.228158
Rec Loss: 10.080353
KL Loss: 2.147804
Y Loss: 0.984491
T Loss: 9.588108
Epoch 799 
Overall Loss: 12.255454
Rec Loss: 10.081178
KL Loss: 2.174276
Y Loss: 0.942403
T Loss: 9.609976
Epoch 849 
Overall Loss: 12.221671
Rec Loss: 10.040102
KL Loss: 2.181570
Y Loss: 0.919741
T Loss: 9.580231
Epoch 899 
Overall Loss: 12.247985
Rec Loss: 10.081009
KL Loss: 2.166975
Y Loss: 0.922482
T Loss: 9.619768
Epoch 949 
Overall Loss: 12.254639
Rec Loss: 10.052806
KL Loss: 2.201833
Y Loss: 0.906222
T Loss: 9.599694
Epoch 999 
Overall Loss: 12.230615
Rec Loss: 10.021997
KL Loss: 2.208618
Y Loss: 0.898975
T Loss: 9.572509
Epoch 1049 
Overall Loss: 12.203087
Rec Loss: 10.050743
KL Loss: 2.152344
Y Loss: 0.922443
T Loss: 9.589522
Epoch 1099 
Overall Loss: 12.216605
Rec Loss: 10.046224
KL Loss: 2.170381
Y Loss: 0.908299
T Loss: 9.592074
Epoch 1149 
Overall Loss: 12.187710
Rec Loss: 10.018710
KL Loss: 2.169000
Y Loss: 0.893172
T Loss: 9.572123
Epoch 1199 
Overall Loss: 12.216111
Rec Loss: 10.035841
KL Loss: 2.180270
Y Loss: 0.906168
T Loss: 9.582758
Epoch 1249 
Overall Loss: 12.204693
Rec Loss: 10.010218
KL Loss: 2.194475
Y Loss: 0.896753
T Loss: 9.561842
Epoch 1299 
Overall Loss: 12.209268
Rec Loss: 10.029019
KL Loss: 2.180248
Y Loss: 0.895946
T Loss: 9.581047
Epoch 1349 
Overall Loss: 12.206241
Rec Loss: 10.030886
KL Loss: 2.175355
Y Loss: 0.894046
T Loss: 9.583863
Epoch 1399 
Overall Loss: 12.212381
Rec Loss: 10.027427
KL Loss: 2.184954
Y Loss: 0.891830
T Loss: 9.581512
Epoch 1449 
Overall Loss: 12.215843
Rec Loss: 10.003927
KL Loss: 2.211917
Y Loss: 0.891852
T Loss: 9.558001
Epoch 1499 
Overall Loss: 12.194851
Rec Loss: 9.965808
KL Loss: 2.229043
Y Loss: 0.865937
T Loss: 9.532840
Epoch 1549 
Overall Loss: 12.222227
Rec Loss: 10.015333
KL Loss: 2.206894
Y Loss: 0.890279
T Loss: 9.570194
Epoch 1599 
Overall Loss: 12.199099
Rec Loss: 10.019820
KL Loss: 2.179280
Y Loss: 0.879796
T Loss: 9.579922
Epoch 1649 
Overall Loss: 12.200297
Rec Loss: 10.014615
KL Loss: 2.185682
Y Loss: 0.892227
T Loss: 9.568502
Epoch 1699 
Overall Loss: 12.199169
Rec Loss: 10.004092
KL Loss: 2.195077
Y Loss: 0.874448
T Loss: 9.566868
Epoch 1749 
Overall Loss: 12.191622
Rec Loss: 9.988778
KL Loss: 2.202845
Y Loss: 0.873991
T Loss: 9.551783
Epoch 1799 
Overall Loss: 12.166836
Rec Loss: 9.980171
KL Loss: 2.186665
Y Loss: 0.897875
T Loss: 9.531234
Epoch 1849 
Overall Loss: 12.189509
Rec Loss: 9.991104
KL Loss: 2.198405
Y Loss: 0.889708
T Loss: 9.546250
Epoch 1899 
Overall Loss: 12.169563
Rec Loss: 9.988500
KL Loss: 2.181064
Y Loss: 0.887638
T Loss: 9.544680
Epoch 1949 
Overall Loss: 12.171368
Rec Loss: 9.994225
KL Loss: 2.177143
Y Loss: 0.903710
T Loss: 9.542370
Epoch 1999 
Overall Loss: 12.177543
Rec Loss: 10.003690
KL Loss: 2.173853
Y Loss: 0.906164
T Loss: 9.550608
Epoch 2049 
Overall Loss: 12.182418
Rec Loss: 9.974163
KL Loss: 2.208254
Y Loss: 0.875033
T Loss: 9.536647
Epoch 2099 
Overall Loss: 12.174030
Rec Loss: 9.974979
KL Loss: 2.199052
Y Loss: 0.884127
T Loss: 9.532915
Epoch 2149 
Overall Loss: 12.190309
Rec Loss: 9.979855
KL Loss: 2.210454
Y Loss: 0.873712
T Loss: 9.542999
Epoch 2199 
Overall Loss: 12.171063
Rec Loss: 9.970641
KL Loss: 2.200422
Y Loss: 0.883240
T Loss: 9.529021
Epoch 2249 
Overall Loss: 12.176661
Rec Loss: 9.979507
KL Loss: 2.197154
Y Loss: 0.883853
T Loss: 9.537580
Epoch 2299 
Overall Loss: 12.148789
Rec Loss: 9.980662
KL Loss: 2.168127
Y Loss: 0.892115
T Loss: 9.534604
Epoch 2349 
Overall Loss: 12.175208
Rec Loss: 9.966765
KL Loss: 2.208444
Y Loss: 0.870608
T Loss: 9.531461
Epoch 2399 
Overall Loss: 12.174830
Rec Loss: 9.986538
KL Loss: 2.188292
Y Loss: 0.873049
T Loss: 9.550014
Epoch 2449 
Overall Loss: 12.176983
Rec Loss: 10.002731
KL Loss: 2.174251
Y Loss: 0.902141
T Loss: 9.551661
Epoch 2499 
Overall Loss: 12.188562
Rec Loss: 9.983327
KL Loss: 2.205235
Y Loss: 0.878453
T Loss: 9.544101
Epoch 2549 
Overall Loss: 12.183553
Rec Loss: 9.955070
KL Loss: 2.228483
Y Loss: 0.869488
T Loss: 9.520326
Epoch 2599 
Overall Loss: 12.176681
Rec Loss: 9.985133
KL Loss: 2.191549
Y Loss: 0.883937
T Loss: 9.543164
Epoch 2649 
Overall Loss: 12.179864
Rec Loss: 9.982049
KL Loss: 2.197816
Y Loss: 0.887680
T Loss: 9.538209
Epoch 2699 
Overall Loss: 12.190451
Rec Loss: 10.014970
KL Loss: 2.175481
Y Loss: 0.904854
T Loss: 9.562542
Epoch 2749 
Overall Loss: 12.166453
Rec Loss: 9.963115
KL Loss: 2.203337
Y Loss: 0.897412
T Loss: 9.514409
Epoch 2799 
Overall Loss: 12.170810
Rec Loss: 9.961072
KL Loss: 2.209737
Y Loss: 0.882880
T Loss: 9.519633
Epoch 2849 
Overall Loss: 12.145748
Rec Loss: 9.959146
KL Loss: 2.186603
Y Loss: 0.886607
T Loss: 9.515842
Epoch 2899 
Overall Loss: 12.135311
Rec Loss: 9.968912
KL Loss: 2.166399
Y Loss: 0.868035
T Loss: 9.534895
Epoch 2949 
Overall Loss: 12.144641
Rec Loss: 9.969542
KL Loss: 2.175099
Y Loss: 0.893738
T Loss: 9.522673
Epoch 2999 
Overall Loss: 12.140718
Rec Loss: 9.946395
KL Loss: 2.194323
Y Loss: 0.886811
T Loss: 9.502990
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.409746
Epoch 99
Rec Loss: 1.396558
Epoch 149
Rec Loss: 1.400122
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.753637
Epoch 99
Rec Loss: 9.747108
Epoch 149
Rec Loss: 9.742134
Epoch 199
Rec Loss: 9.745466
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.727537
Insample Error: 2.598776
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.072655
Epoch 99
Rec Loss: 4.069209
Epoch 149
Rec Loss: 4.069995
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.069664
Epoch 99
Rec Loss: 9.096027
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.967749
Insample Error 2.809296
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.568444
Epoch 99 
Prediction Loss: 2.224168
Epoch 149 
Prediction Loss: 2.102381
Epoch 199 
Prediction Loss: 2.035911
Epoch 249 
Prediction Loss: 2.015547
Epoch 299 
Prediction Loss: 1.990790
Epoch 349 
Prediction Loss: 1.965004
Epoch 399 
Prediction Loss: 1.955389
Epoch 449 
Prediction Loss: 1.938086
Epoch 499 
Prediction Loss: 1.922363
Epoch 549 
Prediction Loss: 1.932036
Epoch 599 
Prediction Loss: 1.888314
Epoch 649 
Prediction Loss: 1.879084
Epoch 699 
Prediction Loss: 1.868027
Epoch 749 
Prediction Loss: 1.868474
Epoch 799 
Prediction Loss: 1.839822
Epoch 849 
Prediction Loss: 1.820363
Epoch 899 
Prediction Loss: 1.822858
Epoch 949 
Prediction Loss: 1.809512
Epoch 999 
Prediction Loss: 1.800002
Epoch 1049 
Prediction Loss: 1.790785
Epoch 1099 
Prediction Loss: 1.774083
Epoch 1149 
Prediction Loss: 1.775395
Epoch 1199 
Prediction Loss: 1.762205
Epoch 1249 
Prediction Loss: 1.746747
Epoch 1299 
Prediction Loss: 1.761123
Epoch 1349 
Prediction Loss: 1.724966
Epoch 1399 
Prediction Loss: 1.720636
Epoch 1449 
Prediction Loss: 1.742529
Epoch 1499 
Prediction Loss: 1.703412
Epoch 1549 
Prediction Loss: 1.694976
Epoch 1599 
Prediction Loss: 1.675627
Epoch 1649 
Prediction Loss: 1.689982
Epoch 1699 
Prediction Loss: 1.665850
Epoch 1749 
Prediction Loss: 1.662113
Epoch 1799 
Prediction Loss: 1.634510
Epoch 1849 
Prediction Loss: 1.647899
Epoch 1899 
Prediction Loss: 1.632133
Epoch 1949 
Prediction Loss: 1.618778
Epoch 1999 
Prediction Loss: 1.600404
Epoch 2049 
Prediction Loss: 1.595496
Epoch 2099 
Prediction Loss: 1.600766
Epoch 2149 
Prediction Loss: 1.592279
Epoch 2199 
Prediction Loss: 1.590375
Epoch 2249 
Prediction Loss: 1.560136
Epoch 2299 
Prediction Loss: 1.567052
Epoch 2349 
Prediction Loss: 1.550466
Epoch 2399 
Prediction Loss: 1.541915
Epoch 2449 
Prediction Loss: 1.541136
Epoch 2499 
Prediction Loss: 1.539424
Epoch 2549 
Prediction Loss: 1.514411
Epoch 2599 
Prediction Loss: 1.506339
Epoch 2649 
Prediction Loss: 1.516379
Epoch 2699 
Prediction Loss: 1.496899
Epoch 2749 
Prediction Loss: 1.486872
Epoch 2799 
Prediction Loss: 1.499896
Epoch 2849 
Prediction Loss: 1.480598
Epoch 2899 
Prediction Loss: 1.466117
Epoch 2949 
Prediction Loss: 1.456471
Epoch 2999 
Prediction Loss: 1.443893
Epoch 3049 
Prediction Loss: 1.460797
Epoch 3099 
Prediction Loss: 1.431460
Epoch 3149 
Prediction Loss: 1.439187
Epoch 3199 
Prediction Loss: 1.426639
Epoch 3249 
Prediction Loss: 1.416536
Epoch 3299 
Prediction Loss: 1.416244
Epoch 3349 
Prediction Loss: 1.419482
Epoch 3399 
Prediction Loss: 1.406906
Epoch 3449 
Prediction Loss: 1.386796
Epoch 3499 
Prediction Loss: 1.401476
Epoch 3549 
Prediction Loss: 1.389368
Epoch 3599 
Prediction Loss: 1.373504
Epoch 3649 
Prediction Loss: 1.379984
Epoch 3699 
Prediction Loss: 1.364855
Epoch 3749 
Prediction Loss: 1.356485
Epoch 3799 
Prediction Loss: 1.361659
Epoch 3849 
Prediction Loss: 1.344473
Epoch 3899 
Prediction Loss: 1.364842
Epoch 3949 
Prediction Loss: 1.343615
Epoch 3999 
Prediction Loss: 1.340996
Epoch 4049 
Prediction Loss: 1.345230
Epoch 4099 
Prediction Loss: 1.327111
Epoch 4149 
Prediction Loss: 1.323252
Epoch 4199 
Prediction Loss: 1.319430
Epoch 4249 
Prediction Loss: 1.302276
Epoch 4299 
Prediction Loss: 1.301545
Epoch 4349 
Prediction Loss: 1.310067
Epoch 4399 
Prediction Loss: 1.310081
Epoch 4449 
Prediction Loss: 1.285355
Epoch 4499 
Prediction Loss: 1.289144
Epoch 4549 
Prediction Loss: 1.281689
Epoch 4599 
Prediction Loss: 1.274108
Epoch 4649 
Prediction Loss: 1.274778
Epoch 4699 
Prediction Loss: 1.277703
Epoch 4749 
Prediction Loss: 1.285638
Epoch 4799 
Prediction Loss: 1.274808
Epoch 4849 
Prediction Loss: 1.256074
Epoch 4899 
Prediction Loss: 1.264048
Epoch 4949 
Prediction Loss: 1.270231
Epoch 4999 
Prediction Loss: 1.251794
Epoch 5049 
Prediction Loss: 1.251375
Epoch 5099 
Prediction Loss: 1.264916
Epoch 5149 
Prediction Loss: 1.235180
Epoch 5199 
Prediction Loss: 1.236548
Epoch 5249 
Prediction Loss: 1.233506
Epoch 5299 
Prediction Loss: 1.234582
Epoch 5349 
Prediction Loss: 1.215252
Epoch 5399 
Prediction Loss: 1.219167
Epoch 5449 
Prediction Loss: 1.212864
Epoch 5499 
Prediction Loss: 1.218936
Epoch 5549 
Prediction Loss: 1.241836
Epoch 5599 
Prediction Loss: 1.197556
Epoch 5649 
Prediction Loss: 1.218878
Epoch 5699 
Prediction Loss: 1.204077
Epoch 5749 
Prediction Loss: 1.196029
Epoch 5799 
Prediction Loss: 1.192873
Epoch 5849 
Prediction Loss: 1.191435
Epoch 5899 
Prediction Loss: 1.187857
Epoch 5949 
Prediction Loss: 1.191720
Epoch 5999 
Prediction Loss: 1.189055
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.082826
Insample Error 2.961070
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.720178
Rec Loss: 10.223659
KL Loss: 2.496518
Y Loss: 1.011768
T Loss: 9.717776
Epoch 99 
Overall Loss: 12.553652
Rec Loss: 10.168756
KL Loss: 2.384897
Y Loss: 1.059555
T Loss: 9.638978
Epoch 149 
Overall Loss: 12.449091
Rec Loss: 10.207372
KL Loss: 2.241719
Y Loss: 1.102348
T Loss: 9.656198
Epoch 199 
Overall Loss: 12.374229
Rec Loss: 10.174359
KL Loss: 2.199871
Y Loss: 1.044397
T Loss: 9.652160
Epoch 249 
Overall Loss: 12.354154
Rec Loss: 10.162791
KL Loss: 2.191363
Y Loss: 1.024121
T Loss: 9.650730
Epoch 299 
Overall Loss: 12.320715
Rec Loss: 10.160800
KL Loss: 2.159915
Y Loss: 1.006458
T Loss: 9.657571
Epoch 349 
Overall Loss: 12.343928
Rec Loss: 10.129119
KL Loss: 2.214808
Y Loss: 0.995548
T Loss: 9.631345
Epoch 399 
Overall Loss: 12.307454
Rec Loss: 10.101630
KL Loss: 2.205824
Y Loss: 0.996044
T Loss: 9.603608
Epoch 449 
Overall Loss: 12.291263
Rec Loss: 10.112215
KL Loss: 2.179047
Y Loss: 0.983904
T Loss: 9.620263
Epoch 499 
Overall Loss: 12.282286
Rec Loss: 10.111035
KL Loss: 2.171251
Y Loss: 0.963177
T Loss: 9.629446
Epoch 549 
Overall Loss: 12.270375
Rec Loss: 10.079550
KL Loss: 2.190825
Y Loss: 0.932997
T Loss: 9.613051
Epoch 599 
Overall Loss: 12.277903
Rec Loss: 10.105382
KL Loss: 2.172521
Y Loss: 0.959402
T Loss: 9.625681
Epoch 649 
Overall Loss: 12.246728
Rec Loss: 10.085538
KL Loss: 2.161191
Y Loss: 0.968109
T Loss: 9.601484
Epoch 699 
Overall Loss: 12.266726
Rec Loss: 10.074648
KL Loss: 2.192078
Y Loss: 0.947691
T Loss: 9.600802
Epoch 749 
Overall Loss: 12.243722
Rec Loss: 10.068956
KL Loss: 2.174766
Y Loss: 0.937842
T Loss: 9.600035
Epoch 799 
Overall Loss: 12.226988
Rec Loss: 10.062435
KL Loss: 2.164553
Y Loss: 0.952455
T Loss: 9.586207
Epoch 849 
Overall Loss: 12.240338
Rec Loss: 10.073275
KL Loss: 2.167064
Y Loss: 0.926657
T Loss: 9.609946
Epoch 899 
Overall Loss: 12.224615
Rec Loss: 10.032917
KL Loss: 2.191698
Y Loss: 0.912404
T Loss: 9.576715
Epoch 949 
Overall Loss: 12.221398
Rec Loss: 10.054914
KL Loss: 2.166484
Y Loss: 0.935729
T Loss: 9.587049
Epoch 999 
Overall Loss: 12.227815
Rec Loss: 10.082846
KL Loss: 2.144969
Y Loss: 0.933742
T Loss: 9.615975
Epoch 1049 
Overall Loss: 12.235059
Rec Loss: 10.075124
KL Loss: 2.159935
Y Loss: 0.947736
T Loss: 9.601256
Epoch 1099 
Overall Loss: 12.208648
Rec Loss: 10.022908
KL Loss: 2.185740
Y Loss: 0.924293
T Loss: 9.560761
Epoch 1149 
Overall Loss: 12.229888
Rec Loss: 10.051072
KL Loss: 2.178815
Y Loss: 0.938435
T Loss: 9.581855
Epoch 1199 
Overall Loss: 12.217678
Rec Loss: 10.035867
KL Loss: 2.181811
Y Loss: 0.914807
T Loss: 9.578464
Epoch 1249 
Overall Loss: 12.217021
Rec Loss: 10.022613
KL Loss: 2.194408
Y Loss: 0.916187
T Loss: 9.564520
Epoch 1299 
Overall Loss: 12.203083
Rec Loss: 10.015816
KL Loss: 2.187267
Y Loss: 0.885448
T Loss: 9.573091
Epoch 1349 
Overall Loss: 12.209607
Rec Loss: 10.026504
KL Loss: 2.183103
Y Loss: 0.909773
T Loss: 9.571618
Epoch 1399 
Overall Loss: 12.183323
Rec Loss: 10.032751
KL Loss: 2.150572
Y Loss: 0.912965
T Loss: 9.576269
Epoch 1449 
Overall Loss: 12.210072
Rec Loss: 10.026481
KL Loss: 2.183591
Y Loss: 0.893328
T Loss: 9.579817
Epoch 1499 
Overall Loss: 12.196699
Rec Loss: 9.970565
KL Loss: 2.226134
Y Loss: 0.878322
T Loss: 9.531404
Epoch 1549 
Overall Loss: 12.198994
Rec Loss: 9.997595
KL Loss: 2.201399
Y Loss: 0.887064
T Loss: 9.554063
Epoch 1599 
Overall Loss: 12.199587
Rec Loss: 10.027348
KL Loss: 2.172239
Y Loss: 0.916270
T Loss: 9.569214
Epoch 1649 
Overall Loss: 12.185965
Rec Loss: 10.014487
KL Loss: 2.171478
Y Loss: 0.890536
T Loss: 9.569219
Epoch 1699 
Overall Loss: 12.182652
Rec Loss: 9.990950
KL Loss: 2.191702
Y Loss: 0.888429
T Loss: 9.546736
Epoch 1749 
Overall Loss: 12.199393
Rec Loss: 10.029169
KL Loss: 2.170224
Y Loss: 0.914356
T Loss: 9.571991
Epoch 1799 
Overall Loss: 12.201029
Rec Loss: 10.025561
KL Loss: 2.175468
Y Loss: 0.914441
T Loss: 9.568341
Epoch 1849 
Overall Loss: 12.199034
Rec Loss: 10.007638
KL Loss: 2.191396
Y Loss: 0.907059
T Loss: 9.554109
Epoch 1899 
Overall Loss: 12.178503
Rec Loss: 9.983924
KL Loss: 2.194579
Y Loss: 0.895649
T Loss: 9.536099
Epoch 1949 
Overall Loss: 12.194841
Rec Loss: 9.996186
KL Loss: 2.198655
Y Loss: 0.901800
T Loss: 9.545286
Epoch 1999 
Overall Loss: 12.188471
Rec Loss: 10.025078
KL Loss: 2.163394
Y Loss: 0.912906
T Loss: 9.568625
Epoch 2049 
Overall Loss: 12.180534
Rec Loss: 9.973355
KL Loss: 2.207179
Y Loss: 0.897808
T Loss: 9.524451
Epoch 2099 
Overall Loss: 12.191647
Rec Loss: 10.001943
KL Loss: 2.189704
Y Loss: 0.907005
T Loss: 9.548441
Epoch 2149 
Overall Loss: 12.152963
Rec Loss: 9.935661
KL Loss: 2.217302
Y Loss: 0.868475
T Loss: 9.501423
Epoch 2199 
Overall Loss: 12.195451
Rec Loss: 10.007778
KL Loss: 2.187673
Y Loss: 0.889414
T Loss: 9.563071
Epoch 2249 
Overall Loss: 12.181637
Rec Loss: 10.010267
KL Loss: 2.171369
Y Loss: 0.909983
T Loss: 9.555276
Epoch 2299 
Overall Loss: 12.180219
Rec Loss: 9.990538
KL Loss: 2.189682
Y Loss: 0.912169
T Loss: 9.534453
Epoch 2349 
Overall Loss: 12.178635
Rec Loss: 9.983551
KL Loss: 2.195083
Y Loss: 0.890161
T Loss: 9.538470
Epoch 2399 
Overall Loss: 12.171981
Rec Loss: 9.982419
KL Loss: 2.189562
Y Loss: 0.887802
T Loss: 9.538518
Epoch 2449 
Overall Loss: 12.159526
Rec Loss: 9.972141
KL Loss: 2.187384
Y Loss: 0.893278
T Loss: 9.525502
Epoch 2499 
Overall Loss: 12.163078
Rec Loss: 9.983972
KL Loss: 2.179107
Y Loss: 0.881965
T Loss: 9.542989
Epoch 2549 
Overall Loss: 12.173204
Rec Loss: 9.974854
KL Loss: 2.198349
Y Loss: 0.874778
T Loss: 9.537465
Epoch 2599 
Overall Loss: 12.167383
Rec Loss: 9.969964
KL Loss: 2.197418
Y Loss: 0.862274
T Loss: 9.538827
Epoch 2649 
Overall Loss: 12.193836
Rec Loss: 9.996253
KL Loss: 2.197583
Y Loss: 0.892011
T Loss: 9.550247
Epoch 2699 
Overall Loss: 12.154854
Rec Loss: 9.961074
KL Loss: 2.193781
Y Loss: 0.877862
T Loss: 9.522143
Epoch 2749 
Overall Loss: 12.183048
Rec Loss: 9.980732
KL Loss: 2.202316
Y Loss: 0.886960
T Loss: 9.537252
Epoch 2799 
Overall Loss: 12.163011
Rec Loss: 9.976212
KL Loss: 2.186799
Y Loss: 0.887925
T Loss: 9.532249
Epoch 2849 
Overall Loss: 12.188818
Rec Loss: 9.988827
KL Loss: 2.199990
Y Loss: 0.903290
T Loss: 9.537182
Epoch 2899 
Overall Loss: 12.164507
Rec Loss: 9.985740
KL Loss: 2.178768
Y Loss: 0.898314
T Loss: 9.536583
Epoch 2949 
Overall Loss: 12.184017
Rec Loss: 9.968642
KL Loss: 2.215375
Y Loss: 0.902400
T Loss: 9.517442
Epoch 2999 
Overall Loss: 12.141881
Rec Loss: 9.940393
KL Loss: 2.201488
Y Loss: 0.873131
T Loss: 9.503828
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.403924
Epoch 99
Rec Loss: 1.385495
Epoch 149
Rec Loss: 1.377198
Epoch 199
Rec Loss: 1.395139
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.743740
Epoch 99
Rec Loss: 9.731552
Epoch 149
Rec Loss: 9.738200
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.721266
Insample Error: 2.552712
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.056307
Epoch 99
Rec Loss: 4.050719
Epoch 149
Rec Loss: 4.050968
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.407461
Epoch 99
Rec Loss: 9.424804
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.973891
Insample Error 2.801868
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.431119
Epoch 99 
Prediction Loss: 2.170346
Epoch 149 
Prediction Loss: 2.098511
Epoch 199 
Prediction Loss: 2.062048
Epoch 249 
Prediction Loss: 2.053968
Epoch 299 
Prediction Loss: 2.029485
Epoch 349 
Prediction Loss: 2.012848
Epoch 399 
Prediction Loss: 2.020166
Epoch 449 
Prediction Loss: 2.023994
Epoch 499 
Prediction Loss: 1.986663
Epoch 549 
Prediction Loss: 1.991226
Epoch 599 
Prediction Loss: 1.974215
Epoch 649 
Prediction Loss: 1.989110
Epoch 699 
Prediction Loss: 1.966726
Epoch 749 
Prediction Loss: 1.958008
Epoch 799 
Prediction Loss: 1.961829
Epoch 849 
Prediction Loss: 1.941039
Epoch 899 
Prediction Loss: 1.931308
Epoch 949 
Prediction Loss: 1.912257
Epoch 999 
Prediction Loss: 1.910161
Epoch 1049 
Prediction Loss: 1.907223
Epoch 1099 
Prediction Loss: 1.905476
Epoch 1149 
Prediction Loss: 1.880349
Epoch 1199 
Prediction Loss: 1.875145
Epoch 1249 
Prediction Loss: 1.877918
Epoch 1299 
Prediction Loss: 1.875859
Epoch 1349 
Prediction Loss: 1.861135
Epoch 1399 
Prediction Loss: 1.859193
Epoch 1449 
Prediction Loss: 1.841057
Epoch 1499 
Prediction Loss: 1.862996
Epoch 1549 
Prediction Loss: 1.830707
Epoch 1599 
Prediction Loss: 1.844542
Epoch 1649 
Prediction Loss: 1.820204
Epoch 1699 
Prediction Loss: 1.816927
Epoch 1749 
Prediction Loss: 1.804884
Epoch 1799 
Prediction Loss: 1.800703
Epoch 1849 
Prediction Loss: 1.797028
Epoch 1899 
Prediction Loss: 1.799704
Epoch 1949 
Prediction Loss: 1.811098
Epoch 1999 
Prediction Loss: 1.785207
Epoch 2049 
Prediction Loss: 1.792785
Epoch 2099 
Prediction Loss: 1.772594
Epoch 2149 
Prediction Loss: 1.791253
Epoch 2199 
Prediction Loss: 1.786925
Epoch 2249 
Prediction Loss: 1.752751
Epoch 2299 
Prediction Loss: 1.745217
Epoch 2349 
Prediction Loss: 1.766583
Epoch 2399 
Prediction Loss: 1.773304
Epoch 2449 
Prediction Loss: 1.724788
Epoch 2499 
Prediction Loss: 1.747557
Epoch 2549 
Prediction Loss: 1.734595
Epoch 2599 
Prediction Loss: 1.721244
Epoch 2649 
Prediction Loss: 1.730793
Epoch 2699 
Prediction Loss: 1.699661
Epoch 2749 
Prediction Loss: 1.718975
Epoch 2799 
Prediction Loss: 1.700030
Epoch 2849 
Prediction Loss: 1.689661
Epoch 2899 
Prediction Loss: 1.690445
Epoch 2949 
Prediction Loss: 1.673086
Epoch 2999 
Prediction Loss: 1.681639
Epoch 3049 
Prediction Loss: 1.706041
Epoch 3099 
Prediction Loss: 1.678199
Epoch 3149 
Prediction Loss: 1.664175
Epoch 3199 
Prediction Loss: 1.657210
Epoch 3249 
Prediction Loss: 1.640923
Epoch 3299 
Prediction Loss: 1.655917
Epoch 3349 
Prediction Loss: 1.635727
Epoch 3399 
Prediction Loss: 1.636279
Epoch 3449 
Prediction Loss: 1.662584
Epoch 3499 
Prediction Loss: 1.637932
Epoch 3549 
Prediction Loss: 1.618103
Epoch 3599 
Prediction Loss: 1.611623
Epoch 3649 
Prediction Loss: 1.604203
Epoch 3699 
Prediction Loss: 1.617550
Epoch 3749 
Prediction Loss: 1.626666
Epoch 3799 
Prediction Loss: 1.606967
Epoch 3849 
Prediction Loss: 1.593873
Epoch 3899 
Prediction Loss: 1.608034
Epoch 3949 
Prediction Loss: 1.581042
Epoch 3999 
Prediction Loss: 1.584146
Epoch 4049 
Prediction Loss: 1.587268
Epoch 4099 
Prediction Loss: 1.570420
Epoch 4149 
Prediction Loss: 1.590356
Epoch 4199 
Prediction Loss: 1.570859
Epoch 4249 
Prediction Loss: 1.580568
Epoch 4299 
Prediction Loss: 1.565651
Epoch 4349 
Prediction Loss: 1.580578
Epoch 4399 
Prediction Loss: 1.547913
Epoch 4449 
Prediction Loss: 1.542503
Epoch 4499 
Prediction Loss: 1.553951
Epoch 4549 
Prediction Loss: 1.539325
Epoch 4599 
Prediction Loss: 1.536630
Epoch 4649 
Prediction Loss: 1.554274
Epoch 4699 
Prediction Loss: 1.532599
Epoch 4749 
Prediction Loss: 1.531323
Epoch 4799 
Prediction Loss: 1.541171
Epoch 4849 
Prediction Loss: 1.531817
Epoch 4899 
Prediction Loss: 1.507514
Epoch 4949 
Prediction Loss: 1.513203
Epoch 4999 
Prediction Loss: 1.498916
Epoch 5049 
Prediction Loss: 1.500469
Epoch 5099 
Prediction Loss: 1.506467
Epoch 5149 
Prediction Loss: 1.499481
Epoch 5199 
Prediction Loss: 1.493562
Epoch 5249 
Prediction Loss: 1.516540
Epoch 5299 
Prediction Loss: 1.497353
Epoch 5349 
Prediction Loss: 1.478120
Epoch 5399 
Prediction Loss: 1.497254
Epoch 5449 
Prediction Loss: 1.475396
Epoch 5499 
Prediction Loss: 1.486396
Epoch 5549 
Prediction Loss: 1.486694
Epoch 5599 
Prediction Loss: 1.466994
Epoch 5649 
Prediction Loss: 1.473999
Epoch 5699 
Prediction Loss: 1.474331
Epoch 5749 
Prediction Loss: 1.472859
Epoch 5799 
Prediction Loss: 1.490578
Epoch 5849 
Prediction Loss: 1.468482
Epoch 5899 
Prediction Loss: 1.436869
Epoch 5949 
Prediction Loss: 1.459841
Epoch 5999 
Prediction Loss: 1.450490
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.191601
Insample Error 2.867198
[31m========== repeat time 4 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.744245
Rec Loss: 10.254720
KL Loss: 2.489525
Y Loss: 1.117662
T Loss: 9.695888
Epoch 99 
Overall Loss: 12.519368
Rec Loss: 10.177751
KL Loss: 2.341617
Y Loss: 1.077205
T Loss: 9.639149
Epoch 149 
Overall Loss: 12.418252
Rec Loss: 10.193168
KL Loss: 2.225084
Y Loss: 1.097159
T Loss: 9.644588
Epoch 199 
Overall Loss: 12.364938
Rec Loss: 10.172846
KL Loss: 2.192092
Y Loss: 1.069583
T Loss: 9.638054
Epoch 249 
Overall Loss: 12.349544
Rec Loss: 10.124218
KL Loss: 2.225325
Y Loss: 0.997361
T Loss: 9.625538
Epoch 299 
Overall Loss: 12.322990
Rec Loss: 10.140594
KL Loss: 2.182396
Y Loss: 1.025122
T Loss: 9.628033
Epoch 349 
Overall Loss: 12.308611
Rec Loss: 10.110665
KL Loss: 2.197947
Y Loss: 1.003251
T Loss: 9.609039
Epoch 399 
Overall Loss: 12.293958
Rec Loss: 10.118240
KL Loss: 2.175718
Y Loss: 0.990601
T Loss: 9.622940
Epoch 449 
Overall Loss: 12.283281
Rec Loss: 10.104684
KL Loss: 2.178597
Y Loss: 0.976911
T Loss: 9.616228
Epoch 499 
Overall Loss: 12.294109
Rec Loss: 10.099975
KL Loss: 2.194135
Y Loss: 0.974104
T Loss: 9.612923
Epoch 549 
Overall Loss: 12.271053
Rec Loss: 10.093198
KL Loss: 2.177855
Y Loss: 0.960159
T Loss: 9.613118
Epoch 599 
Overall Loss: 12.248733
Rec Loss: 10.059516
KL Loss: 2.189217
Y Loss: 0.933941
T Loss: 9.592546
Epoch 649 
Overall Loss: 12.238364
Rec Loss: 10.064418
KL Loss: 2.173946
Y Loss: 0.935833
T Loss: 9.596501
Epoch 699 
Overall Loss: 12.237453
Rec Loss: 10.056566
KL Loss: 2.180887
Y Loss: 0.926942
T Loss: 9.593095
Epoch 749 
Overall Loss: 12.264364
Rec Loss: 10.067285
KL Loss: 2.197079
Y Loss: 0.928550
T Loss: 9.603010
Epoch 799 
Overall Loss: 12.261074
Rec Loss: 10.072387
KL Loss: 2.188687
Y Loss: 0.932967
T Loss: 9.605904
Epoch 849 
Overall Loss: 12.257087
Rec Loss: 10.045510
KL Loss: 2.211578
Y Loss: 0.916975
T Loss: 9.587022
Epoch 899 
Overall Loss: 12.230759
Rec Loss: 10.024953
KL Loss: 2.205806
Y Loss: 0.904643
T Loss: 9.572631
Epoch 949 
Overall Loss: 12.230542
Rec Loss: 10.022778
KL Loss: 2.207764
Y Loss: 0.912342
T Loss: 9.566607
Epoch 999 
Overall Loss: 12.226059
Rec Loss: 10.060797
KL Loss: 2.165262
Y Loss: 0.910886
T Loss: 9.605354
Epoch 1049 
Overall Loss: 12.225308
Rec Loss: 10.008199
KL Loss: 2.217108
Y Loss: 0.908017
T Loss: 9.554191
Epoch 1099 
Overall Loss: 12.215693
Rec Loss: 10.017873
KL Loss: 2.197821
Y Loss: 0.890010
T Loss: 9.572868
Epoch 1149 
Overall Loss: 12.207074
Rec Loss: 9.998693
KL Loss: 2.208381
Y Loss: 0.923927
T Loss: 9.536730
Epoch 1199 
Overall Loss: 12.219210
Rec Loss: 10.037765
KL Loss: 2.181445
Y Loss: 0.952714
T Loss: 9.561408
Epoch 1249 
Overall Loss: 12.206956
Rec Loss: 9.992468
KL Loss: 2.214488
Y Loss: 0.903647
T Loss: 9.540645
Epoch 1299 
Overall Loss: 12.217552
Rec Loss: 10.037662
KL Loss: 2.179890
Y Loss: 0.936526
T Loss: 9.569399
Epoch 1349 
Overall Loss: 12.228698
Rec Loss: 9.998125
KL Loss: 2.230573
Y Loss: 0.909810
T Loss: 9.543220
Epoch 1399 
Overall Loss: 12.191450
Rec Loss: 9.992145
KL Loss: 2.199305
Y Loss: 0.918173
T Loss: 9.533059
Epoch 1449 
Overall Loss: 12.186037
Rec Loss: 10.019875
KL Loss: 2.166162
Y Loss: 0.904113
T Loss: 9.567819
Epoch 1499 
Overall Loss: 12.204338
Rec Loss: 9.997210
KL Loss: 2.207128
Y Loss: 0.902974
T Loss: 9.545723
Epoch 1549 
Overall Loss: 12.170877
Rec Loss: 9.986557
KL Loss: 2.184319
Y Loss: 0.890088
T Loss: 9.541513
Epoch 1599 
Overall Loss: 12.215394
Rec Loss: 10.001266
KL Loss: 2.214129
Y Loss: 0.902519
T Loss: 9.550006
Epoch 1649 
Overall Loss: 12.229346
Rec Loss: 10.009203
KL Loss: 2.220142
Y Loss: 0.886902
T Loss: 9.565752
Epoch 1699 
Overall Loss: 12.205668
Rec Loss: 9.969121
KL Loss: 2.236547
Y Loss: 0.893253
T Loss: 9.522494
Epoch 1749 
Overall Loss: 12.200015
Rec Loss: 9.980507
KL Loss: 2.219509
Y Loss: 0.891821
T Loss: 9.534596
Epoch 1799 
Overall Loss: 12.194594
Rec Loss: 9.975641
KL Loss: 2.218954
Y Loss: 0.894064
T Loss: 9.528608
Epoch 1849 
Overall Loss: 12.176638
Rec Loss: 9.984978
KL Loss: 2.191660
Y Loss: 0.872323
T Loss: 9.548817
Epoch 1899 
Overall Loss: 12.203871
Rec Loss: 9.998038
KL Loss: 2.205833
Y Loss: 0.913709
T Loss: 9.541183
Epoch 1949 
Overall Loss: 12.199715
Rec Loss: 9.987154
KL Loss: 2.212561
Y Loss: 0.874787
T Loss: 9.549760
Epoch 1999 
Overall Loss: 12.175336
Rec Loss: 9.985406
KL Loss: 2.189930
Y Loss: 0.904717
T Loss: 9.533047
Epoch 2049 
Overall Loss: 12.202205
Rec Loss: 10.010901
KL Loss: 2.191304
Y Loss: 0.894740
T Loss: 9.563530
Epoch 2099 
Overall Loss: 12.152559
Rec Loss: 9.941234
KL Loss: 2.211325
Y Loss: 0.874901
T Loss: 9.503784
Epoch 2149 
Overall Loss: 12.174253
Rec Loss: 10.004859
KL Loss: 2.169394
Y Loss: 0.888643
T Loss: 9.560538
Epoch 2199 
Overall Loss: 12.181036
Rec Loss: 9.977662
KL Loss: 2.203373
Y Loss: 0.875111
T Loss: 9.540107
Epoch 2249 
Overall Loss: 12.172906
Rec Loss: 9.940166
KL Loss: 2.232740
Y Loss: 0.875833
T Loss: 9.502249
Epoch 2299 
Overall Loss: 12.145817
Rec Loss: 9.946606
KL Loss: 2.199210
Y Loss: 0.871463
T Loss: 9.510875
Epoch 2349 
Overall Loss: 12.175885
Rec Loss: 9.930755
KL Loss: 2.245130
Y Loss: 0.865778
T Loss: 9.497866
Epoch 2399 
Overall Loss: 12.176185
Rec Loss: 9.978438
KL Loss: 2.197747
Y Loss: 0.893489
T Loss: 9.531694
Epoch 2449 
Overall Loss: 12.164903
Rec Loss: 9.959490
KL Loss: 2.205412
Y Loss: 0.870812
T Loss: 9.524084
Epoch 2499 
Overall Loss: 12.174678
Rec Loss: 9.949168
KL Loss: 2.225511
Y Loss: 0.873725
T Loss: 9.512305
Epoch 2549 
Overall Loss: 12.149487
Rec Loss: 9.933250
KL Loss: 2.216237
Y Loss: 0.868559
T Loss: 9.498970
Epoch 2599 
Overall Loss: 12.132706
Rec Loss: 9.949250
KL Loss: 2.183455
Y Loss: 0.866069
T Loss: 9.516215
Epoch 2649 
Overall Loss: 12.154632
Rec Loss: 9.934996
KL Loss: 2.219636
Y Loss: 0.894861
T Loss: 9.487566
Epoch 2699 
Overall Loss: 12.151046
Rec Loss: 9.945058
KL Loss: 2.205988
Y Loss: 0.886414
T Loss: 9.501850
Epoch 2749 
Overall Loss: 12.146098
Rec Loss: 9.954032
KL Loss: 2.192066
Y Loss: 0.875081
T Loss: 9.516491
Epoch 2799 
Overall Loss: 12.145373
Rec Loss: 9.948916
KL Loss: 2.196457
Y Loss: 0.893510
T Loss: 9.502160
Epoch 2849 
Overall Loss: 12.143480
Rec Loss: 9.930539
KL Loss: 2.212942
Y Loss: 0.878238
T Loss: 9.491419
Epoch 2899 
Overall Loss: 12.141884
Rec Loss: 9.956500
KL Loss: 2.185384
Y Loss: 0.895912
T Loss: 9.508544
Epoch 2949 
Overall Loss: 12.154813
Rec Loss: 9.945236
KL Loss: 2.209577
Y Loss: 0.869497
T Loss: 9.510487
Epoch 2999 
Overall Loss: 12.151146
Rec Loss: 9.922444
KL Loss: 2.228702
Y Loss: 0.874662
T Loss: 9.485114
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.355441
Epoch 99
Rec Loss: 1.328069
Epoch 149
Rec Loss: 1.345191
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.734364
Epoch 99
Rec Loss: 9.732360
Epoch 149
Rec Loss: 9.729768
Epoch 199
Rec Loss: 9.728712
Epoch 249
Rec Loss: 9.710320
Epoch 299
Rec Loss: 9.720309
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.715187
Insample Error: 2.420530
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.065439
Epoch 99
Rec Loss: 4.065227
Epoch 149
Rec Loss: 4.062358
Epoch 199
Rec Loss: 4.071762
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.237580
Epoch 99
Rec Loss: 9.267731
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.001500
Insample Error 2.805519
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.439691
Epoch 99 
Prediction Loss: 2.129712
Epoch 149 
Prediction Loss: 2.072729
Epoch 199 
Prediction Loss: 2.048639
Epoch 249 
Prediction Loss: 2.035824
Epoch 299 
Prediction Loss: 1.990208
Epoch 349 
Prediction Loss: 1.997050
Epoch 399 
Prediction Loss: 1.968193
Epoch 449 
Prediction Loss: 1.958078
Epoch 499 
Prediction Loss: 1.957329
Epoch 549 
Prediction Loss: 1.935548
Epoch 599 
Prediction Loss: 1.926259
Epoch 649 
Prediction Loss: 1.917824
Epoch 699 
Prediction Loss: 1.918720
Epoch 749 
Prediction Loss: 1.886578
Epoch 799 
Prediction Loss: 1.899836
Epoch 849 
Prediction Loss: 1.913013
Epoch 899 
Prediction Loss: 1.872459
Epoch 949 
Prediction Loss: 1.856581
Epoch 999 
Prediction Loss: 1.841381
Epoch 1049 
Prediction Loss: 1.836430
Epoch 1099 
Prediction Loss: 1.842662
Epoch 1149 
Prediction Loss: 1.825467
Epoch 1199 
Prediction Loss: 1.834489
Epoch 1249 
Prediction Loss: 1.799525
Epoch 1299 
Prediction Loss: 1.800959
Epoch 1349 
Prediction Loss: 1.784963
Epoch 1399 
Prediction Loss: 1.806934
Epoch 1449 
Prediction Loss: 1.762160
Epoch 1499 
Prediction Loss: 1.763100
Epoch 1549 
Prediction Loss: 1.792406
Epoch 1599 
Prediction Loss: 1.735497
Epoch 1649 
Prediction Loss: 1.722427
Epoch 1699 
Prediction Loss: 1.743584
Epoch 1749 
Prediction Loss: 1.729289
Epoch 1799 
Prediction Loss: 1.704538
Epoch 1849 
Prediction Loss: 1.706673
Epoch 1899 
Prediction Loss: 1.706115
Epoch 1949 
Prediction Loss: 1.676657
Epoch 1999 
Prediction Loss: 1.675943
Epoch 2049 
Prediction Loss: 1.667314
Epoch 2099 
Prediction Loss: 1.653776
Epoch 2149 
Prediction Loss: 1.646915
Epoch 2199 
Prediction Loss: 1.644348
Epoch 2249 
Prediction Loss: 1.644738
Epoch 2299 
Prediction Loss: 1.636192
Epoch 2349 
Prediction Loss: 1.631228
Epoch 2399 
Prediction Loss: 1.628780
Epoch 2449 
Prediction Loss: 1.614765
Epoch 2499 
Prediction Loss: 1.609399
Epoch 2549 
Prediction Loss: 1.603035
Epoch 2599 
Prediction Loss: 1.593479
Epoch 2649 
Prediction Loss: 1.580474
Epoch 2699 
Prediction Loss: 1.587999
Epoch 2749 
Prediction Loss: 1.572613
Epoch 2799 
Prediction Loss: 1.581469
Epoch 2849 
Prediction Loss: 1.567883
Epoch 2899 
Prediction Loss: 1.557427
Epoch 2949 
Prediction Loss: 1.588297
Epoch 2999 
Prediction Loss: 1.551000
Epoch 3049 
Prediction Loss: 1.545895
Epoch 3099 
Prediction Loss: 1.538001
Epoch 3149 
Prediction Loss: 1.540032
Epoch 3199 
Prediction Loss: 1.565079
Epoch 3249 
Prediction Loss: 1.513767
Epoch 3299 
Prediction Loss: 1.519841
Epoch 3349 
Prediction Loss: 1.516312
Epoch 3399 
Prediction Loss: 1.505034
Epoch 3449 
Prediction Loss: 1.502510
Epoch 3499 
Prediction Loss: 1.483407
Epoch 3549 
Prediction Loss: 1.491680
Epoch 3599 
Prediction Loss: 1.489405
Epoch 3649 
Prediction Loss: 1.492066
Epoch 3699 
Prediction Loss: 1.470471
Epoch 3749 
Prediction Loss: 1.459764
Epoch 3799 
Prediction Loss: 1.464475
Epoch 3849 
Prediction Loss: 1.446940
Epoch 3899 
Prediction Loss: 1.441921
Epoch 3949 
Prediction Loss: 1.437535
Epoch 3999 
Prediction Loss: 1.434407
Epoch 4049 
Prediction Loss: 1.436276
Epoch 4099 
Prediction Loss: 1.433893
Epoch 4149 
Prediction Loss: 1.422411
Epoch 4199 
Prediction Loss: 1.421839
Epoch 4249 
Prediction Loss: 1.430324
Epoch 4299 
Prediction Loss: 1.419429
Epoch 4349 
Prediction Loss: 1.406839
Epoch 4399 
Prediction Loss: 1.394115
Epoch 4449 
Prediction Loss: 1.408107
Epoch 4499 
Prediction Loss: 1.406888
Epoch 4549 
Prediction Loss: 1.386962
Epoch 4599 
Prediction Loss: 1.384769
Epoch 4649 
Prediction Loss: 1.395564
Epoch 4699 
Prediction Loss: 1.370755
Epoch 4749 
Prediction Loss: 1.362666
Epoch 4799 
Prediction Loss: 1.372865
Epoch 4849 
Prediction Loss: 1.351647
Epoch 4899 
Prediction Loss: 1.348198
Epoch 4949 
Prediction Loss: 1.350284
Epoch 4999 
Prediction Loss: 1.351189
Epoch 5049 
Prediction Loss: 1.341925
Epoch 5099 
Prediction Loss: 1.354676
Epoch 5149 
Prediction Loss: 1.328951
Epoch 5199 
Prediction Loss: 1.319843
Epoch 5249 
Prediction Loss: 1.326061
Epoch 5299 
Prediction Loss: 1.322819
Epoch 5349 
Prediction Loss: 1.317884
Epoch 5399 
Prediction Loss: 1.310610
Epoch 5449 
Prediction Loss: 1.303458
Epoch 5499 
Prediction Loss: 1.290204
Epoch 5549 
Prediction Loss: 1.295371
Epoch 5599 
Prediction Loss: 1.293909
Epoch 5649 
Prediction Loss: 1.300173
Epoch 5699 
Prediction Loss: 1.301090
Epoch 5749 
Prediction Loss: 1.287639
Epoch 5799 
Prediction Loss: 1.276707
Epoch 5849 
Prediction Loss: 1.272296
Epoch 5899 
Prediction Loss: 1.278716
Epoch 5949 
Prediction Loss: 1.296150
Epoch 5999 
Prediction Loss: 1.276403
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.126357
Insample Error 2.961591
[31m========== repeat time 5 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.817057
Rec Loss: 10.288182
KL Loss: 2.528875
Y Loss: 1.009512
T Loss: 9.783427
Epoch 99 
Overall Loss: 12.567020
Rec Loss: 10.116243
KL Loss: 2.450776
Y Loss: 1.021781
T Loss: 9.605353
Epoch 149 
Overall Loss: 12.467514
Rec Loss: 10.175481
KL Loss: 2.292033
Y Loss: 1.092448
T Loss: 9.629257
Epoch 199 
Overall Loss: 12.400597
Rec Loss: 10.148228
KL Loss: 2.252369
Y Loss: 1.082254
T Loss: 9.607102
Epoch 249 
Overall Loss: 12.344133
Rec Loss: 10.128158
KL Loss: 2.215975
Y Loss: 1.030274
T Loss: 9.613021
Epoch 299 
Overall Loss: 12.302029
Rec Loss: 10.091217
KL Loss: 2.210812
Y Loss: 0.971765
T Loss: 9.605335
Epoch 349 
Overall Loss: 12.302675
Rec Loss: 10.114931
KL Loss: 2.187743
Y Loss: 0.971075
T Loss: 9.629394
Epoch 399 
Overall Loss: 12.294419
Rec Loss: 10.087965
KL Loss: 2.206454
Y Loss: 0.942336
T Loss: 9.616796
Epoch 449 
Overall Loss: 12.295607
Rec Loss: 10.097592
KL Loss: 2.198016
Y Loss: 0.959549
T Loss: 9.617817
Epoch 499 
Overall Loss: 12.290565
Rec Loss: 10.080490
KL Loss: 2.210075
Y Loss: 0.928067
T Loss: 9.616457
Epoch 549 
Overall Loss: 12.280448
Rec Loss: 10.070689
KL Loss: 2.209759
Y Loss: 0.970079
T Loss: 9.585650
Epoch 599 
Overall Loss: 12.260143
Rec Loss: 10.092607
KL Loss: 2.167536
Y Loss: 0.940348
T Loss: 9.622433
Epoch 649 
Overall Loss: 12.252839
Rec Loss: 10.086176
KL Loss: 2.166663
Y Loss: 0.955173
T Loss: 9.608590
Epoch 699 
Overall Loss: 12.241915
Rec Loss: 10.040207
KL Loss: 2.201708
Y Loss: 0.922242
T Loss: 9.579086
Epoch 749 
Overall Loss: 12.236199
Rec Loss: 10.052342
KL Loss: 2.183858
Y Loss: 0.926289
T Loss: 9.589197
Epoch 799 
Overall Loss: 12.239068
Rec Loss: 10.009483
KL Loss: 2.229585
Y Loss: 0.912783
T Loss: 9.553092
Epoch 849 
Overall Loss: 12.237876
Rec Loss: 10.025535
KL Loss: 2.212341
Y Loss: 0.920036
T Loss: 9.565518
Epoch 899 
Overall Loss: 12.224580
Rec Loss: 10.009946
KL Loss: 2.214633
Y Loss: 0.904777
T Loss: 9.557558
Epoch 949 
Overall Loss: 12.218323
Rec Loss: 10.039405
KL Loss: 2.178917
Y Loss: 0.917114
T Loss: 9.580848
Epoch 999 
Overall Loss: 12.207451
Rec Loss: 10.006518
KL Loss: 2.200934
Y Loss: 0.918616
T Loss: 9.547210
Epoch 1049 
Overall Loss: 12.206444
Rec Loss: 10.002028
KL Loss: 2.204416
Y Loss: 0.921507
T Loss: 9.541274
Epoch 1099 
Overall Loss: 12.237553
Rec Loss: 10.022153
KL Loss: 2.215400
Y Loss: 0.923098
T Loss: 9.560604
Epoch 1149 
Overall Loss: 12.214046
Rec Loss: 10.026892
KL Loss: 2.187155
Y Loss: 0.893322
T Loss: 9.580231
Epoch 1199 
Overall Loss: 12.205036
Rec Loss: 9.974333
KL Loss: 2.230703
Y Loss: 0.891527
T Loss: 9.528569
Epoch 1249 
Overall Loss: 12.200100
Rec Loss: 10.016483
KL Loss: 2.183617
Y Loss: 0.903337
T Loss: 9.564815
Epoch 1299 
Overall Loss: 12.201471
Rec Loss: 9.984105
KL Loss: 2.217365
Y Loss: 0.884547
T Loss: 9.541832
Epoch 1349 
Overall Loss: 12.198339
Rec Loss: 9.998343
KL Loss: 2.199995
Y Loss: 0.879849
T Loss: 9.558419
Epoch 1399 
Overall Loss: 12.184467
Rec Loss: 9.979643
KL Loss: 2.204824
Y Loss: 0.883736
T Loss: 9.537775
Epoch 1449 
Overall Loss: 12.195266
Rec Loss: 9.993200
KL Loss: 2.202066
Y Loss: 0.896809
T Loss: 9.544795
Epoch 1499 
Overall Loss: 12.195845
Rec Loss: 9.963755
KL Loss: 2.232090
Y Loss: 0.893249
T Loss: 9.517131
Epoch 1549 
Overall Loss: 12.198445
Rec Loss: 9.973568
KL Loss: 2.224878
Y Loss: 0.889907
T Loss: 9.528614
Epoch 1599 
Overall Loss: 12.178368
Rec Loss: 9.992062
KL Loss: 2.186307
Y Loss: 0.867907
T Loss: 9.558108
Epoch 1649 
Overall Loss: 12.181547
Rec Loss: 9.988859
KL Loss: 2.192688
Y Loss: 0.896469
T Loss: 9.540625
Epoch 1699 
Overall Loss: 12.195622
Rec Loss: 9.966589
KL Loss: 2.229032
Y Loss: 0.884396
T Loss: 9.524391
Epoch 1749 
Overall Loss: 12.182334
Rec Loss: 9.942300
KL Loss: 2.240034
Y Loss: 0.859203
T Loss: 9.512698
Epoch 1799 
Overall Loss: 12.207471
Rec Loss: 9.983813
KL Loss: 2.223658
Y Loss: 0.898188
T Loss: 9.534719
Epoch 1849 
Overall Loss: 12.184589
Rec Loss: 9.967821
KL Loss: 2.216768
Y Loss: 0.878628
T Loss: 9.528507
Epoch 1899 
Overall Loss: 12.212455
Rec Loss: 9.990821
KL Loss: 2.221635
Y Loss: 0.889684
T Loss: 9.545979
Epoch 1949 
Overall Loss: 12.168823
Rec Loss: 9.979476
KL Loss: 2.189346
Y Loss: 0.891570
T Loss: 9.533691
Epoch 1999 
Overall Loss: 12.168559
Rec Loss: 9.970406
KL Loss: 2.198152
Y Loss: 0.885889
T Loss: 9.527461
Epoch 2049 
Overall Loss: 12.188407
Rec Loss: 9.968927
KL Loss: 2.219481
Y Loss: 0.896812
T Loss: 9.520521
Epoch 2099 
Overall Loss: 12.175202
Rec Loss: 9.959976
KL Loss: 2.215226
Y Loss: 0.883961
T Loss: 9.517995
Epoch 2149 
Overall Loss: 12.184878
Rec Loss: 9.951247
KL Loss: 2.233632
Y Loss: 0.890186
T Loss: 9.506154
Epoch 2199 
Overall Loss: 12.187273
Rec Loss: 9.974766
KL Loss: 2.212507
Y Loss: 0.917047
T Loss: 9.516243
Epoch 2249 
Overall Loss: 12.143008
Rec Loss: 9.939625
KL Loss: 2.203384
Y Loss: 0.865804
T Loss: 9.506722
Epoch 2299 
Overall Loss: 12.166779
Rec Loss: 9.964460
KL Loss: 2.202318
Y Loss: 0.874367
T Loss: 9.527277
Epoch 2349 
Overall Loss: 12.144830
Rec Loss: 9.952368
KL Loss: 2.192461
Y Loss: 0.878712
T Loss: 9.513012
Epoch 2399 
Overall Loss: 12.176567
Rec Loss: 9.932629
KL Loss: 2.243938
Y Loss: 0.886430
T Loss: 9.489414
Epoch 2449 
Overall Loss: 12.158541
Rec Loss: 9.933445
KL Loss: 2.225096
Y Loss: 0.882412
T Loss: 9.492239
Epoch 2499 
Overall Loss: 12.166525
Rec Loss: 9.944394
KL Loss: 2.222131
Y Loss: 0.861459
T Loss: 9.513664
Epoch 2549 
Overall Loss: 12.164264
Rec Loss: 9.970032
KL Loss: 2.194232
Y Loss: 0.900177
T Loss: 9.519943
Epoch 2599 
Overall Loss: 12.174004
Rec Loss: 9.940730
KL Loss: 2.233274
Y Loss: 0.882217
T Loss: 9.499622
Epoch 2649 
Overall Loss: 12.145016
Rec Loss: 9.926599
KL Loss: 2.218417
Y Loss: 0.881174
T Loss: 9.486012
Epoch 2699 
Overall Loss: 12.158534
Rec Loss: 9.923659
KL Loss: 2.234875
Y Loss: 0.847785
T Loss: 9.499766
Epoch 2749 
Overall Loss: 12.147585
Rec Loss: 9.959787
KL Loss: 2.187797
Y Loss: 0.884114
T Loss: 9.517730
Epoch 2799 
Overall Loss: 12.157412
Rec Loss: 9.949792
KL Loss: 2.207620
Y Loss: 0.876010
T Loss: 9.511786
Epoch 2849 
Overall Loss: 12.148382
Rec Loss: 9.901641
KL Loss: 2.246741
Y Loss: 0.858745
T Loss: 9.472269
Epoch 2899 
Overall Loss: 12.134728
Rec Loss: 9.946183
KL Loss: 2.188545
Y Loss: 0.862523
T Loss: 9.514921
Epoch 2949 
Overall Loss: 12.139294
Rec Loss: 9.948260
KL Loss: 2.191034
Y Loss: 0.872681
T Loss: 9.511920
Epoch 2999 
Overall Loss: 12.149592
Rec Loss: 9.955517
KL Loss: 2.194074
Y Loss: 0.914911
T Loss: 9.498062
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.341186
Epoch 99
Rec Loss: 1.334273
Epoch 149
Rec Loss: 1.344604
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.743452
Epoch 99
Rec Loss: 9.743800
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.755149
Insample Error: 2.463548
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.059420
Epoch 99
Rec Loss: 4.052650
Epoch 149
Rec Loss: 4.060149
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.428320
Epoch 99
Rec Loss: 9.370732
Epoch 149
Rec Loss: 9.427586
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.979320
Insample Error 2.796951
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.635067
Epoch 99 
Prediction Loss: 2.260382
Epoch 149 
Prediction Loss: 2.100969
Epoch 199 
Prediction Loss: 2.056332
Epoch 249 
Prediction Loss: 2.042260
Epoch 299 
Prediction Loss: 1.991971
Epoch 349 
Prediction Loss: 1.977462
Epoch 399 
Prediction Loss: 1.976442
Epoch 449 
Prediction Loss: 1.947296
Epoch 499 
Prediction Loss: 1.935262
Epoch 549 
Prediction Loss: 1.927083
Epoch 599 
Prediction Loss: 1.917767
Epoch 649 
Prediction Loss: 1.905345
Epoch 699 
Prediction Loss: 1.884482
Epoch 749 
Prediction Loss: 1.864622
Epoch 799 
Prediction Loss: 1.873595
Epoch 849 
Prediction Loss: 1.858608
Epoch 899 
Prediction Loss: 1.836266
Epoch 949 
Prediction Loss: 1.836622
Epoch 999 
Prediction Loss: 1.817738
Epoch 1049 
Prediction Loss: 1.805906
Epoch 1099 
Prediction Loss: 1.801086
Epoch 1149 
Prediction Loss: 1.793728
Epoch 1199 
Prediction Loss: 1.778818
Epoch 1249 
Prediction Loss: 1.780153
Epoch 1299 
Prediction Loss: 1.789206
Epoch 1349 
Prediction Loss: 1.754967
Epoch 1399 
Prediction Loss: 1.750357
Epoch 1449 
Prediction Loss: 1.734853
Epoch 1499 
Prediction Loss: 1.732088
Epoch 1549 
Prediction Loss: 1.716896
Epoch 1599 
Prediction Loss: 1.706088
Epoch 1649 
Prediction Loss: 1.699253
Epoch 1699 
Prediction Loss: 1.680253
Epoch 1749 
Prediction Loss: 1.672098
Epoch 1799 
Prediction Loss: 1.676963
Epoch 1849 
Prediction Loss: 1.686008
Epoch 1899 
Prediction Loss: 1.651025
Epoch 1949 
Prediction Loss: 1.657011
Epoch 1999 
Prediction Loss: 1.647326
Epoch 2049 
Prediction Loss: 1.637414
Epoch 2099 
Prediction Loss: 1.622207
Epoch 2149 
Prediction Loss: 1.610245
Epoch 2199 
Prediction Loss: 1.602176
Epoch 2249 
Prediction Loss: 1.597124
Epoch 2299 
Prediction Loss: 1.584354
Epoch 2349 
Prediction Loss: 1.590641
Epoch 2399 
Prediction Loss: 1.580263
Epoch 2449 
Prediction Loss: 1.576983
Epoch 2499 
Prediction Loss: 1.557922
Epoch 2549 
Prediction Loss: 1.587478
Epoch 2599 
Prediction Loss: 1.551933
Epoch 2649 
Prediction Loss: 1.536732
Epoch 2699 
Prediction Loss: 1.534336
Epoch 2749 
Prediction Loss: 1.526662
Epoch 2799 
Prediction Loss: 1.531508
Epoch 2849 
Prediction Loss: 1.507688
Epoch 2899 
Prediction Loss: 1.522741
Epoch 2949 
Prediction Loss: 1.496061
Epoch 2999 
Prediction Loss: 1.499983
Epoch 3049 
Prediction Loss: 1.491511
Epoch 3099 
Prediction Loss: 1.493417
Epoch 3149 
Prediction Loss: 1.478277
Epoch 3199 
Prediction Loss: 1.490910
Epoch 3249 
Prediction Loss: 1.485130
Epoch 3299 
Prediction Loss: 1.456326
Epoch 3349 
Prediction Loss: 1.451709
Epoch 3399 
Prediction Loss: 1.449820
Epoch 3449 
Prediction Loss: 1.443587
Epoch 3499 
Prediction Loss: 1.440952
Epoch 3549 
Prediction Loss: 1.427289
Epoch 3599 
Prediction Loss: 1.439750
Epoch 3649 
Prediction Loss: 1.416426
Epoch 3699 
Prediction Loss: 1.416523
Epoch 3749 
Prediction Loss: 1.415813
Epoch 3799 
Prediction Loss: 1.413307
Epoch 3849 
Prediction Loss: 1.414931
Epoch 3899 
Prediction Loss: 1.413415
Epoch 3949 
Prediction Loss: 1.392577
Epoch 3999 
Prediction Loss: 1.408933
Epoch 4049 
Prediction Loss: 1.383265
Epoch 4099 
Prediction Loss: 1.378771
Epoch 4149 
Prediction Loss: 1.374383
Epoch 4199 
Prediction Loss: 1.375082
Epoch 4249 
Prediction Loss: 1.372117
Epoch 4299 
Prediction Loss: 1.361753
Epoch 4349 
Prediction Loss: 1.364146
Epoch 4399 
Prediction Loss: 1.354717
Epoch 4449 
Prediction Loss: 1.351395
Epoch 4499 
Prediction Loss: 1.347735
Epoch 4549 
Prediction Loss: 1.343261
Epoch 4599 
Prediction Loss: 1.342583
Epoch 4649 
Prediction Loss: 1.345077
Epoch 4699 
Prediction Loss: 1.342564
Epoch 4749 
Prediction Loss: 1.354370
Epoch 4799 
Prediction Loss: 1.339369
Epoch 4849 
Prediction Loss: 1.330339
Epoch 4899 
Prediction Loss: 1.324944
Epoch 4949 
Prediction Loss: 1.311213
Epoch 4999 
Prediction Loss: 1.314759
Epoch 5049 
Prediction Loss: 1.305057
Epoch 5099 
Prediction Loss: 1.301589
Epoch 5149 
Prediction Loss: 1.300361
Epoch 5199 
Prediction Loss: 1.291994
Epoch 5249 
Prediction Loss: 1.292913
Epoch 5299 
Prediction Loss: 1.289618
Epoch 5349 
Prediction Loss: 1.323975
Epoch 5399 
Prediction Loss: 1.289442
Epoch 5449 
Prediction Loss: 1.281551
Epoch 5499 
Prediction Loss: 1.307799
Epoch 5549 
Prediction Loss: 1.279007
Epoch 5599 
Prediction Loss: 1.291322
Epoch 5649 
Prediction Loss: 1.266610
Epoch 5699 
Prediction Loss: 1.262424
Epoch 5749 
Prediction Loss: 1.267217
Epoch 5799 
Prediction Loss: 1.254516
Epoch 5849 
Prediction Loss: 1.248002
Epoch 5899 
Prediction Loss: 1.267068
Epoch 5949 
Prediction Loss: 1.251517
Epoch 5999 
Prediction Loss: 1.243359
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.120243
Insample Error 2.902979
Ours, Train RMSE
0.7525, 
0.7275, 
0.7213, 
0.7152, 
0.7551, 
CEVAE, Train RMSE
2.9642, 
2.9677, 
2.9739, 
3.0015, 
2.9793, 
Ours, Insample RMSE
2.6090, 
2.5988, 
2.5527, 
2.4205, 
2.4635, 
CEVAE, Insample RMSE
2.8026, 
2.8093, 
2.8019, 
2.8055, 
2.7970, 
Direct Regression, Insample RMSE
2.9519, 
2.9611, 
2.8672, 
2.9616, 
2.9030, 
Train, RMSE mean 0.7343 std 0.0164
CEVAE, RMSE mean 2.9773 std 0.0132
Ours, RMSE mean 2.5289 std 0.0747, reconstruct confounder 1.3697 (0.0334) noise 9.7327 (0.0120)
CEVAE, RMSE mean 2.8033 std 0.0041, reconstruct confounder 4.0616 (0.0088) noise 9.1336 (0.2999)
Direct Regression, RMSE mean 2.9290 std 0.0377
Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=4, mask=0, nlayer=50, obsm=1, stop=2000, ycof=0.5, ylayer=50)
Y Mean 1.776465, Std 3.501489 
Test Y Mean -0.006496, Std 3.341313 
Observe confounder 1, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.979948
Rec Loss: 10.322769
KL Loss: 2.657179
Y Loss: 1.061069
T Loss: 9.792235
Epoch 99 
Overall Loss: 12.832941
Rec Loss: 10.222908
KL Loss: 2.610033
Y Loss: 1.007491
T Loss: 9.719162
Epoch 149 
Overall Loss: 12.775450
Rec Loss: 10.185425
KL Loss: 2.590025
Y Loss: 0.992157
T Loss: 9.689346
Epoch 199 
Overall Loss: 12.743375
Rec Loss: 10.207700
KL Loss: 2.535675
Y Loss: 1.029541
T Loss: 9.692929
Epoch 249 
Overall Loss: 12.707224
Rec Loss: 10.181072
KL Loss: 2.526152
Y Loss: 1.000255
T Loss: 9.680944
Epoch 299 
Overall Loss: 12.698154
Rec Loss: 10.182677
KL Loss: 2.515477
Y Loss: 0.999933
T Loss: 9.682710
Epoch 349 
Overall Loss: 12.689761
Rec Loss: 10.167923
KL Loss: 2.521837
Y Loss: 1.010691
T Loss: 9.662578
Epoch 399 
Overall Loss: 12.689655
Rec Loss: 10.133165
KL Loss: 2.556490
Y Loss: 0.982677
T Loss: 9.641827
Epoch 449 
Overall Loss: 12.696037
Rec Loss: 10.174804
KL Loss: 2.521234
Y Loss: 0.996316
T Loss: 9.676646
Epoch 499 
Overall Loss: 12.677888
Rec Loss: 10.150002
KL Loss: 2.527886
Y Loss: 0.982836
T Loss: 9.658584
Epoch 549 
Overall Loss: 12.668478
Rec Loss: 10.140872
KL Loss: 2.527606
Y Loss: 1.003127
T Loss: 9.639308
Epoch 599 
Overall Loss: 12.652822
Rec Loss: 10.137288
KL Loss: 2.515534
Y Loss: 0.971371
T Loss: 9.651602
Epoch 649 
Overall Loss: 12.655937
Rec Loss: 10.121356
KL Loss: 2.534581
Y Loss: 0.959075
T Loss: 9.641819
Epoch 699 
Overall Loss: 12.669815
Rec Loss: 10.122865
KL Loss: 2.546950
Y Loss: 0.988711
T Loss: 9.628510
Epoch 749 
Overall Loss: 12.661656
Rec Loss: 10.157937
KL Loss: 2.503719
Y Loss: 0.985844
T Loss: 9.665015
Epoch 799 
Overall Loss: 12.639816
Rec Loss: 10.150891
KL Loss: 2.488926
Y Loss: 0.979028
T Loss: 9.661377
Epoch 849 
Overall Loss: 12.661844
Rec Loss: 10.152661
KL Loss: 2.509184
Y Loss: 0.989412
T Loss: 9.657954
Epoch 899 
Overall Loss: 12.639458
Rec Loss: 10.113431
KL Loss: 2.526028
Y Loss: 0.956062
T Loss: 9.635400
Epoch 949 
Overall Loss: 12.633316
Rec Loss: 10.090188
KL Loss: 2.543127
Y Loss: 0.985871
T Loss: 9.597253
Epoch 999 
Overall Loss: 12.638526
Rec Loss: 10.149569
KL Loss: 2.488957
Y Loss: 0.991575
T Loss: 9.653781
Epoch 1049 
Overall Loss: 12.632257
Rec Loss: 10.141250
KL Loss: 2.491008
Y Loss: 0.988833
T Loss: 9.646833
Epoch 1099 
Overall Loss: 12.650724
Rec Loss: 10.111328
KL Loss: 2.539396
Y Loss: 0.977711
T Loss: 9.622472
Epoch 1149 
Overall Loss: 12.623157
Rec Loss: 10.093651
KL Loss: 2.529505
Y Loss: 0.978118
T Loss: 9.604593
Epoch 1199 
Overall Loss: 12.634199
Rec Loss: 10.100263
KL Loss: 2.533936
Y Loss: 1.002781
T Loss: 9.598873
Epoch 1249 
Overall Loss: 12.619449
Rec Loss: 10.082243
KL Loss: 2.537206
Y Loss: 0.984906
T Loss: 9.589790
Epoch 1299 
Overall Loss: 12.615310
Rec Loss: 10.105785
KL Loss: 2.509525
Y Loss: 0.958110
T Loss: 9.626730
Epoch 1349 
Overall Loss: 12.636542
Rec Loss: 10.097789
KL Loss: 2.538753
Y Loss: 0.965270
T Loss: 9.615154
Epoch 1399 
Overall Loss: 12.628379
Rec Loss: 10.115480
KL Loss: 2.512899
Y Loss: 0.987274
T Loss: 9.621843
Epoch 1449 
Overall Loss: 12.607781
Rec Loss: 10.101429
KL Loss: 2.506352
Y Loss: 0.983149
T Loss: 9.609855
Epoch 1499 
Overall Loss: 12.585752
Rec Loss: 10.085856
KL Loss: 2.499896
Y Loss: 0.958162
T Loss: 9.606774
Epoch 1549 
Overall Loss: 12.617377
Rec Loss: 10.093602
KL Loss: 2.523775
Y Loss: 0.960126
T Loss: 9.613539
Epoch 1599 
Overall Loss: 12.621903
Rec Loss: 10.123014
KL Loss: 2.498888
Y Loss: 0.984657
T Loss: 9.630685
Epoch 1649 
Overall Loss: 12.626759
Rec Loss: 10.097702
KL Loss: 2.529057
Y Loss: 0.960799
T Loss: 9.617303
Epoch 1699 
Overall Loss: 12.611740
Rec Loss: 10.115645
KL Loss: 2.496095
Y Loss: 0.993672
T Loss: 9.618810
Epoch 1749 
Overall Loss: 12.609502
Rec Loss: 10.103325
KL Loss: 2.506176
Y Loss: 0.993203
T Loss: 9.606724
Epoch 1799 
Overall Loss: 12.628558
Rec Loss: 10.079221
KL Loss: 2.549338
Y Loss: 0.972172
T Loss: 9.593135
Epoch 1849 
Overall Loss: 12.623826
Rec Loss: 10.103665
KL Loss: 2.520161
Y Loss: 0.994931
T Loss: 9.606200
Epoch 1899 
Overall Loss: 12.610346
Rec Loss: 10.102345
KL Loss: 2.508001
Y Loss: 0.979777
T Loss: 9.612457
Epoch 1949 
Overall Loss: 12.610768
Rec Loss: 10.098267
KL Loss: 2.512502
Y Loss: 0.967635
T Loss: 9.614450
Epoch 1999 
Overall Loss: 12.611675
Rec Loss: 10.122230
KL Loss: 2.489445
Y Loss: 1.005707
T Loss: 9.619376
Epoch 2049 
Overall Loss: 12.603657
Rec Loss: 10.087630
KL Loss: 2.516027
Y Loss: 0.980815
T Loss: 9.597223
Epoch 2099 
Overall Loss: 12.619883
Rec Loss: 10.085066
KL Loss: 2.534817
Y Loss: 0.981041
T Loss: 9.594545
Epoch 2149 
Overall Loss: 12.613816
Rec Loss: 10.112118
KL Loss: 2.501698
Y Loss: 0.975548
T Loss: 9.624344
Epoch 2199 
Overall Loss: 12.594230
Rec Loss: 10.063312
KL Loss: 2.530919
Y Loss: 0.965076
T Loss: 9.580774
Epoch 2249 
Overall Loss: 12.596837
Rec Loss: 10.072198
KL Loss: 2.524640
Y Loss: 0.964827
T Loss: 9.589784
Epoch 2299 
Overall Loss: 12.610691
Rec Loss: 10.113301
KL Loss: 2.497391
Y Loss: 1.018930
T Loss: 9.603836
Epoch 2349 
Overall Loss: 12.586936
Rec Loss: 10.090654
KL Loss: 2.496283
Y Loss: 0.972245
T Loss: 9.604531
Epoch 2399 
Overall Loss: 12.604803
Rec Loss: 10.085194
KL Loss: 2.519609
Y Loss: 0.988073
T Loss: 9.591158
Epoch 2449 
Overall Loss: 12.573131
Rec Loss: 10.074966
KL Loss: 2.498165
Y Loss: 0.968815
T Loss: 9.590558
Epoch 2499 
Overall Loss: 12.593990
Rec Loss: 10.071876
KL Loss: 2.522114
Y Loss: 0.972527
T Loss: 9.585613
Epoch 2549 
Overall Loss: 12.612717
Rec Loss: 10.074770
KL Loss: 2.537948
Y Loss: 0.986786
T Loss: 9.581376
Epoch 2599 
Overall Loss: 12.611365
Rec Loss: 10.109713
KL Loss: 2.501652
Y Loss: 0.994888
T Loss: 9.612269
Epoch 2649 
Overall Loss: 12.585358
Rec Loss: 10.042342
KL Loss: 2.543015
Y Loss: 0.952364
T Loss: 9.566161
Epoch 2699 
Overall Loss: 12.592504
Rec Loss: 10.077492
KL Loss: 2.515012
Y Loss: 0.977542
T Loss: 9.588721
Epoch 2749 
Overall Loss: 12.567380
Rec Loss: 10.066188
KL Loss: 2.501192
Y Loss: 0.990595
T Loss: 9.570891
Epoch 2799 
Overall Loss: 12.595717
Rec Loss: 10.074745
KL Loss: 2.520972
Y Loss: 0.999038
T Loss: 9.575226
Epoch 2849 
Overall Loss: 12.624819
Rec Loss: 10.060235
KL Loss: 2.564584
Y Loss: 0.978304
T Loss: 9.571083
Epoch 2899 
Overall Loss: 12.582760
Rec Loss: 10.064889
KL Loss: 2.517871
Y Loss: 0.981499
T Loss: 9.574139
Epoch 2949 
Overall Loss: 12.596231
Rec Loss: 10.103326
KL Loss: 2.492905
Y Loss: 1.003119
T Loss: 9.601766
Epoch 2999 
Overall Loss: 12.590073
Rec Loss: 10.070443
KL Loss: 2.519631
Y Loss: 0.993866
T Loss: 9.573510
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.098345
Epoch 99
Rec Loss: 1.078403
Epoch 149
Rec Loss: 1.085644
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.196691
Epoch 99
Rec Loss: 10.195217
Epoch 149
Rec Loss: 10.186862
Epoch 199
Rec Loss: 10.173536
Epoch 249
Rec Loss: 10.186159
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.661881
Insample Error: 2.134660
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.979971
Epoch 99
Rec Loss: 3.975937
Epoch 149
Rec Loss: 3.978950
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.152136
Epoch 99
Rec Loss: 9.203588
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.691561
Insample Error 3.332613
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.552529
Epoch 99 
Prediction Loss: 3.316708
Epoch 149 
Prediction Loss: 3.204464
Epoch 199 
Prediction Loss: 3.169694
Epoch 249 
Prediction Loss: 3.150069
Epoch 299 
Prediction Loss: 3.109847
Epoch 349 
Prediction Loss: 3.085338
Epoch 399 
Prediction Loss: 3.061272
Epoch 449 
Prediction Loss: 3.054752
Epoch 499 
Prediction Loss: 3.044007
Epoch 549 
Prediction Loss: 3.014197
Epoch 599 
Prediction Loss: 3.034332
Epoch 649 
Prediction Loss: 2.998905
Epoch 699 
Prediction Loss: 2.989323
Epoch 749 
Prediction Loss: 2.996770
Epoch 799 
Prediction Loss: 2.951626
Epoch 849 
Prediction Loss: 2.951486
Epoch 899 
Prediction Loss: 2.928248
Epoch 949 
Prediction Loss: 2.930274
Epoch 999 
Prediction Loss: 2.894569
Epoch 1049 
Prediction Loss: 2.893029
Epoch 1099 
Prediction Loss: 2.907751
Epoch 1149 
Prediction Loss: 2.877343
Epoch 1199 
Prediction Loss: 2.861680
Epoch 1249 
Prediction Loss: 2.829661
Epoch 1299 
Prediction Loss: 2.832366
Epoch 1349 
Prediction Loss: 2.826214
Epoch 1399 
Prediction Loss: 2.830082
Epoch 1449 
Prediction Loss: 2.796861
Epoch 1499 
Prediction Loss: 2.832309
Epoch 1549 
Prediction Loss: 2.779574
Epoch 1599 
Prediction Loss: 2.798993
Epoch 1649 
Prediction Loss: 2.789127
Epoch 1699 
Prediction Loss: 2.751945
Epoch 1749 
Prediction Loss: 2.748912
Epoch 1799 
Prediction Loss: 2.747149
Epoch 1849 
Prediction Loss: 2.711683
Epoch 1899 
Prediction Loss: 2.738036
Epoch 1949 
Prediction Loss: 2.679082
Epoch 1999 
Prediction Loss: 2.706114
Epoch 2049 
Prediction Loss: 2.687410
Epoch 2099 
Prediction Loss: 2.660467
Epoch 2149 
Prediction Loss: 2.644805
Epoch 2199 
Prediction Loss: 2.638652
Epoch 2249 
Prediction Loss: 2.621661
Epoch 2299 
Prediction Loss: 2.618554
Epoch 2349 
Prediction Loss: 2.621467
Epoch 2399 
Prediction Loss: 2.623540
Epoch 2449 
Prediction Loss: 2.592772
Epoch 2499 
Prediction Loss: 2.583278
Epoch 2549 
Prediction Loss: 2.573640
Epoch 2599 
Prediction Loss: 2.603117
Epoch 2649 
Prediction Loss: 2.537914
Epoch 2699 
Prediction Loss: 2.524780
Epoch 2749 
Prediction Loss: 2.530441
Epoch 2799 
Prediction Loss: 2.532575
Epoch 2849 
Prediction Loss: 2.513435
Epoch 2899 
Prediction Loss: 2.515615
Epoch 2949 
Prediction Loss: 2.481040
Epoch 2999 
Prediction Loss: 2.475412
Epoch 3049 
Prediction Loss: 2.477272
Epoch 3099 
Prediction Loss: 2.468246
Epoch 3149 
Prediction Loss: 2.462692
Epoch 3199 
Prediction Loss: 2.445893
Epoch 3249 
Prediction Loss: 2.435459
Epoch 3299 
Prediction Loss: 2.409777
Epoch 3349 
Prediction Loss: 2.430088
Epoch 3399 
Prediction Loss: 2.391662
Epoch 3449 
Prediction Loss: 2.392722
Epoch 3499 
Prediction Loss: 2.389412
Epoch 3549 
Prediction Loss: 2.376614
Epoch 3599 
Prediction Loss: 2.390776
Epoch 3649 
Prediction Loss: 2.378327
Epoch 3699 
Prediction Loss: 2.347339
Epoch 3749 
Prediction Loss: 2.338094
Epoch 3799 
Prediction Loss: 2.334307
Epoch 3849 
Prediction Loss: 2.341777
Epoch 3899 
Prediction Loss: 2.305401
Epoch 3949 
Prediction Loss: 2.324896
Epoch 3999 
Prediction Loss: 2.336425
Epoch 4049 
Prediction Loss: 2.277314
Epoch 4099 
Prediction Loss: 2.312369
Epoch 4149 
Prediction Loss: 2.273412
Epoch 4199 
Prediction Loss: 2.274221
Epoch 4249 
Prediction Loss: 2.255613
Epoch 4299 
Prediction Loss: 2.262913
Epoch 4349 
Prediction Loss: 2.257056
Epoch 4399 
Prediction Loss: 2.219502
Epoch 4449 
Prediction Loss: 2.231578
Epoch 4499 
Prediction Loss: 2.253829
Epoch 4549 
Prediction Loss: 2.229201
Epoch 4599 
Prediction Loss: 2.206229
Epoch 4649 
Prediction Loss: 2.213370
Epoch 4699 
Prediction Loss: 2.198851
Epoch 4749 
Prediction Loss: 2.181497
Epoch 4799 
Prediction Loss: 2.222028
Epoch 4849 
Prediction Loss: 2.159112
Epoch 4899 
Prediction Loss: 2.172925
Epoch 4949 
Prediction Loss: 2.156653
Epoch 4999 
Prediction Loss: 2.138874
Epoch 5049 
Prediction Loss: 2.232713
Epoch 5099 
Prediction Loss: 2.141030
Epoch 5149 
Prediction Loss: 2.127830
Epoch 5199 
Prediction Loss: 2.140037
Epoch 5249 
Prediction Loss: 2.111078
Epoch 5299 
Prediction Loss: 2.107419
Epoch 5349 
Prediction Loss: 2.138548
Epoch 5399 
Prediction Loss: 2.096719
Epoch 5449 
Prediction Loss: 2.112768
Epoch 5499 
Prediction Loss: 2.137411
Epoch 5549 
Prediction Loss: 2.105609
Epoch 5599 
Prediction Loss: 2.086242
Epoch 5649 
Prediction Loss: 2.074624
Epoch 5699 
Prediction Loss: 2.057917
Epoch 5749 
Prediction Loss: 2.070106
Epoch 5799 
Prediction Loss: 2.064212
Epoch 5849 
Prediction Loss: 2.054319
Epoch 5899 
Prediction Loss: 2.047163
Epoch 5949 
Prediction Loss: 2.043961
Epoch 5999 
Prediction Loss: 2.031945
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.433816
Insample Error 3.580581
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.894715
Rec Loss: 10.243752
KL Loss: 2.650962
Y Loss: 0.999973
T Loss: 9.743766
Epoch 99 
Overall Loss: 12.792723
Rec Loss: 10.175273
KL Loss: 2.617450
Y Loss: 1.017860
T Loss: 9.666344
Epoch 149 
Overall Loss: 12.763904
Rec Loss: 10.194472
KL Loss: 2.569432
Y Loss: 1.001940
T Loss: 9.693502
Epoch 199 
Overall Loss: 12.718440
Rec Loss: 10.165015
KL Loss: 2.553425
Y Loss: 1.001830
T Loss: 9.664100
Epoch 249 
Overall Loss: 12.693677
Rec Loss: 10.162310
KL Loss: 2.531366
Y Loss: 0.980075
T Loss: 9.672273
Epoch 299 
Overall Loss: 12.710521
Rec Loss: 10.168749
KL Loss: 2.541773
Y Loss: 1.005788
T Loss: 9.665855
Epoch 349 
Overall Loss: 12.687322
Rec Loss: 10.137119
KL Loss: 2.550203
Y Loss: 0.984831
T Loss: 9.644703
Epoch 399 
Overall Loss: 12.650475
Rec Loss: 10.145363
KL Loss: 2.505111
Y Loss: 1.000860
T Loss: 9.644933
Epoch 449 
Overall Loss: 12.674504
Rec Loss: 10.132532
KL Loss: 2.541972
Y Loss: 0.982275
T Loss: 9.641394
Epoch 499 
Overall Loss: 12.671540
Rec Loss: 10.140824
KL Loss: 2.530717
Y Loss: 0.989801
T Loss: 9.645924
Epoch 549 
Overall Loss: 12.651030
Rec Loss: 10.141645
KL Loss: 2.509385
Y Loss: 0.990527
T Loss: 9.646382
Epoch 599 
Overall Loss: 12.677035
Rec Loss: 10.158599
KL Loss: 2.518435
Y Loss: 1.008062
T Loss: 9.654569
Epoch 649 
Overall Loss: 12.672883
Rec Loss: 10.145078
KL Loss: 2.527805
Y Loss: 0.998029
T Loss: 9.646064
Epoch 699 
Overall Loss: 12.658488
Rec Loss: 10.142334
KL Loss: 2.516154
Y Loss: 0.969505
T Loss: 9.657581
Epoch 749 
Overall Loss: 12.639386
Rec Loss: 10.120950
KL Loss: 2.518435
Y Loss: 0.973159
T Loss: 9.634371
Epoch 799 
Overall Loss: 12.663090
Rec Loss: 10.132967
KL Loss: 2.530123
Y Loss: 0.981599
T Loss: 9.642168
Epoch 849 
Overall Loss: 12.660590
Rec Loss: 10.154928
KL Loss: 2.505662
Y Loss: 1.026055
T Loss: 9.641900
Epoch 899 
Overall Loss: 12.659899
Rec Loss: 10.117101
KL Loss: 2.542798
Y Loss: 0.979060
T Loss: 9.627571
Epoch 949 
Overall Loss: 12.644095
Rec Loss: 10.133472
KL Loss: 2.510623
Y Loss: 0.962029
T Loss: 9.652458
Epoch 999 
Overall Loss: 12.647361
Rec Loss: 10.138586
KL Loss: 2.508776
Y Loss: 1.001181
T Loss: 9.637995
Epoch 1049 
Overall Loss: 12.629688
Rec Loss: 10.124659
KL Loss: 2.505029
Y Loss: 0.987272
T Loss: 9.631023
Epoch 1099 
Overall Loss: 12.644128
Rec Loss: 10.122817
KL Loss: 2.521311
Y Loss: 0.985176
T Loss: 9.630229
Epoch 1149 
Overall Loss: 12.631283
Rec Loss: 10.121275
KL Loss: 2.510008
Y Loss: 0.978217
T Loss: 9.632167
Epoch 1199 
Overall Loss: 12.633736
Rec Loss: 10.134945
KL Loss: 2.498792
Y Loss: 0.985801
T Loss: 9.642044
Epoch 1249 
Overall Loss: 12.635450
Rec Loss: 10.129808
KL Loss: 2.505642
Y Loss: 0.989577
T Loss: 9.635019
Epoch 1299 
Overall Loss: 12.627734
Rec Loss: 10.112112
KL Loss: 2.515622
Y Loss: 0.964706
T Loss: 9.629759
Epoch 1349 
Overall Loss: 12.640422
Rec Loss: 10.132891
KL Loss: 2.507531
Y Loss: 0.999501
T Loss: 9.633140
Epoch 1399 
Overall Loss: 12.619783
Rec Loss: 10.112470
KL Loss: 2.507313
Y Loss: 0.983629
T Loss: 9.620656
Epoch 1449 
Overall Loss: 12.627677
Rec Loss: 10.100016
KL Loss: 2.527661
Y Loss: 0.987530
T Loss: 9.606250
Epoch 1499 
Overall Loss: 12.615591
Rec Loss: 10.093872
KL Loss: 2.521719
Y Loss: 0.972569
T Loss: 9.607588
Epoch 1549 
Overall Loss: 12.642097
Rec Loss: 10.106893
KL Loss: 2.535204
Y Loss: 0.988971
T Loss: 9.612408
Epoch 1599 
Overall Loss: 12.620089
Rec Loss: 10.098129
KL Loss: 2.521961
Y Loss: 0.984915
T Loss: 9.605671
Epoch 1649 
Overall Loss: 12.608559
Rec Loss: 10.097823
KL Loss: 2.510736
Y Loss: 0.969947
T Loss: 9.612850
Epoch 1699 
Overall Loss: 12.639295
Rec Loss: 10.109320
KL Loss: 2.529975
Y Loss: 1.000965
T Loss: 9.608837
Epoch 1749 
Overall Loss: 12.622537
Rec Loss: 10.100365
KL Loss: 2.522172
Y Loss: 0.980886
T Loss: 9.609922
Epoch 1799 
Overall Loss: 12.630289
Rec Loss: 10.110081
KL Loss: 2.520207
Y Loss: 1.000898
T Loss: 9.609633
Epoch 1849 
Overall Loss: 12.611346
Rec Loss: 10.066405
KL Loss: 2.544941
Y Loss: 0.977910
T Loss: 9.577450
Epoch 1899 
Overall Loss: 12.593628
Rec Loss: 10.098004
KL Loss: 2.495624
Y Loss: 0.985830
T Loss: 9.605089
Epoch 1949 
Overall Loss: 12.625739
Rec Loss: 10.109729
KL Loss: 2.516011
Y Loss: 0.982160
T Loss: 9.618649
Epoch 1999 
Overall Loss: 12.607680
Rec Loss: 10.081470
KL Loss: 2.526210
Y Loss: 0.967037
T Loss: 9.597952
Epoch 2049 
Overall Loss: 12.605290
Rec Loss: 10.074076
KL Loss: 2.531214
Y Loss: 0.978809
T Loss: 9.584671
Epoch 2099 
Overall Loss: 12.611922
Rec Loss: 10.069008
KL Loss: 2.542914
Y Loss: 0.973763
T Loss: 9.582127
Epoch 2149 
Overall Loss: 12.603703
Rec Loss: 10.073737
KL Loss: 2.529966
Y Loss: 0.987323
T Loss: 9.580075
Epoch 2199 
Overall Loss: 12.603650
Rec Loss: 10.092404
KL Loss: 2.511247
Y Loss: 0.982801
T Loss: 9.601003
Epoch 2249 
Overall Loss: 12.597053
Rec Loss: 10.045238
KL Loss: 2.551815
Y Loss: 0.957409
T Loss: 9.566534
Epoch 2299 
Overall Loss: 12.574369
Rec Loss: 10.080548
KL Loss: 2.493821
Y Loss: 0.956787
T Loss: 9.602155
Epoch 2349 
Overall Loss: 12.581714
Rec Loss: 10.077360
KL Loss: 2.504353
Y Loss: 0.977639
T Loss: 9.588541
Epoch 2399 
Overall Loss: 12.573602
Rec Loss: 10.073248
KL Loss: 2.500354
Y Loss: 0.960998
T Loss: 9.592749
Epoch 2449 
Overall Loss: 12.626256
Rec Loss: 10.078875
KL Loss: 2.547381
Y Loss: 0.972965
T Loss: 9.592393
Epoch 2499 
Overall Loss: 12.593241
Rec Loss: 10.084193
KL Loss: 2.509048
Y Loss: 0.964365
T Loss: 9.602010
Epoch 2549 
Overall Loss: 12.607599
Rec Loss: 10.087868
KL Loss: 2.519731
Y Loss: 1.013736
T Loss: 9.580999
Epoch 2599 
Overall Loss: 12.625466
Rec Loss: 10.083847
KL Loss: 2.541620
Y Loss: 1.004329
T Loss: 9.581682
Epoch 2649 
Overall Loss: 12.613846
Rec Loss: 10.096367
KL Loss: 2.517479
Y Loss: 1.001482
T Loss: 9.595626
Epoch 2699 
Overall Loss: 12.606730
Rec Loss: 10.068352
KL Loss: 2.538378
Y Loss: 0.943533
T Loss: 9.596585
Epoch 2749 
Overall Loss: 12.571613
Rec Loss: 10.080737
KL Loss: 2.490876
Y Loss: 1.000069
T Loss: 9.580702
Epoch 2799 
Overall Loss: 12.589687
Rec Loss: 10.073162
KL Loss: 2.516525
Y Loss: 0.969268
T Loss: 9.588528
Epoch 2849 
Overall Loss: 12.598504
Rec Loss: 10.076933
KL Loss: 2.521571
Y Loss: 1.001263
T Loss: 9.576301
Epoch 2899 
Overall Loss: 12.568533
Rec Loss: 10.053161
KL Loss: 2.515372
Y Loss: 0.958317
T Loss: 9.574002
Epoch 2949 
Overall Loss: 12.586443
Rec Loss: 10.083361
KL Loss: 2.503082
Y Loss: 1.013955
T Loss: 9.576384
Epoch 2999 
Overall Loss: 12.561418
Rec Loss: 10.047202
KL Loss: 2.514216
Y Loss: 0.973464
T Loss: 9.560470
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.093232
Epoch 99
Rec Loss: 1.091476
Epoch 149
Rec Loss: 1.093223
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.187569
Epoch 99
Rec Loss: 10.195998
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.669526
Insample Error: 2.191176
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.998210
Epoch 99
Rec Loss: 4.004154
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.530045
Epoch 99
Rec Loss: 9.529299
Epoch 149
Rec Loss: 9.520073
Epoch 199
Rec Loss: 9.457483
Epoch 249
Rec Loss: 9.447944
Epoch 299
Rec Loss: 9.505371
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.758172
Insample Error 3.353668
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.627030
Epoch 99 
Prediction Loss: 3.416402
Epoch 149 
Prediction Loss: 3.235338
Epoch 199 
Prediction Loss: 3.186721
Epoch 249 
Prediction Loss: 3.130764
Epoch 299 
Prediction Loss: 3.101348
Epoch 349 
Prediction Loss: 3.056386
Epoch 399 
Prediction Loss: 3.025332
Epoch 449 
Prediction Loss: 2.990446
Epoch 499 
Prediction Loss: 3.011252
Epoch 549 
Prediction Loss: 2.974991
Epoch 599 
Prediction Loss: 2.946448
Epoch 649 
Prediction Loss: 2.957682
Epoch 699 
Prediction Loss: 2.901023
Epoch 749 
Prediction Loss: 2.882303
Epoch 799 
Prediction Loss: 2.868782
Epoch 849 
Prediction Loss: 2.855717
Epoch 899 
Prediction Loss: 2.843833
Epoch 949 
Prediction Loss: 2.848729
Epoch 999 
Prediction Loss: 2.797342
Epoch 1049 
Prediction Loss: 2.783705
Epoch 1099 
Prediction Loss: 2.765142
Epoch 1149 
Prediction Loss: 2.767270
Epoch 1199 
Prediction Loss: 2.725524
Epoch 1249 
Prediction Loss: 2.705221
Epoch 1299 
Prediction Loss: 2.691983
Epoch 1349 
Prediction Loss: 2.709926
Epoch 1399 
Prediction Loss: 2.647318
Epoch 1449 
Prediction Loss: 2.648649
Epoch 1499 
Prediction Loss: 2.650934
Epoch 1549 
Prediction Loss: 2.609774
Epoch 1599 
Prediction Loss: 2.583840
Epoch 1649 
Prediction Loss: 2.578357
Epoch 1699 
Prediction Loss: 2.541311
Epoch 1749 
Prediction Loss: 2.535709
Epoch 1799 
Prediction Loss: 2.513731
Epoch 1849 
Prediction Loss: 2.543282
Epoch 1899 
Prediction Loss: 2.513923
Epoch 1949 
Prediction Loss: 2.469302
Epoch 1999 
Prediction Loss: 2.460188
Epoch 2049 
Prediction Loss: 2.443482
Epoch 2099 
Prediction Loss: 2.420983
Epoch 2149 
Prediction Loss: 2.417690
Epoch 2199 
Prediction Loss: 2.383352
Epoch 2249 
Prediction Loss: 2.376261
Epoch 2299 
Prediction Loss: 2.372922
Epoch 2349 
Prediction Loss: 2.358378
Epoch 2399 
Prediction Loss: 2.349696
Epoch 2449 
Prediction Loss: 2.345041
Epoch 2499 
Prediction Loss: 2.340411
Epoch 2549 
Prediction Loss: 2.319875
Epoch 2599 
Prediction Loss: 2.306093
Epoch 2649 
Prediction Loss: 2.292305
Epoch 2699 
Prediction Loss: 2.303678
Epoch 2749 
Prediction Loss: 2.271153
Epoch 2799 
Prediction Loss: 2.272093
Epoch 2849 
Prediction Loss: 2.296222
Epoch 2899 
Prediction Loss: 2.243854
Epoch 2949 
Prediction Loss: 2.230313
Epoch 2999 
Prediction Loss: 2.207827
Epoch 3049 
Prediction Loss: 2.202476
Epoch 3099 
Prediction Loss: 2.191887
Epoch 3149 
Prediction Loss: 2.207311
Epoch 3199 
Prediction Loss: 2.186910
Epoch 3249 
Prediction Loss: 2.181722
Epoch 3299 
Prediction Loss: 2.172292
Epoch 3349 
Prediction Loss: 2.143031
Epoch 3399 
Prediction Loss: 2.153508
Epoch 3449 
Prediction Loss: 2.160358
Epoch 3499 
Prediction Loss: 2.120392
Epoch 3549 
Prediction Loss: 2.136983
Epoch 3599 
Prediction Loss: 2.134221
Epoch 3649 
Prediction Loss: 2.141325
Epoch 3699 
Prediction Loss: 2.097798
Epoch 3749 
Prediction Loss: 2.080309
Epoch 3799 
Prediction Loss: 2.079195
Epoch 3849 
Prediction Loss: 2.065078
Epoch 3899 
Prediction Loss: 2.059991
Epoch 3949 
Prediction Loss: 2.049531
Epoch 3999 
Prediction Loss: 2.038606
Epoch 4049 
Prediction Loss: 2.060514
Epoch 4099 
Prediction Loss: 2.031815
Epoch 4149 
Prediction Loss: 2.061514
Epoch 4199 
Prediction Loss: 2.024687
Epoch 4249 
Prediction Loss: 2.044665
Epoch 4299 
Prediction Loss: 1.995132
Epoch 4349 
Prediction Loss: 2.014348
Epoch 4399 
Prediction Loss: 1.990759
Epoch 4449 
Prediction Loss: 1.998314
Epoch 4499 
Prediction Loss: 1.973137
Epoch 4549 
Prediction Loss: 1.976960
Epoch 4599 
Prediction Loss: 1.962341
Epoch 4649 
Prediction Loss: 1.957571
Epoch 4699 
Prediction Loss: 1.972718
Epoch 4749 
Prediction Loss: 1.950338
Epoch 4799 
Prediction Loss: 1.961529
Epoch 4849 
Prediction Loss: 1.938470
Epoch 4899 
Prediction Loss: 1.913712
Epoch 4949 
Prediction Loss: 1.906628
Epoch 4999 
Prediction Loss: 1.938926
Epoch 5049 
Prediction Loss: 1.901922
Epoch 5099 
Prediction Loss: 1.892464
Epoch 5149 
Prediction Loss: 1.892515
Epoch 5199 
Prediction Loss: 1.883447
Epoch 5249 
Prediction Loss: 1.885834
Epoch 5299 
Prediction Loss: 1.875224
Epoch 5349 
Prediction Loss: 1.880179
Epoch 5399 
Prediction Loss: 1.862029
Epoch 5449 
Prediction Loss: 1.863027
Epoch 5499 
Prediction Loss: 1.863487
Epoch 5549 
Prediction Loss: 1.850561
Epoch 5599 
Prediction Loss: 1.850843
Epoch 5649 
Prediction Loss: 1.845138
Epoch 5699 
Prediction Loss: 1.842961
Epoch 5749 
Prediction Loss: 1.819696
Epoch 5799 
Prediction Loss: 1.850701
Epoch 5849 
Prediction Loss: 1.818657
Epoch 5899 
Prediction Loss: 1.805486
Epoch 5949 
Prediction Loss: 1.820504
Epoch 5999 
Prediction Loss: 1.823620
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.343981
Insample Error 3.623321
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.918928
Rec Loss: 10.259101
KL Loss: 2.659828
Y Loss: 1.011744
T Loss: 9.753229
Epoch 99 
Overall Loss: 12.816691
Rec Loss: 10.194806
KL Loss: 2.621885
Y Loss: 0.999000
T Loss: 9.695306
Epoch 149 
Overall Loss: 12.787374
Rec Loss: 10.199288
KL Loss: 2.588087
Y Loss: 0.995972
T Loss: 9.701301
Epoch 199 
Overall Loss: 12.722522
Rec Loss: 10.191544
KL Loss: 2.530978
Y Loss: 1.001587
T Loss: 9.690751
Epoch 249 
Overall Loss: 12.744786
Rec Loss: 10.217650
KL Loss: 2.527135
Y Loss: 1.024121
T Loss: 9.705590
Epoch 299 
Overall Loss: 12.688738
Rec Loss: 10.173038
KL Loss: 2.515700
Y Loss: 0.963779
T Loss: 9.691149
Epoch 349 
Overall Loss: 12.690848
Rec Loss: 10.160826
KL Loss: 2.530022
Y Loss: 0.998341
T Loss: 9.661655
Epoch 399 
Overall Loss: 12.704207
Rec Loss: 10.147562
KL Loss: 2.556645
Y Loss: 0.975401
T Loss: 9.659862
Epoch 449 
Overall Loss: 12.690922
Rec Loss: 10.141057
KL Loss: 2.549865
Y Loss: 1.000082
T Loss: 9.641016
Epoch 499 
Overall Loss: 12.681388
Rec Loss: 10.157019
KL Loss: 2.524369
Y Loss: 0.991113
T Loss: 9.661462
Epoch 549 
Overall Loss: 12.686520
Rec Loss: 10.135146
KL Loss: 2.551375
Y Loss: 0.981072
T Loss: 9.644610
Epoch 599 
Overall Loss: 12.647747
Rec Loss: 10.146577
KL Loss: 2.501170
Y Loss: 0.973341
T Loss: 9.659907
Epoch 649 
Overall Loss: 12.662701
Rec Loss: 10.153533
KL Loss: 2.509168
Y Loss: 0.995095
T Loss: 9.655985
Epoch 699 
Overall Loss: 12.657677
Rec Loss: 10.128929
KL Loss: 2.528748
Y Loss: 0.979897
T Loss: 9.638980
Epoch 749 
Overall Loss: 12.660389
Rec Loss: 10.129073
KL Loss: 2.531316
Y Loss: 0.995191
T Loss: 9.631477
Epoch 799 
Overall Loss: 12.610540
Rec Loss: 10.100050
KL Loss: 2.510491
Y Loss: 0.972403
T Loss: 9.613849
Epoch 849 
Overall Loss: 12.656920
Rec Loss: 10.157926
KL Loss: 2.498994
Y Loss: 0.997698
T Loss: 9.659077
Epoch 899 
Overall Loss: 12.639555
Rec Loss: 10.105307
KL Loss: 2.534248
Y Loss: 0.963359
T Loss: 9.623627
Epoch 949 
Overall Loss: 12.638389
Rec Loss: 10.119855
KL Loss: 2.518534
Y Loss: 0.985431
T Loss: 9.627140
Epoch 999 
Overall Loss: 12.640256
Rec Loss: 10.137513
KL Loss: 2.502743
Y Loss: 1.019584
T Loss: 9.627722
Epoch 1049 
Overall Loss: 12.644437
Rec Loss: 10.133924
KL Loss: 2.510513
Y Loss: 1.006619
T Loss: 9.630615
Epoch 1099 
Overall Loss: 12.622968
Rec Loss: 10.081411
KL Loss: 2.541557
Y Loss: 0.954342
T Loss: 9.604240
Epoch 1149 
Overall Loss: 12.638459
Rec Loss: 10.145273
KL Loss: 2.493187
Y Loss: 1.019668
T Loss: 9.635439
Epoch 1199 
Overall Loss: 12.627870
Rec Loss: 10.118088
KL Loss: 2.509782
Y Loss: 0.985702
T Loss: 9.625236
Epoch 1249 
Overall Loss: 12.645761
Rec Loss: 10.088470
KL Loss: 2.557292
Y Loss: 0.970947
T Loss: 9.602996
Epoch 1299 
Overall Loss: 12.603346
Rec Loss: 10.102906
KL Loss: 2.500440
Y Loss: 0.970583
T Loss: 9.617614
Epoch 1349 
Overall Loss: 12.619700
Rec Loss: 10.090381
KL Loss: 2.529318
Y Loss: 0.975155
T Loss: 9.602804
Epoch 1399 
Overall Loss: 12.614903
Rec Loss: 10.085693
KL Loss: 2.529210
Y Loss: 0.960458
T Loss: 9.605464
Epoch 1449 
Overall Loss: 12.616020
Rec Loss: 10.106943
KL Loss: 2.509078
Y Loss: 0.979885
T Loss: 9.617000
Epoch 1499 
Overall Loss: 12.606964
Rec Loss: 10.066816
KL Loss: 2.540149
Y Loss: 0.960064
T Loss: 9.586783
Epoch 1549 
Overall Loss: 12.625526
Rec Loss: 10.103386
KL Loss: 2.522140
Y Loss: 1.000837
T Loss: 9.602967
Epoch 1599 
Overall Loss: 12.605129
Rec Loss: 10.097455
KL Loss: 2.507674
Y Loss: 0.992383
T Loss: 9.601263
Epoch 1649 
Overall Loss: 12.587053
Rec Loss: 10.092520
KL Loss: 2.494533
Y Loss: 0.965439
T Loss: 9.609800
Epoch 1699 
Overall Loss: 12.621364
Rec Loss: 10.110648
KL Loss: 2.510716
Y Loss: 1.000160
T Loss: 9.610568
Epoch 1749 
Overall Loss: 12.616854
Rec Loss: 10.076549
KL Loss: 2.540305
Y Loss: 0.980456
T Loss: 9.586321
Epoch 1799 
Overall Loss: 12.630706
Rec Loss: 10.121936
KL Loss: 2.508770
Y Loss: 0.991673
T Loss: 9.626099
Epoch 1849 
Overall Loss: 12.610147
Rec Loss: 10.095929
KL Loss: 2.514218
Y Loss: 0.959318
T Loss: 9.616270
Epoch 1899 
Overall Loss: 12.593191
Rec Loss: 10.079867
KL Loss: 2.513324
Y Loss: 0.973939
T Loss: 9.592897
Epoch 1949 
Overall Loss: 12.621369
Rec Loss: 10.088029
KL Loss: 2.533340
Y Loss: 0.983779
T Loss: 9.596139
Epoch 1999 
Overall Loss: 12.600961
Rec Loss: 10.108727
KL Loss: 2.492234
Y Loss: 0.999981
T Loss: 9.608737
Epoch 2049 
Overall Loss: 12.619444
Rec Loss: 10.075697
KL Loss: 2.543747
Y Loss: 0.991166
T Loss: 9.580113
Epoch 2099 
Overall Loss: 12.617484
Rec Loss: 10.119402
KL Loss: 2.498082
Y Loss: 1.021395
T Loss: 9.608704
Epoch 2149 
Overall Loss: 12.573100
Rec Loss: 10.055928
KL Loss: 2.517171
Y Loss: 0.962723
T Loss: 9.574567
Epoch 2199 
Overall Loss: 12.605723
Rec Loss: 10.095300
KL Loss: 2.510423
Y Loss: 0.970233
T Loss: 9.610184
Epoch 2249 
Overall Loss: 12.602239
Rec Loss: 10.110552
KL Loss: 2.491687
Y Loss: 0.996329
T Loss: 9.612387
Epoch 2299 
Overall Loss: 12.612510
Rec Loss: 10.093152
KL Loss: 2.519359
Y Loss: 0.969541
T Loss: 9.608381
Epoch 2349 
Overall Loss: 12.612118
Rec Loss: 10.077420
KL Loss: 2.534697
Y Loss: 0.970564
T Loss: 9.592139
Epoch 2399 
Overall Loss: 12.596630
Rec Loss: 10.107495
KL Loss: 2.489135
Y Loss: 1.004773
T Loss: 9.605109
Epoch 2449 
Overall Loss: 12.600694
Rec Loss: 10.087563
KL Loss: 2.513130
Y Loss: 0.986688
T Loss: 9.594219
Epoch 2499 
Overall Loss: 12.598077
Rec Loss: 10.077907
KL Loss: 2.520170
Y Loss: 0.991914
T Loss: 9.581950
Epoch 2549 
Overall Loss: 12.600643
Rec Loss: 10.082006
KL Loss: 2.518637
Y Loss: 0.953107
T Loss: 9.605452
Epoch 2599 
Overall Loss: 12.595126
Rec Loss: 10.074242
KL Loss: 2.520884
Y Loss: 0.983911
T Loss: 9.582286
Epoch 2649 
Overall Loss: 12.604170
Rec Loss: 10.085692
KL Loss: 2.518478
Y Loss: 0.997331
T Loss: 9.587027
Epoch 2699 
Overall Loss: 12.578210
Rec Loss: 10.074332
KL Loss: 2.503879
Y Loss: 0.991305
T Loss: 9.578680
Epoch 2749 
Overall Loss: 12.603074
Rec Loss: 10.095618
KL Loss: 2.507456
Y Loss: 1.002275
T Loss: 9.594481
Epoch 2799 
Overall Loss: 12.576314
Rec Loss: 10.088127
KL Loss: 2.488187
Y Loss: 1.008178
T Loss: 9.584038
Epoch 2849 
Overall Loss: 12.599584
Rec Loss: 10.100415
KL Loss: 2.499169
Y Loss: 1.013644
T Loss: 9.593593
Epoch 2899 
Overall Loss: 12.584839
Rec Loss: 10.080776
KL Loss: 2.504063
Y Loss: 0.996348
T Loss: 9.582602
Epoch 2949 
Overall Loss: 12.605719
Rec Loss: 10.068332
KL Loss: 2.537387
Y Loss: 0.963750
T Loss: 9.586457
Epoch 2999 
Overall Loss: 12.592914
Rec Loss: 10.067231
KL Loss: 2.525683
Y Loss: 0.968180
T Loss: 9.583141
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.106845
Epoch 99
Rec Loss: 1.099770
Epoch 149
Rec Loss: 1.096947
Epoch 199
Rec Loss: 1.084769
Epoch 249
Rec Loss: 1.095515
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.186243
Epoch 99
Rec Loss: 10.183089
Epoch 149
Rec Loss: 10.171180
Epoch 199
Rec Loss: 10.174165
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.654782
Insample Error: 2.341031
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.992023
Epoch 99
Rec Loss: 3.991684
Epoch 149
Rec Loss: 3.999687
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.829225
Epoch 99
Rec Loss: 9.801453
Epoch 149
Rec Loss: 9.859962
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.763491
Insample Error 3.348004
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.565025
Epoch 99 
Prediction Loss: 3.335500
Epoch 149 
Prediction Loss: 3.198440
Epoch 199 
Prediction Loss: 3.149853
Epoch 249 
Prediction Loss: 3.121210
Epoch 299 
Prediction Loss: 3.090236
Epoch 349 
Prediction Loss: 3.066571
Epoch 399 
Prediction Loss: 3.063555
Epoch 449 
Prediction Loss: 3.056103
Epoch 499 
Prediction Loss: 3.042136
Epoch 549 
Prediction Loss: 3.001950
Epoch 599 
Prediction Loss: 3.010655
Epoch 649 
Prediction Loss: 2.964640
Epoch 699 
Prediction Loss: 2.963393
Epoch 749 
Prediction Loss: 2.962141
Epoch 799 
Prediction Loss: 2.923450
Epoch 849 
Prediction Loss: 2.930326
Epoch 899 
Prediction Loss: 2.916028
Epoch 949 
Prediction Loss: 2.889426
Epoch 999 
Prediction Loss: 2.880715
Epoch 1049 
Prediction Loss: 2.889212
Epoch 1099 
Prediction Loss: 2.849864
Epoch 1149 
Prediction Loss: 2.849963
Epoch 1199 
Prediction Loss: 2.843706
Epoch 1249 
Prediction Loss: 2.821315
Epoch 1299 
Prediction Loss: 2.812544
Epoch 1349 
Prediction Loss: 2.813770
Epoch 1399 
Prediction Loss: 2.779102
Epoch 1449 
Prediction Loss: 2.770362
Epoch 1499 
Prediction Loss: 2.748524
Epoch 1549 
Prediction Loss: 2.751551
Epoch 1599 
Prediction Loss: 2.800674
Epoch 1649 
Prediction Loss: 2.738619
Epoch 1699 
Prediction Loss: 2.737067
Epoch 1749 
Prediction Loss: 2.763356
Epoch 1799 
Prediction Loss: 2.678762
Epoch 1849 
Prediction Loss: 2.686911
Epoch 1899 
Prediction Loss: 2.664773
Epoch 1949 
Prediction Loss: 2.640381
Epoch 1999 
Prediction Loss: 2.631773
Epoch 2049 
Prediction Loss: 2.623742
Epoch 2099 
Prediction Loss: 2.610556
Epoch 2149 
Prediction Loss: 2.594650
Epoch 2199 
Prediction Loss: 2.633578
Epoch 2249 
Prediction Loss: 2.580529
Epoch 2299 
Prediction Loss: 2.577212
Epoch 2349 
Prediction Loss: 2.565558
Epoch 2399 
Prediction Loss: 2.545116
Epoch 2449 
Prediction Loss: 2.538600
Epoch 2499 
Prediction Loss: 2.568410
Epoch 2549 
Prediction Loss: 2.520776
Epoch 2599 
Prediction Loss: 2.514200
Epoch 2649 
Prediction Loss: 2.491874
Epoch 2699 
Prediction Loss: 2.486678
Epoch 2749 
Prediction Loss: 2.492601
Epoch 2799 
Prediction Loss: 2.476376
Epoch 2849 
Prediction Loss: 2.455774
Epoch 2899 
Prediction Loss: 2.446801
Epoch 2949 
Prediction Loss: 2.443779
Epoch 2999 
Prediction Loss: 2.459805
Epoch 3049 
Prediction Loss: 2.399461
Epoch 3099 
Prediction Loss: 2.401889
Epoch 3149 
Prediction Loss: 2.386238
Epoch 3199 
Prediction Loss: 2.370430
Epoch 3249 
Prediction Loss: 2.358606
Epoch 3299 
Prediction Loss: 2.362730
Epoch 3349 
Prediction Loss: 2.414400
Epoch 3399 
Prediction Loss: 2.339871
Epoch 3449 
Prediction Loss: 2.335107
Epoch 3499 
Prediction Loss: 2.333595
Epoch 3549 
Prediction Loss: 2.337930
Epoch 3599 
Prediction Loss: 2.313392
Epoch 3649 
Prediction Loss: 2.297706
Epoch 3699 
Prediction Loss: 2.287767
Epoch 3749 
Prediction Loss: 2.272870
Epoch 3799 
Prediction Loss: 2.267979
Epoch 3849 
Prediction Loss: 2.259371
Epoch 3899 
Prediction Loss: 2.246490
Epoch 3949 
Prediction Loss: 2.246236
Epoch 3999 
Prediction Loss: 2.219735
Epoch 4049 
Prediction Loss: 2.240262
Epoch 4099 
Prediction Loss: 2.203214
Epoch 4149 
Prediction Loss: 2.213229
Epoch 4199 
Prediction Loss: 2.184709
Epoch 4249 
Prediction Loss: 2.169965
Epoch 4299 
Prediction Loss: 2.202188
Epoch 4349 
Prediction Loss: 2.148577
Epoch 4399 
Prediction Loss: 2.153604
Epoch 4449 
Prediction Loss: 2.165399
Epoch 4499 
Prediction Loss: 2.155431
Epoch 4549 
Prediction Loss: 2.127115
Epoch 4599 
Prediction Loss: 2.136717
Epoch 4649 
Prediction Loss: 2.123771
Epoch 4699 
Prediction Loss: 2.110792
Epoch 4749 
Prediction Loss: 2.083043
Epoch 4799 
Prediction Loss: 2.092521
Epoch 4849 
Prediction Loss: 2.062227
Epoch 4899 
Prediction Loss: 2.073117
Epoch 4949 
Prediction Loss: 2.069755
Epoch 4999 
Prediction Loss: 2.064379
Epoch 5049 
Prediction Loss: 2.074245
Epoch 5099 
Prediction Loss: 2.042263
Epoch 5149 
Prediction Loss: 2.050653
Epoch 5199 
Prediction Loss: 2.045693
Epoch 5249 
Prediction Loss: 2.024129
Epoch 5299 
Prediction Loss: 2.034214
Epoch 5349 
Prediction Loss: 2.003094
Epoch 5399 
Prediction Loss: 2.003922
Epoch 5449 
Prediction Loss: 2.004107
Epoch 5499 
Prediction Loss: 1.984934
Epoch 5549 
Prediction Loss: 2.027653
Epoch 5599 
Prediction Loss: 1.968076
Epoch 5649 
Prediction Loss: 2.003133
Epoch 5699 
Prediction Loss: 1.972590
Epoch 5749 
Prediction Loss: 1.963293
Epoch 5799 
Prediction Loss: 1.951949
Epoch 5849 
Prediction Loss: 1.960293
Epoch 5899 
Prediction Loss: 1.974799
Epoch 5949 
Prediction Loss: 1.942490
Epoch 5999 
Prediction Loss: 1.931059
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.399030
Insample Error 3.584529
[31m========== repeat time 4 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.914257
Rec Loss: 10.328562
KL Loss: 2.585695
Y Loss: 1.105034
T Loss: 9.776045
Epoch 99 
Overall Loss: 12.817796
Rec Loss: 10.201678
KL Loss: 2.616118
Y Loss: 0.988914
T Loss: 9.707221
Epoch 149 
Overall Loss: 12.747452
Rec Loss: 10.196599
KL Loss: 2.550853
Y Loss: 0.999024
T Loss: 9.697087
Epoch 199 
Overall Loss: 12.738121
Rec Loss: 10.184991
KL Loss: 2.553130
Y Loss: 0.999989
T Loss: 9.684996
Epoch 249 
Overall Loss: 12.721564
Rec Loss: 10.187846
KL Loss: 2.533717
Y Loss: 0.992960
T Loss: 9.691366
Epoch 299 
Overall Loss: 12.707730
Rec Loss: 10.167244
KL Loss: 2.540485
Y Loss: 1.004654
T Loss: 9.664918
Epoch 349 
Overall Loss: 12.680097
Rec Loss: 10.140879
KL Loss: 2.539217
Y Loss: 0.963182
T Loss: 9.659289
Epoch 399 
Overall Loss: 12.677866
Rec Loss: 10.175815
KL Loss: 2.502052
Y Loss: 0.961548
T Loss: 9.695041
Epoch 449 
Overall Loss: 12.666080
Rec Loss: 10.175117
KL Loss: 2.490963
Y Loss: 1.011581
T Loss: 9.669326
Epoch 499 
Overall Loss: 12.681019
Rec Loss: 10.172570
KL Loss: 2.508450
Y Loss: 0.989365
T Loss: 9.677887
Epoch 549 
Overall Loss: 12.688570
Rec Loss: 10.167070
KL Loss: 2.521500
Y Loss: 0.988572
T Loss: 9.672784
Epoch 599 
Overall Loss: 12.666058
Rec Loss: 10.153462
KL Loss: 2.512596
Y Loss: 0.995381
T Loss: 9.655771
Epoch 649 
Overall Loss: 12.634974
Rec Loss: 10.132009
KL Loss: 2.502965
Y Loss: 0.976219
T Loss: 9.643900
Epoch 699 
Overall Loss: 12.665507
Rec Loss: 10.145059
KL Loss: 2.520448
Y Loss: 0.971742
T Loss: 9.659187
Epoch 749 
Overall Loss: 12.640176
Rec Loss: 10.112095
KL Loss: 2.528081
Y Loss: 0.968796
T Loss: 9.627697
Epoch 799 
Overall Loss: 12.678825
Rec Loss: 10.119438
KL Loss: 2.559387
Y Loss: 0.973647
T Loss: 9.632615
Epoch 849 
Overall Loss: 12.654041
Rec Loss: 10.132599
KL Loss: 2.521443
Y Loss: 0.984447
T Loss: 9.640375
Epoch 899 
Overall Loss: 12.657356
Rec Loss: 10.126817
KL Loss: 2.530539
Y Loss: 0.974085
T Loss: 9.639775
Epoch 949 
Overall Loss: 12.630588
Rec Loss: 10.099896
KL Loss: 2.530691
Y Loss: 0.980582
T Loss: 9.609606
Epoch 999 
Overall Loss: 12.621069
Rec Loss: 10.163179
KL Loss: 2.457891
Y Loss: 1.036207
T Loss: 9.645075
Epoch 1049 
Overall Loss: 12.672214
Rec Loss: 10.093964
KL Loss: 2.578250
Y Loss: 0.977802
T Loss: 9.605063
Epoch 1099 
Overall Loss: 12.633316
Rec Loss: 10.126169
KL Loss: 2.507146
Y Loss: 0.988789
T Loss: 9.631775
Epoch 1149 
Overall Loss: 12.632930
Rec Loss: 10.080336
KL Loss: 2.552594
Y Loss: 0.990932
T Loss: 9.584870
Epoch 1199 
Overall Loss: 12.637671
Rec Loss: 10.107435
KL Loss: 2.530237
Y Loss: 0.990939
T Loss: 9.611965
Epoch 1249 
Overall Loss: 12.635981
Rec Loss: 10.120605
KL Loss: 2.515376
Y Loss: 0.970852
T Loss: 9.635179
Epoch 1299 
Overall Loss: 12.643429
Rec Loss: 10.105592
KL Loss: 2.537837
Y Loss: 0.960097
T Loss: 9.625544
Epoch 1349 
Overall Loss: 12.632421
Rec Loss: 10.107921
KL Loss: 2.524499
Y Loss: 0.972077
T Loss: 9.621883
Epoch 1399 
Overall Loss: 12.633833
Rec Loss: 10.118149
KL Loss: 2.515684
Y Loss: 1.003816
T Loss: 9.616241
Epoch 1449 
Overall Loss: 12.617325
Rec Loss: 10.121978
KL Loss: 2.495347
Y Loss: 0.999218
T Loss: 9.622369
Epoch 1499 
Overall Loss: 12.644192
Rec Loss: 10.096498
KL Loss: 2.547693
Y Loss: 0.986430
T Loss: 9.603284
Epoch 1549 
Overall Loss: 12.608736
Rec Loss: 10.103925
KL Loss: 2.504811
Y Loss: 0.988277
T Loss: 9.609786
Epoch 1599 
Overall Loss: 12.647916
Rec Loss: 10.111269
KL Loss: 2.536647
Y Loss: 0.958582
T Loss: 9.631978
Epoch 1649 
Overall Loss: 12.612499
Rec Loss: 10.095231
KL Loss: 2.517267
Y Loss: 0.954350
T Loss: 9.618056
Epoch 1699 
Overall Loss: 12.620496
Rec Loss: 10.098785
KL Loss: 2.521711
Y Loss: 0.958864
T Loss: 9.619353
Epoch 1749 
Overall Loss: 12.612941
Rec Loss: 10.075046
KL Loss: 2.537895
Y Loss: 0.978220
T Loss: 9.585936
Epoch 1799 
Overall Loss: 12.619105
Rec Loss: 10.112337
KL Loss: 2.506769
Y Loss: 0.960374
T Loss: 9.632150
Epoch 1849 
Overall Loss: 12.591759
Rec Loss: 10.094334
KL Loss: 2.497425
Y Loss: 0.977547
T Loss: 9.605560
Epoch 1899 
Overall Loss: 12.615664
Rec Loss: 10.086747
KL Loss: 2.528917
Y Loss: 0.970955
T Loss: 9.601270
Epoch 1949 
Overall Loss: 12.601852
Rec Loss: 10.090883
KL Loss: 2.510969
Y Loss: 0.993217
T Loss: 9.594275
Epoch 1999 
Overall Loss: 12.605742
Rec Loss: 10.084973
KL Loss: 2.520768
Y Loss: 0.972042
T Loss: 9.598952
Epoch 2049 
Overall Loss: 12.633502
Rec Loss: 10.107949
KL Loss: 2.525553
Y Loss: 0.979930
T Loss: 9.617984
Epoch 2099 
Overall Loss: 12.581791
Rec Loss: 10.089120
KL Loss: 2.492671
Y Loss: 0.961414
T Loss: 9.608413
Epoch 2149 
Overall Loss: 12.615057
Rec Loss: 10.099210
KL Loss: 2.515847
Y Loss: 0.973748
T Loss: 9.612336
Epoch 2199 
Overall Loss: 12.613003
Rec Loss: 10.107804
KL Loss: 2.505198
Y Loss: 0.976215
T Loss: 9.619697
Epoch 2249 
Overall Loss: 12.596811
Rec Loss: 10.082236
KL Loss: 2.514575
Y Loss: 0.968841
T Loss: 9.597815
Epoch 2299 
Overall Loss: 12.594684
Rec Loss: 10.095602
KL Loss: 2.499082
Y Loss: 0.962701
T Loss: 9.614251
Epoch 2349 
Overall Loss: 12.589831
Rec Loss: 10.085825
KL Loss: 2.504005
Y Loss: 0.970798
T Loss: 9.600426
Epoch 2399 
Overall Loss: 12.608017
Rec Loss: 10.091129
KL Loss: 2.516888
Y Loss: 0.984232
T Loss: 9.599013
Epoch 2449 
Overall Loss: 12.600702
Rec Loss: 10.072843
KL Loss: 2.527859
Y Loss: 0.959597
T Loss: 9.593044
Epoch 2499 
Overall Loss: 12.588297
Rec Loss: 10.073370
KL Loss: 2.514926
Y Loss: 0.984122
T Loss: 9.581310
Epoch 2549 
Overall Loss: 12.586838
Rec Loss: 10.079558
KL Loss: 2.507279
Y Loss: 0.979844
T Loss: 9.589636
Epoch 2599 
Overall Loss: 12.584962
Rec Loss: 10.091415
KL Loss: 2.493548
Y Loss: 0.974225
T Loss: 9.604302
Epoch 2649 
Overall Loss: 12.608291
Rec Loss: 10.084142
KL Loss: 2.524150
Y Loss: 0.993480
T Loss: 9.587402
Epoch 2699 
Overall Loss: 12.588192
Rec Loss: 10.104012
KL Loss: 2.484180
Y Loss: 0.988105
T Loss: 9.609959
Epoch 2749 
Overall Loss: 12.597447
Rec Loss: 10.102716
KL Loss: 2.494731
Y Loss: 0.988356
T Loss: 9.608539
Epoch 2799 
Overall Loss: 12.567947
Rec Loss: 10.078961
KL Loss: 2.488986
Y Loss: 0.983463
T Loss: 9.587230
Epoch 2849 
Overall Loss: 12.576937
Rec Loss: 10.082691
KL Loss: 2.494245
Y Loss: 0.972782
T Loss: 9.596300
Epoch 2899 
Overall Loss: 12.589286
Rec Loss: 10.091785
KL Loss: 2.497501
Y Loss: 0.998036
T Loss: 9.592766
Epoch 2949 
Overall Loss: 12.579449
Rec Loss: 10.072539
KL Loss: 2.506910
Y Loss: 0.963341
T Loss: 9.590868
Epoch 2999 
Overall Loss: 12.584105
Rec Loss: 10.077474
KL Loss: 2.506631
Y Loss: 0.976344
T Loss: 9.589302
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.096432
Epoch 99
Rec Loss: 1.093280
Epoch 149
Rec Loss: 1.082775
Epoch 199
Rec Loss: 1.081084
Epoch 249
Rec Loss: 1.085156
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.184315
Epoch 99
Rec Loss: 10.187516
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.669172
Insample Error: 2.241349
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.011257
Epoch 99
Rec Loss: 4.012066
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.754489
Epoch 99
Rec Loss: 9.702547
Epoch 149
Rec Loss: 9.651998
Epoch 199
Rec Loss: 9.667347
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.817574
Insample Error 3.347142
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.592079
Epoch 99 
Prediction Loss: 3.372350
Epoch 149 
Prediction Loss: 3.236235
Epoch 199 
Prediction Loss: 3.201554
Epoch 249 
Prediction Loss: 3.122307
Epoch 299 
Prediction Loss: 3.093136
Epoch 349 
Prediction Loss: 3.059083
Epoch 399 
Prediction Loss: 3.041956
Epoch 449 
Prediction Loss: 3.024739
Epoch 499 
Prediction Loss: 3.033743
Epoch 549 
Prediction Loss: 3.013014
Epoch 599 
Prediction Loss: 2.974085
Epoch 649 
Prediction Loss: 3.007526
Epoch 699 
Prediction Loss: 2.960455
Epoch 749 
Prediction Loss: 2.943645
Epoch 799 
Prediction Loss: 2.922147
Epoch 849 
Prediction Loss: 2.932005
Epoch 899 
Prediction Loss: 2.899542
Epoch 949 
Prediction Loss: 2.887982
Epoch 999 
Prediction Loss: 2.897722
Epoch 1049 
Prediction Loss: 2.876026
Epoch 1099 
Prediction Loss: 2.879431
Epoch 1149 
Prediction Loss: 2.856653
Epoch 1199 
Prediction Loss: 2.860348
Epoch 1249 
Prediction Loss: 2.863319
Epoch 1299 
Prediction Loss: 2.817101
Epoch 1349 
Prediction Loss: 2.800530
Epoch 1399 
Prediction Loss: 2.804231
Epoch 1449 
Prediction Loss: 2.782375
Epoch 1499 
Prediction Loss: 2.802337
Epoch 1549 
Prediction Loss: 2.765978
Epoch 1599 
Prediction Loss: 2.739316
Epoch 1649 
Prediction Loss: 2.770223
Epoch 1699 
Prediction Loss: 2.725011
Epoch 1749 
Prediction Loss: 2.712986
Epoch 1799 
Prediction Loss: 2.702298
Epoch 1849 
Prediction Loss: 2.686512
Epoch 1899 
Prediction Loss: 2.665506
Epoch 1949 
Prediction Loss: 2.663506
Epoch 1999 
Prediction Loss: 2.658425
Epoch 2049 
Prediction Loss: 2.652301
Epoch 2099 
Prediction Loss: 2.660222
Epoch 2149 
Prediction Loss: 2.642323
Epoch 2199 
Prediction Loss: 2.636835
Epoch 2249 
Prediction Loss: 2.630794
Epoch 2299 
Prediction Loss: 2.590789
Epoch 2349 
Prediction Loss: 2.605804
Epoch 2399 
Prediction Loss: 2.579567
Epoch 2449 
Prediction Loss: 2.597623
Epoch 2499 
Prediction Loss: 2.557200
Epoch 2549 
Prediction Loss: 2.569110
Epoch 2599 
Prediction Loss: 2.535647
Epoch 2649 
Prediction Loss: 2.561123
Epoch 2699 
Prediction Loss: 2.509601
Epoch 2749 
Prediction Loss: 2.500645
Epoch 2799 
Prediction Loss: 2.492892
Epoch 2849 
Prediction Loss: 2.507115
Epoch 2899 
Prediction Loss: 2.569188
Epoch 2949 
Prediction Loss: 2.466295
Epoch 2999 
Prediction Loss: 2.468722
Epoch 3049 
Prediction Loss: 2.463510
Epoch 3099 
Prediction Loss: 2.467630
Epoch 3149 
Prediction Loss: 2.443086
Epoch 3199 
Prediction Loss: 2.413106
Epoch 3249 
Prediction Loss: 2.412692
Epoch 3299 
Prediction Loss: 2.397088
Epoch 3349 
Prediction Loss: 2.412023
Epoch 3399 
Prediction Loss: 2.429496
Epoch 3449 
Prediction Loss: 2.376839
Epoch 3499 
Prediction Loss: 2.403623
Epoch 3549 
Prediction Loss: 2.357292
Epoch 3599 
Prediction Loss: 2.354453
Epoch 3649 
Prediction Loss: 2.362723
Epoch 3699 
Prediction Loss: 2.348126
Epoch 3749 
Prediction Loss: 2.317863
Epoch 3799 
Prediction Loss: 2.321006
Epoch 3849 
Prediction Loss: 2.305605
Epoch 3899 
Prediction Loss: 2.279482
Epoch 3949 
Prediction Loss: 2.301262
Epoch 3999 
Prediction Loss: 2.297137
Epoch 4049 
Prediction Loss: 2.272797
Epoch 4099 
Prediction Loss: 2.273850
Epoch 4149 
Prediction Loss: 2.257100
Epoch 4199 
Prediction Loss: 2.275361
Epoch 4249 
Prediction Loss: 2.251254
Epoch 4299 
Prediction Loss: 2.288145
Epoch 4349 
Prediction Loss: 2.220459
Epoch 4399 
Prediction Loss: 2.229458
Epoch 4449 
Prediction Loss: 2.221987
Epoch 4499 
Prediction Loss: 2.244644
Epoch 4549 
Prediction Loss: 2.220897
Epoch 4599 
Prediction Loss: 2.210591
Epoch 4649 
Prediction Loss: 2.193418
Epoch 4699 
Prediction Loss: 2.183400
Epoch 4749 
Prediction Loss: 2.167712
Epoch 4799 
Prediction Loss: 2.155444
Epoch 4849 
Prediction Loss: 2.150316
Epoch 4899 
Prediction Loss: 2.129689
Epoch 4949 
Prediction Loss: 2.130522
Epoch 4999 
Prediction Loss: 2.129037
Epoch 5049 
Prediction Loss: 2.128415
Epoch 5099 
Prediction Loss: 2.121744
Epoch 5149 
Prediction Loss: 2.119237
Epoch 5199 
Prediction Loss: 2.111796
Epoch 5249 
Prediction Loss: 2.095722
Epoch 5299 
Prediction Loss: 2.109754
Epoch 5349 
Prediction Loss: 2.070195
Epoch 5399 
Prediction Loss: 2.086413
Epoch 5449 
Prediction Loss: 2.055651
Epoch 5499 
Prediction Loss: 2.081256
Epoch 5549 
Prediction Loss: 2.050548
Epoch 5599 
Prediction Loss: 2.074320
Epoch 5649 
Prediction Loss: 2.033033
Epoch 5699 
Prediction Loss: 2.069209
Epoch 5749 
Prediction Loss: 2.090682
Epoch 5799 
Prediction Loss: 2.029814
Epoch 5849 
Prediction Loss: 2.019056
Epoch 5899 
Prediction Loss: 2.036473
Epoch 5949 
Prediction Loss: 2.034948
Epoch 5999 
Prediction Loss: 2.016634
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.412264
Insample Error 3.536670
[31m========== repeat time 5 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.928641
Rec Loss: 10.283298
KL Loss: 2.645342
Y Loss: 1.039774
T Loss: 9.763411
Epoch 99 
Overall Loss: 12.811546
Rec Loss: 10.201021
KL Loss: 2.610525
Y Loss: 0.989619
T Loss: 9.706212
Epoch 149 
Overall Loss: 12.774440
Rec Loss: 10.181169
KL Loss: 2.593271
Y Loss: 1.000396
T Loss: 9.680972
Epoch 199 
Overall Loss: 12.722734
Rec Loss: 10.140030
KL Loss: 2.582704
Y Loss: 0.974189
T Loss: 9.652936
Epoch 249 
Overall Loss: 12.721620
Rec Loss: 10.162043
KL Loss: 2.559576
Y Loss: 0.987246
T Loss: 9.668421
Epoch 299 
Overall Loss: 12.694717
Rec Loss: 10.161185
KL Loss: 2.533532
Y Loss: 0.995967
T Loss: 9.663202
Epoch 349 
Overall Loss: 12.699541
Rec Loss: 10.187212
KL Loss: 2.512329
Y Loss: 1.010132
T Loss: 9.682146
Epoch 399 
Overall Loss: 12.683091
Rec Loss: 10.135007
KL Loss: 2.548085
Y Loss: 0.980789
T Loss: 9.644612
Epoch 449 
Overall Loss: 12.674072
Rec Loss: 10.154164
KL Loss: 2.519908
Y Loss: 0.981990
T Loss: 9.663170
Epoch 499 
Overall Loss: 12.698672
Rec Loss: 10.180165
KL Loss: 2.518507
Y Loss: 1.014070
T Loss: 9.673130
Epoch 549 
Overall Loss: 12.673530
Rec Loss: 10.144763
KL Loss: 2.528768
Y Loss: 0.986107
T Loss: 9.651709
Epoch 599 
Overall Loss: 12.672857
Rec Loss: 10.174896
KL Loss: 2.497962
Y Loss: 1.006296
T Loss: 9.671748
Epoch 649 
Overall Loss: 12.668162
Rec Loss: 10.145538
KL Loss: 2.522624
Y Loss: 0.995407
T Loss: 9.647834
Epoch 699 
Overall Loss: 12.657697
Rec Loss: 10.119680
KL Loss: 2.538017
Y Loss: 0.991784
T Loss: 9.623788
Epoch 749 
Overall Loss: 12.657667
Rec Loss: 10.136689
KL Loss: 2.520978
Y Loss: 0.977669
T Loss: 9.647854
Epoch 799 
Overall Loss: 12.639903
Rec Loss: 10.090549
KL Loss: 2.549355
Y Loss: 0.956555
T Loss: 9.612271
Epoch 849 
Overall Loss: 12.648549
Rec Loss: 10.137247
KL Loss: 2.511301
Y Loss: 0.974163
T Loss: 9.650166
Epoch 899 
Overall Loss: 12.627248
Rec Loss: 10.093017
KL Loss: 2.534232
Y Loss: 0.987607
T Loss: 9.599213
Epoch 949 
Overall Loss: 12.662136
Rec Loss: 10.127332
KL Loss: 2.534804
Y Loss: 1.004339
T Loss: 9.625163
Epoch 999 
Overall Loss: 12.643034
Rec Loss: 10.135153
KL Loss: 2.507881
Y Loss: 0.996157
T Loss: 9.637075
Epoch 1049 
Overall Loss: 12.625396
Rec Loss: 10.105906
KL Loss: 2.519490
Y Loss: 0.972074
T Loss: 9.619869
Epoch 1099 
Overall Loss: 12.651212
Rec Loss: 10.114005
KL Loss: 2.537206
Y Loss: 0.984342
T Loss: 9.621834
Epoch 1149 
Overall Loss: 12.650752
Rec Loss: 10.132421
KL Loss: 2.518330
Y Loss: 0.986462
T Loss: 9.639191
Epoch 1199 
Overall Loss: 12.626102
Rec Loss: 10.101633
KL Loss: 2.524469
Y Loss: 0.952227
T Loss: 9.625519
Epoch 1249 
Overall Loss: 12.616078
Rec Loss: 10.126939
KL Loss: 2.489139
Y Loss: 0.974786
T Loss: 9.639547
Epoch 1299 
Overall Loss: 12.629666
Rec Loss: 10.120081
KL Loss: 2.509584
Y Loss: 0.985328
T Loss: 9.627417
Epoch 1349 
Overall Loss: 12.623902
Rec Loss: 10.121925
KL Loss: 2.501977
Y Loss: 0.978973
T Loss: 9.632439
Epoch 1399 
Overall Loss: 12.614613
Rec Loss: 10.098502
KL Loss: 2.516111
Y Loss: 0.979845
T Loss: 9.608580
Epoch 1449 
Overall Loss: 12.625968
Rec Loss: 10.117674
KL Loss: 2.508295
Y Loss: 0.993042
T Loss: 9.621153
Epoch 1499 
Overall Loss: 12.613260
Rec Loss: 10.095057
KL Loss: 2.518203
Y Loss: 0.969013
T Loss: 9.610550
Epoch 1549 
Overall Loss: 12.621323
Rec Loss: 10.130224
KL Loss: 2.491100
Y Loss: 0.996096
T Loss: 9.632176
Epoch 1599 
Overall Loss: 12.619778
Rec Loss: 10.102856
KL Loss: 2.516921
Y Loss: 0.985428
T Loss: 9.610142
Epoch 1649 
Overall Loss: 12.610940
Rec Loss: 10.083544
KL Loss: 2.527396
Y Loss: 0.981094
T Loss: 9.592997
Epoch 1699 
Overall Loss: 12.635705
Rec Loss: 10.089759
KL Loss: 2.545946
Y Loss: 0.998940
T Loss: 9.590289
Epoch 1749 
Overall Loss: 12.626325
Rec Loss: 10.098653
KL Loss: 2.527673
Y Loss: 0.989424
T Loss: 9.603940
Epoch 1799 
Overall Loss: 12.610421
Rec Loss: 10.081227
KL Loss: 2.529194
Y Loss: 0.965560
T Loss: 9.598447
Epoch 1849 
Overall Loss: 12.625257
Rec Loss: 10.095031
KL Loss: 2.530227
Y Loss: 0.999917
T Loss: 9.595073
Epoch 1899 
Overall Loss: 12.615216
Rec Loss: 10.126678
KL Loss: 2.488539
Y Loss: 1.010699
T Loss: 9.621328
Epoch 1949 
Overall Loss: 12.619616
Rec Loss: 10.104786
KL Loss: 2.514830
Y Loss: 0.983543
T Loss: 9.613014
Epoch 1999 
Overall Loss: 12.595129
Rec Loss: 10.068531
KL Loss: 2.526599
Y Loss: 0.983507
T Loss: 9.576778
Epoch 2049 
Overall Loss: 12.638465
Rec Loss: 10.083837
KL Loss: 2.554628
Y Loss: 0.989129
T Loss: 9.589273
Epoch 2099 
Overall Loss: 12.598271
Rec Loss: 10.077644
KL Loss: 2.520626
Y Loss: 0.962613
T Loss: 9.596338
Epoch 2149 
Overall Loss: 12.610221
Rec Loss: 10.108118
KL Loss: 2.502102
Y Loss: 0.990572
T Loss: 9.612832
Epoch 2199 
Overall Loss: 12.591045
Rec Loss: 10.085216
KL Loss: 2.505829
Y Loss: 0.964613
T Loss: 9.602910
Epoch 2249 
Overall Loss: 12.597171
Rec Loss: 10.083679
KL Loss: 2.513492
Y Loss: 0.982050
T Loss: 9.592654
Epoch 2299 
Overall Loss: 12.586105
Rec Loss: 10.100576
KL Loss: 2.485529
Y Loss: 0.959190
T Loss: 9.620981
Epoch 2349 
Overall Loss: 12.591243
Rec Loss: 10.070350
KL Loss: 2.520893
Y Loss: 0.974339
T Loss: 9.583180
Epoch 2399 
Overall Loss: 12.611167
Rec Loss: 10.085704
KL Loss: 2.525463
Y Loss: 0.985338
T Loss: 9.593035
Epoch 2449 
Overall Loss: 12.586139
Rec Loss: 10.072954
KL Loss: 2.513185
Y Loss: 0.970927
T Loss: 9.587490
Epoch 2499 
Overall Loss: 12.598620
Rec Loss: 10.068718
KL Loss: 2.529901
Y Loss: 0.962870
T Loss: 9.587284
Epoch 2549 
Overall Loss: 12.567246
Rec Loss: 10.083323
KL Loss: 2.483922
Y Loss: 0.957132
T Loss: 9.604758
Epoch 2599 
Overall Loss: 12.612037
Rec Loss: 10.056835
KL Loss: 2.555202
Y Loss: 0.983156
T Loss: 9.565257
Epoch 2649 
Overall Loss: 12.613420
Rec Loss: 10.092837
KL Loss: 2.520583
Y Loss: 0.995583
T Loss: 9.595046
Epoch 2699 
Overall Loss: 12.586288
Rec Loss: 10.073091
KL Loss: 2.513197
Y Loss: 0.975208
T Loss: 9.585487
Epoch 2749 
Overall Loss: 12.596798
Rec Loss: 10.081460
KL Loss: 2.515338
Y Loss: 1.000921
T Loss: 9.581000
Epoch 2799 
Overall Loss: 12.593895
Rec Loss: 10.065812
KL Loss: 2.528083
Y Loss: 0.974446
T Loss: 9.578588
Epoch 2849 
Overall Loss: 12.556250
Rec Loss: 10.061628
KL Loss: 2.494622
Y Loss: 0.974976
T Loss: 9.574140
Epoch 2899 
Overall Loss: 12.589282
Rec Loss: 10.061445
KL Loss: 2.527837
Y Loss: 0.950367
T Loss: 9.586261
Epoch 2949 
Overall Loss: 12.577456
Rec Loss: 10.081886
KL Loss: 2.495570
Y Loss: 0.961702
T Loss: 9.601035
Epoch 2999 
Overall Loss: 12.581579
Rec Loss: 10.054278
KL Loss: 2.527301
Y Loss: 0.981149
T Loss: 9.563703
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.097998
Epoch 99
Rec Loss: 1.083278
Epoch 149
Rec Loss: 1.089827
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.194748
Epoch 99
Rec Loss: 10.192982
Epoch 149
Rec Loss: 10.183659
Epoch 199
Rec Loss: 10.188682
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.655058
Insample Error: 2.169377
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.961833
Epoch 99
Rec Loss: 3.962552
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.782743
Epoch 99
Rec Loss: 9.877039
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.817902
Insample Error 3.324111
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.624618
Epoch 99 
Prediction Loss: 3.354085
Epoch 149 
Prediction Loss: 3.232518
Epoch 199 
Prediction Loss: 3.160204
Epoch 249 
Prediction Loss: 3.134349
Epoch 299 
Prediction Loss: 3.092148
Epoch 349 
Prediction Loss: 3.056740
Epoch 399 
Prediction Loss: 3.036959
Epoch 449 
Prediction Loss: 3.038941
Epoch 499 
Prediction Loss: 3.015925
Epoch 549 
Prediction Loss: 2.993137
Epoch 599 
Prediction Loss: 2.963721
Epoch 649 
Prediction Loss: 2.959762
Epoch 699 
Prediction Loss: 2.942091
Epoch 749 
Prediction Loss: 2.949542
Epoch 799 
Prediction Loss: 2.896918
Epoch 849 
Prediction Loss: 2.881661
Epoch 899 
Prediction Loss: 2.871791
Epoch 949 
Prediction Loss: 2.868243
Epoch 999 
Prediction Loss: 2.828970
Epoch 1049 
Prediction Loss: 2.838569
Epoch 1099 
Prediction Loss: 2.807411
Epoch 1149 
Prediction Loss: 2.817667
Epoch 1199 
Prediction Loss: 2.758805
Epoch 1249 
Prediction Loss: 2.757877
Epoch 1299 
Prediction Loss: 2.734786
Epoch 1349 
Prediction Loss: 2.726825
Epoch 1399 
Prediction Loss: 2.707900
Epoch 1449 
Prediction Loss: 2.678109
Epoch 1499 
Prediction Loss: 2.679588
Epoch 1549 
Prediction Loss: 2.667082
Epoch 1599 
Prediction Loss: 2.635017
Epoch 1649 
Prediction Loss: 2.634472
Epoch 1699 
Prediction Loss: 2.588577
Epoch 1749 
Prediction Loss: 2.575737
Epoch 1799 
Prediction Loss: 2.566906
Epoch 1849 
Prediction Loss: 2.558718
Epoch 1899 
Prediction Loss: 2.528890
Epoch 1949 
Prediction Loss: 2.535152
Epoch 1999 
Prediction Loss: 2.513744
Epoch 2049 
Prediction Loss: 2.515342
Epoch 2099 
Prediction Loss: 2.497351
Epoch 2149 
Prediction Loss: 2.462976
Epoch 2199 
Prediction Loss: 2.464886
Epoch 2249 
Prediction Loss: 2.434554
Epoch 2299 
Prediction Loss: 2.420365
Epoch 2349 
Prediction Loss: 2.402078
Epoch 2399 
Prediction Loss: 2.385717
Epoch 2449 
Prediction Loss: 2.405838
Epoch 2499 
Prediction Loss: 2.395114
Epoch 2549 
Prediction Loss: 2.356361
Epoch 2599 
Prediction Loss: 2.326554
Epoch 2649 
Prediction Loss: 2.327123
Epoch 2699 
Prediction Loss: 2.324731
Epoch 2749 
Prediction Loss: 2.297009
Epoch 2799 
Prediction Loss: 2.301672
Epoch 2849 
Prediction Loss: 2.283663
Epoch 2899 
Prediction Loss: 2.253619
Epoch 2949 
Prediction Loss: 2.256776
Epoch 2999 
Prediction Loss: 2.237906
Epoch 3049 
Prediction Loss: 2.215018
Epoch 3099 
Prediction Loss: 2.203065
Epoch 3149 
Prediction Loss: 2.238087
Epoch 3199 
Prediction Loss: 2.188467
Epoch 3249 
Prediction Loss: 2.172157
Epoch 3299 
Prediction Loss: 2.159051
Epoch 3349 
Prediction Loss: 2.148788
Epoch 3399 
Prediction Loss: 2.161144
Epoch 3449 
Prediction Loss: 2.122704
Epoch 3499 
Prediction Loss: 2.129271
Epoch 3549 
Prediction Loss: 2.112459
Epoch 3599 
Prediction Loss: 2.120695
Epoch 3649 
Prediction Loss: 2.082278
Epoch 3699 
Prediction Loss: 2.086876
Epoch 3749 
Prediction Loss: 2.076372
Epoch 3799 
Prediction Loss: 2.141827
Epoch 3849 
Prediction Loss: 2.048988
Epoch 3899 
Prediction Loss: 2.030044
Epoch 3949 
Prediction Loss: 2.039901
Epoch 3999 
Prediction Loss: 2.026765
Epoch 4049 
Prediction Loss: 1.999610
Epoch 4099 
Prediction Loss: 2.024878
Epoch 4149 
Prediction Loss: 2.010867
Epoch 4199 
Prediction Loss: 1.984241
Epoch 4249 
Prediction Loss: 1.990744
Epoch 4299 
Prediction Loss: 1.968325
Epoch 4349 
Prediction Loss: 1.964879
Epoch 4399 
Prediction Loss: 1.979074
Epoch 4449 
Prediction Loss: 1.979325
Epoch 4499 
Prediction Loss: 1.949320
Epoch 4549 
Prediction Loss: 1.963933
Epoch 4599 
Prediction Loss: 1.927193
Epoch 4649 
Prediction Loss: 1.925459
Epoch 4699 
Prediction Loss: 1.922806
Epoch 4749 
Prediction Loss: 1.905755
Epoch 4799 
Prediction Loss: 1.901392
Epoch 4849 
Prediction Loss: 1.905941
Epoch 4899 
Prediction Loss: 1.933205
Epoch 4949 
Prediction Loss: 1.898183
Epoch 4999 
Prediction Loss: 1.888143
Epoch 5049 
Prediction Loss: 1.897650
Epoch 5099 
Prediction Loss: 1.876518
Epoch 5149 
Prediction Loss: 1.863790
Epoch 5199 
Prediction Loss: 1.865183
Epoch 5249 
Prediction Loss: 1.853584
Epoch 5299 
Prediction Loss: 1.853358
Epoch 5349 
Prediction Loss: 1.866504
Epoch 5399 
Prediction Loss: 1.845287
Epoch 5449 
Prediction Loss: 1.839203
Epoch 5499 
Prediction Loss: 1.847295
Epoch 5549 
Prediction Loss: 1.827416
Epoch 5599 
Prediction Loss: 1.852165
Epoch 5649 
Prediction Loss: 1.816581
Epoch 5699 
Prediction Loss: 1.815182
Epoch 5749 
Prediction Loss: 1.808457
Epoch 5799 
Prediction Loss: 1.799065
Epoch 5849 
Prediction Loss: 1.790777
Epoch 5899 
Prediction Loss: 1.790397
Epoch 5949 
Prediction Loss: 1.792829
Epoch 5999 
Prediction Loss: 1.778415
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.334854
Insample Error 3.640227
Ours, Train RMSE
0.6619, 
0.6695, 
0.6548, 
0.6692, 
0.6551, 
CEVAE, Train RMSE
3.6916, 
3.7582, 
3.7635, 
3.8176, 
3.8179, 
Ours, Insample RMSE
2.1347, 
2.1912, 
2.3410, 
2.2413, 
2.1694, 
CEVAE, Insample RMSE
3.3326, 
3.3537, 
3.3480, 
3.3471, 
3.3241, 
Direct Regression, Insample RMSE
3.5806, 
3.6233, 
3.5845, 
3.5367, 
3.6402, 
Train, RMSE mean 0.6621 std 0.0065
CEVAE, RMSE mean 3.7697 std 0.0467
Ours, RMSE mean 2.2155 std 0.0717, reconstruct confounder 1.0838 (0.0044) noise 10.1801 (0.0065)
CEVAE, RMSE mean 3.3411 std 0.0110, reconstruct confounder 3.9878 (0.0173) noise 9.5673 (0.2429)
Direct Regression, RMSE mean 3.5931 std 0.0362
Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=4, mask=0, nlayer=50, obsm=1, stop=2000, ycof=0.5, ylayer=50)
Y Mean 1.776465, Std 3.501489 
Test Y Mean -0.006496, Std 3.341313 
Observe confounder 1, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.979948
Rec Loss: 10.322769
KL Loss: 2.657179
Y Loss: 1.061069
T Loss: 9.792235
Epoch 99 
Overall Loss: 12.832941
Rec Loss: 10.222908
KL Loss: 2.610033
Y Loss: 1.007491
T Loss: 9.719162
Epoch 149 
Overall Loss: 12.775450
Rec Loss: 10.185425
KL Loss: 2.590025
Y Loss: 0.992157
T Loss: 9.689346
Epoch 199 
Overall Loss: 12.743375
Rec Loss: 10.207700
KL Loss: 2.535675
Y Loss: 1.029541
T Loss: 9.692929
Epoch 249 
Overall Loss: 12.707224
Rec Loss: 10.181072
KL Loss: 2.526152
Y Loss: 1.000255
T Loss: 9.680944
Epoch 299 
Overall Loss: 12.698154
Rec Loss: 10.182677
KL Loss: 2.515477
Y Loss: 0.999933
T Loss: 9.682710
Epoch 349 
Overall Loss: 12.689761
Rec Loss: 10.167923
KL Loss: 2.521837
Y Loss: 1.010691
T Loss: 9.662578
Epoch 399 
Overall Loss: 12.689655
Rec Loss: 10.133165
KL Loss: 2.556490
Y Loss: 0.982677
T Loss: 9.641827
Epoch 449 
Overall Loss: 12.696037
Rec Loss: 10.174804
KL Loss: 2.521234
Y Loss: 0.996316
T Loss: 9.676646
Epoch 499 
Overall Loss: 12.677888
Rec Loss: 10.150002
KL Loss: 2.527886
Y Loss: 0.982836
T Loss: 9.658584
Epoch 549 
Overall Loss: 12.668478
Rec Loss: 10.140872
KL Loss: 2.527606
Y Loss: 1.003127
T Loss: 9.639308
Epoch 599 
Overall Loss: 12.652822
Rec Loss: 10.137288
KL Loss: 2.515534
Y Loss: 0.971371
T Loss: 9.651602
Epoch 649 
Overall Loss: 12.655937
Rec Loss: 10.121356
KL Loss: 2.534581
Y Loss: 0.959075
T Loss: 9.641819
Epoch 699 
Overall Loss: 12.669815
Rec Loss: 10.122865
KL Loss: 2.546950
Y Loss: 0.988711
T Loss: 9.628510
Epoch 749 
Overall Loss: 12.661656
Rec Loss: 10.157937
KL Loss: 2.503719
Y Loss: 0.985844
T Loss: 9.665015
Epoch 799 
Overall Loss: 12.639816
Rec Loss: 10.150891
KL Loss: 2.488926
Y Loss: 0.979028
T Loss: 9.661377
Epoch 849 
Overall Loss: 12.661844
Rec Loss: 10.152661
KL Loss: 2.509184
Y Loss: 0.989412
T Loss: 9.657954
Epoch 899 
Overall Loss: 12.639458
Rec Loss: 10.113431
KL Loss: 2.526028
Y Loss: 0.956062
T Loss: 9.635400
Epoch 949 
Overall Loss: 12.633316
Rec Loss: 10.090188
KL Loss: 2.543127
Y Loss: 0.985871
T Loss: 9.597253
Epoch 999 
Overall Loss: 12.638526
Rec Loss: 10.149569
KL Loss: 2.488957
Y Loss: 0.991575
T Loss: 9.653781
Epoch 1049 
Overall Loss: 12.632257
Rec Loss: 10.141250
KL Loss: 2.491008
Y Loss: 0.988833
T Loss: 9.646833
Epoch 1099 
Overall Loss: 12.650724
Rec Loss: 10.111328
KL Loss: 2.539396
Y Loss: 0.977711
T Loss: 9.622472
Epoch 1149 
Overall Loss: 12.623157
Rec Loss: 10.093651
KL Loss: 2.529505
Y Loss: 0.978118
T Loss: 9.604593
Epoch 1199 
Overall Loss: 12.634199
Rec Loss: 10.100263
KL Loss: 2.533936
Y Loss: 1.002781
T Loss: 9.598873
Epoch 1249 
Overall Loss: 12.619449
Rec Loss: 10.082243
KL Loss: 2.537206
Y Loss: 0.984906
T Loss: 9.589790
Epoch 1299 
Overall Loss: 12.615310
Rec Loss: 10.105785
KL Loss: 2.509525
Y Loss: 0.958110
T Loss: 9.626730
Epoch 1349 
Overall Loss: 12.636542
Rec Loss: 10.097789
KL Loss: 2.538753
Y Loss: 0.965270
T Loss: 9.615154
Epoch 1399 
Overall Loss: 12.628379
Rec Loss: 10.115480
KL Loss: 2.512899
Y Loss: 0.987274
T Loss: 9.621843
Epoch 1449 
Overall Loss: 12.607781
Rec Loss: 10.101429
KL Loss: 2.506352
Y Loss: 0.983149
T Loss: 9.609855
Epoch 1499 
Overall Loss: 12.585752
Rec Loss: 10.085856
KL Loss: 2.499896
Y Loss: 0.958162
T Loss: 9.606774
Epoch 1549 
Overall Loss: 12.617377
Rec Loss: 10.093602
KL Loss: 2.523775
Y Loss: 0.960126
T Loss: 9.613539
Epoch 1599 
Overall Loss: 12.621903
Rec Loss: 10.123014
KL Loss: 2.498888
Y Loss: 0.984657
T Loss: 9.630685
Epoch 1649 
Overall Loss: 12.626759
Rec Loss: 10.097702
KL Loss: 2.529057
Y Loss: 0.960799
T Loss: 9.617303
Epoch 1699 
Overall Loss: 12.611740
Rec Loss: 10.115645
KL Loss: 2.496095
Y Loss: 0.993672
T Loss: 9.618810
Epoch 1749 
Overall Loss: 12.609502
Rec Loss: 10.103325
KL Loss: 2.506176
Y Loss: 0.993203
T Loss: 9.606724
Epoch 1799 
Overall Loss: 12.628558
Rec Loss: 10.079221
KL Loss: 2.549338
Y Loss: 0.972172
T Loss: 9.593135
Epoch 1849 
Overall Loss: 12.623826
Rec Loss: 10.103665
KL Loss: 2.520161
Y Loss: 0.994931
T Loss: 9.606200
Epoch 1899 
Overall Loss: 12.610346
Rec Loss: 10.102345
KL Loss: 2.508001
Y Loss: 0.979777
T Loss: 9.612457
Epoch 1949 
Overall Loss: 12.610768
Rec Loss: 10.098267
KL Loss: 2.512502
Y Loss: 0.967635
T Loss: 9.614450
Epoch 1999 
Overall Loss: 12.611675
Rec Loss: 10.122230
KL Loss: 2.489445
Y Loss: 1.005707
T Loss: 9.619376
Epoch 2049 
Overall Loss: 12.603657
Rec Loss: 10.087630
KL Loss: 2.516027
Y Loss: 0.980815
T Loss: 9.597223
Epoch 2099 
Overall Loss: 12.619883
Rec Loss: 10.085066
KL Loss: 2.534817
Y Loss: 0.981041
T Loss: 9.594545
Epoch 2149 
Overall Loss: 12.613816
Rec Loss: 10.112118
KL Loss: 2.501698
Y Loss: 0.975548
T Loss: 9.624344
Epoch 2199 
Overall Loss: 12.594230
Rec Loss: 10.063312
KL Loss: 2.530919
Y Loss: 0.965076
T Loss: 9.580774
Epoch 2249 
Overall Loss: 12.596837
Rec Loss: 10.072198
KL Loss: 2.524640
Y Loss: 0.964827
T Loss: 9.589784
Epoch 2299 
Overall Loss: 12.610691
Rec Loss: 10.113301
KL Loss: 2.497391
Y Loss: 1.018930
T Loss: 9.603836
Epoch 2349 
Overall Loss: 12.586936
Rec Loss: 10.090654
KL Loss: 2.496283
Y Loss: 0.972245
T Loss: 9.604531
Epoch 2399 
Overall Loss: 12.604803
Rec Loss: 10.085194
KL Loss: 2.519609
Y Loss: 0.988073
T Loss: 9.591158
Epoch 2449 
Overall Loss: 12.573131
Rec Loss: 10.074966
KL Loss: 2.498165
Y Loss: 0.968815
T Loss: 9.590558
Epoch 2499 
Overall Loss: 12.593990
Rec Loss: 10.071876
KL Loss: 2.522114
Y Loss: 0.972527
T Loss: 9.585613
Epoch 2549 
Overall Loss: 12.612717
Rec Loss: 10.074770
KL Loss: 2.537948
Y Loss: 0.986786
T Loss: 9.581376
Epoch 2599 
Overall Loss: 12.611365
Rec Loss: 10.109713
KL Loss: 2.501652
Y Loss: 0.994888
T Loss: 9.612269
Epoch 2649 
Overall Loss: 12.585358
Rec Loss: 10.042342
KL Loss: 2.543015
Y Loss: 0.952364
T Loss: 9.566161
Epoch 2699 
Overall Loss: 12.592504
Rec Loss: 10.077492
KL Loss: 2.515012
Y Loss: 0.977542
T Loss: 9.588721
Epoch 2749 
Overall Loss: 12.567380
Rec Loss: 10.066188
KL Loss: 2.501192
Y Loss: 0.990595
T Loss: 9.570891
Epoch 2799 
Overall Loss: 12.595717
Rec Loss: 10.074745
KL Loss: 2.520972
Y Loss: 0.999038
T Loss: 9.575226
Epoch 2849 
Overall Loss: 12.624819
Rec Loss: 10.060235
KL Loss: 2.564584
Y Loss: 0.978304
T Loss: 9.571083
Epoch 2899 
Overall Loss: 12.582760
Rec Loss: 10.064889
KL Loss: 2.517871
Y Loss: 0.981499
T Loss: 9.574139
Epoch 2949 
Overall Loss: 12.596231
Rec Loss: 10.103326
KL Loss: 2.492905
Y Loss: 1.003119
T Loss: 9.601766
Epoch 2999 
Overall Loss: 12.590073
Rec Loss: 10.070443
KL Loss: 2.519631
Y Loss: 0.993866
T Loss: 9.573510
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.098345
Epoch 99
Rec Loss: 1.078403
Epoch 149
Rec Loss: 1.085644
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.196691
Epoch 99
Rec Loss: 10.195217
Epoch 149
Rec Loss: 10.186862
Epoch 199
Rec Loss: 10.173536
Epoch 249
Rec Loss: 10.186159
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.661881
Insample Error: 2.134660
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 16.997097
Rec Loss: 13.452451
KL Loss: 3.544646
Y Loss: 5.548661
T Loss: 13.505262
X Loss: -2.827142
Epoch 99 
Overall Loss: -0.301195
Rec Loss: -9.759075
KL Loss: 9.457880
Y Loss: 2.391170
T Loss: 13.282892
X Loss: -24.237551
Epoch 149 
Overall Loss: -5.233511
Rec Loss: -15.084225
KL Loss: 9.850713
Y Loss: 1.921474
T Loss: 13.246158
X Loss: -29.291120
Epoch 199 
Overall Loss: -8.629588
Rec Loss: -19.014734
KL Loss: 10.385146
Y Loss: 1.406911
T Loss: 13.192991
X Loss: -32.911181
Epoch 249 
Overall Loss: -11.066774
Rec Loss: -22.228154
KL Loss: 11.161379
Y Loss: 1.087217
T Loss: 13.133052
X Loss: -35.904814
Epoch 299 
Overall Loss: -12.744388
Rec Loss: -24.549715
KL Loss: 11.805328
Y Loss: 0.969309
T Loss: 13.056634
X Loss: -38.091004
Epoch 349 
Overall Loss: -13.605052
Rec Loss: -25.780204
KL Loss: 12.175152
Y Loss: 0.898269
T Loss: 12.962812
X Loss: -39.192151
Epoch 399 
Overall Loss: -14.728284
Rec Loss: -27.391813
KL Loss: 12.663528
Y Loss: 0.850404
T Loss: 12.843999
X Loss: -40.661014
Epoch 449 
Overall Loss: -15.690967
Rec Loss: -28.708495
KL Loss: 13.017529
Y Loss: 0.842021
T Loss: 12.693619
X Loss: -41.823124
Epoch 499 
Overall Loss: -16.420447
Rec Loss: -29.671587
KL Loss: 13.251139
Y Loss: 0.855809
T Loss: 12.541140
X Loss: -42.640631
Epoch 549 
Overall Loss: -16.888718
Rec Loss: -30.359061
KL Loss: 13.470342
Y Loss: 0.803427
T Loss: 12.430070
X Loss: -43.190843
Epoch 599 
Overall Loss: -17.459913
Rec Loss: -31.025512
KL Loss: 13.565598
Y Loss: 0.845555
T Loss: 12.350514
X Loss: -43.798802
Epoch 649 
Overall Loss: -17.640591
Rec Loss: -31.434413
KL Loss: 13.793823
Y Loss: 0.792277
T Loss: 12.276735
X Loss: -44.107288
Epoch 699 
Overall Loss: -18.332673
Rec Loss: -32.280790
KL Loss: 13.948118
Y Loss: 0.790493
T Loss: 12.211778
X Loss: -44.887814
Epoch 749 
Overall Loss: -18.593314
Rec Loss: -32.628119
KL Loss: 14.034805
Y Loss: 0.784547
T Loss: 12.138577
X Loss: -45.158970
Epoch 799 
Overall Loss: -19.087650
Rec Loss: -33.231617
KL Loss: 14.143967
Y Loss: 0.794707
T Loss: 12.072172
X Loss: -45.701144
Epoch 849 
Overall Loss: -19.580118
Rec Loss: -33.814905
KL Loss: 14.234786
Y Loss: 0.765517
T Loss: 12.032912
X Loss: -46.230576
Epoch 899 
Overall Loss: -19.829422
Rec Loss: -34.092431
KL Loss: 14.263010
Y Loss: 0.762745
T Loss: 11.965281
X Loss: -46.439085
Epoch 949 
Overall Loss: -20.052276
Rec Loss: -34.451767
KL Loss: 14.399490
Y Loss: 0.746489
T Loss: 11.914919
X Loss: -46.739929
Epoch 999 
Overall Loss: -20.505295
Rec Loss: -35.012147
KL Loss: 14.506852
Y Loss: 0.743215
T Loss: 11.856395
X Loss: -47.240149
Epoch 1049 
Overall Loss: -20.640815
Rec Loss: -35.239841
KL Loss: 14.599026
Y Loss: 0.724757
T Loss: 11.809637
X Loss: -47.411857
Epoch 1099 
Overall Loss: -21.078910
Rec Loss: -35.725151
KL Loss: 14.646240
Y Loss: 0.703127
T Loss: 11.779955
X Loss: -47.856669
Epoch 1149 
Overall Loss: -20.956703
Rec Loss: -35.590001
KL Loss: 14.633298
Y Loss: 0.720710
T Loss: 11.735756
X Loss: -47.686112
Epoch 1199 
Overall Loss: -21.314254
Rec Loss: -36.142068
KL Loss: 14.827814
Y Loss: 0.680918
T Loss: 11.689927
X Loss: -48.172456
Epoch 1249 
Overall Loss: -21.573592
Rec Loss: -36.292151
KL Loss: 14.718559
Y Loss: 0.674242
T Loss: 11.660462
X Loss: -48.289735
Epoch 1299 
Overall Loss: -21.846377
Rec Loss: -36.635913
KL Loss: 14.789537
Y Loss: 0.663682
T Loss: 11.616120
X Loss: -48.583876
Epoch 1349 
Overall Loss: -22.061216
Rec Loss: -36.911647
KL Loss: 14.850432
Y Loss: 0.672236
T Loss: 11.593330
X Loss: -48.841095
Epoch 1399 
Overall Loss: -22.143442
Rec Loss: -37.029852
KL Loss: 14.886409
Y Loss: 0.664144
T Loss: 11.557807
X Loss: -48.919731
Epoch 1449 
Overall Loss: -22.161768
Rec Loss: -37.030374
KL Loss: 14.868607
Y Loss: 0.659156
T Loss: 11.527718
X Loss: -48.887670
Epoch 1499 
Overall Loss: -22.728907
Rec Loss: -37.730686
KL Loss: 15.001779
Y Loss: 0.611006
T Loss: 11.480951
X Loss: -49.517140
Epoch 1549 
Overall Loss: -22.663883
Rec Loss: -37.618376
KL Loss: 14.954494
Y Loss: 0.635301
T Loss: 11.467357
X Loss: -49.403384
Epoch 1599 
Overall Loss: -22.757206
Rec Loss: -37.832701
KL Loss: 15.075495
Y Loss: 0.636369
T Loss: 11.436914
X Loss: -49.587798
Epoch 1649 
Overall Loss: -23.330202
Rec Loss: -38.358145
KL Loss: 15.027942
Y Loss: 0.610867
T Loss: 11.431656
X Loss: -50.095232
Epoch 1699 
Overall Loss: -22.952650
Rec Loss: -38.013517
KL Loss: 15.060868
Y Loss: 0.613601
T Loss: 11.390501
X Loss: -49.710820
Epoch 1749 
Overall Loss: -23.654000
Rec Loss: -38.687659
KL Loss: 15.033658
Y Loss: 0.593442
T Loss: 11.368932
X Loss: -50.353312
Epoch 1799 
Overall Loss: -23.588515
Rec Loss: -38.661679
KL Loss: 15.073165
Y Loss: 0.603693
T Loss: 11.364171
X Loss: -50.327696
Epoch 1849 
Overall Loss: -23.756508
Rec Loss: -38.799180
KL Loss: 15.042672
Y Loss: 0.613195
T Loss: 11.344608
X Loss: -50.450386
Epoch 1899 
Overall Loss: -24.066841
Rec Loss: -39.205611
KL Loss: 15.138770
Y Loss: 0.585092
T Loss: 11.308537
X Loss: -50.806694
Epoch 1949 
Overall Loss: -24.233908
Rec Loss: -39.467649
KL Loss: 15.233741
Y Loss: 0.561052
T Loss: 11.281769
X Loss: -51.029944
Epoch 1999 
Overall Loss: -23.911806
Rec Loss: -39.001825
KL Loss: 15.090020
Y Loss: 0.568181
T Loss: 11.263998
X Loss: -50.549915
Epoch 2049 
Overall Loss: -24.160129
Rec Loss: -39.427280
KL Loss: 15.267151
Y Loss: 0.553681
T Loss: 11.239267
X Loss: -50.943387
Epoch 2099 
Overall Loss: -24.304295
Rec Loss: -39.538534
KL Loss: 15.234238
Y Loss: 0.541915
T Loss: 11.225130
X Loss: -51.034621
Epoch 2149 
Overall Loss: -24.881688
Rec Loss: -40.204772
KL Loss: 15.323085
Y Loss: 0.533082
T Loss: 11.197245
X Loss: -51.668558
Epoch 2199 
Overall Loss: -24.624450
Rec Loss: -39.867505
KL Loss: 15.243054
Y Loss: 0.519969
T Loss: 11.199484
X Loss: -51.326973
Epoch 2249 
Overall Loss: -24.700602
Rec Loss: -40.019977
KL Loss: 15.319375
Y Loss: 0.507524
T Loss: 11.169440
X Loss: -51.443178
Epoch 2299 
Overall Loss: -25.150548
Rec Loss: -40.443037
KL Loss: 15.292489
Y Loss: 0.508108
T Loss: 11.161397
X Loss: -51.858489
Epoch 2349 
Overall Loss: -25.269324
Rec Loss: -40.676531
KL Loss: 15.407208
Y Loss: 0.471998
T Loss: 11.134162
X Loss: -52.046693
Epoch 2399 
Overall Loss: -25.015444
Rec Loss: -40.348475
KL Loss: 15.333030
Y Loss: 0.490293
T Loss: 11.131269
X Loss: -51.724889
Epoch 2449 
Overall Loss: -25.379209
Rec Loss: -40.610150
KL Loss: 15.230943
Y Loss: 0.470520
T Loss: 11.146251
X Loss: -51.991662
Epoch 2499 
Overall Loss: -24.403113
Rec Loss: -39.805445
KL Loss: 15.402331
Y Loss: 0.463814
T Loss: 11.112992
X Loss: -51.150344
Epoch 2549 
Overall Loss: -25.676063
Rec Loss: -41.025475
KL Loss: 15.349412
Y Loss: 0.451832
T Loss: 11.119566
X Loss: -52.370956
Epoch 2599 
Overall Loss: -25.581463
Rec Loss: -40.944720
KL Loss: 15.363257
Y Loss: 0.427578
T Loss: 11.097145
X Loss: -52.255655
Epoch 2649 
Overall Loss: -26.040827
Rec Loss: -41.505212
KL Loss: 15.464385
Y Loss: 0.425603
T Loss: 11.072469
X Loss: -52.790482
Epoch 2699 
Overall Loss: -25.743872
Rec Loss: -41.206224
KL Loss: 15.462351
Y Loss: 0.425712
T Loss: 11.068344
X Loss: -52.487423
Epoch 2749 
Overall Loss: -25.482020
Rec Loss: -40.940764
KL Loss: 15.458744
Y Loss: 0.408878
T Loss: 11.041267
X Loss: -52.186470
Epoch 2799 
Overall Loss: -26.287283
Rec Loss: -41.604715
KL Loss: 15.317432
Y Loss: 0.419672
T Loss: 11.051291
X Loss: -52.865842
Epoch 2849 
Overall Loss: -25.014197
Rec Loss: -40.455924
KL Loss: 15.441727
Y Loss: 0.408873
T Loss: 11.041307
X Loss: -51.701667
Epoch 2899 
Overall Loss: -26.437919
Rec Loss: -41.800571
KL Loss: 15.362651
Y Loss: 0.400262
T Loss: 11.046595
X Loss: -53.047296
Epoch 2949 
Overall Loss: -25.954102
Rec Loss: -41.457498
KL Loss: 15.503395
Y Loss: 0.384490
T Loss: 11.000318
X Loss: -52.650060
Epoch 2999 
Overall Loss: -26.161803
Rec Loss: -41.579349
KL Loss: 15.417546
Y Loss: 0.381076
T Loss: 11.005459
X Loss: -52.775345
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.343344
Epoch 99
Rec Loss: 2.300946
Epoch 149
Rec Loss: 2.258195
Epoch 199
Rec Loss: 2.247221
Epoch 249
Rec Loss: 2.243223
Epoch 299
Rec Loss: 2.223899
Epoch 349
Rec Loss: 2.221416
Epoch 399
Rec Loss: 2.233393
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.004865
Epoch 99
Rec Loss: 0.002461
Epoch 149
Rec Loss: 0.001369
Epoch 199
Rec Loss: 0.001404
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.414847
Insample Error 3.320323
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.552529
Epoch 99 
Prediction Loss: 3.316708
Epoch 149 
Prediction Loss: 3.204464
Epoch 199 
Prediction Loss: 3.169694
Epoch 249 
Prediction Loss: 3.150069
Epoch 299 
Prediction Loss: 3.109847
Epoch 349 
Prediction Loss: 3.085338
Epoch 399 
Prediction Loss: 3.061272
Epoch 449 
Prediction Loss: 3.054752
Epoch 499 
Prediction Loss: 3.044007
Epoch 549 
Prediction Loss: 3.014197
Epoch 599 
Prediction Loss: 3.034332
Epoch 649 
Prediction Loss: 2.998905
Epoch 699 
Prediction Loss: 2.989323
Epoch 749 
Prediction Loss: 2.996770
Epoch 799 
Prediction Loss: 2.951626
Epoch 849 
Prediction Loss: 2.951486
Epoch 899 
Prediction Loss: 2.928248
Epoch 949 
Prediction Loss: 2.930274
Epoch 999 
Prediction Loss: 2.894569
Epoch 1049 
Prediction Loss: 2.893029
Epoch 1099 
Prediction Loss: 2.907751
Epoch 1149 
Prediction Loss: 2.877343
Epoch 1199 
Prediction Loss: 2.861680
Epoch 1249 
Prediction Loss: 2.829661
Epoch 1299 
Prediction Loss: 2.832366
Epoch 1349 
Prediction Loss: 2.826214
Epoch 1399 
Prediction Loss: 2.830082
Epoch 1449 
Prediction Loss: 2.796861
Epoch 1499 
Prediction Loss: 2.832309
Epoch 1549 
Prediction Loss: 2.779574
Epoch 1599 
Prediction Loss: 2.798993
Epoch 1649 
Prediction Loss: 2.789127
Epoch 1699 
Prediction Loss: 2.751945
Epoch 1749 
Prediction Loss: 2.748912
Epoch 1799 
Prediction Loss: 2.747149
Epoch 1849 
Prediction Loss: 2.711683
Epoch 1899 
Prediction Loss: 2.738036
Epoch 1949 
Prediction Loss: 2.679082
Epoch 1999 
Prediction Loss: 2.706114
Epoch 2049 
Prediction Loss: 2.687410
Epoch 2099 
Prediction Loss: 2.660467
Epoch 2149 
Prediction Loss: 2.644805
Epoch 2199 
Prediction Loss: 2.638652
Epoch 2249 
Prediction Loss: 2.621661
Epoch 2299 
Prediction Loss: 2.618554
Epoch 2349 
Prediction Loss: 2.621467
Epoch 2399 
Prediction Loss: 2.623540
Epoch 2449 
Prediction Loss: 2.592772
Epoch 2499 
Prediction Loss: 2.583278
Epoch 2549 
Prediction Loss: 2.573640
Epoch 2599 
Prediction Loss: 2.603117
Epoch 2649 
Prediction Loss: 2.537914
Epoch 2699 
Prediction Loss: 2.524780
Epoch 2749 
Prediction Loss: 2.530441
Epoch 2799 
Prediction Loss: 2.532575
Epoch 2849 
Prediction Loss: 2.513435
Epoch 2899 
Prediction Loss: 2.515615
Epoch 2949 
Prediction Loss: 2.481040
Epoch 2999 
Prediction Loss: 2.475412
Epoch 3049 
Prediction Loss: 2.477272
Epoch 3099 
Prediction Loss: 2.468246
Epoch 3149 
Prediction Loss: 2.462692
Epoch 3199 
Prediction Loss: 2.445893
Epoch 3249 
Prediction Loss: 2.435459
Epoch 3299 
Prediction Loss: 2.409777
Epoch 3349 
Prediction Loss: 2.430088
Epoch 3399 
Prediction Loss: 2.391662
Epoch 3449 
Prediction Loss: 2.392722
Epoch 3499 
Prediction Loss: 2.389412
Epoch 3549 
Prediction Loss: 2.376614
Epoch 3599 
Prediction Loss: 2.390776
Epoch 3649 
Prediction Loss: 2.378327
Epoch 3699 
Prediction Loss: 2.347339
Epoch 3749 
Prediction Loss: 2.338094
Epoch 3799 
Prediction Loss: 2.334307
Epoch 3849 
Prediction Loss: 2.341777
Epoch 3899 
Prediction Loss: 2.305401
Epoch 3949 
Prediction Loss: 2.324896
Epoch 3999 
Prediction Loss: 2.336425
Epoch 4049 
Prediction Loss: 2.277314
Epoch 4099 
Prediction Loss: 2.312369
Epoch 4149 
Prediction Loss: 2.273412
Epoch 4199 
Prediction Loss: 2.274221
Epoch 4249 
Prediction Loss: 2.255613
Epoch 4299 
Prediction Loss: 2.262913
Epoch 4349 
Prediction Loss: 2.257056
Epoch 4399 
Prediction Loss: 2.219502
Epoch 4449 
Prediction Loss: 2.231578
Epoch 4499 
Prediction Loss: 2.253829
Epoch 4549 
Prediction Loss: 2.229201
Epoch 4599 
Prediction Loss: 2.206229
Epoch 4649 
Prediction Loss: 2.213370
Epoch 4699 
Prediction Loss: 2.198851
Epoch 4749 
Prediction Loss: 2.181497
Epoch 4799 
Prediction Loss: 2.222028
Epoch 4849 
Prediction Loss: 2.159112
Epoch 4899 
Prediction Loss: 2.172925
Epoch 4949 
Prediction Loss: 2.156653
Epoch 4999 
Prediction Loss: 2.138874
Epoch 5049 
Prediction Loss: 2.232713
Epoch 5099 
Prediction Loss: 2.141030
Epoch 5149 
Prediction Loss: 2.127830
Epoch 5199 
Prediction Loss: 2.140037
Epoch 5249 
Prediction Loss: 2.111078
Epoch 5299 
Prediction Loss: 2.107419
Epoch 5349 
Prediction Loss: 2.138548
Epoch 5399 
Prediction Loss: 2.096719
Epoch 5449 
Prediction Loss: 2.112768
Epoch 5499 
Prediction Loss: 2.137411
Epoch 5549 
Prediction Loss: 2.105609
Epoch 5599 
Prediction Loss: 2.086242
Epoch 5649 
Prediction Loss: 2.074624
Epoch 5699 
Prediction Loss: 2.057917
Epoch 5749 
Prediction Loss: 2.070106
Epoch 5799 
Prediction Loss: 2.064212
Epoch 5849 
Prediction Loss: 2.054319
Epoch 5899 
Prediction Loss: 2.047163
Epoch 5949 
Prediction Loss: 2.043961
Epoch 5999 
Prediction Loss: 2.031945
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.433816
Insample Error 3.580581
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.894715
Rec Loss: 10.243752
KL Loss: 2.650962
Y Loss: 0.999973
T Loss: 9.743766
Epoch 99 
Overall Loss: 12.792723
Rec Loss: 10.175273
KL Loss: 2.617450
Y Loss: 1.017860
T Loss: 9.666344
Epoch 149 
Overall Loss: 12.763904
Rec Loss: 10.194472
KL Loss: 2.569432
Y Loss: 1.001940
T Loss: 9.693502
Epoch 199 
Overall Loss: 12.718440
Rec Loss: 10.165015
KL Loss: 2.553425
Y Loss: 1.001830
T Loss: 9.664100
Epoch 249 
Overall Loss: 12.693677
Rec Loss: 10.162310
KL Loss: 2.531366
Y Loss: 0.980075
T Loss: 9.672273
Epoch 299 
Overall Loss: 12.710521
Rec Loss: 10.168749
KL Loss: 2.541773
Y Loss: 1.005788
T Loss: 9.665855
Epoch 349 
Overall Loss: 12.687322
Rec Loss: 10.137119
KL Loss: 2.550203
Y Loss: 0.984831
T Loss: 9.644703
Epoch 399 
Overall Loss: 12.650475
Rec Loss: 10.145363
KL Loss: 2.505111
Y Loss: 1.000860
T Loss: 9.644933
Epoch 449 
Overall Loss: 12.674504
Rec Loss: 10.132532
KL Loss: 2.541972
Y Loss: 0.982275
T Loss: 9.641394
Epoch 499 
Overall Loss: 12.671540
Rec Loss: 10.140824
KL Loss: 2.530717
Y Loss: 0.989801
T Loss: 9.645924
Epoch 549 
Overall Loss: 12.651030
Rec Loss: 10.141645
KL Loss: 2.509385
Y Loss: 0.990527
T Loss: 9.646382
Epoch 599 
Overall Loss: 12.677035
Rec Loss: 10.158599
KL Loss: 2.518435
Y Loss: 1.008062
T Loss: 9.654569
Epoch 649 
Overall Loss: 12.672883
Rec Loss: 10.145078
KL Loss: 2.527805
Y Loss: 0.998029
T Loss: 9.646064
Epoch 699 
Overall Loss: 12.658488
Rec Loss: 10.142334
KL Loss: 2.516154
Y Loss: 0.969505
T Loss: 9.657581
Epoch 749 
Overall Loss: 12.639386
Rec Loss: 10.120950
KL Loss: 2.518435
Y Loss: 0.973159
T Loss: 9.634371
Epoch 799 
Overall Loss: 12.663090
Rec Loss: 10.132967
KL Loss: 2.530123
Y Loss: 0.981599
T Loss: 9.642168
Epoch 849 
Overall Loss: 12.660590
Rec Loss: 10.154928
KL Loss: 2.505662
Y Loss: 1.026055
T Loss: 9.641900
Epoch 899 
Overall Loss: 12.659899
Rec Loss: 10.117101
KL Loss: 2.542798
Y Loss: 0.979060
T Loss: 9.627571
Epoch 949 
Overall Loss: 12.644095
Rec Loss: 10.133472
KL Loss: 2.510623
Y Loss: 0.962029
T Loss: 9.652458
Epoch 999 
Overall Loss: 12.647361
Rec Loss: 10.138586
KL Loss: 2.508776
Y Loss: 1.001181
T Loss: 9.637995
Epoch 1049 
Overall Loss: 12.629688
Rec Loss: 10.124659
KL Loss: 2.505029
Y Loss: 0.987272
T Loss: 9.631023
Epoch 1099 
Overall Loss: 12.644128
Rec Loss: 10.122817
KL Loss: 2.521311
Y Loss: 0.985176
T Loss: 9.630229
Epoch 1149 
Overall Loss: 12.631283
Rec Loss: 10.121275
KL Loss: 2.510008
Y Loss: 0.978217
T Loss: 9.632167
Epoch 1199 
Overall Loss: 12.633736
Rec Loss: 10.134945
KL Loss: 2.498792
Y Loss: 0.985801
T Loss: 9.642044
Epoch 1249 
Overall Loss: 12.635450
Rec Loss: 10.129808
KL Loss: 2.505642
Y Loss: 0.989577
T Loss: 9.635019
Epoch 1299 
Overall Loss: 12.627734
Rec Loss: 10.112112
KL Loss: 2.515622
Y Loss: 0.964706
T Loss: 9.629759
Epoch 1349 
Overall Loss: 12.640422
Rec Loss: 10.132891
KL Loss: 2.507531
Y Loss: 0.999501
T Loss: 9.633140
Epoch 1399 
Overall Loss: 12.619783
Rec Loss: 10.112470
KL Loss: 2.507313
Y Loss: 0.983629
T Loss: 9.620656
Epoch 1449 
Overall Loss: 12.627677
Rec Loss: 10.100016
KL Loss: 2.527661
Y Loss: 0.987530
T Loss: 9.606250
Epoch 1499 
Overall Loss: 12.615591
Rec Loss: 10.093872
KL Loss: 2.521719
Y Loss: 0.972569
T Loss: 9.607588
Epoch 1549 
Overall Loss: 12.642097
Rec Loss: 10.106893
KL Loss: 2.535204
Y Loss: 0.988971
T Loss: 9.612408
Epoch 1599 
Overall Loss: 12.620089
Rec Loss: 10.098129
KL Loss: 2.521961
Y Loss: 0.984915
T Loss: 9.605671
Epoch 1649 
Overall Loss: 12.608559
Rec Loss: 10.097823
KL Loss: 2.510736
Y Loss: 0.969947
T Loss: 9.612850
Epoch 1699 
Overall Loss: 12.639295
Rec Loss: 10.109320
KL Loss: 2.529975
Y Loss: 1.000965
T Loss: 9.608837
Epoch 1749 
Overall Loss: 12.622537
Rec Loss: 10.100365
KL Loss: 2.522172
Y Loss: 0.980886
T Loss: 9.609922
Epoch 1799 
Overall Loss: 12.630289
Rec Loss: 10.110081
KL Loss: 2.520207
Y Loss: 1.000898
T Loss: 9.609633
Epoch 1849 
Overall Loss: 12.611346
Rec Loss: 10.066405
KL Loss: 2.544941
Y Loss: 0.977910
T Loss: 9.577450
Epoch 1899 
Overall Loss: 12.593628
Rec Loss: 10.098004
KL Loss: 2.495624
Y Loss: 0.985830
T Loss: 9.605089
Epoch 1949 
Overall Loss: 12.625739
Rec Loss: 10.109729
KL Loss: 2.516011
Y Loss: 0.982160
T Loss: 9.618649
Epoch 1999 
Overall Loss: 12.607680
Rec Loss: 10.081470
KL Loss: 2.526210
Y Loss: 0.967037
T Loss: 9.597952
Epoch 2049 
Overall Loss: 12.605290
Rec Loss: 10.074076
KL Loss: 2.531214
Y Loss: 0.978809
T Loss: 9.584671
Epoch 2099 
Overall Loss: 12.611922
Rec Loss: 10.069008
KL Loss: 2.542914
Y Loss: 0.973763
T Loss: 9.582127
Epoch 2149 
Overall Loss: 12.603703
Rec Loss: 10.073737
KL Loss: 2.529966
Y Loss: 0.987323
T Loss: 9.580075
Epoch 2199 
Overall Loss: 12.603650
Rec Loss: 10.092404
KL Loss: 2.511247
Y Loss: 0.982801
T Loss: 9.601003
Epoch 2249 
Overall Loss: 12.597053
Rec Loss: 10.045238
KL Loss: 2.551815
Y Loss: 0.957409
T Loss: 9.566534
Epoch 2299 
Overall Loss: 12.574369
Rec Loss: 10.080548
KL Loss: 2.493821
Y Loss: 0.956787
T Loss: 9.602155
Epoch 2349 
Overall Loss: 12.581714
Rec Loss: 10.077360
KL Loss: 2.504353
Y Loss: 0.977639
T Loss: 9.588541
Epoch 2399 
Overall Loss: 12.573602
Rec Loss: 10.073248
KL Loss: 2.500354
Y Loss: 0.960998
T Loss: 9.592749
Epoch 2449 
Overall Loss: 12.626256
Rec Loss: 10.078875
KL Loss: 2.547381
Y Loss: 0.972965
T Loss: 9.592393
Epoch 2499 
Overall Loss: 12.593241
Rec Loss: 10.084193
KL Loss: 2.509048
Y Loss: 0.964365
T Loss: 9.602010
Epoch 2549 
Overall Loss: 12.607599
Rec Loss: 10.087868
KL Loss: 2.519731
Y Loss: 1.013736
T Loss: 9.580999
Epoch 2599 
Overall Loss: 12.625466
Rec Loss: 10.083847
KL Loss: 2.541620
Y Loss: 1.004329
T Loss: 9.581682
Epoch 2649 
Overall Loss: 12.613846
Rec Loss: 10.096367
KL Loss: 2.517479
Y Loss: 1.001482
T Loss: 9.595626
Epoch 2699 
Overall Loss: 12.606730
Rec Loss: 10.068352
KL Loss: 2.538378
Y Loss: 0.943533
T Loss: 9.596585
Epoch 2749 
Overall Loss: 12.571613
Rec Loss: 10.080737
KL Loss: 2.490876
Y Loss: 1.000069
T Loss: 9.580702
Epoch 2799 
Overall Loss: 12.589687
Rec Loss: 10.073162
KL Loss: 2.516525
Y Loss: 0.969268
T Loss: 9.588528
Epoch 2849 
Overall Loss: 12.598504
Rec Loss: 10.076933
KL Loss: 2.521571
Y Loss: 1.001263
T Loss: 9.576301
Epoch 2899 
Overall Loss: 12.568533
Rec Loss: 10.053161
KL Loss: 2.515372
Y Loss: 0.958317
T Loss: 9.574002
Epoch 2949 
Overall Loss: 12.586443
Rec Loss: 10.083361
KL Loss: 2.503082
Y Loss: 1.013955
T Loss: 9.576384
Epoch 2999 
Overall Loss: 12.561418
Rec Loss: 10.047202
KL Loss: 2.514216
Y Loss: 0.973464
T Loss: 9.560470
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.093232
Epoch 99
Rec Loss: 1.091476
Epoch 149
Rec Loss: 1.093223
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.187569
Epoch 99
Rec Loss: 10.195998
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.669526
Insample Error: 2.191176
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 17.458766
Rec Loss: 13.979565
KL Loss: 3.479201
Y Loss: 6.128765
T Loss: 13.440759
X Loss: -2.525576
Epoch 99 
Overall Loss: 0.141758
Rec Loss: -10.385667
KL Loss: 10.527425
Y Loss: 2.385163
T Loss: 13.240611
X Loss: -24.818861
Epoch 149 
Overall Loss: -5.759874
Rec Loss: -17.217495
KL Loss: 11.457620
Y Loss: 1.827002
T Loss: 13.237430
X Loss: -31.368426
Epoch 199 
Overall Loss: -9.746236
Rec Loss: -22.092361
KL Loss: 12.346125
Y Loss: 1.340380
T Loss: 13.217501
X Loss: -35.980054
Epoch 249 
Overall Loss: -11.585149
Rec Loss: -24.542827
KL Loss: 12.957679
Y Loss: 0.966292
T Loss: 13.185815
X Loss: -38.211788
Epoch 299 
Overall Loss: -12.530114
Rec Loss: -25.914184
KL Loss: 13.384069
Y Loss: 0.870128
T Loss: 13.144983
X Loss: -39.494230
Epoch 349 
Overall Loss: -13.220598
Rec Loss: -26.838452
KL Loss: 13.617854
Y Loss: 0.819431
T Loss: 13.071516
X Loss: -40.319683
Epoch 399 
Overall Loss: -14.030532
Rec Loss: -27.765664
KL Loss: 13.735132
Y Loss: 0.798603
T Loss: 12.978885
X Loss: -41.143849
Epoch 449 
Overall Loss: -14.713959
Rec Loss: -28.665017
KL Loss: 13.951058
Y Loss: 0.769337
T Loss: 12.849324
X Loss: -41.899009
Epoch 499 
Overall Loss: -15.500977
Rec Loss: -29.666844
KL Loss: 14.165867
Y Loss: 0.751290
T Loss: 12.658352
X Loss: -42.700842
Epoch 549 
Overall Loss: -15.996104
Rec Loss: -30.360825
KL Loss: 14.364721
Y Loss: 0.689375
T Loss: 12.447039
X Loss: -43.152551
Epoch 599 
Overall Loss: -16.591219
Rec Loss: -31.096022
KL Loss: 14.504803
Y Loss: 0.654745
T Loss: 12.218893
X Loss: -43.642289
Epoch 649 
Overall Loss: -17.080175
Rec Loss: -31.693540
KL Loss: 14.613364
Y Loss: 0.630778
T Loss: 12.073555
X Loss: -44.082484
Epoch 699 
Overall Loss: -17.652610
Rec Loss: -32.372639
KL Loss: 14.720028
Y Loss: 0.600703
T Loss: 11.954090
X Loss: -44.627080
Epoch 749 
Overall Loss: -18.102577
Rec Loss: -32.880164
KL Loss: 14.777587
Y Loss: 0.577016
T Loss: 11.860391
X Loss: -45.029063
Epoch 799 
Overall Loss: -18.344026
Rec Loss: -33.164205
KL Loss: 14.820179
Y Loss: 0.592410
T Loss: 11.791832
X Loss: -45.252242
Epoch 849 
Overall Loss: -18.681171
Rec Loss: -33.570734
KL Loss: 14.889563
Y Loss: 0.571093
T Loss: 11.721373
X Loss: -45.577655
Epoch 899 
Overall Loss: -18.983173
Rec Loss: -33.956001
KL Loss: 14.972827
Y Loss: 0.546376
T Loss: 11.679945
X Loss: -45.909133
Epoch 949 
Overall Loss: -18.814527
Rec Loss: -33.793678
KL Loss: 14.979152
Y Loss: 0.550803
T Loss: 11.643165
X Loss: -45.712245
Epoch 999 
Overall Loss: -19.245936
Rec Loss: -34.217969
KL Loss: 14.972034
Y Loss: 0.541711
T Loss: 11.594494
X Loss: -46.083318
Epoch 1049 
Overall Loss: -19.944200
Rec Loss: -35.089715
KL Loss: 15.145515
Y Loss: 0.507258
T Loss: 11.545429
X Loss: -46.888773
Epoch 1099 
Overall Loss: -19.860685
Rec Loss: -34.865561
KL Loss: 15.004877
Y Loss: 0.520402
T Loss: 11.550017
X Loss: -46.675778
Epoch 1149 
Overall Loss: -19.463400
Rec Loss: -34.605304
KL Loss: 15.141904
Y Loss: 0.511555
T Loss: 11.516192
X Loss: -46.377273
Epoch 1199 
Overall Loss: -20.089098
Rec Loss: -35.353566
KL Loss: 15.264468
Y Loss: 0.491458
T Loss: 11.476685
X Loss: -47.075980
Epoch 1249 
Overall Loss: -20.922496
Rec Loss: -36.197266
KL Loss: 15.274771
Y Loss: 0.486537
T Loss: 11.467906
X Loss: -47.908441
Epoch 1299 
Overall Loss: -21.178355
Rec Loss: -36.515482
KL Loss: 15.337127
Y Loss: 0.472957
T Loss: 11.439415
X Loss: -48.191376
Epoch 1349 
Overall Loss: -21.311724
Rec Loss: -36.576971
KL Loss: 15.265247
Y Loss: 0.486851
T Loss: 11.447142
X Loss: -48.267538
Epoch 1399 
Overall Loss: -21.393634
Rec Loss: -36.796960
KL Loss: 15.403326
Y Loss: 0.464711
T Loss: 11.403636
X Loss: -48.432953
Epoch 1449 
Overall Loss: -21.521096
Rec Loss: -36.962576
KL Loss: 15.441481
Y Loss: 0.454835
T Loss: 11.390418
X Loss: -48.580413
Epoch 1499 
Overall Loss: -21.565393
Rec Loss: -36.937606
KL Loss: 15.372214
Y Loss: 0.475184
T Loss: 11.382113
X Loss: -48.557312
Epoch 1549 
Overall Loss: -21.765392
Rec Loss: -37.266615
KL Loss: 15.501224
Y Loss: 0.455081
T Loss: 11.365480
X Loss: -48.859637
Epoch 1599 
Overall Loss: -22.160977
Rec Loss: -37.569627
KL Loss: 15.408651
Y Loss: 0.485592
T Loss: 11.371672
X Loss: -49.184095
Epoch 1649 
Overall Loss: -22.275036
Rec Loss: -37.895282
KL Loss: 15.620246
Y Loss: 0.436866
T Loss: 11.332078
X Loss: -49.445793
Epoch 1699 
Overall Loss: -22.237296
Rec Loss: -37.630014
KL Loss: 15.392718
Y Loss: 0.498470
T Loss: 11.354768
X Loss: -49.234016
Epoch 1749 
Overall Loss: -22.519986
Rec Loss: -38.225787
KL Loss: 15.705801
Y Loss: 0.458627
T Loss: 11.318939
X Loss: -49.774040
Epoch 1799 
Overall Loss: -22.868969
Rec Loss: -38.436890
KL Loss: 15.567921
Y Loss: 0.449232
T Loss: 11.326437
X Loss: -49.987942
Epoch 1849 
Overall Loss: -22.682198
Rec Loss: -38.323203
KL Loss: 15.641005
Y Loss: 0.453362
T Loss: 11.299815
X Loss: -49.849699
Epoch 1899 
Overall Loss: -22.935550
Rec Loss: -38.699508
KL Loss: 15.763959
Y Loss: 0.427617
T Loss: 11.303120
X Loss: -50.216437
Epoch 1949 
Overall Loss: -22.884304
Rec Loss: -38.479048
KL Loss: 15.594743
Y Loss: 0.468180
T Loss: 11.302654
X Loss: -50.015791
Epoch 1999 
Overall Loss: -23.487722
Rec Loss: -39.229768
KL Loss: 15.742045
Y Loss: 0.430794
T Loss: 11.281232
X Loss: -50.726396
Epoch 2049 
Overall Loss: -23.164967
Rec Loss: -38.988321
KL Loss: 15.823354
Y Loss: 0.432793
T Loss: 11.275924
X Loss: -50.480641
Epoch 2099 
Overall Loss: -23.131654
Rec Loss: -38.839914
KL Loss: 15.708261
Y Loss: 0.451537
T Loss: 11.274986
X Loss: -50.340669
Epoch 2149 
Overall Loss: -23.557385
Rec Loss: -39.344398
KL Loss: 15.787014
Y Loss: 0.454603
T Loss: 11.282120
X Loss: -50.853820
Epoch 2199 
Overall Loss: -23.647216
Rec Loss: -39.455488
KL Loss: 15.808271
Y Loss: 0.437504
T Loss: 11.275132
X Loss: -50.949371
Epoch 2249 
Overall Loss: -23.835261
Rec Loss: -39.594109
KL Loss: 15.758847
Y Loss: 0.443550
T Loss: 11.270671
X Loss: -51.086554
Epoch 2299 
Overall Loss: -23.991203
Rec Loss: -39.914579
KL Loss: 15.923376
Y Loss: 0.426652
T Loss: 11.243823
X Loss: -51.371729
Epoch 2349 
Overall Loss: -23.804327
Rec Loss: -39.363947
KL Loss: 15.559620
Y Loss: 0.473906
T Loss: 11.278256
X Loss: -50.879157
Epoch 2399 
Overall Loss: -24.366766
Rec Loss: -40.277624
KL Loss: 15.910859
Y Loss: 0.428366
T Loss: 11.230332
X Loss: -51.722140
Epoch 2449 
Overall Loss: -23.947848
Rec Loss: -39.873317
KL Loss: 15.925469
Y Loss: 0.434868
T Loss: 11.244628
X Loss: -51.335379
Epoch 2499 
Overall Loss: -23.640300
Rec Loss: -39.620202
KL Loss: 15.979902
Y Loss: 0.437218
T Loss: 11.236513
X Loss: -51.075324
Epoch 2549 
Overall Loss: -24.497738
Rec Loss: -40.523419
KL Loss: 16.025679
Y Loss: 0.429580
T Loss: 11.235430
X Loss: -51.973638
Epoch 2599 
Overall Loss: -24.375334
Rec Loss: -40.265649
KL Loss: 15.890315
Y Loss: 0.446944
T Loss: 11.255134
X Loss: -51.744256
Epoch 2649 
Overall Loss: -24.258482
Rec Loss: -39.974359
KL Loss: 15.715878
Y Loss: 0.474285
T Loss: 11.265304
X Loss: -51.476807
Epoch 2699 
Overall Loss: -24.732161
Rec Loss: -40.739648
KL Loss: 16.007486
Y Loss: 0.430759
T Loss: 11.240074
X Loss: -52.195101
Epoch 2749 
Overall Loss: -24.911277
Rec Loss: -40.927592
KL Loss: 16.016315
Y Loss: 0.425456
T Loss: 11.232187
X Loss: -52.372508
Epoch 2799 
Overall Loss: -24.431566
Rec Loss: -40.465943
KL Loss: 16.034376
Y Loss: 0.425707
T Loss: 11.231970
X Loss: -51.910767
Epoch 2849 
Overall Loss: -25.130112
Rec Loss: -41.042378
KL Loss: 15.912266
Y Loss: 0.455916
T Loss: 11.231213
X Loss: -52.501548
Epoch 2899 
Overall Loss: -25.148584
Rec Loss: -41.273688
KL Loss: 16.125104
Y Loss: 0.424198
T Loss: 11.212954
X Loss: -52.698741
Epoch 2949 
Overall Loss: -25.231648
Rec Loss: -41.414972
KL Loss: 16.183324
Y Loss: 0.406773
T Loss: 11.209722
X Loss: -52.828081
Epoch 2999 
Overall Loss: -25.426110
Rec Loss: -41.526318
KL Loss: 16.100209
Y Loss: 0.419656
T Loss: 11.212430
X Loss: -52.948577
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.572840
Epoch 99
Rec Loss: 2.560795
Epoch 149
Rec Loss: 2.533111
Epoch 199
Rec Loss: 2.523427
Epoch 249
Rec Loss: 2.525568
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.006789
Epoch 99
Rec Loss: 0.003457
Epoch 149
Rec Loss: 0.002589
Epoch 199
Rec Loss: 0.001891
Epoch 249
Rec Loss: 0.002010
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.322707
Insample Error 2.910743
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.627030
Epoch 99 
Prediction Loss: 3.416402
Epoch 149 
Prediction Loss: 3.235338
Epoch 199 
Prediction Loss: 3.186721
Epoch 249 
Prediction Loss: 3.130764
Epoch 299 
Prediction Loss: 3.101348
Epoch 349 
Prediction Loss: 3.056386
Epoch 399 
Prediction Loss: 3.025332
Epoch 449 
Prediction Loss: 2.990446
Epoch 499 
Prediction Loss: 3.011252
Epoch 549 
Prediction Loss: 2.974991
Epoch 599 
Prediction Loss: 2.946448
Epoch 649 
Prediction Loss: 2.957682
Epoch 699 
Prediction Loss: 2.901023
Epoch 749 
Prediction Loss: 2.882303
Epoch 799 
Prediction Loss: 2.868782
Epoch 849 
Prediction Loss: 2.855717
Epoch 899 
Prediction Loss: 2.843833
Epoch 949 
Prediction Loss: 2.848729
Epoch 999 
Prediction Loss: 2.797342
Epoch 1049 
Prediction Loss: 2.783705
Epoch 1099 
Prediction Loss: 2.765142
Epoch 1149 
Prediction Loss: 2.767270
Epoch 1199 
Prediction Loss: 2.725524
Epoch 1249 
Prediction Loss: 2.705221
Epoch 1299 
Prediction Loss: 2.691983
Epoch 1349 
Prediction Loss: 2.709926
Epoch 1399 
Prediction Loss: 2.647318
Epoch 1449 
Prediction Loss: 2.648649
Epoch 1499 
Prediction Loss: 2.650934
Epoch 1549 
Prediction Loss: 2.609774
Epoch 1599 
Prediction Loss: 2.583840
Epoch 1649 
Prediction Loss: 2.578357
Epoch 1699 
Prediction Loss: 2.541311
Epoch 1749 
Prediction Loss: 2.535709
Epoch 1799 
Prediction Loss: 2.513731
Epoch 1849 
Prediction Loss: 2.543282
Epoch 1899 
Prediction Loss: 2.513923
Epoch 1949 
Prediction Loss: 2.469302
Epoch 1999 
Prediction Loss: 2.460188
Epoch 2049 
Prediction Loss: 2.443482
Epoch 2099 
Prediction Loss: 2.420983
Epoch 2149 
Prediction Loss: 2.417690
Epoch 2199 
Prediction Loss: 2.383352
Epoch 2249 
Prediction Loss: 2.376261
Epoch 2299 
Prediction Loss: 2.372922
Epoch 2349 
Prediction Loss: 2.358378
Epoch 2399 
Prediction Loss: 2.349696
Epoch 2449 
Prediction Loss: 2.345041
Epoch 2499 
Prediction Loss: 2.340411
Epoch 2549 
Prediction Loss: 2.319875
Epoch 2599 
Prediction Loss: 2.306093
Epoch 2649 
Prediction Loss: 2.292305
Epoch 2699 
Prediction Loss: 2.303678
Epoch 2749 
Prediction Loss: 2.271153
Epoch 2799 
Prediction Loss: 2.272093
Epoch 2849 
Prediction Loss: 2.296222
Epoch 2899 
Prediction Loss: 2.243854
Epoch 2949 
Prediction Loss: 2.230313
Epoch 2999 
Prediction Loss: 2.207827
Epoch 3049 
Prediction Loss: 2.202476
Epoch 3099 
Prediction Loss: 2.191887
Epoch 3149 
Prediction Loss: 2.207311
Epoch 3199 
Prediction Loss: 2.186910
Epoch 3249 
Prediction Loss: 2.181722
Epoch 3299 
Prediction Loss: 2.172292
Epoch 3349 
Prediction Loss: 2.143031
Epoch 3399 
Prediction Loss: 2.153508
Epoch 3449 
Prediction Loss: 2.160358
Epoch 3499 
Prediction Loss: 2.120392
Epoch 3549 
Prediction Loss: 2.136983
Epoch 3599 
Prediction Loss: 2.134221
Epoch 3649 
Prediction Loss: 2.141325
Epoch 3699 
Prediction Loss: 2.097798
Epoch 3749 
Prediction Loss: 2.080309
Epoch 3799 
Prediction Loss: 2.079195
Epoch 3849 
Prediction Loss: 2.065078
Epoch 3899 
Prediction Loss: 2.059991
Epoch 3949 
Prediction Loss: 2.049531
Epoch 3999 
Prediction Loss: 2.038606
Epoch 4049 
Prediction Loss: 2.060514
Epoch 4099 
Prediction Loss: 2.031815
Epoch 4149 
Prediction Loss: 2.061514
Epoch 4199 
Prediction Loss: 2.024687
Epoch 4249 
Prediction Loss: 2.044665
Epoch 4299 
Prediction Loss: 1.995132
Epoch 4349 
Prediction Loss: 2.014348
Epoch 4399 
Prediction Loss: 1.990759
Epoch 4449 
Prediction Loss: 1.998314
Epoch 4499 
Prediction Loss: 1.973137
Epoch 4549 
Prediction Loss: 1.976960
Epoch 4599 
Prediction Loss: 1.962341
Epoch 4649 
Prediction Loss: 1.957571
Epoch 4699 
Prediction Loss: 1.972718
Epoch 4749 
Prediction Loss: 1.950338
Epoch 4799 
Prediction Loss: 1.961529
Epoch 4849 
Prediction Loss: 1.938470
Epoch 4899 
Prediction Loss: 1.913712
Epoch 4949 
Prediction Loss: 1.906628
Epoch 4999 
Prediction Loss: 1.938926
Epoch 5049 
Prediction Loss: 1.901922
Epoch 5099 
Prediction Loss: 1.892464
Epoch 5149 
Prediction Loss: 1.892515
Epoch 5199 
Prediction Loss: 1.883447
Epoch 5249 
Prediction Loss: 1.885834
Epoch 5299 
Prediction Loss: 1.875224
Epoch 5349 
Prediction Loss: 1.880179
Epoch 5399 
Prediction Loss: 1.862029
Epoch 5449 
Prediction Loss: 1.863027
Epoch 5499 
Prediction Loss: 1.863487
Epoch 5549 
Prediction Loss: 1.850561
Epoch 5599 
Prediction Loss: 1.850843
Epoch 5649 
Prediction Loss: 1.845138
Epoch 5699 
Prediction Loss: 1.842961
Epoch 5749 
Prediction Loss: 1.819696
Epoch 5799 
Prediction Loss: 1.850701
Epoch 5849 
Prediction Loss: 1.818657
Epoch 5899 
Prediction Loss: 1.805486
Epoch 5949 
Prediction Loss: 1.820504
Epoch 5999 
Prediction Loss: 1.823620
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.343981
Insample Error 3.623321
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.918928
Rec Loss: 10.259101
KL Loss: 2.659828
Y Loss: 1.011744
T Loss: 9.753229
Epoch 99 
Overall Loss: 12.816691
Rec Loss: 10.194806
KL Loss: 2.621885
Y Loss: 0.999000
T Loss: 9.695306
Epoch 149 
Overall Loss: 12.787374
Rec Loss: 10.199288
KL Loss: 2.588087
Y Loss: 0.995972
T Loss: 9.701301
Epoch 199 
Overall Loss: 12.722522
Rec Loss: 10.191544
KL Loss: 2.530978
Y Loss: 1.001587
T Loss: 9.690751
Epoch 249 
Overall Loss: 12.744786
Rec Loss: 10.217650
KL Loss: 2.527135
Y Loss: 1.024121
T Loss: 9.705590
Epoch 299 
Overall Loss: 12.688738
Rec Loss: 10.173038
KL Loss: 2.515700
Y Loss: 0.963779
T Loss: 9.691149
Epoch 349 
Overall Loss: 12.690848
Rec Loss: 10.160826
KL Loss: 2.530022
Y Loss: 0.998341
T Loss: 9.661655
Epoch 399 
Overall Loss: 12.704207
Rec Loss: 10.147562
KL Loss: 2.556645
Y Loss: 0.975401
T Loss: 9.659862
Epoch 449 
Overall Loss: 12.690922
Rec Loss: 10.141057
KL Loss: 2.549865
Y Loss: 1.000082
T Loss: 9.641016
Epoch 499 
Overall Loss: 12.681388
Rec Loss: 10.157019
KL Loss: 2.524369
Y Loss: 0.991113
T Loss: 9.661462
Epoch 549 
Overall Loss: 12.686520
Rec Loss: 10.135146
KL Loss: 2.551375
Y Loss: 0.981072
T Loss: 9.644610
Epoch 599 
Overall Loss: 12.647747
Rec Loss: 10.146577
KL Loss: 2.501170
Y Loss: 0.973341
T Loss: 9.659907
Epoch 649 
Overall Loss: 12.662701
Rec Loss: 10.153533
KL Loss: 2.509168
Y Loss: 0.995095
T Loss: 9.655985
Epoch 699 
Overall Loss: 12.657677
Rec Loss: 10.128929
KL Loss: 2.528748
Y Loss: 0.979897
T Loss: 9.638980
Epoch 749 
Overall Loss: 12.660389
Rec Loss: 10.129073
KL Loss: 2.531316
Y Loss: 0.995191
T Loss: 9.631477
Epoch 799 
Overall Loss: 12.610540
Rec Loss: 10.100050
KL Loss: 2.510491
Y Loss: 0.972403
T Loss: 9.613849
Epoch 849 
Overall Loss: 12.656920
Rec Loss: 10.157926
KL Loss: 2.498994
Y Loss: 0.997698
T Loss: 9.659077
Epoch 899 
Overall Loss: 12.639555
Rec Loss: 10.105307
KL Loss: 2.534248
Y Loss: 0.963359
T Loss: 9.623627
Epoch 949 
Overall Loss: 12.638389
Rec Loss: 10.119855
KL Loss: 2.518534
Y Loss: 0.985431
T Loss: 9.627140
Epoch 999 
Overall Loss: 12.640256
Rec Loss: 10.137513
KL Loss: 2.502743
Y Loss: 1.019584
T Loss: 9.627722
Epoch 1049 
Overall Loss: 12.644437
Rec Loss: 10.133924
KL Loss: 2.510513
Y Loss: 1.006619
T Loss: 9.630615
Epoch 1099 
Overall Loss: 12.622968
Rec Loss: 10.081411
KL Loss: 2.541557
Y Loss: 0.954342
T Loss: 9.604240
Epoch 1149 
Overall Loss: 12.638459
Rec Loss: 10.145273
KL Loss: 2.493187
Y Loss: 1.019668
T Loss: 9.635439
Epoch 1199 
Overall Loss: 12.627870
Rec Loss: 10.118088
KL Loss: 2.509782
Y Loss: 0.985702
T Loss: 9.625236
Epoch 1249 
Overall Loss: 12.645761
Rec Loss: 10.088470
KL Loss: 2.557292
Y Loss: 0.970947
T Loss: 9.602996
Epoch 1299 
Overall Loss: 12.603346
Rec Loss: 10.102906
KL Loss: 2.500440
Y Loss: 0.970583
T Loss: 9.617614
Epoch 1349 
Overall Loss: 12.619700
Rec Loss: 10.090381
KL Loss: 2.529318
Y Loss: 0.975155
T Loss: 9.602804
Epoch 1399 
Overall Loss: 12.614903
Rec Loss: 10.085693
KL Loss: 2.529210
Y Loss: 0.960458
T Loss: 9.605464
Epoch 1449 
Overall Loss: 12.616020
Rec Loss: 10.106943
KL Loss: 2.509078
Y Loss: 0.979885
T Loss: 9.617000
Epoch 1499 
Overall Loss: 12.606964
Rec Loss: 10.066816
KL Loss: 2.540149
Y Loss: 0.960064
T Loss: 9.586783
Epoch 1549 
Overall Loss: 12.625526
Rec Loss: 10.103386
KL Loss: 2.522140
Y Loss: 1.000837
T Loss: 9.602967
Epoch 1599 
Overall Loss: 12.605129
Rec Loss: 10.097455
KL Loss: 2.507674
Y Loss: 0.992383
T Loss: 9.601263
Epoch 1649 
Overall Loss: 12.587053
Rec Loss: 10.092520
KL Loss: 2.494533
Y Loss: 0.965439
T Loss: 9.609800
Epoch 1699 
Overall Loss: 12.621364
Rec Loss: 10.110648
KL Loss: 2.510716
Y Loss: 1.000160
T Loss: 9.610568
Epoch 1749 
Overall Loss: 12.616854
Rec Loss: 10.076549
KL Loss: 2.540305
Y Loss: 0.980456
T Loss: 9.586321
Epoch 1799 
Overall Loss: 12.630706
Rec Loss: 10.121936
KL Loss: 2.508770
Y Loss: 0.991673
T Loss: 9.626099
Epoch 1849 
Overall Loss: 12.610147
Rec Loss: 10.095929
KL Loss: 2.514218
Y Loss: 0.959318
T Loss: 9.616270
Epoch 1899 
Overall Loss: 12.593191
Rec Loss: 10.079867
KL Loss: 2.513324
Y Loss: 0.973939
T Loss: 9.592897
Epoch 1949 
Overall Loss: 12.621369
Rec Loss: 10.088029
KL Loss: 2.533340
Y Loss: 0.983779
T Loss: 9.596139
Epoch 1999 
Overall Loss: 12.600961
Rec Loss: 10.108727
KL Loss: 2.492234
Y Loss: 0.999981
T Loss: 9.608737
Epoch 2049 
Overall Loss: 12.619444
Rec Loss: 10.075697
KL Loss: 2.543747
Y Loss: 0.991166
T Loss: 9.580113
Epoch 2099 
Overall Loss: 12.617484
Rec Loss: 10.119402
KL Loss: 2.498082
Y Loss: 1.021395
T Loss: 9.608704
Epoch 2149 
Overall Loss: 12.573100
Rec Loss: 10.055928
KL Loss: 2.517171
Y Loss: 0.962723
T Loss: 9.574567
Epoch 2199 
Overall Loss: 12.605723
Rec Loss: 10.095300
KL Loss: 2.510423
Y Loss: 0.970233
T Loss: 9.610184
Epoch 2249 
Overall Loss: 12.602239
Rec Loss: 10.110552
KL Loss: 2.491687
Y Loss: 0.996329
T Loss: 9.612387
Epoch 2299 
Overall Loss: 12.612510
Rec Loss: 10.093152
KL Loss: 2.519359
Y Loss: 0.969541
T Loss: 9.608381
Epoch 2349 
Overall Loss: 12.612118
Rec Loss: 10.077420
KL Loss: 2.534697
Y Loss: 0.970564
T Loss: 9.592139
Epoch 2399 
Overall Loss: 12.596630
Rec Loss: 10.107495
KL Loss: 2.489135
Y Loss: 1.004773
T Loss: 9.605109
Epoch 2449 
Overall Loss: 12.600694
Rec Loss: 10.087563
KL Loss: 2.513130
Y Loss: 0.986688
T Loss: 9.594219
Epoch 2499 
Overall Loss: 12.598077
Rec Loss: 10.077907
KL Loss: 2.520170
Y Loss: 0.991914
T Loss: 9.581950
Epoch 2549 
Overall Loss: 12.600643
Rec Loss: 10.082006
KL Loss: 2.518637
Y Loss: 0.953107
T Loss: 9.605452
Epoch 2599 
Overall Loss: 12.595126
Rec Loss: 10.074242
KL Loss: 2.520884
Y Loss: 0.983911
T Loss: 9.582286
Epoch 2649 
Overall Loss: 12.604170
Rec Loss: 10.085692
KL Loss: 2.518478
Y Loss: 0.997331
T Loss: 9.587027
Epoch 2699 
Overall Loss: 12.578210
Rec Loss: 10.074332
KL Loss: 2.503879
Y Loss: 0.991305
T Loss: 9.578680
Epoch 2749 
Overall Loss: 12.603074
Rec Loss: 10.095618
KL Loss: 2.507456
Y Loss: 1.002275
T Loss: 9.594481
Epoch 2799 
Overall Loss: 12.576314
Rec Loss: 10.088127
KL Loss: 2.488187
Y Loss: 1.008178
T Loss: 9.584038
Epoch 2849 
Overall Loss: 12.599584
Rec Loss: 10.100415
KL Loss: 2.499169
Y Loss: 1.013644
T Loss: 9.593593
Epoch 2899 
Overall Loss: 12.584839
Rec Loss: 10.080776
KL Loss: 2.504063
Y Loss: 0.996348
T Loss: 9.582602
Epoch 2949 
Overall Loss: 12.605719
Rec Loss: 10.068332
KL Loss: 2.537387
Y Loss: 0.963750
T Loss: 9.586457
Epoch 2999 
Overall Loss: 12.592914
Rec Loss: 10.067231
KL Loss: 2.525683
Y Loss: 0.968180
T Loss: 9.583141
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.106845
Epoch 99
Rec Loss: 1.099770
Epoch 149
Rec Loss: 1.096947
Epoch 199
Rec Loss: 1.084769
Epoch 249
Rec Loss: 1.095515
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.186243
Epoch 99
Rec Loss: 10.183089
Epoch 149
Rec Loss: 10.171180
Epoch 199
Rec Loss: 10.174165
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.654782
Insample Error: 2.341031
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 17.322382
Rec Loss: 13.298107
KL Loss: 4.024275
Y Loss: 7.309890
T Loss: 13.539908
X Loss: -3.896746
Epoch 99 
Overall Loss: 1.462409
Rec Loss: -9.140431
KL Loss: 10.602839
Y Loss: 3.270788
T Loss: 13.212199
X Loss: -23.988025
Epoch 149 
Overall Loss: -2.805238
Rec Loss: -14.555796
KL Loss: 11.750559
Y Loss: 2.332618
T Loss: 12.845409
X Loss: -28.567515
Epoch 199 
Overall Loss: -6.251619
Rec Loss: -19.323325
KL Loss: 13.071705
Y Loss: 1.506171
T Loss: 12.204344
X Loss: -32.280753
Epoch 249 
Overall Loss: -8.601934
Rec Loss: -22.581364
KL Loss: 13.979430
Y Loss: 0.944653
T Loss: 11.851670
X Loss: -34.905359
Epoch 299 
Overall Loss: -10.139685
Rec Loss: -24.773879
KL Loss: 14.634195
Y Loss: 0.712817
T Loss: 11.727984
X Loss: -36.858272
Epoch 349 
Overall Loss: -11.211217
Rec Loss: -26.269710
KL Loss: 15.058493
Y Loss: 0.596673
T Loss: 11.675873
X Loss: -38.243921
Epoch 399 
Overall Loss: -12.034315
Rec Loss: -27.286843
KL Loss: 15.252528
Y Loss: 0.546057
T Loss: 11.652669
X Loss: -39.212541
Epoch 449 
Overall Loss: -12.747124
Rec Loss: -28.264736
KL Loss: 15.517613
Y Loss: 0.445419
T Loss: 11.621657
X Loss: -40.109104
Epoch 499 
Overall Loss: -13.428621
Rec Loss: -29.091926
KL Loss: 15.663305
Y Loss: 0.377944
T Loss: 11.609381
X Loss: -40.890280
Epoch 549 
Overall Loss: -14.109460
Rec Loss: -29.879132
KL Loss: 15.769672
Y Loss: 0.328607
T Loss: 11.603391
X Loss: -41.646826
Epoch 599 
Overall Loss: -14.524573
Rec Loss: -30.418644
KL Loss: 15.894071
Y Loss: 0.311229
T Loss: 11.579023
X Loss: -42.153281
Epoch 649 
Overall Loss: -14.967201
Rec Loss: -31.103190
KL Loss: 16.135989
Y Loss: 0.276530
T Loss: 11.550076
X Loss: -42.791532
Epoch 699 
Overall Loss: -15.438353
Rec Loss: -31.702163
KL Loss: 16.263810
Y Loss: 0.258255
T Loss: 11.521071
X Loss: -43.352362
Epoch 749 
Overall Loss: -15.805343
Rec Loss: -32.124759
KL Loss: 16.319416
Y Loss: 0.239180
T Loss: 11.501001
X Loss: -43.745348
Epoch 799 
Overall Loss: -16.145692
Rec Loss: -32.632010
KL Loss: 16.486318
Y Loss: 0.218174
T Loss: 11.477220
X Loss: -44.218317
Epoch 849 
Overall Loss: -16.575475
Rec Loss: -32.991943
KL Loss: 16.416467
Y Loss: 0.201841
T Loss: 11.450448
X Loss: -44.543311
Epoch 899 
Overall Loss: -16.896220
Rec Loss: -33.570605
KL Loss: 16.674384
Y Loss: 0.202528
T Loss: 11.425096
X Loss: -45.096963
Epoch 949 
Overall Loss: -17.302223
Rec Loss: -34.023245
KL Loss: 16.721022
Y Loss: 0.178087
T Loss: 11.393435
X Loss: -45.505722
Epoch 999 
Overall Loss: -17.530266
Rec Loss: -34.307349
KL Loss: 16.777083
Y Loss: 0.189270
T Loss: 11.364682
X Loss: -45.766664
Epoch 1049 
Overall Loss: -17.730034
Rec Loss: -34.543781
KL Loss: 16.813746
Y Loss: 0.176583
T Loss: 11.332458
X Loss: -45.964529
Epoch 1099 
Overall Loss: -18.069314
Rec Loss: -35.113137
KL Loss: 17.043823
Y Loss: 0.175464
T Loss: 11.310137
X Loss: -46.511007
Epoch 1149 
Overall Loss: -18.190747
Rec Loss: -35.421738
KL Loss: 17.230991
Y Loss: 0.165970
T Loss: 11.281796
X Loss: -46.786520
Epoch 1199 
Overall Loss: -18.372068
Rec Loss: -35.556598
KL Loss: 17.184532
Y Loss: 0.162694
T Loss: 11.256437
X Loss: -46.894383
Epoch 1249 
Overall Loss: -18.558496
Rec Loss: -35.869707
KL Loss: 17.311211
Y Loss: 0.160297
T Loss: 11.226784
X Loss: -47.176640
Epoch 1299 
Overall Loss: -18.942121
Rec Loss: -36.373931
KL Loss: 17.431809
Y Loss: 0.157374
T Loss: 11.206872
X Loss: -47.659490
Epoch 1349 
Overall Loss: -18.999642
Rec Loss: -36.586428
KL Loss: 17.586786
Y Loss: 0.156626
T Loss: 11.155164
X Loss: -47.819904
Epoch 1399 
Overall Loss: -19.251390
Rec Loss: -36.709662
KL Loss: 17.458271
Y Loss: 0.161500
T Loss: 11.155439
X Loss: -47.945851
Epoch 1449 
Overall Loss: -19.283354
Rec Loss: -36.887840
KL Loss: 17.604485
Y Loss: 0.150636
T Loss: 11.109410
X Loss: -48.072569
Epoch 1499 
Overall Loss: -19.759584
Rec Loss: -37.494856
KL Loss: 17.735272
Y Loss: 0.148511
T Loss: 11.093461
X Loss: -48.662572
Epoch 1549 
Overall Loss: -19.942162
Rec Loss: -37.752937
KL Loss: 17.810776
Y Loss: 0.159305
T Loss: 11.066543
X Loss: -48.899132
Epoch 1599 
Overall Loss: -20.004754
Rec Loss: -37.884311
KL Loss: 17.879558
Y Loss: 0.144116
T Loss: 11.044859
X Loss: -49.001228
Epoch 1649 
Overall Loss: -20.311596
Rec Loss: -38.208754
KL Loss: 17.897158
Y Loss: 0.143479
T Loss: 11.018036
X Loss: -49.298529
Epoch 1699 
Overall Loss: -20.544508
Rec Loss: -38.506988
KL Loss: 17.962481
Y Loss: 0.156453
T Loss: 11.010339
X Loss: -49.595555
Epoch 1749 
Overall Loss: -20.593663
Rec Loss: -38.519934
KL Loss: 17.926271
Y Loss: 0.149258
T Loss: 10.992652
X Loss: -49.587216
Epoch 1799 
Overall Loss: -20.704747
Rec Loss: -38.830638
KL Loss: 18.125892
Y Loss: 0.147615
T Loss: 10.942507
X Loss: -49.846952
Epoch 1849 
Overall Loss: -20.810215
Rec Loss: -38.983243
KL Loss: 18.173027
Y Loss: 0.138527
T Loss: 10.945125
X Loss: -49.997631
Epoch 1899 
Overall Loss: -20.489908
Rec Loss: -38.670798
KL Loss: 18.180889
Y Loss: 0.143005
T Loss: 10.939480
X Loss: -49.681780
Epoch 1949 
Overall Loss: -20.367489
Rec Loss: -38.589561
KL Loss: 18.222071
Y Loss: 0.136414
T Loss: 10.906360
X Loss: -49.564127
Epoch 1999 
Overall Loss: -21.011787
Rec Loss: -39.277812
KL Loss: 18.266024
Y Loss: 0.133776
T Loss: 10.883073
X Loss: -50.227773
Epoch 2049 
Overall Loss: -21.433068
Rec Loss: -39.654803
KL Loss: 18.221734
Y Loss: 0.133234
T Loss: 10.879350
X Loss: -50.600771
Epoch 2099 
Overall Loss: -21.549037
Rec Loss: -39.797022
KL Loss: 18.247986
Y Loss: 0.129535
T Loss: 10.854090
X Loss: -50.715881
Epoch 2149 
Overall Loss: -21.434727
Rec Loss: -39.662528
KL Loss: 18.227801
Y Loss: 0.142507
T Loss: 10.854619
X Loss: -50.588401
Epoch 2199 
Overall Loss: -20.161844
Rec Loss: -38.686886
KL Loss: 18.525041
Y Loss: 0.136130
T Loss: 10.830645
X Loss: -49.585594
Epoch 2249 
Overall Loss: -21.778994
Rec Loss: -40.286451
KL Loss: 18.507457
Y Loss: 0.134814
T Loss: 10.822408
X Loss: -51.176265
Epoch 2299 
Overall Loss: -21.841534
Rec Loss: -40.383470
KL Loss: 18.541936
Y Loss: 0.140677
T Loss: 10.803355
X Loss: -51.257162
Epoch 2349 
Overall Loss: -21.209497
Rec Loss: -39.637799
KL Loss: 18.428302
Y Loss: 0.129741
T Loss: 10.811568
X Loss: -50.514238
Epoch 2399 
Overall Loss: -21.759410
Rec Loss: -40.281631
KL Loss: 18.522220
Y Loss: 0.128020
T Loss: 10.798174
X Loss: -51.143815
Epoch 2449 
Overall Loss: -21.852689
Rec Loss: -40.435146
KL Loss: 18.582457
Y Loss: 0.134317
T Loss: 10.772204
X Loss: -51.274509
Epoch 2499 
Overall Loss: -21.903666
Rec Loss: -40.420089
KL Loss: 18.516424
Y Loss: 0.133837
T Loss: 10.763062
X Loss: -51.250070
Epoch 2549 
Overall Loss: -22.450359
Rec Loss: -41.051420
KL Loss: 18.601061
Y Loss: 0.131364
T Loss: 10.747597
X Loss: -51.864699
Epoch 2599 
Overall Loss: -22.644205
Rec Loss: -41.223603
KL Loss: 18.579397
Y Loss: 0.129406
T Loss: 10.739834
X Loss: -52.028141
Epoch 2649 
Overall Loss: -22.563372
Rec Loss: -41.262176
KL Loss: 18.698805
Y Loss: 0.132429
T Loss: 10.737239
X Loss: -52.065630
Epoch 2699 
Overall Loss: -22.731470
Rec Loss: -41.456124
KL Loss: 18.724654
Y Loss: 0.127612
T Loss: 10.711017
X Loss: -52.230949
Epoch 2749 
Overall Loss: -22.758552
Rec Loss: -41.539713
KL Loss: 18.781161
Y Loss: 0.129690
T Loss: 10.708753
X Loss: -52.313310
Epoch 2799 
Overall Loss: -22.062720
Rec Loss: -40.711692
KL Loss: 18.648972
Y Loss: 0.137108
T Loss: 10.708088
X Loss: -51.488334
Epoch 2849 
Overall Loss: -22.691597
Rec Loss: -41.336338
KL Loss: 18.644741
Y Loss: 0.139282
T Loss: 10.695256
X Loss: -52.101235
Epoch 2899 
Overall Loss: -22.426166
Rec Loss: -41.378258
KL Loss: 18.952092
Y Loss: 0.131086
T Loss: 10.682560
X Loss: -52.126361
Epoch 2949 
Overall Loss: -22.953661
Rec Loss: -41.844494
KL Loss: 18.890833
Y Loss: 0.128497
T Loss: 10.670223
X Loss: -52.578966
Epoch 2999 
Overall Loss: -22.513609
Rec Loss: -41.524343
KL Loss: 19.010735
Y Loss: 0.135333
T Loss: 10.664169
X Loss: -52.256179
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.321677
Epoch 99
Rec Loss: 2.276237
Epoch 149
Rec Loss: 2.260655
Epoch 199
Rec Loss: 2.254129
Epoch 249
Rec Loss: 2.252875
Epoch 299
Rec Loss: 2.242214
Epoch 349
Rec Loss: 2.247381
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.004134
Epoch 99
Rec Loss: 0.002416
Epoch 149
Rec Loss: 0.001909
Epoch 199
Rec Loss: 0.001529
Epoch 249
Rec Loss: 0.001676
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.220122
Insample Error 4.861311
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.565025
Epoch 99 
Prediction Loss: 3.335500
Epoch 149 
Prediction Loss: 3.198440
Epoch 199 
Prediction Loss: 3.149853
Epoch 249 
Prediction Loss: 3.121210
Epoch 299 
Prediction Loss: 3.090236
Epoch 349 
Prediction Loss: 3.066571
Epoch 399 
Prediction Loss: 3.063555
Epoch 449 
Prediction Loss: 3.056103
Epoch 499 
Prediction Loss: 3.042136
Epoch 549 
Prediction Loss: 3.001950
Epoch 599 
Prediction Loss: 3.010655
Epoch 649 
Prediction Loss: 2.964640
Epoch 699 
Prediction Loss: 2.963393
Epoch 749 
Prediction Loss: 2.962141
Epoch 799 
Prediction Loss: 2.923450
Epoch 849 
Prediction Loss: 2.930326
Epoch 899 
Prediction Loss: 2.916028
Epoch 949 
Prediction Loss: 2.889426
Epoch 999 
Prediction Loss: 2.880715
Epoch 1049 
Prediction Loss: 2.889212
Epoch 1099 
Prediction Loss: 2.849864
Epoch 1149 
Prediction Loss: 2.849963
Epoch 1199 
Prediction Loss: 2.843706
Epoch 1249 
Prediction Loss: 2.821315
Epoch 1299 
Prediction Loss: 2.812544
Epoch 1349 
Prediction Loss: 2.813770
Epoch 1399 
Prediction Loss: 2.779102
Epoch 1449 
Prediction Loss: 2.770362
Epoch 1499 
Prediction Loss: 2.748524
Epoch 1549 
Prediction Loss: 2.751551
Epoch 1599 
Prediction Loss: 2.800674
Epoch 1649 
Prediction Loss: 2.738619
Epoch 1699 
Prediction Loss: 2.737067
Epoch 1749 
Prediction Loss: 2.763356
Epoch 1799 
Prediction Loss: 2.678762
Epoch 1849 
Prediction Loss: 2.686911
Epoch 1899 
Prediction Loss: 2.664773
Epoch 1949 
Prediction Loss: 2.640381
Epoch 1999 
Prediction Loss: 2.631773
Epoch 2049 
Prediction Loss: 2.623742
Epoch 2099 
Prediction Loss: 2.610556
Epoch 2149 
Prediction Loss: 2.594650
Epoch 2199 
Prediction Loss: 2.633578
Epoch 2249 
Prediction Loss: 2.580529
Epoch 2299 
Prediction Loss: 2.577212
Epoch 2349 
Prediction Loss: 2.565558
Epoch 2399 
Prediction Loss: 2.545116
Epoch 2449 
Prediction Loss: 2.538600
Epoch 2499 
Prediction Loss: 2.568410
Epoch 2549 
Prediction Loss: 2.520776
Epoch 2599 
Prediction Loss: 2.514200
Epoch 2649 
Prediction Loss: 2.491874
Epoch 2699 
Prediction Loss: 2.486678
Epoch 2749 
Prediction Loss: 2.492601
Epoch 2799 
Prediction Loss: 2.476376
Epoch 2849 
Prediction Loss: 2.455774
Epoch 2899 
Prediction Loss: 2.446801
Epoch 2949 
Prediction Loss: 2.443779
Epoch 2999 
Prediction Loss: 2.459805
Epoch 3049 
Prediction Loss: 2.399461
Epoch 3099 
Prediction Loss: 2.401889
Epoch 3149 
Prediction Loss: 2.386238
Epoch 3199 
Prediction Loss: 2.370430
Epoch 3249 
Prediction Loss: 2.358606
Epoch 3299 
Prediction Loss: 2.362730
Epoch 3349 
Prediction Loss: 2.414400
Epoch 3399 
Prediction Loss: 2.339871
Epoch 3449 
Prediction Loss: 2.335107
Epoch 3499 
Prediction Loss: 2.333595
Epoch 3549 
Prediction Loss: 2.337930
Epoch 3599 
Prediction Loss: 2.313392
Epoch 3649 
Prediction Loss: 2.297706
Epoch 3699 
Prediction Loss: 2.287767
Epoch 3749 
Prediction Loss: 2.272870
Epoch 3799 
Prediction Loss: 2.267979
Epoch 3849 
Prediction Loss: 2.259371
Epoch 3899 
Prediction Loss: 2.246490
Epoch 3949 
Prediction Loss: 2.246236
Epoch 3999 
Prediction Loss: 2.219735
Epoch 4049 
Prediction Loss: 2.240262
Epoch 4099 
Prediction Loss: 2.203214
Epoch 4149 
Prediction Loss: 2.213229
Epoch 4199 
Prediction Loss: 2.184709
Epoch 4249 
Prediction Loss: 2.169965
Epoch 4299 
Prediction Loss: 2.202188
Epoch 4349 
Prediction Loss: 2.148577
Epoch 4399 
Prediction Loss: 2.153604
Epoch 4449 
Prediction Loss: 2.165399
Epoch 4499 
Prediction Loss: 2.155431
Epoch 4549 
Prediction Loss: 2.127115
Epoch 4599 
Prediction Loss: 2.136717
Epoch 4649 
Prediction Loss: 2.123771
Epoch 4699 
Prediction Loss: 2.110792
Epoch 4749 
Prediction Loss: 2.083043
Epoch 4799 
Prediction Loss: 2.092521
Epoch 4849 
Prediction Loss: 2.062227
Epoch 4899 
Prediction Loss: 2.073117
Epoch 4949 
Prediction Loss: 2.069755
Epoch 4999 
Prediction Loss: 2.064379
Epoch 5049 
Prediction Loss: 2.074245
Epoch 5099 
Prediction Loss: 2.042263
Epoch 5149 
Prediction Loss: 2.050653
Epoch 5199 
Prediction Loss: 2.045693
Epoch 5249 
Prediction Loss: 2.024129
Epoch 5299 
Prediction Loss: 2.034214
Epoch 5349 
Prediction Loss: 2.003094
Epoch 5399 
Prediction Loss: 2.003922
Epoch 5449 
Prediction Loss: 2.004107
Epoch 5499 
Prediction Loss: 1.984934
Epoch 5549 
Prediction Loss: 2.027653
Epoch 5599 
Prediction Loss: 1.968076
Epoch 5649 
Prediction Loss: 2.003133
Epoch 5699 
Prediction Loss: 1.972590
Epoch 5749 
Prediction Loss: 1.963293
Epoch 5799 
Prediction Loss: 1.951949
Epoch 5849 
Prediction Loss: 1.960293
Epoch 5899 
Prediction Loss: 1.974799
Epoch 5949 
Prediction Loss: 1.942490
Epoch 5999 
Prediction Loss: 1.931059
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.399030
Insample Error 3.584529
[31m========== repeat time 4 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.914257
Rec Loss: 10.328562
KL Loss: 2.585695
Y Loss: 1.105034
T Loss: 9.776045
Epoch 99 
Overall Loss: 12.817796
Rec Loss: 10.201678
KL Loss: 2.616118
Y Loss: 0.988914
T Loss: 9.707221
Epoch 149 
Overall Loss: 12.747452
Rec Loss: 10.196599
KL Loss: 2.550853
Y Loss: 0.999024
T Loss: 9.697087
Epoch 199 
Overall Loss: 12.738121
Rec Loss: 10.184991
KL Loss: 2.553130
Y Loss: 0.999989
T Loss: 9.684996
Epoch 249 
Overall Loss: 12.721564
Rec Loss: 10.187846
KL Loss: 2.533717
Y Loss: 0.992960
T Loss: 9.691366
Epoch 299 
Overall Loss: 12.707730
Rec Loss: 10.167244
KL Loss: 2.540485
Y Loss: 1.004654
T Loss: 9.664918
Epoch 349 
Overall Loss: 12.680097
Rec Loss: 10.140879
KL Loss: 2.539217
Y Loss: 0.963182
T Loss: 9.659289
Epoch 399 
Overall Loss: 12.677866
Rec Loss: 10.175815
KL Loss: 2.502052
Y Loss: 0.961548
T Loss: 9.695041
Epoch 449 
Overall Loss: 12.666080
Rec Loss: 10.175117
KL Loss: 2.490963
Y Loss: 1.011581
T Loss: 9.669326
Epoch 499 
Overall Loss: 12.681019
Rec Loss: 10.172570
KL Loss: 2.508450
Y Loss: 0.989365
T Loss: 9.677887
Epoch 549 
Overall Loss: 12.688570
Rec Loss: 10.167070
KL Loss: 2.521500
Y Loss: 0.988572
T Loss: 9.672784
Epoch 599 
Overall Loss: 12.666058
Rec Loss: 10.153462
KL Loss: 2.512596
Y Loss: 0.995381
T Loss: 9.655771
Epoch 649 
Overall Loss: 12.634974
Rec Loss: 10.132009
KL Loss: 2.502965
Y Loss: 0.976219
T Loss: 9.643900
Epoch 699 
Overall Loss: 12.665507
Rec Loss: 10.145059
KL Loss: 2.520448
Y Loss: 0.971742
T Loss: 9.659187
Epoch 749 
Overall Loss: 12.640176
Rec Loss: 10.112095
KL Loss: 2.528081
Y Loss: 0.968796
T Loss: 9.627697
Epoch 799 
Overall Loss: 12.678825
Rec Loss: 10.119438
KL Loss: 2.559387
Y Loss: 0.973647
T Loss: 9.632615
Epoch 849 
Overall Loss: 12.654041
Rec Loss: 10.132599
KL Loss: 2.521443
Y Loss: 0.984447
T Loss: 9.640375
Epoch 899 
Overall Loss: 12.657356
Rec Loss: 10.126817
KL Loss: 2.530539
Y Loss: 0.974085
T Loss: 9.639775
Epoch 949 
Overall Loss: 12.630588
Rec Loss: 10.099896
KL Loss: 2.530691
Y Loss: 0.980582
T Loss: 9.609606
Epoch 999 
Overall Loss: 12.621069
Rec Loss: 10.163179
KL Loss: 2.457891
Y Loss: 1.036207
T Loss: 9.645075
Epoch 1049 
Overall Loss: 12.672214
Rec Loss: 10.093964
KL Loss: 2.578250
Y Loss: 0.977802
T Loss: 9.605063
Epoch 1099 
Overall Loss: 12.633316
Rec Loss: 10.126169
KL Loss: 2.507146
Y Loss: 0.988789
T Loss: 9.631775
Epoch 1149 
Overall Loss: 12.632930
Rec Loss: 10.080336
KL Loss: 2.552594
Y Loss: 0.990932
T Loss: 9.584870
Epoch 1199 
Overall Loss: 12.637671
Rec Loss: 10.107435
KL Loss: 2.530237
Y Loss: 0.990939
T Loss: 9.611965
Epoch 1249 
Overall Loss: 12.635981
Rec Loss: 10.120605
KL Loss: 2.515376
Y Loss: 0.970852
T Loss: 9.635179
Epoch 1299 
Overall Loss: 12.643429
Rec Loss: 10.105592
KL Loss: 2.537837
Y Loss: 0.960097
T Loss: 9.625544
Epoch 1349 
Overall Loss: 12.632421
Rec Loss: 10.107921
KL Loss: 2.524499
Y Loss: 0.972077
T Loss: 9.621883
Epoch 1399 
Overall Loss: 12.633833
Rec Loss: 10.118149
KL Loss: 2.515684
Y Loss: 1.003816
T Loss: 9.616241
Epoch 1449 
Overall Loss: 12.617325
Rec Loss: 10.121978
KL Loss: 2.495347
Y Loss: 0.999218
T Loss: 9.622369
Epoch 1499 
Overall Loss: 12.644192
Rec Loss: 10.096498
KL Loss: 2.547693
Y Loss: 0.986430
T Loss: 9.603284
Epoch 1549 
Overall Loss: 12.608736
Rec Loss: 10.103925
KL Loss: 2.504811
Y Loss: 0.988277
T Loss: 9.609786
Epoch 1599 
Overall Loss: 12.647916
Rec Loss: 10.111269
KL Loss: 2.536647
Y Loss: 0.958582
T Loss: 9.631978
Epoch 1649 
Overall Loss: 12.612499
Rec Loss: 10.095231
KL Loss: 2.517267
Y Loss: 0.954350
T Loss: 9.618056
Epoch 1699 
Overall Loss: 12.620496
Rec Loss: 10.098785
KL Loss: 2.521711
Y Loss: 0.958864
T Loss: 9.619353
Epoch 1749 
Overall Loss: 12.612941
Rec Loss: 10.075046
KL Loss: 2.537895
Y Loss: 0.978220
T Loss: 9.585936
Epoch 1799 
Overall Loss: 12.619105
Rec Loss: 10.112337
KL Loss: 2.506769
Y Loss: 0.960374
T Loss: 9.632150
Epoch 1849 
Overall Loss: 12.591759
Rec Loss: 10.094334
KL Loss: 2.497425
Y Loss: 0.977547
T Loss: 9.605560
Epoch 1899 
Overall Loss: 12.615664
Rec Loss: 10.086747
KL Loss: 2.528917
Y Loss: 0.970955
T Loss: 9.601270
Epoch 1949 
Overall Loss: 12.601852
Rec Loss: 10.090883
KL Loss: 2.510969
Y Loss: 0.993217
T Loss: 9.594275
Epoch 1999 
Overall Loss: 12.605742
Rec Loss: 10.084973
KL Loss: 2.520768
Y Loss: 0.972042
T Loss: 9.598952
Epoch 2049 
Overall Loss: 12.633502
Rec Loss: 10.107949
KL Loss: 2.525553
Y Loss: 0.979930
T Loss: 9.617984
Epoch 2099 
Overall Loss: 12.581791
Rec Loss: 10.089120
KL Loss: 2.492671
Y Loss: 0.961414
T Loss: 9.608413
Epoch 2149 
Overall Loss: 12.615057
Rec Loss: 10.099210
KL Loss: 2.515847
Y Loss: 0.973748
T Loss: 9.612336
Epoch 2199 
Overall Loss: 12.613003
Rec Loss: 10.107804
KL Loss: 2.505198
Y Loss: 0.976215
T Loss: 9.619697
Epoch 2249 
Overall Loss: 12.596811
Rec Loss: 10.082236
KL Loss: 2.514575
Y Loss: 0.968841
T Loss: 9.597815
Epoch 2299 
Overall Loss: 12.594684
Rec Loss: 10.095602
KL Loss: 2.499082
Y Loss: 0.962701
T Loss: 9.614251
Epoch 2349 
Overall Loss: 12.589831
Rec Loss: 10.085825
KL Loss: 2.504005
Y Loss: 0.970798
T Loss: 9.600426
Epoch 2399 
Overall Loss: 12.608017
Rec Loss: 10.091129
KL Loss: 2.516888
Y Loss: 0.984232
T Loss: 9.599013
Epoch 2449 
Overall Loss: 12.600702
Rec Loss: 10.072843
KL Loss: 2.527859
Y Loss: 0.959597
T Loss: 9.593044
Epoch 2499 
Overall Loss: 12.588297
Rec Loss: 10.073370
KL Loss: 2.514926
Y Loss: 0.984122
T Loss: 9.581310
Epoch 2549 
Overall Loss: 12.586838
Rec Loss: 10.079558
KL Loss: 2.507279
Y Loss: 0.979844
T Loss: 9.589636
Epoch 2599 
Overall Loss: 12.584962
Rec Loss: 10.091415
KL Loss: 2.493548
Y Loss: 0.974225
T Loss: 9.604302
Epoch 2649 
Overall Loss: 12.608291
Rec Loss: 10.084142
KL Loss: 2.524150
Y Loss: 0.993480
T Loss: 9.587402
Epoch 2699 
Overall Loss: 12.588192
Rec Loss: 10.104012
KL Loss: 2.484180
Y Loss: 0.988105
T Loss: 9.609959
Epoch 2749 
Overall Loss: 12.597447
Rec Loss: 10.102716
KL Loss: 2.494731
Y Loss: 0.988356
T Loss: 9.608539
Epoch 2799 
Overall Loss: 12.567947
Rec Loss: 10.078961
KL Loss: 2.488986
Y Loss: 0.983463
T Loss: 9.587230
Epoch 2849 
Overall Loss: 12.576937
Rec Loss: 10.082691
KL Loss: 2.494245
Y Loss: 0.972782
T Loss: 9.596300
Epoch 2899 
Overall Loss: 12.589286
Rec Loss: 10.091785
KL Loss: 2.497501
Y Loss: 0.998036
T Loss: 9.592766
Epoch 2949 
Overall Loss: 12.579449
Rec Loss: 10.072539
KL Loss: 2.506910
Y Loss: 0.963341
T Loss: 9.590868
Epoch 2999 
Overall Loss: 12.584105
Rec Loss: 10.077474
KL Loss: 2.506631
Y Loss: 0.976344
T Loss: 9.589302
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.096432
Epoch 99
Rec Loss: 1.093280
Epoch 149
Rec Loss: 1.082775
Epoch 199
Rec Loss: 1.081084
Epoch 249
Rec Loss: 1.085156
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.184315
Epoch 99
Rec Loss: 10.187516
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.669172
Insample Error: 2.241349
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 17.223808
Rec Loss: 14.030647
KL Loss: 3.193161
Y Loss: 6.005689
T Loss: 13.432040
X Loss: -2.404237
Epoch 99 
Overall Loss: -2.197777
Rec Loss: -10.901428
KL Loss: 8.703651
Y Loss: 2.689099
T Loss: 13.250807
X Loss: -25.496784
Epoch 149 
Overall Loss: -7.910726
Rec Loss: -17.780539
KL Loss: 9.869812
Y Loss: 2.106286
T Loss: 13.220981
X Loss: -32.054663
Epoch 199 
Overall Loss: -11.062139
Rec Loss: -21.936157
KL Loss: 10.874018
Y Loss: 1.488256
T Loss: 13.205286
X Loss: -35.885572
Epoch 249 
Overall Loss: -12.797609
Rec Loss: -24.262775
KL Loss: 11.465166
Y Loss: 1.057373
T Loss: 13.191968
X Loss: -37.983429
Epoch 299 
Overall Loss: -13.982067
Rec Loss: -25.806922
KL Loss: 11.824856
Y Loss: 0.899630
T Loss: 13.175509
X Loss: -39.432245
Epoch 349 
Overall Loss: -15.012981
Rec Loss: -27.219567
KL Loss: 12.206586
Y Loss: 0.824851
T Loss: 13.153473
X Loss: -40.785465
Epoch 399 
Overall Loss: -15.820988
Rec Loss: -28.308781
KL Loss: 12.487793
Y Loss: 0.764896
T Loss: 13.133810
X Loss: -41.825039
Epoch 449 
Overall Loss: -16.514384
Rec Loss: -29.182847
KL Loss: 12.668463
Y Loss: 0.782105
T Loss: 13.122419
X Loss: -42.696319
Epoch 499 
Overall Loss: -17.252700
Rec Loss: -30.148593
KL Loss: 12.895893
Y Loss: 0.762990
T Loss: 13.095237
X Loss: -43.625324
Epoch 549 
Overall Loss: -17.599638
Rec Loss: -30.639988
KL Loss: 13.040350
Y Loss: 0.752113
T Loss: 13.069482
X Loss: -44.085526
Epoch 599 
Overall Loss: -18.257724
Rec Loss: -31.427967
KL Loss: 13.170243
Y Loss: 0.765482
T Loss: 13.037256
X Loss: -44.847966
Epoch 649 
Overall Loss: -18.537110
Rec Loss: -31.832846
KL Loss: 13.295736
Y Loss: 0.742310
T Loss: 13.024343
X Loss: -45.228345
Epoch 699 
Overall Loss: -19.156739
Rec Loss: -32.629710
KL Loss: 13.472972
Y Loss: 0.745160
T Loss: 12.983142
X Loss: -45.985433
Epoch 749 
Overall Loss: -19.424012
Rec Loss: -33.022398
KL Loss: 13.598386
Y Loss: 0.728172
T Loss: 12.950302
X Loss: -46.336785
Epoch 799 
Overall Loss: -19.362058
Rec Loss: -33.063976
KL Loss: 13.701917
Y Loss: 0.721271
T Loss: 12.917584
X Loss: -46.342195
Epoch 849 
Overall Loss: -20.105384
Rec Loss: -33.915592
KL Loss: 13.810207
Y Loss: 0.710253
T Loss: 12.875023
X Loss: -47.145741
Epoch 899 
Overall Loss: -20.621062
Rec Loss: -34.525727
KL Loss: 13.904664
Y Loss: 0.692416
T Loss: 12.831273
X Loss: -47.703208
Epoch 949 
Overall Loss: -20.886118
Rec Loss: -34.929510
KL Loss: 14.043393
Y Loss: 0.685292
T Loss: 12.770431
X Loss: -48.042587
Epoch 999 
Overall Loss: -20.636762
Rec Loss: -34.759080
KL Loss: 14.122319
Y Loss: 0.678148
T Loss: 12.721117
X Loss: -47.819270
Epoch 1049 
Overall Loss: -21.327325
Rec Loss: -35.561190
KL Loss: 14.233866
Y Loss: 0.662646
T Loss: 12.658341
X Loss: -48.550856
Epoch 1099 
Overall Loss: -21.782085
Rec Loss: -36.071587
KL Loss: 14.289503
Y Loss: 0.663046
T Loss: 12.607886
X Loss: -49.010997
Epoch 1149 
Overall Loss: -21.735222
Rec Loss: -36.197102
KL Loss: 14.461880
Y Loss: 0.629640
T Loss: 12.539832
X Loss: -49.051754
Epoch 1199 
Overall Loss: -22.428553
Rec Loss: -36.941112
KL Loss: 14.512559
Y Loss: 0.616265
T Loss: 12.453044
X Loss: -49.702288
Epoch 1249 
Overall Loss: -22.660237
Rec Loss: -37.183625
KL Loss: 14.523387
Y Loss: 0.601665
T Loss: 12.426939
X Loss: -49.911397
Epoch 1299 
Overall Loss: -22.620406
Rec Loss: -37.280189
KL Loss: 14.659782
Y Loss: 0.590142
T Loss: 12.360132
X Loss: -49.935391
Epoch 1349 
Overall Loss: -22.367922
Rec Loss: -37.036165
KL Loss: 14.668243
Y Loss: 0.582626
T Loss: 12.339877
X Loss: -49.667355
Epoch 1399 
Overall Loss: -23.169196
Rec Loss: -37.960864
KL Loss: 14.791667
Y Loss: 0.559998
T Loss: 12.261789
X Loss: -50.502651
Epoch 1449 
Overall Loss: -23.313810
Rec Loss: -37.938581
KL Loss: 14.624771
Y Loss: 0.564370
T Loss: 12.224844
X Loss: -50.445609
Epoch 1499 
Overall Loss: -23.669946
Rec Loss: -38.448399
KL Loss: 14.778453
Y Loss: 0.538313
T Loss: 12.166498
X Loss: -50.884053
Epoch 1549 
Overall Loss: -23.076874
Rec Loss: -37.889239
KL Loss: 14.812364
Y Loss: 0.528200
T Loss: 12.102910
X Loss: -50.256248
Epoch 1599 
Overall Loss: -23.975287
Rec Loss: -38.874568
KL Loss: 14.899282
Y Loss: 0.508616
T Loss: 12.044522
X Loss: -51.173397
Epoch 1649 
Overall Loss: -23.929163
Rec Loss: -38.897105
KL Loss: 14.967941
Y Loss: 0.496730
T Loss: 12.000059
X Loss: -51.145529
Epoch 1699 
Overall Loss: -23.668306
Rec Loss: -38.708378
KL Loss: 15.040073
Y Loss: 0.477260
T Loss: 11.937061
X Loss: -50.884070
Epoch 1749 
Overall Loss: -24.652866
Rec Loss: -39.744141
KL Loss: 15.091275
Y Loss: 0.471719
T Loss: 11.887336
X Loss: -51.867336
Epoch 1799 
Overall Loss: -24.619536
Rec Loss: -39.661267
KL Loss: 15.041732
Y Loss: 0.464252
T Loss: 11.855980
X Loss: -51.749373
Epoch 1849 
Overall Loss: -24.809843
Rec Loss: -39.833097
KL Loss: 15.023254
Y Loss: 0.459656
T Loss: 11.818349
X Loss: -51.881275
Epoch 1899 
Overall Loss: -24.644931
Rec Loss: -39.670843
KL Loss: 15.025913
Y Loss: 0.431400
T Loss: 11.773895
X Loss: -51.660439
Epoch 1949 
Overall Loss: -24.652486
Rec Loss: -39.862904
KL Loss: 15.210419
Y Loss: 0.424380
T Loss: 11.730826
X Loss: -51.805920
Epoch 1999 
Overall Loss: -25.188121
Rec Loss: -40.231430
KL Loss: 15.043310
Y Loss: 0.415281
T Loss: 11.718595
X Loss: -52.157666
Epoch 2049 
Overall Loss: -24.826098
Rec Loss: -39.931075
KL Loss: 15.104977
Y Loss: 0.421258
T Loss: 11.675998
X Loss: -51.817702
Epoch 2099 
Overall Loss: -25.362934
Rec Loss: -40.574615
KL Loss: 15.211681
Y Loss: 0.406244
T Loss: 11.637928
X Loss: -52.415666
Epoch 2149 
Overall Loss: -25.639301
Rec Loss: -40.841794
KL Loss: 15.202493
Y Loss: 0.378756
T Loss: 11.624325
X Loss: -52.655497
Epoch 2199 
Overall Loss: -26.022102
Rec Loss: -41.253723
KL Loss: 15.231621
Y Loss: 0.374641
T Loss: 11.587224
X Loss: -53.028267
Epoch 2249 
Overall Loss: -25.979050
Rec Loss: -41.271449
KL Loss: 15.292400
Y Loss: 0.370737
T Loss: 11.571765
X Loss: -53.028583
Epoch 2299 
Overall Loss: -25.751273
Rec Loss: -41.044463
KL Loss: 15.293191
Y Loss: 0.367364
T Loss: 11.565134
X Loss: -52.793279
Epoch 2349 
Overall Loss: -25.501592
Rec Loss: -40.356799
KL Loss: 14.855207
Y Loss: 0.392225
T Loss: 11.594999
X Loss: -52.147910
Epoch 2399 
Overall Loss: -26.060016
Rec Loss: -41.229962
KL Loss: 15.169946
Y Loss: 0.362899
T Loss: 11.530599
X Loss: -52.942010
Epoch 2449 
Overall Loss: -26.300215
Rec Loss: -41.493079
KL Loss: 15.192864
Y Loss: 0.351918
T Loss: 11.506989
X Loss: -53.176027
Epoch 2499 
Overall Loss: -26.414656
Rec Loss: -41.780403
KL Loss: 15.365746
Y Loss: 0.349431
T Loss: 11.494115
X Loss: -53.449233
Epoch 2549 
Overall Loss: -26.774938
Rec Loss: -42.148853
KL Loss: 15.373914
Y Loss: 0.337793
T Loss: 11.476129
X Loss: -53.793879
Epoch 2599 
Overall Loss: -26.077863
Rec Loss: -40.980188
KL Loss: 14.902325
Y Loss: 0.364536
T Loss: 11.530567
X Loss: -52.693024
Epoch 2649 
Overall Loss: -25.729005
Rec Loss: -40.975524
KL Loss: 15.246520
Y Loss: 0.345499
T Loss: 11.476779
X Loss: -52.625052
Epoch 2699 
Overall Loss: -26.730975
Rec Loss: -41.852668
KL Loss: 15.121694
Y Loss: 0.356624
T Loss: 11.484556
X Loss: -53.515536
Epoch 2749 
Overall Loss: -26.083915
Rec Loss: -41.474669
KL Loss: 15.390753
Y Loss: 0.325867
T Loss: 11.461403
X Loss: -53.099006
Epoch 2799 
Overall Loss: -27.170544
Rec Loss: -42.642165
KL Loss: 15.471621
Y Loss: 0.318186
T Loss: 11.434415
X Loss: -54.235674
Epoch 2849 
Overall Loss: -26.081606
Rec Loss: -41.458290
KL Loss: 15.376684
Y Loss: 0.316844
T Loss: 11.422063
X Loss: -53.038774
Epoch 2899 
Overall Loss: -26.866030
Rec Loss: -42.402596
KL Loss: 15.536566
Y Loss: 0.301297
T Loss: 11.415450
X Loss: -53.968695
Epoch 2949 
Overall Loss: -27.237320
Rec Loss: -42.809642
KL Loss: 15.572321
Y Loss: 0.306811
T Loss: 11.421537
X Loss: -54.384584
Epoch 2999 
Overall Loss: -27.123581
Rec Loss: -42.476278
KL Loss: 15.352697
Y Loss: 0.322289
T Loss: 11.419591
X Loss: -54.057014
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.530667
Epoch 99
Rec Loss: 2.500070
Epoch 149
Rec Loss: 2.493070
Epoch 199
Rec Loss: 2.486987
Epoch 249
Rec Loss: 2.470414
Epoch 299
Rec Loss: 2.484197
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.005070
Epoch 99
Rec Loss: 0.003206
Epoch 149
Rec Loss: 0.001309
Epoch 199
Rec Loss: 0.001316
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.419960
Insample Error 3.741131
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.592079
Epoch 99 
Prediction Loss: 3.372350
Epoch 149 
Prediction Loss: 3.236235
Epoch 199 
Prediction Loss: 3.201554
Epoch 249 
Prediction Loss: 3.122307
Epoch 299 
Prediction Loss: 3.093136
Epoch 349 
Prediction Loss: 3.059083
Epoch 399 
Prediction Loss: 3.041956
Epoch 449 
Prediction Loss: 3.024739
Epoch 499 
Prediction Loss: 3.033743
Epoch 549 
Prediction Loss: 3.013014
Epoch 599 
Prediction Loss: 2.974085
Epoch 649 
Prediction Loss: 3.007526
Epoch 699 
Prediction Loss: 2.960455
Epoch 749 
Prediction Loss: 2.943645
Epoch 799 
Prediction Loss: 2.922147
Epoch 849 
Prediction Loss: 2.932005
Epoch 899 
Prediction Loss: 2.899542
Epoch 949 
Prediction Loss: 2.887982
Epoch 999 
Prediction Loss: 2.897722
Epoch 1049 
Prediction Loss: 2.876026
Epoch 1099 
Prediction Loss: 2.879431
Epoch 1149 
Prediction Loss: 2.856653
Epoch 1199 
Prediction Loss: 2.860348
Epoch 1249 
Prediction Loss: 2.863319
Epoch 1299 
Prediction Loss: 2.817101
Epoch 1349 
Prediction Loss: 2.800530
Epoch 1399 
Prediction Loss: 2.804231
Epoch 1449 
Prediction Loss: 2.782375
Epoch 1499 
Prediction Loss: 2.802337
Epoch 1549 
Prediction Loss: 2.765978
Epoch 1599 
Prediction Loss: 2.739316
Epoch 1649 
Prediction Loss: 2.770223
Epoch 1699 
Prediction Loss: 2.725011
Epoch 1749 
Prediction Loss: 2.712986
Epoch 1799 
Prediction Loss: 2.702298
Epoch 1849 
Prediction Loss: 2.686512
Epoch 1899 
Prediction Loss: 2.665506
Epoch 1949 
Prediction Loss: 2.663506
Epoch 1999 
Prediction Loss: 2.658425
Epoch 2049 
Prediction Loss: 2.652301
Epoch 2099 
Prediction Loss: 2.660222
Epoch 2149 
Prediction Loss: 2.642323
Epoch 2199 
Prediction Loss: 2.636835
Epoch 2249 
Prediction Loss: 2.630794
Epoch 2299 
Prediction Loss: 2.590789
Epoch 2349 
Prediction Loss: 2.605804
Epoch 2399 
Prediction Loss: 2.579567
Epoch 2449 
Prediction Loss: 2.597623
Epoch 2499 
Prediction Loss: 2.557200
Epoch 2549 
Prediction Loss: 2.569110
Epoch 2599 
Prediction Loss: 2.535647
Epoch 2649 
Prediction Loss: 2.561123
Epoch 2699 
Prediction Loss: 2.509601
Epoch 2749 
Prediction Loss: 2.500645
Epoch 2799 
Prediction Loss: 2.492892
Epoch 2849 
Prediction Loss: 2.507115
Epoch 2899 
Prediction Loss: 2.569188
Epoch 2949 
Prediction Loss: 2.466295
Epoch 2999 
Prediction Loss: 2.468722
Epoch 3049 
Prediction Loss: 2.463510
Epoch 3099 
Prediction Loss: 2.467630
Epoch 3149 
Prediction Loss: 2.443086
Epoch 3199 
Prediction Loss: 2.413106
Epoch 3249 
Prediction Loss: 2.412692
Epoch 3299 
Prediction Loss: 2.397088
Epoch 3349 
Prediction Loss: 2.412023
Epoch 3399 
Prediction Loss: 2.429496
Epoch 3449 
Prediction Loss: 2.376839
Epoch 3499 
Prediction Loss: 2.403623
Epoch 3549 
Prediction Loss: 2.357292
Epoch 3599 
Prediction Loss: 2.354453
Epoch 3649 
Prediction Loss: 2.362723
Epoch 3699 
Prediction Loss: 2.348126
Epoch 3749 
Prediction Loss: 2.317863
Epoch 3799 
Prediction Loss: 2.321006
Epoch 3849 
Prediction Loss: 2.305605
Epoch 3899 
Prediction Loss: 2.279482
Epoch 3949 
Prediction Loss: 2.301262
Epoch 3999 
Prediction Loss: 2.297137
Epoch 4049 
Prediction Loss: 2.272797
Epoch 4099 
Prediction Loss: 2.273850
Epoch 4149 
Prediction Loss: 2.257100
Epoch 4199 
Prediction Loss: 2.275361
Epoch 4249 
Prediction Loss: 2.251254
Epoch 4299 
Prediction Loss: 2.288145
Epoch 4349 
Prediction Loss: 2.220459
Epoch 4399 
Prediction Loss: 2.229458
Epoch 4449 
Prediction Loss: 2.221987
Epoch 4499 
Prediction Loss: 2.244644
Epoch 4549 
Prediction Loss: 2.220897
Epoch 4599 
Prediction Loss: 2.210591
Epoch 4649 
Prediction Loss: 2.193418
Epoch 4699 
Prediction Loss: 2.183400
Epoch 4749 
Prediction Loss: 2.167712
Epoch 4799 
Prediction Loss: 2.155444
Epoch 4849 
Prediction Loss: 2.150316
Epoch 4899 
Prediction Loss: 2.129689
Epoch 4949 
Prediction Loss: 2.130522
Epoch 4999 
Prediction Loss: 2.129037
Epoch 5049 
Prediction Loss: 2.128415
Epoch 5099 
Prediction Loss: 2.121744
Epoch 5149 
Prediction Loss: 2.119237
Epoch 5199 
Prediction Loss: 2.111796
Epoch 5249 
Prediction Loss: 2.095722
Epoch 5299 
Prediction Loss: 2.109754
Epoch 5349 
Prediction Loss: 2.070195
Epoch 5399 
Prediction Loss: 2.086413
Epoch 5449 
Prediction Loss: 2.055651
Epoch 5499 
Prediction Loss: 2.081256
Epoch 5549 
Prediction Loss: 2.050548
Epoch 5599 
Prediction Loss: 2.074320
Epoch 5649 
Prediction Loss: 2.033033
Epoch 5699 
Prediction Loss: 2.069209
Epoch 5749 
Prediction Loss: 2.090682
Epoch 5799 
Prediction Loss: 2.029814
Epoch 5849 
Prediction Loss: 2.019056
Epoch 5899 
Prediction Loss: 2.036473
Epoch 5949 
Prediction Loss: 2.034948
Epoch 5999 
Prediction Loss: 2.016634
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.412264
Insample Error 3.536670
[31m========== repeat time 5 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.928641
Rec Loss: 10.283298
KL Loss: 2.645342
Y Loss: 1.039774
T Loss: 9.763411
Epoch 99 
Overall Loss: 12.811546
Rec Loss: 10.201021
KL Loss: 2.610525
Y Loss: 0.989619
T Loss: 9.706212
Epoch 149 
Overall Loss: 12.774440
Rec Loss: 10.181169
KL Loss: 2.593271
Y Loss: 1.000396
T Loss: 9.680972
Epoch 199 
Overall Loss: 12.722734
Rec Loss: 10.140030
KL Loss: 2.582704
Y Loss: 0.974189
T Loss: 9.652936
Epoch 249 
Overall Loss: 12.721620
Rec Loss: 10.162043
KL Loss: 2.559576
Y Loss: 0.987246
T Loss: 9.668421
Epoch 299 
Overall Loss: 12.694717
Rec Loss: 10.161185
KL Loss: 2.533532
Y Loss: 0.995967
T Loss: 9.663202
Epoch 349 
Overall Loss: 12.699541
Rec Loss: 10.187212
KL Loss: 2.512329
Y Loss: 1.010132
T Loss: 9.682146
Epoch 399 
Overall Loss: 12.683091
Rec Loss: 10.135007
KL Loss: 2.548085
Y Loss: 0.980789
T Loss: 9.644612
Epoch 449 
Overall Loss: 12.674072
Rec Loss: 10.154164
KL Loss: 2.519908
Y Loss: 0.981990
T Loss: 9.663170
Epoch 499 
Overall Loss: 12.698672
Rec Loss: 10.180165
KL Loss: 2.518507
Y Loss: 1.014070
T Loss: 9.673130
Epoch 549 
Overall Loss: 12.673530
Rec Loss: 10.144763
KL Loss: 2.528768
Y Loss: 0.986107
T Loss: 9.651709
Epoch 599 
Overall Loss: 12.672857
Rec Loss: 10.174896
KL Loss: 2.497962
Y Loss: 1.006296
T Loss: 9.671748
Epoch 649 
Overall Loss: 12.668162
Rec Loss: 10.145538
KL Loss: 2.522624
Y Loss: 0.995407
T Loss: 9.647834
Epoch 699 
Overall Loss: 12.657697
Rec Loss: 10.119680
KL Loss: 2.538017
Y Loss: 0.991784
T Loss: 9.623788
Epoch 749 
Overall Loss: 12.657667
Rec Loss: 10.136689
KL Loss: 2.520978
Y Loss: 0.977669
T Loss: 9.647854
Epoch 799 
Overall Loss: 12.639903
Rec Loss: 10.090549
KL Loss: 2.549355
Y Loss: 0.956555
T Loss: 9.612271
Epoch 849 
Overall Loss: 12.648549
Rec Loss: 10.137247
KL Loss: 2.511301
Y Loss: 0.974163
T Loss: 9.650166
Epoch 899 
Overall Loss: 12.627248
Rec Loss: 10.093017
KL Loss: 2.534232
Y Loss: 0.987607
T Loss: 9.599213
Epoch 949 
Overall Loss: 12.662136
Rec Loss: 10.127332
KL Loss: 2.534804
Y Loss: 1.004339
T Loss: 9.625163
Epoch 999 
Overall Loss: 12.643034
Rec Loss: 10.135153
KL Loss: 2.507881
Y Loss: 0.996157
T Loss: 9.637075
Epoch 1049 
Overall Loss: 12.625396
Rec Loss: 10.105906
KL Loss: 2.519490
Y Loss: 0.972074
T Loss: 9.619869
Epoch 1099 
Overall Loss: 12.651212
Rec Loss: 10.114005
KL Loss: 2.537206
Y Loss: 0.984342
T Loss: 9.621834
Epoch 1149 
Overall Loss: 12.650752
Rec Loss: 10.132421
KL Loss: 2.518330
Y Loss: 0.986462
T Loss: 9.639191
Epoch 1199 
Overall Loss: 12.626102
Rec Loss: 10.101633
KL Loss: 2.524469
Y Loss: 0.952227
T Loss: 9.625519
Epoch 1249 
Overall Loss: 12.616078
Rec Loss: 10.126939
KL Loss: 2.489139
Y Loss: 0.974786
T Loss: 9.639547
Epoch 1299 
Overall Loss: 12.629666
Rec Loss: 10.120081
KL Loss: 2.509584
Y Loss: 0.985328
T Loss: 9.627417
Epoch 1349 
Overall Loss: 12.623902
Rec Loss: 10.121925
KL Loss: 2.501977
Y Loss: 0.978973
T Loss: 9.632439
Epoch 1399 
Overall Loss: 12.614613
Rec Loss: 10.098502
KL Loss: 2.516111
Y Loss: 0.979845
T Loss: 9.608580
Epoch 1449 
Overall Loss: 12.625968
Rec Loss: 10.117674
KL Loss: 2.508295
Y Loss: 0.993042
T Loss: 9.621153
Epoch 1499 
Overall Loss: 12.613260
Rec Loss: 10.095057
KL Loss: 2.518203
Y Loss: 0.969013
T Loss: 9.610550
Epoch 1549 
Overall Loss: 12.621323
Rec Loss: 10.130224
KL Loss: 2.491100
Y Loss: 0.996096
T Loss: 9.632176
Epoch 1599 
Overall Loss: 12.619778
Rec Loss: 10.102856
KL Loss: 2.516921
Y Loss: 0.985428
T Loss: 9.610142
Epoch 1649 
Overall Loss: 12.610940
Rec Loss: 10.083544
KL Loss: 2.527396
Y Loss: 0.981094
T Loss: 9.592997
Epoch 1699 
Overall Loss: 12.635705
Rec Loss: 10.089759
KL Loss: 2.545946
Y Loss: 0.998940
T Loss: 9.590289
Epoch 1749 
Overall Loss: 12.626325
Rec Loss: 10.098653
KL Loss: 2.527673
Y Loss: 0.989424
T Loss: 9.603940
Epoch 1799 
Overall Loss: 12.610421
Rec Loss: 10.081227
KL Loss: 2.529194
Y Loss: 0.965560
T Loss: 9.598447
Epoch 1849 
Overall Loss: 12.625257
Rec Loss: 10.095031
KL Loss: 2.530227
Y Loss: 0.999917
T Loss: 9.595073
Epoch 1899 
Overall Loss: 12.615216
Rec Loss: 10.126678
KL Loss: 2.488539
Y Loss: 1.010699
T Loss: 9.621328
Epoch 1949 
Overall Loss: 12.619616
Rec Loss: 10.104786
KL Loss: 2.514830
Y Loss: 0.983543
T Loss: 9.613014
Epoch 1999 
Overall Loss: 12.595129
Rec Loss: 10.068531
KL Loss: 2.526599
Y Loss: 0.983507
T Loss: 9.576778
Epoch 2049 
Overall Loss: 12.638465
Rec Loss: 10.083837
KL Loss: 2.554628
Y Loss: 0.989129
T Loss: 9.589273
Epoch 2099 
Overall Loss: 12.598271
Rec Loss: 10.077644
KL Loss: 2.520626
Y Loss: 0.962613
T Loss: 9.596338
Epoch 2149 
Overall Loss: 12.610221
Rec Loss: 10.108118
KL Loss: 2.502102
Y Loss: 0.990572
T Loss: 9.612832
Epoch 2199 
Overall Loss: 12.591045
Rec Loss: 10.085216
KL Loss: 2.505829
Y Loss: 0.964613
T Loss: 9.602910
Epoch 2249 
Overall Loss: 12.597171
Rec Loss: 10.083679
KL Loss: 2.513492
Y Loss: 0.982050
T Loss: 9.592654
Epoch 2299 
Overall Loss: 12.586105
Rec Loss: 10.100576
KL Loss: 2.485529
Y Loss: 0.959190
T Loss: 9.620981
Epoch 2349 
Overall Loss: 12.591243
Rec Loss: 10.070350
KL Loss: 2.520893
Y Loss: 0.974339
T Loss: 9.583180
Epoch 2399 
Overall Loss: 12.611167
Rec Loss: 10.085704
KL Loss: 2.525463
Y Loss: 0.985338
T Loss: 9.593035
Epoch 2449 
Overall Loss: 12.586139
Rec Loss: 10.072954
KL Loss: 2.513185
Y Loss: 0.970927
T Loss: 9.587490
Epoch 2499 
Overall Loss: 12.598620
Rec Loss: 10.068718
KL Loss: 2.529901
Y Loss: 0.962870
T Loss: 9.587284
Epoch 2549 
Overall Loss: 12.567246
Rec Loss: 10.083323
KL Loss: 2.483922
Y Loss: 0.957132
T Loss: 9.604758
Epoch 2599 
Overall Loss: 12.612037
Rec Loss: 10.056835
KL Loss: 2.555202
Y Loss: 0.983156
T Loss: 9.565257
Epoch 2649 
Overall Loss: 12.613420
Rec Loss: 10.092837
KL Loss: 2.520583
Y Loss: 0.995583
T Loss: 9.595046
Epoch 2699 
Overall Loss: 12.586288
Rec Loss: 10.073091
KL Loss: 2.513197
Y Loss: 0.975208
T Loss: 9.585487
Epoch 2749 
Overall Loss: 12.596798
Rec Loss: 10.081460
KL Loss: 2.515338
Y Loss: 1.000921
T Loss: 9.581000
Epoch 2799 
Overall Loss: 12.593895
Rec Loss: 10.065812
KL Loss: 2.528083
Y Loss: 0.974446
T Loss: 9.578588
Epoch 2849 
Overall Loss: 12.556250
Rec Loss: 10.061628
KL Loss: 2.494622
Y Loss: 0.974976
T Loss: 9.574140
Epoch 2899 
Overall Loss: 12.589282
Rec Loss: 10.061445
KL Loss: 2.527837
Y Loss: 0.950367
T Loss: 9.586261
Epoch 2949 
Overall Loss: 12.577456
Rec Loss: 10.081886
KL Loss: 2.495570
Y Loss: 0.961702
T Loss: 9.601035
Epoch 2999 
Overall Loss: 12.581579
Rec Loss: 10.054278
KL Loss: 2.527301
Y Loss: 0.981149
T Loss: 9.563703
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.097998
Epoch 99
Rec Loss: 1.083278
Epoch 149
Rec Loss: 1.089827
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.194748
Epoch 99
Rec Loss: 10.192982
Epoch 149
Rec Loss: 10.183659
Epoch 199
Rec Loss: 10.188682
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.655058
Insample Error: 2.169377
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 17.215852
Rec Loss: 13.543736
KL Loss: 3.672115
Y Loss: 7.459451
T Loss: 13.556214
X Loss: -3.742203
Epoch 99 
Overall Loss: -0.617517
Rec Loss: -8.579189
KL Loss: 7.961673
Y Loss: 5.331638
T Loss: 13.724852
X Loss: -24.969860
Epoch 149 
Overall Loss: -5.771745
Rec Loss: -14.798932
KL Loss: 9.027188
Y Loss: 4.323348
T Loss: 13.591042
X Loss: -30.551648
Epoch 199 
Overall Loss: -8.843410
Rec Loss: -18.833002
KL Loss: 9.989593
Y Loss: 3.593821
T Loss: 13.466274
X Loss: -34.096186
Epoch 249 
Overall Loss: -10.931970
Rec Loss: -21.812969
KL Loss: 10.880999
Y Loss: 2.842254
T Loss: 13.360361
X Loss: -36.594457
Epoch 299 
Overall Loss: -12.382847
Rec Loss: -23.877427
KL Loss: 11.494579
Y Loss: 2.100430
T Loss: 13.296753
X Loss: -38.224395
Epoch 349 
Overall Loss: -13.649712
Rec Loss: -25.717349
KL Loss: 12.067638
Y Loss: 1.588062
T Loss: 13.195096
X Loss: -39.706476
Epoch 399 
Overall Loss: -14.547586
Rec Loss: -27.054675
KL Loss: 12.507089
Y Loss: 1.366514
T Loss: 13.079109
X Loss: -40.817040
Epoch 449 
Overall Loss: -15.410911
Rec Loss: -28.241795
KL Loss: 12.830884
Y Loss: 1.123303
T Loss: 12.860629
X Loss: -41.664075
Epoch 499 
Overall Loss: -15.747333
Rec Loss: -28.987739
KL Loss: 13.240406
Y Loss: 0.990586
T Loss: 12.587733
X Loss: -42.070765
Epoch 549 
Overall Loss: -16.860323
Rec Loss: -30.346120
KL Loss: 13.485797
Y Loss: 0.880392
T Loss: 12.366101
X Loss: -43.152418
Epoch 599 
Overall Loss: -17.347875
Rec Loss: -30.958483
KL Loss: 13.610608
Y Loss: 0.847201
T Loss: 12.216516
X Loss: -43.598598
Epoch 649 
Overall Loss: -17.732338
Rec Loss: -31.471113
KL Loss: 13.738776
Y Loss: 0.828232
T Loss: 12.093911
X Loss: -43.979140
Epoch 699 
Overall Loss: -18.288600
Rec Loss: -32.153310
KL Loss: 13.864709
Y Loss: 0.779553
T Loss: 12.013272
X Loss: -44.556358
Epoch 749 
Overall Loss: -18.648421
Rec Loss: -32.559482
KL Loss: 13.911061
Y Loss: 0.775572
T Loss: 11.949842
X Loss: -44.897110
Epoch 799 
Overall Loss: -18.943365
Rec Loss: -32.883989
KL Loss: 13.940625
Y Loss: 0.768977
T Loss: 11.931503
X Loss: -45.199981
Epoch 849 
Overall Loss: -19.146665
Rec Loss: -33.178098
KL Loss: 14.031433
Y Loss: 0.759108
T Loss: 11.877605
X Loss: -45.435257
Epoch 899 
Overall Loss: -19.467252
Rec Loss: -33.543454
KL Loss: 14.076200
Y Loss: 0.751212
T Loss: 11.850936
X Loss: -45.769995
Epoch 949 
Overall Loss: -19.641471
Rec Loss: -33.775503
KL Loss: 14.134033
Y Loss: 0.697421
T Loss: 11.820636
X Loss: -45.944848
Epoch 999 
Overall Loss: -19.816895
Rec Loss: -34.062139
KL Loss: 14.245244
Y Loss: 0.684517
T Loss: 11.780403
X Loss: -46.184800
Epoch 1049 
Overall Loss: -20.177312
Rec Loss: -34.441953
KL Loss: 14.264640
Y Loss: 0.689649
T Loss: 11.761655
X Loss: -46.548432
Epoch 1099 
Overall Loss: -20.400961
Rec Loss: -34.804705
KL Loss: 14.403745
Y Loss: 0.671484
T Loss: 11.718741
X Loss: -46.859189
Epoch 1149 
Overall Loss: -20.697687
Rec Loss: -34.942233
KL Loss: 14.244545
Y Loss: 0.680959
T Loss: 11.721854
X Loss: -47.004566
Epoch 1199 
Overall Loss: -20.624189
Rec Loss: -34.996424
KL Loss: 14.372234
Y Loss: 0.646302
T Loss: 11.694187
X Loss: -47.013762
Epoch 1249 
Overall Loss: -21.171228
Rec Loss: -35.647710
KL Loss: 14.476482
Y Loss: 0.636350
T Loss: 11.684849
X Loss: -47.650733
Epoch 1299 
Overall Loss: -21.036198
Rec Loss: -35.563597
KL Loss: 14.527399
Y Loss: 0.631009
T Loss: 11.659173
X Loss: -47.538274
Epoch 1349 
Overall Loss: -21.200572
Rec Loss: -35.685576
KL Loss: 14.485004
Y Loss: 0.625383
T Loss: 11.635635
X Loss: -47.633904
Epoch 1399 
Overall Loss: -21.122359
Rec Loss: -35.734166
KL Loss: 14.611807
Y Loss: 0.593012
T Loss: 11.626968
X Loss: -47.657639
Epoch 1449 
Overall Loss: -21.909108
Rec Loss: -36.461311
KL Loss: 14.552202
Y Loss: 0.596819
T Loss: 11.627888
X Loss: -48.387608
Epoch 1499 
Overall Loss: -21.582548
Rec Loss: -36.259099
KL Loss: 14.676550
Y Loss: 0.578837
T Loss: 11.604417
X Loss: -48.152933
Epoch 1549 
Overall Loss: -22.115151
Rec Loss: -36.837981
KL Loss: 14.722831
Y Loss: 0.582219
T Loss: 11.595613
X Loss: -48.724704
Epoch 1599 
Overall Loss: -22.455745
Rec Loss: -37.167801
KL Loss: 14.712057
Y Loss: 0.554928
T Loss: 11.599910
X Loss: -49.045176
Epoch 1649 
Overall Loss: -22.545518
Rec Loss: -37.257571
KL Loss: 14.712053
Y Loss: 0.546903
T Loss: 11.585906
X Loss: -49.116928
Epoch 1699 
Overall Loss: -22.505559
Rec Loss: -37.346943
KL Loss: 14.841384
Y Loss: 0.524695
T Loss: 11.569758
X Loss: -49.179048
Epoch 1749 
Overall Loss: -23.045838
Rec Loss: -37.751154
KL Loss: 14.705316
Y Loss: 0.528560
T Loss: 11.564254
X Loss: -49.579688
Epoch 1799 
Overall Loss: -22.638660
Rec Loss: -37.403715
KL Loss: 14.765057
Y Loss: 0.522064
T Loss: 11.554422
X Loss: -49.219172
Epoch 1849 
Overall Loss: -22.777624
Rec Loss: -37.623675
KL Loss: 14.846051
Y Loss: 0.488819
T Loss: 11.563700
X Loss: -49.431783
Epoch 1899 
Overall Loss: -22.739303
Rec Loss: -37.445253
KL Loss: 14.705950
Y Loss: 0.497877
T Loss: 11.579764
X Loss: -49.273955
Epoch 1949 
Overall Loss: -22.232009
Rec Loss: -37.074434
KL Loss: 14.842424
Y Loss: 0.472093
T Loss: 11.544716
X Loss: -48.855197
Epoch 1999 
Overall Loss: -23.346968
Rec Loss: -38.104146
KL Loss: 14.757177
Y Loss: 0.484958
T Loss: 11.539622
X Loss: -49.886246
Epoch 2049 
Overall Loss: -23.730249
Rec Loss: -38.619316
KL Loss: 14.889068
Y Loss: 0.450162
T Loss: 11.527971
X Loss: -50.372370
Epoch 2099 
Overall Loss: -23.260364
Rec Loss: -38.055799
KL Loss: 14.795435
Y Loss: 0.453163
T Loss: 11.542260
X Loss: -49.824640
Epoch 2149 
Overall Loss: -23.129247
Rec Loss: -38.025475
KL Loss: 14.896230
Y Loss: 0.429934
T Loss: 11.531675
X Loss: -49.772117
Epoch 2199 
Overall Loss: -23.951084
Rec Loss: -38.971842
KL Loss: 15.020758
Y Loss: 0.420209
T Loss: 11.510779
X Loss: -50.692725
Epoch 2249 
Overall Loss: -23.973236
Rec Loss: -38.786350
KL Loss: 14.813114
Y Loss: 0.422867
T Loss: 11.526428
X Loss: -50.524211
Epoch 2299 
Overall Loss: -24.095222
Rec Loss: -39.112391
KL Loss: 15.017168
Y Loss: 0.391834
T Loss: 11.489856
X Loss: -50.798163
Epoch 2349 
Overall Loss: -24.080793
Rec Loss: -38.878980
KL Loss: 14.798187
Y Loss: 0.413148
T Loss: 11.507649
X Loss: -50.593205
Epoch 2399 
Overall Loss: -24.102940
Rec Loss: -39.188495
KL Loss: 15.085554
Y Loss: 0.379524
T Loss: 11.475649
X Loss: -50.853903
Epoch 2449 
Overall Loss: -24.148378
Rec Loss: -38.998977
KL Loss: 14.850599
Y Loss: 0.397151
T Loss: 11.503961
X Loss: -50.701513
Epoch 2499 
Overall Loss: -24.516127
Rec Loss: -39.637137
KL Loss: 15.121010
Y Loss: 0.368898
T Loss: 11.460024
X Loss: -51.281610
Epoch 2549 
Overall Loss: -24.292353
Rec Loss: -39.303916
KL Loss: 15.011562
Y Loss: 0.378092
T Loss: 11.469418
X Loss: -50.962380
Epoch 2599 
Overall Loss: -23.872181
Rec Loss: -38.906977
KL Loss: 15.034796
Y Loss: 0.369054
T Loss: 11.454824
X Loss: -50.546329
Epoch 2649 
Overall Loss: -24.772326
Rec Loss: -39.930849
KL Loss: 15.158523
Y Loss: 0.346045
T Loss: 11.437680
X Loss: -51.541552
Epoch 2699 
Overall Loss: -24.591230
Rec Loss: -39.749181
KL Loss: 15.157950
Y Loss: 0.353127
T Loss: 11.440990
X Loss: -51.366734
Epoch 2749 
Overall Loss: -24.585005
Rec Loss: -39.632662
KL Loss: 15.047657
Y Loss: 0.356637
T Loss: 11.420117
X Loss: -51.231097
Epoch 2799 
Overall Loss: -25.178881
Rec Loss: -40.199323
KL Loss: 15.020443
Y Loss: 0.367884
T Loss: 11.446892
X Loss: -51.830156
Epoch 2849 
Overall Loss: -24.733026
Rec Loss: -39.953303
KL Loss: 15.220277
Y Loss: 0.321255
T Loss: 11.409848
X Loss: -51.523779
Epoch 2899 
Overall Loss: -25.395219
Rec Loss: -40.674188
KL Loss: 15.278969
Y Loss: 0.323939
T Loss: 11.387984
X Loss: -52.224141
Epoch 2949 
Overall Loss: -25.441437
Rec Loss: -40.675240
KL Loss: 15.233803
Y Loss: 0.341782
T Loss: 11.383871
X Loss: -52.230000
Epoch 2999 
Overall Loss: -25.391157
Rec Loss: -40.680646
KL Loss: 15.289491
Y Loss: 0.321632
T Loss: 11.372581
X Loss: -52.214044
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.508904
Epoch 99
Rec Loss: 2.490798
Epoch 149
Rec Loss: 2.491386
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.006002
Epoch 99
Rec Loss: 0.004312
Epoch 149
Rec Loss: 0.002530
Epoch 199
Rec Loss: 0.002002
Epoch 249
Rec Loss: 0.002251
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.325469
Insample Error 3.365073
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.624618
Epoch 99 
Prediction Loss: 3.354085
Epoch 149 
Prediction Loss: 3.232518
Epoch 199 
Prediction Loss: 3.160204
Epoch 249 
Prediction Loss: 3.134349
Epoch 299 
Prediction Loss: 3.092148
Epoch 349 
Prediction Loss: 3.056740
Epoch 399 
Prediction Loss: 3.036959
Epoch 449 
Prediction Loss: 3.038941
Epoch 499 
Prediction Loss: 3.015925
Epoch 549 
Prediction Loss: 2.993137
Epoch 599 
Prediction Loss: 2.963721
Epoch 649 
Prediction Loss: 2.959762
Epoch 699 
Prediction Loss: 2.942091
Epoch 749 
Prediction Loss: 2.949542
Epoch 799 
Prediction Loss: 2.896918
Epoch 849 
Prediction Loss: 2.881661
Epoch 899 
Prediction Loss: 2.871791
Epoch 949 
Prediction Loss: 2.868243
Epoch 999 
Prediction Loss: 2.828970
Epoch 1049 
Prediction Loss: 2.838569
Epoch 1099 
Prediction Loss: 2.807411
Epoch 1149 
Prediction Loss: 2.817667
Epoch 1199 
Prediction Loss: 2.758805
Epoch 1249 
Prediction Loss: 2.757877
Epoch 1299 
Prediction Loss: 2.734786
Epoch 1349 
Prediction Loss: 2.726825
Epoch 1399 
Prediction Loss: 2.707900
Epoch 1449 
Prediction Loss: 2.678109
Epoch 1499 
Prediction Loss: 2.679588
Epoch 1549 
Prediction Loss: 2.667082
Epoch 1599 
Prediction Loss: 2.635017
Epoch 1649 
Prediction Loss: 2.634472
Epoch 1699 
Prediction Loss: 2.588577
Epoch 1749 
Prediction Loss: 2.575737
Epoch 1799 
Prediction Loss: 2.566906
Epoch 1849 
Prediction Loss: 2.558718
Epoch 1899 
Prediction Loss: 2.528890
Epoch 1949 
Prediction Loss: 2.535152
Epoch 1999 
Prediction Loss: 2.513744
Epoch 2049 
Prediction Loss: 2.515342
Epoch 2099 
Prediction Loss: 2.497351
Epoch 2149 
Prediction Loss: 2.462976
Epoch 2199 
Prediction Loss: 2.464886
Epoch 2249 
Prediction Loss: 2.434554
Epoch 2299 
Prediction Loss: 2.420365
Epoch 2349 
Prediction Loss: 2.402078
Epoch 2399 
Prediction Loss: 2.385717
Epoch 2449 
Prediction Loss: 2.405838
Epoch 2499 
Prediction Loss: 2.395114
Epoch 2549 
Prediction Loss: 2.356361
Epoch 2599 
Prediction Loss: 2.326554
Epoch 2649 
Prediction Loss: 2.327123
Epoch 2699 
Prediction Loss: 2.324731
Epoch 2749 
Prediction Loss: 2.297009
Epoch 2799 
Prediction Loss: 2.301672
Epoch 2849 
Prediction Loss: 2.283663
Epoch 2899 
Prediction Loss: 2.253619
Epoch 2949 
Prediction Loss: 2.256776
Epoch 2999 
Prediction Loss: 2.237906
Epoch 3049 
Prediction Loss: 2.215018
Epoch 3099 
Prediction Loss: 2.203065
Epoch 3149 
Prediction Loss: 2.238087
Epoch 3199 
Prediction Loss: 2.188467
Epoch 3249 
Prediction Loss: 2.172157
Epoch 3299 
Prediction Loss: 2.159051
Epoch 3349 
Prediction Loss: 2.148788
Epoch 3399 
Prediction Loss: 2.161144
Epoch 3449 
Prediction Loss: 2.122704
Epoch 3499 
Prediction Loss: 2.129271
Epoch 3549 
Prediction Loss: 2.112459
Epoch 3599 
Prediction Loss: 2.120695
Epoch 3649 
Prediction Loss: 2.082278
Epoch 3699 
Prediction Loss: 2.086876
Epoch 3749 
Prediction Loss: 2.076372
Epoch 3799 
Prediction Loss: 2.141827
Epoch 3849 
Prediction Loss: 2.048988
Epoch 3899 
Prediction Loss: 2.030044
Epoch 3949 
Prediction Loss: 2.039901
Epoch 3999 
Prediction Loss: 2.026765
Epoch 4049 
Prediction Loss: 1.999610
Epoch 4099 
Prediction Loss: 2.024878
Epoch 4149 
Prediction Loss: 2.010867
Epoch 4199 
Prediction Loss: 1.984241
Epoch 4249 
Prediction Loss: 1.990744
Epoch 4299 
Prediction Loss: 1.968325
Epoch 4349 
Prediction Loss: 1.964879
Epoch 4399 
Prediction Loss: 1.979074
Epoch 4449 
Prediction Loss: 1.979325
Epoch 4499 
Prediction Loss: 1.949320
Epoch 4549 
Prediction Loss: 1.963933
Epoch 4599 
Prediction Loss: 1.927193
Epoch 4649 
Prediction Loss: 1.925459
Epoch 4699 
Prediction Loss: 1.922806
Epoch 4749 
Prediction Loss: 1.905755
Epoch 4799 
Prediction Loss: 1.901392
Epoch 4849 
Prediction Loss: 1.905941
Epoch 4899 
Prediction Loss: 1.933205
Epoch 4949 
Prediction Loss: 1.898183
Epoch 4999 
Prediction Loss: 1.888143
Epoch 5049 
Prediction Loss: 1.897650
Epoch 5099 
Prediction Loss: 1.876518
Epoch 5149 
Prediction Loss: 1.863790
Epoch 5199 
Prediction Loss: 1.865183
Epoch 5249 
Prediction Loss: 1.853584
Epoch 5299 
Prediction Loss: 1.853358
Epoch 5349 
Prediction Loss: 1.866504
Epoch 5399 
Prediction Loss: 1.845287
Epoch 5449 
Prediction Loss: 1.839203
Epoch 5499 
Prediction Loss: 1.847295
Epoch 5549 
Prediction Loss: 1.827416
Epoch 5599 
Prediction Loss: 1.852165
Epoch 5649 
Prediction Loss: 1.816581
Epoch 5699 
Prediction Loss: 1.815182
Epoch 5749 
Prediction Loss: 1.808457
Epoch 5799 
Prediction Loss: 1.799065
Epoch 5849 
Prediction Loss: 1.790777
Epoch 5899 
Prediction Loss: 1.790397
Epoch 5949 
Prediction Loss: 1.792829
Epoch 5999 
Prediction Loss: 1.778415
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.334854
Insample Error 3.640227
Ours, Train RMSE
0.6619, 
0.6695, 
0.6548, 
0.6692, 
0.6551, 
CEVAE, Train RMSE
0.4148, 
0.3227, 
0.2201, 
0.4200, 
0.3255, 
Ours, Insample RMSE
2.1347, 
2.1912, 
2.3410, 
2.2413, 
2.1694, 
CEVAE, Insample RMSE
3.3203, 
2.9107, 
4.8613, 
3.7411, 
3.3651, 
Direct Regression, Insample RMSE
3.5806, 
3.6233, 
3.5845, 
3.5367, 
3.6402, 
Train, RMSE mean 0.6621 std 0.0065
CEVAE, RMSE mean 0.3406 std 0.0733
Ours, RMSE mean 2.2155 std 0.0717, reconstruct confounder 1.0838 (0.0044) noise 10.1801 (0.0065)
CEVAE, RMSE mean 3.6397 std 0.6650, reconstruct confounder 2.3897 (0.1301) noise 0.0016 (0.0003)
Direct Regression, RMSE mean 3.5931 std 0.0362
