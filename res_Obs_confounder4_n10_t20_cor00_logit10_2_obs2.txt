Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=4, mask=0, nlayer=50, obsm=2, stop=2000, ycof=0.5, ylayer=50)
Y Mean 0.467551, Std 3.004609 
Test Y Mean 0.015136, Std 2.801871 
Observe confounder 2, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.062685
Rec Loss: 10.053762
KL Loss: 2.008923
Y Loss: 1.030205
T Loss: 9.538659
Epoch 99 
Overall Loss: 11.644995
Rec Loss: 10.196063
KL Loss: 1.448932
Y Loss: 1.033024
T Loss: 9.679551
Epoch 149 
Overall Loss: 11.594358
Rec Loss: 10.125352
KL Loss: 1.469006
Y Loss: 0.970586
T Loss: 9.640059
Epoch 199 
Overall Loss: 11.548046
Rec Loss: 10.055050
KL Loss: 1.492996
Y Loss: 0.927174
T Loss: 9.591463
Epoch 249 
Overall Loss: 11.532057
Rec Loss: 10.064022
KL Loss: 1.468036
Y Loss: 0.902047
T Loss: 9.612998
Epoch 299 
Overall Loss: 11.515880
Rec Loss: 10.058756
KL Loss: 1.457124
Y Loss: 0.870168
T Loss: 9.623673
Epoch 349 
Overall Loss: 11.504393
Rec Loss: 10.018138
KL Loss: 1.486255
Y Loss: 0.855860
T Loss: 9.590208
Epoch 399 
Overall Loss: 11.473125
Rec Loss: 9.982397
KL Loss: 1.490728
Y Loss: 0.829869
T Loss: 9.567462
Epoch 449 
Overall Loss: 11.470766
Rec Loss: 9.996615
KL Loss: 1.474151
Y Loss: 0.831958
T Loss: 9.580636
Epoch 499 
Overall Loss: 11.443850
Rec Loss: 9.977708
KL Loss: 1.466142
Y Loss: 0.814429
T Loss: 9.570494
Epoch 549 
Overall Loss: 11.458174
Rec Loss: 9.962963
KL Loss: 1.495211
Y Loss: 0.802995
T Loss: 9.561465
Epoch 599 
Overall Loss: 11.456903
Rec Loss: 9.955472
KL Loss: 1.501431
Y Loss: 0.779714
T Loss: 9.565615
Epoch 649 
Overall Loss: 11.440621
Rec Loss: 9.937827
KL Loss: 1.502793
Y Loss: 0.774741
T Loss: 9.550457
Epoch 699 
Overall Loss: 11.450467
Rec Loss: 9.955655
KL Loss: 1.494812
Y Loss: 0.770149
T Loss: 9.570581
Epoch 749 
Overall Loss: 11.431078
Rec Loss: 9.929670
KL Loss: 1.501408
Y Loss: 0.773803
T Loss: 9.542769
Epoch 799 
Overall Loss: 11.450961
Rec Loss: 9.934555
KL Loss: 1.516406
Y Loss: 0.768056
T Loss: 9.550527
Epoch 849 
Overall Loss: 11.422170
Rec Loss: 9.926140
KL Loss: 1.496030
Y Loss: 0.753275
T Loss: 9.549503
Epoch 899 
Overall Loss: 11.421340
Rec Loss: 9.912820
KL Loss: 1.508520
Y Loss: 0.752416
T Loss: 9.536612
Epoch 949 
Overall Loss: 11.411188
Rec Loss: 9.901452
KL Loss: 1.509736
Y Loss: 0.736340
T Loss: 9.533282
Epoch 999 
Overall Loss: 11.412174
Rec Loss: 9.911283
KL Loss: 1.500890
Y Loss: 0.744803
T Loss: 9.538882
Epoch 1049 
Overall Loss: 11.423328
Rec Loss: 9.912268
KL Loss: 1.511060
Y Loss: 0.736428
T Loss: 9.544054
Epoch 1099 
Overall Loss: 11.427207
Rec Loss: 9.910766
KL Loss: 1.516440
Y Loss: 0.746168
T Loss: 9.537683
Epoch 1149 
Overall Loss: 11.399115
Rec Loss: 9.882978
KL Loss: 1.516138
Y Loss: 0.725271
T Loss: 9.520342
Epoch 1199 
Overall Loss: 11.401346
Rec Loss: 9.893583
KL Loss: 1.507763
Y Loss: 0.725247
T Loss: 9.530959
Epoch 1249 
Overall Loss: 11.411234
Rec Loss: 9.886355
KL Loss: 1.524878
Y Loss: 0.719037
T Loss: 9.526837
Epoch 1299 
Overall Loss: 11.385332
Rec Loss: 9.857029
KL Loss: 1.528303
Y Loss: 0.720744
T Loss: 9.496657
Epoch 1349 
Overall Loss: 11.386024
Rec Loss: 9.885879
KL Loss: 1.500145
Y Loss: 0.709023
T Loss: 9.531367
Epoch 1399 
Overall Loss: 11.404990
Rec Loss: 9.884766
KL Loss: 1.520224
Y Loss: 0.720510
T Loss: 9.524511
Epoch 1449 
Overall Loss: 11.394355
Rec Loss: 9.849258
KL Loss: 1.545097
Y Loss: 0.708275
T Loss: 9.495120
Epoch 1499 
Overall Loss: 11.389700
Rec Loss: 9.852534
KL Loss: 1.537167
Y Loss: 0.702685
T Loss: 9.501191
Epoch 1549 
Overall Loss: 11.376662
Rec Loss: 9.848864
KL Loss: 1.527798
Y Loss: 0.697706
T Loss: 9.500011
Epoch 1599 
Overall Loss: 11.391651
Rec Loss: 9.859888
KL Loss: 1.531763
Y Loss: 0.715629
T Loss: 9.502074
Epoch 1649 
Overall Loss: 11.370632
Rec Loss: 9.834315
KL Loss: 1.536317
Y Loss: 0.692570
T Loss: 9.488031
Epoch 1699 
Overall Loss: 11.377840
Rec Loss: 9.838204
KL Loss: 1.539636
Y Loss: 0.684616
T Loss: 9.495896
Epoch 1749 
Overall Loss: 11.391680
Rec Loss: 9.870743
KL Loss: 1.520937
Y Loss: 0.688563
T Loss: 9.526461
Epoch 1799 
Overall Loss: 11.373398
Rec Loss: 9.834433
KL Loss: 1.538965
Y Loss: 0.680324
T Loss: 9.494271
Epoch 1849 
Overall Loss: 11.360406
Rec Loss: 9.844633
KL Loss: 1.515773
Y Loss: 0.681619
T Loss: 9.503823
Epoch 1899 
Overall Loss: 11.377868
Rec Loss: 9.846620
KL Loss: 1.531248
Y Loss: 0.701164
T Loss: 9.496038
Epoch 1949 
Overall Loss: 11.364647
Rec Loss: 9.833332
KL Loss: 1.531315
Y Loss: 0.682108
T Loss: 9.492278
Epoch 1999 
Overall Loss: 11.363431
Rec Loss: 9.825604
KL Loss: 1.537826
Y Loss: 0.671677
T Loss: 9.489766
Epoch 2049 
Overall Loss: 11.372389
Rec Loss: 9.853585
KL Loss: 1.518803
Y Loss: 0.681459
T Loss: 9.512856
Epoch 2099 
Overall Loss: 11.349739
Rec Loss: 9.820211
KL Loss: 1.529529
Y Loss: 0.670867
T Loss: 9.484777
Epoch 2149 
Overall Loss: 11.343895
Rec Loss: 9.822999
KL Loss: 1.520896
Y Loss: 0.681704
T Loss: 9.482147
Epoch 2199 
Overall Loss: 11.359575
Rec Loss: 9.816484
KL Loss: 1.543091
Y Loss: 0.689836
T Loss: 9.471566
Epoch 2249 
Overall Loss: 11.351192
Rec Loss: 9.811332
KL Loss: 1.539859
Y Loss: 0.671163
T Loss: 9.475751
Epoch 2299 
Overall Loss: 11.332497
Rec Loss: 9.806034
KL Loss: 1.526463
Y Loss: 0.669866
T Loss: 9.471101
Epoch 2349 
Overall Loss: 11.340774
Rec Loss: 9.805555
KL Loss: 1.535219
Y Loss: 0.678098
T Loss: 9.466506
Epoch 2399 
Overall Loss: 11.343633
Rec Loss: 9.807122
KL Loss: 1.536511
Y Loss: 0.662180
T Loss: 9.476032
Epoch 2449 
Overall Loss: 11.332113
Rec Loss: 9.796576
KL Loss: 1.535536
Y Loss: 0.655722
T Loss: 9.468715
Epoch 2499 
Overall Loss: 11.339417
Rec Loss: 9.822945
KL Loss: 1.516472
Y Loss: 0.654606
T Loss: 9.495642
Epoch 2549 
Overall Loss: 11.339233
Rec Loss: 9.803217
KL Loss: 1.536016
Y Loss: 0.657390
T Loss: 9.474522
Epoch 2599 
Overall Loss: 11.345127
Rec Loss: 9.804296
KL Loss: 1.540832
Y Loss: 0.655471
T Loss: 9.476560
Epoch 2649 
Overall Loss: 11.346884
Rec Loss: 9.810263
KL Loss: 1.536620
Y Loss: 0.652493
T Loss: 9.484017
Epoch 2699 
Overall Loss: 11.342374
Rec Loss: 9.792568
KL Loss: 1.549806
Y Loss: 0.653814
T Loss: 9.465660
Epoch 2749 
Overall Loss: 11.344892
Rec Loss: 9.798898
KL Loss: 1.545994
Y Loss: 0.644208
T Loss: 9.476794
Epoch 2799 
Overall Loss: 11.328789
Rec Loss: 9.777893
KL Loss: 1.550896
Y Loss: 0.649839
T Loss: 9.452973
Epoch 2849 
Overall Loss: 11.338676
Rec Loss: 9.796823
KL Loss: 1.541853
Y Loss: 0.648666
T Loss: 9.472490
Epoch 2899 
Overall Loss: 11.339738
Rec Loss: 9.793192
KL Loss: 1.546545
Y Loss: 0.641454
T Loss: 9.472465
Epoch 2949 
Overall Loss: 11.337093
Rec Loss: 9.816370
KL Loss: 1.520723
Y Loss: 0.653682
T Loss: 9.489529
Epoch 2999 
Overall Loss: 11.312756
Rec Loss: 9.799370
KL Loss: 1.513386
Y Loss: 0.642434
T Loss: 9.478152
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.789022
Epoch 99
Rec Loss: 0.796011
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.743195
Epoch 99
Rec Loss: 9.738038
Epoch 149
Rec Loss: 9.736983
Epoch 199
Rec Loss: 9.722278
Epoch 249
Rec Loss: 9.734890
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.729270
Insample Error: 1.892849
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.047083
Epoch 99
Rec Loss: 4.050082
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 8.914257
Epoch 99
Rec Loss: 8.974143
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.971616
Insample Error 2.797542
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.449075
Epoch 99 
Prediction Loss: 1.110335
Epoch 149 
Prediction Loss: 1.038762
Epoch 199 
Prediction Loss: 1.011102
Epoch 249 
Prediction Loss: 0.998454
Epoch 299 
Prediction Loss: 0.982583
Epoch 349 
Prediction Loss: 0.978223
Epoch 399 
Prediction Loss: 0.964120
Epoch 449 
Prediction Loss: 0.960030
Epoch 499 
Prediction Loss: 0.952086
Epoch 549 
Prediction Loss: 0.950249
Epoch 599 
Prediction Loss: 0.947150
Epoch 649 
Prediction Loss: 0.934105
Epoch 699 
Prediction Loss: 0.938635
Epoch 749 
Prediction Loss: 0.931873
Epoch 799 
Prediction Loss: 0.923549
Epoch 849 
Prediction Loss: 0.914413
Epoch 899 
Prediction Loss: 0.915647
Epoch 949 
Prediction Loss: 0.910014
Epoch 999 
Prediction Loss: 0.896599
Epoch 1049 
Prediction Loss: 0.903931
Epoch 1099 
Prediction Loss: 0.899690
Epoch 1149 
Prediction Loss: 0.888670
Epoch 1199 
Prediction Loss: 0.898161
Epoch 1249 
Prediction Loss: 0.877222
Epoch 1299 
Prediction Loss: 0.870707
Epoch 1349 
Prediction Loss: 0.864502
Epoch 1399 
Prediction Loss: 0.873052
Epoch 1449 
Prediction Loss: 0.865429
Epoch 1499 
Prediction Loss: 0.863991
Epoch 1549 
Prediction Loss: 0.854444
Epoch 1599 
Prediction Loss: 0.859849
Epoch 1649 
Prediction Loss: 0.847394
Epoch 1699 
Prediction Loss: 0.845685
Epoch 1749 
Prediction Loss: 0.839805
Epoch 1799 
Prediction Loss: 0.833522
Epoch 1849 
Prediction Loss: 0.835563
Epoch 1899 
Prediction Loss: 0.840404
Epoch 1949 
Prediction Loss: 0.823378
Epoch 1999 
Prediction Loss: 0.836833
Epoch 2049 
Prediction Loss: 0.818541
Epoch 2099 
Prediction Loss: 0.821391
Epoch 2149 
Prediction Loss: 0.815059
Epoch 2199 
Prediction Loss: 0.820910
Epoch 2249 
Prediction Loss: 0.799157
Epoch 2299 
Prediction Loss: 0.811063
Epoch 2349 
Prediction Loss: 0.807487
Epoch 2399 
Prediction Loss: 0.810941
Epoch 2449 
Prediction Loss: 0.789861
Epoch 2499 
Prediction Loss: 0.785023
Epoch 2549 
Prediction Loss: 0.782637
Epoch 2599 
Prediction Loss: 0.781467
Epoch 2649 
Prediction Loss: 0.785526
Epoch 2699 
Prediction Loss: 0.776190
Epoch 2749 
Prediction Loss: 0.777955
Epoch 2799 
Prediction Loss: 0.772381
Epoch 2849 
Prediction Loss: 0.778200
Epoch 2899 
Prediction Loss: 0.763884
Epoch 2949 
Prediction Loss: 0.753390
Epoch 2999 
Prediction Loss: 0.752899
Epoch 3049 
Prediction Loss: 0.753441
Epoch 3099 
Prediction Loss: 0.751034
Epoch 3149 
Prediction Loss: 0.741087
Epoch 3199 
Prediction Loss: 0.756955
Epoch 3249 
Prediction Loss: 0.740629
Epoch 3299 
Prediction Loss: 0.730079
Epoch 3349 
Prediction Loss: 0.728991
Epoch 3399 
Prediction Loss: 0.734194
Epoch 3449 
Prediction Loss: 0.731794
Epoch 3499 
Prediction Loss: 0.722754
Epoch 3549 
Prediction Loss: 0.727496
Epoch 3599 
Prediction Loss: 0.717778
Epoch 3649 
Prediction Loss: 0.717846
Epoch 3699 
Prediction Loss: 0.736467
Epoch 3749 
Prediction Loss: 0.717167
Epoch 3799 
Prediction Loss: 0.708744
Epoch 3849 
Prediction Loss: 0.722233
Epoch 3899 
Prediction Loss: 0.701720
Epoch 3949 
Prediction Loss: 0.711234
Epoch 3999 
Prediction Loss: 0.713078
Epoch 4049 
Prediction Loss: 0.689313
Epoch 4099 
Prediction Loss: 0.689309
Epoch 4149 
Prediction Loss: 0.701412
Epoch 4199 
Prediction Loss: 0.683318
Epoch 4249 
Prediction Loss: 0.692348
Epoch 4299 
Prediction Loss: 0.682820
Epoch 4349 
Prediction Loss: 0.676273
Epoch 4399 
Prediction Loss: 0.678764
Epoch 4449 
Prediction Loss: 0.666806
Epoch 4499 
Prediction Loss: 0.670765
Epoch 4549 
Prediction Loss: 0.662959
Epoch 4599 
Prediction Loss: 0.671375
Epoch 4649 
Prediction Loss: 0.670546
Epoch 4699 
Prediction Loss: 0.660419
Epoch 4749 
Prediction Loss: 0.655535
Epoch 4799 
Prediction Loss: 0.654545
Epoch 4849 
Prediction Loss: 0.655174
Epoch 4899 
Prediction Loss: 0.653862
Epoch 4949 
Prediction Loss: 0.647520
Epoch 4999 
Prediction Loss: 0.668154
Epoch 5049 
Prediction Loss: 0.651864
Epoch 5099 
Prediction Loss: 0.645807
Epoch 5149 
Prediction Loss: 0.645191
Epoch 5199 
Prediction Loss: 0.639362
Epoch 5249 
Prediction Loss: 0.644466
Epoch 5299 
Prediction Loss: 0.636206
Epoch 5349 
Prediction Loss: 0.642919
Epoch 5399 
Prediction Loss: 0.640445
Epoch 5449 
Prediction Loss: 0.624565
Epoch 5499 
Prediction Loss: 0.630360
Epoch 5549 
Prediction Loss: 0.628906
Epoch 5599 
Prediction Loss: 0.626191
Epoch 5649 
Prediction Loss: 0.618821
Epoch 5699 
Prediction Loss: 0.615209
Epoch 5749 
Prediction Loss: 0.623739
Epoch 5799 
Prediction Loss: 0.612265
Epoch 5849 
Prediction Loss: 0.614460
Epoch 5899 
Prediction Loss: 0.604433
Epoch 5949 
Prediction Loss: 0.614764
Epoch 5999 
Prediction Loss: 0.602659
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.777413
Insample Error 2.290812
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.396365
Rec Loss: 10.663504
KL Loss: 1.732861
Y Loss: 0.968703
T Loss: 10.179153
Epoch 99 
Overall Loss: 11.673437
Rec Loss: 10.204035
KL Loss: 1.469402
Y Loss: 1.056413
T Loss: 9.675829
Epoch 149 
Overall Loss: 11.560996
Rec Loss: 10.085731
KL Loss: 1.475265
Y Loss: 0.951741
T Loss: 9.609860
Epoch 199 
Overall Loss: 11.546453
Rec Loss: 10.076680
KL Loss: 1.469773
Y Loss: 0.908430
T Loss: 9.622465
Epoch 249 
Overall Loss: 11.500966
Rec Loss: 10.063119
KL Loss: 1.437847
Y Loss: 0.879559
T Loss: 9.623339
Epoch 299 
Overall Loss: 11.474605
Rec Loss: 10.010248
KL Loss: 1.464356
Y Loss: 0.849308
T Loss: 9.585594
Epoch 349 
Overall Loss: 11.478704
Rec Loss: 9.999136
KL Loss: 1.479568
Y Loss: 0.839076
T Loss: 9.579598
Epoch 399 
Overall Loss: 11.461014
Rec Loss: 9.975852
KL Loss: 1.485161
Y Loss: 0.814549
T Loss: 9.568577
Epoch 449 
Overall Loss: 11.456994
Rec Loss: 9.956087
KL Loss: 1.500908
Y Loss: 0.800401
T Loss: 9.555886
Epoch 499 
Overall Loss: 11.454720
Rec Loss: 9.952638
KL Loss: 1.502082
Y Loss: 0.772870
T Loss: 9.566203
Epoch 549 
Overall Loss: 11.447814
Rec Loss: 9.950185
KL Loss: 1.497629
Y Loss: 0.777138
T Loss: 9.561616
Epoch 599 
Overall Loss: 11.444131
Rec Loss: 9.908301
KL Loss: 1.535830
Y Loss: 0.764676
T Loss: 9.525963
Epoch 649 
Overall Loss: 11.428222
Rec Loss: 9.943181
KL Loss: 1.485040
Y Loss: 0.753880
T Loss: 9.566241
Epoch 699 
Overall Loss: 11.418952
Rec Loss: 9.910034
KL Loss: 1.508918
Y Loss: 0.736782
T Loss: 9.541643
Epoch 749 
Overall Loss: 11.435354
Rec Loss: 9.901475
KL Loss: 1.533879
Y Loss: 0.740487
T Loss: 9.531231
Epoch 799 
Overall Loss: 11.407141
Rec Loss: 9.908494
KL Loss: 1.498647
Y Loss: 0.733363
T Loss: 9.541813
Epoch 849 
Overall Loss: 11.417333
Rec Loss: 9.888718
KL Loss: 1.528614
Y Loss: 0.724938
T Loss: 9.526250
Epoch 899 
Overall Loss: 11.401026
Rec Loss: 9.850715
KL Loss: 1.550311
Y Loss: 0.708763
T Loss: 9.496334
Epoch 949 
Overall Loss: 11.386934
Rec Loss: 9.869445
KL Loss: 1.517489
Y Loss: 0.708005
T Loss: 9.515443
Epoch 999 
Overall Loss: 11.387249
Rec Loss: 9.875385
KL Loss: 1.511865
Y Loss: 0.705342
T Loss: 9.522714
Epoch 1049 
Overall Loss: 11.391916
Rec Loss: 9.866572
KL Loss: 1.525344
Y Loss: 0.700110
T Loss: 9.516517
Epoch 1099 
Overall Loss: 11.378107
Rec Loss: 9.866924
KL Loss: 1.511183
Y Loss: 0.695224
T Loss: 9.519312
Epoch 1149 
Overall Loss: 11.400738
Rec Loss: 9.866586
KL Loss: 1.534152
Y Loss: 0.695125
T Loss: 9.519024
Epoch 1199 
Overall Loss: 11.384683
Rec Loss: 9.852204
KL Loss: 1.532479
Y Loss: 0.687518
T Loss: 9.508445
Epoch 1249 
Overall Loss: 11.385976
Rec Loss: 9.841033
KL Loss: 1.544943
Y Loss: 0.689517
T Loss: 9.496274
Epoch 1299 
Overall Loss: 11.384989
Rec Loss: 9.835744
KL Loss: 1.549245
Y Loss: 0.685699
T Loss: 9.492895
Epoch 1349 
Overall Loss: 11.388110
Rec Loss: 9.835481
KL Loss: 1.552629
Y Loss: 0.681986
T Loss: 9.494488
Epoch 1399 
Overall Loss: 11.377374
Rec Loss: 9.854655
KL Loss: 1.522719
Y Loss: 0.674885
T Loss: 9.517213
Epoch 1449 
Overall Loss: 11.377776
Rec Loss: 9.836616
KL Loss: 1.541160
Y Loss: 0.669832
T Loss: 9.501700
Epoch 1499 
Overall Loss: 11.377678
Rec Loss: 9.842699
KL Loss: 1.534979
Y Loss: 0.676764
T Loss: 9.504317
Epoch 1549 
Overall Loss: 11.369599
Rec Loss: 9.835832
KL Loss: 1.533767
Y Loss: 0.674712
T Loss: 9.498476
Epoch 1599 
Overall Loss: 11.360621
Rec Loss: 9.813318
KL Loss: 1.547302
Y Loss: 0.666219
T Loss: 9.480208
Epoch 1649 
Overall Loss: 11.341404
Rec Loss: 9.795635
KL Loss: 1.545770
Y Loss: 0.659088
T Loss: 9.466091
Epoch 1699 
Overall Loss: 11.378828
Rec Loss: 9.812035
KL Loss: 1.566794
Y Loss: 0.654370
T Loss: 9.484849
Epoch 1749 
Overall Loss: 11.340981
Rec Loss: 9.794224
KL Loss: 1.546758
Y Loss: 0.655131
T Loss: 9.466659
Epoch 1799 
Overall Loss: 11.339440
Rec Loss: 9.786188
KL Loss: 1.553252
Y Loss: 0.655954
T Loss: 9.458212
Epoch 1849 
Overall Loss: 11.333721
Rec Loss: 9.792431
KL Loss: 1.541290
Y Loss: 0.648562
T Loss: 9.468150
Epoch 1899 
Overall Loss: 11.327818
Rec Loss: 9.806399
KL Loss: 1.521419
Y Loss: 0.645478
T Loss: 9.483660
Epoch 1949 
Overall Loss: 11.338053
Rec Loss: 9.803190
KL Loss: 1.534864
Y Loss: 0.650368
T Loss: 9.478005
Epoch 1999 
Overall Loss: 11.350732
Rec Loss: 9.822382
KL Loss: 1.528350
Y Loss: 0.628191
T Loss: 9.508286
Epoch 2049 
Overall Loss: 11.323433
Rec Loss: 9.822965
KL Loss: 1.500468
Y Loss: 0.639697
T Loss: 9.503116
Epoch 2099 
Overall Loss: 11.330926
Rec Loss: 9.810198
KL Loss: 1.520728
Y Loss: 0.638474
T Loss: 9.490961
Epoch 2149 
Overall Loss: 11.352120
Rec Loss: 9.796872
KL Loss: 1.555248
Y Loss: 0.656089
T Loss: 9.468827
Epoch 2199 
Overall Loss: 11.318614
Rec Loss: 9.789277
KL Loss: 1.529337
Y Loss: 0.632841
T Loss: 9.472857
Epoch 2249 
Overall Loss: 11.334163
Rec Loss: 9.791794
KL Loss: 1.542369
Y Loss: 0.641956
T Loss: 9.470816
Epoch 2299 
Overall Loss: 11.333273
Rec Loss: 9.789819
KL Loss: 1.543454
Y Loss: 0.632441
T Loss: 9.473598
Epoch 2349 
Overall Loss: 11.328222
Rec Loss: 9.796895
KL Loss: 1.531327
Y Loss: 0.635323
T Loss: 9.479233
Epoch 2399 
Overall Loss: 11.337766
Rec Loss: 9.783318
KL Loss: 1.554448
Y Loss: 0.630616
T Loss: 9.468010
Epoch 2449 
Overall Loss: 11.346243
Rec Loss: 9.766286
KL Loss: 1.579956
Y Loss: 0.621543
T Loss: 9.455515
Epoch 2499 
Overall Loss: 11.318805
Rec Loss: 9.770512
KL Loss: 1.548293
Y Loss: 0.635699
T Loss: 9.452662
Epoch 2549 
Overall Loss: 11.319780
Rec Loss: 9.777503
KL Loss: 1.542277
Y Loss: 0.625772
T Loss: 9.464617
Epoch 2599 
Overall Loss: 11.312773
Rec Loss: 9.772925
KL Loss: 1.539848
Y Loss: 0.617322
T Loss: 9.464265
Epoch 2649 
Overall Loss: 11.314330
Rec Loss: 9.772802
KL Loss: 1.541528
Y Loss: 0.624770
T Loss: 9.460417
Epoch 2699 
Overall Loss: 11.313454
Rec Loss: 9.773277
KL Loss: 1.540177
Y Loss: 0.625719
T Loss: 9.460418
Epoch 2749 
Overall Loss: 11.318881
Rec Loss: 9.772292
KL Loss: 1.546589
Y Loss: 0.618852
T Loss: 9.462866
Epoch 2799 
Overall Loss: 11.307772
Rec Loss: 9.739151
KL Loss: 1.568621
Y Loss: 0.617418
T Loss: 9.430442
Epoch 2849 
Overall Loss: 11.298815
Rec Loss: 9.779690
KL Loss: 1.519125
Y Loss: 0.623274
T Loss: 9.468053
Epoch 2899 
Overall Loss: 11.286369
Rec Loss: 9.766492
KL Loss: 1.519877
Y Loss: 0.617303
T Loss: 9.457840
Epoch 2949 
Overall Loss: 11.298920
Rec Loss: 9.747853
KL Loss: 1.551066
Y Loss: 0.611482
T Loss: 9.442113
Epoch 2999 
Overall Loss: 11.298237
Rec Loss: 9.777531
KL Loss: 1.520706
Y Loss: 0.614269
T Loss: 9.470396
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.805064
Epoch 99
Rec Loss: 0.801211
Epoch 149
Rec Loss: 0.803159
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.737141
Epoch 99
Rec Loss: 9.733129
Epoch 149
Rec Loss: 9.721659
Epoch 199
Rec Loss: 9.721887
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.718977
Insample Error: 2.005994
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.070395
Epoch 99
Rec Loss: 4.073064
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.501936
Epoch 99
Rec Loss: 9.452107
Epoch 149
Rec Loss: 9.547829
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.976138
Insample Error 2.809955
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.508389
Epoch 99 
Prediction Loss: 1.148816
Epoch 149 
Prediction Loss: 1.062338
Epoch 199 
Prediction Loss: 1.021363
Epoch 249 
Prediction Loss: 0.996295
Epoch 299 
Prediction Loss: 0.993987
Epoch 349 
Prediction Loss: 0.973461
Epoch 399 
Prediction Loss: 0.962069
Epoch 449 
Prediction Loss: 0.958287
Epoch 499 
Prediction Loss: 0.940895
Epoch 549 
Prediction Loss: 0.944082
Epoch 599 
Prediction Loss: 0.930063
Epoch 649 
Prediction Loss: 0.923614
Epoch 699 
Prediction Loss: 0.924377
Epoch 749 
Prediction Loss: 0.944075
Epoch 799 
Prediction Loss: 0.922012
Epoch 849 
Prediction Loss: 0.901275
Epoch 899 
Prediction Loss: 0.891593
Epoch 949 
Prediction Loss: 0.895313
Epoch 999 
Prediction Loss: 0.885245
Epoch 1049 
Prediction Loss: 0.889310
Epoch 1099 
Prediction Loss: 0.878132
Epoch 1149 
Prediction Loss: 0.870227
Epoch 1199 
Prediction Loss: 0.894375
Epoch 1249 
Prediction Loss: 0.868342
Epoch 1299 
Prediction Loss: 0.870432
Epoch 1349 
Prediction Loss: 0.861992
Epoch 1399 
Prediction Loss: 0.856387
Epoch 1449 
Prediction Loss: 0.885232
Epoch 1499 
Prediction Loss: 0.847134
Epoch 1549 
Prediction Loss: 0.847469
Epoch 1599 
Prediction Loss: 0.843400
Epoch 1649 
Prediction Loss: 0.845449
Epoch 1699 
Prediction Loss: 0.833003
Epoch 1749 
Prediction Loss: 0.828465
Epoch 1799 
Prediction Loss: 0.831164
Epoch 1849 
Prediction Loss: 0.826051
Epoch 1899 
Prediction Loss: 0.829439
Epoch 1949 
Prediction Loss: 0.815441
Epoch 1999 
Prediction Loss: 0.818125
Epoch 2049 
Prediction Loss: 0.823602
Epoch 2099 
Prediction Loss: 0.817462
Epoch 2149 
Prediction Loss: 0.841236
Epoch 2199 
Prediction Loss: 0.802681
Epoch 2249 
Prediction Loss: 0.797192
Epoch 2299 
Prediction Loss: 0.806688
Epoch 2349 
Prediction Loss: 0.800585
Epoch 2399 
Prediction Loss: 0.797784
Epoch 2449 
Prediction Loss: 0.791648
Epoch 2499 
Prediction Loss: 0.784843
Epoch 2549 
Prediction Loss: 0.780962
Epoch 2599 
Prediction Loss: 0.777013
Epoch 2649 
Prediction Loss: 0.772737
Epoch 2699 
Prediction Loss: 0.773168
Epoch 2749 
Prediction Loss: 0.773632
Epoch 2799 
Prediction Loss: 0.773581
Epoch 2849 
Prediction Loss: 0.764983
Epoch 2899 
Prediction Loss: 0.760546
Epoch 2949 
Prediction Loss: 0.766754
Epoch 2999 
Prediction Loss: 0.753892
Epoch 3049 
Prediction Loss: 0.752357
Epoch 3099 
Prediction Loss: 0.751653
Epoch 3149 
Prediction Loss: 0.746615
Epoch 3199 
Prediction Loss: 0.742417
Epoch 3249 
Prediction Loss: 0.739423
Epoch 3299 
Prediction Loss: 0.735689
Epoch 3349 
Prediction Loss: 0.734581
Epoch 3399 
Prediction Loss: 0.738223
Epoch 3449 
Prediction Loss: 0.729888
Epoch 3499 
Prediction Loss: 0.721681
Epoch 3549 
Prediction Loss: 0.728943
Epoch 3599 
Prediction Loss: 0.720165
Epoch 3649 
Prediction Loss: 0.715616
Epoch 3699 
Prediction Loss: 0.723961
Epoch 3749 
Prediction Loss: 0.718763
Epoch 3799 
Prediction Loss: 0.720077
Epoch 3849 
Prediction Loss: 0.710786
Epoch 3899 
Prediction Loss: 0.708786
Epoch 3949 
Prediction Loss: 0.715342
Epoch 3999 
Prediction Loss: 0.696730
Epoch 4049 
Prediction Loss: 0.701489
Epoch 4099 
Prediction Loss: 0.700142
Epoch 4149 
Prediction Loss: 0.710205
Epoch 4199 
Prediction Loss: 0.700228
Epoch 4249 
Prediction Loss: 0.692126
Epoch 4299 
Prediction Loss: 0.696774
Epoch 4349 
Prediction Loss: 0.680650
Epoch 4399 
Prediction Loss: 0.678862
Epoch 4449 
Prediction Loss: 0.676358
Epoch 4499 
Prediction Loss: 0.677408
Epoch 4549 
Prediction Loss: 0.679284
Epoch 4599 
Prediction Loss: 0.682209
Epoch 4649 
Prediction Loss: 0.671183
Epoch 4699 
Prediction Loss: 0.673556
Epoch 4749 
Prediction Loss: 0.661660
Epoch 4799 
Prediction Loss: 0.669505
Epoch 4849 
Prediction Loss: 0.675672
Epoch 4899 
Prediction Loss: 0.663103
Epoch 4949 
Prediction Loss: 0.653775
Epoch 4999 
Prediction Loss: 0.656215
Epoch 5049 
Prediction Loss: 0.656838
Epoch 5099 
Prediction Loss: 0.670294
Epoch 5149 
Prediction Loss: 0.654531
Epoch 5199 
Prediction Loss: 0.649619
Epoch 5249 
Prediction Loss: 0.648473
Epoch 5299 
Prediction Loss: 0.643830
Epoch 5349 
Prediction Loss: 0.643291
Epoch 5399 
Prediction Loss: 0.639099
Epoch 5449 
Prediction Loss: 0.633413
Epoch 5499 
Prediction Loss: 0.636907
Epoch 5549 
Prediction Loss: 0.634456
Epoch 5599 
Prediction Loss: 0.627883
Epoch 5649 
Prediction Loss: 0.631166
Epoch 5699 
Prediction Loss: 0.625908
Epoch 5749 
Prediction Loss: 0.635070
Epoch 5799 
Prediction Loss: 0.625903
Epoch 5849 
Prediction Loss: 0.616445
Epoch 5899 
Prediction Loss: 0.617507
Epoch 5949 
Prediction Loss: 0.611995
Epoch 5999 
Prediction Loss: 0.626026
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.786797
Insample Error 2.281875
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.108853
Rec Loss: 10.043002
KL Loss: 2.065850
Y Loss: 1.043584
T Loss: 9.521211
Epoch 99 
Overall Loss: 11.691387
Rec Loss: 10.188941
KL Loss: 1.502446
Y Loss: 1.063805
T Loss: 9.657038
Epoch 149 
Overall Loss: 11.594445
Rec Loss: 10.132418
KL Loss: 1.462027
Y Loss: 0.984192
T Loss: 9.640322
Epoch 199 
Overall Loss: 11.554764
Rec Loss: 10.077920
KL Loss: 1.476844
Y Loss: 0.927324
T Loss: 9.614258
Epoch 249 
Overall Loss: 11.513539
Rec Loss: 10.040583
KL Loss: 1.472956
Y Loss: 0.886064
T Loss: 9.597551
Epoch 299 
Overall Loss: 11.498254
Rec Loss: 10.011522
KL Loss: 1.486732
Y Loss: 0.864289
T Loss: 9.579378
Epoch 349 
Overall Loss: 11.493091
Rec Loss: 10.004900
KL Loss: 1.488190
Y Loss: 0.837351
T Loss: 9.586225
Epoch 399 
Overall Loss: 11.474207
Rec Loss: 9.987889
KL Loss: 1.486318
Y Loss: 0.821328
T Loss: 9.577225
Epoch 449 
Overall Loss: 11.464145
Rec Loss: 9.969057
KL Loss: 1.495087
Y Loss: 0.804121
T Loss: 9.566997
Epoch 499 
Overall Loss: 11.493702
Rec Loss: 9.985853
KL Loss: 1.507849
Y Loss: 0.816407
T Loss: 9.577649
Epoch 549 
Overall Loss: 11.476054
Rec Loss: 9.981227
KL Loss: 1.494827
Y Loss: 0.782258
T Loss: 9.590098
Epoch 599 
Overall Loss: 11.445415
Rec Loss: 9.946463
KL Loss: 1.498953
Y Loss: 0.788002
T Loss: 9.552462
Epoch 649 
Overall Loss: 11.461476
Rec Loss: 9.968380
KL Loss: 1.493096
Y Loss: 0.778999
T Loss: 9.578880
Epoch 699 
Overall Loss: 11.441210
Rec Loss: 9.937492
KL Loss: 1.503718
Y Loss: 0.758316
T Loss: 9.558334
Epoch 749 
Overall Loss: 11.462206
Rec Loss: 9.938607
KL Loss: 1.523599
Y Loss: 0.758207
T Loss: 9.559503
Epoch 799 
Overall Loss: 11.423804
Rec Loss: 9.922357
KL Loss: 1.501447
Y Loss: 0.755288
T Loss: 9.544713
Epoch 849 
Overall Loss: 11.417797
Rec Loss: 9.908102
KL Loss: 1.509695
Y Loss: 0.745004
T Loss: 9.535599
Epoch 899 
Overall Loss: 11.447401
Rec Loss: 9.917796
KL Loss: 1.529605
Y Loss: 0.754285
T Loss: 9.540654
Epoch 949 
Overall Loss: 11.393552
Rec Loss: 9.873110
KL Loss: 1.520442
Y Loss: 0.718795
T Loss: 9.513713
Epoch 999 
Overall Loss: 11.411646
Rec Loss: 9.915285
KL Loss: 1.496361
Y Loss: 0.741366
T Loss: 9.544602
Epoch 1049 
Overall Loss: 11.444081
Rec Loss: 9.899055
KL Loss: 1.545027
Y Loss: 0.740951
T Loss: 9.528579
Epoch 1099 
Overall Loss: 11.427327
Rec Loss: 9.917556
KL Loss: 1.509771
Y Loss: 0.716516
T Loss: 9.559298
Epoch 1149 
Overall Loss: 11.401027
Rec Loss: 9.880500
KL Loss: 1.520527
Y Loss: 0.711626
T Loss: 9.524687
Epoch 1199 
Overall Loss: 11.401259
Rec Loss: 9.865534
KL Loss: 1.535726
Y Loss: 0.712134
T Loss: 9.509466
Epoch 1249 
Overall Loss: 11.407605
Rec Loss: 9.859882
KL Loss: 1.547723
Y Loss: 0.712863
T Loss: 9.503450
Epoch 1299 
Overall Loss: 11.416305
Rec Loss: 9.871391
KL Loss: 1.544914
Y Loss: 0.709959
T Loss: 9.516411
Epoch 1349 
Overall Loss: 11.387524
Rec Loss: 9.848098
KL Loss: 1.539426
Y Loss: 0.700773
T Loss: 9.497712
Epoch 1399 
Overall Loss: 11.396260
Rec Loss: 9.847738
KL Loss: 1.548521
Y Loss: 0.689620
T Loss: 9.502929
Epoch 1449 
Overall Loss: 11.383430
Rec Loss: 9.861398
KL Loss: 1.522032
Y Loss: 0.692635
T Loss: 9.515080
Epoch 1499 
Overall Loss: 11.394954
Rec Loss: 9.862768
KL Loss: 1.532186
Y Loss: 0.698212
T Loss: 9.513661
Epoch 1549 
Overall Loss: 11.376540
Rec Loss: 9.857579
KL Loss: 1.518961
Y Loss: 0.692175
T Loss: 9.511492
Epoch 1599 
Overall Loss: 11.359166
Rec Loss: 9.846118
KL Loss: 1.513049
Y Loss: 0.683518
T Loss: 9.504359
Epoch 1649 
Overall Loss: 11.369829
Rec Loss: 9.840917
KL Loss: 1.528913
Y Loss: 0.694259
T Loss: 9.493787
Epoch 1699 
Overall Loss: 11.375720
Rec Loss: 9.841490
KL Loss: 1.534230
Y Loss: 0.672890
T Loss: 9.505046
Epoch 1749 
Overall Loss: 11.373545
Rec Loss: 9.852580
KL Loss: 1.520966
Y Loss: 0.680298
T Loss: 9.512431
Epoch 1799 
Overall Loss: 11.363612
Rec Loss: 9.840341
KL Loss: 1.523271
Y Loss: 0.681902
T Loss: 9.499390
Epoch 1849 
Overall Loss: 11.364910
Rec Loss: 9.845333
KL Loss: 1.519578
Y Loss: 0.678185
T Loss: 9.506240
Epoch 1899 
Overall Loss: 11.364651
Rec Loss: 9.830095
KL Loss: 1.534556
Y Loss: 0.680281
T Loss: 9.489954
Epoch 1949 
Overall Loss: 11.358548
Rec Loss: 9.822115
KL Loss: 1.536432
Y Loss: 0.678077
T Loss: 9.483076
Epoch 1999 
Overall Loss: 11.380147
Rec Loss: 9.813882
KL Loss: 1.566265
Y Loss: 0.681513
T Loss: 9.473126
Epoch 2049 
Overall Loss: 11.376707
Rec Loss: 9.854786
KL Loss: 1.521921
Y Loss: 0.669677
T Loss: 9.519948
Epoch 2099 
Overall Loss: 11.376066
Rec Loss: 9.841389
KL Loss: 1.534677
Y Loss: 0.687508
T Loss: 9.497635
Epoch 2149 
Overall Loss: 11.364922
Rec Loss: 9.812724
KL Loss: 1.552198
Y Loss: 0.671511
T Loss: 9.476968
Epoch 2199 
Overall Loss: 11.361087
Rec Loss: 9.810485
KL Loss: 1.550601
Y Loss: 0.665847
T Loss: 9.477562
Epoch 2249 
Overall Loss: 11.375617
Rec Loss: 9.812319
KL Loss: 1.563298
Y Loss: 0.656704
T Loss: 9.483967
Epoch 2299 
Overall Loss: 11.349208
Rec Loss: 9.805942
KL Loss: 1.543266
Y Loss: 0.672047
T Loss: 9.469918
Epoch 2349 
Overall Loss: 11.327844
Rec Loss: 9.789352
KL Loss: 1.538492
Y Loss: 0.653076
T Loss: 9.462814
Epoch 2399 
Overall Loss: 11.354462
Rec Loss: 9.824995
KL Loss: 1.529467
Y Loss: 0.669848
T Loss: 9.490071
Epoch 2449 
Overall Loss: 11.357598
Rec Loss: 9.813294
KL Loss: 1.544304
Y Loss: 0.652152
T Loss: 9.487218
Epoch 2499 
Overall Loss: 11.326497
Rec Loss: 9.801106
KL Loss: 1.525391
Y Loss: 0.658757
T Loss: 9.471727
Epoch 2549 
Overall Loss: 11.332797
Rec Loss: 9.788303
KL Loss: 1.544494
Y Loss: 0.660711
T Loss: 9.457946
Epoch 2599 
Overall Loss: 11.333412
Rec Loss: 9.800479
KL Loss: 1.532933
Y Loss: 0.666627
T Loss: 9.467165
Epoch 2649 
Overall Loss: 11.331885
Rec Loss: 9.783719
KL Loss: 1.548166
Y Loss: 0.651922
T Loss: 9.457758
Epoch 2699 
Overall Loss: 11.347580
Rec Loss: 9.790961
KL Loss: 1.556619
Y Loss: 0.656190
T Loss: 9.462866
Epoch 2749 
Overall Loss: 11.347953
Rec Loss: 9.820723
KL Loss: 1.527230
Y Loss: 0.658407
T Loss: 9.491520
Epoch 2799 
Overall Loss: 11.325789
Rec Loss: 9.786784
KL Loss: 1.539005
Y Loss: 0.646843
T Loss: 9.463362
Epoch 2849 
Overall Loss: 11.342011
Rec Loss: 9.793760
KL Loss: 1.548251
Y Loss: 0.650480
T Loss: 9.468519
Epoch 2899 
Overall Loss: 11.330560
Rec Loss: 9.785321
KL Loss: 1.545239
Y Loss: 0.644504
T Loss: 9.463068
Epoch 2949 
Overall Loss: 11.332836
Rec Loss: 9.790466
KL Loss: 1.542370
Y Loss: 0.646024
T Loss: 9.467454
Epoch 2999 
Overall Loss: 11.319133
Rec Loss: 9.784010
KL Loss: 1.535123
Y Loss: 0.646314
T Loss: 9.460853
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.818547
Epoch 99
Rec Loss: 0.811664
Epoch 149
Rec Loss: 0.809467
Epoch 199
Rec Loss: 0.796495
Epoch 249
Rec Loss: 0.805977
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.744846
Epoch 99
Rec Loss: 9.735423
Epoch 149
Rec Loss: 9.731611
Epoch 199
Rec Loss: 9.723749
Epoch 249
Rec Loss: 9.728880
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.731133
Insample Error: 1.887036
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.071573
Epoch 99
Rec Loss: 4.065364
Epoch 149
Rec Loss: 4.071507
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 8.233174
Epoch 99
Rec Loss: 8.344421
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.018351
Insample Error 2.801696
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.338715
Epoch 99 
Prediction Loss: 1.114739
Epoch 149 
Prediction Loss: 1.047779
Epoch 199 
Prediction Loss: 1.020240
Epoch 249 
Prediction Loss: 1.013062
Epoch 299 
Prediction Loss: 1.000000
Epoch 349 
Prediction Loss: 0.975532
Epoch 399 
Prediction Loss: 0.980562
Epoch 449 
Prediction Loss: 0.960175
Epoch 499 
Prediction Loss: 0.965324
Epoch 549 
Prediction Loss: 0.956274
Epoch 599 
Prediction Loss: 0.945729
Epoch 649 
Prediction Loss: 0.955090
Epoch 699 
Prediction Loss: 0.948070
Epoch 749 
Prediction Loss: 0.934423
Epoch 799 
Prediction Loss: 0.936112
Epoch 849 
Prediction Loss: 0.922190
Epoch 899 
Prediction Loss: 0.916839
Epoch 949 
Prediction Loss: 0.921911
Epoch 999 
Prediction Loss: 0.928539
Epoch 1049 
Prediction Loss: 0.904363
Epoch 1099 
Prediction Loss: 0.897071
Epoch 1149 
Prediction Loss: 0.892489
Epoch 1199 
Prediction Loss: 0.896900
Epoch 1249 
Prediction Loss: 0.895311
Epoch 1299 
Prediction Loss: 0.893740
Epoch 1349 
Prediction Loss: 0.883292
Epoch 1399 
Prediction Loss: 0.876338
Epoch 1449 
Prediction Loss: 0.872900
Epoch 1499 
Prediction Loss: 0.871783
Epoch 1549 
Prediction Loss: 0.863960
Epoch 1599 
Prediction Loss: 0.861189
Epoch 1649 
Prediction Loss: 0.859066
Epoch 1699 
Prediction Loss: 0.852016
Epoch 1749 
Prediction Loss: 0.852354
Epoch 1799 
Prediction Loss: 0.843358
Epoch 1849 
Prediction Loss: 0.852265
Epoch 1899 
Prediction Loss: 0.837730
Epoch 1949 
Prediction Loss: 0.842114
Epoch 1999 
Prediction Loss: 0.829236
Epoch 2049 
Prediction Loss: 0.843599
Epoch 2099 
Prediction Loss: 0.828185
Epoch 2149 
Prediction Loss: 0.825106
Epoch 2199 
Prediction Loss: 0.835932
Epoch 2249 
Prediction Loss: 0.819338
Epoch 2299 
Prediction Loss: 0.814540
Epoch 2349 
Prediction Loss: 0.814418
Epoch 2399 
Prediction Loss: 0.813527
Epoch 2449 
Prediction Loss: 0.807349
Epoch 2499 
Prediction Loss: 0.805814
Epoch 2549 
Prediction Loss: 0.800594
Epoch 2599 
Prediction Loss: 0.799345
Epoch 2649 
Prediction Loss: 0.804273
Epoch 2699 
Prediction Loss: 0.797714
Epoch 2749 
Prediction Loss: 0.808598
Epoch 2799 
Prediction Loss: 0.793498
Epoch 2849 
Prediction Loss: 0.789717
Epoch 2899 
Prediction Loss: 0.795012
Epoch 2949 
Prediction Loss: 0.784756
Epoch 2999 
Prediction Loss: 0.781787
Epoch 3049 
Prediction Loss: 0.773475
Epoch 3099 
Prediction Loss: 0.781566
Epoch 3149 
Prediction Loss: 0.772976
Epoch 3199 
Prediction Loss: 0.774232
Epoch 3249 
Prediction Loss: 0.767375
Epoch 3299 
Prediction Loss: 0.763740
Epoch 3349 
Prediction Loss: 0.766461
Epoch 3399 
Prediction Loss: 0.758176
Epoch 3449 
Prediction Loss: 0.750939
Epoch 3499 
Prediction Loss: 0.768843
Epoch 3549 
Prediction Loss: 0.750333
Epoch 3599 
Prediction Loss: 0.744821
Epoch 3649 
Prediction Loss: 0.741605
Epoch 3699 
Prediction Loss: 0.736258
Epoch 3749 
Prediction Loss: 0.745274
Epoch 3799 
Prediction Loss: 0.739845
Epoch 3849 
Prediction Loss: 0.730488
Epoch 3899 
Prediction Loss: 0.726834
Epoch 3949 
Prediction Loss: 0.734379
Epoch 3999 
Prediction Loss: 0.729933
Epoch 4049 
Prediction Loss: 0.723175
Epoch 4099 
Prediction Loss: 0.720538
Epoch 4149 
Prediction Loss: 0.718261
Epoch 4199 
Prediction Loss: 0.709557
Epoch 4249 
Prediction Loss: 0.721512
Epoch 4299 
Prediction Loss: 0.712182
Epoch 4349 
Prediction Loss: 0.708249
Epoch 4399 
Prediction Loss: 0.700077
Epoch 4449 
Prediction Loss: 0.698260
Epoch 4499 
Prediction Loss: 0.709797
Epoch 4549 
Prediction Loss: 0.700024
Epoch 4599 
Prediction Loss: 0.708469
Epoch 4649 
Prediction Loss: 0.697104
Epoch 4699 
Prediction Loss: 0.705685
Epoch 4749 
Prediction Loss: 0.695950
Epoch 4799 
Prediction Loss: 0.697891
Epoch 4849 
Prediction Loss: 0.685541
Epoch 4899 
Prediction Loss: 0.682808
Epoch 4949 
Prediction Loss: 0.675917
Epoch 4999 
Prediction Loss: 0.674654
Epoch 5049 
Prediction Loss: 0.673235
Epoch 5099 
Prediction Loss: 0.677484
Epoch 5149 
Prediction Loss: 0.678545
Epoch 5199 
Prediction Loss: 0.671393
Epoch 5249 
Prediction Loss: 0.675140
Epoch 5299 
Prediction Loss: 0.664719
Epoch 5349 
Prediction Loss: 0.665813
Epoch 5399 
Prediction Loss: 0.665523
Epoch 5449 
Prediction Loss: 0.660350
Epoch 5499 
Prediction Loss: 0.656174
Epoch 5549 
Prediction Loss: 0.665365
Epoch 5599 
Prediction Loss: 0.656734
Epoch 5649 
Prediction Loss: 0.650717
Epoch 5699 
Prediction Loss: 0.654036
Epoch 5749 
Prediction Loss: 0.653061
Epoch 5799 
Prediction Loss: 0.651844
Epoch 5849 
Prediction Loss: 0.645181
Epoch 5899 
Prediction Loss: 0.642528
Epoch 5949 
Prediction Loss: 0.644092
Epoch 5999 
Prediction Loss: 0.643343
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.797883
Insample Error 2.311692
[31m========== repeat time 4 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.106530
Rec Loss: 10.048931
KL Loss: 2.057600
Y Loss: 1.028893
T Loss: 9.534484
Epoch 99 
Overall Loss: 11.714425
Rec Loss: 10.184909
KL Loss: 1.529515
Y Loss: 1.059899
T Loss: 9.654960
Epoch 149 
Overall Loss: 11.603570
Rec Loss: 10.164504
KL Loss: 1.439066
Y Loss: 1.014577
T Loss: 9.657216
Epoch 199 
Overall Loss: 11.547232
Rec Loss: 10.095727
KL Loss: 1.451504
Y Loss: 0.953080
T Loss: 9.619188
Epoch 249 
Overall Loss: 11.531722
Rec Loss: 10.060380
KL Loss: 1.471342
Y Loss: 0.911562
T Loss: 9.604599
Epoch 299 
Overall Loss: 11.509113
Rec Loss: 10.026156
KL Loss: 1.482957
Y Loss: 0.884440
T Loss: 9.583935
Epoch 349 
Overall Loss: 11.494263
Rec Loss: 9.992962
KL Loss: 1.501301
Y Loss: 0.859005
T Loss: 9.563459
Epoch 399 
Overall Loss: 11.477186
Rec Loss: 10.006043
KL Loss: 1.471143
Y Loss: 0.831841
T Loss: 9.590123
Epoch 449 
Overall Loss: 11.448266
Rec Loss: 9.983491
KL Loss: 1.464775
Y Loss: 0.819775
T Loss: 9.573604
Epoch 499 
Overall Loss: 11.469248
Rec Loss: 9.970602
KL Loss: 1.498645
Y Loss: 0.816980
T Loss: 9.562112
Epoch 549 
Overall Loss: 11.454454
Rec Loss: 9.955138
KL Loss: 1.499317
Y Loss: 0.795732
T Loss: 9.557272
Epoch 599 
Overall Loss: 11.459801
Rec Loss: 9.961895
KL Loss: 1.497905
Y Loss: 0.800841
T Loss: 9.561475
Epoch 649 
Overall Loss: 11.470041
Rec Loss: 9.968754
KL Loss: 1.501287
Y Loss: 0.792897
T Loss: 9.572306
Epoch 699 
Overall Loss: 11.450082
Rec Loss: 9.926866
KL Loss: 1.523216
Y Loss: 0.775922
T Loss: 9.538905
Epoch 749 
Overall Loss: 11.462249
Rec Loss: 9.947170
KL Loss: 1.515079
Y Loss: 0.771686
T Loss: 9.561327
Epoch 799 
Overall Loss: 11.431390
Rec Loss: 9.929164
KL Loss: 1.502226
Y Loss: 0.758964
T Loss: 9.549682
Epoch 849 
Overall Loss: 11.435838
Rec Loss: 9.914741
KL Loss: 1.521096
Y Loss: 0.754191
T Loss: 9.537646
Epoch 899 
Overall Loss: 11.425154
Rec Loss: 9.915368
KL Loss: 1.509786
Y Loss: 0.758151
T Loss: 9.536293
Epoch 949 
Overall Loss: 11.413423
Rec Loss: 9.913474
KL Loss: 1.499949
Y Loss: 0.740093
T Loss: 9.543428
Epoch 999 
Overall Loss: 11.411908
Rec Loss: 9.899090
KL Loss: 1.512818
Y Loss: 0.739795
T Loss: 9.529193
Epoch 1049 
Overall Loss: 11.395070
Rec Loss: 9.901600
KL Loss: 1.493469
Y Loss: 0.726712
T Loss: 9.538244
Epoch 1099 
Overall Loss: 11.437926
Rec Loss: 9.885890
KL Loss: 1.552035
Y Loss: 0.727703
T Loss: 9.522039
Epoch 1149 
Overall Loss: 11.411729
Rec Loss: 9.870707
KL Loss: 1.541022
Y Loss: 0.733821
T Loss: 9.503797
Epoch 1199 
Overall Loss: 11.410197
Rec Loss: 9.867598
KL Loss: 1.542599
Y Loss: 0.725688
T Loss: 9.504754
Epoch 1249 
Overall Loss: 11.409284
Rec Loss: 9.895863
KL Loss: 1.513421
Y Loss: 0.740918
T Loss: 9.525405
Epoch 1299 
Overall Loss: 11.409354
Rec Loss: 9.898819
KL Loss: 1.510535
Y Loss: 0.710792
T Loss: 9.543423
Epoch 1349 
Overall Loss: 11.391939
Rec Loss: 9.852708
KL Loss: 1.539231
Y Loss: 0.706379
T Loss: 9.499518
Epoch 1399 
Overall Loss: 11.398315
Rec Loss: 9.846115
KL Loss: 1.552200
Y Loss: 0.708832
T Loss: 9.491699
Epoch 1449 
Overall Loss: 11.400498
Rec Loss: 9.849192
KL Loss: 1.551306
Y Loss: 0.688582
T Loss: 9.504901
Epoch 1499 
Overall Loss: 11.387111
Rec Loss: 9.850685
KL Loss: 1.536426
Y Loss: 0.695895
T Loss: 9.502738
Epoch 1549 
Overall Loss: 11.396081
Rec Loss: 9.837228
KL Loss: 1.558853
Y Loss: 0.696446
T Loss: 9.489005
Epoch 1599 
Overall Loss: 11.382482
Rec Loss: 9.858522
KL Loss: 1.523960
Y Loss: 0.697730
T Loss: 9.509657
Epoch 1649 
Overall Loss: 11.380821
Rec Loss: 9.847055
KL Loss: 1.533766
Y Loss: 0.665894
T Loss: 9.514108
Epoch 1699 
Overall Loss: 11.379165
Rec Loss: 9.847707
KL Loss: 1.531457
Y Loss: 0.675480
T Loss: 9.509967
Epoch 1749 
Overall Loss: 11.376460
Rec Loss: 9.840071
KL Loss: 1.536389
Y Loss: 0.692741
T Loss: 9.493701
Epoch 1799 
Overall Loss: 11.358726
Rec Loss: 9.837925
KL Loss: 1.520801
Y Loss: 0.674357
T Loss: 9.500746
Epoch 1849 
Overall Loss: 11.355484
Rec Loss: 9.839268
KL Loss: 1.516215
Y Loss: 0.667736
T Loss: 9.505400
Epoch 1899 
Overall Loss: 11.374885
Rec Loss: 9.821360
KL Loss: 1.553526
Y Loss: 0.657745
T Loss: 9.492487
Epoch 1949 
Overall Loss: 11.379663
Rec Loss: 9.834513
KL Loss: 1.545150
Y Loss: 0.659943
T Loss: 9.504541
Epoch 1999 
Overall Loss: 11.371110
Rec Loss: 9.847051
KL Loss: 1.524059
Y Loss: 0.682771
T Loss: 9.505666
Epoch 2049 
Overall Loss: 11.370427
Rec Loss: 9.831624
KL Loss: 1.538804
Y Loss: 0.652665
T Loss: 9.505291
Epoch 2099 
Overall Loss: 11.317123
Rec Loss: 9.805519
KL Loss: 1.511604
Y Loss: 0.668119
T Loss: 9.471459
Epoch 2149 
Overall Loss: 11.348012
Rec Loss: 9.801872
KL Loss: 1.546141
Y Loss: 0.653974
T Loss: 9.474884
Epoch 2199 
Overall Loss: 11.351050
Rec Loss: 9.802328
KL Loss: 1.548721
Y Loss: 0.655019
T Loss: 9.474819
Epoch 2249 
Overall Loss: 11.357137
Rec Loss: 9.814620
KL Loss: 1.542517
Y Loss: 0.664536
T Loss: 9.482352
Epoch 2299 
Overall Loss: 11.331849
Rec Loss: 9.817384
KL Loss: 1.514465
Y Loss: 0.655194
T Loss: 9.489787
Epoch 2349 
Overall Loss: 11.328523
Rec Loss: 9.800021
KL Loss: 1.528502
Y Loss: 0.660626
T Loss: 9.469708
Epoch 2399 
Overall Loss: 11.356773
Rec Loss: 9.802938
KL Loss: 1.553835
Y Loss: 0.663642
T Loss: 9.471117
Epoch 2449 
Overall Loss: 11.330826
Rec Loss: 9.798653
KL Loss: 1.532173
Y Loss: 0.656086
T Loss: 9.470610
Epoch 2499 
Overall Loss: 11.336564
Rec Loss: 9.817755
KL Loss: 1.518809
Y Loss: 0.653521
T Loss: 9.490994
Epoch 2549 
Overall Loss: 11.348025
Rec Loss: 9.811116
KL Loss: 1.536909
Y Loss: 0.644019
T Loss: 9.489106
Epoch 2599 
Overall Loss: 11.328130
Rec Loss: 9.800345
KL Loss: 1.527784
Y Loss: 0.656983
T Loss: 9.471854
Epoch 2649 
Overall Loss: 11.338621
Rec Loss: 9.811606
KL Loss: 1.527014
Y Loss: 0.639974
T Loss: 9.491619
Epoch 2699 
Overall Loss: 11.346454
Rec Loss: 9.806575
KL Loss: 1.539879
Y Loss: 0.639094
T Loss: 9.487028
Epoch 2749 
Overall Loss: 11.326197
Rec Loss: 9.806690
KL Loss: 1.519507
Y Loss: 0.651703
T Loss: 9.480839
Epoch 2799 
Overall Loss: 11.333569
Rec Loss: 9.808826
KL Loss: 1.524743
Y Loss: 0.641083
T Loss: 9.488285
Epoch 2849 
Overall Loss: 11.333762
Rec Loss: 9.783521
KL Loss: 1.550241
Y Loss: 0.642288
T Loss: 9.462377
Epoch 2899 
Overall Loss: 11.312521
Rec Loss: 9.775279
KL Loss: 1.537243
Y Loss: 0.637164
T Loss: 9.456697
Epoch 2949 
Overall Loss: 11.335087
Rec Loss: 9.768737
KL Loss: 1.566349
Y Loss: 0.640489
T Loss: 9.448493
Epoch 2999 
Overall Loss: 11.353916
Rec Loss: 9.789123
KL Loss: 1.564792
Y Loss: 0.642971
T Loss: 9.467638
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.799353
Epoch 99
Rec Loss: 0.787176
Epoch 149
Rec Loss: 0.789487
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.744709
Epoch 99
Rec Loss: 9.743981
Epoch 149
Rec Loss: 9.733648
Epoch 199
Rec Loss: 9.721085
Epoch 249
Rec Loss: 9.731651
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.735756
Insample Error: 1.952492
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.066742
Epoch 99
Rec Loss: 4.064236
Epoch 149
Rec Loss: 4.061570
Epoch 199
Rec Loss: 4.062959
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 8.981068
Epoch 99
Rec Loss: 8.911078
Epoch 149
Rec Loss: 8.865548
Epoch 199
Rec Loss: 8.909012
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.971459
Insample Error 2.802434
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.377729
Epoch 99 
Prediction Loss: 1.155541
Epoch 149 
Prediction Loss: 1.082668
Epoch 199 
Prediction Loss: 1.044491
Epoch 249 
Prediction Loss: 1.025584
Epoch 299 
Prediction Loss: 1.003416
Epoch 349 
Prediction Loss: 0.993497
Epoch 399 
Prediction Loss: 0.988044
Epoch 449 
Prediction Loss: 0.987868
Epoch 499 
Prediction Loss: 0.973958
Epoch 549 
Prediction Loss: 0.961143
Epoch 599 
Prediction Loss: 0.953849
Epoch 649 
Prediction Loss: 0.949694
Epoch 699 
Prediction Loss: 0.936951
Epoch 749 
Prediction Loss: 0.930703
Epoch 799 
Prediction Loss: 0.929867
Epoch 849 
Prediction Loss: 0.922604
Epoch 899 
Prediction Loss: 0.926404
Epoch 949 
Prediction Loss: 0.916781
Epoch 999 
Prediction Loss: 0.906269
Epoch 1049 
Prediction Loss: 0.913331
Epoch 1099 
Prediction Loss: 0.906096
Epoch 1149 
Prediction Loss: 0.895445
Epoch 1199 
Prediction Loss: 0.896389
Epoch 1249 
Prediction Loss: 0.888666
Epoch 1299 
Prediction Loss: 0.889218
Epoch 1349 
Prediction Loss: 0.895759
Epoch 1399 
Prediction Loss: 0.884703
Epoch 1449 
Prediction Loss: 0.880430
Epoch 1499 
Prediction Loss: 0.889166
Epoch 1549 
Prediction Loss: 0.875329
Epoch 1599 
Prediction Loss: 0.866066
Epoch 1649 
Prediction Loss: 0.867336
Epoch 1699 
Prediction Loss: 0.861677
Epoch 1749 
Prediction Loss: 0.855410
Epoch 1799 
Prediction Loss: 0.858452
Epoch 1849 
Prediction Loss: 0.858758
Epoch 1899 
Prediction Loss: 0.849180
Epoch 1949 
Prediction Loss: 0.850188
Epoch 1999 
Prediction Loss: 0.849753
Epoch 2049 
Prediction Loss: 0.840846
Epoch 2099 
Prediction Loss: 0.839685
Epoch 2149 
Prediction Loss: 0.841328
Epoch 2199 
Prediction Loss: 0.837653
Epoch 2249 
Prediction Loss: 0.841027
Epoch 2299 
Prediction Loss: 0.832905
Epoch 2349 
Prediction Loss: 0.836171
Epoch 2399 
Prediction Loss: 0.829943
Epoch 2449 
Prediction Loss: 0.821842
Epoch 2499 
Prediction Loss: 0.827846
Epoch 2549 
Prediction Loss: 0.820900
Epoch 2599 
Prediction Loss: 0.817697
Epoch 2649 
Prediction Loss: 0.820841
Epoch 2699 
Prediction Loss: 0.817957
Epoch 2749 
Prediction Loss: 0.823725
Epoch 2799 
Prediction Loss: 0.813127
Epoch 2849 
Prediction Loss: 0.806412
Epoch 2899 
Prediction Loss: 0.803665
Epoch 2949 
Prediction Loss: 0.810627
Epoch 2999 
Prediction Loss: 0.807569
Epoch 3049 
Prediction Loss: 0.794740
Epoch 3099 
Prediction Loss: 0.801179
Epoch 3149 
Prediction Loss: 0.794446
Epoch 3199 
Prediction Loss: 0.798121
Epoch 3249 
Prediction Loss: 0.782958
Epoch 3299 
Prediction Loss: 0.788224
Epoch 3349 
Prediction Loss: 0.778972
Epoch 3399 
Prediction Loss: 0.777159
Epoch 3449 
Prediction Loss: 0.784702
Epoch 3499 
Prediction Loss: 0.786889
Epoch 3549 
Prediction Loss: 0.786415
Epoch 3599 
Prediction Loss: 0.767552
Epoch 3649 
Prediction Loss: 0.783782
Epoch 3699 
Prediction Loss: 0.763378
Epoch 3749 
Prediction Loss: 0.762330
Epoch 3799 
Prediction Loss: 0.763252
Epoch 3849 
Prediction Loss: 0.771052
Epoch 3899 
Prediction Loss: 0.749459
Epoch 3949 
Prediction Loss: 0.747374
Epoch 3999 
Prediction Loss: 0.754411
Epoch 4049 
Prediction Loss: 0.744674
Epoch 4099 
Prediction Loss: 0.745868
Epoch 4149 
Prediction Loss: 0.744369
Epoch 4199 
Prediction Loss: 0.751138
Epoch 4249 
Prediction Loss: 0.739495
Epoch 4299 
Prediction Loss: 0.749254
Epoch 4349 
Prediction Loss: 0.742230
Epoch 4399 
Prediction Loss: 0.737125
Epoch 4449 
Prediction Loss: 0.728212
Epoch 4499 
Prediction Loss: 0.727974
Epoch 4549 
Prediction Loss: 0.737858
Epoch 4599 
Prediction Loss: 0.723038
Epoch 4649 
Prediction Loss: 0.724228
Epoch 4699 
Prediction Loss: 0.719531
Epoch 4749 
Prediction Loss: 0.732714
Epoch 4799 
Prediction Loss: 0.720972
Epoch 4849 
Prediction Loss: 0.710027
Epoch 4899 
Prediction Loss: 0.714283
Epoch 4949 
Prediction Loss: 0.736219
Epoch 4999 
Prediction Loss: 0.710817
Epoch 5049 
Prediction Loss: 0.706697
Epoch 5099 
Prediction Loss: 0.709975
Epoch 5149 
Prediction Loss: 0.703965
Epoch 5199 
Prediction Loss: 0.698718
Epoch 5249 
Prediction Loss: 0.710554
Epoch 5299 
Prediction Loss: 0.696314
Epoch 5349 
Prediction Loss: 0.699117
Epoch 5399 
Prediction Loss: 0.712263
Epoch 5449 
Prediction Loss: 0.702530
Epoch 5499 
Prediction Loss: 0.698747
Epoch 5549 
Prediction Loss: 0.692250
Epoch 5599 
Prediction Loss: 0.688170
Epoch 5649 
Prediction Loss: 0.701412
Epoch 5699 
Prediction Loss: 0.688863
Epoch 5749 
Prediction Loss: 0.690726
Epoch 5799 
Prediction Loss: 0.682048
Epoch 5849 
Prediction Loss: 0.703038
Epoch 5899 
Prediction Loss: 0.678527
Epoch 5949 
Prediction Loss: 0.684199
Epoch 5999 
Prediction Loss: 0.678133
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.817929
Insample Error 2.250571
[31m========== repeat time 5 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.053399
Rec Loss: 10.062867
KL Loss: 1.990532
Y Loss: 1.054895
T Loss: 9.535419
Epoch 99 
Overall Loss: 11.654286
Rec Loss: 10.144456
KL Loss: 1.509830
Y Loss: 1.023409
T Loss: 9.632751
Epoch 149 
Overall Loss: 11.598902
Rec Loss: 10.115611
KL Loss: 1.483291
Y Loss: 0.959665
T Loss: 9.635779
Epoch 199 
Overall Loss: 11.543360
Rec Loss: 10.058537
KL Loss: 1.484824
Y Loss: 0.907823
T Loss: 9.604625
Epoch 249 
Overall Loss: 11.525292
Rec Loss: 10.029372
KL Loss: 1.495920
Y Loss: 0.885085
T Loss: 9.586830
Epoch 299 
Overall Loss: 11.494945
Rec Loss: 10.017102
KL Loss: 1.477843
Y Loss: 0.835804
T Loss: 9.599200
Epoch 349 
Overall Loss: 11.485653
Rec Loss: 10.006824
KL Loss: 1.478829
Y Loss: 0.820782
T Loss: 9.596433
Epoch 399 
Overall Loss: 11.489279
Rec Loss: 9.996017
KL Loss: 1.493262
Y Loss: 0.821442
T Loss: 9.585296
Epoch 449 
Overall Loss: 11.456478
Rec Loss: 9.946845
KL Loss: 1.509633
Y Loss: 0.804221
T Loss: 9.544734
Epoch 499 
Overall Loss: 11.467025
Rec Loss: 9.968777
KL Loss: 1.498247
Y Loss: 0.795531
T Loss: 9.571012
Epoch 549 
Overall Loss: 11.448126
Rec Loss: 9.936613
KL Loss: 1.511514
Y Loss: 0.768815
T Loss: 9.552205
Epoch 599 
Overall Loss: 11.433746
Rec Loss: 9.939035
KL Loss: 1.494712
Y Loss: 0.779752
T Loss: 9.549159
Epoch 649 
Overall Loss: 11.452258
Rec Loss: 9.914300
KL Loss: 1.537958
Y Loss: 0.741457
T Loss: 9.543571
Epoch 699 
Overall Loss: 11.435695
Rec Loss: 9.908017
KL Loss: 1.527677
Y Loss: 0.753775
T Loss: 9.531130
Epoch 749 
Overall Loss: 11.440217
Rec Loss: 9.908380
KL Loss: 1.531837
Y Loss: 0.740661
T Loss: 9.538049
Epoch 799 
Overall Loss: 11.434503
Rec Loss: 9.904319
KL Loss: 1.530183
Y Loss: 0.742000
T Loss: 9.533319
Epoch 849 
Overall Loss: 11.429938
Rec Loss: 9.897471
KL Loss: 1.532468
Y Loss: 0.747242
T Loss: 9.523850
Epoch 899 
Overall Loss: 11.412079
Rec Loss: 9.900110
KL Loss: 1.511969
Y Loss: 0.724650
T Loss: 9.537784
Epoch 949 
Overall Loss: 11.401645
Rec Loss: 9.872864
KL Loss: 1.528781
Y Loss: 0.737166
T Loss: 9.504282
Epoch 999 
Overall Loss: 11.417126
Rec Loss: 9.895719
KL Loss: 1.521408
Y Loss: 0.715987
T Loss: 9.537725
Epoch 1049 
Overall Loss: 11.408099
Rec Loss: 9.884329
KL Loss: 1.523770
Y Loss: 0.717470
T Loss: 9.525594
Epoch 1099 
Overall Loss: 11.420671
Rec Loss: 9.889566
KL Loss: 1.531104
Y Loss: 0.713896
T Loss: 9.532618
Epoch 1149 
Overall Loss: 11.392343
Rec Loss: 9.877612
KL Loss: 1.514732
Y Loss: 0.720818
T Loss: 9.517203
Epoch 1199 
Overall Loss: 11.393199
Rec Loss: 9.846901
KL Loss: 1.546298
Y Loss: 0.707102
T Loss: 9.493350
Epoch 1249 
Overall Loss: 11.387346
Rec Loss: 9.860463
KL Loss: 1.526883
Y Loss: 0.704735
T Loss: 9.508095
Epoch 1299 
Overall Loss: 11.377654
Rec Loss: 9.828741
KL Loss: 1.548913
Y Loss: 0.691761
T Loss: 9.482860
Epoch 1349 
Overall Loss: 11.380775
Rec Loss: 9.842813
KL Loss: 1.537962
Y Loss: 0.694489
T Loss: 9.495568
Epoch 1399 
Overall Loss: 11.371000
Rec Loss: 9.832065
KL Loss: 1.538935
Y Loss: 0.689981
T Loss: 9.487075
Epoch 1449 
Overall Loss: 11.397443
Rec Loss: 9.848301
KL Loss: 1.549141
Y Loss: 0.681365
T Loss: 9.507619
Epoch 1499 
Overall Loss: 11.371875
Rec Loss: 9.851951
KL Loss: 1.519925
Y Loss: 0.699055
T Loss: 9.502424
Epoch 1549 
Overall Loss: 11.375359
Rec Loss: 9.829332
KL Loss: 1.546027
Y Loss: 0.689511
T Loss: 9.484577
Epoch 1599 
Overall Loss: 11.383464
Rec Loss: 9.838118
KL Loss: 1.545346
Y Loss: 0.677842
T Loss: 9.499197
Epoch 1649 
Overall Loss: 11.361397
Rec Loss: 9.823759
KL Loss: 1.537639
Y Loss: 0.669604
T Loss: 9.488957
Epoch 1699 
Overall Loss: 11.378873
Rec Loss: 9.841387
KL Loss: 1.537485
Y Loss: 0.674634
T Loss: 9.504071
Epoch 1749 
Overall Loss: 11.348184
Rec Loss: 9.823104
KL Loss: 1.525080
Y Loss: 0.661901
T Loss: 9.492154
Epoch 1799 
Overall Loss: 11.383573
Rec Loss: 9.838201
KL Loss: 1.545372
Y Loss: 0.677059
T Loss: 9.499672
Epoch 1849 
Overall Loss: 11.370604
Rec Loss: 9.816691
KL Loss: 1.553914
Y Loss: 0.658697
T Loss: 9.487342
Epoch 1899 
Overall Loss: 11.383578
Rec Loss: 9.832953
KL Loss: 1.550625
Y Loss: 0.666431
T Loss: 9.499738
Epoch 1949 
Overall Loss: 11.367833
Rec Loss: 9.831184
KL Loss: 1.536649
Y Loss: 0.676872
T Loss: 9.492748
Epoch 1999 
Overall Loss: 11.355783
Rec Loss: 9.805671
KL Loss: 1.550112
Y Loss: 0.655454
T Loss: 9.477944
Epoch 2049 
Overall Loss: 11.341836
Rec Loss: 9.793014
KL Loss: 1.548822
Y Loss: 0.658633
T Loss: 9.463698
Epoch 2099 
Overall Loss: 11.350804
Rec Loss: 9.827300
KL Loss: 1.523503
Y Loss: 0.653918
T Loss: 9.500341
Epoch 2149 
Overall Loss: 11.341198
Rec Loss: 9.796811
KL Loss: 1.544387
Y Loss: 0.647907
T Loss: 9.472857
Epoch 2199 
Overall Loss: 11.357128
Rec Loss: 9.797351
KL Loss: 1.559777
Y Loss: 0.664387
T Loss: 9.465157
Epoch 2249 
Overall Loss: 11.336112
Rec Loss: 9.799120
KL Loss: 1.536992
Y Loss: 0.643226
T Loss: 9.477507
Epoch 2299 
Overall Loss: 11.347283
Rec Loss: 9.788003
KL Loss: 1.559280
Y Loss: 0.640034
T Loss: 9.467986
Epoch 2349 
Overall Loss: 11.325003
Rec Loss: 9.791762
KL Loss: 1.533241
Y Loss: 0.641287
T Loss: 9.471119
Epoch 2399 
Overall Loss: 11.350714
Rec Loss: 9.791411
KL Loss: 1.559303
Y Loss: 0.656331
T Loss: 9.463246
Epoch 2449 
Overall Loss: 11.343902
Rec Loss: 9.786095
KL Loss: 1.557807
Y Loss: 0.644284
T Loss: 9.463953
Epoch 2499 
Overall Loss: 11.346250
Rec Loss: 9.782272
KL Loss: 1.563978
Y Loss: 0.642949
T Loss: 9.460797
Epoch 2549 
Overall Loss: 11.329835
Rec Loss: 9.795482
KL Loss: 1.534352
Y Loss: 0.645865
T Loss: 9.472550
Epoch 2599 
Overall Loss: 11.325734
Rec Loss: 9.771371
KL Loss: 1.554364
Y Loss: 0.631685
T Loss: 9.455528
Epoch 2649 
Overall Loss: 11.327895
Rec Loss: 9.749928
KL Loss: 1.577968
Y Loss: 0.630649
T Loss: 9.434603
Epoch 2699 
Overall Loss: 11.334251
Rec Loss: 9.786957
KL Loss: 1.547294
Y Loss: 0.637829
T Loss: 9.468043
Epoch 2749 
Overall Loss: 11.310475
Rec Loss: 9.777199
KL Loss: 1.533276
Y Loss: 0.634028
T Loss: 9.460185
Epoch 2799 
Overall Loss: 11.346783
Rec Loss: 9.771162
KL Loss: 1.575621
Y Loss: 0.630384
T Loss: 9.455970
Epoch 2849 
Overall Loss: 11.305824
Rec Loss: 9.769378
KL Loss: 1.536446
Y Loss: 0.644456
T Loss: 9.447150
Epoch 2899 
Overall Loss: 11.311852
Rec Loss: 9.772819
KL Loss: 1.539032
Y Loss: 0.626562
T Loss: 9.459538
Epoch 2949 
Overall Loss: 11.323552
Rec Loss: 9.759561
KL Loss: 1.563991
Y Loss: 0.617834
T Loss: 9.450643
Epoch 2999 
Overall Loss: 11.332649
Rec Loss: 9.794787
KL Loss: 1.537861
Y Loss: 0.641714
T Loss: 9.473931
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.790159
Epoch 99
Rec Loss: 0.793006
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.746724
Epoch 99
Rec Loss: 9.743227
Epoch 149
Rec Loss: 9.720127
Epoch 199
Rec Loss: 9.727276
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.728103
Insample Error: 1.886027
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.067383
Epoch 99
Rec Loss: 4.067153
Epoch 149
Rec Loss: 4.072432
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.456729
Epoch 99
Rec Loss: 9.430447
Epoch 149
Rec Loss: 9.379119
Epoch 199
Rec Loss: 9.458064
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.966248
Insample Error 2.806654
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.425396
Epoch 99 
Prediction Loss: 1.137625
Epoch 149 
Prediction Loss: 1.069622
Epoch 199 
Prediction Loss: 1.020616
Epoch 249 
Prediction Loss: 1.006360
Epoch 299 
Prediction Loss: 0.983662
Epoch 349 
Prediction Loss: 0.982559
Epoch 399 
Prediction Loss: 0.964648
Epoch 449 
Prediction Loss: 0.974306
Epoch 499 
Prediction Loss: 0.986611
Epoch 549 
Prediction Loss: 0.948691
Epoch 599 
Prediction Loss: 0.952660
Epoch 649 
Prediction Loss: 0.950003
Epoch 699 
Prediction Loss: 0.931634
Epoch 749 
Prediction Loss: 0.923290
Epoch 799 
Prediction Loss: 0.930141
Epoch 849 
Prediction Loss: 0.929673
Epoch 899 
Prediction Loss: 0.920045
Epoch 949 
Prediction Loss: 0.906713
Epoch 999 
Prediction Loss: 0.928657
Epoch 1049 
Prediction Loss: 0.898393
Epoch 1099 
Prediction Loss: 0.894532
Epoch 1149 
Prediction Loss: 0.896966
Epoch 1199 
Prediction Loss: 0.894156
Epoch 1249 
Prediction Loss: 0.890936
Epoch 1299 
Prediction Loss: 0.896808
Epoch 1349 
Prediction Loss: 0.880863
Epoch 1399 
Prediction Loss: 0.873649
Epoch 1449 
Prediction Loss: 0.877031
Epoch 1499 
Prediction Loss: 0.876536
Epoch 1549 
Prediction Loss: 0.867268
Epoch 1599 
Prediction Loss: 0.859220
Epoch 1649 
Prediction Loss: 0.871011
Epoch 1699 
Prediction Loss: 0.853226
Epoch 1749 
Prediction Loss: 0.845736
Epoch 1799 
Prediction Loss: 0.843345
Epoch 1849 
Prediction Loss: 0.845071
Epoch 1899 
Prediction Loss: 0.845060
Epoch 1949 
Prediction Loss: 0.859823
Epoch 1999 
Prediction Loss: 0.834661
Epoch 2049 
Prediction Loss: 0.831371
Epoch 2099 
Prediction Loss: 0.828350
Epoch 2149 
Prediction Loss: 0.835220
Epoch 2199 
Prediction Loss: 0.820969
Epoch 2249 
Prediction Loss: 0.816668
Epoch 2299 
Prediction Loss: 0.814613
Epoch 2349 
Prediction Loss: 0.818294
Epoch 2399 
Prediction Loss: 0.809472
Epoch 2449 
Prediction Loss: 0.803750
Epoch 2499 
Prediction Loss: 0.815794
Epoch 2549 
Prediction Loss: 0.795656
Epoch 2599 
Prediction Loss: 0.791689
Epoch 2649 
Prediction Loss: 0.793400
Epoch 2699 
Prediction Loss: 0.785590
Epoch 2749 
Prediction Loss: 0.785037
Epoch 2799 
Prediction Loss: 0.780755
Epoch 2849 
Prediction Loss: 0.807240
Epoch 2899 
Prediction Loss: 0.772913
Epoch 2949 
Prediction Loss: 0.775589
Epoch 2999 
Prediction Loss: 0.772797
Epoch 3049 
Prediction Loss: 0.770234
Epoch 3099 
Prediction Loss: 0.771272
Epoch 3149 
Prediction Loss: 0.759305
Epoch 3199 
Prediction Loss: 0.765078
Epoch 3249 
Prediction Loss: 0.757339
Epoch 3299 
Prediction Loss: 0.746375
Epoch 3349 
Prediction Loss: 0.739622
Epoch 3399 
Prediction Loss: 0.744473
Epoch 3449 
Prediction Loss: 0.737902
Epoch 3499 
Prediction Loss: 0.737211
Epoch 3549 
Prediction Loss: 0.737174
Epoch 3599 
Prediction Loss: 0.734027
Epoch 3649 
Prediction Loss: 0.745358
Epoch 3699 
Prediction Loss: 0.725611
Epoch 3749 
Prediction Loss: 0.720345
Epoch 3799 
Prediction Loss: 0.717515
Epoch 3849 
Prediction Loss: 0.724727
Epoch 3899 
Prediction Loss: 0.729606
Epoch 3949 
Prediction Loss: 0.715211
Epoch 3999 
Prediction Loss: 0.708396
Epoch 4049 
Prediction Loss: 0.701575
Epoch 4099 
Prediction Loss: 0.699149
Epoch 4149 
Prediction Loss: 0.696779
Epoch 4199 
Prediction Loss: 0.694774
Epoch 4249 
Prediction Loss: 0.698352
Epoch 4299 
Prediction Loss: 0.693208
Epoch 4349 
Prediction Loss: 0.696529
Epoch 4399 
Prediction Loss: 0.689440
Epoch 4449 
Prediction Loss: 0.681543
Epoch 4499 
Prediction Loss: 0.683852
Epoch 4549 
Prediction Loss: 0.683496
Epoch 4599 
Prediction Loss: 0.684085
Epoch 4649 
Prediction Loss: 0.674533
Epoch 4699 
Prediction Loss: 0.679319
Epoch 4749 
Prediction Loss: 0.666993
Epoch 4799 
Prediction Loss: 0.669996
Epoch 4849 
Prediction Loss: 0.678884
Epoch 4899 
Prediction Loss: 0.673048
Epoch 4949 
Prediction Loss: 0.658922
Epoch 4999 
Prediction Loss: 0.674871
Epoch 5049 
Prediction Loss: 0.659510
Epoch 5099 
Prediction Loss: 0.650326
Epoch 5149 
Prediction Loss: 0.652936
Epoch 5199 
Prediction Loss: 0.648818
Epoch 5249 
Prediction Loss: 0.653692
Epoch 5299 
Prediction Loss: 0.645161
Epoch 5349 
Prediction Loss: 0.640441
Epoch 5399 
Prediction Loss: 0.646627
Epoch 5449 
Prediction Loss: 0.641820
Epoch 5499 
Prediction Loss: 0.643208
Epoch 5549 
Prediction Loss: 0.638401
Epoch 5599 
Prediction Loss: 0.629641
Epoch 5649 
Prediction Loss: 0.625223
Epoch 5699 
Prediction Loss: 0.629344
Epoch 5749 
Prediction Loss: 0.627628
Epoch 5799 
Prediction Loss: 0.627098
Epoch 5849 
Prediction Loss: 0.621242
Epoch 5899 
Prediction Loss: 0.622151
Epoch 5949 
Prediction Loss: 0.617221
Epoch 5999 
Prediction Loss: 0.620668
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.786531
Insample Error 2.265740
Ours, Train RMSE
0.7293, 
0.7190, 
0.7311, 
0.7358, 
0.7281, 
CEVAE, Train RMSE
2.9716, 
2.9761, 
3.0184, 
2.9715, 
2.9662, 
Ours, Insample RMSE
1.8928, 
2.0060, 
1.8870, 
1.9525, 
1.8860, 
CEVAE, Insample RMSE
2.7975, 
2.8100, 
2.8017, 
2.8024, 
2.8067, 
Direct Regression, Insample RMSE
2.2908, 
2.2819, 
2.3117, 
2.2506, 
2.2657, 
Train, RMSE mean 0.7286 std 0.0055
CEVAE, RMSE mean 2.9808 std 0.0191
Ours, RMSE mean 1.9249 std 0.0476, reconstruct confounder 0.7928 (0.0052) noise 9.7218 (0.0012)
CEVAE, RMSE mean 2.8037 std 0.0043, reconstruct confounder 4.0623 (0.0081) noise 8.9688 (0.4374)
Direct Regression, RMSE mean 2.2801 std 0.0209
Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=4, mask=0, nlayer=50, obsm=2, stop=2000, ycof=0.5, ylayer=50)
Y Mean 1.776465, Std 3.501489 
Test Y Mean -0.006496, Std 3.341313 
Observe confounder 2, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.262717
Rec Loss: 10.119638
KL Loss: 2.143080
Y Loss: 0.988319
T Loss: 9.625478
Epoch 99 
Overall Loss: 12.055457
Rec Loss: 10.124345
KL Loss: 1.931113
Y Loss: 0.980725
T Loss: 9.633982
Epoch 149 
Overall Loss: 11.967485
Rec Loss: 10.151783
KL Loss: 1.815702
Y Loss: 0.990791
T Loss: 9.656388
Epoch 199 
Overall Loss: 11.924707
Rec Loss: 10.118680
KL Loss: 1.806027
Y Loss: 0.998406
T Loss: 9.619477
Epoch 249 
Overall Loss: 11.921117
Rec Loss: 10.134435
KL Loss: 1.786682
Y Loss: 1.004647
T Loss: 9.632111
Epoch 299 
Overall Loss: 11.906261
Rec Loss: 10.118361
KL Loss: 1.787900
Y Loss: 1.013168
T Loss: 9.611777
Epoch 349 
Overall Loss: 11.876604
Rec Loss: 10.119949
KL Loss: 1.756656
Y Loss: 1.002462
T Loss: 9.618718
Epoch 399 
Overall Loss: 11.846253
Rec Loss: 10.101223
KL Loss: 1.745030
Y Loss: 0.990324
T Loss: 9.606061
Epoch 449 
Overall Loss: 11.856223
Rec Loss: 10.101587
KL Loss: 1.754636
Y Loss: 0.973944
T Loss: 9.614614
Epoch 499 
Overall Loss: 11.839521
Rec Loss: 10.104992
KL Loss: 1.734528
Y Loss: 0.982119
T Loss: 9.613932
Epoch 549 
Overall Loss: 11.829849
Rec Loss: 10.092575
KL Loss: 1.737275
Y Loss: 0.972178
T Loss: 9.606485
Epoch 599 
Overall Loss: 11.846081
Rec Loss: 10.098244
KL Loss: 1.747837
Y Loss: 0.971909
T Loss: 9.612289
Epoch 649 
Overall Loss: 11.839098
Rec Loss: 10.080887
KL Loss: 1.758210
Y Loss: 0.955612
T Loss: 9.603081
Epoch 699 
Overall Loss: 11.843959
Rec Loss: 10.100274
KL Loss: 1.743685
Y Loss: 0.964850
T Loss: 9.617849
Epoch 749 
Overall Loss: 11.827202
Rec Loss: 10.098760
KL Loss: 1.728442
Y Loss: 0.983821
T Loss: 9.606850
Epoch 799 
Overall Loss: 11.819582
Rec Loss: 10.072972
KL Loss: 1.746610
Y Loss: 0.963231
T Loss: 9.591357
Epoch 849 
Overall Loss: 11.807254
Rec Loss: 10.068130
KL Loss: 1.739124
Y Loss: 0.958085
T Loss: 9.589087
Epoch 899 
Overall Loss: 11.832376
Rec Loss: 10.078845
KL Loss: 1.753532
Y Loss: 0.958294
T Loss: 9.599697
Epoch 949 
Overall Loss: 11.821722
Rec Loss: 10.068722
KL Loss: 1.752999
Y Loss: 0.951477
T Loss: 9.592984
Epoch 999 
Overall Loss: 11.798391
Rec Loss: 10.060973
KL Loss: 1.737417
Y Loss: 0.945548
T Loss: 9.588199
Epoch 1049 
Overall Loss: 11.802855
Rec Loss: 10.045853
KL Loss: 1.757003
Y Loss: 0.940917
T Loss: 9.575394
Epoch 1099 
Overall Loss: 11.811552
Rec Loss: 10.070028
KL Loss: 1.741524
Y Loss: 0.951870
T Loss: 9.594093
Epoch 1149 
Overall Loss: 11.785905
Rec Loss: 10.054125
KL Loss: 1.731780
Y Loss: 0.947635
T Loss: 9.580307
Epoch 1199 
Overall Loss: 11.810154
Rec Loss: 10.063279
KL Loss: 1.746875
Y Loss: 0.955244
T Loss: 9.585658
Epoch 1249 
Overall Loss: 11.798474
Rec Loss: 10.078287
KL Loss: 1.720187
Y Loss: 0.950517
T Loss: 9.603028
Epoch 1299 
Overall Loss: 11.768494
Rec Loss: 10.042581
KL Loss: 1.725913
Y Loss: 0.921256
T Loss: 9.581953
Epoch 1349 
Overall Loss: 11.759440
Rec Loss: 10.049400
KL Loss: 1.710040
Y Loss: 0.929910
T Loss: 9.584445
Epoch 1399 
Overall Loss: 11.783559
Rec Loss: 10.051472
KL Loss: 1.732087
Y Loss: 0.944360
T Loss: 9.579292
Epoch 1449 
Overall Loss: 11.776036
Rec Loss: 10.030585
KL Loss: 1.745451
Y Loss: 0.926108
T Loss: 9.567531
Epoch 1499 
Overall Loss: 11.767631
Rec Loss: 10.029731
KL Loss: 1.737900
Y Loss: 0.914330
T Loss: 9.572566
Epoch 1549 
Overall Loss: 11.771830
Rec Loss: 10.038683
KL Loss: 1.733147
Y Loss: 0.925573
T Loss: 9.575896
Epoch 1599 
Overall Loss: 11.767472
Rec Loss: 10.034003
KL Loss: 1.733469
Y Loss: 0.927584
T Loss: 9.570211
Epoch 1649 
Overall Loss: 11.745174
Rec Loss: 10.025885
KL Loss: 1.719289
Y Loss: 0.913423
T Loss: 9.569173
Epoch 1699 
Overall Loss: 11.763185
Rec Loss: 10.028994
KL Loss: 1.734191
Y Loss: 0.907893
T Loss: 9.575047
Epoch 1749 
Overall Loss: 11.756249
Rec Loss: 10.044537
KL Loss: 1.711712
Y Loss: 0.926022
T Loss: 9.581527
Epoch 1799 
Overall Loss: 11.761034
Rec Loss: 10.020659
KL Loss: 1.740374
Y Loss: 0.913761
T Loss: 9.563779
Epoch 1849 
Overall Loss: 11.759058
Rec Loss: 10.040316
KL Loss: 1.718743
Y Loss: 0.914596
T Loss: 9.583018
Epoch 1899 
Overall Loss: 11.753281
Rec Loss: 10.033324
KL Loss: 1.719957
Y Loss: 0.917541
T Loss: 9.574553
Epoch 1949 
Overall Loss: 11.767752
Rec Loss: 10.025621
KL Loss: 1.742131
Y Loss: 0.908196
T Loss: 9.571523
Epoch 1999 
Overall Loss: 11.764999
Rec Loss: 10.012862
KL Loss: 1.752138
Y Loss: 0.926661
T Loss: 9.549532
Epoch 2049 
Overall Loss: 11.755819
Rec Loss: 10.015359
KL Loss: 1.740460
Y Loss: 0.915134
T Loss: 9.557792
Epoch 2099 
Overall Loss: 11.752693
Rec Loss: 10.008972
KL Loss: 1.743721
Y Loss: 0.912298
T Loss: 9.552823
Epoch 2149 
Overall Loss: 11.743563
Rec Loss: 10.001302
KL Loss: 1.742261
Y Loss: 0.912840
T Loss: 9.544882
Epoch 2199 
Overall Loss: 11.765575
Rec Loss: 10.037308
KL Loss: 1.728267
Y Loss: 0.918655
T Loss: 9.577981
Epoch 2249 
Overall Loss: 11.739975
Rec Loss: 10.021153
KL Loss: 1.718822
Y Loss: 0.913306
T Loss: 9.564500
Epoch 2299 
Overall Loss: 11.756261
Rec Loss: 10.018310
KL Loss: 1.737951
Y Loss: 0.907541
T Loss: 9.564539
Epoch 2349 
Overall Loss: 11.735951
Rec Loss: 10.002774
KL Loss: 1.733177
Y Loss: 0.914322
T Loss: 9.545613
Epoch 2399 
Overall Loss: 11.746910
Rec Loss: 10.001529
KL Loss: 1.745381
Y Loss: 0.905424
T Loss: 9.548817
Epoch 2449 
Overall Loss: 11.721817
Rec Loss: 10.000497
KL Loss: 1.721320
Y Loss: 0.901248
T Loss: 9.549873
Epoch 2499 
Overall Loss: 11.750199
Rec Loss: 10.016406
KL Loss: 1.733793
Y Loss: 0.923103
T Loss: 9.554854
Epoch 2549 
Overall Loss: 11.731729
Rec Loss: 9.983589
KL Loss: 1.748140
Y Loss: 0.917743
T Loss: 9.524717
Epoch 2599 
Overall Loss: 11.745800
Rec Loss: 10.032652
KL Loss: 1.713148
Y Loss: 0.928511
T Loss: 9.568397
Epoch 2649 
Overall Loss: 11.757198
Rec Loss: 10.000160
KL Loss: 1.757038
Y Loss: 0.912143
T Loss: 9.544089
Epoch 2699 
Overall Loss: 11.721001
Rec Loss: 10.016653
KL Loss: 1.704348
Y Loss: 0.919041
T Loss: 9.557133
Epoch 2749 
Overall Loss: 11.744206
Rec Loss: 10.005268
KL Loss: 1.738939
Y Loss: 0.937910
T Loss: 9.536312
Epoch 2799 
Overall Loss: 11.732653
Rec Loss: 10.014099
KL Loss: 1.718554
Y Loss: 0.908835
T Loss: 9.559681
Epoch 2849 
Overall Loss: 11.709854
Rec Loss: 10.007353
KL Loss: 1.702500
Y Loss: 0.911431
T Loss: 9.551638
Epoch 2899 
Overall Loss: 11.726968
Rec Loss: 9.987883
KL Loss: 1.739085
Y Loss: 0.900421
T Loss: 9.537672
Epoch 2949 
Overall Loss: 11.723269
Rec Loss: 10.011206
KL Loss: 1.712063
Y Loss: 0.923791
T Loss: 9.549311
Epoch 2999 
Overall Loss: 11.713442
Rec Loss: 10.002177
KL Loss: 1.711266
Y Loss: 0.922234
T Loss: 9.541060
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.714139
Epoch 99
Rec Loss: 0.732221
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.185766
Epoch 99
Rec Loss: 10.193589
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.768846
Insample Error: 2.036853
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.967098
Epoch 99
Rec Loss: 3.966841
Epoch 149
Rec Loss: 3.970879
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.401864
Epoch 99
Rec Loss: 9.281151
Epoch 149
Rec Loss: 9.260478
Epoch 199
Rec Loss: 9.323100
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.765865
Insample Error 3.337424
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.561872
Epoch 99 
Prediction Loss: 2.159276
Epoch 149 
Prediction Loss: 2.039397
Epoch 199 
Prediction Loss: 2.015912
Epoch 249 
Prediction Loss: 1.975683
Epoch 299 
Prediction Loss: 1.945370
Epoch 349 
Prediction Loss: 1.920098
Epoch 399 
Prediction Loss: 1.908551
Epoch 449 
Prediction Loss: 1.893916
Epoch 499 
Prediction Loss: 1.894583
Epoch 549 
Prediction Loss: 1.870457
Epoch 599 
Prediction Loss: 1.870031
Epoch 649 
Prediction Loss: 1.866673
Epoch 699 
Prediction Loss: 1.838813
Epoch 749 
Prediction Loss: 1.832951
Epoch 799 
Prediction Loss: 1.815166
Epoch 849 
Prediction Loss: 1.814485
Epoch 899 
Prediction Loss: 1.790750
Epoch 949 
Prediction Loss: 1.799525
Epoch 999 
Prediction Loss: 1.777052
Epoch 1049 
Prediction Loss: 1.774266
Epoch 1099 
Prediction Loss: 1.794196
Epoch 1149 
Prediction Loss: 1.752099
Epoch 1199 
Prediction Loss: 1.752105
Epoch 1249 
Prediction Loss: 1.738527
Epoch 1299 
Prediction Loss: 1.730164
Epoch 1349 
Prediction Loss: 1.731922
Epoch 1399 
Prediction Loss: 1.746679
Epoch 1449 
Prediction Loss: 1.706204
Epoch 1499 
Prediction Loss: 1.732228
Epoch 1549 
Prediction Loss: 1.693179
Epoch 1599 
Prediction Loss: 1.693154
Epoch 1649 
Prediction Loss: 1.686556
Epoch 1699 
Prediction Loss: 1.675681
Epoch 1749 
Prediction Loss: 1.670925
Epoch 1799 
Prediction Loss: 1.654965
Epoch 1849 
Prediction Loss: 1.655307
Epoch 1899 
Prediction Loss: 1.647657
Epoch 1949 
Prediction Loss: 1.634690
Epoch 1999 
Prediction Loss: 1.639131
Epoch 2049 
Prediction Loss: 1.637158
Epoch 2099 
Prediction Loss: 1.627796
Epoch 2149 
Prediction Loss: 1.604170
Epoch 2199 
Prediction Loss: 1.601082
Epoch 2249 
Prediction Loss: 1.586211
Epoch 2299 
Prediction Loss: 1.581903
Epoch 2349 
Prediction Loss: 1.582204
Epoch 2399 
Prediction Loss: 1.579078
Epoch 2449 
Prediction Loss: 1.568629
Epoch 2499 
Prediction Loss: 1.553761
Epoch 2549 
Prediction Loss: 1.547851
Epoch 2599 
Prediction Loss: 1.565932
Epoch 2649 
Prediction Loss: 1.532466
Epoch 2699 
Prediction Loss: 1.525909
Epoch 2749 
Prediction Loss: 1.552299
Epoch 2799 
Prediction Loss: 1.521717
Epoch 2849 
Prediction Loss: 1.513246
Epoch 2899 
Prediction Loss: 1.499530
Epoch 2949 
Prediction Loss: 1.491294
Epoch 2999 
Prediction Loss: 1.492093
Epoch 3049 
Prediction Loss: 1.490425
Epoch 3099 
Prediction Loss: 1.472492
Epoch 3149 
Prediction Loss: 1.480354
Epoch 3199 
Prediction Loss: 1.462332
Epoch 3249 
Prediction Loss: 1.455521
Epoch 3299 
Prediction Loss: 1.470688
Epoch 3349 
Prediction Loss: 1.460434
Epoch 3399 
Prediction Loss: 1.440764
Epoch 3449 
Prediction Loss: 1.446560
Epoch 3499 
Prediction Loss: 1.464228
Epoch 3549 
Prediction Loss: 1.424699
Epoch 3599 
Prediction Loss: 1.414534
Epoch 3649 
Prediction Loss: 1.421107
Epoch 3699 
Prediction Loss: 1.405986
Epoch 3749 
Prediction Loss: 1.396032
Epoch 3799 
Prediction Loss: 1.390154
Epoch 3849 
Prediction Loss: 1.393056
Epoch 3899 
Prediction Loss: 1.381201
Epoch 3949 
Prediction Loss: 1.382378
Epoch 3999 
Prediction Loss: 1.369437
Epoch 4049 
Prediction Loss: 1.365656
Epoch 4099 
Prediction Loss: 1.368798
Epoch 4149 
Prediction Loss: 1.347325
Epoch 4199 
Prediction Loss: 1.371598
Epoch 4249 
Prediction Loss: 1.343210
Epoch 4299 
Prediction Loss: 1.338619
Epoch 4349 
Prediction Loss: 1.345898
Epoch 4399 
Prediction Loss: 1.328926
Epoch 4449 
Prediction Loss: 1.333910
Epoch 4499 
Prediction Loss: 1.330662
Epoch 4549 
Prediction Loss: 1.313747
Epoch 4599 
Prediction Loss: 1.316130
Epoch 4649 
Prediction Loss: 1.311206
Epoch 4699 
Prediction Loss: 1.300584
Epoch 4749 
Prediction Loss: 1.302649
Epoch 4799 
Prediction Loss: 1.320405
Epoch 4849 
Prediction Loss: 1.284712
Epoch 4899 
Prediction Loss: 1.296473
Epoch 4949 
Prediction Loss: 1.280736
Epoch 4999 
Prediction Loss: 1.286612
Epoch 5049 
Prediction Loss: 1.289625
Epoch 5099 
Prediction Loss: 1.259438
Epoch 5149 
Prediction Loss: 1.273057
Epoch 5199 
Prediction Loss: 1.272804
Epoch 5249 
Prediction Loss: 1.243542
Epoch 5299 
Prediction Loss: 1.242701
Epoch 5349 
Prediction Loss: 1.268969
Epoch 5399 
Prediction Loss: 1.239556
Epoch 5449 
Prediction Loss: 1.235594
Epoch 5499 
Prediction Loss: 1.245233
Epoch 5549 
Prediction Loss: 1.227614
Epoch 5599 
Prediction Loss: 1.246382
Epoch 5649 
Prediction Loss: 1.222881
Epoch 5699 
Prediction Loss: 1.209488
Epoch 5749 
Prediction Loss: 1.208951
Epoch 5799 
Prediction Loss: 1.206206
Epoch 5849 
Prediction Loss: 1.215488
Epoch 5899 
Prediction Loss: 1.193201
Epoch 5949 
Prediction Loss: 1.189029
Epoch 5999 
Prediction Loss: 1.193446
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.097774
Insample Error 3.120694
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.215818
Rec Loss: 10.091623
KL Loss: 2.124195
Y Loss: 0.985081
T Loss: 9.599083
Epoch 99 
Overall Loss: 12.027053
Rec Loss: 10.139653
KL Loss: 1.887400
Y Loss: 1.010553
T Loss: 9.634376
Epoch 149 
Overall Loss: 11.972668
Rec Loss: 10.136754
KL Loss: 1.835914
Y Loss: 1.002942
T Loss: 9.635284
Epoch 199 
Overall Loss: 11.921851
Rec Loss: 10.123071
KL Loss: 1.798780
Y Loss: 0.969375
T Loss: 9.638383
Epoch 249 
Overall Loss: 11.918414
Rec Loss: 10.127518
KL Loss: 1.790897
Y Loss: 1.012882
T Loss: 9.621077
Epoch 299 
Overall Loss: 11.873340
Rec Loss: 10.119822
KL Loss: 1.753518
Y Loss: 0.997444
T Loss: 9.621100
Epoch 349 
Overall Loss: 11.853637
Rec Loss: 10.088747
KL Loss: 1.764890
Y Loss: 0.986725
T Loss: 9.595385
Epoch 399 
Overall Loss: 11.861904
Rec Loss: 10.081801
KL Loss: 1.780103
Y Loss: 0.981413
T Loss: 9.591095
Epoch 449 
Overall Loss: 11.832680
Rec Loss: 10.081440
KL Loss: 1.751240
Y Loss: 0.960866
T Loss: 9.601007
Epoch 499 
Overall Loss: 11.844259
Rec Loss: 10.092071
KL Loss: 1.752188
Y Loss: 0.968775
T Loss: 9.607684
Epoch 549 
Overall Loss: 11.846024
Rec Loss: 10.115003
KL Loss: 1.731021
Y Loss: 0.977814
T Loss: 9.626096
Epoch 599 
Overall Loss: 11.827678
Rec Loss: 10.100313
KL Loss: 1.727365
Y Loss: 0.996395
T Loss: 9.602115
Epoch 649 
Overall Loss: 11.810773
Rec Loss: 10.073889
KL Loss: 1.736885
Y Loss: 0.940029
T Loss: 9.603874
Epoch 699 
Overall Loss: 11.826093
Rec Loss: 10.106711
KL Loss: 1.719382
Y Loss: 0.986911
T Loss: 9.613255
Epoch 749 
Overall Loss: 11.834326
Rec Loss: 10.080444
KL Loss: 1.753883
Y Loss: 0.987396
T Loss: 9.586745
Epoch 799 
Overall Loss: 11.811934
Rec Loss: 10.072144
KL Loss: 1.739790
Y Loss: 0.969283
T Loss: 9.587502
Epoch 849 
Overall Loss: 11.824201
Rec Loss: 10.104998
KL Loss: 1.719203
Y Loss: 0.979451
T Loss: 9.615272
Epoch 899 
Overall Loss: 11.802124
Rec Loss: 10.061754
KL Loss: 1.740370
Y Loss: 0.964934
T Loss: 9.579287
Epoch 949 
Overall Loss: 11.788470
Rec Loss: 10.071988
KL Loss: 1.716482
Y Loss: 0.945410
T Loss: 9.599283
Epoch 999 
Overall Loss: 11.800070
Rec Loss: 10.061346
KL Loss: 1.738725
Y Loss: 0.936277
T Loss: 9.593207
Epoch 1049 
Overall Loss: 11.803946
Rec Loss: 10.078684
KL Loss: 1.725262
Y Loss: 0.946416
T Loss: 9.605476
Epoch 1099 
Overall Loss: 11.795580
Rec Loss: 10.055269
KL Loss: 1.740312
Y Loss: 0.925244
T Loss: 9.592646
Epoch 1149 
Overall Loss: 11.776770
Rec Loss: 10.053185
KL Loss: 1.723585
Y Loss: 0.959613
T Loss: 9.573379
Epoch 1199 
Overall Loss: 11.778466
Rec Loss: 10.048723
KL Loss: 1.729743
Y Loss: 0.951989
T Loss: 9.572728
Epoch 1249 
Overall Loss: 11.805962
Rec Loss: 10.076835
KL Loss: 1.729127
Y Loss: 0.950355
T Loss: 9.601658
Epoch 1299 
Overall Loss: 11.807625
Rec Loss: 10.054055
KL Loss: 1.753570
Y Loss: 0.936752
T Loss: 9.585678
Epoch 1349 
Overall Loss: 11.802102
Rec Loss: 10.064267
KL Loss: 1.737835
Y Loss: 0.954786
T Loss: 9.586875
Epoch 1399 
Overall Loss: 11.783740
Rec Loss: 10.045108
KL Loss: 1.738632
Y Loss: 0.933253
T Loss: 9.578482
Epoch 1449 
Overall Loss: 11.772789
Rec Loss: 10.057960
KL Loss: 1.714829
Y Loss: 0.962016
T Loss: 9.576952
Epoch 1499 
Overall Loss: 11.807379
Rec Loss: 10.062548
KL Loss: 1.744830
Y Loss: 0.945597
T Loss: 9.589750
Epoch 1549 
Overall Loss: 11.770016
Rec Loss: 10.016291
KL Loss: 1.753726
Y Loss: 0.926444
T Loss: 9.553069
Epoch 1599 
Overall Loss: 11.770304
Rec Loss: 10.041039
KL Loss: 1.729266
Y Loss: 0.917812
T Loss: 9.582132
Epoch 1649 
Overall Loss: 11.766618
Rec Loss: 10.045017
KL Loss: 1.721601
Y Loss: 0.943290
T Loss: 9.573372
Epoch 1699 
Overall Loss: 11.774375
Rec Loss: 10.032198
KL Loss: 1.742177
Y Loss: 0.934342
T Loss: 9.565027
Epoch 1749 
Overall Loss: 11.771648
Rec Loss: 10.047944
KL Loss: 1.723704
Y Loss: 0.936071
T Loss: 9.579908
Epoch 1799 
Overall Loss: 11.752129
Rec Loss: 10.018350
KL Loss: 1.733779
Y Loss: 0.929898
T Loss: 9.553401
Epoch 1849 
Overall Loss: 11.779185
Rec Loss: 10.040444
KL Loss: 1.738741
Y Loss: 0.930228
T Loss: 9.575330
Epoch 1899 
Overall Loss: 11.751493
Rec Loss: 10.027927
KL Loss: 1.723566
Y Loss: 0.947392
T Loss: 9.554232
Epoch 1949 
Overall Loss: 11.764584
Rec Loss: 10.030324
KL Loss: 1.734259
Y Loss: 0.950825
T Loss: 9.554912
Epoch 1999 
Overall Loss: 11.759221
Rec Loss: 10.039387
KL Loss: 1.719835
Y Loss: 0.921606
T Loss: 9.578584
Epoch 2049 
Overall Loss: 11.751692
Rec Loss: 10.032987
KL Loss: 1.718704
Y Loss: 0.940890
T Loss: 9.562542
Epoch 2099 
Overall Loss: 11.769779
Rec Loss: 10.029135
KL Loss: 1.740643
Y Loss: 0.940833
T Loss: 9.558719
Epoch 2149 
Overall Loss: 11.746015
Rec Loss: 10.023033
KL Loss: 1.722982
Y Loss: 0.951557
T Loss: 9.547254
Epoch 2199 
Overall Loss: 11.757795
Rec Loss: 10.042987
KL Loss: 1.714808
Y Loss: 0.942015
T Loss: 9.571980
Epoch 2249 
Overall Loss: 11.713872
Rec Loss: 10.019542
KL Loss: 1.694329
Y Loss: 0.943701
T Loss: 9.547692
Epoch 2299 
Overall Loss: 11.749580
Rec Loss: 10.001464
KL Loss: 1.748116
Y Loss: 0.914981
T Loss: 9.543974
Epoch 2349 
Overall Loss: 11.748286
Rec Loss: 10.027126
KL Loss: 1.721160
Y Loss: 0.935811
T Loss: 9.559220
Epoch 2399 
Overall Loss: 11.733591
Rec Loss: 9.990581
KL Loss: 1.743010
Y Loss: 0.900624
T Loss: 9.540269
Epoch 2449 
Overall Loss: 11.752739
Rec Loss: 10.026398
KL Loss: 1.726342
Y Loss: 0.903754
T Loss: 9.574521
Epoch 2499 
Overall Loss: 11.719201
Rec Loss: 9.996248
KL Loss: 1.722954
Y Loss: 0.906289
T Loss: 9.543103
Epoch 2549 
Overall Loss: 11.743329
Rec Loss: 10.032949
KL Loss: 1.710380
Y Loss: 0.921783
T Loss: 9.572057
Epoch 2599 
Overall Loss: 11.731724
Rec Loss: 10.012299
KL Loss: 1.719425
Y Loss: 0.904167
T Loss: 9.560215
Epoch 2649 
Overall Loss: 11.740208
Rec Loss: 10.018812
KL Loss: 1.721396
Y Loss: 0.927228
T Loss: 9.555198
Epoch 2699 
Overall Loss: 11.712267
Rec Loss: 10.008565
KL Loss: 1.703702
Y Loss: 0.905254
T Loss: 9.555938
Epoch 2749 
Overall Loss: 11.727954
Rec Loss: 9.997024
KL Loss: 1.730930
Y Loss: 0.924424
T Loss: 9.534813
Epoch 2799 
Overall Loss: 11.731928
Rec Loss: 10.019114
KL Loss: 1.712814
Y Loss: 0.927198
T Loss: 9.555515
Epoch 2849 
Overall Loss: 11.721481
Rec Loss: 10.020242
KL Loss: 1.701239
Y Loss: 0.944362
T Loss: 9.548061
Epoch 2899 
Overall Loss: 11.723041
Rec Loss: 10.007298
KL Loss: 1.715743
Y Loss: 0.929580
T Loss: 9.542508
Epoch 2949 
Overall Loss: 11.740344
Rec Loss: 10.027885
KL Loss: 1.712459
Y Loss: 0.918410
T Loss: 9.568680
Epoch 2999 
Overall Loss: 11.713167
Rec Loss: 10.006340
KL Loss: 1.706828
Y Loss: 0.912362
T Loss: 9.550158
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.712286
Epoch 99
Rec Loss: 0.705649
Epoch 149
Rec Loss: 0.703550
Epoch 199
Rec Loss: 0.713030
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.182352
Epoch 99
Rec Loss: 10.177188
Epoch 149
Rec Loss: 10.171207
Epoch 199
Rec Loss: 10.165315
Epoch 249
Rec Loss: 10.170332
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.775451
Insample Error: 1.976941
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.979138
Epoch 99
Rec Loss: 3.985790
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.997254
Epoch 99
Rec Loss: 10.065423
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.719582
Insample Error 3.346579
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.391447
Epoch 99 
Prediction Loss: 2.183043
Epoch 149 
Prediction Loss: 2.096578
Epoch 199 
Prediction Loss: 2.032554
Epoch 249 
Prediction Loss: 2.008021
Epoch 299 
Prediction Loss: 1.979978
Epoch 349 
Prediction Loss: 1.985320
Epoch 399 
Prediction Loss: 1.929258
Epoch 449 
Prediction Loss: 1.911308
Epoch 499 
Prediction Loss: 1.919603
Epoch 549 
Prediction Loss: 1.922582
Epoch 599 
Prediction Loss: 1.889307
Epoch 649 
Prediction Loss: 1.871997
Epoch 699 
Prediction Loss: 1.868386
Epoch 749 
Prediction Loss: 1.868280
Epoch 799 
Prediction Loss: 1.866025
Epoch 849 
Prediction Loss: 1.838857
Epoch 899 
Prediction Loss: 1.886061
Epoch 949 
Prediction Loss: 1.851417
Epoch 999 
Prediction Loss: 1.839665
Epoch 1049 
Prediction Loss: 1.816550
Epoch 1099 
Prediction Loss: 1.823985
Epoch 1149 
Prediction Loss: 1.819696
Epoch 1199 
Prediction Loss: 1.807877
Epoch 1249 
Prediction Loss: 1.795379
Epoch 1299 
Prediction Loss: 1.798110
Epoch 1349 
Prediction Loss: 1.792900
Epoch 1399 
Prediction Loss: 1.780592
Epoch 1449 
Prediction Loss: 1.772153
Epoch 1499 
Prediction Loss: 1.783468
Epoch 1549 
Prediction Loss: 1.761488
Epoch 1599 
Prediction Loss: 1.751080
Epoch 1649 
Prediction Loss: 1.758012
Epoch 1699 
Prediction Loss: 1.770725
Epoch 1749 
Prediction Loss: 1.753160
Epoch 1799 
Prediction Loss: 1.736275
Epoch 1849 
Prediction Loss: 1.750742
Epoch 1899 
Prediction Loss: 1.715034
Epoch 1949 
Prediction Loss: 1.718056
Epoch 1999 
Prediction Loss: 1.706941
Epoch 2049 
Prediction Loss: 1.695923
Epoch 2099 
Prediction Loss: 1.726385
Epoch 2149 
Prediction Loss: 1.687972
Epoch 2199 
Prediction Loss: 1.704275
Epoch 2249 
Prediction Loss: 1.678537
Epoch 2299 
Prediction Loss: 1.667183
Epoch 2349 
Prediction Loss: 1.714082
Epoch 2399 
Prediction Loss: 1.661950
Epoch 2449 
Prediction Loss: 1.660451
Epoch 2499 
Prediction Loss: 1.646626
Epoch 2549 
Prediction Loss: 1.638681
Epoch 2599 
Prediction Loss: 1.634419
Epoch 2649 
Prediction Loss: 1.631242
Epoch 2699 
Prediction Loss: 1.648248
Epoch 2749 
Prediction Loss: 1.622939
Epoch 2799 
Prediction Loss: 1.605766
Epoch 2849 
Prediction Loss: 1.642899
Epoch 2899 
Prediction Loss: 1.610274
Epoch 2949 
Prediction Loss: 1.612069
Epoch 2999 
Prediction Loss: 1.592723
Epoch 3049 
Prediction Loss: 1.574603
Epoch 3099 
Prediction Loss: 1.570049
Epoch 3149 
Prediction Loss: 1.589085
Epoch 3199 
Prediction Loss: 1.556683
Epoch 3249 
Prediction Loss: 1.604964
Epoch 3299 
Prediction Loss: 1.577910
Epoch 3349 
Prediction Loss: 1.547627
Epoch 3399 
Prediction Loss: 1.540476
Epoch 3449 
Prediction Loss: 1.539371
Epoch 3499 
Prediction Loss: 1.569103
Epoch 3549 
Prediction Loss: 1.535528
Epoch 3599 
Prediction Loss: 1.539883
Epoch 3649 
Prediction Loss: 1.517552
Epoch 3699 
Prediction Loss: 1.515421
Epoch 3749 
Prediction Loss: 1.501221
Epoch 3799 
Prediction Loss: 1.505939
Epoch 3849 
Prediction Loss: 1.494093
Epoch 3899 
Prediction Loss: 1.496828
Epoch 3949 
Prediction Loss: 1.478007
Epoch 3999 
Prediction Loss: 1.520748
Epoch 4049 
Prediction Loss: 1.477017
Epoch 4099 
Prediction Loss: 1.482457
Epoch 4149 
Prediction Loss: 1.471344
Epoch 4199 
Prediction Loss: 1.463489
Epoch 4249 
Prediction Loss: 1.482877
Epoch 4299 
Prediction Loss: 1.452775
Epoch 4349 
Prediction Loss: 1.447370
Epoch 4399 
Prediction Loss: 1.451941
Epoch 4449 
Prediction Loss: 1.459721
Epoch 4499 
Prediction Loss: 1.444442
Epoch 4549 
Prediction Loss: 1.432987
Epoch 4599 
Prediction Loss: 1.427399
Epoch 4649 
Prediction Loss: 1.433643
Epoch 4699 
Prediction Loss: 1.424694
Epoch 4749 
Prediction Loss: 1.464291
Epoch 4799 
Prediction Loss: 1.429934
Epoch 4849 
Prediction Loss: 1.418763
Epoch 4899 
Prediction Loss: 1.441681
Epoch 4949 
Prediction Loss: 1.406561
Epoch 4999 
Prediction Loss: 1.414502
Epoch 5049 
Prediction Loss: 1.405428
Epoch 5099 
Prediction Loss: 1.410439
Epoch 5149 
Prediction Loss: 1.386403
Epoch 5199 
Prediction Loss: 1.389102
Epoch 5249 
Prediction Loss: 1.372606
Epoch 5299 
Prediction Loss: 1.376695
Epoch 5349 
Prediction Loss: 1.371089
Epoch 5399 
Prediction Loss: 1.372624
Epoch 5449 
Prediction Loss: 1.365295
Epoch 5499 
Prediction Loss: 1.359837
Epoch 5549 
Prediction Loss: 1.374272
Epoch 5599 
Prediction Loss: 1.345138
Epoch 5649 
Prediction Loss: 1.357096
Epoch 5699 
Prediction Loss: 1.353597
Epoch 5749 
Prediction Loss: 1.363961
Epoch 5799 
Prediction Loss: 1.345690
Epoch 5849 
Prediction Loss: 1.332923
Epoch 5899 
Prediction Loss: 1.339869
Epoch 5949 
Prediction Loss: 1.385033
Epoch 5999 
Prediction Loss: 1.332192
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.153692
Insample Error 3.104357
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.260249
Rec Loss: 10.140701
KL Loss: 2.119548
Y Loss: 0.960121
T Loss: 9.660641
Epoch 99 
Overall Loss: 12.066482
Rec Loss: 10.119676
KL Loss: 1.946806
Y Loss: 0.986560
T Loss: 9.626396
Epoch 149 
Overall Loss: 11.956254
Rec Loss: 10.137742
KL Loss: 1.818512
Y Loss: 1.013359
T Loss: 9.631063
Epoch 199 
Overall Loss: 11.958168
Rec Loss: 10.148961
KL Loss: 1.809207
Y Loss: 1.021590
T Loss: 9.638166
Epoch 249 
Overall Loss: 11.903323
Rec Loss: 10.122344
KL Loss: 1.780980
Y Loss: 1.019802
T Loss: 9.612442
Epoch 299 
Overall Loss: 11.888323
Rec Loss: 10.110316
KL Loss: 1.778007
Y Loss: 0.989627
T Loss: 9.615502
Epoch 349 
Overall Loss: 11.901876
Rec Loss: 10.126874
KL Loss: 1.775002
Y Loss: 1.014969
T Loss: 9.619389
Epoch 399 
Overall Loss: 11.872433
Rec Loss: 10.125159
KL Loss: 1.747274
Y Loss: 0.978954
T Loss: 9.635682
Epoch 449 
Overall Loss: 11.851283
Rec Loss: 10.090135
KL Loss: 1.761148
Y Loss: 0.969431
T Loss: 9.605419
Epoch 499 
Overall Loss: 11.849125
Rec Loss: 10.111230
KL Loss: 1.737895
Y Loss: 0.974395
T Loss: 9.624033
Epoch 549 
Overall Loss: 11.837439
Rec Loss: 10.077224
KL Loss: 1.760215
Y Loss: 0.954641
T Loss: 9.599904
Epoch 599 
Overall Loss: 11.843025
Rec Loss: 10.091890
KL Loss: 1.751135
Y Loss: 0.961018
T Loss: 9.611382
Epoch 649 
Overall Loss: 11.837857
Rec Loss: 10.090046
KL Loss: 1.747811
Y Loss: 0.988201
T Loss: 9.595946
Epoch 699 
Overall Loss: 11.832898
Rec Loss: 10.067780
KL Loss: 1.765118
Y Loss: 0.965689
T Loss: 9.584936
Epoch 749 
Overall Loss: 11.824906
Rec Loss: 10.056699
KL Loss: 1.768207
Y Loss: 0.957764
T Loss: 9.577818
Epoch 799 
Overall Loss: 11.787589
Rec Loss: 10.063498
KL Loss: 1.724092
Y Loss: 0.928979
T Loss: 9.599008
Epoch 849 
Overall Loss: 11.810993
Rec Loss: 10.093231
KL Loss: 1.717762
Y Loss: 0.963183
T Loss: 9.611640
Epoch 899 
Overall Loss: 11.810657
Rec Loss: 10.075285
KL Loss: 1.735372
Y Loss: 0.947868
T Loss: 9.601351
Epoch 949 
Overall Loss: 11.812440
Rec Loss: 10.045011
KL Loss: 1.767429
Y Loss: 0.924073
T Loss: 9.582975
Epoch 999 
Overall Loss: 11.808967
Rec Loss: 10.072485
KL Loss: 1.736482
Y Loss: 0.943023
T Loss: 9.600974
Epoch 1049 
Overall Loss: 11.822139
Rec Loss: 10.053033
KL Loss: 1.769107
Y Loss: 0.941199
T Loss: 9.582433
Epoch 1099 
Overall Loss: 11.803262
Rec Loss: 10.086937
KL Loss: 1.716325
Y Loss: 0.973233
T Loss: 9.600320
Epoch 1149 
Overall Loss: 11.778274
Rec Loss: 10.049592
KL Loss: 1.728682
Y Loss: 0.913117
T Loss: 9.593034
Epoch 1199 
Overall Loss: 11.780520
Rec Loss: 10.052039
KL Loss: 1.728481
Y Loss: 0.924765
T Loss: 9.589656
Epoch 1249 
Overall Loss: 11.789625
Rec Loss: 10.046492
KL Loss: 1.743133
Y Loss: 0.931220
T Loss: 9.580882
Epoch 1299 
Overall Loss: 11.800881
Rec Loss: 10.062768
KL Loss: 1.738114
Y Loss: 0.910480
T Loss: 9.607528
Epoch 1349 
Overall Loss: 11.774749
Rec Loss: 10.036228
KL Loss: 1.738521
Y Loss: 0.938258
T Loss: 9.567099
Epoch 1399 
Overall Loss: 11.793369
Rec Loss: 10.057773
KL Loss: 1.735597
Y Loss: 0.909487
T Loss: 9.603030
Epoch 1449 
Overall Loss: 11.795374
Rec Loss: 10.066769
KL Loss: 1.728606
Y Loss: 0.963966
T Loss: 9.584785
Epoch 1499 
Overall Loss: 11.768521
Rec Loss: 10.045378
KL Loss: 1.723143
Y Loss: 0.955501
T Loss: 9.567628
Epoch 1549 
Overall Loss: 11.762150
Rec Loss: 10.033106
KL Loss: 1.729044
Y Loss: 0.954222
T Loss: 9.555995
Epoch 1599 
Overall Loss: 11.765111
Rec Loss: 10.024397
KL Loss: 1.740714
Y Loss: 0.915463
T Loss: 9.566665
Epoch 1649 
Overall Loss: 11.773924
Rec Loss: 10.047904
KL Loss: 1.726020
Y Loss: 0.931435
T Loss: 9.582187
Epoch 1699 
Overall Loss: 11.771541
Rec Loss: 10.040141
KL Loss: 1.731400
Y Loss: 0.919431
T Loss: 9.580426
Epoch 1749 
Overall Loss: 11.747746
Rec Loss: 10.016594
KL Loss: 1.731152
Y Loss: 0.915795
T Loss: 9.558697
Epoch 1799 
Overall Loss: 11.755296
Rec Loss: 10.038132
KL Loss: 1.717163
Y Loss: 0.942122
T Loss: 9.567071
Epoch 1849 
Overall Loss: 11.751722
Rec Loss: 10.014423
KL Loss: 1.737299
Y Loss: 0.899506
T Loss: 9.564669
Epoch 1899 
Overall Loss: 11.749982
Rec Loss: 10.017635
KL Loss: 1.732346
Y Loss: 0.921054
T Loss: 9.557108
Epoch 1949 
Overall Loss: 11.776750
Rec Loss: 10.037359
KL Loss: 1.739392
Y Loss: 0.927554
T Loss: 9.573582
Epoch 1999 
Overall Loss: 11.749940
Rec Loss: 10.031204
KL Loss: 1.718736
Y Loss: 0.917545
T Loss: 9.572431
Epoch 2049 
Overall Loss: 11.778973
Rec Loss: 10.042026
KL Loss: 1.736946
Y Loss: 0.930362
T Loss: 9.576846
Epoch 2099 
Overall Loss: 11.750146
Rec Loss: 10.036052
KL Loss: 1.714094
Y Loss: 0.929909
T Loss: 9.571098
Epoch 2149 
Overall Loss: 11.759749
Rec Loss: 10.016184
KL Loss: 1.743565
Y Loss: 0.934994
T Loss: 9.548686
Epoch 2199 
Overall Loss: 11.746956
Rec Loss: 10.018504
KL Loss: 1.728453
Y Loss: 0.943824
T Loss: 9.546592
Epoch 2249 
Overall Loss: 11.759335
Rec Loss: 10.013092
KL Loss: 1.746244
Y Loss: 0.919563
T Loss: 9.553311
Epoch 2299 
Overall Loss: 11.744338
Rec Loss: 10.030994
KL Loss: 1.713344
Y Loss: 0.938570
T Loss: 9.561708
Epoch 2349 
Overall Loss: 11.742867
Rec Loss: 10.009761
KL Loss: 1.733106
Y Loss: 0.921691
T Loss: 9.548915
Epoch 2399 
Overall Loss: 11.753598
Rec Loss: 10.038024
KL Loss: 1.715574
Y Loss: 0.926039
T Loss: 9.575005
Epoch 2449 
Overall Loss: 11.745189
Rec Loss: 10.021936
KL Loss: 1.723254
Y Loss: 0.927639
T Loss: 9.558116
Epoch 2499 
Overall Loss: 11.734620
Rec Loss: 10.027299
KL Loss: 1.707321
Y Loss: 0.913535
T Loss: 9.570532
Epoch 2549 
Overall Loss: 11.740103
Rec Loss: 9.987667
KL Loss: 1.752436
Y Loss: 0.891179
T Loss: 9.542077
Epoch 2599 
Overall Loss: 11.748512
Rec Loss: 10.021949
KL Loss: 1.726562
Y Loss: 0.942101
T Loss: 9.550899
Epoch 2649 
Overall Loss: 11.746612
Rec Loss: 10.031260
KL Loss: 1.715352
Y Loss: 0.926431
T Loss: 9.568044
Epoch 2699 
Overall Loss: 11.733012
Rec Loss: 10.007710
KL Loss: 1.725302
Y Loss: 0.915693
T Loss: 9.549864
Epoch 2749 
Overall Loss: 11.737719
Rec Loss: 10.008064
KL Loss: 1.729655
Y Loss: 0.928828
T Loss: 9.543650
Epoch 2799 
Overall Loss: 11.725160
Rec Loss: 10.006858
KL Loss: 1.718301
Y Loss: 0.920757
T Loss: 9.546480
Epoch 2849 
Overall Loss: 11.713659
Rec Loss: 10.000417
KL Loss: 1.713242
Y Loss: 0.893651
T Loss: 9.553591
Epoch 2899 
Overall Loss: 11.726993
Rec Loss: 10.011681
KL Loss: 1.715312
Y Loss: 0.912726
T Loss: 9.555317
Epoch 2949 
Overall Loss: 11.738005
Rec Loss: 10.021924
KL Loss: 1.716081
Y Loss: 0.935102
T Loss: 9.554372
Epoch 2999 
Overall Loss: 11.720926
Rec Loss: 9.991779
KL Loss: 1.729147
Y Loss: 0.901517
T Loss: 9.541020
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.720812
Epoch 99
Rec Loss: 0.712527
Epoch 149
Rec Loss: 0.728408
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.186683
Epoch 99
Rec Loss: 10.181644
Epoch 149
Rec Loss: 10.170616
Epoch 199
Rec Loss: 10.171070
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.771910
Insample Error: 2.001502
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.013738
Epoch 99
Rec Loss: 4.016040
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 8.886763
Epoch 99
Rec Loss: 8.759824
Epoch 149
Rec Loss: 8.746709
Epoch 199
Rec Loss: 8.675817
Epoch 249
Rec Loss: 8.776179
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.841496
Insample Error 3.342949
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.380558
Epoch 99 
Prediction Loss: 2.142254
Epoch 149 
Prediction Loss: 2.044677
Epoch 199 
Prediction Loss: 2.003192
Epoch 249 
Prediction Loss: 1.969306
Epoch 299 
Prediction Loss: 1.954030
Epoch 349 
Prediction Loss: 1.937771
Epoch 399 
Prediction Loss: 1.904890
Epoch 449 
Prediction Loss: 1.907401
Epoch 499 
Prediction Loss: 1.897290
Epoch 549 
Prediction Loss: 1.893743
Epoch 599 
Prediction Loss: 1.913692
Epoch 649 
Prediction Loss: 1.853931
Epoch 699 
Prediction Loss: 1.841764
Epoch 749 
Prediction Loss: 1.839327
Epoch 799 
Prediction Loss: 1.834368
Epoch 849 
Prediction Loss: 1.818662
Epoch 899 
Prediction Loss: 1.806894
Epoch 949 
Prediction Loss: 1.816872
Epoch 999 
Prediction Loss: 1.796873
Epoch 1049 
Prediction Loss: 1.801275
Epoch 1099 
Prediction Loss: 1.780809
Epoch 1149 
Prediction Loss: 1.771883
Epoch 1199 
Prediction Loss: 1.757605
Epoch 1249 
Prediction Loss: 1.751015
Epoch 1299 
Prediction Loss: 1.753189
Epoch 1349 
Prediction Loss: 1.743909
Epoch 1399 
Prediction Loss: 1.736021
Epoch 1449 
Prediction Loss: 1.727726
Epoch 1499 
Prediction Loss: 1.717661
Epoch 1549 
Prediction Loss: 1.722306
Epoch 1599 
Prediction Loss: 1.722405
Epoch 1649 
Prediction Loss: 1.723804
Epoch 1699 
Prediction Loss: 1.690833
Epoch 1749 
Prediction Loss: 1.701833
Epoch 1799 
Prediction Loss: 1.676277
Epoch 1849 
Prediction Loss: 1.677121
Epoch 1899 
Prediction Loss: 1.677059
Epoch 1949 
Prediction Loss: 1.651973
Epoch 1999 
Prediction Loss: 1.660220
Epoch 2049 
Prediction Loss: 1.663733
Epoch 2099 
Prediction Loss: 1.644010
Epoch 2149 
Prediction Loss: 1.650731
Epoch 2199 
Prediction Loss: 1.681522
Epoch 2249 
Prediction Loss: 1.627027
Epoch 2299 
Prediction Loss: 1.627828
Epoch 2349 
Prediction Loss: 1.611106
Epoch 2399 
Prediction Loss: 1.607069
Epoch 2449 
Prediction Loss: 1.609386
Epoch 2499 
Prediction Loss: 1.614709
Epoch 2549 
Prediction Loss: 1.589112
Epoch 2599 
Prediction Loss: 1.606061
Epoch 2649 
Prediction Loss: 1.596196
Epoch 2699 
Prediction Loss: 1.578329
Epoch 2749 
Prediction Loss: 1.590409
Epoch 2799 
Prediction Loss: 1.584416
Epoch 2849 
Prediction Loss: 1.558170
Epoch 2899 
Prediction Loss: 1.567713
Epoch 2949 
Prediction Loss: 1.560278
Epoch 2999 
Prediction Loss: 1.556009
Epoch 3049 
Prediction Loss: 1.530817
Epoch 3099 
Prediction Loss: 1.536306
Epoch 3149 
Prediction Loss: 1.534419
Epoch 3199 
Prediction Loss: 1.533819
Epoch 3249 
Prediction Loss: 1.519862
Epoch 3299 
Prediction Loss: 1.505164
Epoch 3349 
Prediction Loss: 1.513560
Epoch 3399 
Prediction Loss: 1.495559
Epoch 3449 
Prediction Loss: 1.506697
Epoch 3499 
Prediction Loss: 1.502551
Epoch 3549 
Prediction Loss: 1.509029
Epoch 3599 
Prediction Loss: 1.488416
Epoch 3649 
Prediction Loss: 1.503985
Epoch 3699 
Prediction Loss: 1.481913
Epoch 3749 
Prediction Loss: 1.475466
Epoch 3799 
Prediction Loss: 1.461125
Epoch 3849 
Prediction Loss: 1.481072
Epoch 3899 
Prediction Loss: 1.449074
Epoch 3949 
Prediction Loss: 1.446952
Epoch 3999 
Prediction Loss: 1.446262
Epoch 4049 
Prediction Loss: 1.458627
Epoch 4099 
Prediction Loss: 1.429692
Epoch 4149 
Prediction Loss: 1.432969
Epoch 4199 
Prediction Loss: 1.434768
Epoch 4249 
Prediction Loss: 1.409297
Epoch 4299 
Prediction Loss: 1.431938
Epoch 4349 
Prediction Loss: 1.401957
Epoch 4399 
Prediction Loss: 1.404086
Epoch 4449 
Prediction Loss: 1.422557
Epoch 4499 
Prediction Loss: 1.406577
Epoch 4549 
Prediction Loss: 1.392023
Epoch 4599 
Prediction Loss: 1.391512
Epoch 4649 
Prediction Loss: 1.400281
Epoch 4699 
Prediction Loss: 1.385160
Epoch 4749 
Prediction Loss: 1.368278
Epoch 4799 
Prediction Loss: 1.406130
Epoch 4849 
Prediction Loss: 1.374352
Epoch 4899 
Prediction Loss: 1.359304
Epoch 4949 
Prediction Loss: 1.355259
Epoch 4999 
Prediction Loss: 1.355170
Epoch 5049 
Prediction Loss: 1.355892
Epoch 5099 
Prediction Loss: 1.358389
Epoch 5149 
Prediction Loss: 1.368869
Epoch 5199 
Prediction Loss: 1.337967
Epoch 5249 
Prediction Loss: 1.324215
Epoch 5299 
Prediction Loss: 1.334565
Epoch 5349 
Prediction Loss: 1.317258
Epoch 5399 
Prediction Loss: 1.331453
Epoch 5449 
Prediction Loss: 1.318054
Epoch 5499 
Prediction Loss: 1.306739
Epoch 5549 
Prediction Loss: 1.340299
Epoch 5599 
Prediction Loss: 1.312634
Epoch 5649 
Prediction Loss: 1.323685
Epoch 5699 
Prediction Loss: 1.313785
Epoch 5749 
Prediction Loss: 1.295827
Epoch 5799 
Prediction Loss: 1.295162
Epoch 5849 
Prediction Loss: 1.303603
Epoch 5899 
Prediction Loss: 1.287903
Epoch 5949 
Prediction Loss: 1.284230
Epoch 5999 
Prediction Loss: 1.281698
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.133585
Insample Error 3.043749
[31m========== repeat time 4 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.228631
Rec Loss: 10.150162
KL Loss: 2.078469
Y Loss: 1.093704
T Loss: 9.603310
Epoch 99 
Overall Loss: 12.043588
Rec Loss: 10.154067
KL Loss: 1.889521
Y Loss: 1.051619
T Loss: 9.628258
Epoch 149 
Overall Loss: 11.978500
Rec Loss: 10.161731
KL Loss: 1.816769
Y Loss: 1.052322
T Loss: 9.635571
Epoch 199 
Overall Loss: 11.932469
Rec Loss: 10.115458
KL Loss: 1.817011
Y Loss: 1.035360
T Loss: 9.597778
Epoch 249 
Overall Loss: 11.904205
Rec Loss: 10.130368
KL Loss: 1.773837
Y Loss: 1.021171
T Loss: 9.619782
Epoch 299 
Overall Loss: 11.866275
Rec Loss: 10.121183
KL Loss: 1.745092
Y Loss: 1.031135
T Loss: 9.605616
Epoch 349 
Overall Loss: 11.890943
Rec Loss: 10.105719
KL Loss: 1.785225
Y Loss: 1.013546
T Loss: 9.598946
Epoch 399 
Overall Loss: 11.842516
Rec Loss: 10.121075
KL Loss: 1.721441
Y Loss: 1.007144
T Loss: 9.617503
Epoch 449 
Overall Loss: 11.848246
Rec Loss: 10.084151
KL Loss: 1.764095
Y Loss: 0.976801
T Loss: 9.595751
Epoch 499 
Overall Loss: 11.852398
Rec Loss: 10.092161
KL Loss: 1.760237
Y Loss: 0.994553
T Loss: 9.594884
Epoch 549 
Overall Loss: 11.842064
Rec Loss: 10.102369
KL Loss: 1.739695
Y Loss: 0.973459
T Loss: 9.615639
Epoch 599 
Overall Loss: 11.840209
Rec Loss: 10.076554
KL Loss: 1.763655
Y Loss: 0.973779
T Loss: 9.589664
Epoch 649 
Overall Loss: 11.841245
Rec Loss: 10.073921
KL Loss: 1.767324
Y Loss: 0.982456
T Loss: 9.582692
Epoch 699 
Overall Loss: 11.831483
Rec Loss: 10.065628
KL Loss: 1.765855
Y Loss: 0.969890
T Loss: 9.580683
Epoch 749 
Overall Loss: 11.844605
Rec Loss: 10.088191
KL Loss: 1.756414
Y Loss: 0.999744
T Loss: 9.588319
Epoch 799 
Overall Loss: 11.842465
Rec Loss: 10.108719
KL Loss: 1.733746
Y Loss: 0.986779
T Loss: 9.615330
Epoch 849 
Overall Loss: 11.813147
Rec Loss: 10.066236
KL Loss: 1.746911
Y Loss: 0.965917
T Loss: 9.583278
Epoch 899 
Overall Loss: 11.817082
Rec Loss: 10.052115
KL Loss: 1.764967
Y Loss: 0.962729
T Loss: 9.570750
Epoch 949 
Overall Loss: 11.808766
Rec Loss: 10.097016
KL Loss: 1.711750
Y Loss: 0.969447
T Loss: 9.612293
Epoch 999 
Overall Loss: 11.781186
Rec Loss: 10.046480
KL Loss: 1.734706
Y Loss: 0.963207
T Loss: 9.564877
Epoch 1049 
Overall Loss: 11.797962
Rec Loss: 10.052373
KL Loss: 1.745589
Y Loss: 0.969995
T Loss: 9.567375
Epoch 1099 
Overall Loss: 11.790013
Rec Loss: 10.053181
KL Loss: 1.736832
Y Loss: 0.979910
T Loss: 9.563226
Epoch 1149 
Overall Loss: 11.816896
Rec Loss: 10.065161
KL Loss: 1.751735
Y Loss: 0.966560
T Loss: 9.581881
Epoch 1199 
Overall Loss: 11.789041
Rec Loss: 10.057745
KL Loss: 1.731296
Y Loss: 0.959807
T Loss: 9.577841
Epoch 1249 
Overall Loss: 11.805734
Rec Loss: 10.057262
KL Loss: 1.748472
Y Loss: 0.953280
T Loss: 9.580622
Epoch 1299 
Overall Loss: 11.791859
Rec Loss: 10.057078
KL Loss: 1.734780
Y Loss: 0.959434
T Loss: 9.577361
Epoch 1349 
Overall Loss: 11.781797
Rec Loss: 10.034075
KL Loss: 1.747721
Y Loss: 0.933542
T Loss: 9.567304
Epoch 1399 
Overall Loss: 11.785504
Rec Loss: 10.037412
KL Loss: 1.748093
Y Loss: 0.948723
T Loss: 9.563050
Epoch 1449 
Overall Loss: 11.769768
Rec Loss: 10.072631
KL Loss: 1.697137
Y Loss: 0.976883
T Loss: 9.584190
Epoch 1499 
Overall Loss: 11.787800
Rec Loss: 10.061168
KL Loss: 1.726632
Y Loss: 0.958734
T Loss: 9.581801
Epoch 1549 
Overall Loss: 11.780517
Rec Loss: 10.045654
KL Loss: 1.734863
Y Loss: 0.935496
T Loss: 9.577906
Epoch 1599 
Overall Loss: 11.782413
Rec Loss: 10.044751
KL Loss: 1.737662
Y Loss: 0.944408
T Loss: 9.572547
Epoch 1649 
Overall Loss: 11.785809
Rec Loss: 10.067253
KL Loss: 1.718556
Y Loss: 0.983562
T Loss: 9.575472
Epoch 1699 
Overall Loss: 11.760996
Rec Loss: 10.058248
KL Loss: 1.702748
Y Loss: 0.951197
T Loss: 9.582650
Epoch 1749 
Overall Loss: 11.767399
Rec Loss: 10.056191
KL Loss: 1.711209
Y Loss: 0.951557
T Loss: 9.580412
Epoch 1799 
Overall Loss: 11.754900
Rec Loss: 10.022750
KL Loss: 1.732149
Y Loss: 0.946178
T Loss: 9.549661
Epoch 1849 
Overall Loss: 11.750825
Rec Loss: 10.047499
KL Loss: 1.703327
Y Loss: 0.939491
T Loss: 9.577753
Epoch 1899 
Overall Loss: 11.782836
Rec Loss: 10.043564
KL Loss: 1.739272
Y Loss: 0.965991
T Loss: 9.560568
Epoch 1949 
Overall Loss: 11.764493
Rec Loss: 10.014559
KL Loss: 1.749934
Y Loss: 0.944121
T Loss: 9.542498
Epoch 1999 
Overall Loss: 11.749805
Rec Loss: 10.041705
KL Loss: 1.708099
Y Loss: 0.948587
T Loss: 9.567411
Epoch 2049 
Overall Loss: 11.772005
Rec Loss: 10.036296
KL Loss: 1.735709
Y Loss: 0.954870
T Loss: 9.558861
Epoch 2099 
Overall Loss: 11.764592
Rec Loss: 10.058984
KL Loss: 1.705608
Y Loss: 0.975677
T Loss: 9.571145
Epoch 2149 
Overall Loss: 11.760126
Rec Loss: 10.029325
KL Loss: 1.730801
Y Loss: 0.949120
T Loss: 9.554765
Epoch 2199 
Overall Loss: 11.739382
Rec Loss: 10.021557
KL Loss: 1.717825
Y Loss: 0.953083
T Loss: 9.545016
Epoch 2249 
Overall Loss: 11.749000
Rec Loss: 10.032352
KL Loss: 1.716648
Y Loss: 0.944726
T Loss: 9.559989
Epoch 2299 
Overall Loss: 11.755479
Rec Loss: 10.025210
KL Loss: 1.730270
Y Loss: 0.940520
T Loss: 9.554950
Epoch 2349 
Overall Loss: 11.725127
Rec Loss: 10.024061
KL Loss: 1.701066
Y Loss: 0.931251
T Loss: 9.558435
Epoch 2399 
Overall Loss: 11.754086
Rec Loss: 10.026279
KL Loss: 1.727807
Y Loss: 0.960698
T Loss: 9.545931
Epoch 2449 
Overall Loss: 11.734605
Rec Loss: 10.011438
KL Loss: 1.723167
Y Loss: 0.946757
T Loss: 9.538059
Epoch 2499 
Overall Loss: 11.734180
Rec Loss: 10.038305
KL Loss: 1.695875
Y Loss: 0.954431
T Loss: 9.561090
Epoch 2549 
Overall Loss: 11.750549
Rec Loss: 10.034578
KL Loss: 1.715971
Y Loss: 0.939004
T Loss: 9.565077
Epoch 2599 
Overall Loss: 11.735733
Rec Loss: 10.052978
KL Loss: 1.682756
Y Loss: 0.944514
T Loss: 9.580721
Epoch 2649 
Overall Loss: 11.738475
Rec Loss: 10.022498
KL Loss: 1.715977
Y Loss: 0.946580
T Loss: 9.549208
Epoch 2699 
Overall Loss: 11.743216
Rec Loss: 10.004343
KL Loss: 1.738873
Y Loss: 0.920076
T Loss: 9.544304
Epoch 2749 
Overall Loss: 11.723486
Rec Loss: 10.007816
KL Loss: 1.715670
Y Loss: 0.951806
T Loss: 9.531912
Epoch 2799 
Overall Loss: 11.717463
Rec Loss: 10.003313
KL Loss: 1.714150
Y Loss: 0.933164
T Loss: 9.536730
Epoch 2849 
Overall Loss: 11.751248
Rec Loss: 10.004306
KL Loss: 1.746943
Y Loss: 0.932227
T Loss: 9.538192
Epoch 2899 
Overall Loss: 11.717112
Rec Loss: 9.995259
KL Loss: 1.721854
Y Loss: 0.918618
T Loss: 9.535950
Epoch 2949 
Overall Loss: 11.735475
Rec Loss: 9.986562
KL Loss: 1.748913
Y Loss: 0.920999
T Loss: 9.526062
Epoch 2999 
Overall Loss: 11.733211
Rec Loss: 9.992128
KL Loss: 1.741083
Y Loss: 0.924360
T Loss: 9.529948
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.671022
Epoch 99
Rec Loss: 0.665129
Epoch 149
Rec Loss: 0.661567
Epoch 199
Rec Loss: 0.665417
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.187614
Epoch 99
Rec Loss: 10.184383
Epoch 149
Rec Loss: 10.171064
Epoch 199
Rec Loss: 10.179607
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.785492
Insample Error: 1.895800
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.959711
Epoch 99
Rec Loss: 3.966702
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.399817
Epoch 99
Rec Loss: 9.513421
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.752214
Insample Error 3.330329
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.492995
Epoch 99 
Prediction Loss: 2.180104
Epoch 149 
Prediction Loss: 2.058951
Epoch 199 
Prediction Loss: 2.035931
Epoch 249 
Prediction Loss: 1.984945
Epoch 299 
Prediction Loss: 1.971842
Epoch 349 
Prediction Loss: 1.948941
Epoch 399 
Prediction Loss: 1.919616
Epoch 449 
Prediction Loss: 1.904697
Epoch 499 
Prediction Loss: 1.903735
Epoch 549 
Prediction Loss: 1.891060
Epoch 599 
Prediction Loss: 1.871917
Epoch 649 
Prediction Loss: 1.887446
Epoch 699 
Prediction Loss: 1.845159
Epoch 749 
Prediction Loss: 1.826221
Epoch 799 
Prediction Loss: 1.825632
Epoch 849 
Prediction Loss: 1.816948
Epoch 899 
Prediction Loss: 1.796917
Epoch 949 
Prediction Loss: 1.797287
Epoch 999 
Prediction Loss: 1.791993
Epoch 1049 
Prediction Loss: 1.780472
Epoch 1099 
Prediction Loss: 1.774360
Epoch 1149 
Prediction Loss: 1.763004
Epoch 1199 
Prediction Loss: 1.756155
Epoch 1249 
Prediction Loss: 1.770546
Epoch 1299 
Prediction Loss: 1.741290
Epoch 1349 
Prediction Loss: 1.733907
Epoch 1399 
Prediction Loss: 1.733066
Epoch 1449 
Prediction Loss: 1.701726
Epoch 1499 
Prediction Loss: 1.727478
Epoch 1549 
Prediction Loss: 1.693376
Epoch 1599 
Prediction Loss: 1.695395
Epoch 1649 
Prediction Loss: 1.715155
Epoch 1699 
Prediction Loss: 1.675708
Epoch 1749 
Prediction Loss: 1.674492
Epoch 1799 
Prediction Loss: 1.658747
Epoch 1849 
Prediction Loss: 1.654260
Epoch 1899 
Prediction Loss: 1.661183
Epoch 1949 
Prediction Loss: 1.651802
Epoch 1999 
Prediction Loss: 1.632046
Epoch 2049 
Prediction Loss: 1.637398
Epoch 2099 
Prediction Loss: 1.623397
Epoch 2149 
Prediction Loss: 1.630926
Epoch 2199 
Prediction Loss: 1.603490
Epoch 2249 
Prediction Loss: 1.609500
Epoch 2299 
Prediction Loss: 1.599488
Epoch 2349 
Prediction Loss: 1.594568
Epoch 2399 
Prediction Loss: 1.594502
Epoch 2449 
Prediction Loss: 1.592256
Epoch 2499 
Prediction Loss: 1.573676
Epoch 2549 
Prediction Loss: 1.563751
Epoch 2599 
Prediction Loss: 1.588479
Epoch 2649 
Prediction Loss: 1.571277
Epoch 2699 
Prediction Loss: 1.540410
Epoch 2749 
Prediction Loss: 1.554240
Epoch 2799 
Prediction Loss: 1.539716
Epoch 2849 
Prediction Loss: 1.523257
Epoch 2899 
Prediction Loss: 1.555664
Epoch 2949 
Prediction Loss: 1.512523
Epoch 2999 
Prediction Loss: 1.517306
Epoch 3049 
Prediction Loss: 1.506692
Epoch 3099 
Prediction Loss: 1.496391
Epoch 3149 
Prediction Loss: 1.500676
Epoch 3199 
Prediction Loss: 1.497573
Epoch 3249 
Prediction Loss: 1.480899
Epoch 3299 
Prediction Loss: 1.482530
Epoch 3349 
Prediction Loss: 1.477625
Epoch 3399 
Prediction Loss: 1.476683
Epoch 3449 
Prediction Loss: 1.488924
Epoch 3499 
Prediction Loss: 1.471054
Epoch 3549 
Prediction Loss: 1.457049
Epoch 3599 
Prediction Loss: 1.449164
Epoch 3649 
Prediction Loss: 1.436121
Epoch 3699 
Prediction Loss: 1.439317
Epoch 3749 
Prediction Loss: 1.425151
Epoch 3799 
Prediction Loss: 1.439353
Epoch 3849 
Prediction Loss: 1.410458
Epoch 3899 
Prediction Loss: 1.404641
Epoch 3949 
Prediction Loss: 1.411617
Epoch 3999 
Prediction Loss: 1.396515
Epoch 4049 
Prediction Loss: 1.392958
Epoch 4099 
Prediction Loss: 1.388684
Epoch 4149 
Prediction Loss: 1.412094
Epoch 4199 
Prediction Loss: 1.412650
Epoch 4249 
Prediction Loss: 1.393697
Epoch 4299 
Prediction Loss: 1.398865
Epoch 4349 
Prediction Loss: 1.356918
Epoch 4399 
Prediction Loss: 1.361065
Epoch 4449 
Prediction Loss: 1.355917
Epoch 4499 
Prediction Loss: 1.369797
Epoch 4549 
Prediction Loss: 1.365666
Epoch 4599 
Prediction Loss: 1.361027
Epoch 4649 
Prediction Loss: 1.349709
Epoch 4699 
Prediction Loss: 1.345008
Epoch 4749 
Prediction Loss: 1.322225
Epoch 4799 
Prediction Loss: 1.333497
Epoch 4849 
Prediction Loss: 1.319906
Epoch 4899 
Prediction Loss: 1.327377
Epoch 4949 
Prediction Loss: 1.309197
Epoch 4999 
Prediction Loss: 1.310056
Epoch 5049 
Prediction Loss: 1.306630
Epoch 5099 
Prediction Loss: 1.303517
Epoch 5149 
Prediction Loss: 1.308635
Epoch 5199 
Prediction Loss: 1.310279
Epoch 5249 
Prediction Loss: 1.287800
Epoch 5299 
Prediction Loss: 1.299879
Epoch 5349 
Prediction Loss: 1.270761
Epoch 5399 
Prediction Loss: 1.288844
Epoch 5449 
Prediction Loss: 1.257217
Epoch 5499 
Prediction Loss: 1.278600
Epoch 5549 
Prediction Loss: 1.271175
Epoch 5599 
Prediction Loss: 1.281807
Epoch 5649 
Prediction Loss: 1.244552
Epoch 5699 
Prediction Loss: 1.272092
Epoch 5749 
Prediction Loss: 1.255113
Epoch 5799 
Prediction Loss: 1.243940
Epoch 5849 
Prediction Loss: 1.238482
Epoch 5899 
Prediction Loss: 1.263294
Epoch 5949 
Prediction Loss: 1.250627
Epoch 5999 
Prediction Loss: 1.236919
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.119191
Insample Error 3.119766
[31m========== repeat time 5 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.267674
Rec Loss: 10.105577
KL Loss: 2.162097
Y Loss: 0.958198
T Loss: 9.626478
Epoch 99 
Overall Loss: 12.059083
Rec Loss: 10.126635
KL Loss: 1.932448
Y Loss: 0.962679
T Loss: 9.645296
Epoch 149 
Overall Loss: 11.972740
Rec Loss: 10.133032
KL Loss: 1.839709
Y Loss: 0.983102
T Loss: 9.641480
Epoch 199 
Overall Loss: 11.922909
Rec Loss: 10.128654
KL Loss: 1.794255
Y Loss: 0.989769
T Loss: 9.633770
Epoch 249 
Overall Loss: 11.895092
Rec Loss: 10.132593
KL Loss: 1.762498
Y Loss: 0.976920
T Loss: 9.644133
Epoch 299 
Overall Loss: 11.873162
Rec Loss: 10.131308
KL Loss: 1.741854
Y Loss: 0.987725
T Loss: 9.637445
Epoch 349 
Overall Loss: 11.871147
Rec Loss: 10.130542
KL Loss: 1.740605
Y Loss: 0.999719
T Loss: 9.630682
Epoch 399 
Overall Loss: 11.870777
Rec Loss: 10.123437
KL Loss: 1.747339
Y Loss: 0.965484
T Loss: 9.640695
Epoch 449 
Overall Loss: 11.863940
Rec Loss: 10.082162
KL Loss: 1.781778
Y Loss: 0.960636
T Loss: 9.601844
Epoch 499 
Overall Loss: 11.860733
Rec Loss: 10.106660
KL Loss: 1.754072
Y Loss: 0.976789
T Loss: 9.618266
Epoch 549 
Overall Loss: 11.823348
Rec Loss: 10.083220
KL Loss: 1.740128
Y Loss: 0.959552
T Loss: 9.603444
Epoch 599 
Overall Loss: 11.821140
Rec Loss: 10.057980
KL Loss: 1.763161
Y Loss: 0.935641
T Loss: 9.590159
Epoch 649 
Overall Loss: 11.842355
Rec Loss: 10.081362
KL Loss: 1.760993
Y Loss: 0.951372
T Loss: 9.605676
Epoch 699 
Overall Loss: 11.811641
Rec Loss: 10.077903
KL Loss: 1.733739
Y Loss: 0.961243
T Loss: 9.597281
Epoch 749 
Overall Loss: 11.851662
Rec Loss: 10.090966
KL Loss: 1.760696
Y Loss: 0.962079
T Loss: 9.609927
Epoch 799 
Overall Loss: 11.826949
Rec Loss: 10.056943
KL Loss: 1.770005
Y Loss: 0.927896
T Loss: 9.592995
Epoch 849 
Overall Loss: 11.815836
Rec Loss: 10.064145
KL Loss: 1.751691
Y Loss: 0.923041
T Loss: 9.602624
Epoch 899 
Overall Loss: 11.804616
Rec Loss: 10.064368
KL Loss: 1.740248
Y Loss: 0.951765
T Loss: 9.588485
Epoch 949 
Overall Loss: 11.797725
Rec Loss: 10.047799
KL Loss: 1.749926
Y Loss: 0.942939
T Loss: 9.576329
Epoch 999 
Overall Loss: 11.791193
Rec Loss: 10.037255
KL Loss: 1.753937
Y Loss: 0.936199
T Loss: 9.569156
Epoch 1049 
Overall Loss: 11.807915
Rec Loss: 10.067997
KL Loss: 1.739919
Y Loss: 0.940022
T Loss: 9.597985
Epoch 1099 
Overall Loss: 11.808865
Rec Loss: 10.052043
KL Loss: 1.756823
Y Loss: 0.927414
T Loss: 9.588335
Epoch 1149 
Overall Loss: 11.776165
Rec Loss: 10.062294
KL Loss: 1.713871
Y Loss: 0.925305
T Loss: 9.599642
Epoch 1199 
Overall Loss: 11.778111
Rec Loss: 10.044460
KL Loss: 1.733651
Y Loss: 0.923181
T Loss: 9.582869
Epoch 1249 
Overall Loss: 11.796848
Rec Loss: 10.056224
KL Loss: 1.740624
Y Loss: 0.933580
T Loss: 9.589434
Epoch 1299 
Overall Loss: 11.788228
Rec Loss: 10.044436
KL Loss: 1.743792
Y Loss: 0.944087
T Loss: 9.572393
Epoch 1349 
Overall Loss: 11.798572
Rec Loss: 10.015149
KL Loss: 1.783423
Y Loss: 0.917464
T Loss: 9.556416
Epoch 1399 
Overall Loss: 11.779708
Rec Loss: 10.045383
KL Loss: 1.734325
Y Loss: 0.917918
T Loss: 9.586424
Epoch 1449 
Overall Loss: 11.788060
Rec Loss: 10.043854
KL Loss: 1.744206
Y Loss: 0.917347
T Loss: 9.585180
Epoch 1499 
Overall Loss: 11.779850
Rec Loss: 10.036707
KL Loss: 1.743142
Y Loss: 0.910353
T Loss: 9.581530
Epoch 1549 
Overall Loss: 11.774863
Rec Loss: 10.037048
KL Loss: 1.737814
Y Loss: 0.945257
T Loss: 9.564419
Epoch 1599 
Overall Loss: 11.780668
Rec Loss: 10.034454
KL Loss: 1.746214
Y Loss: 0.918056
T Loss: 9.575426
Epoch 1649 
Overall Loss: 11.751227
Rec Loss: 10.038326
KL Loss: 1.712902
Y Loss: 0.940102
T Loss: 9.568275
Epoch 1699 
Overall Loss: 11.770027
Rec Loss: 10.054669
KL Loss: 1.715357
Y Loss: 0.950562
T Loss: 9.579389
Epoch 1749 
Overall Loss: 11.758786
Rec Loss: 10.018277
KL Loss: 1.740509
Y Loss: 0.915976
T Loss: 9.560289
Epoch 1799 
Overall Loss: 11.775451
Rec Loss: 10.033170
KL Loss: 1.742282
Y Loss: 0.934832
T Loss: 9.565754
Epoch 1849 
Overall Loss: 11.751188
Rec Loss: 10.015717
KL Loss: 1.735472
Y Loss: 0.916981
T Loss: 9.557226
Epoch 1899 
Overall Loss: 11.769552
Rec Loss: 10.046353
KL Loss: 1.723199
Y Loss: 0.934362
T Loss: 9.579172
Epoch 1949 
Overall Loss: 11.748183
Rec Loss: 10.025810
KL Loss: 1.722373
Y Loss: 0.922262
T Loss: 9.564679
Epoch 1999 
Overall Loss: 11.760131
Rec Loss: 10.018889
KL Loss: 1.741242
Y Loss: 0.910286
T Loss: 9.563746
Epoch 2049 
Overall Loss: 11.746244
Rec Loss: 10.007639
KL Loss: 1.738605
Y Loss: 0.926310
T Loss: 9.544484
Epoch 2099 
Overall Loss: 11.757143
Rec Loss: 10.007258
KL Loss: 1.749885
Y Loss: 0.918292
T Loss: 9.548113
Epoch 2149 
Overall Loss: 11.754971
Rec Loss: 10.021169
KL Loss: 1.733801
Y Loss: 0.922589
T Loss: 9.559875
Epoch 2199 
Overall Loss: 11.773913
Rec Loss: 10.044098
KL Loss: 1.729816
Y Loss: 0.920284
T Loss: 9.583956
Epoch 2249 
Overall Loss: 11.739586
Rec Loss: 10.019704
KL Loss: 1.719882
Y Loss: 0.932666
T Loss: 9.553371
Epoch 2299 
Overall Loss: 11.729715
Rec Loss: 10.004426
KL Loss: 1.725289
Y Loss: 0.912912
T Loss: 9.547970
Epoch 2349 
Overall Loss: 11.735346
Rec Loss: 10.007781
KL Loss: 1.727565
Y Loss: 0.918627
T Loss: 9.548467
Epoch 2399 
Overall Loss: 11.750128
Rec Loss: 10.005388
KL Loss: 1.744740
Y Loss: 0.911519
T Loss: 9.549628
Epoch 2449 
Overall Loss: 11.741936
Rec Loss: 9.999623
KL Loss: 1.742313
Y Loss: 0.924825
T Loss: 9.537210
Epoch 2499 
Overall Loss: 11.744898
Rec Loss: 10.008170
KL Loss: 1.736729
Y Loss: 0.940735
T Loss: 9.537802
Epoch 2549 
Overall Loss: 11.724657
Rec Loss: 10.007782
KL Loss: 1.716875
Y Loss: 0.899932
T Loss: 9.557817
Epoch 2599 
Overall Loss: 11.724410
Rec Loss: 9.997365
KL Loss: 1.727045
Y Loss: 0.906389
T Loss: 9.544170
Epoch 2649 
Overall Loss: 11.730938
Rec Loss: 9.975721
KL Loss: 1.755216
Y Loss: 0.889927
T Loss: 9.530758
Epoch 2699 
Overall Loss: 11.717258
Rec Loss: 9.989500
KL Loss: 1.727758
Y Loss: 0.900120
T Loss: 9.539440
Epoch 2749 
Overall Loss: 11.729387
Rec Loss: 9.973360
KL Loss: 1.756028
Y Loss: 0.914167
T Loss: 9.516276
Epoch 2799 
Overall Loss: 11.730864
Rec Loss: 10.009767
KL Loss: 1.721096
Y Loss: 0.917444
T Loss: 9.551045
Epoch 2849 
Overall Loss: 11.727102
Rec Loss: 10.018868
KL Loss: 1.708235
Y Loss: 0.953944
T Loss: 9.541896
Epoch 2899 
Overall Loss: 11.721078
Rec Loss: 9.999554
KL Loss: 1.721524
Y Loss: 0.920339
T Loss: 9.539384
Epoch 2949 
Overall Loss: 11.748316
Rec Loss: 10.021379
KL Loss: 1.726937
Y Loss: 0.916165
T Loss: 9.563297
Epoch 2999 
Overall Loss: 11.724468
Rec Loss: 9.974871
KL Loss: 1.749597
Y Loss: 0.915340
T Loss: 9.517201
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.705003
Epoch 99
Rec Loss: 0.705526
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.174641
Epoch 99
Rec Loss: 10.167403
Epoch 149
Rec Loss: 10.170933
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.779408
Insample Error: 1.914194
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.010539
Epoch 99
Rec Loss: 4.010035
Epoch 149
Rec Loss: 4.009327
Epoch 199
Rec Loss: 4.010378
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.736598
Epoch 99
Rec Loss: 9.850834
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.741946
Insample Error 3.351636
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.425007
Epoch 99 
Prediction Loss: 2.189877
Epoch 149 
Prediction Loss: 2.059952
Epoch 199 
Prediction Loss: 2.011057
Epoch 249 
Prediction Loss: 1.985058
Epoch 299 
Prediction Loss: 1.954673
Epoch 349 
Prediction Loss: 1.935368
Epoch 399 
Prediction Loss: 1.919059
Epoch 449 
Prediction Loss: 1.899279
Epoch 499 
Prediction Loss: 1.886331
Epoch 549 
Prediction Loss: 1.883352
Epoch 599 
Prediction Loss: 1.865542
Epoch 649 
Prediction Loss: 1.875338
Epoch 699 
Prediction Loss: 1.858661
Epoch 749 
Prediction Loss: 1.842048
Epoch 799 
Prediction Loss: 1.835613
Epoch 849 
Prediction Loss: 1.816365
Epoch 899 
Prediction Loss: 1.835959
Epoch 949 
Prediction Loss: 1.813398
Epoch 999 
Prediction Loss: 1.813684
Epoch 1049 
Prediction Loss: 1.832768
Epoch 1099 
Prediction Loss: 1.796383
Epoch 1149 
Prediction Loss: 1.769439
Epoch 1199 
Prediction Loss: 1.775640
Epoch 1249 
Prediction Loss: 1.778811
Epoch 1299 
Prediction Loss: 1.754967
Epoch 1349 
Prediction Loss: 1.750894
Epoch 1399 
Prediction Loss: 1.742478
Epoch 1449 
Prediction Loss: 1.740241
Epoch 1499 
Prediction Loss: 1.738395
Epoch 1549 
Prediction Loss: 1.762653
Epoch 1599 
Prediction Loss: 1.718715
Epoch 1649 
Prediction Loss: 1.721246
Epoch 1699 
Prediction Loss: 1.726489
Epoch 1749 
Prediction Loss: 1.710433
Epoch 1799 
Prediction Loss: 1.702935
Epoch 1849 
Prediction Loss: 1.699503
Epoch 1899 
Prediction Loss: 1.723523
Epoch 1949 
Prediction Loss: 1.679623
Epoch 1999 
Prediction Loss: 1.687890
Epoch 2049 
Prediction Loss: 1.666741
Epoch 2099 
Prediction Loss: 1.683202
Epoch 2149 
Prediction Loss: 1.662407
Epoch 2199 
Prediction Loss: 1.650871
Epoch 2249 
Prediction Loss: 1.645925
Epoch 2299 
Prediction Loss: 1.638718
Epoch 2349 
Prediction Loss: 1.635760
Epoch 2399 
Prediction Loss: 1.640087
Epoch 2449 
Prediction Loss: 1.652553
Epoch 2499 
Prediction Loss: 1.641540
Epoch 2549 
Prediction Loss: 1.615040
Epoch 2599 
Prediction Loss: 1.606127
Epoch 2649 
Prediction Loss: 1.606442
Epoch 2699 
Prediction Loss: 1.591934
Epoch 2749 
Prediction Loss: 1.585510
Epoch 2799 
Prediction Loss: 1.622778
Epoch 2849 
Prediction Loss: 1.590579
Epoch 2899 
Prediction Loss: 1.567926
Epoch 2949 
Prediction Loss: 1.581644
Epoch 2999 
Prediction Loss: 1.573419
Epoch 3049 
Prediction Loss: 1.563117
Epoch 3099 
Prediction Loss: 1.566726
Epoch 3149 
Prediction Loss: 1.572404
Epoch 3199 
Prediction Loss: 1.554701
Epoch 3249 
Prediction Loss: 1.552457
Epoch 3299 
Prediction Loss: 1.533840
Epoch 3349 
Prediction Loss: 1.536200
Epoch 3399 
Prediction Loss: 1.531992
Epoch 3449 
Prediction Loss: 1.513338
Epoch 3499 
Prediction Loss: 1.506950
Epoch 3549 
Prediction Loss: 1.509092
Epoch 3599 
Prediction Loss: 1.529241
Epoch 3649 
Prediction Loss: 1.493926
Epoch 3699 
Prediction Loss: 1.509898
Epoch 3749 
Prediction Loss: 1.483857
Epoch 3799 
Prediction Loss: 1.509775
Epoch 3849 
Prediction Loss: 1.468883
Epoch 3899 
Prediction Loss: 1.511391
Epoch 3949 
Prediction Loss: 1.493767
Epoch 3999 
Prediction Loss: 1.474702
Epoch 4049 
Prediction Loss: 1.460225
Epoch 4099 
Prediction Loss: 1.449756
Epoch 4149 
Prediction Loss: 1.445717
Epoch 4199 
Prediction Loss: 1.443262
Epoch 4249 
Prediction Loss: 1.439502
Epoch 4299 
Prediction Loss: 1.426877
Epoch 4349 
Prediction Loss: 1.440559
Epoch 4399 
Prediction Loss: 1.457947
Epoch 4449 
Prediction Loss: 1.435117
Epoch 4499 
Prediction Loss: 1.420051
Epoch 4549 
Prediction Loss: 1.416543
Epoch 4599 
Prediction Loss: 1.400216
Epoch 4649 
Prediction Loss: 1.417840
Epoch 4699 
Prediction Loss: 1.407977
Epoch 4749 
Prediction Loss: 1.405061
Epoch 4799 
Prediction Loss: 1.402833
Epoch 4849 
Prediction Loss: 1.408329
Epoch 4899 
Prediction Loss: 1.399001
Epoch 4949 
Prediction Loss: 1.384396
Epoch 4999 
Prediction Loss: 1.378184
Epoch 5049 
Prediction Loss: 1.376223
Epoch 5099 
Prediction Loss: 1.403739
Epoch 5149 
Prediction Loss: 1.366645
Epoch 5199 
Prediction Loss: 1.357473
Epoch 5249 
Prediction Loss: 1.366773
Epoch 5299 
Prediction Loss: 1.359774
Epoch 5349 
Prediction Loss: 1.360067
Epoch 5399 
Prediction Loss: 1.342210
Epoch 5449 
Prediction Loss: 1.338482
Epoch 5499 
Prediction Loss: 1.360069
Epoch 5549 
Prediction Loss: 1.353162
Epoch 5599 
Prediction Loss: 1.332213
Epoch 5649 
Prediction Loss: 1.317028
Epoch 5699 
Prediction Loss: 1.321331
Epoch 5749 
Prediction Loss: 1.311505
Epoch 5799 
Prediction Loss: 1.316013
Epoch 5849 
Prediction Loss: 1.303207
Epoch 5899 
Prediction Loss: 1.293057
Epoch 5949 
Prediction Loss: 1.296149
Epoch 5999 
Prediction Loss: 1.306313
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.145385
Insample Error 3.061619
Ours, Train RMSE
0.7688, 
0.7755, 
0.7719, 
0.7855, 
0.7794, 
CEVAE, Train RMSE
3.7659, 
3.7196, 
3.8415, 
3.7522, 
3.7419, 
Ours, Insample RMSE
2.0369, 
1.9769, 
2.0015, 
1.8958, 
1.9142, 
CEVAE, Insample RMSE
3.3374, 
3.3466, 
3.3429, 
3.3303, 
3.3516, 
Direct Regression, Insample RMSE
3.1207, 
3.1044, 
3.0437, 
3.1198, 
3.0616, 
Train, RMSE mean 0.7762 std 0.0058
CEVAE, RMSE mean 3.7642 std 0.0415
Ours, RMSE mean 1.9651 std 0.0529, reconstruct confounder 0.6994 (0.0193) noise 10.1720 (0.0072)
CEVAE, RMSE mean 3.3418 std 0.0074, reconstruct confounder 3.9858 (0.0220) noise 9.4140 (0.4501)
Direct Regression, RMSE mean 3.0900 std 0.0316
Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=4, mask=0, nlayer=50, obsm=2, stop=2000, ycof=0.5, ylayer=50)
Y Mean 1.776465, Std 3.501489 
Test Y Mean -0.006496, Std 3.341313 
Observe confounder 2, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.262717
Rec Loss: 10.119638
KL Loss: 2.143080
Y Loss: 0.988319
T Loss: 9.625478
Epoch 99 
Overall Loss: 12.055457
Rec Loss: 10.124345
KL Loss: 1.931113
Y Loss: 0.980725
T Loss: 9.633982
Epoch 149 
Overall Loss: 11.967485
Rec Loss: 10.151783
KL Loss: 1.815702
Y Loss: 0.990791
T Loss: 9.656388
Epoch 199 
Overall Loss: 11.924707
Rec Loss: 10.118680
KL Loss: 1.806027
Y Loss: 0.998406
T Loss: 9.619477
Epoch 249 
Overall Loss: 11.921117
Rec Loss: 10.134435
KL Loss: 1.786682
Y Loss: 1.004647
T Loss: 9.632111
Epoch 299 
Overall Loss: 11.906261
Rec Loss: 10.118361
KL Loss: 1.787900
Y Loss: 1.013168
T Loss: 9.611777
Epoch 349 
Overall Loss: 11.876604
Rec Loss: 10.119949
KL Loss: 1.756656
Y Loss: 1.002462
T Loss: 9.618718
Epoch 399 
Overall Loss: 11.846253
Rec Loss: 10.101223
KL Loss: 1.745030
Y Loss: 0.990324
T Loss: 9.606061
Epoch 449 
Overall Loss: 11.856223
Rec Loss: 10.101587
KL Loss: 1.754636
Y Loss: 0.973944
T Loss: 9.614614
Epoch 499 
Overall Loss: 11.839521
Rec Loss: 10.104992
KL Loss: 1.734528
Y Loss: 0.982119
T Loss: 9.613932
Epoch 549 
Overall Loss: 11.829849
Rec Loss: 10.092575
KL Loss: 1.737275
Y Loss: 0.972178
T Loss: 9.606485
Epoch 599 
Overall Loss: 11.846081
Rec Loss: 10.098244
KL Loss: 1.747837
Y Loss: 0.971909
T Loss: 9.612289
Epoch 649 
Overall Loss: 11.839098
Rec Loss: 10.080887
KL Loss: 1.758210
Y Loss: 0.955612
T Loss: 9.603081
Epoch 699 
Overall Loss: 11.843959
Rec Loss: 10.100274
KL Loss: 1.743685
Y Loss: 0.964850
T Loss: 9.617849
Epoch 749 
Overall Loss: 11.827202
Rec Loss: 10.098760
KL Loss: 1.728442
Y Loss: 0.983821
T Loss: 9.606850
Epoch 799 
Overall Loss: 11.819582
Rec Loss: 10.072972
KL Loss: 1.746610
Y Loss: 0.963231
T Loss: 9.591357
Epoch 849 
Overall Loss: 11.807254
Rec Loss: 10.068130
KL Loss: 1.739124
Y Loss: 0.958085
T Loss: 9.589087
Epoch 899 
Overall Loss: 11.832376
Rec Loss: 10.078845
KL Loss: 1.753532
Y Loss: 0.958294
T Loss: 9.599697
Epoch 949 
Overall Loss: 11.821722
Rec Loss: 10.068722
KL Loss: 1.752999
Y Loss: 0.951477
T Loss: 9.592984
Epoch 999 
Overall Loss: 11.798391
Rec Loss: 10.060973
KL Loss: 1.737417
Y Loss: 0.945548
T Loss: 9.588199
Epoch 1049 
Overall Loss: 11.802855
Rec Loss: 10.045853
KL Loss: 1.757003
Y Loss: 0.940917
T Loss: 9.575394
Epoch 1099 
Overall Loss: 11.811552
Rec Loss: 10.070028
KL Loss: 1.741524
Y Loss: 0.951870
T Loss: 9.594093
Epoch 1149 
Overall Loss: 11.785905
Rec Loss: 10.054125
KL Loss: 1.731780
Y Loss: 0.947635
T Loss: 9.580307
Epoch 1199 
Overall Loss: 11.810154
Rec Loss: 10.063279
KL Loss: 1.746875
Y Loss: 0.955244
T Loss: 9.585658
Epoch 1249 
Overall Loss: 11.798474
Rec Loss: 10.078287
KL Loss: 1.720187
Y Loss: 0.950517
T Loss: 9.603028
Epoch 1299 
Overall Loss: 11.768494
Rec Loss: 10.042581
KL Loss: 1.725913
Y Loss: 0.921256
T Loss: 9.581953
Epoch 1349 
Overall Loss: 11.759440
Rec Loss: 10.049400
KL Loss: 1.710040
Y Loss: 0.929910
T Loss: 9.584445
Epoch 1399 
Overall Loss: 11.783559
Rec Loss: 10.051472
KL Loss: 1.732087
Y Loss: 0.944360
T Loss: 9.579292
Epoch 1449 
Overall Loss: 11.776036
Rec Loss: 10.030585
KL Loss: 1.745451
Y Loss: 0.926108
T Loss: 9.567531
Epoch 1499 
Overall Loss: 11.767631
Rec Loss: 10.029731
KL Loss: 1.737900
Y Loss: 0.914330
T Loss: 9.572566
Epoch 1549 
Overall Loss: 11.771830
Rec Loss: 10.038683
KL Loss: 1.733147
Y Loss: 0.925573
T Loss: 9.575896
Epoch 1599 
Overall Loss: 11.767472
Rec Loss: 10.034003
KL Loss: 1.733469
Y Loss: 0.927584
T Loss: 9.570211
Epoch 1649 
Overall Loss: 11.745174
Rec Loss: 10.025885
KL Loss: 1.719289
Y Loss: 0.913423
T Loss: 9.569173
Epoch 1699 
Overall Loss: 11.763185
Rec Loss: 10.028994
KL Loss: 1.734191
Y Loss: 0.907893
T Loss: 9.575047
Epoch 1749 
Overall Loss: 11.756249
Rec Loss: 10.044537
KL Loss: 1.711712
Y Loss: 0.926022
T Loss: 9.581527
Epoch 1799 
Overall Loss: 11.761034
Rec Loss: 10.020659
KL Loss: 1.740374
Y Loss: 0.913761
T Loss: 9.563779
Epoch 1849 
Overall Loss: 11.759058
Rec Loss: 10.040316
KL Loss: 1.718743
Y Loss: 0.914596
T Loss: 9.583018
Epoch 1899 
Overall Loss: 11.753281
Rec Loss: 10.033324
KL Loss: 1.719957
Y Loss: 0.917541
T Loss: 9.574553
Epoch 1949 
Overall Loss: 11.767752
Rec Loss: 10.025621
KL Loss: 1.742131
Y Loss: 0.908196
T Loss: 9.571523
Epoch 1999 
Overall Loss: 11.764999
Rec Loss: 10.012862
KL Loss: 1.752138
Y Loss: 0.926661
T Loss: 9.549532
Epoch 2049 
Overall Loss: 11.755819
Rec Loss: 10.015359
KL Loss: 1.740460
Y Loss: 0.915134
T Loss: 9.557792
Epoch 2099 
Overall Loss: 11.752693
Rec Loss: 10.008972
KL Loss: 1.743721
Y Loss: 0.912298
T Loss: 9.552823
Epoch 2149 
Overall Loss: 11.743563
Rec Loss: 10.001302
KL Loss: 1.742261
Y Loss: 0.912840
T Loss: 9.544882
Epoch 2199 
Overall Loss: 11.765575
Rec Loss: 10.037308
KL Loss: 1.728267
Y Loss: 0.918655
T Loss: 9.577981
Epoch 2249 
Overall Loss: 11.739975
Rec Loss: 10.021153
KL Loss: 1.718822
Y Loss: 0.913306
T Loss: 9.564500
Epoch 2299 
Overall Loss: 11.756261
Rec Loss: 10.018310
KL Loss: 1.737951
Y Loss: 0.907541
T Loss: 9.564539
Epoch 2349 
Overall Loss: 11.735951
Rec Loss: 10.002774
KL Loss: 1.733177
Y Loss: 0.914322
T Loss: 9.545613
Epoch 2399 
Overall Loss: 11.746910
Rec Loss: 10.001529
KL Loss: 1.745381
Y Loss: 0.905424
T Loss: 9.548817
Epoch 2449 
Overall Loss: 11.721817
Rec Loss: 10.000497
KL Loss: 1.721320
Y Loss: 0.901248
T Loss: 9.549873
Epoch 2499 
Overall Loss: 11.750199
Rec Loss: 10.016406
KL Loss: 1.733793
Y Loss: 0.923103
T Loss: 9.554854
Epoch 2549 
Overall Loss: 11.731729
Rec Loss: 9.983589
KL Loss: 1.748140
Y Loss: 0.917743
T Loss: 9.524717
Epoch 2599 
Overall Loss: 11.745800
Rec Loss: 10.032652
KL Loss: 1.713148
Y Loss: 0.928511
T Loss: 9.568397
Epoch 2649 
Overall Loss: 11.757198
Rec Loss: 10.000160
KL Loss: 1.757038
Y Loss: 0.912143
T Loss: 9.544089
Epoch 2699 
Overall Loss: 11.721001
Rec Loss: 10.016653
KL Loss: 1.704348
Y Loss: 0.919041
T Loss: 9.557133
Epoch 2749 
Overall Loss: 11.744206
Rec Loss: 10.005268
KL Loss: 1.738939
Y Loss: 0.937910
T Loss: 9.536312
Epoch 2799 
Overall Loss: 11.732653
Rec Loss: 10.014099
KL Loss: 1.718554
Y Loss: 0.908835
T Loss: 9.559681
Epoch 2849 
Overall Loss: 11.709854
Rec Loss: 10.007353
KL Loss: 1.702500
Y Loss: 0.911431
T Loss: 9.551638
Epoch 2899 
Overall Loss: 11.726968
Rec Loss: 9.987883
KL Loss: 1.739085
Y Loss: 0.900421
T Loss: 9.537672
Epoch 2949 
Overall Loss: 11.723269
Rec Loss: 10.011206
KL Loss: 1.712063
Y Loss: 0.923791
T Loss: 9.549311
Epoch 2999 
Overall Loss: 11.713442
Rec Loss: 10.002177
KL Loss: 1.711266
Y Loss: 0.922234
T Loss: 9.541060
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.714139
Epoch 99
Rec Loss: 0.732221
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.185766
Epoch 99
Rec Loss: 10.193589
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.768846
Insample Error: 2.036853
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 16.677836
Rec Loss: 12.414502
KL Loss: 4.263334
Y Loss: 7.450806
T Loss: 13.620611
X Loss: -4.931512
Epoch 99 
Overall Loss: -0.218647
Rec Loss: -10.083529
KL Loss: 9.864882
Y Loss: 4.906824
T Loss: 13.612161
X Loss: -26.149102
Epoch 149 
Overall Loss: -5.851181
Rec Loss: -17.654845
KL Loss: 11.803664
Y Loss: 3.396023
T Loss: 13.362565
X Loss: -32.715421
Epoch 199 
Overall Loss: -8.652021
Rec Loss: -21.648604
KL Loss: 12.996583
Y Loss: 2.372415
T Loss: 13.283775
X Loss: -36.118586
Epoch 249 
Overall Loss: -10.667693
Rec Loss: -24.406644
KL Loss: 13.738951
Y Loss: 1.386374
T Loss: 13.224297
X Loss: -38.324128
Epoch 299 
Overall Loss: -12.027659
Rec Loss: -26.213324
KL Loss: 14.185665
Y Loss: 0.885671
T Loss: 13.174134
X Loss: -39.830294
Epoch 349 
Overall Loss: -13.034974
Rec Loss: -27.444008
KL Loss: 14.409034
Y Loss: 0.644213
T Loss: 13.120976
X Loss: -40.887090
Epoch 399 
Overall Loss: -13.846185
Rec Loss: -28.416689
KL Loss: 14.570504
Y Loss: 0.527466
T Loss: 13.078542
X Loss: -41.758963
Epoch 449 
Overall Loss: -14.371172
Rec Loss: -29.056056
KL Loss: 14.684884
Y Loss: 0.474024
T Loss: 13.026665
X Loss: -42.319732
Epoch 499 
Overall Loss: -14.995884
Rec Loss: -29.868029
KL Loss: 14.872145
Y Loss: 0.437472
T Loss: 12.959808
X Loss: -43.046574
Epoch 549 
Overall Loss: -15.404172
Rec Loss: -30.445972
KL Loss: 15.041801
Y Loss: 0.422738
T Loss: 12.884367
X Loss: -43.541709
Epoch 599 
Overall Loss: -16.039340
Rec Loss: -31.186120
KL Loss: 15.146780
Y Loss: 0.427176
T Loss: 12.785534
X Loss: -44.185241
Epoch 649 
Overall Loss: -16.566009
Rec Loss: -31.858178
KL Loss: 15.292169
Y Loss: 0.422835
T Loss: 12.693669
X Loss: -44.763265
Epoch 699 
Overall Loss: -16.957928
Rec Loss: -32.342678
KL Loss: 15.384750
Y Loss: 0.401836
T Loss: 12.633997
X Loss: -45.177593
Epoch 749 
Overall Loss: -17.455069
Rec Loss: -32.907098
KL Loss: 15.452029
Y Loss: 0.395694
T Loss: 12.562023
X Loss: -45.666968
Epoch 799 
Overall Loss: -17.339056
Rec Loss: -32.787000
KL Loss: 15.447943
Y Loss: 0.413840
T Loss: 12.538956
X Loss: -45.532876
Epoch 849 
Overall Loss: -18.039254
Rec Loss: -33.502205
KL Loss: 15.462951
Y Loss: 0.408303
T Loss: 12.476862
X Loss: -46.183218
Epoch 899 
Overall Loss: -18.469555
Rec Loss: -34.018162
KL Loss: 15.548607
Y Loss: 0.412826
T Loss: 12.453911
X Loss: -46.678485
Epoch 949 
Overall Loss: -18.686849
Rec Loss: -34.165781
KL Loss: 15.478932
Y Loss: 0.421377
T Loss: 12.427577
X Loss: -46.804047
Epoch 999 
Overall Loss: -18.818022
Rec Loss: -34.333006
KL Loss: 15.514984
Y Loss: 0.430454
T Loss: 12.370753
X Loss: -46.918986
Epoch 1049 
Overall Loss: -19.244406
Rec Loss: -34.881149
KL Loss: 15.636745
Y Loss: 0.422878
T Loss: 12.341524
X Loss: -47.434114
Epoch 1099 
Overall Loss: -19.576741
Rec Loss: -35.219260
KL Loss: 15.642519
Y Loss: 0.417580
T Loss: 12.316981
X Loss: -47.745031
Epoch 1149 
Overall Loss: -19.770834
Rec Loss: -35.273655
KL Loss: 15.502821
Y Loss: 0.448217
T Loss: 12.292799
X Loss: -47.790562
Epoch 1199 
Overall Loss: -19.874753
Rec Loss: -35.482005
KL Loss: 15.607253
Y Loss: 0.468216
T Loss: 12.276170
X Loss: -47.992283
Epoch 1249 
Overall Loss: -20.512000
Rec Loss: -36.097403
KL Loss: 15.585403
Y Loss: 0.481244
T Loss: 12.230461
X Loss: -48.568486
Epoch 1299 
Overall Loss: -20.475123
Rec Loss: -36.052676
KL Loss: 15.577553
Y Loss: 0.475964
T Loss: 12.211879
X Loss: -48.502537
Epoch 1349 
Overall Loss: -20.915967
Rec Loss: -36.568839
KL Loss: 15.652870
Y Loss: 0.479585
T Loss: 12.183487
X Loss: -48.992116
Epoch 1399 
Overall Loss: -21.169714
Rec Loss: -36.856007
KL Loss: 15.686293
Y Loss: 0.507433
T Loss: 12.174133
X Loss: -49.283857
Epoch 1449 
Overall Loss: -21.401259
Rec Loss: -37.111767
KL Loss: 15.710507
Y Loss: 0.518389
T Loss: 12.145487
X Loss: -49.516448
Epoch 1499 
Overall Loss: -21.518939
Rec Loss: -37.077751
KL Loss: 15.558812
Y Loss: 0.526503
T Loss: 12.135055
X Loss: -49.476057
Epoch 1549 
Overall Loss: -21.836975
Rec Loss: -37.543889
KL Loss: 15.706913
Y Loss: 0.508284
T Loss: 12.107853
X Loss: -49.905884
Epoch 1599 
Overall Loss: -21.933807
Rec Loss: -37.659292
KL Loss: 15.725483
Y Loss: 0.542232
T Loss: 12.061975
X Loss: -49.992382
Epoch 1649 
Overall Loss: -21.932017
Rec Loss: -37.721991
KL Loss: 15.789974
Y Loss: 0.515216
T Loss: 12.035231
X Loss: -50.014830
Epoch 1699 
Overall Loss: -22.388886
Rec Loss: -38.186441
KL Loss: 15.797556
Y Loss: 0.540795
T Loss: 12.007277
X Loss: -50.464115
Epoch 1749 
Overall Loss: -22.482735
Rec Loss: -38.281733
KL Loss: 15.798998
Y Loss: 0.512054
T Loss: 11.981361
X Loss: -50.519121
Epoch 1799 
Overall Loss: -22.646322
Rec Loss: -38.519252
KL Loss: 15.872930
Y Loss: 0.513452
T Loss: 11.964230
X Loss: -50.740208
Epoch 1849 
Overall Loss: -22.567810
Rec Loss: -38.261323
KL Loss: 15.693513
Y Loss: 0.536083
T Loss: 11.946202
X Loss: -50.475566
Epoch 1899 
Overall Loss: -22.676536
Rec Loss: -38.322981
KL Loss: 15.646445
Y Loss: 0.528869
T Loss: 11.903106
X Loss: -50.490523
Epoch 1949 
Overall Loss: -23.093021
Rec Loss: -39.037589
KL Loss: 15.944567
Y Loss: 0.493127
T Loss: 11.844039
X Loss: -51.128192
Epoch 1999 
Overall Loss: -23.224649
Rec Loss: -39.237271
KL Loss: 16.012622
Y Loss: 0.485363
T Loss: 11.808912
X Loss: -51.288864
Epoch 2049 
Overall Loss: -23.232111
Rec Loss: -39.217903
KL Loss: 15.985791
Y Loss: 0.473661
T Loss: 11.768794
X Loss: -51.223526
Epoch 2099 
Overall Loss: -23.695870
Rec Loss: -39.748552
KL Loss: 16.052681
Y Loss: 0.458958
T Loss: 11.720042
X Loss: -51.698073
Epoch 2149 
Overall Loss: -23.823944
Rec Loss: -39.678269
KL Loss: 15.854324
Y Loss: 0.480795
T Loss: 11.698022
X Loss: -51.616688
Epoch 2199 
Overall Loss: -23.611765
Rec Loss: -39.624960
KL Loss: 16.013194
Y Loss: 0.448760
T Loss: 11.633837
X Loss: -51.483177
Epoch 2249 
Overall Loss: -23.797125
Rec Loss: -39.622213
KL Loss: 15.825088
Y Loss: 0.450632
T Loss: 11.611331
X Loss: -51.458860
Epoch 2299 
Overall Loss: -23.930036
Rec Loss: -40.124486
KL Loss: 16.194450
Y Loss: 0.416664
T Loss: 11.525126
X Loss: -51.857944
Epoch 2349 
Overall Loss: -24.132244
Rec Loss: -40.140675
KL Loss: 16.008431
Y Loss: 0.424627
T Loss: 11.494109
X Loss: -51.847097
Epoch 2399 
Overall Loss: -24.474977
Rec Loss: -40.618123
KL Loss: 16.143148
Y Loss: 0.417011
T Loss: 11.432498
X Loss: -52.259127
Epoch 2449 
Overall Loss: -24.714904
Rec Loss: -40.854116
KL Loss: 16.139213
Y Loss: 0.403776
T Loss: 11.398341
X Loss: -52.454346
Epoch 2499 
Overall Loss: -24.492304
Rec Loss: -40.751105
KL Loss: 16.258801
Y Loss: 0.389820
T Loss: 11.350496
X Loss: -52.296511
Epoch 2549 
Overall Loss: -24.988847
Rec Loss: -41.206739
KL Loss: 16.217893
Y Loss: 0.379673
T Loss: 11.304042
X Loss: -52.700618
Epoch 2599 
Overall Loss: -25.080472
Rec Loss: -41.324206
KL Loss: 16.243733
Y Loss: 0.382516
T Loss: 11.273330
X Loss: -52.788793
Epoch 2649 
Overall Loss: -25.238099
Rec Loss: -41.483827
KL Loss: 16.245729
Y Loss: 0.368356
T Loss: 11.243475
X Loss: -52.911481
Epoch 2699 
Overall Loss: -24.922930
Rec Loss: -41.169022
KL Loss: 16.246092
Y Loss: 0.367744
T Loss: 11.182035
X Loss: -52.534929
Epoch 2749 
Overall Loss: -25.207897
Rec Loss: -41.542583
KL Loss: 16.334687
Y Loss: 0.350294
T Loss: 11.151174
X Loss: -52.868905
Epoch 2799 
Overall Loss: -25.517727
Rec Loss: -41.882320
KL Loss: 16.364593
Y Loss: 0.341355
T Loss: 11.132136
X Loss: -53.185135
Epoch 2849 
Overall Loss: -25.167265
Rec Loss: -41.453646
KL Loss: 16.286380
Y Loss: 0.339341
T Loss: 11.114834
X Loss: -52.738151
Epoch 2899 
Overall Loss: -25.895915
Rec Loss: -42.159471
KL Loss: 16.263557
Y Loss: 0.342731
T Loss: 11.074719
X Loss: -53.405555
Epoch 2949 
Overall Loss: -25.869383
Rec Loss: -42.322212
KL Loss: 16.452829
Y Loss: 0.314171
T Loss: 11.053629
X Loss: -53.532926
Epoch 2999 
Overall Loss: -25.419790
Rec Loss: -41.660237
KL Loss: 16.240446
Y Loss: 0.338063
T Loss: 11.044983
X Loss: -52.874251
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.323407
Epoch 99
Rec Loss: 2.311810
Epoch 149
Rec Loss: 2.291619
Epoch 199
Rec Loss: 2.280172
Epoch 249
Rec Loss: 2.271495
Epoch 299
Rec Loss: 2.265377
Epoch 349
Rec Loss: 2.260594
Epoch 399
Rec Loss: 2.273759
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.003561
Epoch 99
Rec Loss: 0.001793
Epoch 149
Rec Loss: 0.002147
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.364342
Insample Error 3.636688
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.561872
Epoch 99 
Prediction Loss: 2.159276
Epoch 149 
Prediction Loss: 2.039397
Epoch 199 
Prediction Loss: 2.015912
Epoch 249 
Prediction Loss: 1.975683
Epoch 299 
Prediction Loss: 1.945370
Epoch 349 
Prediction Loss: 1.920098
Epoch 399 
Prediction Loss: 1.908551
Epoch 449 
Prediction Loss: 1.893916
Epoch 499 
Prediction Loss: 1.894583
Epoch 549 
Prediction Loss: 1.870457
Epoch 599 
Prediction Loss: 1.870031
Epoch 649 
Prediction Loss: 1.866673
Epoch 699 
Prediction Loss: 1.838813
Epoch 749 
Prediction Loss: 1.832951
Epoch 799 
Prediction Loss: 1.815166
Epoch 849 
Prediction Loss: 1.814485
Epoch 899 
Prediction Loss: 1.790750
Epoch 949 
Prediction Loss: 1.799525
Epoch 999 
Prediction Loss: 1.777052
Epoch 1049 
Prediction Loss: 1.774266
Epoch 1099 
Prediction Loss: 1.794196
Epoch 1149 
Prediction Loss: 1.752099
Epoch 1199 
Prediction Loss: 1.752105
Epoch 1249 
Prediction Loss: 1.738527
Epoch 1299 
Prediction Loss: 1.730164
Epoch 1349 
Prediction Loss: 1.731922
Epoch 1399 
Prediction Loss: 1.746679
Epoch 1449 
Prediction Loss: 1.706204
Epoch 1499 
Prediction Loss: 1.732228
Epoch 1549 
Prediction Loss: 1.693179
Epoch 1599 
Prediction Loss: 1.693154
Epoch 1649 
Prediction Loss: 1.686556
Epoch 1699 
Prediction Loss: 1.675681
Epoch 1749 
Prediction Loss: 1.670925
Epoch 1799 
Prediction Loss: 1.654965
Epoch 1849 
Prediction Loss: 1.655307
Epoch 1899 
Prediction Loss: 1.647657
Epoch 1949 
Prediction Loss: 1.634690
Epoch 1999 
Prediction Loss: 1.639131
Epoch 2049 
Prediction Loss: 1.637158
Epoch 2099 
Prediction Loss: 1.627796
Epoch 2149 
Prediction Loss: 1.604170
Epoch 2199 
Prediction Loss: 1.601082
Epoch 2249 
Prediction Loss: 1.586211
Epoch 2299 
Prediction Loss: 1.581903
Epoch 2349 
Prediction Loss: 1.582204
Epoch 2399 
Prediction Loss: 1.579078
Epoch 2449 
Prediction Loss: 1.568629
Epoch 2499 
Prediction Loss: 1.553761
Epoch 2549 
Prediction Loss: 1.547851
Epoch 2599 
Prediction Loss: 1.565932
Epoch 2649 
Prediction Loss: 1.532466
Epoch 2699 
Prediction Loss: 1.525909
Epoch 2749 
Prediction Loss: 1.552299
Epoch 2799 
Prediction Loss: 1.521717
Epoch 2849 
Prediction Loss: 1.513246
Epoch 2899 
Prediction Loss: 1.499530
Epoch 2949 
Prediction Loss: 1.491294
Epoch 2999 
Prediction Loss: 1.492093
Epoch 3049 
Prediction Loss: 1.490425
Epoch 3099 
Prediction Loss: 1.472492
Epoch 3149 
Prediction Loss: 1.480354
Epoch 3199 
Prediction Loss: 1.462332
Epoch 3249 
Prediction Loss: 1.455521
Epoch 3299 
Prediction Loss: 1.470688
Epoch 3349 
Prediction Loss: 1.460434
Epoch 3399 
Prediction Loss: 1.440764
Epoch 3449 
Prediction Loss: 1.446560
Epoch 3499 
Prediction Loss: 1.464228
Epoch 3549 
Prediction Loss: 1.424699
Epoch 3599 
Prediction Loss: 1.414534
Epoch 3649 
Prediction Loss: 1.421107
Epoch 3699 
Prediction Loss: 1.405986
Epoch 3749 
Prediction Loss: 1.396032
Epoch 3799 
Prediction Loss: 1.390154
Epoch 3849 
Prediction Loss: 1.393056
Epoch 3899 
Prediction Loss: 1.381201
Epoch 3949 
Prediction Loss: 1.382378
Epoch 3999 
Prediction Loss: 1.369437
Epoch 4049 
Prediction Loss: 1.365656
Epoch 4099 
Prediction Loss: 1.368798
Epoch 4149 
Prediction Loss: 1.347325
Epoch 4199 
Prediction Loss: 1.371598
Epoch 4249 
Prediction Loss: 1.343210
Epoch 4299 
Prediction Loss: 1.338619
Epoch 4349 
Prediction Loss: 1.345898
Epoch 4399 
Prediction Loss: 1.328926
Epoch 4449 
Prediction Loss: 1.333910
Epoch 4499 
Prediction Loss: 1.330662
Epoch 4549 
Prediction Loss: 1.313747
Epoch 4599 
Prediction Loss: 1.316130
Epoch 4649 
Prediction Loss: 1.311206
Epoch 4699 
Prediction Loss: 1.300584
Epoch 4749 
Prediction Loss: 1.302649
Epoch 4799 
Prediction Loss: 1.320405
Epoch 4849 
Prediction Loss: 1.284712
Epoch 4899 
Prediction Loss: 1.296473
Epoch 4949 
Prediction Loss: 1.280736
Epoch 4999 
Prediction Loss: 1.286612
Epoch 5049 
Prediction Loss: 1.289625
Epoch 5099 
Prediction Loss: 1.259438
Epoch 5149 
Prediction Loss: 1.273057
Epoch 5199 
Prediction Loss: 1.272804
Epoch 5249 
Prediction Loss: 1.243542
Epoch 5299 
Prediction Loss: 1.242701
Epoch 5349 
Prediction Loss: 1.268969
Epoch 5399 
Prediction Loss: 1.239556
Epoch 5449 
Prediction Loss: 1.235594
Epoch 5499 
Prediction Loss: 1.245233
Epoch 5549 
Prediction Loss: 1.227614
Epoch 5599 
Prediction Loss: 1.246382
Epoch 5649 
Prediction Loss: 1.222881
Epoch 5699 
Prediction Loss: 1.209488
Epoch 5749 
Prediction Loss: 1.208951
Epoch 5799 
Prediction Loss: 1.206206
Epoch 5849 
Prediction Loss: 1.215488
Epoch 5899 
Prediction Loss: 1.193201
Epoch 5949 
Prediction Loss: 1.189029
Epoch 5999 
Prediction Loss: 1.193446
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.097774
Insample Error 3.120694
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.215818
Rec Loss: 10.091623
KL Loss: 2.124195
Y Loss: 0.985081
T Loss: 9.599083
Epoch 99 
Overall Loss: 12.027053
Rec Loss: 10.139653
KL Loss: 1.887400
Y Loss: 1.010553
T Loss: 9.634376
Epoch 149 
Overall Loss: 11.972668
Rec Loss: 10.136754
KL Loss: 1.835914
Y Loss: 1.002942
T Loss: 9.635284
Epoch 199 
Overall Loss: 11.921851
Rec Loss: 10.123071
KL Loss: 1.798780
Y Loss: 0.969375
T Loss: 9.638383
Epoch 249 
Overall Loss: 11.918414
Rec Loss: 10.127518
KL Loss: 1.790897
Y Loss: 1.012882
T Loss: 9.621077
Epoch 299 
Overall Loss: 11.873340
Rec Loss: 10.119822
KL Loss: 1.753518
Y Loss: 0.997444
T Loss: 9.621100
Epoch 349 
Overall Loss: 11.853637
Rec Loss: 10.088747
KL Loss: 1.764890
Y Loss: 0.986725
T Loss: 9.595385
Epoch 399 
Overall Loss: 11.861904
Rec Loss: 10.081801
KL Loss: 1.780103
Y Loss: 0.981413
T Loss: 9.591095
Epoch 449 
Overall Loss: 11.832680
Rec Loss: 10.081440
KL Loss: 1.751240
Y Loss: 0.960866
T Loss: 9.601007
Epoch 499 
Overall Loss: 11.844259
Rec Loss: 10.092071
KL Loss: 1.752188
Y Loss: 0.968775
T Loss: 9.607684
Epoch 549 
Overall Loss: 11.846024
Rec Loss: 10.115003
KL Loss: 1.731021
Y Loss: 0.977814
T Loss: 9.626096
Epoch 599 
Overall Loss: 11.827678
Rec Loss: 10.100313
KL Loss: 1.727365
Y Loss: 0.996395
T Loss: 9.602115
Epoch 649 
Overall Loss: 11.810773
Rec Loss: 10.073889
KL Loss: 1.736885
Y Loss: 0.940029
T Loss: 9.603874
Epoch 699 
Overall Loss: 11.826093
Rec Loss: 10.106711
KL Loss: 1.719382
Y Loss: 0.986911
T Loss: 9.613255
Epoch 749 
Overall Loss: 11.834326
Rec Loss: 10.080444
KL Loss: 1.753883
Y Loss: 0.987396
T Loss: 9.586745
Epoch 799 
Overall Loss: 11.811934
Rec Loss: 10.072144
KL Loss: 1.739790
Y Loss: 0.969283
T Loss: 9.587502
Epoch 849 
Overall Loss: 11.824201
Rec Loss: 10.104998
KL Loss: 1.719203
Y Loss: 0.979451
T Loss: 9.615272
Epoch 899 
Overall Loss: 11.802124
Rec Loss: 10.061754
KL Loss: 1.740370
Y Loss: 0.964934
T Loss: 9.579287
Epoch 949 
Overall Loss: 11.788470
Rec Loss: 10.071988
KL Loss: 1.716482
Y Loss: 0.945410
T Loss: 9.599283
Epoch 999 
Overall Loss: 11.800070
Rec Loss: 10.061346
KL Loss: 1.738725
Y Loss: 0.936277
T Loss: 9.593207
Epoch 1049 
Overall Loss: 11.803946
Rec Loss: 10.078684
KL Loss: 1.725262
Y Loss: 0.946416
T Loss: 9.605476
Epoch 1099 
Overall Loss: 11.795580
Rec Loss: 10.055269
KL Loss: 1.740312
Y Loss: 0.925244
T Loss: 9.592646
Epoch 1149 
Overall Loss: 11.776770
Rec Loss: 10.053185
KL Loss: 1.723585
Y Loss: 0.959613
T Loss: 9.573379
Epoch 1199 
Overall Loss: 11.778466
Rec Loss: 10.048723
KL Loss: 1.729743
Y Loss: 0.951989
T Loss: 9.572728
Epoch 1249 
Overall Loss: 11.805962
Rec Loss: 10.076835
KL Loss: 1.729127
Y Loss: 0.950355
T Loss: 9.601658
Epoch 1299 
Overall Loss: 11.807625
Rec Loss: 10.054055
KL Loss: 1.753570
Y Loss: 0.936752
T Loss: 9.585678
Epoch 1349 
Overall Loss: 11.802102
Rec Loss: 10.064267
KL Loss: 1.737835
Y Loss: 0.954786
T Loss: 9.586875
Epoch 1399 
Overall Loss: 11.783740
Rec Loss: 10.045108
KL Loss: 1.738632
Y Loss: 0.933253
T Loss: 9.578482
Epoch 1449 
Overall Loss: 11.772789
Rec Loss: 10.057960
KL Loss: 1.714829
Y Loss: 0.962016
T Loss: 9.576952
Epoch 1499 
Overall Loss: 11.807379
Rec Loss: 10.062548
KL Loss: 1.744830
Y Loss: 0.945597
T Loss: 9.589750
Epoch 1549 
Overall Loss: 11.770016
Rec Loss: 10.016291
KL Loss: 1.753726
Y Loss: 0.926444
T Loss: 9.553069
Epoch 1599 
Overall Loss: 11.770304
Rec Loss: 10.041039
KL Loss: 1.729266
Y Loss: 0.917812
T Loss: 9.582132
Epoch 1649 
Overall Loss: 11.766618
Rec Loss: 10.045017
KL Loss: 1.721601
Y Loss: 0.943290
T Loss: 9.573372
Epoch 1699 
Overall Loss: 11.774375
Rec Loss: 10.032198
KL Loss: 1.742177
Y Loss: 0.934342
T Loss: 9.565027
Epoch 1749 
Overall Loss: 11.771648
Rec Loss: 10.047944
KL Loss: 1.723704
Y Loss: 0.936071
T Loss: 9.579908
Epoch 1799 
Overall Loss: 11.752129
Rec Loss: 10.018350
KL Loss: 1.733779
Y Loss: 0.929898
T Loss: 9.553401
Epoch 1849 
Overall Loss: 11.779185
Rec Loss: 10.040444
KL Loss: 1.738741
Y Loss: 0.930228
T Loss: 9.575330
Epoch 1899 
Overall Loss: 11.751493
Rec Loss: 10.027927
KL Loss: 1.723566
Y Loss: 0.947392
T Loss: 9.554232
Epoch 1949 
Overall Loss: 11.764584
Rec Loss: 10.030324
KL Loss: 1.734259
Y Loss: 0.950825
T Loss: 9.554912
Epoch 1999 
Overall Loss: 11.759221
Rec Loss: 10.039387
KL Loss: 1.719835
Y Loss: 0.921606
T Loss: 9.578584
Epoch 2049 
Overall Loss: 11.751692
Rec Loss: 10.032987
KL Loss: 1.718704
Y Loss: 0.940890
T Loss: 9.562542
Epoch 2099 
Overall Loss: 11.769779
Rec Loss: 10.029135
KL Loss: 1.740643
Y Loss: 0.940833
T Loss: 9.558719
Epoch 2149 
Overall Loss: 11.746015
Rec Loss: 10.023033
KL Loss: 1.722982
Y Loss: 0.951557
T Loss: 9.547254
Epoch 2199 
Overall Loss: 11.757795
Rec Loss: 10.042987
KL Loss: 1.714808
Y Loss: 0.942015
T Loss: 9.571980
Epoch 2249 
Overall Loss: 11.713872
Rec Loss: 10.019542
KL Loss: 1.694329
Y Loss: 0.943701
T Loss: 9.547692
Epoch 2299 
Overall Loss: 11.749580
Rec Loss: 10.001464
KL Loss: 1.748116
Y Loss: 0.914981
T Loss: 9.543974
Epoch 2349 
Overall Loss: 11.748286
Rec Loss: 10.027126
KL Loss: 1.721160
Y Loss: 0.935811
T Loss: 9.559220
Epoch 2399 
Overall Loss: 11.733591
Rec Loss: 9.990581
KL Loss: 1.743010
Y Loss: 0.900624
T Loss: 9.540269
Epoch 2449 
Overall Loss: 11.752739
Rec Loss: 10.026398
KL Loss: 1.726342
Y Loss: 0.903754
T Loss: 9.574521
Epoch 2499 
Overall Loss: 11.719201
Rec Loss: 9.996248
KL Loss: 1.722954
Y Loss: 0.906289
T Loss: 9.543103
Epoch 2549 
Overall Loss: 11.743329
Rec Loss: 10.032949
KL Loss: 1.710380
Y Loss: 0.921783
T Loss: 9.572057
Epoch 2599 
Overall Loss: 11.731724
Rec Loss: 10.012299
KL Loss: 1.719425
Y Loss: 0.904167
T Loss: 9.560215
Epoch 2649 
Overall Loss: 11.740208
Rec Loss: 10.018812
KL Loss: 1.721396
Y Loss: 0.927228
T Loss: 9.555198
Epoch 2699 
Overall Loss: 11.712267
Rec Loss: 10.008565
KL Loss: 1.703702
Y Loss: 0.905254
T Loss: 9.555938
Epoch 2749 
Overall Loss: 11.727954
Rec Loss: 9.997024
KL Loss: 1.730930
Y Loss: 0.924424
T Loss: 9.534813
Epoch 2799 
Overall Loss: 11.731928
Rec Loss: 10.019114
KL Loss: 1.712814
Y Loss: 0.927198
T Loss: 9.555515
Epoch 2849 
Overall Loss: 11.721481
Rec Loss: 10.020242
KL Loss: 1.701239
Y Loss: 0.944362
T Loss: 9.548061
Epoch 2899 
Overall Loss: 11.723041
Rec Loss: 10.007298
KL Loss: 1.715743
Y Loss: 0.929580
T Loss: 9.542508
Epoch 2949 
Overall Loss: 11.740344
Rec Loss: 10.027885
KL Loss: 1.712459
Y Loss: 0.918410
T Loss: 9.568680
Epoch 2999 
Overall Loss: 11.713167
Rec Loss: 10.006340
KL Loss: 1.706828
Y Loss: 0.912362
T Loss: 9.550158
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.712286
Epoch 99
Rec Loss: 0.705649
Epoch 149
Rec Loss: 0.703550
Epoch 199
Rec Loss: 0.713030
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.182352
Epoch 99
Rec Loss: 10.177188
Epoch 149
Rec Loss: 10.171207
Epoch 199
Rec Loss: 10.165315
Epoch 249
Rec Loss: 10.170332
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.775451
Insample Error: 1.976941
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 18.548166
Rec Loss: 15.369771
KL Loss: 3.178394
Y Loss: 5.633812
T Loss: 13.428333
X Loss: -0.875468
Epoch 99 
Overall Loss: 3.429249
Rec Loss: -7.457285
KL Loss: 10.886534
Y Loss: 1.745894
T Loss: 13.005837
X Loss: -21.336068
Epoch 149 
Overall Loss: -3.429189
Rec Loss: -15.465953
KL Loss: 12.036764
Y Loss: 0.967451
T Loss: 12.160905
X Loss: -28.110584
Epoch 199 
Overall Loss: -7.561717
Rec Loss: -20.832879
KL Loss: 13.271162
Y Loss: 0.512528
T Loss: 11.683210
X Loss: -32.772354
Epoch 249 
Overall Loss: -9.742679
Rec Loss: -23.997045
KL Loss: 14.254366
Y Loss: 0.389842
T Loss: 11.552143
X Loss: -35.744108
Epoch 299 
Overall Loss: -11.476852
Rec Loss: -26.392628
KL Loss: 14.915776
Y Loss: 0.335402
T Loss: 11.514257
X Loss: -38.074586
Epoch 349 
Overall Loss: -12.695254
Rec Loss: -28.016693
KL Loss: 15.321439
Y Loss: 0.310405
T Loss: 11.498009
X Loss: -39.669904
Epoch 399 
Overall Loss: -13.540843
Rec Loss: -29.250118
KL Loss: 15.709275
Y Loss: 0.329390
T Loss: 11.481072
X Loss: -40.895885
Epoch 449 
Overall Loss: -14.279443
Rec Loss: -30.255043
KL Loss: 15.975600
Y Loss: 0.305295
T Loss: 11.477967
X Loss: -41.885657
Epoch 499 
Overall Loss: -14.938269
Rec Loss: -30.996375
KL Loss: 16.058106
Y Loss: 0.310870
T Loss: 11.487668
X Loss: -42.639478
Epoch 549 
Overall Loss: -15.453080
Rec Loss: -31.693666
KL Loss: 16.240586
Y Loss: 0.293827
T Loss: 11.472172
X Loss: -43.312751
Epoch 599 
Overall Loss: -15.725597
Rec Loss: -32.181853
KL Loss: 16.456256
Y Loss: 0.274301
T Loss: 11.459951
X Loss: -43.778953
Epoch 649 
Overall Loss: -16.059839
Rec Loss: -32.641554
KL Loss: 16.581716
Y Loss: 0.269704
T Loss: 11.457282
X Loss: -44.233689
Epoch 699 
Overall Loss: -16.652636
Rec Loss: -33.295938
KL Loss: 16.643303
Y Loss: 0.268086
T Loss: 11.445611
X Loss: -44.875592
Epoch 749 
Overall Loss: -16.916975
Rec Loss: -33.824784
KL Loss: 16.907810
Y Loss: 0.252024
T Loss: 11.426683
X Loss: -45.377479
Epoch 799 
Overall Loss: -17.190102
Rec Loss: -34.161400
KL Loss: 16.971299
Y Loss: 0.242612
T Loss: 11.424194
X Loss: -45.706900
Epoch 849 
Overall Loss: -17.248217
Rec Loss: -34.054388
KL Loss: 16.806172
Y Loss: 0.243329
T Loss: 11.424107
X Loss: -45.600161
Epoch 899 
Overall Loss: -17.865558
Rec Loss: -35.008089
KL Loss: 17.142531
Y Loss: 0.226132
T Loss: 11.392493
X Loss: -46.513647
Epoch 949 
Overall Loss: -18.118069
Rec Loss: -35.396558
KL Loss: 17.278489
Y Loss: 0.235040
T Loss: 11.369126
X Loss: -46.883205
Epoch 999 
Overall Loss: -18.272783
Rec Loss: -35.717504
KL Loss: 17.444721
Y Loss: 0.218835
T Loss: 11.355827
X Loss: -47.182750
Epoch 1049 
Overall Loss: -18.242990
Rec Loss: -35.722812
KL Loss: 17.479821
Y Loss: 0.212921
T Loss: 11.363182
X Loss: -47.192454
Epoch 1099 
Overall Loss: -18.398540
Rec Loss: -35.824586
KL Loss: 17.426045
Y Loss: 0.211092
T Loss: 11.358221
X Loss: -47.288352
Epoch 1149 
Overall Loss: -19.000275
Rec Loss: -36.597936
KL Loss: 17.597662
Y Loss: 0.197843
T Loss: 11.339422
X Loss: -48.036280
Epoch 1199 
Overall Loss: -19.182511
Rec Loss: -36.859356
KL Loss: 17.676846
Y Loss: 0.188666
T Loss: 11.330034
X Loss: -48.283724
Epoch 1249 
Overall Loss: -19.323630
Rec Loss: -37.081056
KL Loss: 17.757426
Y Loss: 0.191042
T Loss: 11.327592
X Loss: -48.504170
Epoch 1299 
Overall Loss: -19.132247
Rec Loss: -36.984696
KL Loss: 17.852449
Y Loss: 0.184627
T Loss: 11.291007
X Loss: -48.368016
Epoch 1349 
Overall Loss: -19.648816
Rec Loss: -37.331927
KL Loss: 17.683112
Y Loss: 0.177828
T Loss: 11.311381
X Loss: -48.732223
Epoch 1399 
Overall Loss: -19.844867
Rec Loss: -37.784844
KL Loss: 17.939976
Y Loss: 0.170964
T Loss: 11.274129
X Loss: -49.144454
Epoch 1449 
Overall Loss: -19.388696
Rec Loss: -37.381707
KL Loss: 17.993010
Y Loss: 0.172316
T Loss: 11.258438
X Loss: -48.726303
Epoch 1499 
Overall Loss: -20.122002
Rec Loss: -38.092205
KL Loss: 17.970204
Y Loss: 0.163341
T Loss: 11.240618
X Loss: -49.414494
Epoch 1549 
Overall Loss: -20.100122
Rec Loss: -37.907932
KL Loss: 17.807809
Y Loss: 0.173186
T Loss: 11.258013
X Loss: -49.252538
Epoch 1599 
Overall Loss: -19.790411
Rec Loss: -37.870140
KL Loss: 18.079730
Y Loss: 0.160072
T Loss: 11.237485
X Loss: -49.187663
Epoch 1649 
Overall Loss: -20.375874
Rec Loss: -38.478358
KL Loss: 18.102484
Y Loss: 0.152427
T Loss: 11.233594
X Loss: -49.788166
Epoch 1699 
Overall Loss: -20.744940
Rec Loss: -39.071836
KL Loss: 18.326895
Y Loss: 0.144645
T Loss: 11.207898
X Loss: -50.352056
Epoch 1749 
Overall Loss: -20.926769
Rec Loss: -39.222730
KL Loss: 18.295960
Y Loss: 0.141054
T Loss: 11.187970
X Loss: -50.481228
Epoch 1799 
Overall Loss: -20.880476
Rec Loss: -39.049117
KL Loss: 18.168641
Y Loss: 0.142485
T Loss: 11.183691
X Loss: -50.304051
Epoch 1849 
Overall Loss: -20.936437
Rec Loss: -39.301994
KL Loss: 18.365556
Y Loss: 0.136986
T Loss: 11.173521
X Loss: -50.544007
Epoch 1899 
Overall Loss: -20.930157
Rec Loss: -39.308047
KL Loss: 18.377889
Y Loss: 0.143351
T Loss: 11.154772
X Loss: -50.534494
Epoch 1949 
Overall Loss: -21.040597
Rec Loss: -39.457455
KL Loss: 18.416858
Y Loss: 0.134147
T Loss: 11.128977
X Loss: -50.653506
Epoch 1999 
Overall Loss: -21.225007
Rec Loss: -39.570721
KL Loss: 18.345713
Y Loss: 0.128827
T Loss: 11.135091
X Loss: -50.770225
Epoch 2049 
Overall Loss: -21.374927
Rec Loss: -39.899901
KL Loss: 18.524974
Y Loss: 0.122939
T Loss: 11.127248
X Loss: -51.088619
Epoch 2099 
Overall Loss: -21.747843
Rec Loss: -40.277092
KL Loss: 18.529250
Y Loss: 0.116654
T Loss: 11.106349
X Loss: -51.441770
Epoch 2149 
Overall Loss: -21.833193
Rec Loss: -40.453537
KL Loss: 18.620345
Y Loss: 0.119716
T Loss: 11.101242
X Loss: -51.614638
Epoch 2199 
Overall Loss: -21.868542
Rec Loss: -40.281123
KL Loss: 18.412580
Y Loss: 0.116786
T Loss: 11.086515
X Loss: -51.426031
Epoch 2249 
Overall Loss: -22.117639
Rec Loss: -40.735159
KL Loss: 18.617520
Y Loss: 0.115848
T Loss: 11.068954
X Loss: -51.862037
Epoch 2299 
Overall Loss: -21.899531
Rec Loss: -40.369227
KL Loss: 18.469697
Y Loss: 0.113666
T Loss: 11.083884
X Loss: -51.509944
Epoch 2349 
Overall Loss: -21.886164
Rec Loss: -40.622932
KL Loss: 18.736767
Y Loss: 0.110997
T Loss: 11.051349
X Loss: -51.729779
Epoch 2399 
Overall Loss: -22.256541
Rec Loss: -40.939201
KL Loss: 18.682660
Y Loss: 0.104046
T Loss: 11.038154
X Loss: -52.029377
Epoch 2449 
Overall Loss: -21.728184
Rec Loss: -40.262820
KL Loss: 18.534637
Y Loss: 0.108455
T Loss: 11.064197
X Loss: -51.381244
Epoch 2499 
Overall Loss: -22.404079
Rec Loss: -41.030047
KL Loss: 18.625968
Y Loss: 0.102407
T Loss: 11.046684
X Loss: -52.127935
Epoch 2549 
Overall Loss: -22.342512
Rec Loss: -41.198434
KL Loss: 18.855923
Y Loss: 0.107155
T Loss: 11.019032
X Loss: -52.271045
Epoch 2599 
Overall Loss: -22.324247
Rec Loss: -41.271092
KL Loss: 18.946846
Y Loss: 0.095317
T Loss: 10.991809
X Loss: -52.310559
Epoch 2649 
Overall Loss: -22.683766
Rec Loss: -41.498757
KL Loss: 18.814991
Y Loss: 0.100221
T Loss: 11.011468
X Loss: -52.560336
Epoch 2699 
Overall Loss: -22.779890
Rec Loss: -41.596899
KL Loss: 18.817009
Y Loss: 0.103529
T Loss: 11.008265
X Loss: -52.656929
Epoch 2749 
Overall Loss: -22.516494
Rec Loss: -41.033101
KL Loss: 18.516606
Y Loss: 0.103574
T Loss: 11.017992
X Loss: -52.102879
Epoch 2799 
Overall Loss: -22.387774
Rec Loss: -40.685850
KL Loss: 18.298075
Y Loss: 0.107698
T Loss: 11.028098
X Loss: -51.767796
Epoch 2849 
Overall Loss: -22.929658
Rec Loss: -41.987937
KL Loss: 19.058280
Y Loss: 0.095740
T Loss: 10.979216
X Loss: -53.015023
Epoch 2899 
Overall Loss: -23.326102
Rec Loss: -42.409332
KL Loss: 19.083232
Y Loss: 0.091578
T Loss: 10.975423
X Loss: -53.430544
Epoch 2949 
Overall Loss: -23.416079
Rec Loss: -42.430689
KL Loss: 19.014612
Y Loss: 0.088775
T Loss: 10.985987
X Loss: -53.461064
Epoch 2999 
Overall Loss: -23.331885
Rec Loss: -42.426125
KL Loss: 19.094240
Y Loss: 0.091441
T Loss: 10.966542
X Loss: -53.438388
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.474660
Epoch 99
Rec Loss: 2.432548
Epoch 149
Rec Loss: 2.411650
Epoch 199
Rec Loss: 2.403608
Epoch 249
Rec Loss: 2.382990
Epoch 299
Rec Loss: 2.385148
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.003696
Epoch 99
Rec Loss: 0.002125
Epoch 149
Rec Loss: 0.001438
Epoch 199
Rec Loss: 0.001147
Epoch 249
Rec Loss: 0.000787
Epoch 299
Rec Loss: 0.001030
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.225499
Insample Error 4.231705
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.391447
Epoch 99 
Prediction Loss: 2.183043
Epoch 149 
Prediction Loss: 2.096578
Epoch 199 
Prediction Loss: 2.032554
Epoch 249 
Prediction Loss: 2.008021
Epoch 299 
Prediction Loss: 1.979978
Epoch 349 
Prediction Loss: 1.985320
Epoch 399 
Prediction Loss: 1.929258
Epoch 449 
Prediction Loss: 1.911308
Epoch 499 
Prediction Loss: 1.919603
Epoch 549 
Prediction Loss: 1.922582
Epoch 599 
Prediction Loss: 1.889307
Epoch 649 
Prediction Loss: 1.871997
Epoch 699 
Prediction Loss: 1.868386
Epoch 749 
Prediction Loss: 1.868280
Epoch 799 
Prediction Loss: 1.866025
Epoch 849 
Prediction Loss: 1.838857
Epoch 899 
Prediction Loss: 1.886061
Epoch 949 
Prediction Loss: 1.851417
Epoch 999 
Prediction Loss: 1.839665
Epoch 1049 
Prediction Loss: 1.816550
Epoch 1099 
Prediction Loss: 1.823985
Epoch 1149 
Prediction Loss: 1.819696
Epoch 1199 
Prediction Loss: 1.807877
Epoch 1249 
Prediction Loss: 1.795379
Epoch 1299 
Prediction Loss: 1.798110
Epoch 1349 
Prediction Loss: 1.792900
Epoch 1399 
Prediction Loss: 1.780592
Epoch 1449 
Prediction Loss: 1.772153
Epoch 1499 
Prediction Loss: 1.783468
Epoch 1549 
Prediction Loss: 1.761488
Epoch 1599 
Prediction Loss: 1.751080
Epoch 1649 
Prediction Loss: 1.758012
Epoch 1699 
Prediction Loss: 1.770725
Epoch 1749 
Prediction Loss: 1.753160
Epoch 1799 
Prediction Loss: 1.736275
Epoch 1849 
Prediction Loss: 1.750742
Epoch 1899 
Prediction Loss: 1.715034
Epoch 1949 
Prediction Loss: 1.718056
Epoch 1999 
Prediction Loss: 1.706941
Epoch 2049 
Prediction Loss: 1.695923
Epoch 2099 
Prediction Loss: 1.726385
Epoch 2149 
Prediction Loss: 1.687972
Epoch 2199 
Prediction Loss: 1.704275
Epoch 2249 
Prediction Loss: 1.678537
Epoch 2299 
Prediction Loss: 1.667183
Epoch 2349 
Prediction Loss: 1.714082
Epoch 2399 
Prediction Loss: 1.661950
Epoch 2449 
Prediction Loss: 1.660451
Epoch 2499 
Prediction Loss: 1.646626
Epoch 2549 
Prediction Loss: 1.638681
Epoch 2599 
Prediction Loss: 1.634419
Epoch 2649 
Prediction Loss: 1.631242
Epoch 2699 
Prediction Loss: 1.648248
Epoch 2749 
Prediction Loss: 1.622939
Epoch 2799 
Prediction Loss: 1.605766
Epoch 2849 
Prediction Loss: 1.642899
Epoch 2899 
Prediction Loss: 1.610274
Epoch 2949 
Prediction Loss: 1.612069
Epoch 2999 
Prediction Loss: 1.592723
Epoch 3049 
Prediction Loss: 1.574603
Epoch 3099 
Prediction Loss: 1.570049
Epoch 3149 
Prediction Loss: 1.589085
Epoch 3199 
Prediction Loss: 1.556683
Epoch 3249 
Prediction Loss: 1.604964
Epoch 3299 
Prediction Loss: 1.577910
Epoch 3349 
Prediction Loss: 1.547627
Epoch 3399 
Prediction Loss: 1.540476
Epoch 3449 
Prediction Loss: 1.539371
Epoch 3499 
Prediction Loss: 1.569103
Epoch 3549 
Prediction Loss: 1.535528
Epoch 3599 
Prediction Loss: 1.539883
Epoch 3649 
Prediction Loss: 1.517552
Epoch 3699 
Prediction Loss: 1.515421
Epoch 3749 
Prediction Loss: 1.501221
Epoch 3799 
Prediction Loss: 1.505939
Epoch 3849 
Prediction Loss: 1.494093
Epoch 3899 
Prediction Loss: 1.496828
Epoch 3949 
Prediction Loss: 1.478007
Epoch 3999 
Prediction Loss: 1.520748
Epoch 4049 
Prediction Loss: 1.477017
Epoch 4099 
Prediction Loss: 1.482457
Epoch 4149 
Prediction Loss: 1.471344
Epoch 4199 
Prediction Loss: 1.463489
Epoch 4249 
Prediction Loss: 1.482877
Epoch 4299 
Prediction Loss: 1.452775
Epoch 4349 
Prediction Loss: 1.447370
Epoch 4399 
Prediction Loss: 1.451941
Epoch 4449 
Prediction Loss: 1.459721
Epoch 4499 
Prediction Loss: 1.444442
Epoch 4549 
Prediction Loss: 1.432987
Epoch 4599 
Prediction Loss: 1.427399
Epoch 4649 
Prediction Loss: 1.433643
Epoch 4699 
Prediction Loss: 1.424694
Epoch 4749 
Prediction Loss: 1.464291
Epoch 4799 
Prediction Loss: 1.429934
Epoch 4849 
Prediction Loss: 1.418763
Epoch 4899 
Prediction Loss: 1.441681
Epoch 4949 
Prediction Loss: 1.406561
Epoch 4999 
Prediction Loss: 1.414502
Epoch 5049 
Prediction Loss: 1.405428
Epoch 5099 
Prediction Loss: 1.410439
Epoch 5149 
Prediction Loss: 1.386403
Epoch 5199 
Prediction Loss: 1.389102
Epoch 5249 
Prediction Loss: 1.372606
Epoch 5299 
Prediction Loss: 1.376695
Epoch 5349 
Prediction Loss: 1.371089
Epoch 5399 
Prediction Loss: 1.372624
Epoch 5449 
Prediction Loss: 1.365295
Epoch 5499 
Prediction Loss: 1.359837
Epoch 5549 
Prediction Loss: 1.374272
Epoch 5599 
Prediction Loss: 1.345138
Epoch 5649 
Prediction Loss: 1.357096
Epoch 5699 
Prediction Loss: 1.353597
Epoch 5749 
Prediction Loss: 1.363961
Epoch 5799 
Prediction Loss: 1.345690
Epoch 5849 
Prediction Loss: 1.332923
Epoch 5899 
Prediction Loss: 1.339869
Epoch 5949 
Prediction Loss: 1.385033
Epoch 5999 
Prediction Loss: 1.332192
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.153692
Insample Error 3.104357
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.260249
Rec Loss: 10.140701
KL Loss: 2.119548
Y Loss: 0.960121
T Loss: 9.660641
Epoch 99 
Overall Loss: 12.066482
Rec Loss: 10.119676
KL Loss: 1.946806
Y Loss: 0.986560
T Loss: 9.626396
Epoch 149 
Overall Loss: 11.956254
Rec Loss: 10.137742
KL Loss: 1.818512
Y Loss: 1.013359
T Loss: 9.631063
Epoch 199 
Overall Loss: 11.958168
Rec Loss: 10.148961
KL Loss: 1.809207
Y Loss: 1.021590
T Loss: 9.638166
Epoch 249 
Overall Loss: 11.903323
Rec Loss: 10.122344
KL Loss: 1.780980
Y Loss: 1.019802
T Loss: 9.612442
Epoch 299 
Overall Loss: 11.888323
Rec Loss: 10.110316
KL Loss: 1.778007
Y Loss: 0.989627
T Loss: 9.615502
Epoch 349 
Overall Loss: 11.901876
Rec Loss: 10.126874
KL Loss: 1.775002
Y Loss: 1.014969
T Loss: 9.619389
Epoch 399 
Overall Loss: 11.872433
Rec Loss: 10.125159
KL Loss: 1.747274
Y Loss: 0.978954
T Loss: 9.635682
Epoch 449 
Overall Loss: 11.851283
Rec Loss: 10.090135
KL Loss: 1.761148
Y Loss: 0.969431
T Loss: 9.605419
Epoch 499 
Overall Loss: 11.849125
Rec Loss: 10.111230
KL Loss: 1.737895
Y Loss: 0.974395
T Loss: 9.624033
Epoch 549 
Overall Loss: 11.837439
Rec Loss: 10.077224
KL Loss: 1.760215
Y Loss: 0.954641
T Loss: 9.599904
Epoch 599 
Overall Loss: 11.843025
Rec Loss: 10.091890
KL Loss: 1.751135
Y Loss: 0.961018
T Loss: 9.611382
Epoch 649 
Overall Loss: 11.837857
Rec Loss: 10.090046
KL Loss: 1.747811
Y Loss: 0.988201
T Loss: 9.595946
Epoch 699 
Overall Loss: 11.832898
Rec Loss: 10.067780
KL Loss: 1.765118
Y Loss: 0.965689
T Loss: 9.584936
Epoch 749 
Overall Loss: 11.824906
Rec Loss: 10.056699
KL Loss: 1.768207
Y Loss: 0.957764
T Loss: 9.577818
Epoch 799 
Overall Loss: 11.787589
Rec Loss: 10.063498
KL Loss: 1.724092
Y Loss: 0.928979
T Loss: 9.599008
Epoch 849 
Overall Loss: 11.810993
Rec Loss: 10.093231
KL Loss: 1.717762
Y Loss: 0.963183
T Loss: 9.611640
Epoch 899 
Overall Loss: 11.810657
Rec Loss: 10.075285
KL Loss: 1.735372
Y Loss: 0.947868
T Loss: 9.601351
Epoch 949 
Overall Loss: 11.812440
Rec Loss: 10.045011
KL Loss: 1.767429
Y Loss: 0.924073
T Loss: 9.582975
Epoch 999 
Overall Loss: 11.808967
Rec Loss: 10.072485
KL Loss: 1.736482
Y Loss: 0.943023
T Loss: 9.600974
Epoch 1049 
Overall Loss: 11.822139
Rec Loss: 10.053033
KL Loss: 1.769107
Y Loss: 0.941199
T Loss: 9.582433
Epoch 1099 
Overall Loss: 11.803262
Rec Loss: 10.086937
KL Loss: 1.716325
Y Loss: 0.973233
T Loss: 9.600320
Epoch 1149 
Overall Loss: 11.778274
Rec Loss: 10.049592
KL Loss: 1.728682
Y Loss: 0.913117
T Loss: 9.593034
Epoch 1199 
Overall Loss: 11.780520
Rec Loss: 10.052039
KL Loss: 1.728481
Y Loss: 0.924765
T Loss: 9.589656
Epoch 1249 
Overall Loss: 11.789625
Rec Loss: 10.046492
KL Loss: 1.743133
Y Loss: 0.931220
T Loss: 9.580882
Epoch 1299 
Overall Loss: 11.800881
Rec Loss: 10.062768
KL Loss: 1.738114
Y Loss: 0.910480
T Loss: 9.607528
Epoch 1349 
Overall Loss: 11.774749
Rec Loss: 10.036228
KL Loss: 1.738521
Y Loss: 0.938258
T Loss: 9.567099
Epoch 1399 
Overall Loss: 11.793369
Rec Loss: 10.057773
KL Loss: 1.735597
Y Loss: 0.909487
T Loss: 9.603030
Epoch 1449 
Overall Loss: 11.795374
Rec Loss: 10.066769
KL Loss: 1.728606
Y Loss: 0.963966
T Loss: 9.584785
Epoch 1499 
Overall Loss: 11.768521
Rec Loss: 10.045378
KL Loss: 1.723143
Y Loss: 0.955501
T Loss: 9.567628
Epoch 1549 
Overall Loss: 11.762150
Rec Loss: 10.033106
KL Loss: 1.729044
Y Loss: 0.954222
T Loss: 9.555995
Epoch 1599 
Overall Loss: 11.765111
Rec Loss: 10.024397
KL Loss: 1.740714
Y Loss: 0.915463
T Loss: 9.566665
Epoch 1649 
Overall Loss: 11.773924
Rec Loss: 10.047904
KL Loss: 1.726020
Y Loss: 0.931435
T Loss: 9.582187
Epoch 1699 
Overall Loss: 11.771541
Rec Loss: 10.040141
KL Loss: 1.731400
Y Loss: 0.919431
T Loss: 9.580426
Epoch 1749 
Overall Loss: 11.747746
Rec Loss: 10.016594
KL Loss: 1.731152
Y Loss: 0.915795
T Loss: 9.558697
Epoch 1799 
Overall Loss: 11.755296
Rec Loss: 10.038132
KL Loss: 1.717163
Y Loss: 0.942122
T Loss: 9.567071
Epoch 1849 
Overall Loss: 11.751722
Rec Loss: 10.014423
KL Loss: 1.737299
Y Loss: 0.899506
T Loss: 9.564669
Epoch 1899 
Overall Loss: 11.749982
Rec Loss: 10.017635
KL Loss: 1.732346
Y Loss: 0.921054
T Loss: 9.557108
Epoch 1949 
Overall Loss: 11.776750
Rec Loss: 10.037359
KL Loss: 1.739392
Y Loss: 0.927554
T Loss: 9.573582
Epoch 1999 
Overall Loss: 11.749940
Rec Loss: 10.031204
KL Loss: 1.718736
Y Loss: 0.917545
T Loss: 9.572431
Epoch 2049 
Overall Loss: 11.778973
Rec Loss: 10.042026
KL Loss: 1.736946
Y Loss: 0.930362
T Loss: 9.576846
Epoch 2099 
Overall Loss: 11.750146
Rec Loss: 10.036052
KL Loss: 1.714094
Y Loss: 0.929909
T Loss: 9.571098
Epoch 2149 
Overall Loss: 11.759749
Rec Loss: 10.016184
KL Loss: 1.743565
Y Loss: 0.934994
T Loss: 9.548686
Epoch 2199 
Overall Loss: 11.746956
Rec Loss: 10.018504
KL Loss: 1.728453
Y Loss: 0.943824
T Loss: 9.546592
Epoch 2249 
Overall Loss: 11.759335
Rec Loss: 10.013092
KL Loss: 1.746244
Y Loss: 0.919563
T Loss: 9.553311
Epoch 2299 
Overall Loss: 11.744338
Rec Loss: 10.030994
KL Loss: 1.713344
Y Loss: 0.938570
T Loss: 9.561708
Epoch 2349 
Overall Loss: 11.742867
Rec Loss: 10.009761
KL Loss: 1.733106
Y Loss: 0.921691
T Loss: 9.548915
Epoch 2399 
Overall Loss: 11.753598
Rec Loss: 10.038024
KL Loss: 1.715574
Y Loss: 0.926039
T Loss: 9.575005
Epoch 2449 
Overall Loss: 11.745189
Rec Loss: 10.021936
KL Loss: 1.723254
Y Loss: 0.927639
T Loss: 9.558116
Epoch 2499 
Overall Loss: 11.734620
Rec Loss: 10.027299
KL Loss: 1.707321
Y Loss: 0.913535
T Loss: 9.570532
Epoch 2549 
Overall Loss: 11.740103
Rec Loss: 9.987667
KL Loss: 1.752436
Y Loss: 0.891179
T Loss: 9.542077
Epoch 2599 
Overall Loss: 11.748512
Rec Loss: 10.021949
KL Loss: 1.726562
Y Loss: 0.942101
T Loss: 9.550899
Epoch 2649 
Overall Loss: 11.746612
Rec Loss: 10.031260
KL Loss: 1.715352
Y Loss: 0.926431
T Loss: 9.568044
Epoch 2699 
Overall Loss: 11.733012
Rec Loss: 10.007710
KL Loss: 1.725302
Y Loss: 0.915693
T Loss: 9.549864
Epoch 2749 
Overall Loss: 11.737719
Rec Loss: 10.008064
KL Loss: 1.729655
Y Loss: 0.928828
T Loss: 9.543650
Epoch 2799 
Overall Loss: 11.725160
Rec Loss: 10.006858
KL Loss: 1.718301
Y Loss: 0.920757
T Loss: 9.546480
Epoch 2849 
Overall Loss: 11.713659
Rec Loss: 10.000417
KL Loss: 1.713242
Y Loss: 0.893651
T Loss: 9.553591
Epoch 2899 
Overall Loss: 11.726993
Rec Loss: 10.011681
KL Loss: 1.715312
Y Loss: 0.912726
T Loss: 9.555317
Epoch 2949 
Overall Loss: 11.738005
Rec Loss: 10.021924
KL Loss: 1.716081
Y Loss: 0.935102
T Loss: 9.554372
Epoch 2999 
Overall Loss: 11.720926
Rec Loss: 9.991779
KL Loss: 1.729147
Y Loss: 0.901517
T Loss: 9.541020
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.720812
Epoch 99
Rec Loss: 0.712527
Epoch 149
Rec Loss: 0.728408
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.186683
Epoch 99
Rec Loss: 10.181644
Epoch 149
Rec Loss: 10.170616
Epoch 199
Rec Loss: 10.171070
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.771910
Insample Error: 2.001502
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 19.178894
Rec Loss: 16.195295
KL Loss: 2.983599
Y Loss: 5.944164
T Loss: 13.468294
X Loss: -0.245082
Epoch 99 
Overall Loss: 2.167765
Rec Loss: -8.585484
KL Loss: 10.753249
Y Loss: 1.808754
T Loss: 13.274257
X Loss: -22.764117
Epoch 149 
Overall Loss: -4.367660
Rec Loss: -17.218584
KL Loss: 12.850923
Y Loss: 1.128454
T Loss: 13.248972
X Loss: -31.031783
Epoch 199 
Overall Loss: -7.068674
Rec Loss: -21.103565
KL Loss: 14.034891
Y Loss: 0.542364
T Loss: 13.222197
X Loss: -34.596945
Epoch 249 
Overall Loss: -8.605336
Rec Loss: -23.117075
KL Loss: 14.511739
Y Loss: 0.275974
T Loss: 13.208820
X Loss: -36.463881
Epoch 299 
Overall Loss: -9.643165
Rec Loss: -24.503422
KL Loss: 14.860257
Y Loss: 0.192191
T Loss: 13.193288
X Loss: -37.792806
Epoch 349 
Overall Loss: -10.420782
Rec Loss: -25.569256
KL Loss: 15.148474
Y Loss: 0.201171
T Loss: 13.171568
X Loss: -38.841409
Epoch 399 
Overall Loss: -11.188352
Rec Loss: -26.616317
KL Loss: 15.427966
Y Loss: 0.184246
T Loss: 13.146000
X Loss: -39.854440
Epoch 449 
Overall Loss: -12.040752
Rec Loss: -27.638374
KL Loss: 15.597623
Y Loss: 0.154849
T Loss: 13.121920
X Loss: -40.837719
Epoch 499 
Overall Loss: -10.213814
Rec Loss: -25.889652
KL Loss: 15.675838
Y Loss: 0.154473
T Loss: 13.102669
X Loss: -39.069557
Epoch 549 
Overall Loss: -12.429310
Rec Loss: -27.864745
KL Loss: 15.435435
Y Loss: 0.148506
T Loss: 13.062347
X Loss: -41.001346
Epoch 599 
Overall Loss: -12.844343
Rec Loss: -28.515067
KL Loss: 15.670724
Y Loss: 0.154170
T Loss: 13.032360
X Loss: -41.624512
Epoch 649 
Overall Loss: -13.370866
Rec Loss: -29.225520
KL Loss: 15.854654
Y Loss: 0.139232
T Loss: 12.982020
X Loss: -42.277156
Epoch 699 
Overall Loss: -13.753468
Rec Loss: -29.756651
KL Loss: 16.003182
Y Loss: 0.130996
T Loss: 12.923318
X Loss: -42.745467
Epoch 749 
Overall Loss: -14.054908
Rec Loss: -30.239920
KL Loss: 16.185012
Y Loss: 0.123424
T Loss: 12.890373
X Loss: -43.192006
Epoch 799 
Overall Loss: -14.327761
Rec Loss: -30.637669
KL Loss: 16.309909
Y Loss: 0.105954
T Loss: 12.848792
X Loss: -43.539437
Epoch 849 
Overall Loss: -14.834996
Rec Loss: -31.307077
KL Loss: 16.472081
Y Loss: 0.100035
T Loss: 12.818967
X Loss: -44.176062
Epoch 899 
Overall Loss: -15.045429
Rec Loss: -31.612607
KL Loss: 16.567178
Y Loss: 0.092126
T Loss: 12.784643
X Loss: -44.443313
Epoch 949 
Overall Loss: -15.373719
Rec Loss: -32.067596
KL Loss: 16.693876
Y Loss: 0.089863
T Loss: 12.770804
X Loss: -44.883331
Epoch 999 
Overall Loss: -15.470294
Rec Loss: -32.298396
KL Loss: 16.828101
Y Loss: 0.128357
T Loss: 12.747257
X Loss: -45.109830
Epoch 1049 
Overall Loss: -15.790716
Rec Loss: -32.740477
KL Loss: 16.949761
Y Loss: 0.080414
T Loss: 12.729457
X Loss: -45.510142
Epoch 1099 
Overall Loss: -16.051100
Rec Loss: -33.145200
KL Loss: 17.094099
Y Loss: 0.071991
T Loss: 12.707862
X Loss: -45.889057
Epoch 1149 
Overall Loss: -16.437447
Rec Loss: -33.633769
KL Loss: 17.196322
Y Loss: 0.063382
T Loss: 12.686101
X Loss: -46.351561
Epoch 1199 
Overall Loss: -16.546403
Rec Loss: -33.826021
KL Loss: 17.279618
Y Loss: 0.083278
T Loss: 12.667485
X Loss: -46.535146
Epoch 1249 
Overall Loss: -16.750250
Rec Loss: -34.207029
KL Loss: 17.456779
Y Loss: 0.070661
T Loss: 12.643510
X Loss: -46.885870
Epoch 1299 
Overall Loss: -17.294161
Rec Loss: -34.801583
KL Loss: 17.507421
Y Loss: 0.057412
T Loss: 12.611800
X Loss: -47.442088
Epoch 1349 
Overall Loss: -17.667953
Rec Loss: -35.349276
KL Loss: 17.681323
Y Loss: 0.064890
T Loss: 12.567945
X Loss: -47.949666
Epoch 1399 
Overall Loss: -17.763299
Rec Loss: -35.533064
KL Loss: 17.769764
Y Loss: 0.079506
T Loss: 12.529965
X Loss: -48.102782
Epoch 1449 
Overall Loss: -17.912372
Rec Loss: -35.702389
KL Loss: 17.790018
Y Loss: 0.059057
T Loss: 12.465789
X Loss: -48.197708
Epoch 1499 
Overall Loss: -17.957760
Rec Loss: -35.919935
KL Loss: 17.962175
Y Loss: 0.073459
T Loss: 12.363751
X Loss: -48.320416
Epoch 1549 
Overall Loss: -18.556456
Rec Loss: -36.662281
KL Loss: 18.105825
Y Loss: 0.055482
T Loss: 12.275566
X Loss: -48.965587
Epoch 1599 
Overall Loss: -18.655212
Rec Loss: -36.892980
KL Loss: 18.237769
Y Loss: 0.060486
T Loss: 12.172176
X Loss: -49.095399
Epoch 1649 
Overall Loss: -18.909206
Rec Loss: -37.161197
KL Loss: 18.251990
Y Loss: 0.064197
T Loss: 12.066367
X Loss: -49.259662
Epoch 1699 
Overall Loss: -19.259126
Rec Loss: -37.618559
KL Loss: 18.359435
Y Loss: 0.084311
T Loss: 11.953434
X Loss: -49.614151
Epoch 1749 
Overall Loss: -19.393364
Rec Loss: -37.840468
KL Loss: 18.447104
Y Loss: 0.059525
T Loss: 11.871108
X Loss: -49.741339
Epoch 1799 
Overall Loss: -19.729706
Rec Loss: -38.147713
KL Loss: 18.418007
Y Loss: 0.055965
T Loss: 11.820144
X Loss: -49.995840
Epoch 1849 
Overall Loss: -19.689147
Rec Loss: -38.271076
KL Loss: 18.581930
Y Loss: 0.049338
T Loss: 11.735410
X Loss: -50.031155
Epoch 1899 
Overall Loss: -19.501009
Rec Loss: -38.094852
KL Loss: 18.593843
Y Loss: 0.055049
T Loss: 11.678588
X Loss: -49.800965
Epoch 1949 
Overall Loss: -20.251560
Rec Loss: -38.843226
KL Loss: 18.591666
Y Loss: 0.060365
T Loss: 11.650897
X Loss: -50.524305
Epoch 1999 
Overall Loss: -20.229982
Rec Loss: -38.772615
KL Loss: 18.542631
Y Loss: 0.072841
T Loss: 11.620958
X Loss: -50.429994
Epoch 2049 
Overall Loss: -20.581156
Rec Loss: -39.243219
KL Loss: 18.662063
Y Loss: 0.057390
T Loss: 11.569256
X Loss: -50.841169
Epoch 2099 
Overall Loss: -20.927218
Rec Loss: -39.557352
KL Loss: 18.630135
Y Loss: 0.070348
T Loss: 11.548883
X Loss: -51.141409
Epoch 2149 
Overall Loss: -20.642187
Rec Loss: -39.370894
KL Loss: 18.728707
Y Loss: 0.059986
T Loss: 11.502612
X Loss: -50.903500
Epoch 2199 
Overall Loss: -20.965056
Rec Loss: -39.616932
KL Loss: 18.651875
Y Loss: 0.103765
T Loss: 11.507969
X Loss: -51.176782
Epoch 2249 
Overall Loss: -21.145061
Rec Loss: -39.966299
KL Loss: 18.821238
Y Loss: 0.060541
T Loss: 11.432434
X Loss: -51.429004
Epoch 2299 
Overall Loss: -21.340537
Rec Loss: -39.858078
KL Loss: 18.517541
Y Loss: 0.063428
T Loss: 11.459029
X Loss: -51.348821
Epoch 2349 
Overall Loss: -21.309965
Rec Loss: -40.224606
KL Loss: 18.914641
Y Loss: 0.054005
T Loss: 11.400499
X Loss: -51.652107
Epoch 2399 
Overall Loss: -21.663814
Rec Loss: -40.553524
KL Loss: 18.889710
Y Loss: 0.065899
T Loss: 11.381727
X Loss: -51.968199
Epoch 2449 
Overall Loss: -21.888419
Rec Loss: -40.764637
KL Loss: 18.876218
Y Loss: 0.064993
T Loss: 11.380136
X Loss: -52.177268
Epoch 2499 
Overall Loss: -21.628636
Rec Loss: -40.609720
KL Loss: 18.981085
Y Loss: 0.057184
T Loss: 11.349761
X Loss: -51.988073
Epoch 2549 
Overall Loss: -20.747816
Rec Loss: -39.658451
KL Loss: 18.910635
Y Loss: 0.054534
T Loss: 11.337184
X Loss: -51.022902
Epoch 2599 
Overall Loss: -22.341295
Rec Loss: -41.334404
KL Loss: 18.993109
Y Loss: 0.055609
T Loss: 11.311347
X Loss: -52.673555
Epoch 2649 
Overall Loss: -21.866298
Rec Loss: -40.749206
KL Loss: 18.882907
Y Loss: 0.059180
T Loss: 11.314113
X Loss: -52.092908
Epoch 2699 
Overall Loss: -21.662531
Rec Loss: -40.509145
KL Loss: 18.846615
Y Loss: 0.060957
T Loss: 11.282246
X Loss: -51.821870
Epoch 2749 
Overall Loss: -22.602609
Rec Loss: -41.525010
KL Loss: 18.922402
Y Loss: 0.057722
T Loss: 11.271620
X Loss: -52.825492
Epoch 2799 
Overall Loss: -22.320376
Rec Loss: -41.038630
KL Loss: 18.718253
Y Loss: 0.056022
T Loss: 11.276055
X Loss: -52.342696
Epoch 2849 
Overall Loss: -22.798257
Rec Loss: -41.686559
KL Loss: 18.888301
Y Loss: 0.064454
T Loss: 11.256130
X Loss: -52.974915
Epoch 2899 
Overall Loss: -22.950131
Rec Loss: -42.064229
KL Loss: 19.114098
Y Loss: 0.050891
T Loss: 11.240668
X Loss: -53.330343
Epoch 2949 
Overall Loss: -22.861238
Rec Loss: -42.015972
KL Loss: 19.154734
Y Loss: 0.059719
T Loss: 11.220471
X Loss: -53.266303
Epoch 2999 
Overall Loss: -22.873051
Rec Loss: -42.039344
KL Loss: 19.166293
Y Loss: 0.051029
T Loss: 11.208685
X Loss: -53.273544
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.536197
Epoch 99
Rec Loss: 2.510916
Epoch 149
Rec Loss: 2.496904
Epoch 199
Rec Loss: 2.471504
Epoch 249
Rec Loss: 2.478962
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.002949
Epoch 99
Rec Loss: 0.001680
Epoch 149
Rec Loss: 0.001669
Epoch 199
Rec Loss: 0.001674
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.141351
Insample Error 3.067967
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.380558
Epoch 99 
Prediction Loss: 2.142254
Epoch 149 
Prediction Loss: 2.044677
Epoch 199 
Prediction Loss: 2.003192
Epoch 249 
Prediction Loss: 1.969306
Epoch 299 
Prediction Loss: 1.954030
Epoch 349 
Prediction Loss: 1.937771
Epoch 399 
Prediction Loss: 1.904890
Epoch 449 
Prediction Loss: 1.907401
Epoch 499 
Prediction Loss: 1.897290
Epoch 549 
Prediction Loss: 1.893743
Epoch 599 
Prediction Loss: 1.913692
Epoch 649 
Prediction Loss: 1.853931
Epoch 699 
Prediction Loss: 1.841764
Epoch 749 
Prediction Loss: 1.839327
Epoch 799 
Prediction Loss: 1.834368
Epoch 849 
Prediction Loss: 1.818662
Epoch 899 
Prediction Loss: 1.806894
Epoch 949 
Prediction Loss: 1.816872
Epoch 999 
Prediction Loss: 1.796873
Epoch 1049 
Prediction Loss: 1.801275
Epoch 1099 
Prediction Loss: 1.780809
Epoch 1149 
Prediction Loss: 1.771883
Epoch 1199 
Prediction Loss: 1.757605
Epoch 1249 
Prediction Loss: 1.751015
Epoch 1299 
Prediction Loss: 1.753189
Epoch 1349 
Prediction Loss: 1.743909
Epoch 1399 
Prediction Loss: 1.736021
Epoch 1449 
Prediction Loss: 1.727726
Epoch 1499 
Prediction Loss: 1.717661
Epoch 1549 
Prediction Loss: 1.722306
Epoch 1599 
Prediction Loss: 1.722405
Epoch 1649 
Prediction Loss: 1.723804
Epoch 1699 
Prediction Loss: 1.690833
Epoch 1749 
Prediction Loss: 1.701833
Epoch 1799 
Prediction Loss: 1.676277
Epoch 1849 
Prediction Loss: 1.677121
Epoch 1899 
Prediction Loss: 1.677059
Epoch 1949 
Prediction Loss: 1.651973
Epoch 1999 
Prediction Loss: 1.660220
Epoch 2049 
Prediction Loss: 1.663733
Epoch 2099 
Prediction Loss: 1.644010
Epoch 2149 
Prediction Loss: 1.650731
Epoch 2199 
Prediction Loss: 1.681522
Epoch 2249 
Prediction Loss: 1.627027
Epoch 2299 
Prediction Loss: 1.627828
Epoch 2349 
Prediction Loss: 1.611106
Epoch 2399 
Prediction Loss: 1.607069
Epoch 2449 
Prediction Loss: 1.609386
Epoch 2499 
Prediction Loss: 1.614709
Epoch 2549 
Prediction Loss: 1.589112
Epoch 2599 
Prediction Loss: 1.606061
Epoch 2649 
Prediction Loss: 1.596196
Epoch 2699 
Prediction Loss: 1.578329
Epoch 2749 
Prediction Loss: 1.590409
Epoch 2799 
Prediction Loss: 1.584416
Epoch 2849 
Prediction Loss: 1.558170
Epoch 2899 
Prediction Loss: 1.567713
Epoch 2949 
Prediction Loss: 1.560278
Epoch 2999 
Prediction Loss: 1.556009
Epoch 3049 
Prediction Loss: 1.530817
Epoch 3099 
Prediction Loss: 1.536306
Epoch 3149 
Prediction Loss: 1.534419
Epoch 3199 
Prediction Loss: 1.533819
Epoch 3249 
Prediction Loss: 1.519862
Epoch 3299 
Prediction Loss: 1.505164
Epoch 3349 
Prediction Loss: 1.513560
Epoch 3399 
Prediction Loss: 1.495559
Epoch 3449 
Prediction Loss: 1.506697
Epoch 3499 
Prediction Loss: 1.502551
Epoch 3549 
Prediction Loss: 1.509029
Epoch 3599 
Prediction Loss: 1.488416
Epoch 3649 
Prediction Loss: 1.503985
Epoch 3699 
Prediction Loss: 1.481913
Epoch 3749 
Prediction Loss: 1.475466
Epoch 3799 
Prediction Loss: 1.461125
Epoch 3849 
Prediction Loss: 1.481072
Epoch 3899 
Prediction Loss: 1.449074
Epoch 3949 
Prediction Loss: 1.446952
Epoch 3999 
Prediction Loss: 1.446262
Epoch 4049 
Prediction Loss: 1.458627
Epoch 4099 
Prediction Loss: 1.429692
Epoch 4149 
Prediction Loss: 1.432969
Epoch 4199 
Prediction Loss: 1.434768
Epoch 4249 
Prediction Loss: 1.409297
Epoch 4299 
Prediction Loss: 1.431938
Epoch 4349 
Prediction Loss: 1.401957
Epoch 4399 
Prediction Loss: 1.404086
Epoch 4449 
Prediction Loss: 1.422557
Epoch 4499 
Prediction Loss: 1.406577
Epoch 4549 
Prediction Loss: 1.392023
Epoch 4599 
Prediction Loss: 1.391512
Epoch 4649 
Prediction Loss: 1.400281
Epoch 4699 
Prediction Loss: 1.385160
Epoch 4749 
Prediction Loss: 1.368278
Epoch 4799 
Prediction Loss: 1.406130
Epoch 4849 
Prediction Loss: 1.374352
Epoch 4899 
Prediction Loss: 1.359304
Epoch 4949 
Prediction Loss: 1.355259
Epoch 4999 
Prediction Loss: 1.355170
Epoch 5049 
Prediction Loss: 1.355892
Epoch 5099 
Prediction Loss: 1.358389
Epoch 5149 
Prediction Loss: 1.368869
Epoch 5199 
Prediction Loss: 1.337967
Epoch 5249 
Prediction Loss: 1.324215
Epoch 5299 
Prediction Loss: 1.334565
Epoch 5349 
Prediction Loss: 1.317258
Epoch 5399 
Prediction Loss: 1.331453
Epoch 5449 
Prediction Loss: 1.318054
Epoch 5499 
Prediction Loss: 1.306739
Epoch 5549 
Prediction Loss: 1.340299
Epoch 5599 
Prediction Loss: 1.312634
Epoch 5649 
Prediction Loss: 1.323685
Epoch 5699 
Prediction Loss: 1.313785
Epoch 5749 
Prediction Loss: 1.295827
Epoch 5799 
Prediction Loss: 1.295162
Epoch 5849 
Prediction Loss: 1.303603
Epoch 5899 
Prediction Loss: 1.287903
Epoch 5949 
Prediction Loss: 1.284230
Epoch 5999 
Prediction Loss: 1.281698
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.133585
Insample Error 3.043749
[31m========== repeat time 4 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.228631
Rec Loss: 10.150162
KL Loss: 2.078469
Y Loss: 1.093704
T Loss: 9.603310
Epoch 99 
Overall Loss: 12.043588
Rec Loss: 10.154067
KL Loss: 1.889521
Y Loss: 1.051619
T Loss: 9.628258
Epoch 149 
Overall Loss: 11.978500
Rec Loss: 10.161731
KL Loss: 1.816769
Y Loss: 1.052322
T Loss: 9.635571
Epoch 199 
Overall Loss: 11.932469
Rec Loss: 10.115458
KL Loss: 1.817011
Y Loss: 1.035360
T Loss: 9.597778
Epoch 249 
Overall Loss: 11.904205
Rec Loss: 10.130368
KL Loss: 1.773837
Y Loss: 1.021171
T Loss: 9.619782
Epoch 299 
Overall Loss: 11.866275
Rec Loss: 10.121183
KL Loss: 1.745092
Y Loss: 1.031135
T Loss: 9.605616
Epoch 349 
Overall Loss: 11.890943
Rec Loss: 10.105719
KL Loss: 1.785225
Y Loss: 1.013546
T Loss: 9.598946
Epoch 399 
Overall Loss: 11.842516
Rec Loss: 10.121075
KL Loss: 1.721441
Y Loss: 1.007144
T Loss: 9.617503
Epoch 449 
Overall Loss: 11.848246
Rec Loss: 10.084151
KL Loss: 1.764095
Y Loss: 0.976801
T Loss: 9.595751
Epoch 499 
Overall Loss: 11.852398
Rec Loss: 10.092161
KL Loss: 1.760237
Y Loss: 0.994553
T Loss: 9.594884
Epoch 549 
Overall Loss: 11.842064
Rec Loss: 10.102369
KL Loss: 1.739695
Y Loss: 0.973459
T Loss: 9.615639
Epoch 599 
Overall Loss: 11.840209
Rec Loss: 10.076554
KL Loss: 1.763655
Y Loss: 0.973779
T Loss: 9.589664
Epoch 649 
Overall Loss: 11.841245
Rec Loss: 10.073921
KL Loss: 1.767324
Y Loss: 0.982456
T Loss: 9.582692
Epoch 699 
Overall Loss: 11.831483
Rec Loss: 10.065628
KL Loss: 1.765855
Y Loss: 0.969890
T Loss: 9.580683
Epoch 749 
Overall Loss: 11.844605
Rec Loss: 10.088191
KL Loss: 1.756414
Y Loss: 0.999744
T Loss: 9.588319
Epoch 799 
Overall Loss: 11.842465
Rec Loss: 10.108719
KL Loss: 1.733746
Y Loss: 0.986779
T Loss: 9.615330
Epoch 849 
Overall Loss: 11.813147
Rec Loss: 10.066236
KL Loss: 1.746911
Y Loss: 0.965917
T Loss: 9.583278
Epoch 899 
Overall Loss: 11.817082
Rec Loss: 10.052115
KL Loss: 1.764967
Y Loss: 0.962729
T Loss: 9.570750
Epoch 949 
Overall Loss: 11.808766
Rec Loss: 10.097016
KL Loss: 1.711750
Y Loss: 0.969447
T Loss: 9.612293
Epoch 999 
Overall Loss: 11.781186
Rec Loss: 10.046480
KL Loss: 1.734706
Y Loss: 0.963207
T Loss: 9.564877
Epoch 1049 
Overall Loss: 11.797962
Rec Loss: 10.052373
KL Loss: 1.745589
Y Loss: 0.969995
T Loss: 9.567375
Epoch 1099 
Overall Loss: 11.790013
Rec Loss: 10.053181
KL Loss: 1.736832
Y Loss: 0.979910
T Loss: 9.563226
Epoch 1149 
Overall Loss: 11.816896
Rec Loss: 10.065161
KL Loss: 1.751735
Y Loss: 0.966560
T Loss: 9.581881
Epoch 1199 
Overall Loss: 11.789041
Rec Loss: 10.057745
KL Loss: 1.731296
Y Loss: 0.959807
T Loss: 9.577841
Epoch 1249 
Overall Loss: 11.805734
Rec Loss: 10.057262
KL Loss: 1.748472
Y Loss: 0.953280
T Loss: 9.580622
Epoch 1299 
Overall Loss: 11.791859
Rec Loss: 10.057078
KL Loss: 1.734780
Y Loss: 0.959434
T Loss: 9.577361
Epoch 1349 
Overall Loss: 11.781797
Rec Loss: 10.034075
KL Loss: 1.747721
Y Loss: 0.933542
T Loss: 9.567304
Epoch 1399 
Overall Loss: 11.785504
Rec Loss: 10.037412
KL Loss: 1.748093
Y Loss: 0.948723
T Loss: 9.563050
Epoch 1449 
Overall Loss: 11.769768
Rec Loss: 10.072631
KL Loss: 1.697137
Y Loss: 0.976883
T Loss: 9.584190
Epoch 1499 
Overall Loss: 11.787800
Rec Loss: 10.061168
KL Loss: 1.726632
Y Loss: 0.958734
T Loss: 9.581801
Epoch 1549 
Overall Loss: 11.780517
Rec Loss: 10.045654
KL Loss: 1.734863
Y Loss: 0.935496
T Loss: 9.577906
Epoch 1599 
Overall Loss: 11.782413
Rec Loss: 10.044751
KL Loss: 1.737662
Y Loss: 0.944408
T Loss: 9.572547
Epoch 1649 
Overall Loss: 11.785809
Rec Loss: 10.067253
KL Loss: 1.718556
Y Loss: 0.983562
T Loss: 9.575472
Epoch 1699 
Overall Loss: 11.760996
Rec Loss: 10.058248
KL Loss: 1.702748
Y Loss: 0.951197
T Loss: 9.582650
Epoch 1749 
Overall Loss: 11.767399
Rec Loss: 10.056191
KL Loss: 1.711209
Y Loss: 0.951557
T Loss: 9.580412
Epoch 1799 
Overall Loss: 11.754900
Rec Loss: 10.022750
KL Loss: 1.732149
Y Loss: 0.946178
T Loss: 9.549661
Epoch 1849 
Overall Loss: 11.750825
Rec Loss: 10.047499
KL Loss: 1.703327
Y Loss: 0.939491
T Loss: 9.577753
Epoch 1899 
Overall Loss: 11.782836
Rec Loss: 10.043564
KL Loss: 1.739272
Y Loss: 0.965991
T Loss: 9.560568
Epoch 1949 
Overall Loss: 11.764493
Rec Loss: 10.014559
KL Loss: 1.749934
Y Loss: 0.944121
T Loss: 9.542498
Epoch 1999 
Overall Loss: 11.749805
Rec Loss: 10.041705
KL Loss: 1.708099
Y Loss: 0.948587
T Loss: 9.567411
Epoch 2049 
Overall Loss: 11.772005
Rec Loss: 10.036296
KL Loss: 1.735709
Y Loss: 0.954870
T Loss: 9.558861
Epoch 2099 
Overall Loss: 11.764592
Rec Loss: 10.058984
KL Loss: 1.705608
Y Loss: 0.975677
T Loss: 9.571145
Epoch 2149 
Overall Loss: 11.760126
Rec Loss: 10.029325
KL Loss: 1.730801
Y Loss: 0.949120
T Loss: 9.554765
Epoch 2199 
Overall Loss: 11.739382
Rec Loss: 10.021557
KL Loss: 1.717825
Y Loss: 0.953083
T Loss: 9.545016
Epoch 2249 
Overall Loss: 11.749000
Rec Loss: 10.032352
KL Loss: 1.716648
Y Loss: 0.944726
T Loss: 9.559989
Epoch 2299 
Overall Loss: 11.755479
Rec Loss: 10.025210
KL Loss: 1.730270
Y Loss: 0.940520
T Loss: 9.554950
Epoch 2349 
Overall Loss: 11.725127
Rec Loss: 10.024061
KL Loss: 1.701066
Y Loss: 0.931251
T Loss: 9.558435
Epoch 2399 
Overall Loss: 11.754086
Rec Loss: 10.026279
KL Loss: 1.727807
Y Loss: 0.960698
T Loss: 9.545931
Epoch 2449 
Overall Loss: 11.734605
Rec Loss: 10.011438
KL Loss: 1.723167
Y Loss: 0.946757
T Loss: 9.538059
Epoch 2499 
Overall Loss: 11.734180
Rec Loss: 10.038305
KL Loss: 1.695875
Y Loss: 0.954431
T Loss: 9.561090
Epoch 2549 
Overall Loss: 11.750549
Rec Loss: 10.034578
KL Loss: 1.715971
Y Loss: 0.939004
T Loss: 9.565077
Epoch 2599 
Overall Loss: 11.735733
Rec Loss: 10.052978
KL Loss: 1.682756
Y Loss: 0.944514
T Loss: 9.580721
Epoch 2649 
Overall Loss: 11.738475
Rec Loss: 10.022498
KL Loss: 1.715977
Y Loss: 0.946580
T Loss: 9.549208
Epoch 2699 
Overall Loss: 11.743216
Rec Loss: 10.004343
KL Loss: 1.738873
Y Loss: 0.920076
T Loss: 9.544304
Epoch 2749 
Overall Loss: 11.723486
Rec Loss: 10.007816
KL Loss: 1.715670
Y Loss: 0.951806
T Loss: 9.531912
Epoch 2799 
Overall Loss: 11.717463
Rec Loss: 10.003313
KL Loss: 1.714150
Y Loss: 0.933164
T Loss: 9.536730
Epoch 2849 
Overall Loss: 11.751248
Rec Loss: 10.004306
KL Loss: 1.746943
Y Loss: 0.932227
T Loss: 9.538192
Epoch 2899 
Overall Loss: 11.717112
Rec Loss: 9.995259
KL Loss: 1.721854
Y Loss: 0.918618
T Loss: 9.535950
Epoch 2949 
Overall Loss: 11.735475
Rec Loss: 9.986562
KL Loss: 1.748913
Y Loss: 0.920999
T Loss: 9.526062
Epoch 2999 
Overall Loss: 11.733211
Rec Loss: 9.992128
KL Loss: 1.741083
Y Loss: 0.924360
T Loss: 9.529948
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.671022
Epoch 99
Rec Loss: 0.665129
Epoch 149
Rec Loss: 0.661567
Epoch 199
Rec Loss: 0.665417
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.187614
Epoch 99
Rec Loss: 10.184383
Epoch 149
Rec Loss: 10.171064
Epoch 199
Rec Loss: 10.179607
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.785492
Insample Error: 1.895800
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 15.079162
Rec Loss: 10.710941
KL Loss: 4.368222
Y Loss: 6.153199
T Loss: 13.484736
X Loss: -5.850395
Epoch 99 
Overall Loss: -1.426968
Rec Loss: -10.493867
KL Loss: 9.066899
Y Loss: 2.240325
T Loss: 13.256814
X Loss: -24.870844
Epoch 149 
Overall Loss: -5.964316
Rec Loss: -16.007770
KL Loss: 10.043455
Y Loss: 1.478966
T Loss: 13.159765
X Loss: -29.907018
Epoch 199 
Overall Loss: -8.807289
Rec Loss: -19.593058
KL Loss: 10.785769
Y Loss: 1.059625
T Loss: 12.951464
X Loss: -33.074333
Epoch 249 
Overall Loss: -11.033435
Rec Loss: -22.661325
KL Loss: 11.627891
Y Loss: 0.851923
T Loss: 12.529633
X Loss: -35.616920
Epoch 299 
Overall Loss: -12.811388
Rec Loss: -25.056821
KL Loss: 12.245432
Y Loss: 0.744126
T Loss: 12.197728
X Loss: -37.626613
Epoch 349 
Overall Loss: -13.755504
Rec Loss: -26.523796
KL Loss: 12.768292
Y Loss: 0.690686
T Loss: 12.013416
X Loss: -38.882554
Epoch 399 
Overall Loss: -14.863168
Rec Loss: -27.915623
KL Loss: 13.052455
Y Loss: 0.695440
T Loss: 11.888160
X Loss: -40.151503
Epoch 449 
Overall Loss: -15.609582
Rec Loss: -28.837770
KL Loss: 13.228189
Y Loss: 0.687836
T Loss: 11.836120
X Loss: -41.017808
Epoch 499 
Overall Loss: -16.385977
Rec Loss: -29.777828
KL Loss: 13.391851
Y Loss: 0.698849
T Loss: 11.787266
X Loss: -41.914519
Epoch 549 
Overall Loss: -16.974783
Rec Loss: -30.501247
KL Loss: 13.526465
Y Loss: 0.714599
T Loss: 11.741685
X Loss: -42.600232
Epoch 599 
Overall Loss: -17.722582
Rec Loss: -31.351011
KL Loss: 13.628428
Y Loss: 0.715297
T Loss: 11.703979
X Loss: -43.412639
Epoch 649 
Overall Loss: -17.920364
Rec Loss: -31.587938
KL Loss: 13.667574
Y Loss: 0.723215
T Loss: 11.686649
X Loss: -43.636194
Epoch 699 
Overall Loss: -18.441598
Rec Loss: -32.292505
KL Loss: 13.850907
Y Loss: 0.729993
T Loss: 11.650068
X Loss: -44.307570
Epoch 749 
Overall Loss: -19.027888
Rec Loss: -32.897321
KL Loss: 13.869432
Y Loss: 0.708095
T Loss: 11.631512
X Loss: -44.882878
Epoch 799 
Overall Loss: -19.330441
Rec Loss: -33.204391
KL Loss: 13.873949
Y Loss: 0.747621
T Loss: 11.627946
X Loss: -45.206146
Epoch 849 
Overall Loss: -19.648201
Rec Loss: -33.712016
KL Loss: 14.063814
Y Loss: 0.717270
T Loss: 11.590906
X Loss: -45.661557
Epoch 899 
Overall Loss: -19.777980
Rec Loss: -33.881556
KL Loss: 14.103575
Y Loss: 0.701784
T Loss: 11.563134
X Loss: -45.795581
Epoch 949 
Overall Loss: -20.335550
Rec Loss: -34.559857
KL Loss: 14.224308
Y Loss: 0.672428
T Loss: 11.551910
X Loss: -46.447981
Epoch 999 
Overall Loss: -20.518109
Rec Loss: -34.791763
KL Loss: 14.273655
Y Loss: 0.690102
T Loss: 11.533288
X Loss: -46.670102
Epoch 1049 
Overall Loss: -20.516042
Rec Loss: -34.753398
KL Loss: 14.237356
Y Loss: 0.695183
T Loss: 11.532568
X Loss: -46.633558
Epoch 1099 
Overall Loss: -20.921678
Rec Loss: -35.257700
KL Loss: 14.336022
Y Loss: 0.678920
T Loss: 11.518645
X Loss: -47.115805
Epoch 1149 
Overall Loss: -21.480848
Rec Loss: -35.833998
KL Loss: 14.353149
Y Loss: 0.707389
T Loss: 11.499533
X Loss: -47.687225
Epoch 1199 
Overall Loss: -21.625601
Rec Loss: -36.101090
KL Loss: 14.475488
Y Loss: 0.653172
T Loss: 11.471940
X Loss: -47.899616
Epoch 1249 
Overall Loss: -21.951971
Rec Loss: -36.418353
KL Loss: 14.466382
Y Loss: 0.682884
T Loss: 11.475803
X Loss: -48.235598
Epoch 1299 
Overall Loss: -22.163524
Rec Loss: -36.745199
KL Loss: 14.581675
Y Loss: 0.649408
T Loss: 11.456565
X Loss: -48.526467
Epoch 1349 
Overall Loss: -22.402695
Rec Loss: -37.065544
KL Loss: 14.662848
Y Loss: 0.652723
T Loss: 11.430663
X Loss: -48.822568
Epoch 1399 
Overall Loss: -22.478546
Rec Loss: -37.137336
KL Loss: 14.658790
Y Loss: 0.625835
T Loss: 11.420330
X Loss: -48.870584
Epoch 1449 
Overall Loss: -22.704392
Rec Loss: -37.457230
KL Loss: 14.752839
Y Loss: 0.607693
T Loss: 11.389117
X Loss: -49.150194
Epoch 1499 
Overall Loss: -22.734422
Rec Loss: -37.484283
KL Loss: 14.749860
Y Loss: 0.612666
T Loss: 11.396581
X Loss: -49.187197
Epoch 1549 
Overall Loss: -22.709102
Rec Loss: -37.357860
KL Loss: 14.648757
Y Loss: 0.614503
T Loss: 11.390854
X Loss: -49.055964
Epoch 1599 
Overall Loss: -23.108954
Rec Loss: -37.971037
KL Loss: 14.862083
Y Loss: 0.590822
T Loss: 11.364818
X Loss: -49.631266
Epoch 1649 
Overall Loss: -23.626618
Rec Loss: -38.401879
KL Loss: 14.775261
Y Loss: 0.593128
T Loss: 11.357972
X Loss: -50.056416
Epoch 1699 
Overall Loss: -23.629668
Rec Loss: -38.492353
KL Loss: 14.862684
Y Loss: 0.568463
T Loss: 11.333631
X Loss: -50.110215
Epoch 1749 
Overall Loss: -23.952958
Rec Loss: -38.790894
KL Loss: 14.837935
Y Loss: 0.594128
T Loss: 11.341101
X Loss: -50.429059
Epoch 1799 
Overall Loss: -24.058122
Rec Loss: -38.963833
KL Loss: 14.905711
Y Loss: 0.559299
T Loss: 11.313354
X Loss: -50.556838
Epoch 1849 
Overall Loss: -23.036237
Rec Loss: -38.028947
KL Loss: 14.992710
Y Loss: 0.544507
T Loss: 11.319048
X Loss: -49.620249
Epoch 1899 
Overall Loss: -24.044722
Rec Loss: -39.071485
KL Loss: 15.026763
Y Loss: 0.542452
T Loss: 11.300750
X Loss: -50.643461
Epoch 1949 
Overall Loss: -24.259748
Rec Loss: -39.131534
KL Loss: 14.871785
Y Loss: 0.551957
T Loss: 11.312171
X Loss: -50.719685
Epoch 1999 
Overall Loss: -24.502489
Rec Loss: -39.579740
KL Loss: 15.077253
Y Loss: 0.514321
T Loss: 11.279925
X Loss: -51.116827
Epoch 2049 
Overall Loss: -24.644845
Rec Loss: -39.741091
KL Loss: 15.096247
Y Loss: 0.518521
T Loss: 11.284586
X Loss: -51.284937
Epoch 2099 
Overall Loss: -24.956851
Rec Loss: -40.113572
KL Loss: 15.156721
Y Loss: 0.499769
T Loss: 11.270400
X Loss: -51.633857
Epoch 2149 
Overall Loss: -25.026818
Rec Loss: -40.196017
KL Loss: 15.169199
Y Loss: 0.507109
T Loss: 11.257416
X Loss: -51.706987
Epoch 2199 
Overall Loss: -24.924164
Rec Loss: -39.995683
KL Loss: 15.071520
Y Loss: 0.496890
T Loss: 11.268116
X Loss: -51.512244
Epoch 2249 
Overall Loss: -24.911507
Rec Loss: -40.064274
KL Loss: 15.152766
Y Loss: 0.482555
T Loss: 11.250689
X Loss: -51.556239
Epoch 2299 
Overall Loss: -25.019629
Rec Loss: -40.209768
KL Loss: 15.190139
Y Loss: 0.489394
T Loss: 11.256544
X Loss: -51.711008
Epoch 2349 
Overall Loss: -25.433449
Rec Loss: -40.583890
KL Loss: 15.150441
Y Loss: 0.490957
T Loss: 11.222798
X Loss: -52.052167
Epoch 2399 
Overall Loss: -24.852966
Rec Loss: -40.149481
KL Loss: 15.296515
Y Loss: 0.460707
T Loss: 11.209458
X Loss: -51.589292
Epoch 2449 
Overall Loss: -25.665143
Rec Loss: -40.853418
KL Loss: 15.188275
Y Loss: 0.490796
T Loss: 11.219139
X Loss: -52.317954
Epoch 2499 
Overall Loss: -25.717180
Rec Loss: -40.932069
KL Loss: 15.214890
Y Loss: 0.477989
T Loss: 11.201677
X Loss: -52.372741
Epoch 2549 
Overall Loss: -25.728512
Rec Loss: -41.044658
KL Loss: 15.316145
Y Loss: 0.482865
T Loss: 11.194146
X Loss: -52.480237
Epoch 2599 
Overall Loss: -25.805405
Rec Loss: -40.889482
KL Loss: 15.084078
Y Loss: 0.478396
T Loss: 11.192734
X Loss: -52.321414
Epoch 2649 
Overall Loss: -26.170096
Rec Loss: -41.535080
KL Loss: 15.364982
Y Loss: 0.468583
T Loss: 11.158094
X Loss: -52.927464
Epoch 2699 
Overall Loss: -25.992686
Rec Loss: -41.257978
KL Loss: 15.265291
Y Loss: 0.482271
T Loss: 11.166936
X Loss: -52.666049
Epoch 2749 
Overall Loss: -26.166395
Rec Loss: -41.347084
KL Loss: 15.180690
Y Loss: 0.477350
T Loss: 11.153398
X Loss: -52.739157
Epoch 2799 
Overall Loss: -26.404160
Rec Loss: -41.844992
KL Loss: 15.440833
Y Loss: 0.459586
T Loss: 11.119924
X Loss: -53.194709
Epoch 2849 
Overall Loss: -26.495727
Rec Loss: -41.763427
KL Loss: 15.267699
Y Loss: 0.463063
T Loss: 11.114775
X Loss: -53.109734
Epoch 2899 
Overall Loss: -25.270118
Rec Loss: -40.663948
KL Loss: 15.393830
Y Loss: 0.457926
T Loss: 11.087982
X Loss: -51.980893
Epoch 2949 
Overall Loss: -26.700486
Rec Loss: -42.205238
KL Loss: 15.504751
Y Loss: 0.441848
T Loss: 11.077459
X Loss: -53.503620
Epoch 2999 
Overall Loss: -26.541015
Rec Loss: -41.874651
KL Loss: 15.333637
Y Loss: 0.452975
T Loss: 11.084234
X Loss: -53.185373
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.398739
Epoch 99
Rec Loss: 2.385538
Epoch 149
Rec Loss: 2.370608
Epoch 199
Rec Loss: 2.363963
Epoch 249
Rec Loss: 2.357772
Epoch 299
Rec Loss: 2.364433
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.004524
Epoch 99
Rec Loss: 0.002372
Epoch 149
Rec Loss: 0.001843
Epoch 199
Rec Loss: 0.002456
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.427314
Insample Error 3.292691
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.492995
Epoch 99 
Prediction Loss: 2.180104
Epoch 149 
Prediction Loss: 2.058951
Epoch 199 
Prediction Loss: 2.035931
Epoch 249 
Prediction Loss: 1.984945
Epoch 299 
Prediction Loss: 1.971842
Epoch 349 
Prediction Loss: 1.948941
Epoch 399 
Prediction Loss: 1.919616
Epoch 449 
Prediction Loss: 1.904697
Epoch 499 
Prediction Loss: 1.903735
Epoch 549 
Prediction Loss: 1.891060
Epoch 599 
Prediction Loss: 1.871917
Epoch 649 
Prediction Loss: 1.887446
Epoch 699 
Prediction Loss: 1.845159
Epoch 749 
Prediction Loss: 1.826221
Epoch 799 
Prediction Loss: 1.825632
Epoch 849 
Prediction Loss: 1.816948
Epoch 899 
Prediction Loss: 1.796917
Epoch 949 
Prediction Loss: 1.797287
Epoch 999 
Prediction Loss: 1.791993
Epoch 1049 
Prediction Loss: 1.780472
Epoch 1099 
Prediction Loss: 1.774360
Epoch 1149 
Prediction Loss: 1.763004
Epoch 1199 
Prediction Loss: 1.756155
Epoch 1249 
Prediction Loss: 1.770546
Epoch 1299 
Prediction Loss: 1.741290
Epoch 1349 
Prediction Loss: 1.733907
Epoch 1399 
Prediction Loss: 1.733066
Epoch 1449 
Prediction Loss: 1.701726
Epoch 1499 
Prediction Loss: 1.727478
Epoch 1549 
Prediction Loss: 1.693376
Epoch 1599 
Prediction Loss: 1.695395
Epoch 1649 
Prediction Loss: 1.715155
Epoch 1699 
Prediction Loss: 1.675708
Epoch 1749 
Prediction Loss: 1.674492
Epoch 1799 
Prediction Loss: 1.658747
Epoch 1849 
Prediction Loss: 1.654260
Epoch 1899 
Prediction Loss: 1.661183
Epoch 1949 
Prediction Loss: 1.651802
Epoch 1999 
Prediction Loss: 1.632046
Epoch 2049 
Prediction Loss: 1.637398
Epoch 2099 
Prediction Loss: 1.623397
Epoch 2149 
Prediction Loss: 1.630926
Epoch 2199 
Prediction Loss: 1.603490
Epoch 2249 
Prediction Loss: 1.609500
Epoch 2299 
Prediction Loss: 1.599488
Epoch 2349 
Prediction Loss: 1.594568
Epoch 2399 
Prediction Loss: 1.594502
Epoch 2449 
Prediction Loss: 1.592256
Epoch 2499 
Prediction Loss: 1.573676
Epoch 2549 
Prediction Loss: 1.563751
Epoch 2599 
Prediction Loss: 1.588479
Epoch 2649 
Prediction Loss: 1.571277
Epoch 2699 
Prediction Loss: 1.540410
Epoch 2749 
Prediction Loss: 1.554240
Epoch 2799 
Prediction Loss: 1.539716
Epoch 2849 
Prediction Loss: 1.523257
Epoch 2899 
Prediction Loss: 1.555664
Epoch 2949 
Prediction Loss: 1.512523
Epoch 2999 
Prediction Loss: 1.517306
Epoch 3049 
Prediction Loss: 1.506692
Epoch 3099 
Prediction Loss: 1.496391
Epoch 3149 
Prediction Loss: 1.500676
Epoch 3199 
Prediction Loss: 1.497573
Epoch 3249 
Prediction Loss: 1.480899
Epoch 3299 
Prediction Loss: 1.482530
Epoch 3349 
Prediction Loss: 1.477625
Epoch 3399 
Prediction Loss: 1.476683
Epoch 3449 
Prediction Loss: 1.488924
Epoch 3499 
Prediction Loss: 1.471054
Epoch 3549 
Prediction Loss: 1.457049
Epoch 3599 
Prediction Loss: 1.449164
Epoch 3649 
Prediction Loss: 1.436121
Epoch 3699 
Prediction Loss: 1.439317
Epoch 3749 
Prediction Loss: 1.425151
Epoch 3799 
Prediction Loss: 1.439353
Epoch 3849 
Prediction Loss: 1.410458
Epoch 3899 
Prediction Loss: 1.404641
Epoch 3949 
Prediction Loss: 1.411617
Epoch 3999 
Prediction Loss: 1.396515
Epoch 4049 
Prediction Loss: 1.392958
Epoch 4099 
Prediction Loss: 1.388684
Epoch 4149 
Prediction Loss: 1.412094
Epoch 4199 
Prediction Loss: 1.412650
Epoch 4249 
Prediction Loss: 1.393697
Epoch 4299 
Prediction Loss: 1.398865
Epoch 4349 
Prediction Loss: 1.356918
Epoch 4399 
Prediction Loss: 1.361065
Epoch 4449 
Prediction Loss: 1.355917
Epoch 4499 
Prediction Loss: 1.369797
Epoch 4549 
Prediction Loss: 1.365666
Epoch 4599 
Prediction Loss: 1.361027
Epoch 4649 
Prediction Loss: 1.349709
Epoch 4699 
Prediction Loss: 1.345008
Epoch 4749 
Prediction Loss: 1.322225
Epoch 4799 
Prediction Loss: 1.333497
Epoch 4849 
Prediction Loss: 1.319906
Epoch 4899 
Prediction Loss: 1.327377
Epoch 4949 
Prediction Loss: 1.309197
Epoch 4999 
Prediction Loss: 1.310056
Epoch 5049 
Prediction Loss: 1.306630
Epoch 5099 
Prediction Loss: 1.303517
Epoch 5149 
Prediction Loss: 1.308635
Epoch 5199 
Prediction Loss: 1.310279
Epoch 5249 
Prediction Loss: 1.287800
Epoch 5299 
Prediction Loss: 1.299879
Epoch 5349 
Prediction Loss: 1.270761
Epoch 5399 
Prediction Loss: 1.288844
Epoch 5449 
Prediction Loss: 1.257217
Epoch 5499 
Prediction Loss: 1.278600
Epoch 5549 
Prediction Loss: 1.271175
Epoch 5599 
Prediction Loss: 1.281807
Epoch 5649 
Prediction Loss: 1.244552
Epoch 5699 
Prediction Loss: 1.272092
Epoch 5749 
Prediction Loss: 1.255113
Epoch 5799 
Prediction Loss: 1.243940
Epoch 5849 
Prediction Loss: 1.238482
Epoch 5899 
Prediction Loss: 1.263294
Epoch 5949 
Prediction Loss: 1.250627
Epoch 5999 
Prediction Loss: 1.236919
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.119191
Insample Error 3.119766
[31m========== repeat time 5 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.267674
Rec Loss: 10.105577
KL Loss: 2.162097
Y Loss: 0.958198
T Loss: 9.626478
Epoch 99 
Overall Loss: 12.059083
Rec Loss: 10.126635
KL Loss: 1.932448
Y Loss: 0.962679
T Loss: 9.645296
Epoch 149 
Overall Loss: 11.972740
Rec Loss: 10.133032
KL Loss: 1.839709
Y Loss: 0.983102
T Loss: 9.641480
Epoch 199 
Overall Loss: 11.922909
Rec Loss: 10.128654
KL Loss: 1.794255
Y Loss: 0.989769
T Loss: 9.633770
Epoch 249 
Overall Loss: 11.895092
Rec Loss: 10.132593
KL Loss: 1.762498
Y Loss: 0.976920
T Loss: 9.644133
Epoch 299 
Overall Loss: 11.873162
Rec Loss: 10.131308
KL Loss: 1.741854
Y Loss: 0.987725
T Loss: 9.637445
Epoch 349 
Overall Loss: 11.871147
Rec Loss: 10.130542
KL Loss: 1.740605
Y Loss: 0.999719
T Loss: 9.630682
Epoch 399 
Overall Loss: 11.870777
Rec Loss: 10.123437
KL Loss: 1.747339
Y Loss: 0.965484
T Loss: 9.640695
Epoch 449 
Overall Loss: 11.863940
Rec Loss: 10.082162
KL Loss: 1.781778
Y Loss: 0.960636
T Loss: 9.601844
Epoch 499 
Overall Loss: 11.860733
Rec Loss: 10.106660
KL Loss: 1.754072
Y Loss: 0.976789
T Loss: 9.618266
Epoch 549 
Overall Loss: 11.823348
Rec Loss: 10.083220
KL Loss: 1.740128
Y Loss: 0.959552
T Loss: 9.603444
Epoch 599 
Overall Loss: 11.821140
Rec Loss: 10.057980
KL Loss: 1.763161
Y Loss: 0.935641
T Loss: 9.590159
Epoch 649 
Overall Loss: 11.842355
Rec Loss: 10.081362
KL Loss: 1.760993
Y Loss: 0.951372
T Loss: 9.605676
Epoch 699 
Overall Loss: 11.811641
Rec Loss: 10.077903
KL Loss: 1.733739
Y Loss: 0.961243
T Loss: 9.597281
Epoch 749 
Overall Loss: 11.851662
Rec Loss: 10.090966
KL Loss: 1.760696
Y Loss: 0.962079
T Loss: 9.609927
Epoch 799 
Overall Loss: 11.826949
Rec Loss: 10.056943
KL Loss: 1.770005
Y Loss: 0.927896
T Loss: 9.592995
Epoch 849 
Overall Loss: 11.815836
Rec Loss: 10.064145
KL Loss: 1.751691
Y Loss: 0.923041
T Loss: 9.602624
Epoch 899 
Overall Loss: 11.804616
Rec Loss: 10.064368
KL Loss: 1.740248
Y Loss: 0.951765
T Loss: 9.588485
Epoch 949 
Overall Loss: 11.797725
Rec Loss: 10.047799
KL Loss: 1.749926
Y Loss: 0.942939
T Loss: 9.576329
Epoch 999 
Overall Loss: 11.791193
Rec Loss: 10.037255
KL Loss: 1.753937
Y Loss: 0.936199
T Loss: 9.569156
Epoch 1049 
Overall Loss: 11.807915
Rec Loss: 10.067997
KL Loss: 1.739919
Y Loss: 0.940022
T Loss: 9.597985
Epoch 1099 
Overall Loss: 11.808865
Rec Loss: 10.052043
KL Loss: 1.756823
Y Loss: 0.927414
T Loss: 9.588335
Epoch 1149 
Overall Loss: 11.776165
Rec Loss: 10.062294
KL Loss: 1.713871
Y Loss: 0.925305
T Loss: 9.599642
Epoch 1199 
Overall Loss: 11.778111
Rec Loss: 10.044460
KL Loss: 1.733651
Y Loss: 0.923181
T Loss: 9.582869
Epoch 1249 
Overall Loss: 11.796848
Rec Loss: 10.056224
KL Loss: 1.740624
Y Loss: 0.933580
T Loss: 9.589434
Epoch 1299 
Overall Loss: 11.788228
Rec Loss: 10.044436
KL Loss: 1.743792
Y Loss: 0.944087
T Loss: 9.572393
Epoch 1349 
Overall Loss: 11.798572
Rec Loss: 10.015149
KL Loss: 1.783423
Y Loss: 0.917464
T Loss: 9.556416
Epoch 1399 
Overall Loss: 11.779708
Rec Loss: 10.045383
KL Loss: 1.734325
Y Loss: 0.917918
T Loss: 9.586424
Epoch 1449 
Overall Loss: 11.788060
Rec Loss: 10.043854
KL Loss: 1.744206
Y Loss: 0.917347
T Loss: 9.585180
Epoch 1499 
Overall Loss: 11.779850
Rec Loss: 10.036707
KL Loss: 1.743142
Y Loss: 0.910353
T Loss: 9.581530
Epoch 1549 
Overall Loss: 11.774863
Rec Loss: 10.037048
KL Loss: 1.737814
Y Loss: 0.945257
T Loss: 9.564419
Epoch 1599 
Overall Loss: 11.780668
Rec Loss: 10.034454
KL Loss: 1.746214
Y Loss: 0.918056
T Loss: 9.575426
Epoch 1649 
Overall Loss: 11.751227
Rec Loss: 10.038326
KL Loss: 1.712902
Y Loss: 0.940102
T Loss: 9.568275
Epoch 1699 
Overall Loss: 11.770027
Rec Loss: 10.054669
KL Loss: 1.715357
Y Loss: 0.950562
T Loss: 9.579389
Epoch 1749 
Overall Loss: 11.758786
Rec Loss: 10.018277
KL Loss: 1.740509
Y Loss: 0.915976
T Loss: 9.560289
Epoch 1799 
Overall Loss: 11.775451
Rec Loss: 10.033170
KL Loss: 1.742282
Y Loss: 0.934832
T Loss: 9.565754
Epoch 1849 
Overall Loss: 11.751188
Rec Loss: 10.015717
KL Loss: 1.735472
Y Loss: 0.916981
T Loss: 9.557226
Epoch 1899 
Overall Loss: 11.769552
Rec Loss: 10.046353
KL Loss: 1.723199
Y Loss: 0.934362
T Loss: 9.579172
Epoch 1949 
Overall Loss: 11.748183
Rec Loss: 10.025810
KL Loss: 1.722373
Y Loss: 0.922262
T Loss: 9.564679
Epoch 1999 
Overall Loss: 11.760131
Rec Loss: 10.018889
KL Loss: 1.741242
Y Loss: 0.910286
T Loss: 9.563746
Epoch 2049 
Overall Loss: 11.746244
Rec Loss: 10.007639
KL Loss: 1.738605
Y Loss: 0.926310
T Loss: 9.544484
Epoch 2099 
Overall Loss: 11.757143
Rec Loss: 10.007258
KL Loss: 1.749885
Y Loss: 0.918292
T Loss: 9.548113
Epoch 2149 
Overall Loss: 11.754971
Rec Loss: 10.021169
KL Loss: 1.733801
Y Loss: 0.922589
T Loss: 9.559875
Epoch 2199 
Overall Loss: 11.773913
Rec Loss: 10.044098
KL Loss: 1.729816
Y Loss: 0.920284
T Loss: 9.583956
Epoch 2249 
Overall Loss: 11.739586
Rec Loss: 10.019704
KL Loss: 1.719882
Y Loss: 0.932666
T Loss: 9.553371
Epoch 2299 
Overall Loss: 11.729715
Rec Loss: 10.004426
KL Loss: 1.725289
Y Loss: 0.912912
T Loss: 9.547970
Epoch 2349 
Overall Loss: 11.735346
Rec Loss: 10.007781
KL Loss: 1.727565
Y Loss: 0.918627
T Loss: 9.548467
Epoch 2399 
Overall Loss: 11.750128
Rec Loss: 10.005388
KL Loss: 1.744740
Y Loss: 0.911519
T Loss: 9.549628
Epoch 2449 
Overall Loss: 11.741936
Rec Loss: 9.999623
KL Loss: 1.742313
Y Loss: 0.924825
T Loss: 9.537210
Epoch 2499 
Overall Loss: 11.744898
Rec Loss: 10.008170
KL Loss: 1.736729
Y Loss: 0.940735
T Loss: 9.537802
Epoch 2549 
Overall Loss: 11.724657
Rec Loss: 10.007782
KL Loss: 1.716875
Y Loss: 0.899932
T Loss: 9.557817
Epoch 2599 
Overall Loss: 11.724410
Rec Loss: 9.997365
KL Loss: 1.727045
Y Loss: 0.906389
T Loss: 9.544170
Epoch 2649 
Overall Loss: 11.730938
Rec Loss: 9.975721
KL Loss: 1.755216
Y Loss: 0.889927
T Loss: 9.530758
Epoch 2699 
Overall Loss: 11.717258
Rec Loss: 9.989500
KL Loss: 1.727758
Y Loss: 0.900120
T Loss: 9.539440
Epoch 2749 
Overall Loss: 11.729387
Rec Loss: 9.973360
KL Loss: 1.756028
Y Loss: 0.914167
T Loss: 9.516276
Epoch 2799 
Overall Loss: 11.730864
Rec Loss: 10.009767
KL Loss: 1.721096
Y Loss: 0.917444
T Loss: 9.551045
Epoch 2849 
Overall Loss: 11.727102
Rec Loss: 10.018868
KL Loss: 1.708235
Y Loss: 0.953944
T Loss: 9.541896
Epoch 2899 
Overall Loss: 11.721078
Rec Loss: 9.999554
KL Loss: 1.721524
Y Loss: 0.920339
T Loss: 9.539384
Epoch 2949 
Overall Loss: 11.748316
Rec Loss: 10.021379
KL Loss: 1.726937
Y Loss: 0.916165
T Loss: 9.563297
Epoch 2999 
Overall Loss: 11.724468
Rec Loss: 9.974871
KL Loss: 1.749597
Y Loss: 0.915340
T Loss: 9.517201
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.705003
Epoch 99
Rec Loss: 0.705526
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.174641
Epoch 99
Rec Loss: 10.167403
Epoch 149
Rec Loss: 10.170933
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.779408
Insample Error: 1.914194
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 16.973800
Rec Loss: 13.326855
KL Loss: 3.646944
Y Loss: 6.405156
T Loss: 13.524878
X Loss: -3.400600
Epoch 99 
Overall Loss: -0.695998
Rec Loss: -9.353842
KL Loss: 8.657844
Y Loss: 2.834557
T Loss: 13.287974
X Loss: -24.059095
Epoch 149 
Overall Loss: -5.460710
Rec Loss: -15.003315
KL Loss: 9.542605
Y Loss: 2.141803
T Loss: 13.238255
X Loss: -29.312471
Epoch 199 
Overall Loss: -8.980164
Rec Loss: -19.586452
KL Loss: 10.606288
Y Loss: 1.412305
T Loss: 13.171023
X Loss: -33.463627
Epoch 249 
Overall Loss: -11.096969
Rec Loss: -22.539313
KL Loss: 11.442344
Y Loss: 0.901731
T Loss: 13.109533
X Loss: -36.099712
Epoch 299 
Overall Loss: -12.355103
Rec Loss: -24.281497
KL Loss: 11.926394
Y Loss: 0.632713
T Loss: 13.030625
X Loss: -37.628477
Epoch 349 
Overall Loss: -13.447910
Rec Loss: -25.746975
KL Loss: 12.299065
Y Loss: 0.534838
T Loss: 12.926993
X Loss: -38.941386
Epoch 399 
Overall Loss: -14.344803
Rec Loss: -27.036654
KL Loss: 12.691851
Y Loss: 0.491260
T Loss: 12.777093
X Loss: -40.059377
Epoch 449 
Overall Loss: -15.171982
Rec Loss: -28.201701
KL Loss: 13.029719
Y Loss: 0.484741
T Loss: 12.585117
X Loss: -41.029188
Epoch 499 
Overall Loss: -15.808392
Rec Loss: -29.155053
KL Loss: 13.346661
Y Loss: 0.453479
T Loss: 12.367542
X Loss: -41.749335
Epoch 549 
Overall Loss: -16.440184
Rec Loss: -30.021602
KL Loss: 13.581418
Y Loss: 0.444698
T Loss: 12.193263
X Loss: -42.437213
Epoch 599 
Overall Loss: -17.005404
Rec Loss: -30.798361
KL Loss: 13.792956
Y Loss: 0.435094
T Loss: 12.048161
X Loss: -43.064068
Epoch 649 
Overall Loss: -17.525117
Rec Loss: -31.488621
KL Loss: 13.963504
Y Loss: 0.435283
T Loss: 11.942033
X Loss: -43.648295
Epoch 699 
Overall Loss: -17.838326
Rec Loss: -31.916841
KL Loss: 14.078515
Y Loss: 0.425136
T Loss: 11.866762
X Loss: -43.996172
Epoch 749 
Overall Loss: -18.378162
Rec Loss: -32.597749
KL Loss: 14.219588
Y Loss: 0.435824
T Loss: 11.780401
X Loss: -44.596062
Epoch 799 
Overall Loss: -18.783200
Rec Loss: -33.147030
KL Loss: 14.363830
Y Loss: 0.420579
T Loss: 11.702293
X Loss: -45.059612
Epoch 849 
Overall Loss: -19.054274
Rec Loss: -33.522287
KL Loss: 14.468012
Y Loss: 0.423633
T Loss: 11.645260
X Loss: -45.379362
Epoch 899 
Overall Loss: -19.590789
Rec Loss: -34.168233
KL Loss: 14.577443
Y Loss: 0.402261
T Loss: 11.589624
X Loss: -45.958988
Epoch 949 
Overall Loss: -19.831169
Rec Loss: -34.497480
KL Loss: 14.666310
Y Loss: 0.405140
T Loss: 11.532691
X Loss: -46.232739
Epoch 999 
Overall Loss: -20.102135
Rec Loss: -34.700283
KL Loss: 14.598148
Y Loss: 0.421888
T Loss: 11.503379
X Loss: -46.414606
Epoch 1049 
Overall Loss: -20.193308
Rec Loss: -35.068375
KL Loss: 14.875067
Y Loss: 0.391775
T Loss: 11.433419
X Loss: -46.697683
Epoch 1099 
Overall Loss: -20.695702
Rec Loss: -35.605527
KL Loss: 14.909825
Y Loss: 0.406530
T Loss: 11.404985
X Loss: -47.213777
Epoch 1149 
Overall Loss: -20.792926
Rec Loss: -35.835941
KL Loss: 15.043015
Y Loss: 0.384884
T Loss: 11.351742
X Loss: -47.380125
Epoch 1199 
Overall Loss: -20.974821
Rec Loss: -35.934670
KL Loss: 14.959849
Y Loss: 0.407231
T Loss: 11.330116
X Loss: -47.468402
Epoch 1249 
Overall Loss: -21.216513
Rec Loss: -36.231293
KL Loss: 15.014780
Y Loss: 0.383820
T Loss: 11.313303
X Loss: -47.736507
Epoch 1299 
Overall Loss: -21.411704
Rec Loss: -36.462614
KL Loss: 15.050909
Y Loss: 0.409339
T Loss: 11.287573
X Loss: -47.954856
Epoch 1349 
Overall Loss: -21.764032
Rec Loss: -36.977928
KL Loss: 15.213896
Y Loss: 0.395101
T Loss: 11.251401
X Loss: -48.426879
Epoch 1399 
Overall Loss: -21.932750
Rec Loss: -37.148038
KL Loss: 15.215287
Y Loss: 0.402397
T Loss: 11.253599
X Loss: -48.602835
Epoch 1449 
Overall Loss: -22.271073
Rec Loss: -37.562861
KL Loss: 15.291788
Y Loss: 0.401247
T Loss: 11.210791
X Loss: -48.974275
Epoch 1499 
Overall Loss: -22.194384
Rec Loss: -37.574305
KL Loss: 15.379920
Y Loss: 0.400992
T Loss: 11.190289
X Loss: -48.965090
Epoch 1549 
Overall Loss: -22.516305
Rec Loss: -37.827730
KL Loss: 15.311426
Y Loss: 0.421840
T Loss: 11.190953
X Loss: -49.229604
Epoch 1599 
Overall Loss: -22.626168
Rec Loss: -38.010591
KL Loss: 15.384424
Y Loss: 0.423839
T Loss: 11.192577
X Loss: -49.415086
Epoch 1649 
Overall Loss: -22.905223
Rec Loss: -38.356529
KL Loss: 15.451306
Y Loss: 0.415043
T Loss: 11.163891
X Loss: -49.727941
Epoch 1699 
Overall Loss: -22.446604
Rec Loss: -37.929918
KL Loss: 15.483314
Y Loss: 0.432119
T Loss: 11.149080
X Loss: -49.295058
Epoch 1749 
Overall Loss: -22.994644
Rec Loss: -38.535414
KL Loss: 15.540772
Y Loss: 0.427664
T Loss: 11.140198
X Loss: -49.889446
Epoch 1799 
Overall Loss: -23.002808
Rec Loss: -38.395250
KL Loss: 15.392442
Y Loss: 0.458678
T Loss: 11.150630
X Loss: -49.775220
Epoch 1849 
Overall Loss: -23.581236
Rec Loss: -38.963863
KL Loss: 15.382626
Y Loss: 0.472576
T Loss: 11.158892
X Loss: -50.359043
Epoch 1899 
Overall Loss: -23.561451
Rec Loss: -39.131556
KL Loss: 15.570104
Y Loss: 0.469385
T Loss: 11.134771
X Loss: -50.501019
Epoch 1949 
Overall Loss: -23.251630
Rec Loss: -38.816782
KL Loss: 15.565152
Y Loss: 0.472021
T Loss: 11.119621
X Loss: -50.172414
Epoch 1999 
Overall Loss: -23.697925
Rec Loss: -39.298252
KL Loss: 15.600328
Y Loss: 0.467735
T Loss: 11.105015
X Loss: -50.637134
Epoch 2049 
Overall Loss: -23.762406
Rec Loss: -39.387711
KL Loss: 15.625304
Y Loss: 0.466701
T Loss: 11.103477
X Loss: -50.724539
Epoch 2099 
Overall Loss: -23.823436
Rec Loss: -39.465932
KL Loss: 15.642494
Y Loss: 0.483964
T Loss: 11.081780
X Loss: -50.789693
Epoch 2149 
Overall Loss: -24.395866
Rec Loss: -40.029788
KL Loss: 15.633921
Y Loss: 0.500373
T Loss: 11.093472
X Loss: -51.373446
Epoch 2199 
Overall Loss: -24.049635
Rec Loss: -39.519937
KL Loss: 15.470302
Y Loss: 0.551749
T Loss: 11.096590
X Loss: -50.892401
Epoch 2249 
Overall Loss: -24.255430
Rec Loss: -39.916862
KL Loss: 15.661432
Y Loss: 0.522736
T Loss: 11.076220
X Loss: -51.254450
Epoch 2299 
Overall Loss: -24.777747
Rec Loss: -40.338709
KL Loss: 15.560963
Y Loss: 0.537876
T Loss: 11.092330
X Loss: -51.699978
Epoch 2349 
Overall Loss: -24.297779
Rec Loss: -39.897803
KL Loss: 15.600024
Y Loss: 0.538625
T Loss: 11.085701
X Loss: -51.252817
Epoch 2399 
Overall Loss: -24.520619
Rec Loss: -40.251376
KL Loss: 15.730756
Y Loss: 0.530829
T Loss: 11.077648
X Loss: -51.594437
Epoch 2449 
Overall Loss: -24.529045
Rec Loss: -40.144200
KL Loss: 15.615155
Y Loss: 0.560681
T Loss: 11.079647
X Loss: -51.504187
Epoch 2499 
Overall Loss: -24.392050
Rec Loss: -39.937041
KL Loss: 15.544990
Y Loss: 0.555910
T Loss: 11.084379
X Loss: -51.299376
Epoch 2549 
Overall Loss: -24.758143
Rec Loss: -40.446022
KL Loss: 15.687879
Y Loss: 0.557178
T Loss: 11.060772
X Loss: -51.785383
Epoch 2599 
Overall Loss: -25.196707
Rec Loss: -40.978688
KL Loss: 15.781981
Y Loss: 0.551432
T Loss: 11.050403
X Loss: -52.304808
Epoch 2649 
Overall Loss: -25.246769
Rec Loss: -40.966709
KL Loss: 15.719940
Y Loss: 0.558085
T Loss: 11.056006
X Loss: -52.301757
Epoch 2699 
Overall Loss: -25.483104
Rec Loss: -41.310575
KL Loss: 15.827472
Y Loss: 0.552187
T Loss: 11.059105
X Loss: -52.645773
Epoch 2749 
Overall Loss: -25.471086
Rec Loss: -41.098716
KL Loss: 15.627631
Y Loss: 0.587356
T Loss: 11.069577
X Loss: -52.461970
Epoch 2799 
Overall Loss: -24.921783
Rec Loss: -40.809872
KL Loss: 15.888089
Y Loss: 0.544996
T Loss: 11.065127
X Loss: -52.147498
Epoch 2849 
Overall Loss: -24.497280
Rec Loss: -40.247150
KL Loss: 15.749870
Y Loss: 0.566384
T Loss: 11.054179
X Loss: -51.584523
Epoch 2899 
Overall Loss: -25.729027
Rec Loss: -41.487024
KL Loss: 15.757996
Y Loss: 0.596203
T Loss: 11.057788
X Loss: -52.842913
Epoch 2949 
Overall Loss: -25.041175
Rec Loss: -40.815421
KL Loss: 15.774246
Y Loss: 0.591688
T Loss: 11.063561
X Loss: -52.174826
Epoch 2999 
Overall Loss: -25.435217
Rec Loss: -41.310297
KL Loss: 15.875080
Y Loss: 0.584479
T Loss: 11.046521
X Loss: -52.649058
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.475771
Epoch 99
Rec Loss: 2.454201
Epoch 149
Rec Loss: 2.449830
Epoch 199
Rec Loss: 2.442880
Epoch 249
Rec Loss: 2.444383
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.005976
Epoch 99
Rec Loss: 0.002123
Epoch 149
Rec Loss: 0.002139
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.342902
Insample Error 2.722391
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.425007
Epoch 99 
Prediction Loss: 2.189877
Epoch 149 
Prediction Loss: 2.059952
Epoch 199 
Prediction Loss: 2.011057
Epoch 249 
Prediction Loss: 1.985058
Epoch 299 
Prediction Loss: 1.954673
Epoch 349 
Prediction Loss: 1.935368
Epoch 399 
Prediction Loss: 1.919059
Epoch 449 
Prediction Loss: 1.899279
Epoch 499 
Prediction Loss: 1.886331
Epoch 549 
Prediction Loss: 1.883352
Epoch 599 
Prediction Loss: 1.865542
Epoch 649 
Prediction Loss: 1.875338
Epoch 699 
Prediction Loss: 1.858661
Epoch 749 
Prediction Loss: 1.842048
Epoch 799 
Prediction Loss: 1.835613
Epoch 849 
Prediction Loss: 1.816365
Epoch 899 
Prediction Loss: 1.835959
Epoch 949 
Prediction Loss: 1.813398
Epoch 999 
Prediction Loss: 1.813684
Epoch 1049 
Prediction Loss: 1.832768
Epoch 1099 
Prediction Loss: 1.796383
Epoch 1149 
Prediction Loss: 1.769439
Epoch 1199 
Prediction Loss: 1.775640
Epoch 1249 
Prediction Loss: 1.778811
Epoch 1299 
Prediction Loss: 1.754967
Epoch 1349 
Prediction Loss: 1.750894
Epoch 1399 
Prediction Loss: 1.742478
Epoch 1449 
Prediction Loss: 1.740241
Epoch 1499 
Prediction Loss: 1.738395
Epoch 1549 
Prediction Loss: 1.762653
Epoch 1599 
Prediction Loss: 1.718715
Epoch 1649 
Prediction Loss: 1.721246
Epoch 1699 
Prediction Loss: 1.726489
Epoch 1749 
Prediction Loss: 1.710433
Epoch 1799 
Prediction Loss: 1.702935
Epoch 1849 
Prediction Loss: 1.699503
Epoch 1899 
Prediction Loss: 1.723523
Epoch 1949 
Prediction Loss: 1.679623
Epoch 1999 
Prediction Loss: 1.687890
Epoch 2049 
Prediction Loss: 1.666741
Epoch 2099 
Prediction Loss: 1.683202
Epoch 2149 
Prediction Loss: 1.662407
Epoch 2199 
Prediction Loss: 1.650871
Epoch 2249 
Prediction Loss: 1.645925
Epoch 2299 
Prediction Loss: 1.638718
Epoch 2349 
Prediction Loss: 1.635760
Epoch 2399 
Prediction Loss: 1.640087
Epoch 2449 
Prediction Loss: 1.652553
Epoch 2499 
Prediction Loss: 1.641540
Epoch 2549 
Prediction Loss: 1.615040
Epoch 2599 
Prediction Loss: 1.606127
Epoch 2649 
Prediction Loss: 1.606442
Epoch 2699 
Prediction Loss: 1.591934
Epoch 2749 
Prediction Loss: 1.585510
Epoch 2799 
Prediction Loss: 1.622778
Epoch 2849 
Prediction Loss: 1.590579
Epoch 2899 
Prediction Loss: 1.567926
Epoch 2949 
Prediction Loss: 1.581644
Epoch 2999 
Prediction Loss: 1.573419
Epoch 3049 
Prediction Loss: 1.563117
Epoch 3099 
Prediction Loss: 1.566726
Epoch 3149 
Prediction Loss: 1.572404
Epoch 3199 
Prediction Loss: 1.554701
Epoch 3249 
Prediction Loss: 1.552457
Epoch 3299 
Prediction Loss: 1.533840
Epoch 3349 
Prediction Loss: 1.536200
Epoch 3399 
Prediction Loss: 1.531992
Epoch 3449 
Prediction Loss: 1.513338
Epoch 3499 
Prediction Loss: 1.506950
Epoch 3549 
Prediction Loss: 1.509092
Epoch 3599 
Prediction Loss: 1.529241
Epoch 3649 
Prediction Loss: 1.493926
Epoch 3699 
Prediction Loss: 1.509898
Epoch 3749 
Prediction Loss: 1.483857
Epoch 3799 
Prediction Loss: 1.509775
Epoch 3849 
Prediction Loss: 1.468883
Epoch 3899 
Prediction Loss: 1.511391
Epoch 3949 
Prediction Loss: 1.493767
Epoch 3999 
Prediction Loss: 1.474702
Epoch 4049 
Prediction Loss: 1.460225
Epoch 4099 
Prediction Loss: 1.449756
Epoch 4149 
Prediction Loss: 1.445717
Epoch 4199 
Prediction Loss: 1.443262
Epoch 4249 
Prediction Loss: 1.439502
Epoch 4299 
Prediction Loss: 1.426877
Epoch 4349 
Prediction Loss: 1.440559
Epoch 4399 
Prediction Loss: 1.457947
Epoch 4449 
Prediction Loss: 1.435117
Epoch 4499 
Prediction Loss: 1.420051
Epoch 4549 
Prediction Loss: 1.416543
Epoch 4599 
Prediction Loss: 1.400216
Epoch 4649 
Prediction Loss: 1.417840
Epoch 4699 
Prediction Loss: 1.407977
Epoch 4749 
Prediction Loss: 1.405061
Epoch 4799 
Prediction Loss: 1.402833
Epoch 4849 
Prediction Loss: 1.408329
Epoch 4899 
Prediction Loss: 1.399001
Epoch 4949 
Prediction Loss: 1.384396
Epoch 4999 
Prediction Loss: 1.378184
Epoch 5049 
Prediction Loss: 1.376223
Epoch 5099 
Prediction Loss: 1.403739
Epoch 5149 
Prediction Loss: 1.366645
Epoch 5199 
Prediction Loss: 1.357473
Epoch 5249 
Prediction Loss: 1.366773
Epoch 5299 
Prediction Loss: 1.359774
Epoch 5349 
Prediction Loss: 1.360067
Epoch 5399 
Prediction Loss: 1.342210
Epoch 5449 
Prediction Loss: 1.338482
Epoch 5499 
Prediction Loss: 1.360069
Epoch 5549 
Prediction Loss: 1.353162
Epoch 5599 
Prediction Loss: 1.332213
Epoch 5649 
Prediction Loss: 1.317028
Epoch 5699 
Prediction Loss: 1.321331
Epoch 5749 
Prediction Loss: 1.311505
Epoch 5799 
Prediction Loss: 1.316013
Epoch 5849 
Prediction Loss: 1.303207
Epoch 5899 
Prediction Loss: 1.293057
Epoch 5949 
Prediction Loss: 1.296149
Epoch 5999 
Prediction Loss: 1.306313
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 1.145385
Insample Error 3.061619
Ours, Train RMSE
0.7688, 
0.7755, 
0.7719, 
0.7855, 
0.7794, 
CEVAE, Train RMSE
0.3643, 
0.2255, 
0.1414, 
0.4273, 
0.3429, 
Ours, Insample RMSE
2.0369, 
1.9769, 
2.0015, 
1.8958, 
1.9142, 
CEVAE, Insample RMSE
3.6367, 
4.2317, 
3.0680, 
3.2927, 
2.7224, 
Direct Regression, Insample RMSE
3.1207, 
3.1044, 
3.0437, 
3.1198, 
3.0616, 
Train, RMSE mean 0.7762 std 0.0058
CEVAE, RMSE mean 0.3003 std 0.1029
Ours, RMSE mean 1.9651 std 0.0529, reconstruct confounder 0.6994 (0.0193) noise 10.1720 (0.0072)
CEVAE, RMSE mean 3.3903 std 0.5154, reconstruct confounder 2.3831 (0.0735) noise 0.0016 (0.0005)
Direct Regression, RMSE mean 3.0900 std 0.0316
