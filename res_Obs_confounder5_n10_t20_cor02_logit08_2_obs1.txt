Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=5, mask=0, nlayer=50, obsm=1, stop=5000, ycof=0.5, ylayer=50)
Y Mean 0.924902, Std 2.914444 
Test Y Mean 0.002127, Std 2.874724 
Observe confounder 1, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.397962
Rec Loss: 11.408227
KL Loss: 1.989735
Y Loss: 1.005726
T Loss: 10.905363
Epoch 99 
Overall Loss: 13.260484
Rec Loss: 10.991975
KL Loss: 2.268510
Y Loss: 0.991356
T Loss: 10.496297
Epoch 149 
Overall Loss: 13.227104
Rec Loss: 10.962481
KL Loss: 2.264623
Y Loss: 0.986695
T Loss: 10.469134
Epoch 199 
Overall Loss: 13.212902
Rec Loss: 10.932842
KL Loss: 2.280060
Y Loss: 0.990034
T Loss: 10.437825
Epoch 249 
Overall Loss: 13.184531
Rec Loss: 10.923025
KL Loss: 2.261506
Y Loss: 0.972252
T Loss: 10.436899
Epoch 299 
Overall Loss: 13.181483
Rec Loss: 10.899336
KL Loss: 2.282146
Y Loss: 0.964692
T Loss: 10.416990
Epoch 349 
Overall Loss: 13.165173
Rec Loss: 10.893614
KL Loss: 2.271559
Y Loss: 0.970551
T Loss: 10.408339
Epoch 399 
Overall Loss: 13.180374
Rec Loss: 10.884552
KL Loss: 2.295821
Y Loss: 0.978161
T Loss: 10.395472
Epoch 449 
Overall Loss: 13.161029
Rec Loss: 10.858167
KL Loss: 2.302862
Y Loss: 0.986235
T Loss: 10.365049
Epoch 499 
Overall Loss: 13.137178
Rec Loss: 10.866126
KL Loss: 2.271052
Y Loss: 0.961109
T Loss: 10.385572
Epoch 549 
Overall Loss: 13.140517
Rec Loss: 10.845313
KL Loss: 2.295204
Y Loss: 0.953551
T Loss: 10.368537
Epoch 599 
Overall Loss: 13.120683
Rec Loss: 10.869872
KL Loss: 2.250811
Y Loss: 0.992550
T Loss: 10.373597
Epoch 649 
Overall Loss: 13.140990
Rec Loss: 10.837028
KL Loss: 2.303963
Y Loss: 0.954513
T Loss: 10.359771
Epoch 699 
Overall Loss: 13.140570
Rec Loss: 10.840819
KL Loss: 2.299751
Y Loss: 0.984308
T Loss: 10.348665
Epoch 749 
Overall Loss: 13.129620
Rec Loss: 10.823406
KL Loss: 2.306213
Y Loss: 0.948000
T Loss: 10.349406
Epoch 799 
Overall Loss: 13.127627
Rec Loss: 10.836982
KL Loss: 2.290645
Y Loss: 0.981397
T Loss: 10.346283
Epoch 849 
Overall Loss: 13.120295
Rec Loss: 10.828647
KL Loss: 2.291648
Y Loss: 0.981891
T Loss: 10.337702
Epoch 899 
Overall Loss: 13.102868
Rec Loss: 10.819487
KL Loss: 2.283381
Y Loss: 0.964264
T Loss: 10.337355
Epoch 949 
Overall Loss: 13.099503
Rec Loss: 10.766284
KL Loss: 2.333219
Y Loss: 0.938700
T Loss: 10.296934
Epoch 999 
Overall Loss: 13.105708
Rec Loss: 10.797889
KL Loss: 2.307819
Y Loss: 0.962634
T Loss: 10.316572
Epoch 1049 
Overall Loss: 13.113216
Rec Loss: 10.800675
KL Loss: 2.312541
Y Loss: 0.938416
T Loss: 10.331467
Epoch 1099 
Overall Loss: 13.117287
Rec Loss: 10.795617
KL Loss: 2.321670
Y Loss: 0.946937
T Loss: 10.322148
Epoch 1149 
Overall Loss: 13.108234
Rec Loss: 10.810388
KL Loss: 2.297846
Y Loss: 0.969546
T Loss: 10.325615
Epoch 1199 
Overall Loss: 13.078614
Rec Loss: 10.769410
KL Loss: 2.309204
Y Loss: 0.928607
T Loss: 10.305106
Epoch 1249 
Overall Loss: 13.070413
Rec Loss: 10.764669
KL Loss: 2.305744
Y Loss: 0.948084
T Loss: 10.290627
Epoch 1299 
Overall Loss: 13.076546
Rec Loss: 10.765225
KL Loss: 2.311322
Y Loss: 0.965509
T Loss: 10.282470
Epoch 1349 
Overall Loss: 13.072603
Rec Loss: 10.769603
KL Loss: 2.303000
Y Loss: 0.965289
T Loss: 10.286959
Epoch 1399 
Overall Loss: 13.062654
Rec Loss: 10.762230
KL Loss: 2.300424
Y Loss: 0.942833
T Loss: 10.290813
Epoch 1449 
Overall Loss: 13.074738
Rec Loss: 10.745976
KL Loss: 2.328762
Y Loss: 0.935357
T Loss: 10.278297
Epoch 1499 
Overall Loss: 13.047547
Rec Loss: 10.753271
KL Loss: 2.294276
Y Loss: 0.963262
T Loss: 10.271640
Epoch 1549 
Overall Loss: 13.067173
Rec Loss: 10.759362
KL Loss: 2.307811
Y Loss: 0.949850
T Loss: 10.284436
Epoch 1599 
Overall Loss: 13.071567
Rec Loss: 10.767127
KL Loss: 2.304440
Y Loss: 0.949820
T Loss: 10.292217
Epoch 1649 
Overall Loss: 13.069658
Rec Loss: 10.766965
KL Loss: 2.302693
Y Loss: 0.958829
T Loss: 10.287551
Epoch 1699 
Overall Loss: 13.055710
Rec Loss: 10.728786
KL Loss: 2.326923
Y Loss: 0.936615
T Loss: 10.260479
Epoch 1749 
Overall Loss: 13.032060
Rec Loss: 10.738189
KL Loss: 2.293871
Y Loss: 0.945561
T Loss: 10.265409
Epoch 1799 
Overall Loss: 13.045205
Rec Loss: 10.733560
KL Loss: 2.311645
Y Loss: 0.945444
T Loss: 10.260838
Epoch 1849 
Overall Loss: 13.032519
Rec Loss: 10.703261
KL Loss: 2.329258
Y Loss: 0.941151
T Loss: 10.232685
Epoch 1899 
Overall Loss: 13.023070
Rec Loss: 10.700255
KL Loss: 2.322815
Y Loss: 0.926349
T Loss: 10.237080
Epoch 1949 
Overall Loss: 13.046413
Rec Loss: 10.742433
KL Loss: 2.303979
Y Loss: 0.965470
T Loss: 10.259698
Epoch 1999 
Overall Loss: 13.038246
Rec Loss: 10.712822
KL Loss: 2.325424
Y Loss: 0.954243
T Loss: 10.235700
Epoch 2049 
Overall Loss: 13.014762
Rec Loss: 10.738994
KL Loss: 2.275768
Y Loss: 0.953557
T Loss: 10.262216
Epoch 2099 
Overall Loss: 13.030419
Rec Loss: 10.729034
KL Loss: 2.301386
Y Loss: 0.955331
T Loss: 10.251368
Epoch 2149 
Overall Loss: 13.026637
Rec Loss: 10.724062
KL Loss: 2.302576
Y Loss: 0.944713
T Loss: 10.251705
Epoch 2199 
Overall Loss: 13.003747
Rec Loss: 10.702499
KL Loss: 2.301247
Y Loss: 0.942726
T Loss: 10.231137
Epoch 2249 
Overall Loss: 13.011536
Rec Loss: 10.718823
KL Loss: 2.292712
Y Loss: 0.975272
T Loss: 10.231188
Epoch 2299 
Overall Loss: 12.998749
Rec Loss: 10.679041
KL Loss: 2.319707
Y Loss: 0.963267
T Loss: 10.197408
Epoch 2349 
Overall Loss: 13.019069
Rec Loss: 10.689540
KL Loss: 2.329529
Y Loss: 0.938455
T Loss: 10.220312
Epoch 2399 
Overall Loss: 13.009623
Rec Loss: 10.694267
KL Loss: 2.315355
Y Loss: 0.927280
T Loss: 10.230627
Epoch 2449 
Overall Loss: 13.001967
Rec Loss: 10.676033
KL Loss: 2.325934
Y Loss: 0.903443
T Loss: 10.224311
Epoch 2499 
Overall Loss: 13.012479
Rec Loss: 10.676911
KL Loss: 2.335567
Y Loss: 0.922125
T Loss: 10.215849
Epoch 2549 
Overall Loss: 13.014176
Rec Loss: 10.688638
KL Loss: 2.325538
Y Loss: 0.946323
T Loss: 10.215476
Epoch 2599 
Overall Loss: 12.978288
Rec Loss: 10.678431
KL Loss: 2.299857
Y Loss: 0.921026
T Loss: 10.217918
Epoch 2649 
Overall Loss: 12.996191
Rec Loss: 10.657446
KL Loss: 2.338745
Y Loss: 0.927518
T Loss: 10.193687
Epoch 2699 
Overall Loss: 12.974382
Rec Loss: 10.692667
KL Loss: 2.281715
Y Loss: 0.937192
T Loss: 10.224071
Epoch 2749 
Overall Loss: 13.013610
Rec Loss: 10.673826
KL Loss: 2.339784
Y Loss: 0.922890
T Loss: 10.212381
Epoch 2799 
Overall Loss: 12.956628
Rec Loss: 10.656303
KL Loss: 2.300325
Y Loss: 0.945568
T Loss: 10.183519
Epoch 2849 
Overall Loss: 12.998307
Rec Loss: 10.665203
KL Loss: 2.333104
Y Loss: 0.928879
T Loss: 10.200763
Epoch 2899 
Overall Loss: 12.955481
Rec Loss: 10.618267
KL Loss: 2.337214
Y Loss: 0.922235
T Loss: 10.157149
Epoch 2949 
Overall Loss: 12.980895
Rec Loss: 10.654907
KL Loss: 2.325988
Y Loss: 0.918087
T Loss: 10.195863
Epoch 2999 
Overall Loss: 12.954682
Rec Loss: 10.658122
KL Loss: 2.296560
Y Loss: 0.949514
T Loss: 10.183365
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.942189
Epoch 99
Rec Loss: 1.927753
Epoch 149
Rec Loss: 1.923939
Epoch 199
Rec Loss: 1.923424
Epoch 249
Rec Loss: 1.923072
Epoch 299
Rec Loss: 1.918030
Epoch 349
Rec Loss: 1.925122
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.955207
Epoch 99
Rec Loss: 9.947340
Epoch 149
Rec Loss: 9.936444
Epoch 199
Rec Loss: 9.926075
Epoch 249
Rec Loss: 9.920686
Epoch 299
Rec Loss: 9.931202
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.740030
Insample Error: 1.557932
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 18.268552
Rec Loss: 15.877796
KL Loss: 2.390756
Y Loss: 3.067564
T Loss: 13.325331
X Loss: 1.018683
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.631431
Epoch 99
Rec Loss: 3.623167
Epoch 149
Rec Loss: 3.632772
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 3.020713
Epoch 99
Rec Loss: 3.052916
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 1.267409
Insample Error 1.853160
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.995175
Epoch 99 
Prediction Loss: 1.885611
Epoch 149 
Prediction Loss: 1.826238
Epoch 199 
Prediction Loss: 1.814607
Epoch 249 
Prediction Loss: 1.738895
Epoch 299 
Prediction Loss: 1.738809
Epoch 349 
Prediction Loss: 1.611289
Epoch 399 
Prediction Loss: 1.565814
Epoch 449 
Prediction Loss: 1.506287
Epoch 499 
Prediction Loss: 1.458679
Epoch 549 
Prediction Loss: 1.388255
Epoch 599 
Prediction Loss: 1.354369
Epoch 649 
Prediction Loss: 1.273765
Epoch 699 
Prediction Loss: 1.220141
Epoch 749 
Prediction Loss: 1.159008
Epoch 799 
Prediction Loss: 1.135865
Epoch 849 
Prediction Loss: 1.089088
Epoch 899 
Prediction Loss: 1.037869
Epoch 949 
Prediction Loss: 1.013983
Epoch 999 
Prediction Loss: 0.993163
Epoch 1049 
Prediction Loss: 0.981891
Epoch 1099 
Prediction Loss: 0.951902
Epoch 1149 
Prediction Loss: 0.922194
Epoch 1199 
Prediction Loss: 0.895884
Epoch 1249 
Prediction Loss: 0.886034
Epoch 1299 
Prediction Loss: 0.880509
Epoch 1349 
Prediction Loss: 0.865829
Epoch 1399 
Prediction Loss: 0.824907
Epoch 1449 
Prediction Loss: 0.832529
Epoch 1499 
Prediction Loss: 0.823614
Epoch 1549 
Prediction Loss: 0.789646
Epoch 1599 
Prediction Loss: 0.775717
Epoch 1649 
Prediction Loss: 0.776016
Epoch 1699 
Prediction Loss: 0.798550
Epoch 1749 
Prediction Loss: 0.760767
Epoch 1799 
Prediction Loss: 0.759579
Epoch 1849 
Prediction Loss: 0.743383
Epoch 1899 
Prediction Loss: 0.751212
Epoch 1949 
Prediction Loss: 0.718097
Epoch 1999 
Prediction Loss: 0.744182
Epoch 2049 
Prediction Loss: 0.702370
Epoch 2099 
Prediction Loss: 0.700939
Epoch 2149 
Prediction Loss: 0.715216
Epoch 2199 
Prediction Loss: 0.691063
Epoch 2249 
Prediction Loss: 0.678025
Epoch 2299 
Prediction Loss: 0.684593
Epoch 2349 
Prediction Loss: 0.694777
Epoch 2399 
Prediction Loss: 0.679833
Epoch 2449 
Prediction Loss: 0.674554
Epoch 2499 
Prediction Loss: 0.689649
Epoch 2549 
Prediction Loss: 0.680882
Epoch 2599 
Prediction Loss: 0.650360
Epoch 2649 
Prediction Loss: 0.676018
Epoch 2699 
Prediction Loss: 0.659310
Epoch 2749 
Prediction Loss: 0.653178
Epoch 2799 
Prediction Loss: 0.665806
Epoch 2849 
Prediction Loss: 0.650563
Epoch 2899 
Prediction Loss: 0.640719
Epoch 2949 
Prediction Loss: 0.650366
Epoch 2999 
Prediction Loss: 0.643506
Epoch 3049 
Prediction Loss: 0.660329
Epoch 3099 
Prediction Loss: 0.631233
Epoch 3149 
Prediction Loss: 0.637381
Epoch 3199 
Prediction Loss: 0.640122
Epoch 3249 
Prediction Loss: 0.620524
Epoch 3299 
Prediction Loss: 0.642052
Epoch 3349 
Prediction Loss: 0.635177
Epoch 3399 
Prediction Loss: 0.622243
Epoch 3449 
Prediction Loss: 0.621452
Epoch 3499 
Prediction Loss: 0.614677
Epoch 3549 
Prediction Loss: 0.636549
Epoch 3599 
Prediction Loss: 0.613679
Epoch 3649 
Prediction Loss: 0.604160
Epoch 3699 
Prediction Loss: 0.616140
Epoch 3749 
Prediction Loss: 0.609333
Epoch 3799 
Prediction Loss: 0.612513
Epoch 3849 
Prediction Loss: 0.615847
Epoch 3899 
Prediction Loss: 0.598701
Epoch 3949 
Prediction Loss: 0.621128
Epoch 3999 
Prediction Loss: 0.595630
Epoch 4049 
Prediction Loss: 0.600112
Epoch 4099 
Prediction Loss: 0.607267
Epoch 4149 
Prediction Loss: 0.603237
Epoch 4199 
Prediction Loss: 0.591940
Epoch 4249 
Prediction Loss: 0.584683
Epoch 4299 
Prediction Loss: 0.607017
Epoch 4349 
Prediction Loss: 0.602820
Epoch 4399 
Prediction Loss: 0.583636
Epoch 4449 
Prediction Loss: 0.620681
Epoch 4499 
Prediction Loss: 0.615400
Epoch 4549 
Prediction Loss: 0.576922
Epoch 4599 
Prediction Loss: 0.583659
Epoch 4649 
Prediction Loss: 0.589523
Epoch 4699 
Prediction Loss: 0.583237
Epoch 4749 
Prediction Loss: 0.590546
Epoch 4799 
Prediction Loss: 0.574905
Epoch 4849 
Prediction Loss: 0.573973
Epoch 4899 
Prediction Loss: 0.565082
Epoch 4949 
Prediction Loss: 0.577165
Epoch 4999 
Prediction Loss: 0.577444
Epoch 5049 
Prediction Loss: 0.589282
Epoch 5099 
Prediction Loss: 0.562321
Epoch 5149 
Prediction Loss: 0.588915
Epoch 5199 
Prediction Loss: 0.575565
Epoch 5249 
Prediction Loss: 0.577115
Epoch 5299 
Prediction Loss: 0.562764
Epoch 5349 
Prediction Loss: 0.568084
Epoch 5399 
Prediction Loss: 0.573497
Epoch 5449 
Prediction Loss: 0.580394
Epoch 5499 
Prediction Loss: 0.561136
Epoch 5549 
Prediction Loss: 0.580166
Epoch 5599 
Prediction Loss: 0.570586
Epoch 5649 
Prediction Loss: 0.559618
Epoch 5699 
Prediction Loss: 0.574179
Epoch 5749 
Prediction Loss: 0.551426
Epoch 5799 
Prediction Loss: 0.553234
Epoch 5849 
Prediction Loss: 0.559383
Epoch 5899 
Prediction Loss: 0.565992
Epoch 5949 
Prediction Loss: 0.561156
Epoch 5999 
Prediction Loss: 0.585280
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.747462
Insample Error 3.085130
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.380706
Rec Loss: 11.334099
KL Loss: 2.046607
Y Loss: 0.976827
T Loss: 10.845685
Epoch 99 
Overall Loss: 13.297938
Rec Loss: 10.982005
KL Loss: 2.315933
Y Loss: 1.002355
T Loss: 10.480828
Epoch 149 
Overall Loss: 13.269263
Rec Loss: 10.960962
KL Loss: 2.308301
Y Loss: 1.000165
T Loss: 10.460879
Epoch 199 
Overall Loss: 13.210060
Rec Loss: 10.928486
KL Loss: 2.281575
Y Loss: 0.976610
T Loss: 10.440181
Epoch 249 
Overall Loss: 13.196370
Rec Loss: 10.898197
KL Loss: 2.298173
Y Loss: 0.980807
T Loss: 10.407794
Epoch 299 
Overall Loss: 13.194398
Rec Loss: 10.909365
KL Loss: 2.285032
Y Loss: 0.976649
T Loss: 10.421041
Epoch 349 
Overall Loss: 13.182226
Rec Loss: 10.887310
KL Loss: 2.294917
Y Loss: 0.972765
T Loss: 10.400927
Epoch 399 
Overall Loss: 13.164764
Rec Loss: 10.872922
KL Loss: 2.291842
Y Loss: 0.980753
T Loss: 10.382545
Epoch 449 
Overall Loss: 13.157790
Rec Loss: 10.873263
KL Loss: 2.284527
Y Loss: 0.993437
T Loss: 10.376545
Epoch 499 
Overall Loss: 13.175387
Rec Loss: 10.859654
KL Loss: 2.315733
Y Loss: 0.957471
T Loss: 10.380918
Epoch 549 
Overall Loss: 13.121937
Rec Loss: 10.838568
KL Loss: 2.283370
Y Loss: 0.967237
T Loss: 10.354949
Epoch 599 
Overall Loss: 13.139176
Rec Loss: 10.839018
KL Loss: 2.300158
Y Loss: 0.965359
T Loss: 10.356339
Epoch 649 
Overall Loss: 13.131853
Rec Loss: 10.853195
KL Loss: 2.278659
Y Loss: 0.971908
T Loss: 10.367240
Epoch 699 
Overall Loss: 13.093531
Rec Loss: 10.833644
KL Loss: 2.259887
Y Loss: 0.971094
T Loss: 10.348098
Epoch 749 
Overall Loss: 13.132826
Rec Loss: 10.828804
KL Loss: 2.304022
Y Loss: 0.948348
T Loss: 10.354630
Epoch 799 
Overall Loss: 13.128572
Rec Loss: 10.842735
KL Loss: 2.285838
Y Loss: 0.982637
T Loss: 10.351416
Epoch 849 
Overall Loss: 13.093874
Rec Loss: 10.827963
KL Loss: 2.265910
Y Loss: 0.958166
T Loss: 10.348880
Epoch 899 
Overall Loss: 13.119659
Rec Loss: 10.834388
KL Loss: 2.285270
Y Loss: 0.982161
T Loss: 10.343308
Epoch 949 
Overall Loss: 13.103029
Rec Loss: 10.806684
KL Loss: 2.296345
Y Loss: 0.958452
T Loss: 10.327458
Epoch 999 
Overall Loss: 13.139902
Rec Loss: 10.835059
KL Loss: 2.304844
Y Loss: 0.965363
T Loss: 10.352377
Epoch 1049 
Overall Loss: 13.078409
Rec Loss: 10.806921
KL Loss: 2.271488
Y Loss: 0.952323
T Loss: 10.330759
Epoch 1099 
Overall Loss: 13.109228
Rec Loss: 10.787723
KL Loss: 2.321506
Y Loss: 0.941333
T Loss: 10.317056
Epoch 1149 
Overall Loss: 13.101216
Rec Loss: 10.778413
KL Loss: 2.322802
Y Loss: 0.945751
T Loss: 10.305538
Epoch 1199 
Overall Loss: 13.100737
Rec Loss: 10.783690
KL Loss: 2.317047
Y Loss: 0.943869
T Loss: 10.311755
Epoch 1249 
Overall Loss: 13.068232
Rec Loss: 10.775210
KL Loss: 2.293022
Y Loss: 0.957204
T Loss: 10.296608
Epoch 1299 
Overall Loss: 13.069334
Rec Loss: 10.771416
KL Loss: 2.297918
Y Loss: 0.958805
T Loss: 10.292013
Epoch 1349 
Overall Loss: 13.075263
Rec Loss: 10.784150
KL Loss: 2.291113
Y Loss: 0.949907
T Loss: 10.309197
Epoch 1399 
Overall Loss: 13.080303
Rec Loss: 10.754287
KL Loss: 2.326016
Y Loss: 0.957502
T Loss: 10.275536
Epoch 1449 
Overall Loss: 13.055653
Rec Loss: 10.752883
KL Loss: 2.302770
Y Loss: 0.939268
T Loss: 10.283250
Epoch 1499 
Overall Loss: 13.041626
Rec Loss: 10.754397
KL Loss: 2.287229
Y Loss: 0.957365
T Loss: 10.275714
Epoch 1549 
Overall Loss: 13.052140
Rec Loss: 10.729138
KL Loss: 2.323002
Y Loss: 0.926967
T Loss: 10.265654
Epoch 1599 
Overall Loss: 13.055690
Rec Loss: 10.736723
KL Loss: 2.318966
Y Loss: 0.932301
T Loss: 10.270573
Epoch 1649 
Overall Loss: 13.062388
Rec Loss: 10.749148
KL Loss: 2.313241
Y Loss: 0.949896
T Loss: 10.274199
Epoch 1699 
Overall Loss: 13.039219
Rec Loss: 10.723841
KL Loss: 2.315378
Y Loss: 0.918301
T Loss: 10.264690
Epoch 1749 
Overall Loss: 13.059104
Rec Loss: 10.734429
KL Loss: 2.324676
Y Loss: 0.947826
T Loss: 10.260516
Epoch 1799 
Overall Loss: 13.045191
Rec Loss: 10.728686
KL Loss: 2.316505
Y Loss: 0.921828
T Loss: 10.267772
Epoch 1849 
Overall Loss: 13.027101
Rec Loss: 10.722234
KL Loss: 2.304866
Y Loss: 0.952528
T Loss: 10.245971
Epoch 1899 
Overall Loss: 13.051286
Rec Loss: 10.743201
KL Loss: 2.308085
Y Loss: 0.945251
T Loss: 10.270575
Epoch 1949 
Overall Loss: 13.039598
Rec Loss: 10.715443
KL Loss: 2.324155
Y Loss: 0.930824
T Loss: 10.250032
Epoch 1999 
Overall Loss: 13.014144
Rec Loss: 10.729108
KL Loss: 2.285036
Y Loss: 0.948995
T Loss: 10.254610
Epoch 2049 
Overall Loss: 13.019314
Rec Loss: 10.727084
KL Loss: 2.292229
Y Loss: 0.954699
T Loss: 10.249735
Epoch 2099 
Overall Loss: 13.006901
Rec Loss: 10.692399
KL Loss: 2.314502
Y Loss: 0.935325
T Loss: 10.224736
Epoch 2149 
Overall Loss: 13.022979
Rec Loss: 10.705593
KL Loss: 2.317386
Y Loss: 0.931584
T Loss: 10.239801
Epoch 2199 
Overall Loss: 13.004566
Rec Loss: 10.706335
KL Loss: 2.298231
Y Loss: 0.914044
T Loss: 10.249314
Epoch 2249 
Overall Loss: 12.980588
Rec Loss: 10.686286
KL Loss: 2.294302
Y Loss: 0.928306
T Loss: 10.222133
Epoch 2299 
Overall Loss: 13.021303
Rec Loss: 10.703880
KL Loss: 2.317422
Y Loss: 0.900990
T Loss: 10.253386
Epoch 2349 
Overall Loss: 12.999334
Rec Loss: 10.701527
KL Loss: 2.297807
Y Loss: 0.942427
T Loss: 10.230314
Epoch 2399 
Overall Loss: 12.980878
Rec Loss: 10.686477
KL Loss: 2.294401
Y Loss: 0.956790
T Loss: 10.208082
Epoch 2449 
Overall Loss: 12.969793
Rec Loss: 10.669772
KL Loss: 2.300021
Y Loss: 0.931987
T Loss: 10.203778
Epoch 2499 
Overall Loss: 13.007556
Rec Loss: 10.675964
KL Loss: 2.331592
Y Loss: 0.920523
T Loss: 10.215702
Epoch 2549 
Overall Loss: 12.971933
Rec Loss: 10.656231
KL Loss: 2.315702
Y Loss: 0.901143
T Loss: 10.205660
Epoch 2599 
Overall Loss: 12.988887
Rec Loss: 10.665391
KL Loss: 2.323496
Y Loss: 0.929569
T Loss: 10.200606
Epoch 2649 
Overall Loss: 12.963971
Rec Loss: 10.666044
KL Loss: 2.297927
Y Loss: 0.918942
T Loss: 10.206573
Epoch 2699 
Overall Loss: 12.946536
Rec Loss: 10.649288
KL Loss: 2.297248
Y Loss: 0.933178
T Loss: 10.182698
Epoch 2749 
Overall Loss: 12.978759
Rec Loss: 10.689357
KL Loss: 2.289402
Y Loss: 0.913346
T Loss: 10.232684
Epoch 2799 
Overall Loss: 12.968128
Rec Loss: 10.650437
KL Loss: 2.317691
Y Loss: 0.903434
T Loss: 10.198720
Epoch 2849 
Overall Loss: 12.992860
Rec Loss: 10.675246
KL Loss: 2.317615
Y Loss: 0.927560
T Loss: 10.211465
Epoch 2899 
Overall Loss: 12.974774
Rec Loss: 10.628891
KL Loss: 2.345883
Y Loss: 0.913227
T Loss: 10.172277
Epoch 2949 
Overall Loss: 12.989784
Rec Loss: 10.665252
KL Loss: 2.324532
Y Loss: 0.931079
T Loss: 10.199713
Epoch 2999 
Overall Loss: 12.948024
Rec Loss: 10.657001
KL Loss: 2.291023
Y Loss: 0.922683
T Loss: 10.195659
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.943602
Epoch 99
Rec Loss: 1.948550
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.948824
Epoch 99
Rec Loss: 9.945821
Epoch 149
Rec Loss: 9.939933
Epoch 199
Rec Loss: 9.940168
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.734108
Insample Error: 1.598664
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 18.067852
Rec Loss: 15.740704
KL Loss: 2.327148
Y Loss: 3.255733
T Loss: 13.305529
X Loss: 0.807309
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.681065
Epoch 99
Rec Loss: 3.653056
Epoch 149
Rec Loss: 3.678981
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.808514
Epoch 99
Rec Loss: 2.796421
Epoch 149
Rec Loss: 2.800590
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 1.341999
Insample Error 1.948275
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.029605
Epoch 99 
Prediction Loss: 1.877869
Epoch 149 
Prediction Loss: 1.777024
Epoch 199 
Prediction Loss: 1.723247
Epoch 249 
Prediction Loss: 1.629742
Epoch 299 
Prediction Loss: 1.555693
Epoch 349 
Prediction Loss: 1.494410
Epoch 399 
Prediction Loss: 1.390502
Epoch 449 
Prediction Loss: 1.306470
Epoch 499 
Prediction Loss: 1.241382
Epoch 549 
Prediction Loss: 1.216554
Epoch 599 
Prediction Loss: 1.095609
Epoch 649 
Prediction Loss: 1.080320
Epoch 699 
Prediction Loss: 1.020620
Epoch 749 
Prediction Loss: 0.999911
Epoch 799 
Prediction Loss: 0.965480
Epoch 849 
Prediction Loss: 0.941121
Epoch 899 
Prediction Loss: 0.904428
Epoch 949 
Prediction Loss: 0.870806
Epoch 999 
Prediction Loss: 0.861110
Epoch 1049 
Prediction Loss: 0.842881
Epoch 1099 
Prediction Loss: 0.856911
Epoch 1149 
Prediction Loss: 0.816922
Epoch 1199 
Prediction Loss: 0.797944
Epoch 1249 
Prediction Loss: 0.772505
Epoch 1299 
Prediction Loss: 0.781969
Epoch 1349 
Prediction Loss: 0.786776
Epoch 1399 
Prediction Loss: 0.757626
Epoch 1449 
Prediction Loss: 0.767636
Epoch 1499 
Prediction Loss: 0.743568
Epoch 1549 
Prediction Loss: 0.738825
Epoch 1599 
Prediction Loss: 0.735782
Epoch 1649 
Prediction Loss: 0.707458
Epoch 1699 
Prediction Loss: 0.699120
Epoch 1749 
Prediction Loss: 0.697574
Epoch 1799 
Prediction Loss: 0.689391
Epoch 1849 
Prediction Loss: 0.674129
Epoch 1899 
Prediction Loss: 0.679648
Epoch 1949 
Prediction Loss: 0.683301
Epoch 1999 
Prediction Loss: 0.663211
Epoch 2049 
Prediction Loss: 0.651627
Epoch 2099 
Prediction Loss: 0.645479
Epoch 2149 
Prediction Loss: 0.669464
Epoch 2199 
Prediction Loss: 0.658252
Epoch 2249 
Prediction Loss: 0.644924
Epoch 2299 
Prediction Loss: 0.645256
Epoch 2349 
Prediction Loss: 0.629925
Epoch 2399 
Prediction Loss: 0.640287
Epoch 2449 
Prediction Loss: 0.622000
Epoch 2499 
Prediction Loss: 0.635078
Epoch 2549 
Prediction Loss: 0.608669
Epoch 2599 
Prediction Loss: 0.626624
Epoch 2649 
Prediction Loss: 0.625450
Epoch 2699 
Prediction Loss: 0.627080
Epoch 2749 
Prediction Loss: 0.604397
Epoch 2799 
Prediction Loss: 0.616170
Epoch 2849 
Prediction Loss: 0.606913
Epoch 2899 
Prediction Loss: 0.599159
Epoch 2949 
Prediction Loss: 0.620435
Epoch 2999 
Prediction Loss: 0.614636
Epoch 3049 
Prediction Loss: 0.588575
Epoch 3099 
Prediction Loss: 0.585020
Epoch 3149 
Prediction Loss: 0.593007
Epoch 3199 
Prediction Loss: 0.583349
Epoch 3249 
Prediction Loss: 0.622024
Epoch 3299 
Prediction Loss: 0.578746
Epoch 3349 
Prediction Loss: 0.571667
Epoch 3399 
Prediction Loss: 0.572843
Epoch 3449 
Prediction Loss: 0.568804
Epoch 3499 
Prediction Loss: 0.563063
Epoch 3549 
Prediction Loss: 0.568852
Epoch 3599 
Prediction Loss: 0.571894
Epoch 3649 
Prediction Loss: 0.567684
Epoch 3699 
Prediction Loss: 0.555994
Epoch 3749 
Prediction Loss: 0.564649
Epoch 3799 
Prediction Loss: 0.560068
Epoch 3849 
Prediction Loss: 0.559968
Epoch 3899 
Prediction Loss: 0.576771
Epoch 3949 
Prediction Loss: 0.568457
Epoch 3999 
Prediction Loss: 0.552761
Epoch 4049 
Prediction Loss: 0.545861
Epoch 4099 
Prediction Loss: 0.551144
Epoch 4149 
Prediction Loss: 0.541094
Epoch 4199 
Prediction Loss: 0.549521
Epoch 4249 
Prediction Loss: 0.571133
Epoch 4299 
Prediction Loss: 0.533454
Epoch 4349 
Prediction Loss: 0.554544
Epoch 4399 
Prediction Loss: 0.553130
Epoch 4449 
Prediction Loss: 0.569765
Epoch 4499 
Prediction Loss: 0.554192
Epoch 4549 
Prediction Loss: 0.543229
Epoch 4599 
Prediction Loss: 0.542411
Epoch 4649 
Prediction Loss: 0.541591
Epoch 4699 
Prediction Loss: 0.537065
Epoch 4749 
Prediction Loss: 0.531419
Epoch 4799 
Prediction Loss: 0.547695
Epoch 4849 
Prediction Loss: 0.538233
Epoch 4899 
Prediction Loss: 0.552678
Epoch 4949 
Prediction Loss: 0.531789
Epoch 4999 
Prediction Loss: 0.519209
Epoch 5049 
Prediction Loss: 0.532623
Epoch 5099 
Prediction Loss: 0.524914
Epoch 5149 
Prediction Loss: 0.512246
Epoch 5199 
Prediction Loss: 0.521877
Epoch 5249 
Prediction Loss: 0.526975
Epoch 5299 
Prediction Loss: 0.552262
Epoch 5349 
Prediction Loss: 0.533040
Epoch 5399 
Prediction Loss: 0.525368
Epoch 5449 
Prediction Loss: 0.527098
Epoch 5499 
Prediction Loss: 0.507212
Epoch 5549 
Prediction Loss: 0.510885
Epoch 5599 
Prediction Loss: 0.507692
Epoch 5649 
Prediction Loss: 0.515545
Epoch 5699 
Prediction Loss: 0.527341
Epoch 5749 
Prediction Loss: 0.519406
Epoch 5799 
Prediction Loss: 0.537121
Epoch 5849 
Prediction Loss: 0.509235
Epoch 5899 
Prediction Loss: 0.527164
Epoch 5949 
Prediction Loss: 0.513956
Epoch 5999 
Prediction Loss: 0.510304
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.723323
Insample Error 3.153528
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.380035
Rec Loss: 11.360628
KL Loss: 2.019407
Y Loss: 1.021379
T Loss: 10.849939
Epoch 99 
Overall Loss: 13.259882
Rec Loss: 10.937892
KL Loss: 2.321990
Y Loss: 0.977087
T Loss: 10.449348
Epoch 149 
Overall Loss: 13.241301
Rec Loss: 10.926730
KL Loss: 2.314571
Y Loss: 0.975825
T Loss: 10.438817
Epoch 199 
Overall Loss: 13.201108
Rec Loss: 10.921606
KL Loss: 2.279502
Y Loss: 0.997282
T Loss: 10.422965
Epoch 249 
Overall Loss: 13.188067
Rec Loss: 10.888766
KL Loss: 2.299301
Y Loss: 0.963649
T Loss: 10.406941
Epoch 299 
Overall Loss: 13.208914
Rec Loss: 10.887489
KL Loss: 2.321426
Y Loss: 0.995061
T Loss: 10.389958
Epoch 349 
Overall Loss: 13.152878
Rec Loss: 10.896845
KL Loss: 2.256033
Y Loss: 0.985754
T Loss: 10.403968
Epoch 399 
Overall Loss: 13.179888
Rec Loss: 10.883842
KL Loss: 2.296047
Y Loss: 0.970092
T Loss: 10.398795
Epoch 449 
Overall Loss: 13.186621
Rec Loss: 10.880996
KL Loss: 2.305625
Y Loss: 0.969298
T Loss: 10.396347
Epoch 499 
Overall Loss: 13.168095
Rec Loss: 10.861224
KL Loss: 2.306871
Y Loss: 0.959636
T Loss: 10.381406
Epoch 549 
Overall Loss: 13.153450
Rec Loss: 10.854839
KL Loss: 2.298612
Y Loss: 0.951808
T Loss: 10.378935
Epoch 599 
Overall Loss: 13.129212
Rec Loss: 10.850938
KL Loss: 2.278274
Y Loss: 0.966851
T Loss: 10.367513
Epoch 649 
Overall Loss: 13.127912
Rec Loss: 10.804799
KL Loss: 2.323113
Y Loss: 0.956252
T Loss: 10.326673
Epoch 699 
Overall Loss: 13.140955
Rec Loss: 10.837511
KL Loss: 2.303444
Y Loss: 0.975663
T Loss: 10.349680
Epoch 749 
Overall Loss: 13.115975
Rec Loss: 10.818198
KL Loss: 2.297777
Y Loss: 0.962023
T Loss: 10.337186
Epoch 799 
Overall Loss: 13.121705
Rec Loss: 10.811421
KL Loss: 2.310284
Y Loss: 0.956361
T Loss: 10.333241
Epoch 849 
Overall Loss: 13.102108
Rec Loss: 10.792807
KL Loss: 2.309301
Y Loss: 0.951037
T Loss: 10.317289
Epoch 899 
Overall Loss: 13.107108
Rec Loss: 10.819390
KL Loss: 2.287718
Y Loss: 0.947886
T Loss: 10.345448
Epoch 949 
Overall Loss: 13.087030
Rec Loss: 10.782572
KL Loss: 2.304457
Y Loss: 0.941455
T Loss: 10.311845
Epoch 999 
Overall Loss: 13.101905
Rec Loss: 10.783272
KL Loss: 2.318633
Y Loss: 0.934136
T Loss: 10.316204
Epoch 1049 
Overall Loss: 13.098809
Rec Loss: 10.802194
KL Loss: 2.296615
Y Loss: 0.960544
T Loss: 10.321922
Epoch 1099 
Overall Loss: 13.070402
Rec Loss: 10.767412
KL Loss: 2.302989
Y Loss: 0.926901
T Loss: 10.303962
Epoch 1149 
Overall Loss: 13.073344
Rec Loss: 10.766000
KL Loss: 2.307343
Y Loss: 0.940733
T Loss: 10.295634
Epoch 1199 
Overall Loss: 13.062543
Rec Loss: 10.752359
KL Loss: 2.310183
Y Loss: 0.928152
T Loss: 10.288283
Epoch 1249 
Overall Loss: 13.086913
Rec Loss: 10.793099
KL Loss: 2.293815
Y Loss: 0.935307
T Loss: 10.325445
Epoch 1299 
Overall Loss: 13.097262
Rec Loss: 10.811049
KL Loss: 2.286213
Y Loss: 0.986434
T Loss: 10.317831
Epoch 1349 
Overall Loss: 13.055491
Rec Loss: 10.732289
KL Loss: 2.323202
Y Loss: 0.917316
T Loss: 10.273630
Epoch 1399 
Overall Loss: 13.056590
Rec Loss: 10.747906
KL Loss: 2.308684
Y Loss: 0.939907
T Loss: 10.277952
Epoch 1449 
Overall Loss: 13.075430
Rec Loss: 10.754895
KL Loss: 2.320535
Y Loss: 0.940850
T Loss: 10.284470
Epoch 1499 
Overall Loss: 13.076842
Rec Loss: 10.751058
KL Loss: 2.325784
Y Loss: 0.941713
T Loss: 10.280201
Epoch 1549 
Overall Loss: 13.063253
Rec Loss: 10.774186
KL Loss: 2.289067
Y Loss: 0.944830
T Loss: 10.301771
Epoch 1599 
Overall Loss: 13.030350
Rec Loss: 10.750039
KL Loss: 2.280310
Y Loss: 0.944272
T Loss: 10.277903
Epoch 1649 
Overall Loss: 13.070707
Rec Loss: 10.752307
KL Loss: 2.318400
Y Loss: 0.950479
T Loss: 10.277068
Epoch 1699 
Overall Loss: 13.048396
Rec Loss: 10.726551
KL Loss: 2.321845
Y Loss: 0.929644
T Loss: 10.261729
Epoch 1749 
Overall Loss: 13.054697
Rec Loss: 10.736964
KL Loss: 2.317733
Y Loss: 0.921685
T Loss: 10.276121
Epoch 1799 
Overall Loss: 13.051653
Rec Loss: 10.745889
KL Loss: 2.305764
Y Loss: 0.938339
T Loss: 10.276720
Epoch 1849 
Overall Loss: 13.011197
Rec Loss: 10.717733
KL Loss: 2.293464
Y Loss: 0.927631
T Loss: 10.253917
Epoch 1899 
Overall Loss: 13.039854
Rec Loss: 10.719124
KL Loss: 2.320730
Y Loss: 0.940308
T Loss: 10.248970
Epoch 1949 
Overall Loss: 13.035619
Rec Loss: 10.728997
KL Loss: 2.306621
Y Loss: 0.934292
T Loss: 10.261851
Epoch 1999 
Overall Loss: 13.005401
Rec Loss: 10.684876
KL Loss: 2.320525
Y Loss: 0.922599
T Loss: 10.223576
Epoch 2049 
Overall Loss: 12.997968
Rec Loss: 10.653627
KL Loss: 2.344341
Y Loss: 0.900302
T Loss: 10.203476
Epoch 2099 
Overall Loss: 13.024756
Rec Loss: 10.723870
KL Loss: 2.300886
Y Loss: 0.931699
T Loss: 10.258020
Epoch 2149 
Overall Loss: 13.005489
Rec Loss: 10.722364
KL Loss: 2.283125
Y Loss: 0.937175
T Loss: 10.253777
Epoch 2199 
Overall Loss: 13.013727
Rec Loss: 10.721786
KL Loss: 2.291942
Y Loss: 0.934020
T Loss: 10.254776
Epoch 2249 
Overall Loss: 12.987217
Rec Loss: 10.710752
KL Loss: 2.276465
Y Loss: 0.925754
T Loss: 10.247875
Epoch 2299 
Overall Loss: 12.995527
Rec Loss: 10.695486
KL Loss: 2.300040
Y Loss: 0.937809
T Loss: 10.226581
Epoch 2349 
Overall Loss: 12.997235
Rec Loss: 10.682562
KL Loss: 2.314673
Y Loss: 0.912938
T Loss: 10.226093
Epoch 2399 
Overall Loss: 12.980385
Rec Loss: 10.659551
KL Loss: 2.320835
Y Loss: 0.912499
T Loss: 10.203301
Epoch 2449 
Overall Loss: 12.978215
Rec Loss: 10.693690
KL Loss: 2.284526
Y Loss: 0.916067
T Loss: 10.235656
Epoch 2499 
Overall Loss: 13.012683
Rec Loss: 10.710393
KL Loss: 2.302290
Y Loss: 0.953535
T Loss: 10.233625
Epoch 2549 
Overall Loss: 12.985963
Rec Loss: 10.693356
KL Loss: 2.292606
Y Loss: 0.902227
T Loss: 10.242243
Epoch 2599 
Overall Loss: 12.970361
Rec Loss: 10.683927
KL Loss: 2.286434
Y Loss: 0.930772
T Loss: 10.218540
Epoch 2649 
Overall Loss: 13.003613
Rec Loss: 10.671734
KL Loss: 2.331880
Y Loss: 0.905212
T Loss: 10.219128
Epoch 2699 
Overall Loss: 12.998491
Rec Loss: 10.683340
KL Loss: 2.315151
Y Loss: 0.911092
T Loss: 10.227794
Epoch 2749 
Overall Loss: 13.005526
Rec Loss: 10.667146
KL Loss: 2.338379
Y Loss: 0.926283
T Loss: 10.204005
Epoch 2799 
Overall Loss: 12.989302
Rec Loss: 10.676207
KL Loss: 2.313095
Y Loss: 0.918255
T Loss: 10.217079
Epoch 2849 
Overall Loss: 12.987723
Rec Loss: 10.663073
KL Loss: 2.324650
Y Loss: 0.905099
T Loss: 10.210524
Epoch 2899 
Overall Loss: 12.979854
Rec Loss: 10.660620
KL Loss: 2.319233
Y Loss: 0.904031
T Loss: 10.208605
Epoch 2949 
Overall Loss: 12.964212
Rec Loss: 10.670384
KL Loss: 2.293828
Y Loss: 0.924833
T Loss: 10.207967
Epoch 2999 
Overall Loss: 12.965057
Rec Loss: 10.670414
KL Loss: 2.294642
Y Loss: 0.907844
T Loss: 10.216492
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.897372
Epoch 99
Rec Loss: 1.909158
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.939764
Epoch 99
Rec Loss: 9.942932
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.720228
Insample Error: 1.407132
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 18.391319
Rec Loss: 16.196336
KL Loss: 2.194983
Y Loss: 3.950803
T Loss: 13.470974
X Loss: 0.749961
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.807620
Epoch 99
Rec Loss: 3.790332
Epoch 149
Rec Loss: 3.802887
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.591425
Epoch 99
Rec Loss: 2.587845
Epoch 149
Rec Loss: 2.610902
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 1.505842
Insample Error 2.148152
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.985459
Epoch 99 
Prediction Loss: 1.911189
Epoch 149 
Prediction Loss: 1.824847
Epoch 199 
Prediction Loss: 1.769606
Epoch 249 
Prediction Loss: 1.756436
Epoch 299 
Prediction Loss: 1.713314
Epoch 349 
Prediction Loss: 1.628902
Epoch 399 
Prediction Loss: 1.609259
Epoch 449 
Prediction Loss: 1.520411
Epoch 499 
Prediction Loss: 1.459462
Epoch 549 
Prediction Loss: 1.409686
Epoch 599 
Prediction Loss: 1.362048
Epoch 649 
Prediction Loss: 1.334672
Epoch 699 
Prediction Loss: 1.239673
Epoch 749 
Prediction Loss: 1.202060
Epoch 799 
Prediction Loss: 1.153804
Epoch 849 
Prediction Loss: 1.102359
Epoch 899 
Prediction Loss: 1.055119
Epoch 949 
Prediction Loss: 1.048516
Epoch 999 
Prediction Loss: 1.013013
Epoch 1049 
Prediction Loss: 0.994233
Epoch 1099 
Prediction Loss: 0.970178
Epoch 1149 
Prediction Loss: 0.909962
Epoch 1199 
Prediction Loss: 0.915695
Epoch 1249 
Prediction Loss: 0.870968
Epoch 1299 
Prediction Loss: 0.885818
Epoch 1349 
Prediction Loss: 0.866308
Epoch 1399 
Prediction Loss: 0.833242
Epoch 1449 
Prediction Loss: 0.816378
Epoch 1499 
Prediction Loss: 0.845548
Epoch 1549 
Prediction Loss: 0.815848
Epoch 1599 
Prediction Loss: 0.782090
Epoch 1649 
Prediction Loss: 0.771056
Epoch 1699 
Prediction Loss: 0.769345
Epoch 1749 
Prediction Loss: 0.755912
Epoch 1799 
Prediction Loss: 0.751422
Epoch 1849 
Prediction Loss: 0.751580
Epoch 1899 
Prediction Loss: 0.768593
Epoch 1949 
Prediction Loss: 0.735743
Epoch 1999 
Prediction Loss: 0.725314
Epoch 2049 
Prediction Loss: 0.740168
Epoch 2099 
Prediction Loss: 0.741560
Epoch 2149 
Prediction Loss: 0.737636
Epoch 2199 
Prediction Loss: 0.724452
Epoch 2249 
Prediction Loss: 0.707929
Epoch 2299 
Prediction Loss: 0.702229
Epoch 2349 
Prediction Loss: 0.703116
Epoch 2399 
Prediction Loss: 0.682459
Epoch 2449 
Prediction Loss: 0.680266
Epoch 2499 
Prediction Loss: 0.668401
Epoch 2549 
Prediction Loss: 0.695122
Epoch 2599 
Prediction Loss: 0.673010
Epoch 2649 
Prediction Loss: 0.679118
Epoch 2699 
Prediction Loss: 0.652087
Epoch 2749 
Prediction Loss: 0.652736
Epoch 2799 
Prediction Loss: 0.656997
Epoch 2849 
Prediction Loss: 0.654136
Epoch 2899 
Prediction Loss: 0.667995
Epoch 2949 
Prediction Loss: 0.650990
Epoch 2999 
Prediction Loss: 0.642674
Epoch 3049 
Prediction Loss: 0.642775
Epoch 3099 
Prediction Loss: 0.637319
Epoch 3149 
Prediction Loss: 0.644615
Epoch 3199 
Prediction Loss: 0.616792
Epoch 3249 
Prediction Loss: 0.621526
Epoch 3299 
Prediction Loss: 0.607645
Epoch 3349 
Prediction Loss: 0.618302
Epoch 3399 
Prediction Loss: 0.624917
Epoch 3449 
Prediction Loss: 0.614513
Epoch 3499 
Prediction Loss: 0.621702
Epoch 3549 
Prediction Loss: 0.635036
Epoch 3599 
Prediction Loss: 0.623619
Epoch 3649 
Prediction Loss: 0.605978
Epoch 3699 
Prediction Loss: 0.608664
Epoch 3749 
Prediction Loss: 0.595724
Epoch 3799 
Prediction Loss: 0.628074
Epoch 3849 
Prediction Loss: 0.592964
Epoch 3899 
Prediction Loss: 0.604016
Epoch 3949 
Prediction Loss: 0.602569
Epoch 3999 
Prediction Loss: 0.601255
Epoch 4049 
Prediction Loss: 0.607497
Epoch 4099 
Prediction Loss: 0.601475
Epoch 4149 
Prediction Loss: 0.612866
Epoch 4199 
Prediction Loss: 0.592945
Epoch 4249 
Prediction Loss: 0.584863
Epoch 4299 
Prediction Loss: 0.595705
Epoch 4349 
Prediction Loss: 0.583000
Epoch 4399 
Prediction Loss: 0.580291
Epoch 4449 
Prediction Loss: 0.582865
Epoch 4499 
Prediction Loss: 0.600926
Epoch 4549 
Prediction Loss: 0.593477
Epoch 4599 
Prediction Loss: 0.576984
Epoch 4649 
Prediction Loss: 0.582131
Epoch 4699 
Prediction Loss: 0.584405
Epoch 4749 
Prediction Loss: 0.577308
Epoch 4799 
Prediction Loss: 0.575506
Epoch 4849 
Prediction Loss: 0.582369
Epoch 4899 
Prediction Loss: 0.569189
Epoch 4949 
Prediction Loss: 0.559985
Epoch 4999 
Prediction Loss: 0.571308
Epoch 5049 
Prediction Loss: 0.570906
Epoch 5099 
Prediction Loss: 0.565547
Epoch 5149 
Prediction Loss: 0.564639
Epoch 5199 
Prediction Loss: 0.577772
Epoch 5249 
Prediction Loss: 0.560981
Epoch 5299 
Prediction Loss: 0.549895
Epoch 5349 
Prediction Loss: 0.541282
Epoch 5399 
Prediction Loss: 0.538641
Epoch 5449 
Prediction Loss: 0.557387
Epoch 5499 
Prediction Loss: 0.594576
Epoch 5549 
Prediction Loss: 0.550824
Epoch 5599 
Prediction Loss: 0.562382
Epoch 5649 
Prediction Loss: 0.561636
Epoch 5699 
Prediction Loss: 0.565619
Epoch 5749 
Prediction Loss: 0.585927
Epoch 5799 
Prediction Loss: 0.552809
Epoch 5849 
Prediction Loss: 0.559169
Epoch 5899 
Prediction Loss: 0.533688
Epoch 5949 
Prediction Loss: 0.550533
Epoch 5999 
Prediction Loss: 0.541252
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.725508
Insample Error 3.109316
Ours, Train RMSE
0.7400, 
0.7341, 
0.7202, 
CEVAE, Train RMSE
1.2674, 
1.3420, 
1.5058, 
Ours, Insample RMSE
1.5579, 
1.5987, 
1.4071, 
CEVAE, Insample RMSE
1.8532, 
1.9483, 
2.1482, 
Direct Regression, Insample RMSE
3.0851, 
3.1535, 
3.1093, 
Train, RMSE mean 0.7315 std 0.0083
CEVAE, RMSE mean 1.3717 std 0.0996
Ours, RMSE mean 1.5212 std 0.0824, reconstruct confounder 1.9197 (0.0189) noise 9.9335 (0.0090)
CEVAE, RMSE mean 1.9832 std 0.1229, reconstruct confounder 3.6889 (0.0728) noise 2.8017 (0.1768)
Direct Regression, RMSE mean 3.1160 std 0.0283
Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=5, mask=0, nlayer=50, obsm=1, stop=5000, ycof=0.5, ylayer=50)
Y Mean 2.635484, Std 4.326354 
Test Y Mean 0.032706, Std 4.125860 
Observe confounder 1, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.488962
Rec Loss: 11.573156
KL Loss: 1.915806
Y Loss: 1.063219
T Loss: 11.041546
Epoch 99 
Overall Loss: 13.369654
Rec Loss: 11.339616
KL Loss: 2.030038
Y Loss: 0.979780
T Loss: 10.849726
Epoch 149 
Overall Loss: 13.305943
Rec Loss: 11.301852
KL Loss: 2.004091
Y Loss: 0.970580
T Loss: 10.816563
Epoch 199 
Overall Loss: 13.231628
Rec Loss: 11.049503
KL Loss: 2.182125
Y Loss: 0.971242
T Loss: 10.563883
Epoch 249 
Overall Loss: 13.218804
Rec Loss: 10.987848
KL Loss: 2.230955
Y Loss: 0.955885
T Loss: 10.509905
Epoch 299 
Overall Loss: 13.217158
Rec Loss: 10.985196
KL Loss: 2.231962
Y Loss: 0.991866
T Loss: 10.489263
Epoch 349 
Overall Loss: 13.174466
Rec Loss: 10.944580
KL Loss: 2.229885
Y Loss: 0.969504
T Loss: 10.459828
Epoch 399 
Overall Loss: 13.191707
Rec Loss: 10.936500
KL Loss: 2.255207
Y Loss: 0.934420
T Loss: 10.469290
Epoch 449 
Overall Loss: 13.191101
Rec Loss: 10.951991
KL Loss: 2.239109
Y Loss: 0.992583
T Loss: 10.455700
Epoch 499 
Overall Loss: 13.152074
Rec Loss: 10.943091
KL Loss: 2.208983
Y Loss: 0.970388
T Loss: 10.457897
Epoch 549 
Overall Loss: 13.147176
Rec Loss: 10.948450
KL Loss: 2.198727
Y Loss: 0.963523
T Loss: 10.466688
Epoch 599 
Overall Loss: 13.165850
Rec Loss: 10.964698
KL Loss: 2.201152
Y Loss: 0.973451
T Loss: 10.477973
Epoch 649 
Overall Loss: 13.170110
Rec Loss: 10.949191
KL Loss: 2.220920
Y Loss: 0.970613
T Loss: 10.463884
Epoch 699 
Overall Loss: 13.155172
Rec Loss: 10.922604
KL Loss: 2.232568
Y Loss: 0.954871
T Loss: 10.445169
Epoch 749 
Overall Loss: 13.135075
Rec Loss: 10.904701
KL Loss: 2.230375
Y Loss: 0.941105
T Loss: 10.434148
Epoch 799 
Overall Loss: 13.125961
Rec Loss: 10.911022
KL Loss: 2.214938
Y Loss: 0.959074
T Loss: 10.431485
Epoch 849 
Overall Loss: 13.116345
Rec Loss: 10.903194
KL Loss: 2.213151
Y Loss: 0.953680
T Loss: 10.426355
Epoch 899 
Overall Loss: 13.133245
Rec Loss: 10.921983
KL Loss: 2.211261
Y Loss: 0.973615
T Loss: 10.435176
Epoch 949 
Overall Loss: 13.142088
Rec Loss: 10.888559
KL Loss: 2.253529
Y Loss: 0.939556
T Loss: 10.418782
Epoch 999 
Overall Loss: 13.095207
Rec Loss: 10.870628
KL Loss: 2.224578
Y Loss: 0.959018
T Loss: 10.391119
Epoch 1049 
Overall Loss: 13.099341
Rec Loss: 10.888612
KL Loss: 2.210729
Y Loss: 0.949839
T Loss: 10.413693
Epoch 1099 
Overall Loss: 13.106003
Rec Loss: 10.912641
KL Loss: 2.193362
Y Loss: 0.972368
T Loss: 10.426457
Epoch 1149 
Overall Loss: 13.120924
Rec Loss: 10.898712
KL Loss: 2.222212
Y Loss: 0.953187
T Loss: 10.422119
Epoch 1199 
Overall Loss: 13.078901
Rec Loss: 10.848241
KL Loss: 2.230660
Y Loss: 0.934665
T Loss: 10.380908
Epoch 1249 
Overall Loss: 13.083617
Rec Loss: 10.847034
KL Loss: 2.236583
Y Loss: 0.935420
T Loss: 10.379324
Epoch 1299 
Overall Loss: 13.080830
Rec Loss: 10.885227
KL Loss: 2.195603
Y Loss: 0.953237
T Loss: 10.408609
Epoch 1349 
Overall Loss: 13.083014
Rec Loss: 10.874287
KL Loss: 2.208727
Y Loss: 0.958754
T Loss: 10.394910
Epoch 1399 
Overall Loss: 13.076967
Rec Loss: 10.883498
KL Loss: 2.193469
Y Loss: 0.951866
T Loss: 10.407565
Epoch 1449 
Overall Loss: 13.082909
Rec Loss: 10.884559
KL Loss: 2.198350
Y Loss: 0.947086
T Loss: 10.411016
Epoch 1499 
Overall Loss: 13.085347
Rec Loss: 10.880993
KL Loss: 2.204354
Y Loss: 0.952099
T Loss: 10.404944
Epoch 1549 
Overall Loss: 13.078079
Rec Loss: 10.876836
KL Loss: 2.201243
Y Loss: 0.948821
T Loss: 10.402425
Epoch 1599 
Overall Loss: 13.039125
Rec Loss: 10.841381
KL Loss: 2.197744
Y Loss: 0.937895
T Loss: 10.372434
Epoch 1649 
Overall Loss: 13.066622
Rec Loss: 10.862936
KL Loss: 2.203686
Y Loss: 0.953538
T Loss: 10.386166
Epoch 1699 
Overall Loss: 13.071354
Rec Loss: 10.857763
KL Loss: 2.213590
Y Loss: 0.970102
T Loss: 10.372712
Epoch 1749 
Overall Loss: 13.057721
Rec Loss: 10.862530
KL Loss: 2.195190
Y Loss: 0.968806
T Loss: 10.378127
Epoch 1799 
Overall Loss: 13.054129
Rec Loss: 10.831389
KL Loss: 2.222740
Y Loss: 0.925215
T Loss: 10.368782
Epoch 1849 
Overall Loss: 13.033295
Rec Loss: 10.826888
KL Loss: 2.206407
Y Loss: 0.943632
T Loss: 10.355072
Epoch 1899 
Overall Loss: 13.041164
Rec Loss: 10.832291
KL Loss: 2.208872
Y Loss: 0.915984
T Loss: 10.374300
Epoch 1949 
Overall Loss: 13.050837
Rec Loss: 10.824463
KL Loss: 2.226374
Y Loss: 0.943744
T Loss: 10.352591
Epoch 1999 
Overall Loss: 13.039760
Rec Loss: 10.834686
KL Loss: 2.205074
Y Loss: 0.948632
T Loss: 10.360370
Epoch 2049 
Overall Loss: 13.035536
Rec Loss: 10.861012
KL Loss: 2.174524
Y Loss: 0.941746
T Loss: 10.390139
Epoch 2099 
Overall Loss: 13.030477
Rec Loss: 10.818019
KL Loss: 2.212458
Y Loss: 0.930348
T Loss: 10.352845
Epoch 2149 
Overall Loss: 13.058895
Rec Loss: 10.828346
KL Loss: 2.230549
Y Loss: 0.973497
T Loss: 10.341598
Epoch 2199 
Overall Loss: 13.018056
Rec Loss: 10.814958
KL Loss: 2.203099
Y Loss: 0.944586
T Loss: 10.342665
Epoch 2249 
Overall Loss: 13.036399
Rec Loss: 10.834527
KL Loss: 2.201873
Y Loss: 0.940500
T Loss: 10.364277
Epoch 2299 
Overall Loss: 13.006576
Rec Loss: 10.802619
KL Loss: 2.203957
Y Loss: 0.949403
T Loss: 10.327918
Epoch 2349 
Overall Loss: 13.039821
Rec Loss: 10.826945
KL Loss: 2.212876
Y Loss: 0.942950
T Loss: 10.355470
Epoch 2399 
Overall Loss: 13.003286
Rec Loss: 10.801175
KL Loss: 2.202111
Y Loss: 0.946325
T Loss: 10.328013
Epoch 2449 
Overall Loss: 13.001602
Rec Loss: 10.794937
KL Loss: 2.206665
Y Loss: 0.929711
T Loss: 10.330081
Epoch 2499 
Overall Loss: 13.018340
Rec Loss: 10.794518
KL Loss: 2.223822
Y Loss: 0.927269
T Loss: 10.330884
Epoch 2549 
Overall Loss: 12.994217
Rec Loss: 10.803721
KL Loss: 2.190495
Y Loss: 0.954821
T Loss: 10.326311
Epoch 2599 
Overall Loss: 12.991662
Rec Loss: 10.789823
KL Loss: 2.201838
Y Loss: 0.922817
T Loss: 10.328415
Epoch 2649 
Overall Loss: 13.008087
Rec Loss: 10.789155
KL Loss: 2.218933
Y Loss: 0.900752
T Loss: 10.338778
Epoch 2699 
Overall Loss: 12.998002
Rec Loss: 10.797932
KL Loss: 2.200070
Y Loss: 0.928297
T Loss: 10.333784
Epoch 2749 
Overall Loss: 13.009377
Rec Loss: 10.797997
KL Loss: 2.211380
Y Loss: 0.927399
T Loss: 10.334297
Epoch 2799 
Overall Loss: 12.960076
Rec Loss: 10.781664
KL Loss: 2.178412
Y Loss: 0.926966
T Loss: 10.318181
Epoch 2849 
Overall Loss: 12.984029
Rec Loss: 10.765741
KL Loss: 2.218288
Y Loss: 0.902158
T Loss: 10.314662
Epoch 2899 
Overall Loss: 12.979546
Rec Loss: 10.760601
KL Loss: 2.218945
Y Loss: 0.896613
T Loss: 10.312295
Epoch 2949 
Overall Loss: 12.979359
Rec Loss: 10.800779
KL Loss: 2.178580
Y Loss: 0.936961
T Loss: 10.332299
Epoch 2999 
Overall Loss: 12.963644
Rec Loss: 10.790180
KL Loss: 2.173464
Y Loss: 0.919235
T Loss: 10.330563
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.056054
Epoch 99
Rec Loss: 2.048102
Epoch 149
Rec Loss: 2.038779
Epoch 199
Rec Loss: 2.051784
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.930024
Epoch 99
Rec Loss: 9.930809
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.619264
Insample Error: 1.944365
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.558486
Rec Loss: 18.424046
KL Loss: 3.134440
Y Loss: 8.811914
T Loss: 12.969240
X Loss: 1.048849
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.613717
Epoch 99
Rec Loss: 3.605199
Epoch 149
Rec Loss: 3.602731
Epoch 199
Rec Loss: 3.602483
Epoch 249
Rec Loss: 3.601533
Epoch 299
Rec Loss: 3.597620
Epoch 349
Rec Loss: 3.601339
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 3.272959
Epoch 99
Rec Loss: 3.246442
Epoch 149
Rec Loss: 3.253491
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.320783
Insample Error 3.574652
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.650663
Epoch 99 
Prediction Loss: 3.356529
Epoch 149 
Prediction Loss: 3.174959
Epoch 199 
Prediction Loss: 2.991827
Epoch 249 
Prediction Loss: 2.846117
Epoch 299 
Prediction Loss: 2.804402
Epoch 349 
Prediction Loss: 2.569370
Epoch 399 
Prediction Loss: 2.430071
Epoch 449 
Prediction Loss: 2.251984
Epoch 499 
Prediction Loss: 2.202554
Epoch 549 
Prediction Loss: 2.067997
Epoch 599 
Prediction Loss: 1.883762
Epoch 649 
Prediction Loss: 1.897368
Epoch 699 
Prediction Loss: 1.731543
Epoch 749 
Prediction Loss: 1.691133
Epoch 799 
Prediction Loss: 1.650336
Epoch 849 
Prediction Loss: 1.580374
Epoch 899 
Prediction Loss: 1.526467
Epoch 949 
Prediction Loss: 1.494431
Epoch 999 
Prediction Loss: 1.529332
Epoch 1049 
Prediction Loss: 1.430539
Epoch 1099 
Prediction Loss: 1.380557
Epoch 1149 
Prediction Loss: 1.366254
Epoch 1199 
Prediction Loss: 1.355529
Epoch 1249 
Prediction Loss: 1.326400
Epoch 1299 
Prediction Loss: 1.280455
Epoch 1349 
Prediction Loss: 1.260744
Epoch 1399 
Prediction Loss: 1.261160
Epoch 1449 
Prediction Loss: 1.265143
Epoch 1499 
Prediction Loss: 1.211612
Epoch 1549 
Prediction Loss: 1.208268
Epoch 1599 
Prediction Loss: 1.164001
Epoch 1649 
Prediction Loss: 1.185300
Epoch 1699 
Prediction Loss: 1.147163
Epoch 1749 
Prediction Loss: 1.135954
Epoch 1799 
Prediction Loss: 1.168104
Epoch 1849 
Prediction Loss: 1.106917
Epoch 1899 
Prediction Loss: 1.098946
Epoch 1949 
Prediction Loss: 1.089630
Epoch 1999 
Prediction Loss: 1.079050
Epoch 2049 
Prediction Loss: 1.091440
Epoch 2099 
Prediction Loss: 1.077682
Epoch 2149 
Prediction Loss: 1.050974
Epoch 2199 
Prediction Loss: 1.083164
Epoch 2249 
Prediction Loss: 1.041178
Epoch 2299 
Prediction Loss: 1.037060
Epoch 2349 
Prediction Loss: 1.034796
Epoch 2399 
Prediction Loss: 1.031930
Epoch 2449 
Prediction Loss: 1.010548
Epoch 2499 
Prediction Loss: 0.991216
Epoch 2549 
Prediction Loss: 0.995186
Epoch 2599 
Prediction Loss: 0.976736
Epoch 2649 
Prediction Loss: 0.963212
Epoch 2699 
Prediction Loss: 0.958835
Epoch 2749 
Prediction Loss: 0.946853
Epoch 2799 
Prediction Loss: 0.939659
Epoch 2849 
Prediction Loss: 0.924519
Epoch 2899 
Prediction Loss: 0.961185
Epoch 2949 
Prediction Loss: 0.919648
Epoch 2999 
Prediction Loss: 0.920133
Epoch 3049 
Prediction Loss: 0.978877
Epoch 3099 
Prediction Loss: 0.937367
Epoch 3149 
Prediction Loss: 0.907171
Epoch 3199 
Prediction Loss: 0.905747
Epoch 3249 
Prediction Loss: 0.886919
Epoch 3299 
Prediction Loss: 0.889383
Epoch 3349 
Prediction Loss: 0.872433
Epoch 3399 
Prediction Loss: 0.889789
Epoch 3449 
Prediction Loss: 0.881841
Epoch 3499 
Prediction Loss: 0.875987
Epoch 3549 
Prediction Loss: 0.866351
Epoch 3599 
Prediction Loss: 0.854694
Epoch 3649 
Prediction Loss: 0.858852
Epoch 3699 
Prediction Loss: 0.860690
Epoch 3749 
Prediction Loss: 0.851813
Epoch 3799 
Prediction Loss: 0.870368
Epoch 3849 
Prediction Loss: 0.838452
Epoch 3899 
Prediction Loss: 0.868860
Epoch 3949 
Prediction Loss: 0.828184
Epoch 3999 
Prediction Loss: 0.845475
Epoch 4049 
Prediction Loss: 0.862829
Epoch 4099 
Prediction Loss: 0.859248
Epoch 4149 
Prediction Loss: 0.828888
Epoch 4199 
Prediction Loss: 0.840182
Epoch 4249 
Prediction Loss: 0.843996
Epoch 4299 
Prediction Loss: 0.842345
Epoch 4349 
Prediction Loss: 0.911105
Epoch 4399 
Prediction Loss: 0.821563
Epoch 4449 
Prediction Loss: 0.818892
Epoch 4499 
Prediction Loss: 0.812487
Epoch 4549 
Prediction Loss: 0.867149
Epoch 4599 
Prediction Loss: 0.833722
Epoch 4649 
Prediction Loss: 0.838782
Epoch 4699 
Prediction Loss: 0.836080
Epoch 4749 
Prediction Loss: 0.833761
Epoch 4799 
Prediction Loss: 0.819036
Epoch 4849 
Prediction Loss: 0.813010
Epoch 4899 
Prediction Loss: 0.829042
Epoch 4949 
Prediction Loss: 0.838114
Epoch 4999 
Prediction Loss: 0.807978
Epoch 5049 
Prediction Loss: 0.813038
Epoch 5099 
Prediction Loss: 0.798146
Epoch 5149 
Prediction Loss: 0.815041
Epoch 5199 
Prediction Loss: 0.801954
Epoch 5249 
Prediction Loss: 0.801004
Epoch 5299 
Prediction Loss: 0.805843
Epoch 5349 
Prediction Loss: 0.794260
Epoch 5399 
Prediction Loss: 0.785766
Epoch 5449 
Prediction Loss: 0.797698
Epoch 5499 
Prediction Loss: 0.815703
Epoch 5549 
Prediction Loss: 0.794067
Epoch 5599 
Prediction Loss: 0.795421
Epoch 5649 
Prediction Loss: 0.788617
Epoch 5699 
Prediction Loss: 0.795774
Epoch 5749 
Prediction Loss: 0.805854
Epoch 5799 
Prediction Loss: 0.797702
Epoch 5849 
Prediction Loss: 0.783791
Epoch 5899 
Prediction Loss: 0.796562
Epoch 5949 
Prediction Loss: 0.807451
Epoch 5999 
Prediction Loss: 0.783535
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.878086
Insample Error 4.253480
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.474058
Rec Loss: 11.601903
KL Loss: 1.872154
Y Loss: 0.978851
T Loss: 11.112478
Epoch 99 
Overall Loss: 13.354108
Rec Loss: 11.343244
KL Loss: 2.010864
Y Loss: 0.954319
T Loss: 10.866084
Epoch 149 
Overall Loss: 13.299048
Rec Loss: 11.311115
KL Loss: 1.987934
Y Loss: 0.992145
T Loss: 10.815042
Epoch 199 
Overall Loss: 13.247364
Rec Loss: 11.180633
KL Loss: 2.066731
Y Loss: 0.979185
T Loss: 10.691040
Epoch 249 
Overall Loss: 13.224165
Rec Loss: 10.996596
KL Loss: 2.227568
Y Loss: 0.991773
T Loss: 10.500710
Epoch 299 
Overall Loss: 13.197236
Rec Loss: 10.983302
KL Loss: 2.213934
Y Loss: 0.973066
T Loss: 10.496769
Epoch 349 
Overall Loss: 13.194621
Rec Loss: 10.969410
KL Loss: 2.225211
Y Loss: 0.990593
T Loss: 10.474113
Epoch 399 
Overall Loss: 13.177728
Rec Loss: 10.967944
KL Loss: 2.209783
Y Loss: 0.973954
T Loss: 10.480968
Epoch 449 
Overall Loss: 13.197007
Rec Loss: 10.983242
KL Loss: 2.213765
Y Loss: 0.986645
T Loss: 10.489920
Epoch 499 
Overall Loss: 13.160981
Rec Loss: 10.934285
KL Loss: 2.226696
Y Loss: 0.962161
T Loss: 10.453205
Epoch 549 
Overall Loss: 13.145628
Rec Loss: 10.956210
KL Loss: 2.189418
Y Loss: 0.981933
T Loss: 10.465244
Epoch 599 
Overall Loss: 13.149190
Rec Loss: 10.935558
KL Loss: 2.213632
Y Loss: 0.971401
T Loss: 10.449857
Epoch 649 
Overall Loss: 13.130140
Rec Loss: 10.927782
KL Loss: 2.202357
Y Loss: 0.966858
T Loss: 10.444354
Epoch 699 
Overall Loss: 13.127041
Rec Loss: 10.905848
KL Loss: 2.221193
Y Loss: 0.942280
T Loss: 10.434708
Epoch 749 
Overall Loss: 13.132737
Rec Loss: 10.930007
KL Loss: 2.202730
Y Loss: 0.969022
T Loss: 10.445496
Epoch 799 
Overall Loss: 13.144075
Rec Loss: 10.924848
KL Loss: 2.219226
Y Loss: 0.969247
T Loss: 10.440225
Epoch 849 
Overall Loss: 13.119210
Rec Loss: 10.907719
KL Loss: 2.211491
Y Loss: 0.945280
T Loss: 10.435079
Epoch 899 
Overall Loss: 13.132868
Rec Loss: 10.920661
KL Loss: 2.212208
Y Loss: 0.972391
T Loss: 10.434465
Epoch 949 
Overall Loss: 13.122374
Rec Loss: 10.901964
KL Loss: 2.220410
Y Loss: 0.953074
T Loss: 10.425427
Epoch 999 
Overall Loss: 13.100776
Rec Loss: 10.905376
KL Loss: 2.195399
Y Loss: 0.968528
T Loss: 10.421112
Epoch 1049 
Overall Loss: 13.101690
Rec Loss: 10.900168
KL Loss: 2.201522
Y Loss: 0.954963
T Loss: 10.422687
Epoch 1099 
Overall Loss: 13.116991
Rec Loss: 10.897292
KL Loss: 2.219699
Y Loss: 0.971574
T Loss: 10.411505
Epoch 1149 
Overall Loss: 13.103238
Rec Loss: 10.885753
KL Loss: 2.217484
Y Loss: 0.962400
T Loss: 10.404553
Epoch 1199 
Overall Loss: 13.107374
Rec Loss: 10.885021
KL Loss: 2.222353
Y Loss: 0.969607
T Loss: 10.400218
Epoch 1249 
Overall Loss: 13.117274
Rec Loss: 10.902047
KL Loss: 2.215227
Y Loss: 0.974152
T Loss: 10.414971
Epoch 1299 
Overall Loss: 13.102800
Rec Loss: 10.904727
KL Loss: 2.198073
Y Loss: 0.968541
T Loss: 10.420456
Epoch 1349 
Overall Loss: 13.113032
Rec Loss: 10.913918
KL Loss: 2.199114
Y Loss: 0.977627
T Loss: 10.425104
Epoch 1399 
Overall Loss: 13.082967
Rec Loss: 10.854135
KL Loss: 2.228832
Y Loss: 0.928329
T Loss: 10.389971
Epoch 1449 
Overall Loss: 13.086889
Rec Loss: 10.892487
KL Loss: 2.194403
Y Loss: 0.968262
T Loss: 10.408356
Epoch 1499 
Overall Loss: 13.050738
Rec Loss: 10.839169
KL Loss: 2.211569
Y Loss: 0.971984
T Loss: 10.353177
Epoch 1549 
Overall Loss: 13.071824
Rec Loss: 10.854517
KL Loss: 2.217307
Y Loss: 0.944686
T Loss: 10.382174
Epoch 1599 
Overall Loss: 13.062509
Rec Loss: 10.867584
KL Loss: 2.194925
Y Loss: 0.971669
T Loss: 10.381749
Epoch 1649 
Overall Loss: 13.069263
Rec Loss: 10.872863
KL Loss: 2.196400
Y Loss: 0.954410
T Loss: 10.395658
Epoch 1699 
Overall Loss: 13.064794
Rec Loss: 10.837633
KL Loss: 2.227160
Y Loss: 0.923185
T Loss: 10.376041
Epoch 1749 
Overall Loss: 13.078958
Rec Loss: 10.871693
KL Loss: 2.207264
Y Loss: 0.965284
T Loss: 10.389051
Epoch 1799 
Overall Loss: 13.049139
Rec Loss: 10.820321
KL Loss: 2.228818
Y Loss: 0.927467
T Loss: 10.356588
Epoch 1849 
Overall Loss: 13.047544
Rec Loss: 10.830237
KL Loss: 2.217306
Y Loss: 0.925402
T Loss: 10.367536
Epoch 1899 
Overall Loss: 13.052080
Rec Loss: 10.841896
KL Loss: 2.210184
Y Loss: 0.935376
T Loss: 10.374208
Epoch 1949 
Overall Loss: 13.028518
Rec Loss: 10.821884
KL Loss: 2.206634
Y Loss: 0.942429
T Loss: 10.350669
Epoch 1999 
Overall Loss: 13.066678
Rec Loss: 10.835587
KL Loss: 2.231091
Y Loss: 0.930796
T Loss: 10.370189
Epoch 2049 
Overall Loss: 13.029052
Rec Loss: 10.820859
KL Loss: 2.208194
Y Loss: 0.945976
T Loss: 10.347870
Epoch 2099 
Overall Loss: 13.073769
Rec Loss: 10.852607
KL Loss: 2.221163
Y Loss: 0.972141
T Loss: 10.366536
Epoch 2149 
Overall Loss: 13.042790
Rec Loss: 10.804962
KL Loss: 2.237829
Y Loss: 0.929980
T Loss: 10.339972
Epoch 2199 
Overall Loss: 13.026533
Rec Loss: 10.816118
KL Loss: 2.210415
Y Loss: 0.945476
T Loss: 10.343380
Epoch 2249 
Overall Loss: 13.027548
Rec Loss: 10.817737
KL Loss: 2.209811
Y Loss: 0.967458
T Loss: 10.334008
Epoch 2299 
Overall Loss: 13.012752
Rec Loss: 10.802332
KL Loss: 2.210420
Y Loss: 0.942172
T Loss: 10.331246
Epoch 2349 
Overall Loss: 13.018508
Rec Loss: 10.822383
KL Loss: 2.196126
Y Loss: 0.934948
T Loss: 10.354909
Epoch 2399 
Overall Loss: 13.028118
Rec Loss: 10.795697
KL Loss: 2.232421
Y Loss: 0.938494
T Loss: 10.326450
Epoch 2449 
Overall Loss: 13.013322
Rec Loss: 10.794670
KL Loss: 2.218652
Y Loss: 0.942336
T Loss: 10.323502
Epoch 2499 
Overall Loss: 13.025291
Rec Loss: 10.779560
KL Loss: 2.245731
Y Loss: 0.910074
T Loss: 10.324523
Epoch 2549 
Overall Loss: 12.996158
Rec Loss: 10.803276
KL Loss: 2.192883
Y Loss: 0.940153
T Loss: 10.333199
Epoch 2599 
Overall Loss: 13.034207
Rec Loss: 10.804816
KL Loss: 2.229391
Y Loss: 0.948996
T Loss: 10.330318
Epoch 2649 
Overall Loss: 12.997582
Rec Loss: 10.781659
KL Loss: 2.215923
Y Loss: 0.951351
T Loss: 10.305983
Epoch 2699 
Overall Loss: 13.004007
Rec Loss: 10.804954
KL Loss: 2.199053
Y Loss: 0.949303
T Loss: 10.330302
Epoch 2749 
Overall Loss: 13.007007
Rec Loss: 10.793243
KL Loss: 2.213764
Y Loss: 0.940175
T Loss: 10.323156
Epoch 2799 
Overall Loss: 12.982637
Rec Loss: 10.758625
KL Loss: 2.224012
Y Loss: 0.908796
T Loss: 10.304227
Epoch 2849 
Overall Loss: 12.993021
Rec Loss: 10.754540
KL Loss: 2.238482
Y Loss: 0.915012
T Loss: 10.297033
Epoch 2899 
Overall Loss: 12.989750
Rec Loss: 10.759003
KL Loss: 2.230747
Y Loss: 0.931659
T Loss: 10.293173
Epoch 2949 
Overall Loss: 12.967456
Rec Loss: 10.793684
KL Loss: 2.173772
Y Loss: 0.921488
T Loss: 10.332940
Epoch 2999 
Overall Loss: 12.966971
Rec Loss: 10.757249
KL Loss: 2.209723
Y Loss: 0.933653
T Loss: 10.290422
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.072249
Epoch 99
Rec Loss: 2.063309
Epoch 149
Rec Loss: 2.056356
Epoch 199
Rec Loss: 2.043748
Epoch 249
Rec Loss: 2.056757
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.932037
Epoch 99
Rec Loss: 9.946996
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.633712
Insample Error: 1.935477
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.318033
Rec Loss: 19.788751
KL Loss: 2.529283
Y Loss: 11.721370
T Loss: 13.139239
X Loss: 0.788827
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.688878
Epoch 99
Rec Loss: 3.685731
Epoch 149
Rec Loss: 3.688510
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.733342
Epoch 99
Rec Loss: 2.761036
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.762157
Insample Error 3.824097
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.590906
Epoch 99 
Prediction Loss: 3.377117
Epoch 149 
Prediction Loss: 3.337059
Epoch 199 
Prediction Loss: 3.203889
Epoch 249 
Prediction Loss: 2.950142
Epoch 299 
Prediction Loss: 2.811385
Epoch 349 
Prediction Loss: 2.655918
Epoch 399 
Prediction Loss: 2.492090
Epoch 449 
Prediction Loss: 2.381053
Epoch 499 
Prediction Loss: 2.269115
Epoch 549 
Prediction Loss: 2.182050
Epoch 599 
Prediction Loss: 2.058284
Epoch 649 
Prediction Loss: 2.012560
Epoch 699 
Prediction Loss: 1.926983
Epoch 749 
Prediction Loss: 1.862496
Epoch 799 
Prediction Loss: 1.790812
Epoch 849 
Prediction Loss: 1.748676
Epoch 899 
Prediction Loss: 1.735438
Epoch 949 
Prediction Loss: 1.640362
Epoch 999 
Prediction Loss: 1.638476
Epoch 1049 
Prediction Loss: 1.597589
Epoch 1099 
Prediction Loss: 1.536638
Epoch 1149 
Prediction Loss: 1.528345
Epoch 1199 
Prediction Loss: 1.518373
Epoch 1249 
Prediction Loss: 1.470155
Epoch 1299 
Prediction Loss: 1.455846
Epoch 1349 
Prediction Loss: 1.380838
Epoch 1399 
Prediction Loss: 1.386652
Epoch 1449 
Prediction Loss: 1.352973
Epoch 1499 
Prediction Loss: 1.357758
Epoch 1549 
Prediction Loss: 1.347137
Epoch 1599 
Prediction Loss: 1.313295
Epoch 1649 
Prediction Loss: 1.294946
Epoch 1699 
Prediction Loss: 1.260340
Epoch 1749 
Prediction Loss: 1.259354
Epoch 1799 
Prediction Loss: 1.215634
Epoch 1849 
Prediction Loss: 1.218364
Epoch 1899 
Prediction Loss: 1.182087
Epoch 1949 
Prediction Loss: 1.172799
Epoch 1999 
Prediction Loss: 1.185159
Epoch 2049 
Prediction Loss: 1.147698
Epoch 2099 
Prediction Loss: 1.133800
Epoch 2149 
Prediction Loss: 1.187009
Epoch 2199 
Prediction Loss: 1.126820
Epoch 2249 
Prediction Loss: 1.137903
Epoch 2299 
Prediction Loss: 1.141067
Epoch 2349 
Prediction Loss: 1.095168
Epoch 2399 
Prediction Loss: 1.102459
Epoch 2449 
Prediction Loss: 1.085012
Epoch 2499 
Prediction Loss: 1.095560
Epoch 2549 
Prediction Loss: 1.085377
Epoch 2599 
Prediction Loss: 1.118713
Epoch 2649 
Prediction Loss: 1.073059
Epoch 2699 
Prediction Loss: 1.058082
Epoch 2749 
Prediction Loss: 1.060432
Epoch 2799 
Prediction Loss: 1.079525
Epoch 2849 
Prediction Loss: 1.048971
Epoch 2899 
Prediction Loss: 1.047898
Epoch 2949 
Prediction Loss: 1.035735
Epoch 2999 
Prediction Loss: 1.058397
Epoch 3049 
Prediction Loss: 1.032167
Epoch 3099 
Prediction Loss: 1.000355
Epoch 3149 
Prediction Loss: 1.000227
Epoch 3199 
Prediction Loss: 1.006984
Epoch 3249 
Prediction Loss: 1.010979
Epoch 3299 
Prediction Loss: 0.999646
Epoch 3349 
Prediction Loss: 1.045541
Epoch 3399 
Prediction Loss: 1.004178
Epoch 3449 
Prediction Loss: 0.992409
Epoch 3499 
Prediction Loss: 1.073416
Epoch 3549 
Prediction Loss: 0.986899
Epoch 3599 
Prediction Loss: 0.978141
Epoch 3649 
Prediction Loss: 0.969344
Epoch 3699 
Prediction Loss: 0.994900
Epoch 3749 
Prediction Loss: 0.965722
Epoch 3799 
Prediction Loss: 0.972792
Epoch 3849 
Prediction Loss: 0.989965
Epoch 3899 
Prediction Loss: 0.980390
Epoch 3949 
Prediction Loss: 0.992952
Epoch 3999 
Prediction Loss: 0.975462
Epoch 4049 
Prediction Loss: 0.965415
Epoch 4099 
Prediction Loss: 0.956139
Epoch 4149 
Prediction Loss: 0.965830
Epoch 4199 
Prediction Loss: 0.963043
Epoch 4249 
Prediction Loss: 0.973917
Epoch 4299 
Prediction Loss: 0.966858
Epoch 4349 
Prediction Loss: 0.964343
Epoch 4399 
Prediction Loss: 0.953528
Epoch 4449 
Prediction Loss: 0.946772
Epoch 4499 
Prediction Loss: 0.937256
Epoch 4549 
Prediction Loss: 0.945242
Epoch 4599 
Prediction Loss: 0.919958
Epoch 4649 
Prediction Loss: 0.931205
Epoch 4699 
Prediction Loss: 0.918631
Epoch 4749 
Prediction Loss: 0.921238
Epoch 4799 
Prediction Loss: 0.931343
Epoch 4849 
Prediction Loss: 0.901930
Epoch 4899 
Prediction Loss: 0.933747
Epoch 4949 
Prediction Loss: 0.899311
Epoch 4999 
Prediction Loss: 0.891507
Epoch 5049 
Prediction Loss: 0.898885
Epoch 5099 
Prediction Loss: 0.886156
Epoch 5149 
Prediction Loss: 0.898540
Epoch 5199 
Prediction Loss: 0.908223
Epoch 5249 
Prediction Loss: 0.919572
Epoch 5299 
Prediction Loss: 0.891602
Epoch 5349 
Prediction Loss: 0.876075
Epoch 5399 
Prediction Loss: 0.911606
Epoch 5449 
Prediction Loss: 0.892941
Epoch 5499 
Prediction Loss: 0.901492
Epoch 5549 
Prediction Loss: 0.886561
Epoch 5599 
Prediction Loss: 0.881392
Epoch 5649 
Prediction Loss: 0.875142
Epoch 5699 
Prediction Loss: 0.939207
Epoch 5749 
Prediction Loss: 0.881687
Epoch 5799 
Prediction Loss: 0.871799
Epoch 5849 
Prediction Loss: 0.863746
Epoch 5899 
Prediction Loss: 0.891346
Epoch 5949 
Prediction Loss: 0.876915
Epoch 5999 
Prediction Loss: 0.880640
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.931997
Insample Error 4.250547
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.489843
Rec Loss: 11.454079
KL Loss: 2.035764
Y Loss: 1.033982
T Loss: 10.937088
Epoch 99 
Overall Loss: 13.354257
Rec Loss: 11.331926
KL Loss: 2.022331
Y Loss: 0.976542
T Loss: 10.843654
Epoch 149 
Overall Loss: 13.326153
Rec Loss: 11.310415
KL Loss: 2.015738
Y Loss: 0.978671
T Loss: 10.821080
Epoch 199 
Overall Loss: 13.270306
Rec Loss: 11.042130
KL Loss: 2.228175
Y Loss: 0.969960
T Loss: 10.557150
Epoch 249 
Overall Loss: 13.233280
Rec Loss: 10.983181
KL Loss: 2.250099
Y Loss: 0.974796
T Loss: 10.495783
Epoch 299 
Overall Loss: 13.228593
Rec Loss: 10.971290
KL Loss: 2.257304
Y Loss: 0.995005
T Loss: 10.473787
Epoch 349 
Overall Loss: 13.194689
Rec Loss: 10.981519
KL Loss: 2.213171
Y Loss: 0.996520
T Loss: 10.483259
Epoch 399 
Overall Loss: 13.201081
Rec Loss: 10.965114
KL Loss: 2.235967
Y Loss: 0.986422
T Loss: 10.471903
Epoch 449 
Overall Loss: 13.208982
Rec Loss: 10.990792
KL Loss: 2.218190
Y Loss: 0.995077
T Loss: 10.493253
Epoch 499 
Overall Loss: 13.163497
Rec Loss: 10.940198
KL Loss: 2.223299
Y Loss: 0.950784
T Loss: 10.464806
Epoch 549 
Overall Loss: 13.194064
Rec Loss: 10.939489
KL Loss: 2.254575
Y Loss: 0.970122
T Loss: 10.454428
Epoch 599 
Overall Loss: 13.174314
Rec Loss: 10.946305
KL Loss: 2.228010
Y Loss: 0.971499
T Loss: 10.460555
Epoch 649 
Overall Loss: 13.152628
Rec Loss: 10.925286
KL Loss: 2.227342
Y Loss: 0.963954
T Loss: 10.443309
Epoch 699 
Overall Loss: 13.146489
Rec Loss: 10.902320
KL Loss: 2.244169
Y Loss: 0.967124
T Loss: 10.418758
Epoch 749 
Overall Loss: 13.149308
Rec Loss: 10.931553
KL Loss: 2.217755
Y Loss: 0.972405
T Loss: 10.445350
Epoch 799 
Overall Loss: 13.130316
Rec Loss: 10.897819
KL Loss: 2.232498
Y Loss: 0.943572
T Loss: 10.426033
Epoch 849 
Overall Loss: 13.132697
Rec Loss: 10.921756
KL Loss: 2.210942
Y Loss: 0.984229
T Loss: 10.429641
Epoch 899 
Overall Loss: 13.116850
Rec Loss: 10.919377
KL Loss: 2.197473
Y Loss: 0.956478
T Loss: 10.441138
Epoch 949 
Overall Loss: 13.118191
Rec Loss: 10.898526
KL Loss: 2.219665
Y Loss: 0.961530
T Loss: 10.417761
Epoch 999 
Overall Loss: 13.107672
Rec Loss: 10.884038
KL Loss: 2.223635
Y Loss: 0.968370
T Loss: 10.399853
Epoch 1049 
Overall Loss: 13.116064
Rec Loss: 10.907784
KL Loss: 2.208280
Y Loss: 0.969173
T Loss: 10.423197
Epoch 1099 
Overall Loss: 13.104844
Rec Loss: 10.871023
KL Loss: 2.233821
Y Loss: 0.944221
T Loss: 10.398913
Epoch 1149 
Overall Loss: 13.088418
Rec Loss: 10.857408
KL Loss: 2.231010
Y Loss: 0.927879
T Loss: 10.393469
Epoch 1199 
Overall Loss: 13.088884
Rec Loss: 10.855718
KL Loss: 2.233166
Y Loss: 0.940576
T Loss: 10.385431
Epoch 1249 
Overall Loss: 13.108030
Rec Loss: 10.870798
KL Loss: 2.237232
Y Loss: 0.935941
T Loss: 10.402827
Epoch 1299 
Overall Loss: 13.101632
Rec Loss: 10.889465
KL Loss: 2.212168
Y Loss: 0.964565
T Loss: 10.407182
Epoch 1349 
Overall Loss: 13.079490
Rec Loss: 10.853020
KL Loss: 2.226470
Y Loss: 0.943150
T Loss: 10.381445
Epoch 1399 
Overall Loss: 13.076402
Rec Loss: 10.859189
KL Loss: 2.217213
Y Loss: 0.964891
T Loss: 10.376743
Epoch 1449 
Overall Loss: 13.070970
Rec Loss: 10.868139
KL Loss: 2.202830
Y Loss: 0.940621
T Loss: 10.397829
Epoch 1499 
Overall Loss: 13.088230
Rec Loss: 10.879294
KL Loss: 2.208935
Y Loss: 0.967995
T Loss: 10.395297
Epoch 1549 
Overall Loss: 13.084869
Rec Loss: 10.881433
KL Loss: 2.203436
Y Loss: 0.958871
T Loss: 10.401998
Epoch 1599 
Overall Loss: 13.039038
Rec Loss: 10.859275
KL Loss: 2.179763
Y Loss: 0.952000
T Loss: 10.383275
Epoch 1649 
Overall Loss: 13.066931
Rec Loss: 10.882918
KL Loss: 2.184014
Y Loss: 0.936559
T Loss: 10.414638
Epoch 1699 
Overall Loss: 13.065920
Rec Loss: 10.853824
KL Loss: 2.212097
Y Loss: 0.977745
T Loss: 10.364951
Epoch 1749 
Overall Loss: 13.066942
Rec Loss: 10.871526
KL Loss: 2.195416
Y Loss: 0.970627
T Loss: 10.386213
Epoch 1799 
Overall Loss: 13.049349
Rec Loss: 10.854921
KL Loss: 2.194428
Y Loss: 0.969312
T Loss: 10.370265
Epoch 1849 
Overall Loss: 13.036724
Rec Loss: 10.837372
KL Loss: 2.199352
Y Loss: 0.954416
T Loss: 10.360164
Epoch 1899 
Overall Loss: 13.035070
Rec Loss: 10.827609
KL Loss: 2.207461
Y Loss: 0.949467
T Loss: 10.352876
Epoch 1949 
Overall Loss: 13.043330
Rec Loss: 10.815735
KL Loss: 2.227595
Y Loss: 0.924054
T Loss: 10.353708
Epoch 1999 
Overall Loss: 13.028651
Rec Loss: 10.824741
KL Loss: 2.203910
Y Loss: 0.950471
T Loss: 10.349505
Epoch 2049 
Overall Loss: 13.014275
Rec Loss: 10.808908
KL Loss: 2.205367
Y Loss: 0.967206
T Loss: 10.325305
Epoch 2099 
Overall Loss: 13.028204
Rec Loss: 10.821796
KL Loss: 2.206409
Y Loss: 0.941142
T Loss: 10.351225
Epoch 2149 
Overall Loss: 13.031042
Rec Loss: 10.839575
KL Loss: 2.191467
Y Loss: 0.946434
T Loss: 10.366358
Epoch 2199 
Overall Loss: 13.034944
Rec Loss: 10.841303
KL Loss: 2.193641
Y Loss: 0.944376
T Loss: 10.369115
Epoch 2249 
Overall Loss: 13.030992
Rec Loss: 10.814145
KL Loss: 2.216847
Y Loss: 0.921431
T Loss: 10.353429
Epoch 2299 
Overall Loss: 13.025682
Rec Loss: 10.811535
KL Loss: 2.214146
Y Loss: 0.950859
T Loss: 10.336106
Epoch 2349 
Overall Loss: 13.024299
Rec Loss: 10.800062
KL Loss: 2.224237
Y Loss: 0.918742
T Loss: 10.340691
Epoch 2399 
Overall Loss: 13.004968
Rec Loss: 10.800807
KL Loss: 2.204162
Y Loss: 0.953582
T Loss: 10.324015
Epoch 2449 
Overall Loss: 12.992042
Rec Loss: 10.822662
KL Loss: 2.169380
Y Loss: 0.939087
T Loss: 10.353118
Epoch 2499 
Overall Loss: 13.011843
Rec Loss: 10.801784
KL Loss: 2.210059
Y Loss: 0.927860
T Loss: 10.337854
Epoch 2549 
Overall Loss: 13.014661
Rec Loss: 10.825087
KL Loss: 2.189573
Y Loss: 0.944134
T Loss: 10.353020
Epoch 2599 
Overall Loss: 13.001452
Rec Loss: 10.782026
KL Loss: 2.219426
Y Loss: 0.927371
T Loss: 10.318341
Epoch 2649 
Overall Loss: 13.005651
Rec Loss: 10.808704
KL Loss: 2.196947
Y Loss: 0.947692
T Loss: 10.334859
Epoch 2699 
Overall Loss: 12.998371
Rec Loss: 10.775375
KL Loss: 2.222996
Y Loss: 0.931154
T Loss: 10.309798
Epoch 2749 
Overall Loss: 12.971213
Rec Loss: 10.776361
KL Loss: 2.194852
Y Loss: 0.961241
T Loss: 10.295740
Epoch 2799 
Overall Loss: 12.985653
Rec Loss: 10.796498
KL Loss: 2.189155
Y Loss: 0.941886
T Loss: 10.325554
Epoch 2849 
Overall Loss: 12.977755
Rec Loss: 10.768036
KL Loss: 2.209720
Y Loss: 0.931676
T Loss: 10.302198
Epoch 2899 
Overall Loss: 13.002445
Rec Loss: 10.816437
KL Loss: 2.186008
Y Loss: 0.961162
T Loss: 10.335855
Epoch 2949 
Overall Loss: 12.964818
Rec Loss: 10.762263
KL Loss: 2.202555
Y Loss: 0.925805
T Loss: 10.299360
Epoch 2999 
Overall Loss: 12.973289
Rec Loss: 10.785593
KL Loss: 2.187696
Y Loss: 0.925741
T Loss: 10.322723
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.064096
Epoch 99
Rec Loss: 2.056329
Epoch 149
Rec Loss: 2.046122
Epoch 199
Rec Loss: 2.037095
Epoch 249
Rec Loss: 2.048912
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.954511
Epoch 99
Rec Loss: 9.926878
Epoch 149
Rec Loss: 9.903782
Epoch 199
Rec Loss: 9.906638
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.628539
Insample Error: 2.037058
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.426249
Rec Loss: 19.836473
KL Loss: 2.589776
Y Loss: 11.433912
T Loss: 13.164929
X Loss: 0.954588
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.623749
Epoch 99
Rec Loss: 3.625549
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 3.047458
Epoch 99
Rec Loss: 3.021405
Epoch 149
Rec Loss: 3.030656
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.741696
Insample Error 3.843221
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.588070
Epoch 99 
Prediction Loss: 3.326196
Epoch 149 
Prediction Loss: 3.173375
Epoch 199 
Prediction Loss: 3.092677
Epoch 249 
Prediction Loss: 2.883852
Epoch 299 
Prediction Loss: 2.750402
Epoch 349 
Prediction Loss: 2.652482
Epoch 399 
Prediction Loss: 2.507293
Epoch 449 
Prediction Loss: 2.420760
Epoch 499 
Prediction Loss: 2.321841
Epoch 549 
Prediction Loss: 2.212893
Epoch 599 
Prediction Loss: 2.086683
Epoch 649 
Prediction Loss: 2.034547
Epoch 699 
Prediction Loss: 1.910323
Epoch 749 
Prediction Loss: 1.830860
Epoch 799 
Prediction Loss: 1.782365
Epoch 849 
Prediction Loss: 1.699011
Epoch 899 
Prediction Loss: 1.667056
Epoch 949 
Prediction Loss: 1.570340
Epoch 999 
Prediction Loss: 1.527799
Epoch 1049 
Prediction Loss: 1.519010
Epoch 1099 
Prediction Loss: 1.492088
Epoch 1149 
Prediction Loss: 1.437370
Epoch 1199 
Prediction Loss: 1.438000
Epoch 1249 
Prediction Loss: 1.405872
Epoch 1299 
Prediction Loss: 1.371284
Epoch 1349 
Prediction Loss: 1.383226
Epoch 1399 
Prediction Loss: 1.347602
Epoch 1449 
Prediction Loss: 1.342280
Epoch 1499 
Prediction Loss: 1.309326
Epoch 1549 
Prediction Loss: 1.291571
Epoch 1599 
Prediction Loss: 1.240484
Epoch 1649 
Prediction Loss: 1.244295
Epoch 1699 
Prediction Loss: 1.227282
Epoch 1749 
Prediction Loss: 1.220246
Epoch 1799 
Prediction Loss: 1.192872
Epoch 1849 
Prediction Loss: 1.189205
Epoch 1899 
Prediction Loss: 1.189454
Epoch 1949 
Prediction Loss: 1.170030
Epoch 1999 
Prediction Loss: 1.143173
Epoch 2049 
Prediction Loss: 1.144843
Epoch 2099 
Prediction Loss: 1.126814
Epoch 2149 
Prediction Loss: 1.105776
Epoch 2199 
Prediction Loss: 1.115382
Epoch 2249 
Prediction Loss: 1.087958
Epoch 2299 
Prediction Loss: 1.081853
Epoch 2349 
Prediction Loss: 1.075739
Epoch 2399 
Prediction Loss: 1.070148
Epoch 2449 
Prediction Loss: 1.059390
Epoch 2499 
Prediction Loss: 1.060239
Epoch 2549 
Prediction Loss: 1.052820
Epoch 2599 
Prediction Loss: 1.080753
Epoch 2649 
Prediction Loss: 1.046011
Epoch 2699 
Prediction Loss: 1.022574
Epoch 2749 
Prediction Loss: 1.023397
Epoch 2799 
Prediction Loss: 1.033472
Epoch 2849 
Prediction Loss: 1.009910
Epoch 2899 
Prediction Loss: 1.028978
Epoch 2949 
Prediction Loss: 1.012598
Epoch 2999 
Prediction Loss: 1.015982
Epoch 3049 
Prediction Loss: 0.996595
Epoch 3099 
Prediction Loss: 1.000169
Epoch 3149 
Prediction Loss: 1.031260
Epoch 3199 
Prediction Loss: 0.982668
Epoch 3249 
Prediction Loss: 0.991870
Epoch 3299 
Prediction Loss: 0.980062
Epoch 3349 
Prediction Loss: 0.977484
Epoch 3399 
Prediction Loss: 0.974133
Epoch 3449 
Prediction Loss: 0.953738
Epoch 3499 
Prediction Loss: 0.953984
Epoch 3549 
Prediction Loss: 0.957352
Epoch 3599 
Prediction Loss: 0.960484
Epoch 3649 
Prediction Loss: 0.927997
Epoch 3699 
Prediction Loss: 0.929661
Epoch 3749 
Prediction Loss: 0.947700
Epoch 3799 
Prediction Loss: 0.954012
Epoch 3849 
Prediction Loss: 0.908346
Epoch 3899 
Prediction Loss: 0.921678
Epoch 3949 
Prediction Loss: 0.945520
Epoch 3999 
Prediction Loss: 0.933514
Epoch 4049 
Prediction Loss: 0.931486
Epoch 4099 
Prediction Loss: 0.915835
Epoch 4149 
Prediction Loss: 0.909683
Epoch 4199 
Prediction Loss: 0.965789
Epoch 4249 
Prediction Loss: 0.910134
Epoch 4299 
Prediction Loss: 0.898648
Epoch 4349 
Prediction Loss: 0.907657
Epoch 4399 
Prediction Loss: 0.926283
Epoch 4449 
Prediction Loss: 0.885291
Epoch 4499 
Prediction Loss: 0.872353
Epoch 4549 
Prediction Loss: 0.884887
Epoch 4599 
Prediction Loss: 0.875650
Epoch 4649 
Prediction Loss: 0.915642
Epoch 4699 
Prediction Loss: 0.874918
Epoch 4749 
Prediction Loss: 0.924689
Epoch 4799 
Prediction Loss: 0.872909
Epoch 4849 
Prediction Loss: 0.854475
Epoch 4899 
Prediction Loss: 0.873299
Epoch 4949 
Prediction Loss: 0.863292
Epoch 4999 
Prediction Loss: 0.917366
Epoch 5049 
Prediction Loss: 0.858106
Epoch 5099 
Prediction Loss: 0.900058
Epoch 5149 
Prediction Loss: 0.889057
Epoch 5199 
Prediction Loss: 0.874141
Epoch 5249 
Prediction Loss: 0.895759
Epoch 5299 
Prediction Loss: 0.938328
Epoch 5349 
Prediction Loss: 0.854423
Epoch 5399 
Prediction Loss: 0.889211
Epoch 5449 
Prediction Loss: 0.892428
Epoch 5499 
Prediction Loss: 0.848044
Epoch 5549 
Prediction Loss: 0.842144
Epoch 5599 
Prediction Loss: 0.877659
Epoch 5649 
Prediction Loss: 0.852793
Epoch 5699 
Prediction Loss: 0.843055
Epoch 5749 
Prediction Loss: 0.844623
Epoch 5799 
Prediction Loss: 0.886573
Epoch 5849 
Prediction Loss: 0.874890
Epoch 5899 
Prediction Loss: 0.851858
Epoch 5949 
Prediction Loss: 0.823567
Epoch 5999 
Prediction Loss: 0.851915
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.956121
Insample Error 4.142738
Ours, Train RMSE
0.6193, 
0.6337, 
0.6285, 
CEVAE, Train RMSE
2.3208, 
2.7622, 
2.7417, 
Ours, Insample RMSE
1.9444, 
1.9355, 
2.0371, 
CEVAE, Insample RMSE
3.5747, 
3.8241, 
3.8432, 
Direct Regression, Insample RMSE
4.2535, 
4.2505, 
4.1427, 
Train, RMSE mean 0.6272 std 0.0060
CEVAE, RMSE mean 2.6082 std 0.2034
Ours, RMSE mean 1.9723 std 0.0459, reconstruct confounder 2.0399 (0.0028) noise 9.9219 (0.0129)
CEVAE, RMSE mean 3.7473 std 0.1223, reconstruct confounder 3.6357 (0.0370) noise 3.0004 (0.2100)
Direct Regression, RMSE mean 4.2156 std 0.0515
Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=5, mask=0, nlayer=50, obsm=1, stop=5000, ycof=0.5, ylayer=50)
Y Mean 2.635484, Std 4.326354 
Test Y Mean 0.032706, Std 4.125860 
Observe confounder 1, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.488962
Rec Loss: 11.573156
KL Loss: 1.915806
Y Loss: 1.063219
T Loss: 11.041546
Epoch 99 
Overall Loss: 13.369654
Rec Loss: 11.339616
KL Loss: 2.030038
Y Loss: 0.979780
T Loss: 10.849726
Epoch 149 
Overall Loss: 13.305943
Rec Loss: 11.301852
KL Loss: 2.004091
Y Loss: 0.970580
T Loss: 10.816563
Epoch 199 
Overall Loss: 13.231628
Rec Loss: 11.049503
KL Loss: 2.182125
Y Loss: 0.971242
T Loss: 10.563883
Epoch 249 
Overall Loss: 13.218804
Rec Loss: 10.987848
KL Loss: 2.230955
Y Loss: 0.955885
T Loss: 10.509905
Epoch 299 
Overall Loss: 13.217158
Rec Loss: 10.985196
KL Loss: 2.231962
Y Loss: 0.991866
T Loss: 10.489263
Epoch 349 
Overall Loss: 13.174466
Rec Loss: 10.944580
KL Loss: 2.229885
Y Loss: 0.969504
T Loss: 10.459828
Epoch 399 
Overall Loss: 13.191707
Rec Loss: 10.936500
KL Loss: 2.255207
Y Loss: 0.934420
T Loss: 10.469290
Epoch 449 
Overall Loss: 13.191101
Rec Loss: 10.951991
KL Loss: 2.239109
Y Loss: 0.992583
T Loss: 10.455700
Epoch 499 
Overall Loss: 13.152074
Rec Loss: 10.943091
KL Loss: 2.208983
Y Loss: 0.970388
T Loss: 10.457897
Epoch 549 
Overall Loss: 13.147176
Rec Loss: 10.948450
KL Loss: 2.198727
Y Loss: 0.963523
T Loss: 10.466688
Epoch 599 
Overall Loss: 13.165850
Rec Loss: 10.964698
KL Loss: 2.201152
Y Loss: 0.973451
T Loss: 10.477973
Epoch 649 
Overall Loss: 13.170110
Rec Loss: 10.949191
KL Loss: 2.220920
Y Loss: 0.970613
T Loss: 10.463884
Epoch 699 
Overall Loss: 13.155172
Rec Loss: 10.922604
KL Loss: 2.232568
Y Loss: 0.954871
T Loss: 10.445169
Epoch 749 
Overall Loss: 13.135075
Rec Loss: 10.904701
KL Loss: 2.230375
Y Loss: 0.941105
T Loss: 10.434148
Epoch 799 
Overall Loss: 13.125961
Rec Loss: 10.911022
KL Loss: 2.214938
Y Loss: 0.959074
T Loss: 10.431485
Epoch 849 
Overall Loss: 13.116345
Rec Loss: 10.903194
KL Loss: 2.213151
Y Loss: 0.953680
T Loss: 10.426355
Epoch 899 
Overall Loss: 13.133245
Rec Loss: 10.921983
KL Loss: 2.211261
Y Loss: 0.973615
T Loss: 10.435176
Epoch 949 
Overall Loss: 13.142088
Rec Loss: 10.888559
KL Loss: 2.253529
Y Loss: 0.939556
T Loss: 10.418782
Epoch 999 
Overall Loss: 13.095207
Rec Loss: 10.870628
KL Loss: 2.224578
Y Loss: 0.959018
T Loss: 10.391119
Epoch 1049 
Overall Loss: 13.099341
Rec Loss: 10.888612
KL Loss: 2.210729
Y Loss: 0.949839
T Loss: 10.413693
Epoch 1099 
Overall Loss: 13.106003
Rec Loss: 10.912641
KL Loss: 2.193362
Y Loss: 0.972368
T Loss: 10.426457
Epoch 1149 
Overall Loss: 13.120924
Rec Loss: 10.898712
KL Loss: 2.222212
Y Loss: 0.953187
T Loss: 10.422119
Epoch 1199 
Overall Loss: 13.078901
Rec Loss: 10.848241
KL Loss: 2.230660
Y Loss: 0.934665
T Loss: 10.380908
Epoch 1249 
Overall Loss: 13.083617
Rec Loss: 10.847034
KL Loss: 2.236583
Y Loss: 0.935420
T Loss: 10.379324
Epoch 1299 
Overall Loss: 13.080830
Rec Loss: 10.885227
KL Loss: 2.195603
Y Loss: 0.953237
T Loss: 10.408609
Epoch 1349 
Overall Loss: 13.083014
Rec Loss: 10.874287
KL Loss: 2.208727
Y Loss: 0.958754
T Loss: 10.394910
Epoch 1399 
Overall Loss: 13.076967
Rec Loss: 10.883498
KL Loss: 2.193469
Y Loss: 0.951866
T Loss: 10.407565
Epoch 1449 
Overall Loss: 13.082909
Rec Loss: 10.884559
KL Loss: 2.198350
Y Loss: 0.947086
T Loss: 10.411016
Epoch 1499 
Overall Loss: 13.085347
Rec Loss: 10.880993
KL Loss: 2.204354
Y Loss: 0.952099
T Loss: 10.404944
Epoch 1549 
Overall Loss: 13.078079
Rec Loss: 10.876836
KL Loss: 2.201243
Y Loss: 0.948821
T Loss: 10.402425
Epoch 1599 
Overall Loss: 13.039125
Rec Loss: 10.841381
KL Loss: 2.197744
Y Loss: 0.937895
T Loss: 10.372434
Epoch 1649 
Overall Loss: 13.066622
Rec Loss: 10.862936
KL Loss: 2.203686
Y Loss: 0.953538
T Loss: 10.386166
Epoch 1699 
Overall Loss: 13.071354
Rec Loss: 10.857763
KL Loss: 2.213590
Y Loss: 0.970102
T Loss: 10.372712
Epoch 1749 
Overall Loss: 13.057721
Rec Loss: 10.862530
KL Loss: 2.195190
Y Loss: 0.968806
T Loss: 10.378127
Epoch 1799 
Overall Loss: 13.054129
Rec Loss: 10.831389
KL Loss: 2.222740
Y Loss: 0.925215
T Loss: 10.368782
Epoch 1849 
Overall Loss: 13.033295
Rec Loss: 10.826888
KL Loss: 2.206407
Y Loss: 0.943632
T Loss: 10.355072
Epoch 1899 
Overall Loss: 13.041164
Rec Loss: 10.832291
KL Loss: 2.208872
Y Loss: 0.915984
T Loss: 10.374300
Epoch 1949 
Overall Loss: 13.050837
Rec Loss: 10.824463
KL Loss: 2.226374
Y Loss: 0.943744
T Loss: 10.352591
Epoch 1999 
Overall Loss: 13.039760
Rec Loss: 10.834686
KL Loss: 2.205074
Y Loss: 0.948632
T Loss: 10.360370
Epoch 2049 
Overall Loss: 13.035536
Rec Loss: 10.861012
KL Loss: 2.174524
Y Loss: 0.941746
T Loss: 10.390139
Epoch 2099 
Overall Loss: 13.030477
Rec Loss: 10.818019
KL Loss: 2.212458
Y Loss: 0.930348
T Loss: 10.352845
Epoch 2149 
Overall Loss: 13.058895
Rec Loss: 10.828346
KL Loss: 2.230549
Y Loss: 0.973497
T Loss: 10.341598
Epoch 2199 
Overall Loss: 13.018056
Rec Loss: 10.814958
KL Loss: 2.203099
Y Loss: 0.944586
T Loss: 10.342665
Epoch 2249 
Overall Loss: 13.036399
Rec Loss: 10.834527
KL Loss: 2.201873
Y Loss: 0.940500
T Loss: 10.364277
Epoch 2299 
Overall Loss: 13.006576
Rec Loss: 10.802619
KL Loss: 2.203957
Y Loss: 0.949403
T Loss: 10.327918
Epoch 2349 
Overall Loss: 13.039821
Rec Loss: 10.826945
KL Loss: 2.212876
Y Loss: 0.942950
T Loss: 10.355470
Epoch 2399 
Overall Loss: 13.003286
Rec Loss: 10.801175
KL Loss: 2.202111
Y Loss: 0.946325
T Loss: 10.328013
Epoch 2449 
Overall Loss: 13.001602
Rec Loss: 10.794937
KL Loss: 2.206665
Y Loss: 0.929711
T Loss: 10.330081
Epoch 2499 
Overall Loss: 13.018340
Rec Loss: 10.794518
KL Loss: 2.223822
Y Loss: 0.927269
T Loss: 10.330884
Epoch 2549 
Overall Loss: 12.994217
Rec Loss: 10.803721
KL Loss: 2.190495
Y Loss: 0.954821
T Loss: 10.326311
Epoch 2599 
Overall Loss: 12.991662
Rec Loss: 10.789823
KL Loss: 2.201838
Y Loss: 0.922817
T Loss: 10.328415
Epoch 2649 
Overall Loss: 13.008087
Rec Loss: 10.789155
KL Loss: 2.218933
Y Loss: 0.900752
T Loss: 10.338778
Epoch 2699 
Overall Loss: 12.998002
Rec Loss: 10.797932
KL Loss: 2.200070
Y Loss: 0.928297
T Loss: 10.333784
Epoch 2749 
Overall Loss: 13.009377
Rec Loss: 10.797997
KL Loss: 2.211380
Y Loss: 0.927399
T Loss: 10.334297
Epoch 2799 
Overall Loss: 12.960076
Rec Loss: 10.781664
KL Loss: 2.178412
Y Loss: 0.926966
T Loss: 10.318181
Epoch 2849 
Overall Loss: 12.984029
Rec Loss: 10.765741
KL Loss: 2.218288
Y Loss: 0.902158
T Loss: 10.314662
Epoch 2899 
Overall Loss: 12.979546
Rec Loss: 10.760601
KL Loss: 2.218945
Y Loss: 0.896613
T Loss: 10.312295
Epoch 2949 
Overall Loss: 12.979359
Rec Loss: 10.800779
KL Loss: 2.178580
Y Loss: 0.936961
T Loss: 10.332299
Epoch 2999 
Overall Loss: 12.963644
Rec Loss: 10.790180
KL Loss: 2.173464
Y Loss: 0.919235
T Loss: 10.330563
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.056054
Epoch 99
Rec Loss: 2.048102
Epoch 149
Rec Loss: 2.038779
Epoch 199
Rec Loss: 2.051784
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.930024
Epoch 99
Rec Loss: 9.930809
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.619264
Insample Error: 1.944365
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.558486
Rec Loss: 18.424046
KL Loss: 3.134440
Y Loss: 8.811914
T Loss: 12.969240
X Loss: 1.048849
Epoch 99 
Overall Loss: 16.836764
Rec Loss: 13.125360
KL Loss: 3.711403
Y Loss: 2.791042
T Loss: 12.906192
X Loss: -1.176352
Epoch 149 
Overall Loss: 15.635643
Rec Loss: 12.066630
KL Loss: 3.569014
Y Loss: 2.213354
T Loss: 12.927889
X Loss: -1.967936
Epoch 199 
Overall Loss: 14.610369
Rec Loss: 10.839992
KL Loss: 3.770377
Y Loss: 1.856780
T Loss: 12.503640
X Loss: -2.592038
Epoch 249 
Overall Loss: 14.142146
Rec Loss: 10.200288
KL Loss: 3.941858
Y Loss: 1.575713
T Loss: 12.360133
X Loss: -2.947701
Epoch 299 
Overall Loss: 13.836974
Rec Loss: 9.802598
KL Loss: 4.034375
Y Loss: 1.321329
T Loss: 12.262335
X Loss: -3.120401
Epoch 349 
Overall Loss: 13.550901
Rec Loss: 9.432764
KL Loss: 4.118136
Y Loss: 1.143664
T Loss: 12.087439
X Loss: -3.226506
Epoch 399 
Overall Loss: 13.385367
Rec Loss: 9.163553
KL Loss: 4.221814
Y Loss: 1.071410
T Loss: 11.969770
X Loss: -3.341922
Epoch 449 
Overall Loss: 13.296685
Rec Loss: 8.970359
KL Loss: 4.326326
Y Loss: 1.043202
T Loss: 11.874533
X Loss: -3.425775
Epoch 499 
Overall Loss: 13.239031
Rec Loss: 8.892773
KL Loss: 4.346258
Y Loss: 1.014314
T Loss: 11.839945
X Loss: -3.454329
Epoch 549 
Overall Loss: 13.176871
Rec Loss: 8.795186
KL Loss: 4.381685
Y Loss: 0.996746
T Loss: 11.803598
X Loss: -3.506785
Epoch 599 
Overall Loss: 13.133110
Rec Loss: 8.716816
KL Loss: 4.416294
Y Loss: 0.976539
T Loss: 11.742845
X Loss: -3.514298
Epoch 649 
Overall Loss: 13.126494
Rec Loss: 8.659955
KL Loss: 4.466539
Y Loss: 0.991513
T Loss: 11.677842
X Loss: -3.513643
Epoch 699 
Overall Loss: 13.068687
Rec Loss: 8.478858
KL Loss: 4.589829
Y Loss: 0.963770
T Loss: 11.543471
X Loss: -3.546498
Epoch 749 
Overall Loss: 12.965907
Rec Loss: 8.276769
KL Loss: 4.689138
Y Loss: 0.944240
T Loss: 11.383571
X Loss: -3.578922
Epoch 799 
Overall Loss: 12.928495
Rec Loss: 8.171328
KL Loss: 4.757167
Y Loss: 0.947522
T Loss: 11.288954
X Loss: -3.591388
Epoch 849 
Overall Loss: 12.888479
Rec Loss: 8.121039
KL Loss: 4.767440
Y Loss: 0.963005
T Loss: 11.242607
X Loss: -3.603071
Epoch 899 
Overall Loss: 12.877339
Rec Loss: 8.076249
KL Loss: 4.801090
Y Loss: 0.943129
T Loss: 11.207760
X Loss: -3.603075
Epoch 949 
Overall Loss: 12.875311
Rec Loss: 8.064062
KL Loss: 4.811249
Y Loss: 0.968219
T Loss: 11.206988
X Loss: -3.627036
Epoch 999 
Overall Loss: 12.857545
Rec Loss: 8.030728
KL Loss: 4.826818
Y Loss: 0.929799
T Loss: 11.205223
X Loss: -3.639395
Epoch 1049 
Overall Loss: 12.863545
Rec Loss: 8.035963
KL Loss: 4.827582
Y Loss: 0.971263
T Loss: 11.192690
X Loss: -3.642359
Epoch 1099 
Overall Loss: 12.848687
Rec Loss: 8.011193
KL Loss: 4.837493
Y Loss: 0.962697
T Loss: 11.170845
X Loss: -3.641000
Epoch 1149 
Overall Loss: 12.831350
Rec Loss: 7.990172
KL Loss: 4.841178
Y Loss: 0.937208
T Loss: 11.180537
X Loss: -3.658969
Epoch 1199 
Overall Loss: 12.818157
Rec Loss: 7.998089
KL Loss: 4.820068
Y Loss: 0.955767
T Loss: 11.181615
X Loss: -3.661409
Epoch 1249 
Overall Loss: 12.806005
Rec Loss: 7.960624
KL Loss: 4.845381
Y Loss: 0.945354
T Loss: 11.167206
X Loss: -3.679259
Epoch 1299 
Overall Loss: 12.790345
Rec Loss: 7.938542
KL Loss: 4.851803
Y Loss: 0.913503
T Loss: 11.155853
X Loss: -3.674063
Epoch 1349 
Overall Loss: 12.802826
Rec Loss: 7.949775
KL Loss: 4.853051
Y Loss: 0.931328
T Loss: 11.164678
X Loss: -3.680567
Epoch 1399 
Overall Loss: 12.772225
Rec Loss: 7.932852
KL Loss: 4.839373
Y Loss: 0.925861
T Loss: 11.172950
X Loss: -3.703029
Epoch 1449 
Overall Loss: 12.793925
Rec Loss: 7.962547
KL Loss: 4.831378
Y Loss: 0.965294
T Loss: 11.171737
X Loss: -3.691837
Epoch 1499 
Overall Loss: 12.779088
Rec Loss: 7.955722
KL Loss: 4.823365
Y Loss: 0.975755
T Loss: 11.178566
X Loss: -3.710721
Epoch 1549 
Overall Loss: 12.762298
Rec Loss: 7.903751
KL Loss: 4.858547
Y Loss: 0.948942
T Loss: 11.165421
X Loss: -3.736141
Epoch 1599 
Overall Loss: 12.760825
Rec Loss: 7.895748
KL Loss: 4.865076
Y Loss: 0.946545
T Loss: 11.159677
X Loss: -3.737201
Epoch 1649 
Overall Loss: 12.765000
Rec Loss: 7.892435
KL Loss: 4.872565
Y Loss: 0.960343
T Loss: 11.153503
X Loss: -3.741239
Epoch 1699 
Overall Loss: 12.743129
Rec Loss: 7.905560
KL Loss: 4.837569
Y Loss: 0.969161
T Loss: 11.159753
X Loss: -3.738774
Epoch 1749 
Overall Loss: 12.747307
Rec Loss: 7.860613
KL Loss: 4.886694
Y Loss: 0.947011
T Loss: 11.136835
X Loss: -3.749727
Epoch 1799 
Overall Loss: 12.727274
Rec Loss: 7.806051
KL Loss: 4.921224
Y Loss: 0.915994
T Loss: 11.124700
X Loss: -3.776646
Epoch 1849 
Overall Loss: 12.724256
Rec Loss: 7.802011
KL Loss: 4.922245
Y Loss: 0.954273
T Loss: 11.106639
X Loss: -3.781764
Epoch 1899 
Overall Loss: 12.721791
Rec Loss: 7.773287
KL Loss: 4.948503
Y Loss: 0.949330
T Loss: 11.086670
X Loss: -3.788048
Epoch 1949 
Overall Loss: 12.700847
Rec Loss: 7.744133
KL Loss: 4.956715
Y Loss: 0.946741
T Loss: 11.062023
X Loss: -3.791260
Epoch 1999 
Overall Loss: 12.676479
Rec Loss: 7.660365
KL Loss: 5.016114
Y Loss: 0.939718
T Loss: 10.992959
X Loss: -3.802453
Epoch 2049 
Overall Loss: 12.673603
Rec Loss: 7.620731
KL Loss: 5.052872
Y Loss: 0.947198
T Loss: 10.950265
X Loss: -3.803133
Epoch 2099 
Overall Loss: 12.636662
Rec Loss: 7.569882
KL Loss: 5.066781
Y Loss: 0.954305
T Loss: 10.891753
X Loss: -3.799024
Epoch 2149 
Overall Loss: 12.687633
Rec Loss: 7.565412
KL Loss: 5.122221
Y Loss: 0.953597
T Loss: 10.882729
X Loss: -3.794116
Epoch 2199 
Overall Loss: 12.649778
Rec Loss: 7.513964
KL Loss: 5.135814
Y Loss: 0.960222
T Loss: 10.847316
X Loss: -3.813463
Epoch 2249 
Overall Loss: 12.663377
Rec Loss: 7.529358
KL Loss: 5.134019
Y Loss: 0.965943
T Loss: 10.859073
X Loss: -3.812687
Epoch 2299 
Overall Loss: 12.634689
Rec Loss: 7.484796
KL Loss: 5.149893
Y Loss: 0.961706
T Loss: 10.845355
X Loss: -3.841413
Epoch 2349 
Overall Loss: 12.653207
Rec Loss: 7.509360
KL Loss: 5.143847
Y Loss: 0.939374
T Loss: 10.849842
X Loss: -3.810169
Epoch 2399 
Overall Loss: 12.640334
Rec Loss: 7.518757
KL Loss: 5.121577
Y Loss: 0.962662
T Loss: 10.848071
X Loss: -3.810645
Epoch 2449 
Overall Loss: 12.633931
Rec Loss: 7.510998
KL Loss: 5.122934
Y Loss: 0.943267
T Loss: 10.855068
X Loss: -3.815704
Epoch 2499 
Overall Loss: 12.650049
Rec Loss: 7.497010
KL Loss: 5.153039
Y Loss: 0.967333
T Loss: 10.842198
X Loss: -3.828854
Epoch 2549 
Overall Loss: 12.649640
Rec Loss: 7.495774
KL Loss: 5.153866
Y Loss: 0.962367
T Loss: 10.852826
X Loss: -3.838235
Epoch 2599 
Overall Loss: 12.633289
Rec Loss: 7.480603
KL Loss: 5.152686
Y Loss: 0.975093
T Loss: 10.847806
X Loss: -3.854749
Epoch 2649 
Overall Loss: 12.626775
Rec Loss: 7.458306
KL Loss: 5.168469
Y Loss: 0.960963
T Loss: 10.840190
X Loss: -3.862365
Epoch 2699 
Overall Loss: 12.630887
Rec Loss: 7.490545
KL Loss: 5.140342
Y Loss: 0.973237
T Loss: 10.841669
X Loss: -3.837743
Epoch 2749 
Overall Loss: 12.651211
Rec Loss: 7.465349
KL Loss: 5.185863
Y Loss: 0.961885
T Loss: 10.841361
X Loss: -3.856955
Epoch 2799 
Overall Loss: 12.632148
Rec Loss: 7.486686
KL Loss: 5.145462
Y Loss: 0.983810
T Loss: 10.850282
X Loss: -3.855501
Epoch 2849 
Overall Loss: 12.623215
Rec Loss: 7.459657
KL Loss: 5.163558
Y Loss: 0.987076
T Loss: 10.839812
X Loss: -3.873692
Epoch 2899 
Overall Loss: 12.628818
Rec Loss: 7.463413
KL Loss: 5.165405
Y Loss: 0.968598
T Loss: 10.837708
X Loss: -3.858594
Epoch 2949 
Overall Loss: 12.640562
Rec Loss: 7.459938
KL Loss: 5.180623
Y Loss: 0.974888
T Loss: 10.835624
X Loss: -3.863130
Epoch 2999 
Overall Loss: 12.605850
Rec Loss: 7.431203
KL Loss: 5.174647
Y Loss: 0.928854
T Loss: 10.843621
X Loss: -3.876844
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.366736
Epoch 99
Rec Loss: 2.346218
Epoch 149
Rec Loss: 2.360935
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.010899
Epoch 99
Rec Loss: 1.997357
Epoch 149
Rec Loss: 2.003954
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.566151
Insample Error 2.741722
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.650663
Epoch 99 
Prediction Loss: 3.356529
Epoch 149 
Prediction Loss: 3.174959
Epoch 199 
Prediction Loss: 2.991827
Epoch 249 
Prediction Loss: 2.846117
Epoch 299 
Prediction Loss: 2.804402
Epoch 349 
Prediction Loss: 2.569370
Epoch 399 
Prediction Loss: 2.430071
Epoch 449 
Prediction Loss: 2.251984
Epoch 499 
Prediction Loss: 2.202554
Epoch 549 
Prediction Loss: 2.067997
Epoch 599 
Prediction Loss: 1.883762
Epoch 649 
Prediction Loss: 1.897368
Epoch 699 
Prediction Loss: 1.731543
Epoch 749 
Prediction Loss: 1.691133
Epoch 799 
Prediction Loss: 1.650336
Epoch 849 
Prediction Loss: 1.580374
Epoch 899 
Prediction Loss: 1.526467
Epoch 949 
Prediction Loss: 1.494431
Epoch 999 
Prediction Loss: 1.529332
Epoch 1049 
Prediction Loss: 1.430539
Epoch 1099 
Prediction Loss: 1.380557
Epoch 1149 
Prediction Loss: 1.366254
Epoch 1199 
Prediction Loss: 1.355529
Epoch 1249 
Prediction Loss: 1.326400
Epoch 1299 
Prediction Loss: 1.280455
Epoch 1349 
Prediction Loss: 1.260744
Epoch 1399 
Prediction Loss: 1.261160
Epoch 1449 
Prediction Loss: 1.265143
Epoch 1499 
Prediction Loss: 1.211612
Epoch 1549 
Prediction Loss: 1.208268
Epoch 1599 
Prediction Loss: 1.164001
Epoch 1649 
Prediction Loss: 1.185300
Epoch 1699 
Prediction Loss: 1.147163
Epoch 1749 
Prediction Loss: 1.135954
Epoch 1799 
Prediction Loss: 1.168104
Epoch 1849 
Prediction Loss: 1.106917
Epoch 1899 
Prediction Loss: 1.098946
Epoch 1949 
Prediction Loss: 1.089630
Epoch 1999 
Prediction Loss: 1.079050
Epoch 2049 
Prediction Loss: 1.091440
Epoch 2099 
Prediction Loss: 1.077682
Epoch 2149 
Prediction Loss: 1.050974
Epoch 2199 
Prediction Loss: 1.083164
Epoch 2249 
Prediction Loss: 1.041178
Epoch 2299 
Prediction Loss: 1.037060
Epoch 2349 
Prediction Loss: 1.034796
Epoch 2399 
Prediction Loss: 1.031930
Epoch 2449 
Prediction Loss: 1.010548
Epoch 2499 
Prediction Loss: 0.991216
Epoch 2549 
Prediction Loss: 0.995186
Epoch 2599 
Prediction Loss: 0.976736
Epoch 2649 
Prediction Loss: 0.963212
Epoch 2699 
Prediction Loss: 0.958835
Epoch 2749 
Prediction Loss: 0.946853
Epoch 2799 
Prediction Loss: 0.939659
Epoch 2849 
Prediction Loss: 0.924519
Epoch 2899 
Prediction Loss: 0.961185
Epoch 2949 
Prediction Loss: 0.919648
Epoch 2999 
Prediction Loss: 0.920133
Epoch 3049 
Prediction Loss: 0.978877
Epoch 3099 
Prediction Loss: 0.937367
Epoch 3149 
Prediction Loss: 0.907171
Epoch 3199 
Prediction Loss: 0.905747
Epoch 3249 
Prediction Loss: 0.886919
Epoch 3299 
Prediction Loss: 0.889383
Epoch 3349 
Prediction Loss: 0.872433
Epoch 3399 
Prediction Loss: 0.889789
Epoch 3449 
Prediction Loss: 0.881841
Epoch 3499 
Prediction Loss: 0.875987
Epoch 3549 
Prediction Loss: 0.866351
Epoch 3599 
Prediction Loss: 0.854694
Epoch 3649 
Prediction Loss: 0.858852
Epoch 3699 
Prediction Loss: 0.860690
Epoch 3749 
Prediction Loss: 0.851813
Epoch 3799 
Prediction Loss: 0.870368
Epoch 3849 
Prediction Loss: 0.838452
Epoch 3899 
Prediction Loss: 0.868860
Epoch 3949 
Prediction Loss: 0.828184
Epoch 3999 
Prediction Loss: 0.845475
Epoch 4049 
Prediction Loss: 0.862829
Epoch 4099 
Prediction Loss: 0.859248
Epoch 4149 
Prediction Loss: 0.828888
Epoch 4199 
Prediction Loss: 0.840182
Epoch 4249 
Prediction Loss: 0.843996
Epoch 4299 
Prediction Loss: 0.842345
Epoch 4349 
Prediction Loss: 0.911105
Epoch 4399 
Prediction Loss: 0.821563
Epoch 4449 
Prediction Loss: 0.818892
Epoch 4499 
Prediction Loss: 0.812487
Epoch 4549 
Prediction Loss: 0.867149
Epoch 4599 
Prediction Loss: 0.833722
Epoch 4649 
Prediction Loss: 0.838782
Epoch 4699 
Prediction Loss: 0.836080
Epoch 4749 
Prediction Loss: 0.833761
Epoch 4799 
Prediction Loss: 0.819036
Epoch 4849 
Prediction Loss: 0.813010
Epoch 4899 
Prediction Loss: 0.829042
Epoch 4949 
Prediction Loss: 0.838114
Epoch 4999 
Prediction Loss: 0.807978
Epoch 5049 
Prediction Loss: 0.813038
Epoch 5099 
Prediction Loss: 0.798146
Epoch 5149 
Prediction Loss: 0.815041
Epoch 5199 
Prediction Loss: 0.801954
Epoch 5249 
Prediction Loss: 0.801004
Epoch 5299 
Prediction Loss: 0.805843
Epoch 5349 
Prediction Loss: 0.794260
Epoch 5399 
Prediction Loss: 0.785766
Epoch 5449 
Prediction Loss: 0.797698
Epoch 5499 
Prediction Loss: 0.815703
Epoch 5549 
Prediction Loss: 0.794067
Epoch 5599 
Prediction Loss: 0.795421
Epoch 5649 
Prediction Loss: 0.788617
Epoch 5699 
Prediction Loss: 0.795774
Epoch 5749 
Prediction Loss: 0.805854
Epoch 5799 
Prediction Loss: 0.797702
Epoch 5849 
Prediction Loss: 0.783791
Epoch 5899 
Prediction Loss: 0.796562
Epoch 5949 
Prediction Loss: 0.807451
Epoch 5999 
Prediction Loss: 0.783535
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.878086
Insample Error 4.253480
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.474058
Rec Loss: 11.601903
KL Loss: 1.872154
Y Loss: 0.978851
T Loss: 11.112478
Epoch 99 
Overall Loss: 13.354108
Rec Loss: 11.343244
KL Loss: 2.010864
Y Loss: 0.954319
T Loss: 10.866084
Epoch 149 
Overall Loss: 13.299048
Rec Loss: 11.311115
KL Loss: 1.987934
Y Loss: 0.992145
T Loss: 10.815042
Epoch 199 
Overall Loss: 13.247364
Rec Loss: 11.180633
KL Loss: 2.066731
Y Loss: 0.979185
T Loss: 10.691040
Epoch 249 
Overall Loss: 13.224165
Rec Loss: 10.996596
KL Loss: 2.227568
Y Loss: 0.991773
T Loss: 10.500710
Epoch 299 
Overall Loss: 13.197236
Rec Loss: 10.983302
KL Loss: 2.213934
Y Loss: 0.973066
T Loss: 10.496769
Epoch 349 
Overall Loss: 13.194621
Rec Loss: 10.969410
KL Loss: 2.225211
Y Loss: 0.990593
T Loss: 10.474113
Epoch 399 
Overall Loss: 13.177728
Rec Loss: 10.967944
KL Loss: 2.209783
Y Loss: 0.973954
T Loss: 10.480968
Epoch 449 
Overall Loss: 13.197007
Rec Loss: 10.983242
KL Loss: 2.213765
Y Loss: 0.986645
T Loss: 10.489920
Epoch 499 
Overall Loss: 13.160981
Rec Loss: 10.934285
KL Loss: 2.226696
Y Loss: 0.962161
T Loss: 10.453205
Epoch 549 
Overall Loss: 13.145628
Rec Loss: 10.956210
KL Loss: 2.189418
Y Loss: 0.981933
T Loss: 10.465244
Epoch 599 
Overall Loss: 13.149190
Rec Loss: 10.935558
KL Loss: 2.213632
Y Loss: 0.971401
T Loss: 10.449857
Epoch 649 
Overall Loss: 13.130140
Rec Loss: 10.927782
KL Loss: 2.202357
Y Loss: 0.966858
T Loss: 10.444354
Epoch 699 
Overall Loss: 13.127041
Rec Loss: 10.905848
KL Loss: 2.221193
Y Loss: 0.942280
T Loss: 10.434708
Epoch 749 
Overall Loss: 13.132737
Rec Loss: 10.930007
KL Loss: 2.202730
Y Loss: 0.969022
T Loss: 10.445496
Epoch 799 
Overall Loss: 13.144075
Rec Loss: 10.924848
KL Loss: 2.219226
Y Loss: 0.969247
T Loss: 10.440225
Epoch 849 
Overall Loss: 13.119210
Rec Loss: 10.907719
KL Loss: 2.211491
Y Loss: 0.945280
T Loss: 10.435079
Epoch 899 
Overall Loss: 13.132868
Rec Loss: 10.920661
KL Loss: 2.212208
Y Loss: 0.972391
T Loss: 10.434465
Epoch 949 
Overall Loss: 13.122374
Rec Loss: 10.901964
KL Loss: 2.220410
Y Loss: 0.953074
T Loss: 10.425427
Epoch 999 
Overall Loss: 13.100776
Rec Loss: 10.905376
KL Loss: 2.195399
Y Loss: 0.968528
T Loss: 10.421112
Epoch 1049 
Overall Loss: 13.101690
Rec Loss: 10.900168
KL Loss: 2.201522
Y Loss: 0.954963
T Loss: 10.422687
Epoch 1099 
Overall Loss: 13.116991
Rec Loss: 10.897292
KL Loss: 2.219699
Y Loss: 0.971574
T Loss: 10.411505
Epoch 1149 
Overall Loss: 13.103238
Rec Loss: 10.885753
KL Loss: 2.217484
Y Loss: 0.962400
T Loss: 10.404553
Epoch 1199 
Overall Loss: 13.107374
Rec Loss: 10.885021
KL Loss: 2.222353
Y Loss: 0.969607
T Loss: 10.400218
Epoch 1249 
Overall Loss: 13.117274
Rec Loss: 10.902047
KL Loss: 2.215227
Y Loss: 0.974152
T Loss: 10.414971
Epoch 1299 
Overall Loss: 13.102800
Rec Loss: 10.904727
KL Loss: 2.198073
Y Loss: 0.968541
T Loss: 10.420456
Epoch 1349 
Overall Loss: 13.113032
Rec Loss: 10.913918
KL Loss: 2.199114
Y Loss: 0.977627
T Loss: 10.425104
Epoch 1399 
Overall Loss: 13.082967
Rec Loss: 10.854135
KL Loss: 2.228832
Y Loss: 0.928329
T Loss: 10.389971
Epoch 1449 
Overall Loss: 13.086889
Rec Loss: 10.892487
KL Loss: 2.194403
Y Loss: 0.968262
T Loss: 10.408356
Epoch 1499 
Overall Loss: 13.050738
Rec Loss: 10.839169
KL Loss: 2.211569
Y Loss: 0.971984
T Loss: 10.353177
Epoch 1549 
Overall Loss: 13.071824
Rec Loss: 10.854517
KL Loss: 2.217307
Y Loss: 0.944686
T Loss: 10.382174
Epoch 1599 
Overall Loss: 13.062509
Rec Loss: 10.867584
KL Loss: 2.194925
Y Loss: 0.971669
T Loss: 10.381749
Epoch 1649 
Overall Loss: 13.069263
Rec Loss: 10.872863
KL Loss: 2.196400
Y Loss: 0.954410
T Loss: 10.395658
Epoch 1699 
Overall Loss: 13.064794
Rec Loss: 10.837633
KL Loss: 2.227160
Y Loss: 0.923185
T Loss: 10.376041
Epoch 1749 
Overall Loss: 13.078958
Rec Loss: 10.871693
KL Loss: 2.207264
Y Loss: 0.965284
T Loss: 10.389051
Epoch 1799 
Overall Loss: 13.049139
Rec Loss: 10.820321
KL Loss: 2.228818
Y Loss: 0.927467
T Loss: 10.356588
Epoch 1849 
Overall Loss: 13.047544
Rec Loss: 10.830237
KL Loss: 2.217306
Y Loss: 0.925402
T Loss: 10.367536
Epoch 1899 
Overall Loss: 13.052080
Rec Loss: 10.841896
KL Loss: 2.210184
Y Loss: 0.935376
T Loss: 10.374208
Epoch 1949 
Overall Loss: 13.028518
Rec Loss: 10.821884
KL Loss: 2.206634
Y Loss: 0.942429
T Loss: 10.350669
Epoch 1999 
Overall Loss: 13.066678
Rec Loss: 10.835587
KL Loss: 2.231091
Y Loss: 0.930796
T Loss: 10.370189
Epoch 2049 
Overall Loss: 13.029052
Rec Loss: 10.820859
KL Loss: 2.208194
Y Loss: 0.945976
T Loss: 10.347870
Epoch 2099 
Overall Loss: 13.073769
Rec Loss: 10.852607
KL Loss: 2.221163
Y Loss: 0.972141
T Loss: 10.366536
Epoch 2149 
Overall Loss: 13.042790
Rec Loss: 10.804962
KL Loss: 2.237829
Y Loss: 0.929980
T Loss: 10.339972
Epoch 2199 
Overall Loss: 13.026533
Rec Loss: 10.816118
KL Loss: 2.210415
Y Loss: 0.945476
T Loss: 10.343380
Epoch 2249 
Overall Loss: 13.027548
Rec Loss: 10.817737
KL Loss: 2.209811
Y Loss: 0.967458
T Loss: 10.334008
Epoch 2299 
Overall Loss: 13.012752
Rec Loss: 10.802332
KL Loss: 2.210420
Y Loss: 0.942172
T Loss: 10.331246
Epoch 2349 
Overall Loss: 13.018508
Rec Loss: 10.822383
KL Loss: 2.196126
Y Loss: 0.934948
T Loss: 10.354909
Epoch 2399 
Overall Loss: 13.028118
Rec Loss: 10.795697
KL Loss: 2.232421
Y Loss: 0.938494
T Loss: 10.326450
Epoch 2449 
Overall Loss: 13.013322
Rec Loss: 10.794670
KL Loss: 2.218652
Y Loss: 0.942336
T Loss: 10.323502
Epoch 2499 
Overall Loss: 13.025291
Rec Loss: 10.779560
KL Loss: 2.245731
Y Loss: 0.910074
T Loss: 10.324523
Epoch 2549 
Overall Loss: 12.996158
Rec Loss: 10.803276
KL Loss: 2.192883
Y Loss: 0.940153
T Loss: 10.333199
Epoch 2599 
Overall Loss: 13.034207
Rec Loss: 10.804816
KL Loss: 2.229391
Y Loss: 0.948996
T Loss: 10.330318
Epoch 2649 
Overall Loss: 12.997582
Rec Loss: 10.781659
KL Loss: 2.215923
Y Loss: 0.951351
T Loss: 10.305983
Epoch 2699 
Overall Loss: 13.004007
Rec Loss: 10.804954
KL Loss: 2.199053
Y Loss: 0.949303
T Loss: 10.330302
Epoch 2749 
Overall Loss: 13.007007
Rec Loss: 10.793243
KL Loss: 2.213764
Y Loss: 0.940175
T Loss: 10.323156
Epoch 2799 
Overall Loss: 12.982637
Rec Loss: 10.758625
KL Loss: 2.224012
Y Loss: 0.908796
T Loss: 10.304227
Epoch 2849 
Overall Loss: 12.993021
Rec Loss: 10.754540
KL Loss: 2.238482
Y Loss: 0.915012
T Loss: 10.297033
Epoch 2899 
Overall Loss: 12.989750
Rec Loss: 10.759003
KL Loss: 2.230747
Y Loss: 0.931659
T Loss: 10.293173
Epoch 2949 
Overall Loss: 12.967456
Rec Loss: 10.793684
KL Loss: 2.173772
Y Loss: 0.921488
T Loss: 10.332940
Epoch 2999 
Overall Loss: 12.966971
Rec Loss: 10.757249
KL Loss: 2.209723
Y Loss: 0.933653
T Loss: 10.290422
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.072249
Epoch 99
Rec Loss: 2.063309
Epoch 149
Rec Loss: 2.056356
Epoch 199
Rec Loss: 2.043748
Epoch 249
Rec Loss: 2.056757
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.932037
Epoch 99
Rec Loss: 9.946996
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.633712
Insample Error: 1.935477
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.318033
Rec Loss: 19.788751
KL Loss: 2.529283
Y Loss: 11.721370
T Loss: 13.139239
X Loss: 0.788827
Epoch 99 
Overall Loss: 16.304273
Rec Loss: 13.056062
KL Loss: 3.248211
Y Loss: 3.837760
T Loss: 12.937378
X Loss: -1.800197
Epoch 149 
Overall Loss: 15.204984
Rec Loss: 11.924763
KL Loss: 3.280220
Y Loss: 2.687418
T Loss: 12.997129
X Loss: -2.416074
Epoch 199 
Overall Loss: 14.506274
Rec Loss: 11.061975
KL Loss: 3.444299
Y Loss: 1.945838
T Loss: 12.779317
X Loss: -2.690260
Epoch 249 
Overall Loss: 14.067074
Rec Loss: 10.489441
KL Loss: 3.577633
Y Loss: 1.424023
T Loss: 12.656003
X Loss: -2.878573
Epoch 299 
Overall Loss: 13.876055
Rec Loss: 10.229480
KL Loss: 3.646575
Y Loss: 1.188953
T Loss: 12.653047
X Loss: -3.018044
Epoch 349 
Overall Loss: 13.772970
Rec Loss: 10.060922
KL Loss: 3.712048
Y Loss: 1.154347
T Loss: 12.610270
X Loss: -3.126521
Epoch 399 
Overall Loss: 13.570350
Rec Loss: 9.699550
KL Loss: 3.870800
Y Loss: 1.080672
T Loss: 12.419007
X Loss: -3.259793
Epoch 449 
Overall Loss: 13.332181
Rec Loss: 9.164284
KL Loss: 4.167897
Y Loss: 1.031995
T Loss: 11.978065
X Loss: -3.329779
Epoch 499 
Overall Loss: 13.205580
Rec Loss: 8.926055
KL Loss: 4.279525
Y Loss: 1.003193
T Loss: 11.769025
X Loss: -3.344567
Epoch 549 
Overall Loss: 13.149000
Rec Loss: 8.798780
KL Loss: 4.350220
Y Loss: 0.995946
T Loss: 11.700692
X Loss: -3.399884
Epoch 599 
Overall Loss: 13.102794
Rec Loss: 8.711207
KL Loss: 4.391587
Y Loss: 1.006264
T Loss: 11.627019
X Loss: -3.418944
Epoch 649 
Overall Loss: 13.057805
Rec Loss: 8.588876
KL Loss: 4.468928
Y Loss: 1.027529
T Loss: 11.542470
X Loss: -3.467358
Epoch 699 
Overall Loss: 12.974208
Rec Loss: 8.407451
KL Loss: 4.566757
Y Loss: 0.981177
T Loss: 11.442241
X Loss: -3.525378
Epoch 749 
Overall Loss: 12.968506
Rec Loss: 8.345249
KL Loss: 4.623257
Y Loss: 1.026380
T Loss: 11.376896
X Loss: -3.544837
Epoch 799 
Overall Loss: 12.908073
Rec Loss: 8.219571
KL Loss: 4.688502
Y Loss: 0.999995
T Loss: 11.298889
X Loss: -3.579315
Epoch 849 
Overall Loss: 12.917044
Rec Loss: 8.169996
KL Loss: 4.747048
Y Loss: 1.014987
T Loss: 11.252993
X Loss: -3.590490
Epoch 899 
Overall Loss: 12.884490
Rec Loss: 8.108025
KL Loss: 4.776464
Y Loss: 0.957928
T Loss: 11.227447
X Loss: -3.598386
Epoch 949 
Overall Loss: 12.837521
Rec Loss: 8.064663
KL Loss: 4.772858
Y Loss: 0.981607
T Loss: 11.178508
X Loss: -3.604649
Epoch 999 
Overall Loss: 12.861416
Rec Loss: 8.028310
KL Loss: 4.833106
Y Loss: 0.967136
T Loss: 11.153808
X Loss: -3.609066
Epoch 1049 
Overall Loss: 12.801080
Rec Loss: 7.960138
KL Loss: 4.840942
Y Loss: 0.939817
T Loss: 11.111717
X Loss: -3.621488
Epoch 1099 
Overall Loss: 12.832091
Rec Loss: 7.941639
KL Loss: 4.890452
Y Loss: 0.978635
T Loss: 11.112544
X Loss: -3.660223
Epoch 1149 
Overall Loss: 12.797328
Rec Loss: 7.866189
KL Loss: 4.931139
Y Loss: 0.934676
T Loss: 11.055698
X Loss: -3.656847
Epoch 1199 
Overall Loss: 12.788398
Rec Loss: 7.830689
KL Loss: 4.957709
Y Loss: 0.946091
T Loss: 11.017043
X Loss: -3.659399
Epoch 1249 
Overall Loss: 12.752263
Rec Loss: 7.782526
KL Loss: 4.969737
Y Loss: 0.959291
T Loss: 10.974716
X Loss: -3.671835
Epoch 1299 
Overall Loss: 12.735616
Rec Loss: 7.749365
KL Loss: 4.986251
Y Loss: 0.934656
T Loss: 10.972938
X Loss: -3.690902
Epoch 1349 
Overall Loss: 12.734843
Rec Loss: 7.723121
KL Loss: 5.011723
Y Loss: 0.954550
T Loss: 10.943988
X Loss: -3.698142
Epoch 1399 
Overall Loss: 12.740565
Rec Loss: 7.726582
KL Loss: 5.013982
Y Loss: 0.977732
T Loss: 10.952822
X Loss: -3.715106
Epoch 1449 
Overall Loss: 12.733797
Rec Loss: 7.688614
KL Loss: 5.045183
Y Loss: 0.958289
T Loss: 10.918457
X Loss: -3.708987
Epoch 1499 
Overall Loss: 12.712868
Rec Loss: 7.659566
KL Loss: 5.053302
Y Loss: 0.951382
T Loss: 10.912937
X Loss: -3.729062
Epoch 1549 
Overall Loss: 12.701103
Rec Loss: 7.641967
KL Loss: 5.059136
Y Loss: 0.966622
T Loss: 10.895075
X Loss: -3.736419
Epoch 1599 
Overall Loss: 12.698435
Rec Loss: 7.636914
KL Loss: 5.061521
Y Loss: 0.967623
T Loss: 10.889737
X Loss: -3.736635
Epoch 1649 
Overall Loss: 12.715247
Rec Loss: 7.636606
KL Loss: 5.078641
Y Loss: 0.969172
T Loss: 10.886898
X Loss: -3.734878
Epoch 1699 
Overall Loss: 12.702275
Rec Loss: 7.611972
KL Loss: 5.090303
Y Loss: 0.945609
T Loss: 10.877503
X Loss: -3.738336
Epoch 1749 
Overall Loss: 12.686584
Rec Loss: 7.615559
KL Loss: 5.071026
Y Loss: 0.948931
T Loss: 10.867430
X Loss: -3.726337
Epoch 1799 
Overall Loss: 12.652484
Rec Loss: 7.547127
KL Loss: 5.105358
Y Loss: 0.943100
T Loss: 10.849076
X Loss: -3.773500
Epoch 1849 
Overall Loss: 12.649110
Rec Loss: 7.580467
KL Loss: 5.068644
Y Loss: 0.971558
T Loss: 10.855198
X Loss: -3.760510
Epoch 1899 
Overall Loss: 12.698094
Rec Loss: 7.590273
KL Loss: 5.107822
Y Loss: 0.941231
T Loss: 10.869754
X Loss: -3.750097
Epoch 1949 
Overall Loss: 12.666921
Rec Loss: 7.554639
KL Loss: 5.112282
Y Loss: 0.958463
T Loss: 10.855995
X Loss: -3.780587
Epoch 1999 
Overall Loss: 12.682988
Rec Loss: 7.574639
KL Loss: 5.108349
Y Loss: 0.967764
T Loss: 10.861310
X Loss: -3.770554
Epoch 2049 
Overall Loss: 12.662097
Rec Loss: 7.565143
KL Loss: 5.096954
Y Loss: 0.948832
T Loss: 10.871640
X Loss: -3.780913
Epoch 2099 
Overall Loss: 12.644788
Rec Loss: 7.554813
KL Loss: 5.089974
Y Loss: 0.968466
T Loss: 10.832337
X Loss: -3.761757
Epoch 2149 
Overall Loss: 12.648691
Rec Loss: 7.561595
KL Loss: 5.087096
Y Loss: 0.958546
T Loss: 10.874618
X Loss: -3.792296
Epoch 2199 
Overall Loss: 12.664255
Rec Loss: 7.558586
KL Loss: 5.105669
Y Loss: 0.973788
T Loss: 10.855963
X Loss: -3.784271
Epoch 2249 
Overall Loss: 12.624714
Rec Loss: 7.545765
KL Loss: 5.078949
Y Loss: 0.973502
T Loss: 10.837222
X Loss: -3.778207
Epoch 2299 
Overall Loss: 12.657960
Rec Loss: 7.537701
KL Loss: 5.120260
Y Loss: 0.933534
T Loss: 10.866088
X Loss: -3.795154
Epoch 2349 
Overall Loss: 12.648920
Rec Loss: 7.549546
KL Loss: 5.099374
Y Loss: 0.945222
T Loss: 10.862326
X Loss: -3.785391
Epoch 2399 
Overall Loss: 12.641964
Rec Loss: 7.525685
KL Loss: 5.116279
Y Loss: 0.974993
T Loss: 10.857478
X Loss: -3.819289
Epoch 2449 
Overall Loss: 12.645017
Rec Loss: 7.515596
KL Loss: 5.129421
Y Loss: 0.946788
T Loss: 10.853622
X Loss: -3.811420
Epoch 2499 
Overall Loss: 12.637893
Rec Loss: 7.531933
KL Loss: 5.105960
Y Loss: 0.975268
T Loss: 10.851267
X Loss: -3.806968
Epoch 2549 
Overall Loss: 12.632449
Rec Loss: 7.513149
KL Loss: 5.119300
Y Loss: 0.962183
T Loss: 10.855637
X Loss: -3.823579
Epoch 2599 
Overall Loss: 12.649460
Rec Loss: 7.521110
KL Loss: 5.128350
Y Loss: 0.958592
T Loss: 10.850241
X Loss: -3.808427
Epoch 2649 
Overall Loss: 12.626492
Rec Loss: 7.517009
KL Loss: 5.109483
Y Loss: 0.961685
T Loss: 10.841183
X Loss: -3.805017
Epoch 2699 
Overall Loss: 12.617728
Rec Loss: 7.502379
KL Loss: 5.115349
Y Loss: 0.958438
T Loss: 10.840651
X Loss: -3.817491
Epoch 2749 
Overall Loss: 12.636607
Rec Loss: 7.502236
KL Loss: 5.134371
Y Loss: 0.950309
T Loss: 10.847154
X Loss: -3.820073
Epoch 2799 
Overall Loss: 12.639585
Rec Loss: 7.496110
KL Loss: 5.143476
Y Loss: 0.971062
T Loss: 10.854050
X Loss: -3.843471
Epoch 2849 
Overall Loss: 12.633598
Rec Loss: 7.486555
KL Loss: 5.147043
Y Loss: 0.943363
T Loss: 10.857682
X Loss: -3.842809
Epoch 2899 
Overall Loss: 12.652663
Rec Loss: 7.529448
KL Loss: 5.123215
Y Loss: 0.949976
T Loss: 10.849973
X Loss: -3.795514
Epoch 2949 
Overall Loss: 12.608017
Rec Loss: 7.461615
KL Loss: 5.146402
Y Loss: 0.949935
T Loss: 10.829157
X Loss: -3.842510
Epoch 2999 
Overall Loss: 12.631582
Rec Loss: 7.490441
KL Loss: 5.141141
Y Loss: 0.952205
T Loss: 10.850427
X Loss: -3.836088
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.333519
Epoch 99
Rec Loss: 2.330458
Epoch 149
Rec Loss: 2.342024
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.003515
Epoch 99
Rec Loss: 2.004603
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.565352
Insample Error 2.760348
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.590906
Epoch 99 
Prediction Loss: 3.377117
Epoch 149 
Prediction Loss: 3.337059
Epoch 199 
Prediction Loss: 3.203889
Epoch 249 
Prediction Loss: 2.950142
Epoch 299 
Prediction Loss: 2.811385
Epoch 349 
Prediction Loss: 2.655918
Epoch 399 
Prediction Loss: 2.492090
Epoch 449 
Prediction Loss: 2.381053
Epoch 499 
Prediction Loss: 2.269115
Epoch 549 
Prediction Loss: 2.182050
Epoch 599 
Prediction Loss: 2.058284
Epoch 649 
Prediction Loss: 2.012560
Epoch 699 
Prediction Loss: 1.926983
Epoch 749 
Prediction Loss: 1.862496
Epoch 799 
Prediction Loss: 1.790812
Epoch 849 
Prediction Loss: 1.748676
Epoch 899 
Prediction Loss: 1.735438
Epoch 949 
Prediction Loss: 1.640362
Epoch 999 
Prediction Loss: 1.638476
Epoch 1049 
Prediction Loss: 1.597589
Epoch 1099 
Prediction Loss: 1.536638
Epoch 1149 
Prediction Loss: 1.528345
Epoch 1199 
Prediction Loss: 1.518373
Epoch 1249 
Prediction Loss: 1.470155
Epoch 1299 
Prediction Loss: 1.455846
Epoch 1349 
Prediction Loss: 1.380838
Epoch 1399 
Prediction Loss: 1.386652
Epoch 1449 
Prediction Loss: 1.352973
Epoch 1499 
Prediction Loss: 1.357758
Epoch 1549 
Prediction Loss: 1.347137
Epoch 1599 
Prediction Loss: 1.313295
Epoch 1649 
Prediction Loss: 1.294946
Epoch 1699 
Prediction Loss: 1.260340
Epoch 1749 
Prediction Loss: 1.259354
Epoch 1799 
Prediction Loss: 1.215634
Epoch 1849 
Prediction Loss: 1.218364
Epoch 1899 
Prediction Loss: 1.182087
Epoch 1949 
Prediction Loss: 1.172799
Epoch 1999 
Prediction Loss: 1.185159
Epoch 2049 
Prediction Loss: 1.147698
Epoch 2099 
Prediction Loss: 1.133800
Epoch 2149 
Prediction Loss: 1.187009
Epoch 2199 
Prediction Loss: 1.126820
Epoch 2249 
Prediction Loss: 1.137903
Epoch 2299 
Prediction Loss: 1.141067
Epoch 2349 
Prediction Loss: 1.095168
Epoch 2399 
Prediction Loss: 1.102459
Epoch 2449 
Prediction Loss: 1.085012
Epoch 2499 
Prediction Loss: 1.095560
Epoch 2549 
Prediction Loss: 1.085377
Epoch 2599 
Prediction Loss: 1.118713
Epoch 2649 
Prediction Loss: 1.073059
Epoch 2699 
Prediction Loss: 1.058082
Epoch 2749 
Prediction Loss: 1.060432
Epoch 2799 
Prediction Loss: 1.079525
Epoch 2849 
Prediction Loss: 1.048971
Epoch 2899 
Prediction Loss: 1.047898
Epoch 2949 
Prediction Loss: 1.035735
Epoch 2999 
Prediction Loss: 1.058397
Epoch 3049 
Prediction Loss: 1.032167
Epoch 3099 
Prediction Loss: 1.000355
Epoch 3149 
Prediction Loss: 1.000227
Epoch 3199 
Prediction Loss: 1.006984
Epoch 3249 
Prediction Loss: 1.010979
Epoch 3299 
Prediction Loss: 0.999646
Epoch 3349 
Prediction Loss: 1.045541
Epoch 3399 
Prediction Loss: 1.004178
Epoch 3449 
Prediction Loss: 0.992409
Epoch 3499 
Prediction Loss: 1.073416
Epoch 3549 
Prediction Loss: 0.986899
Epoch 3599 
Prediction Loss: 0.978141
Epoch 3649 
Prediction Loss: 0.969344
Epoch 3699 
Prediction Loss: 0.994900
Epoch 3749 
Prediction Loss: 0.965722
Epoch 3799 
Prediction Loss: 0.972792
Epoch 3849 
Prediction Loss: 0.989965
Epoch 3899 
Prediction Loss: 0.980390
Epoch 3949 
Prediction Loss: 0.992952
Epoch 3999 
Prediction Loss: 0.975462
Epoch 4049 
Prediction Loss: 0.965415
Epoch 4099 
Prediction Loss: 0.956139
Epoch 4149 
Prediction Loss: 0.965830
Epoch 4199 
Prediction Loss: 0.963043
Epoch 4249 
Prediction Loss: 0.973917
Epoch 4299 
Prediction Loss: 0.966858
Epoch 4349 
Prediction Loss: 0.964343
Epoch 4399 
Prediction Loss: 0.953528
Epoch 4449 
Prediction Loss: 0.946772
Epoch 4499 
Prediction Loss: 0.937256
Epoch 4549 
Prediction Loss: 0.945242
Epoch 4599 
Prediction Loss: 0.919958
Epoch 4649 
Prediction Loss: 0.931205
Epoch 4699 
Prediction Loss: 0.918631
Epoch 4749 
Prediction Loss: 0.921238
Epoch 4799 
Prediction Loss: 0.931343
Epoch 4849 
Prediction Loss: 0.901930
Epoch 4899 
Prediction Loss: 0.933747
Epoch 4949 
Prediction Loss: 0.899311
Epoch 4999 
Prediction Loss: 0.891507
Epoch 5049 
Prediction Loss: 0.898885
Epoch 5099 
Prediction Loss: 0.886156
Epoch 5149 
Prediction Loss: 0.898540
Epoch 5199 
Prediction Loss: 0.908223
Epoch 5249 
Prediction Loss: 0.919572
Epoch 5299 
Prediction Loss: 0.891602
Epoch 5349 
Prediction Loss: 0.876075
Epoch 5399 
Prediction Loss: 0.911606
Epoch 5449 
Prediction Loss: 0.892941
Epoch 5499 
Prediction Loss: 0.901492
Epoch 5549 
Prediction Loss: 0.886561
Epoch 5599 
Prediction Loss: 0.881392
Epoch 5649 
Prediction Loss: 0.875142
Epoch 5699 
Prediction Loss: 0.939207
Epoch 5749 
Prediction Loss: 0.881687
Epoch 5799 
Prediction Loss: 0.871799
Epoch 5849 
Prediction Loss: 0.863746
Epoch 5899 
Prediction Loss: 0.891346
Epoch 5949 
Prediction Loss: 0.876915
Epoch 5999 
Prediction Loss: 0.880640
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.931997
Insample Error 4.250547
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.489843
Rec Loss: 11.454079
KL Loss: 2.035764
Y Loss: 1.033982
T Loss: 10.937088
Epoch 99 
Overall Loss: 13.354257
Rec Loss: 11.331926
KL Loss: 2.022331
Y Loss: 0.976542
T Loss: 10.843654
Epoch 149 
Overall Loss: 13.326153
Rec Loss: 11.310415
KL Loss: 2.015738
Y Loss: 0.978671
T Loss: 10.821080
Epoch 199 
Overall Loss: 13.270306
Rec Loss: 11.042130
KL Loss: 2.228175
Y Loss: 0.969960
T Loss: 10.557150
Epoch 249 
Overall Loss: 13.233280
Rec Loss: 10.983181
KL Loss: 2.250099
Y Loss: 0.974796
T Loss: 10.495783
Epoch 299 
Overall Loss: 13.228593
Rec Loss: 10.971290
KL Loss: 2.257304
Y Loss: 0.995005
T Loss: 10.473787
Epoch 349 
Overall Loss: 13.194689
Rec Loss: 10.981519
KL Loss: 2.213171
Y Loss: 0.996520
T Loss: 10.483259
Epoch 399 
Overall Loss: 13.201081
Rec Loss: 10.965114
KL Loss: 2.235967
Y Loss: 0.986422
T Loss: 10.471903
Epoch 449 
Overall Loss: 13.208982
Rec Loss: 10.990792
KL Loss: 2.218190
Y Loss: 0.995077
T Loss: 10.493253
Epoch 499 
Overall Loss: 13.163497
Rec Loss: 10.940198
KL Loss: 2.223299
Y Loss: 0.950784
T Loss: 10.464806
Epoch 549 
Overall Loss: 13.194064
Rec Loss: 10.939489
KL Loss: 2.254575
Y Loss: 0.970122
T Loss: 10.454428
Epoch 599 
Overall Loss: 13.174314
Rec Loss: 10.946305
KL Loss: 2.228010
Y Loss: 0.971499
T Loss: 10.460555
Epoch 649 
Overall Loss: 13.152628
Rec Loss: 10.925286
KL Loss: 2.227342
Y Loss: 0.963954
T Loss: 10.443309
Epoch 699 
Overall Loss: 13.146489
Rec Loss: 10.902320
KL Loss: 2.244169
Y Loss: 0.967124
T Loss: 10.418758
Epoch 749 
Overall Loss: 13.149308
Rec Loss: 10.931553
KL Loss: 2.217755
Y Loss: 0.972405
T Loss: 10.445350
Epoch 799 
Overall Loss: 13.130316
Rec Loss: 10.897819
KL Loss: 2.232498
Y Loss: 0.943572
T Loss: 10.426033
Epoch 849 
Overall Loss: 13.132697
Rec Loss: 10.921756
KL Loss: 2.210942
Y Loss: 0.984229
T Loss: 10.429641
Epoch 899 
Overall Loss: 13.116850
Rec Loss: 10.919377
KL Loss: 2.197473
Y Loss: 0.956478
T Loss: 10.441138
Epoch 949 
Overall Loss: 13.118191
Rec Loss: 10.898526
KL Loss: 2.219665
Y Loss: 0.961530
T Loss: 10.417761
Epoch 999 
Overall Loss: 13.107672
Rec Loss: 10.884038
KL Loss: 2.223635
Y Loss: 0.968370
T Loss: 10.399853
Epoch 1049 
Overall Loss: 13.116064
Rec Loss: 10.907784
KL Loss: 2.208280
Y Loss: 0.969173
T Loss: 10.423197
Epoch 1099 
Overall Loss: 13.104844
Rec Loss: 10.871023
KL Loss: 2.233821
Y Loss: 0.944221
T Loss: 10.398913
Epoch 1149 
Overall Loss: 13.088418
Rec Loss: 10.857408
KL Loss: 2.231010
Y Loss: 0.927879
T Loss: 10.393469
Epoch 1199 
Overall Loss: 13.088884
Rec Loss: 10.855718
KL Loss: 2.233166
Y Loss: 0.940576
T Loss: 10.385431
Epoch 1249 
Overall Loss: 13.108030
Rec Loss: 10.870798
KL Loss: 2.237232
Y Loss: 0.935941
T Loss: 10.402827
Epoch 1299 
Overall Loss: 13.101632
Rec Loss: 10.889465
KL Loss: 2.212168
Y Loss: 0.964565
T Loss: 10.407182
Epoch 1349 
Overall Loss: 13.079490
Rec Loss: 10.853020
KL Loss: 2.226470
Y Loss: 0.943150
T Loss: 10.381445
Epoch 1399 
Overall Loss: 13.076402
Rec Loss: 10.859189
KL Loss: 2.217213
Y Loss: 0.964891
T Loss: 10.376743
Epoch 1449 
Overall Loss: 13.070970
Rec Loss: 10.868139
KL Loss: 2.202830
Y Loss: 0.940621
T Loss: 10.397829
Epoch 1499 
Overall Loss: 13.088230
Rec Loss: 10.879294
KL Loss: 2.208935
Y Loss: 0.967995
T Loss: 10.395297
Epoch 1549 
Overall Loss: 13.084869
Rec Loss: 10.881433
KL Loss: 2.203436
Y Loss: 0.958871
T Loss: 10.401998
Epoch 1599 
Overall Loss: 13.039038
Rec Loss: 10.859275
KL Loss: 2.179763
Y Loss: 0.952000
T Loss: 10.383275
Epoch 1649 
Overall Loss: 13.066931
Rec Loss: 10.882918
KL Loss: 2.184014
Y Loss: 0.936559
T Loss: 10.414638
Epoch 1699 
Overall Loss: 13.065920
Rec Loss: 10.853824
KL Loss: 2.212097
Y Loss: 0.977745
T Loss: 10.364951
Epoch 1749 
Overall Loss: 13.066942
Rec Loss: 10.871526
KL Loss: 2.195416
Y Loss: 0.970627
T Loss: 10.386213
Epoch 1799 
Overall Loss: 13.049349
Rec Loss: 10.854921
KL Loss: 2.194428
Y Loss: 0.969312
T Loss: 10.370265
Epoch 1849 
Overall Loss: 13.036724
Rec Loss: 10.837372
KL Loss: 2.199352
Y Loss: 0.954416
T Loss: 10.360164
Epoch 1899 
Overall Loss: 13.035070
Rec Loss: 10.827609
KL Loss: 2.207461
Y Loss: 0.949467
T Loss: 10.352876
Epoch 1949 
Overall Loss: 13.043330
Rec Loss: 10.815735
KL Loss: 2.227595
Y Loss: 0.924054
T Loss: 10.353708
Epoch 1999 
Overall Loss: 13.028651
Rec Loss: 10.824741
KL Loss: 2.203910
Y Loss: 0.950471
T Loss: 10.349505
Epoch 2049 
Overall Loss: 13.014275
Rec Loss: 10.808908
KL Loss: 2.205367
Y Loss: 0.967206
T Loss: 10.325305
Epoch 2099 
Overall Loss: 13.028204
Rec Loss: 10.821796
KL Loss: 2.206409
Y Loss: 0.941142
T Loss: 10.351225
Epoch 2149 
Overall Loss: 13.031042
Rec Loss: 10.839575
KL Loss: 2.191467
Y Loss: 0.946434
T Loss: 10.366358
Epoch 2199 
Overall Loss: 13.034944
Rec Loss: 10.841303
KL Loss: 2.193641
Y Loss: 0.944376
T Loss: 10.369115
Epoch 2249 
Overall Loss: 13.030992
Rec Loss: 10.814145
KL Loss: 2.216847
Y Loss: 0.921431
T Loss: 10.353429
Epoch 2299 
Overall Loss: 13.025682
Rec Loss: 10.811535
KL Loss: 2.214146
Y Loss: 0.950859
T Loss: 10.336106
Epoch 2349 
Overall Loss: 13.024299
Rec Loss: 10.800062
KL Loss: 2.224237
Y Loss: 0.918742
T Loss: 10.340691
Epoch 2399 
Overall Loss: 13.004968
Rec Loss: 10.800807
KL Loss: 2.204162
Y Loss: 0.953582
T Loss: 10.324015
Epoch 2449 
Overall Loss: 12.992042
Rec Loss: 10.822662
KL Loss: 2.169380
Y Loss: 0.939087
T Loss: 10.353118
Epoch 2499 
Overall Loss: 13.011843
Rec Loss: 10.801784
KL Loss: 2.210059
Y Loss: 0.927860
T Loss: 10.337854
Epoch 2549 
Overall Loss: 13.014661
Rec Loss: 10.825087
KL Loss: 2.189573
Y Loss: 0.944134
T Loss: 10.353020
Epoch 2599 
Overall Loss: 13.001452
Rec Loss: 10.782026
KL Loss: 2.219426
Y Loss: 0.927371
T Loss: 10.318341
Epoch 2649 
Overall Loss: 13.005651
Rec Loss: 10.808704
KL Loss: 2.196947
Y Loss: 0.947692
T Loss: 10.334859
Epoch 2699 
Overall Loss: 12.998371
Rec Loss: 10.775375
KL Loss: 2.222996
Y Loss: 0.931154
T Loss: 10.309798
Epoch 2749 
Overall Loss: 12.971213
Rec Loss: 10.776361
KL Loss: 2.194852
Y Loss: 0.961241
T Loss: 10.295740
Epoch 2799 
Overall Loss: 12.985653
Rec Loss: 10.796498
KL Loss: 2.189155
Y Loss: 0.941886
T Loss: 10.325554
Epoch 2849 
Overall Loss: 12.977755
Rec Loss: 10.768036
KL Loss: 2.209720
Y Loss: 0.931676
T Loss: 10.302198
Epoch 2899 
Overall Loss: 13.002445
Rec Loss: 10.816437
KL Loss: 2.186008
Y Loss: 0.961162
T Loss: 10.335855
Epoch 2949 
Overall Loss: 12.964818
Rec Loss: 10.762263
KL Loss: 2.202555
Y Loss: 0.925805
T Loss: 10.299360
Epoch 2999 
Overall Loss: 12.973289
Rec Loss: 10.785593
KL Loss: 2.187696
Y Loss: 0.925741
T Loss: 10.322723
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.064096
Epoch 99
Rec Loss: 2.056329
Epoch 149
Rec Loss: 2.046122
Epoch 199
Rec Loss: 2.037095
Epoch 249
Rec Loss: 2.048912
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.954511
Epoch 99
Rec Loss: 9.926878
Epoch 149
Rec Loss: 9.903782
Epoch 199
Rec Loss: 9.906638
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.628539
Insample Error: 2.037058
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.426249
Rec Loss: 19.836473
KL Loss: 2.589776
Y Loss: 11.433912
T Loss: 13.164929
X Loss: 0.954588
Epoch 99 
Overall Loss: 16.554341
Rec Loss: 13.220877
KL Loss: 3.333464
Y Loss: 3.361076
T Loss: 12.903188
X Loss: -1.362849
Epoch 149 
Overall Loss: 15.094475
Rec Loss: 11.673343
KL Loss: 3.421132
Y Loss: 2.044088
T Loss: 12.824136
X Loss: -2.172837
Epoch 199 
Overall Loss: 14.152092
Rec Loss: 10.286088
KL Loss: 3.866004
Y Loss: 1.348349
T Loss: 12.472843
X Loss: -2.860929
Epoch 249 
Overall Loss: 13.825949
Rec Loss: 9.792956
KL Loss: 4.032992
Y Loss: 1.149557
T Loss: 12.309033
X Loss: -3.090855
Epoch 299 
Overall Loss: 13.591091
Rec Loss: 9.454824
KL Loss: 4.136266
Y Loss: 1.112219
T Loss: 12.147705
X Loss: -3.248990
Epoch 349 
Overall Loss: 13.430574
Rec Loss: 9.201882
KL Loss: 4.228691
Y Loss: 1.102192
T Loss: 12.008042
X Loss: -3.357256
Epoch 399 
Overall Loss: 13.339594
Rec Loss: 9.021163
KL Loss: 4.318431
Y Loss: 1.056060
T Loss: 11.923284
X Loss: -3.430152
Epoch 449 
Overall Loss: 13.263026
Rec Loss: 8.933282
KL Loss: 4.329744
Y Loss: 1.036858
T Loss: 11.872861
X Loss: -3.458007
Epoch 499 
Overall Loss: 13.239506
Rec Loss: 8.879023
KL Loss: 4.360482
Y Loss: 0.996437
T Loss: 11.862473
X Loss: -3.481668
Epoch 549 
Overall Loss: 13.196736
Rec Loss: 8.808181
KL Loss: 4.388554
Y Loss: 0.987382
T Loss: 11.815607
X Loss: -3.501116
Epoch 599 
Overall Loss: 13.158205
Rec Loss: 8.763945
KL Loss: 4.394260
Y Loss: 0.953645
T Loss: 11.780177
X Loss: -3.493054
Epoch 649 
Overall Loss: 13.135303
Rec Loss: 8.719875
KL Loss: 4.415427
Y Loss: 0.962421
T Loss: 11.731180
X Loss: -3.492515
Epoch 699 
Overall Loss: 13.037196
Rec Loss: 8.522421
KL Loss: 4.514775
Y Loss: 0.973026
T Loss: 11.579395
X Loss: -3.543487
Epoch 749 
Overall Loss: 12.976366
Rec Loss: 8.318306
KL Loss: 4.658060
Y Loss: 0.960756
T Loss: 11.400665
X Loss: -3.562737
Epoch 799 
Overall Loss: 12.897302
Rec Loss: 8.172977
KL Loss: 4.724325
Y Loss: 0.944313
T Loss: 11.288792
X Loss: -3.587972
Epoch 849 
Overall Loss: 12.914529
Rec Loss: 8.127839
KL Loss: 4.786690
Y Loss: 0.949880
T Loss: 11.246235
X Loss: -3.593336
Epoch 899 
Overall Loss: 12.866831
Rec Loss: 8.054469
KL Loss: 4.812362
Y Loss: 0.934512
T Loss: 11.208059
X Loss: -3.620846
Epoch 949 
Overall Loss: 12.864005
Rec Loss: 8.058772
KL Loss: 4.805233
Y Loss: 0.934180
T Loss: 11.204136
X Loss: -3.612454
Epoch 999 
Overall Loss: 12.837688
Rec Loss: 8.054290
KL Loss: 4.783398
Y Loss: 0.952515
T Loss: 11.195544
X Loss: -3.617511
Epoch 1049 
Overall Loss: 12.832295
Rec Loss: 8.025898
KL Loss: 4.806397
Y Loss: 0.936557
T Loss: 11.183207
X Loss: -3.625588
Epoch 1099 
Overall Loss: 12.815776
Rec Loss: 7.995376
KL Loss: 4.820400
Y Loss: 0.928664
T Loss: 11.175812
X Loss: -3.644768
Epoch 1149 
Overall Loss: 12.806932
Rec Loss: 7.977449
KL Loss: 4.829484
Y Loss: 0.948248
T Loss: 11.167803
X Loss: -3.664479
Epoch 1199 
Overall Loss: 12.802727
Rec Loss: 7.979161
KL Loss: 4.823566
Y Loss: 0.935342
T Loss: 11.175011
X Loss: -3.663521
Epoch 1249 
Overall Loss: 12.819929
Rec Loss: 8.003837
KL Loss: 4.816093
Y Loss: 0.961056
T Loss: 11.180469
X Loss: -3.657160
Epoch 1299 
Overall Loss: 12.811818
Rec Loss: 8.009843
KL Loss: 4.801974
Y Loss: 0.988074
T Loss: 11.158727
X Loss: -3.642920
Epoch 1349 
Overall Loss: 12.771402
Rec Loss: 7.958648
KL Loss: 4.812754
Y Loss: 0.937040
T Loss: 11.160922
X Loss: -3.670793
Epoch 1399 
Overall Loss: 12.803193
Rec Loss: 7.994244
KL Loss: 4.808949
Y Loss: 0.960422
T Loss: 11.179789
X Loss: -3.665756
Epoch 1449 
Overall Loss: 12.771565
Rec Loss: 7.958246
KL Loss: 4.813319
Y Loss: 0.966247
T Loss: 11.175948
X Loss: -3.700825
Epoch 1499 
Overall Loss: 12.788989
Rec Loss: 7.959050
KL Loss: 4.829939
Y Loss: 0.952745
T Loss: 11.171741
X Loss: -3.689063
Epoch 1549 
Overall Loss: 12.784673
Rec Loss: 7.967980
KL Loss: 4.816694
Y Loss: 0.963958
T Loss: 11.172955
X Loss: -3.686955
Epoch 1599 
Overall Loss: 12.755881
Rec Loss: 7.961997
KL Loss: 4.793883
Y Loss: 0.952967
T Loss: 11.152065
X Loss: -3.666552
Epoch 1649 
Overall Loss: 12.759258
Rec Loss: 7.917312
KL Loss: 4.841946
Y Loss: 0.946984
T Loss: 11.160548
X Loss: -3.716729
Epoch 1699 
Overall Loss: 12.751637
Rec Loss: 7.930465
KL Loss: 4.821172
Y Loss: 0.950895
T Loss: 11.161579
X Loss: -3.706562
Epoch 1749 
Overall Loss: 12.762751
Rec Loss: 7.943418
KL Loss: 4.819333
Y Loss: 0.972980
T Loss: 11.161730
X Loss: -3.704802
Epoch 1799 
Overall Loss: 12.736418
Rec Loss: 7.909037
KL Loss: 4.827381
Y Loss: 0.939613
T Loss: 11.164992
X Loss: -3.725762
Epoch 1849 
Overall Loss: 12.744283
Rec Loss: 7.920820
KL Loss: 4.823464
Y Loss: 0.949091
T Loss: 11.155568
X Loss: -3.709294
Epoch 1899 
Overall Loss: 12.728402
Rec Loss: 7.902337
KL Loss: 4.826065
Y Loss: 0.935847
T Loss: 11.148102
X Loss: -3.713689
Epoch 1949 
Overall Loss: 12.746191
Rec Loss: 7.925253
KL Loss: 4.820938
Y Loss: 0.983338
T Loss: 11.140759
X Loss: -3.707176
Epoch 1999 
Overall Loss: 12.713911
Rec Loss: 7.868551
KL Loss: 4.845361
Y Loss: 0.934909
T Loss: 11.131718
X Loss: -3.730622
Epoch 2049 
Overall Loss: 12.704343
Rec Loss: 7.840206
KL Loss: 4.864137
Y Loss: 0.943132
T Loss: 11.108326
X Loss: -3.739685
Epoch 2099 
Overall Loss: 12.700864
Rec Loss: 7.826146
KL Loss: 4.874718
Y Loss: 0.965860
T Loss: 11.087505
X Loss: -3.744289
Epoch 2149 
Overall Loss: 12.702407
Rec Loss: 7.805083
KL Loss: 4.897324
Y Loss: 0.960222
T Loss: 11.070256
X Loss: -3.745285
Epoch 2199 
Overall Loss: 12.691844
Rec Loss: 7.750048
KL Loss: 4.941796
Y Loss: 0.956488
T Loss: 11.004707
X Loss: -3.732903
Epoch 2249 
Overall Loss: 12.637647
Rec Loss: 7.644092
KL Loss: 4.993556
Y Loss: 0.951623
T Loss: 10.920828
X Loss: -3.752547
Epoch 2299 
Overall Loss: 12.676297
Rec Loss: 7.627414
KL Loss: 5.048883
Y Loss: 0.951587
T Loss: 10.901290
X Loss: -3.749669
Epoch 2349 
Overall Loss: 12.664625
Rec Loss: 7.607710
KL Loss: 5.056916
Y Loss: 0.967919
T Loss: 10.887241
X Loss: -3.763491
Epoch 2399 
Overall Loss: 12.654644
Rec Loss: 7.599332
KL Loss: 5.055312
Y Loss: 0.978435
T Loss: 10.859526
X Loss: -3.749412
Epoch 2449 
Overall Loss: 12.642643
Rec Loss: 7.579457
KL Loss: 5.063186
Y Loss: 0.967362
T Loss: 10.835306
X Loss: -3.739530
Epoch 2499 
Overall Loss: 12.637157
Rec Loss: 7.596673
KL Loss: 5.040484
Y Loss: 0.975059
T Loss: 10.852353
X Loss: -3.743209
Epoch 2549 
Overall Loss: 12.632679
Rec Loss: 7.572372
KL Loss: 5.060307
Y Loss: 0.973355
T Loss: 10.842358
X Loss: -3.756664
Epoch 2599 
Overall Loss: 12.640914
Rec Loss: 7.567230
KL Loss: 5.073684
Y Loss: 0.948961
T Loss: 10.855692
X Loss: -3.762943
Epoch 2649 
Overall Loss: 12.636277
Rec Loss: 7.557726
KL Loss: 5.078551
Y Loss: 0.946262
T Loss: 10.843213
X Loss: -3.758619
Epoch 2699 
Overall Loss: 12.670379
Rec Loss: 7.593866
KL Loss: 5.076513
Y Loss: 0.968675
T Loss: 10.857556
X Loss: -3.748028
Epoch 2749 
Overall Loss: 12.629493
Rec Loss: 7.565763
KL Loss: 5.063730
Y Loss: 0.952729
T Loss: 10.848180
X Loss: -3.758782
Epoch 2799 
Overall Loss: 12.612586
Rec Loss: 7.542073
KL Loss: 5.070512
Y Loss: 0.956535
T Loss: 10.840541
X Loss: -3.776735
Epoch 2849 
Overall Loss: 12.645907
Rec Loss: 7.597192
KL Loss: 5.048715
Y Loss: 0.980420
T Loss: 10.845628
X Loss: -3.738646
Epoch 2899 
Overall Loss: 12.635783
Rec Loss: 7.567934
KL Loss: 5.067849
Y Loss: 0.959899
T Loss: 10.848346
X Loss: -3.760362
Epoch 2949 
Overall Loss: 12.630779
Rec Loss: 7.560854
KL Loss: 5.069924
Y Loss: 0.952336
T Loss: 10.838399
X Loss: -3.753713
Epoch 2999 
Overall Loss: 12.626185
Rec Loss: 7.556720
KL Loss: 5.069465
Y Loss: 0.951680
T Loss: 10.831880
X Loss: -3.751000
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.390004
Epoch 99
Rec Loss: 2.384201
Epoch 149
Rec Loss: 2.371388
Epoch 199
Rec Loss: 2.392310
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.014496
Epoch 99
Rec Loss: 2.006591
Epoch 149
Rec Loss: 2.000022
Epoch 199
Rec Loss: 2.007598
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.571438
Insample Error 2.681668
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.588070
Epoch 99 
Prediction Loss: 3.326196
Epoch 149 
Prediction Loss: 3.173375
Epoch 199 
Prediction Loss: 3.092677
Epoch 249 
Prediction Loss: 2.883852
Epoch 299 
Prediction Loss: 2.750402
Epoch 349 
Prediction Loss: 2.652482
Epoch 399 
Prediction Loss: 2.507293
Epoch 449 
Prediction Loss: 2.420760
Epoch 499 
Prediction Loss: 2.321841
Epoch 549 
Prediction Loss: 2.212893
Epoch 599 
Prediction Loss: 2.086683
Epoch 649 
Prediction Loss: 2.034547
Epoch 699 
Prediction Loss: 1.910323
Epoch 749 
Prediction Loss: 1.830860
Epoch 799 
Prediction Loss: 1.782365
Epoch 849 
Prediction Loss: 1.699011
Epoch 899 
Prediction Loss: 1.667056
Epoch 949 
Prediction Loss: 1.570340
Epoch 999 
Prediction Loss: 1.527799
Epoch 1049 
Prediction Loss: 1.519010
Epoch 1099 
Prediction Loss: 1.492088
Epoch 1149 
Prediction Loss: 1.437370
Epoch 1199 
Prediction Loss: 1.438000
Epoch 1249 
Prediction Loss: 1.405872
Epoch 1299 
Prediction Loss: 1.371284
Epoch 1349 
Prediction Loss: 1.383226
Epoch 1399 
Prediction Loss: 1.347602
Epoch 1449 
Prediction Loss: 1.342280
Epoch 1499 
Prediction Loss: 1.309326
Epoch 1549 
Prediction Loss: 1.291571
Epoch 1599 
Prediction Loss: 1.240484
Epoch 1649 
Prediction Loss: 1.244295
Epoch 1699 
Prediction Loss: 1.227282
Epoch 1749 
Prediction Loss: 1.220246
Epoch 1799 
Prediction Loss: 1.192872
Epoch 1849 
Prediction Loss: 1.189205
Epoch 1899 
Prediction Loss: 1.189454
Epoch 1949 
Prediction Loss: 1.170030
Epoch 1999 
Prediction Loss: 1.143173
Epoch 2049 
Prediction Loss: 1.144843
Epoch 2099 
Prediction Loss: 1.126814
Epoch 2149 
Prediction Loss: 1.105776
Epoch 2199 
Prediction Loss: 1.115382
Epoch 2249 
Prediction Loss: 1.087958
Epoch 2299 
Prediction Loss: 1.081853
Epoch 2349 
Prediction Loss: 1.075739
Epoch 2399 
Prediction Loss: 1.070148
Epoch 2449 
Prediction Loss: 1.059390
Epoch 2499 
Prediction Loss: 1.060239
Epoch 2549 
Prediction Loss: 1.052820
Epoch 2599 
Prediction Loss: 1.080753
Epoch 2649 
Prediction Loss: 1.046011
Epoch 2699 
Prediction Loss: 1.022574
Epoch 2749 
Prediction Loss: 1.023397
Epoch 2799 
Prediction Loss: 1.033472
Epoch 2849 
Prediction Loss: 1.009910
Epoch 2899 
Prediction Loss: 1.028978
Epoch 2949 
Prediction Loss: 1.012598
Epoch 2999 
Prediction Loss: 1.015982
Epoch 3049 
Prediction Loss: 0.996595
Epoch 3099 
Prediction Loss: 1.000169
Epoch 3149 
Prediction Loss: 1.031260
Epoch 3199 
Prediction Loss: 0.982668
Epoch 3249 
Prediction Loss: 0.991870
Epoch 3299 
Prediction Loss: 0.980062
Epoch 3349 
Prediction Loss: 0.977484
Epoch 3399 
Prediction Loss: 0.974133
Epoch 3449 
Prediction Loss: 0.953738
Epoch 3499 
Prediction Loss: 0.953984
Epoch 3549 
Prediction Loss: 0.957352
Epoch 3599 
Prediction Loss: 0.960484
Epoch 3649 
Prediction Loss: 0.927997
Epoch 3699 
Prediction Loss: 0.929661
Epoch 3749 
Prediction Loss: 0.947700
Epoch 3799 
Prediction Loss: 0.954012
Epoch 3849 
Prediction Loss: 0.908346
Epoch 3899 
Prediction Loss: 0.921678
Epoch 3949 
Prediction Loss: 0.945520
Epoch 3999 
Prediction Loss: 0.933514
Epoch 4049 
Prediction Loss: 0.931486
Epoch 4099 
Prediction Loss: 0.915835
Epoch 4149 
Prediction Loss: 0.909683
Epoch 4199 
Prediction Loss: 0.965789
Epoch 4249 
Prediction Loss: 0.910134
Epoch 4299 
Prediction Loss: 0.898648
Epoch 4349 
Prediction Loss: 0.907657
Epoch 4399 
Prediction Loss: 0.926283
Epoch 4449 
Prediction Loss: 0.885291
Epoch 4499 
Prediction Loss: 0.872353
Epoch 4549 
Prediction Loss: 0.884887
Epoch 4599 
Prediction Loss: 0.875650
Epoch 4649 
Prediction Loss: 0.915642
Epoch 4699 
Prediction Loss: 0.874918
Epoch 4749 
Prediction Loss: 0.924689
Epoch 4799 
Prediction Loss: 0.872909
Epoch 4849 
Prediction Loss: 0.854475
Epoch 4899 
Prediction Loss: 0.873299
Epoch 4949 
Prediction Loss: 0.863292
Epoch 4999 
Prediction Loss: 0.917366
Epoch 5049 
Prediction Loss: 0.858106
Epoch 5099 
Prediction Loss: 0.900058
Epoch 5149 
Prediction Loss: 0.889057
Epoch 5199 
Prediction Loss: 0.874141
Epoch 5249 
Prediction Loss: 0.895759
Epoch 5299 
Prediction Loss: 0.938328
Epoch 5349 
Prediction Loss: 0.854423
Epoch 5399 
Prediction Loss: 0.889211
Epoch 5449 
Prediction Loss: 0.892428
Epoch 5499 
Prediction Loss: 0.848044
Epoch 5549 
Prediction Loss: 0.842144
Epoch 5599 
Prediction Loss: 0.877659
Epoch 5649 
Prediction Loss: 0.852793
Epoch 5699 
Prediction Loss: 0.843055
Epoch 5749 
Prediction Loss: 0.844623
Epoch 5799 
Prediction Loss: 0.886573
Epoch 5849 
Prediction Loss: 0.874890
Epoch 5899 
Prediction Loss: 0.851858
Epoch 5949 
Prediction Loss: 0.823567
Epoch 5999 
Prediction Loss: 0.851915
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.956121
Insample Error 4.142738
[31m========== repeat time 4 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.498010
Rec Loss: 11.725572
KL Loss: 1.772438
Y Loss: 1.030510
T Loss: 11.210317
Epoch 99 
Overall Loss: 13.393376
Rec Loss: 11.524176
KL Loss: 1.869200
Y Loss: 1.013367
T Loss: 11.017493
Epoch 149 
Overall Loss: 13.322781
Rec Loss: 11.330204
KL Loss: 1.992576
Y Loss: 0.969888
T Loss: 10.845261
Epoch 199 
Overall Loss: 13.308355
Rec Loss: 11.338426
KL Loss: 1.969929
Y Loss: 0.989553
T Loss: 10.843649
Epoch 249 
Overall Loss: 13.264607
Rec Loss: 11.317227
KL Loss: 1.947379
Y Loss: 0.977684
T Loss: 10.828385
Epoch 299 
Overall Loss: 13.257399
Rec Loss: 11.308357
KL Loss: 1.949042
Y Loss: 0.989844
T Loss: 10.813435
Epoch 349 
Overall Loss: 13.258457
Rec Loss: 11.280208
KL Loss: 1.978249
Y Loss: 0.962650
T Loss: 10.798883
Epoch 399 
Overall Loss: 13.159933
Rec Loss: 10.987405
KL Loss: 2.172528
Y Loss: 0.979820
T Loss: 10.497495
Epoch 449 
Overall Loss: 13.183136
Rec Loss: 10.977904
KL Loss: 2.205232
Y Loss: 0.988486
T Loss: 10.483661
Epoch 499 
Overall Loss: 13.168815
Rec Loss: 10.961480
KL Loss: 2.207335
Y Loss: 0.959825
T Loss: 10.481568
Epoch 549 
Overall Loss: 13.175375
Rec Loss: 10.954246
KL Loss: 2.221129
Y Loss: 0.973239
T Loss: 10.467626
Epoch 599 
Overall Loss: 13.178901
Rec Loss: 10.927520
KL Loss: 2.251382
Y Loss: 0.939285
T Loss: 10.457877
Epoch 649 
Overall Loss: 13.154647
Rec Loss: 10.917997
KL Loss: 2.236649
Y Loss: 0.930534
T Loss: 10.452730
Epoch 699 
Overall Loss: 13.145242
Rec Loss: 10.934211
KL Loss: 2.211031
Y Loss: 0.944439
T Loss: 10.461992
Epoch 749 
Overall Loss: 13.140540
Rec Loss: 10.940039
KL Loss: 2.200501
Y Loss: 0.953254
T Loss: 10.463412
Epoch 799 
Overall Loss: 13.123487
Rec Loss: 10.919279
KL Loss: 2.204207
Y Loss: 0.982759
T Loss: 10.427900
Epoch 849 
Overall Loss: 13.128064
Rec Loss: 10.916419
KL Loss: 2.211644
Y Loss: 0.948238
T Loss: 10.442300
Epoch 899 
Overall Loss: 13.124229
Rec Loss: 10.895980
KL Loss: 2.228249
Y Loss: 0.953530
T Loss: 10.419214
Epoch 949 
Overall Loss: 13.132751
Rec Loss: 10.924018
KL Loss: 2.208733
Y Loss: 0.952570
T Loss: 10.447734
Epoch 999 
Overall Loss: 13.119471
Rec Loss: 10.910136
KL Loss: 2.209335
Y Loss: 0.936113
T Loss: 10.442080
Epoch 1049 
Overall Loss: 13.118191
Rec Loss: 10.886244
KL Loss: 2.231947
Y Loss: 0.951145
T Loss: 10.410671
Epoch 1099 
Overall Loss: 13.076952
Rec Loss: 10.885315
KL Loss: 2.191637
Y Loss: 0.941451
T Loss: 10.414589
Epoch 1149 
Overall Loss: 13.119283
Rec Loss: 10.881660
KL Loss: 2.237623
Y Loss: 0.918055
T Loss: 10.422632
Epoch 1199 
Overall Loss: 13.092470
Rec Loss: 10.876419
KL Loss: 2.216051
Y Loss: 0.955153
T Loss: 10.398843
Epoch 1249 
Overall Loss: 13.072562
Rec Loss: 10.877430
KL Loss: 2.195132
Y Loss: 0.940636
T Loss: 10.407112
Epoch 1299 
Overall Loss: 13.090205
Rec Loss: 10.889566
KL Loss: 2.200639
Y Loss: 0.961429
T Loss: 10.408852
Epoch 1349 
Overall Loss: 13.090612
Rec Loss: 10.897739
KL Loss: 2.192873
Y Loss: 0.957401
T Loss: 10.419038
Epoch 1399 
Overall Loss: 13.080639
Rec Loss: 10.879273
KL Loss: 2.201366
Y Loss: 0.947809
T Loss: 10.405369
Epoch 1449 
Overall Loss: 13.056834
Rec Loss: 10.850863
KL Loss: 2.205970
Y Loss: 0.943605
T Loss: 10.379061
Epoch 1499 
Overall Loss: 13.052437
Rec Loss: 10.862485
KL Loss: 2.189951
Y Loss: 0.936907
T Loss: 10.394032
Epoch 1549 
Overall Loss: 13.050043
Rec Loss: 10.866993
KL Loss: 2.183050
Y Loss: 0.951082
T Loss: 10.391452
Epoch 1599 
Overall Loss: 13.073189
Rec Loss: 10.862692
KL Loss: 2.210497
Y Loss: 0.954060
T Loss: 10.385662
Epoch 1649 
Overall Loss: 13.049823
Rec Loss: 10.870768
KL Loss: 2.179055
Y Loss: 0.921045
T Loss: 10.410245
Epoch 1699 
Overall Loss: 13.052535
Rec Loss: 10.837416
KL Loss: 2.215119
Y Loss: 0.950671
T Loss: 10.362081
Epoch 1749 
Overall Loss: 13.057284
Rec Loss: 10.833771
KL Loss: 2.223512
Y Loss: 0.941269
T Loss: 10.363137
Epoch 1799 
Overall Loss: 13.069797
Rec Loss: 10.861568
KL Loss: 2.208229
Y Loss: 0.943505
T Loss: 10.389815
Epoch 1849 
Overall Loss: 13.055025
Rec Loss: 10.843020
KL Loss: 2.212005
Y Loss: 0.929870
T Loss: 10.378085
Epoch 1899 
Overall Loss: 13.036849
Rec Loss: 10.846101
KL Loss: 2.190748
Y Loss: 0.940171
T Loss: 10.376016
Epoch 1949 
Overall Loss: 13.046408
Rec Loss: 10.853449
KL Loss: 2.192958
Y Loss: 0.946415
T Loss: 10.380242
Epoch 1999 
Overall Loss: 13.039311
Rec Loss: 10.842539
KL Loss: 2.196773
Y Loss: 0.935961
T Loss: 10.374558
Epoch 2049 
Overall Loss: 13.043101
Rec Loss: 10.830322
KL Loss: 2.212780
Y Loss: 0.917412
T Loss: 10.371616
Epoch 2099 
Overall Loss: 13.040878
Rec Loss: 10.832014
KL Loss: 2.208864
Y Loss: 0.945505
T Loss: 10.359262
Epoch 2149 
Overall Loss: 13.027569
Rec Loss: 10.825715
KL Loss: 2.201854
Y Loss: 0.939119
T Loss: 10.356155
Epoch 2199 
Overall Loss: 12.998310
Rec Loss: 10.797833
KL Loss: 2.200476
Y Loss: 0.922014
T Loss: 10.336827
Epoch 2249 
Overall Loss: 13.007829
Rec Loss: 10.814391
KL Loss: 2.193439
Y Loss: 0.939942
T Loss: 10.344419
Epoch 2299 
Overall Loss: 13.041444
Rec Loss: 10.838314
KL Loss: 2.203130
Y Loss: 0.939541
T Loss: 10.368543
Epoch 2349 
Overall Loss: 13.021531
Rec Loss: 10.820831
KL Loss: 2.200700
Y Loss: 0.944588
T Loss: 10.348536
Epoch 2399 
Overall Loss: 13.031564
Rec Loss: 10.854056
KL Loss: 2.177509
Y Loss: 0.984000
T Loss: 10.362055
Epoch 2449 
Overall Loss: 13.001861
Rec Loss: 10.811422
KL Loss: 2.190439
Y Loss: 0.930014
T Loss: 10.346414
Epoch 2499 
Overall Loss: 12.999838
Rec Loss: 10.810401
KL Loss: 2.189437
Y Loss: 0.924090
T Loss: 10.348357
Epoch 2549 
Overall Loss: 12.999536
Rec Loss: 10.823193
KL Loss: 2.176343
Y Loss: 0.948863
T Loss: 10.348762
Epoch 2599 
Overall Loss: 13.005201
Rec Loss: 10.784311
KL Loss: 2.220891
Y Loss: 0.904530
T Loss: 10.332046
Epoch 2649 
Overall Loss: 13.005565
Rec Loss: 10.814755
KL Loss: 2.190810
Y Loss: 0.936214
T Loss: 10.346648
Epoch 2699 
Overall Loss: 12.972984
Rec Loss: 10.810048
KL Loss: 2.162936
Y Loss: 0.932063
T Loss: 10.344016
Epoch 2749 
Overall Loss: 12.976140
Rec Loss: 10.808471
KL Loss: 2.167670
Y Loss: 0.946251
T Loss: 10.335345
Epoch 2799 
Overall Loss: 12.952062
Rec Loss: 10.769534
KL Loss: 2.182527
Y Loss: 0.917785
T Loss: 10.310641
Epoch 2849 
Overall Loss: 12.961038
Rec Loss: 10.775071
KL Loss: 2.185967
Y Loss: 0.935582
T Loss: 10.307279
Epoch 2899 
Overall Loss: 12.967389
Rec Loss: 10.776329
KL Loss: 2.191060
Y Loss: 0.915588
T Loss: 10.318535
Epoch 2949 
Overall Loss: 12.955242
Rec Loss: 10.796994
KL Loss: 2.158248
Y Loss: 0.920322
T Loss: 10.336833
Epoch 2999 
Overall Loss: 12.993054
Rec Loss: 10.793478
KL Loss: 2.199576
Y Loss: 0.928510
T Loss: 10.329223
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.051168
Epoch 99
Rec Loss: 2.058887
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.928746
Epoch 99
Rec Loss: 9.926528
Epoch 149
Rec Loss: 9.922874
Epoch 199
Rec Loss: 9.915815
Epoch 249
Rec Loss: 9.916310
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.638436
Insample Error: 2.030411
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 20.885941
Rec Loss: 17.667614
KL Loss: 3.218327
Y Loss: 9.090661
T Loss: 12.883591
X Loss: 0.238693
Epoch 99 
Overall Loss: 16.104693
Rec Loss: 12.734851
KL Loss: 3.369841
Y Loss: 3.678009
T Loss: 12.876351
X Loss: -1.980504
Epoch 149 
Overall Loss: 14.735295
Rec Loss: 11.082900
KL Loss: 3.652396
Y Loss: 2.445449
T Loss: 12.544108
X Loss: -2.683933
Epoch 199 
Overall Loss: 14.081515
Rec Loss: 10.259172
KL Loss: 3.822343
Y Loss: 1.775154
T Loss: 12.355911
X Loss: -2.984315
Epoch 249 
Overall Loss: 13.753313
Rec Loss: 9.807113
KL Loss: 3.946200
Y Loss: 1.417542
T Loss: 12.240803
X Loss: -3.142461
Epoch 299 
Overall Loss: 13.509657
Rec Loss: 9.446378
KL Loss: 4.063279
Y Loss: 1.282496
T Loss: 12.110745
X Loss: -3.305615
Epoch 349 
Overall Loss: 13.392622
Rec Loss: 9.242676
KL Loss: 4.149947
Y Loss: 1.249587
T Loss: 12.007088
X Loss: -3.389205
Epoch 399 
Overall Loss: 13.273003
Rec Loss: 9.037437
KL Loss: 4.235565
Y Loss: 1.186205
T Loss: 11.932096
X Loss: -3.487762
Epoch 449 
Overall Loss: 13.216508
Rec Loss: 8.869416
KL Loss: 4.347091
Y Loss: 1.132022
T Loss: 11.862722
X Loss: -3.559317
Epoch 499 
Overall Loss: 13.138503
Rec Loss: 8.682711
KL Loss: 4.455792
Y Loss: 1.117667
T Loss: 11.742607
X Loss: -3.618729
Epoch 549 
Overall Loss: 13.031687
Rec Loss: 8.441022
KL Loss: 4.590665
Y Loss: 1.120529
T Loss: 11.541133
X Loss: -3.660376
Epoch 599 
Overall Loss: 13.001510
Rec Loss: 8.230017
KL Loss: 4.771493
Y Loss: 1.071913
T Loss: 11.390903
X Loss: -3.696843
Epoch 649 
Overall Loss: 12.928964
Rec Loss: 8.117158
KL Loss: 4.811805
Y Loss: 1.080197
T Loss: 11.325099
X Loss: -3.748039
Epoch 699 
Overall Loss: 12.884482
Rec Loss: 8.026354
KL Loss: 4.858127
Y Loss: 1.042958
T Loss: 11.269343
X Loss: -3.764468
Epoch 749 
Overall Loss: 12.874509
Rec Loss: 8.021972
KL Loss: 4.852538
Y Loss: 1.052271
T Loss: 11.253939
X Loss: -3.758102
Epoch 799 
Overall Loss: 12.869918
Rec Loss: 7.994494
KL Loss: 4.875424
Y Loss: 1.045951
T Loss: 11.249702
X Loss: -3.778183
Epoch 849 
Overall Loss: 12.854574
Rec Loss: 7.974293
KL Loss: 4.880281
Y Loss: 1.021391
T Loss: 11.250143
X Loss: -3.786545
Epoch 899 
Overall Loss: 12.869924
Rec Loss: 7.968573
KL Loss: 4.901351
Y Loss: 1.030467
T Loss: 11.212508
X Loss: -3.759168
Epoch 949 
Overall Loss: 12.832596
Rec Loss: 7.917576
KL Loss: 4.915020
Y Loss: 1.015502
T Loss: 11.208400
X Loss: -3.798575
Epoch 999 
Overall Loss: 12.826708
Rec Loss: 7.932941
KL Loss: 4.893768
Y Loss: 0.998439
T Loss: 11.217185
X Loss: -3.783464
Epoch 1049 
Overall Loss: 12.817809
Rec Loss: 7.935477
KL Loss: 4.882333
Y Loss: 1.003680
T Loss: 11.217907
X Loss: -3.784271
Epoch 1099 
Overall Loss: 12.775554
Rec Loss: 7.886527
KL Loss: 4.889027
Y Loss: 0.990877
T Loss: 11.198943
X Loss: -3.807854
Epoch 1149 
Overall Loss: 12.799052
Rec Loss: 7.903321
KL Loss: 4.895731
Y Loss: 0.992143
T Loss: 11.188970
X Loss: -3.781721
Epoch 1199 
Overall Loss: 12.801027
Rec Loss: 7.890344
KL Loss: 4.910684
Y Loss: 1.004878
T Loss: 11.195458
X Loss: -3.807554
Epoch 1249 
Overall Loss: 12.781557
Rec Loss: 7.888522
KL Loss: 4.893034
Y Loss: 0.987188
T Loss: 11.204219
X Loss: -3.809291
Epoch 1299 
Overall Loss: 12.770603
Rec Loss: 7.871417
KL Loss: 4.899186
Y Loss: 0.982597
T Loss: 11.183879
X Loss: -3.803760
Epoch 1349 
Overall Loss: 12.776048
Rec Loss: 7.896736
KL Loss: 4.879312
Y Loss: 0.994590
T Loss: 11.193712
X Loss: -3.794271
Epoch 1399 
Overall Loss: 12.743139
Rec Loss: 7.870687
KL Loss: 4.872452
Y Loss: 0.982101
T Loss: 11.185072
X Loss: -3.805435
Epoch 1449 
Overall Loss: 12.759002
Rec Loss: 7.849509
KL Loss: 4.909493
Y Loss: 0.955192
T Loss: 11.196374
X Loss: -3.824462
Epoch 1499 
Overall Loss: 12.753178
Rec Loss: 7.869398
KL Loss: 4.883780
Y Loss: 0.982556
T Loss: 11.189051
X Loss: -3.810931
Epoch 1549 
Overall Loss: 12.723214
Rec Loss: 7.833757
KL Loss: 4.889457
Y Loss: 0.955765
T Loss: 11.177558
X Loss: -3.821683
Epoch 1599 
Overall Loss: 12.756105
Rec Loss: 7.861897
KL Loss: 4.894208
Y Loss: 0.961334
T Loss: 11.173588
X Loss: -3.792358
Epoch 1649 
Overall Loss: 12.719542
Rec Loss: 7.846810
KL Loss: 4.872732
Y Loss: 0.954615
T Loss: 11.171990
X Loss: -3.802488
Epoch 1699 
Overall Loss: 12.736845
Rec Loss: 7.857584
KL Loss: 4.879261
Y Loss: 0.992706
T Loss: 11.175672
X Loss: -3.814441
Epoch 1749 
Overall Loss: 12.705532
Rec Loss: 7.806615
KL Loss: 4.898918
Y Loss: 0.963065
T Loss: 11.146267
X Loss: -3.821185
Epoch 1799 
Overall Loss: 12.726047
Rec Loss: 7.830590
KL Loss: 4.895458
Y Loss: 0.981874
T Loss: 11.137818
X Loss: -3.798165
Epoch 1849 
Overall Loss: 12.698585
Rec Loss: 7.788754
KL Loss: 4.909831
Y Loss: 0.979132
T Loss: 11.118343
X Loss: -3.819156
Epoch 1899 
Overall Loss: 12.709584
Rec Loss: 7.783070
KL Loss: 4.926514
Y Loss: 0.959190
T Loss: 11.103376
X Loss: -3.799901
Epoch 1949 
Overall Loss: 12.706281
Rec Loss: 7.756500
KL Loss: 4.949781
Y Loss: 0.972683
T Loss: 11.066284
X Loss: -3.796126
Epoch 1999 
Overall Loss: 12.662383
Rec Loss: 7.653668
KL Loss: 5.008715
Y Loss: 0.980276
T Loss: 10.993025
X Loss: -3.829495
Epoch 2049 
Overall Loss: 12.687294
Rec Loss: 7.642463
KL Loss: 5.044832
Y Loss: 0.981132
T Loss: 10.945733
X Loss: -3.793836
Epoch 2099 
Overall Loss: 12.667964
Rec Loss: 7.588800
KL Loss: 5.079163
Y Loss: 0.981270
T Loss: 10.905186
X Loss: -3.807020
Epoch 2149 
Overall Loss: 12.666189
Rec Loss: 7.547910
KL Loss: 5.118280
Y Loss: 0.943807
T Loss: 10.891510
X Loss: -3.815504
Epoch 2199 
Overall Loss: 12.618865
Rec Loss: 7.523890
KL Loss: 5.094975
Y Loss: 0.962368
T Loss: 10.863997
X Loss: -3.821291
Epoch 2249 
Overall Loss: 12.638662
Rec Loss: 7.531952
KL Loss: 5.106710
Y Loss: 0.975105
T Loss: 10.863017
X Loss: -3.818617
Epoch 2299 
Overall Loss: 12.634786
Rec Loss: 7.528579
KL Loss: 5.106207
Y Loss: 0.959337
T Loss: 10.852955
X Loss: -3.804045
Epoch 2349 
Overall Loss: 12.652621
Rec Loss: 7.535767
KL Loss: 5.116854
Y Loss: 0.960867
T Loss: 10.861178
X Loss: -3.805845
Epoch 2399 
Overall Loss: 12.646163
Rec Loss: 7.543789
KL Loss: 5.102374
Y Loss: 0.986220
T Loss: 10.854399
X Loss: -3.803720
Epoch 2449 
Overall Loss: 12.637257
Rec Loss: 7.514810
KL Loss: 5.122447
Y Loss: 0.962788
T Loss: 10.846827
X Loss: -3.813411
Epoch 2499 
Overall Loss: 12.616456
Rec Loss: 7.501684
KL Loss: 5.114771
Y Loss: 0.940900
T Loss: 10.860483
X Loss: -3.829248
Epoch 2549 
Overall Loss: 12.609421
Rec Loss: 7.515650
KL Loss: 5.093771
Y Loss: 0.972240
T Loss: 10.850852
X Loss: -3.821322
Epoch 2599 
Overall Loss: 12.628617
Rec Loss: 7.521520
KL Loss: 5.107097
Y Loss: 0.983051
T Loss: 10.844416
X Loss: -3.814422
Epoch 2649 
Overall Loss: 12.624273
Rec Loss: 7.512434
KL Loss: 5.111839
Y Loss: 0.972375
T Loss: 10.843166
X Loss: -3.816919
Epoch 2699 
Overall Loss: 12.626932
Rec Loss: 7.501149
KL Loss: 5.125783
Y Loss: 0.987372
T Loss: 10.851453
X Loss: -3.843989
Epoch 2749 
Overall Loss: 12.613268
Rec Loss: 7.480814
KL Loss: 5.132454
Y Loss: 0.945037
T Loss: 10.850333
X Loss: -3.842037
Epoch 2799 
Overall Loss: 12.598305
Rec Loss: 7.509951
KL Loss: 5.088354
Y Loss: 0.965417
T Loss: 10.834750
X Loss: -3.807508
Epoch 2849 
Overall Loss: 12.620190
Rec Loss: 7.509563
KL Loss: 5.110626
Y Loss: 0.966449
T Loss: 10.849647
X Loss: -3.823309
Epoch 2899 
Overall Loss: 12.633161
Rec Loss: 7.506675
KL Loss: 5.126487
Y Loss: 0.961402
T Loss: 10.855852
X Loss: -3.829879
Epoch 2949 
Overall Loss: 12.634641
Rec Loss: 7.523272
KL Loss: 5.111369
Y Loss: 0.979672
T Loss: 10.847821
X Loss: -3.814385
Epoch 2999 
Overall Loss: 12.643963
Rec Loss: 7.526138
KL Loss: 5.117826
Y Loss: 0.974298
T Loss: 10.855378
X Loss: -3.816389
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.371210
Epoch 99
Rec Loss: 2.387574
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 1.998843
Epoch 99
Rec Loss: 1.992898
Epoch 149
Rec Loss: 1.997172
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.576808
Insample Error 2.691066
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.581111
Epoch 99 
Prediction Loss: 3.347650
Epoch 149 
Prediction Loss: 3.318868
Epoch 199 
Prediction Loss: 3.017202
Epoch 249 
Prediction Loss: 2.896378
Epoch 299 
Prediction Loss: 2.714083
Epoch 349 
Prediction Loss: 2.549916
Epoch 399 
Prediction Loss: 2.388052
Epoch 449 
Prediction Loss: 2.259920
Epoch 499 
Prediction Loss: 2.124054
Epoch 549 
Prediction Loss: 2.013655
Epoch 599 
Prediction Loss: 1.913060
Epoch 649 
Prediction Loss: 1.855847
Epoch 699 
Prediction Loss: 1.792242
Epoch 749 
Prediction Loss: 1.686659
Epoch 799 
Prediction Loss: 1.681029
Epoch 849 
Prediction Loss: 1.599974
Epoch 899 
Prediction Loss: 1.565074
Epoch 949 
Prediction Loss: 1.530635
Epoch 999 
Prediction Loss: 1.505841
Epoch 1049 
Prediction Loss: 1.424681
Epoch 1099 
Prediction Loss: 1.368553
Epoch 1149 
Prediction Loss: 1.330796
Epoch 1199 
Prediction Loss: 1.317273
Epoch 1249 
Prediction Loss: 1.367401
Epoch 1299 
Prediction Loss: 1.260595
Epoch 1349 
Prediction Loss: 1.261070
Epoch 1399 
Prediction Loss: 1.240499
Epoch 1449 
Prediction Loss: 1.226969
Epoch 1499 
Prediction Loss: 1.212405
Epoch 1549 
Prediction Loss: 1.165865
Epoch 1599 
Prediction Loss: 1.183793
Epoch 1649 
Prediction Loss: 1.155297
Epoch 1699 
Prediction Loss: 1.139182
Epoch 1749 
Prediction Loss: 1.108249
Epoch 1799 
Prediction Loss: 1.096801
Epoch 1849 
Prediction Loss: 1.091046
Epoch 1899 
Prediction Loss: 1.056510
Epoch 1949 
Prediction Loss: 1.050457
Epoch 1999 
Prediction Loss: 1.014825
Epoch 2049 
Prediction Loss: 1.056918
Epoch 2099 
Prediction Loss: 1.019543
Epoch 2149 
Prediction Loss: 1.016206
Epoch 2199 
Prediction Loss: 1.007621
Epoch 2249 
Prediction Loss: 1.002867
Epoch 2299 
Prediction Loss: 1.004637
Epoch 2349 
Prediction Loss: 0.957007
Epoch 2399 
Prediction Loss: 0.991231
Epoch 2449 
Prediction Loss: 0.972200
Epoch 2499 
Prediction Loss: 0.966926
Epoch 2549 
Prediction Loss: 0.940446
Epoch 2599 
Prediction Loss: 0.931141
Epoch 2649 
Prediction Loss: 0.920696
Epoch 2699 
Prediction Loss: 0.920315
Epoch 2749 
Prediction Loss: 0.921037
Epoch 2799 
Prediction Loss: 0.898291
Epoch 2849 
Prediction Loss: 0.923710
Epoch 2899 
Prediction Loss: 0.977640
Epoch 2949 
Prediction Loss: 0.902156
Epoch 2999 
Prediction Loss: 0.884376
Epoch 3049 
Prediction Loss: 0.915239
Epoch 3099 
Prediction Loss: 0.887071
Epoch 3149 
Prediction Loss: 0.866707
Epoch 3199 
Prediction Loss: 0.878086
Epoch 3249 
Prediction Loss: 0.875898
Epoch 3299 
Prediction Loss: 0.901132
Epoch 3349 
Prediction Loss: 0.866542
Epoch 3399 
Prediction Loss: 0.849788
Epoch 3449 
Prediction Loss: 0.903793
Epoch 3499 
Prediction Loss: 0.869215
Epoch 3549 
Prediction Loss: 0.853654
Epoch 3599 
Prediction Loss: 0.849254
Epoch 3649 
Prediction Loss: 0.885476
Epoch 3699 
Prediction Loss: 0.860972
Epoch 3749 
Prediction Loss: 0.838546
Epoch 3799 
Prediction Loss: 0.840496
Epoch 3849 
Prediction Loss: 0.825757
Epoch 3899 
Prediction Loss: 0.838407
Epoch 3949 
Prediction Loss: 0.838694
Epoch 3999 
Prediction Loss: 0.831942
Epoch 4049 
Prediction Loss: 0.881318
Epoch 4099 
Prediction Loss: 0.809617
Epoch 4149 
Prediction Loss: 0.817189
Epoch 4199 
Prediction Loss: 0.817966
Epoch 4249 
Prediction Loss: 0.825068
Epoch 4299 
Prediction Loss: 0.819438
Epoch 4349 
Prediction Loss: 0.839923
Epoch 4399 
Prediction Loss: 0.800001
Epoch 4449 
Prediction Loss: 0.804488
Epoch 4499 
Prediction Loss: 0.811380
Epoch 4549 
Prediction Loss: 0.796082
Epoch 4599 
Prediction Loss: 0.797804
Epoch 4649 
Prediction Loss: 0.781640
Epoch 4699 
Prediction Loss: 0.792785
Epoch 4749 
Prediction Loss: 0.809787
Epoch 4799 
Prediction Loss: 0.788002
Epoch 4849 
Prediction Loss: 0.860649
Epoch 4899 
Prediction Loss: 0.776122
Epoch 4949 
Prediction Loss: 0.787008
Epoch 4999 
Prediction Loss: 0.776781
Epoch 5049 
Prediction Loss: 0.794153
Epoch 5099 
Prediction Loss: 0.773365
Epoch 5149 
Prediction Loss: 0.771031
Epoch 5199 
Prediction Loss: 0.778489
Epoch 5249 
Prediction Loss: 0.791580
Epoch 5299 
Prediction Loss: 0.764981
Epoch 5349 
Prediction Loss: 0.769883
Epoch 5399 
Prediction Loss: 0.796846
Epoch 5449 
Prediction Loss: 0.768253
Epoch 5499 
Prediction Loss: 0.755726
Epoch 5549 
Prediction Loss: 0.789977
Epoch 5599 
Prediction Loss: 0.759651
Epoch 5649 
Prediction Loss: 0.750834
Epoch 5699 
Prediction Loss: 0.775414
Epoch 5749 
Prediction Loss: 0.770229
Epoch 5799 
Prediction Loss: 0.773796
Epoch 5849 
Prediction Loss: 0.773547
Epoch 5899 
Prediction Loss: 0.752693
Epoch 5949 
Prediction Loss: 0.770574
Epoch 5999 
Prediction Loss: 0.754458
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.865275
Insample Error 4.255380
[31m========== repeat time 5 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.459366
Rec Loss: 11.412707
KL Loss: 2.046659
Y Loss: 1.006461
T Loss: 10.909476
Epoch 99 
Overall Loss: 13.349032
Rec Loss: 11.187133
KL Loss: 2.161899
Y Loss: 0.980533
T Loss: 10.696867
Epoch 149 
Overall Loss: 13.271585
Rec Loss: 11.022641
KL Loss: 2.248944
Y Loss: 0.981181
T Loss: 10.532051
Epoch 199 
Overall Loss: 13.242288
Rec Loss: 11.008777
KL Loss: 2.233511
Y Loss: 0.961577
T Loss: 10.527988
Epoch 249 
Overall Loss: 13.226274
Rec Loss: 10.950899
KL Loss: 2.275375
Y Loss: 0.969729
T Loss: 10.466035
Epoch 299 
Overall Loss: 13.197381
Rec Loss: 10.958582
KL Loss: 2.238799
Y Loss: 1.002687
T Loss: 10.457239
Epoch 349 
Overall Loss: 13.206753
Rec Loss: 10.979471
KL Loss: 2.227282
Y Loss: 0.973750
T Loss: 10.492597
Epoch 399 
Overall Loss: 13.190131
Rec Loss: 10.963149
KL Loss: 2.226982
Y Loss: 0.978098
T Loss: 10.474101
Epoch 449 
Overall Loss: 13.203572
Rec Loss: 10.953123
KL Loss: 2.250449
Y Loss: 0.961350
T Loss: 10.472448
Epoch 499 
Overall Loss: 13.160208
Rec Loss: 10.938990
KL Loss: 2.221217
Y Loss: 0.947002
T Loss: 10.465489
Epoch 549 
Overall Loss: 13.169869
Rec Loss: 10.930708
KL Loss: 2.239162
Y Loss: 0.972046
T Loss: 10.444685
Epoch 599 
Overall Loss: 13.154964
Rec Loss: 10.933166
KL Loss: 2.221798
Y Loss: 0.993109
T Loss: 10.436611
Epoch 649 
Overall Loss: 13.149769
Rec Loss: 10.921349
KL Loss: 2.228420
Y Loss: 0.926455
T Loss: 10.458121
Epoch 699 
Overall Loss: 13.135299
Rec Loss: 10.908355
KL Loss: 2.226945
Y Loss: 0.958855
T Loss: 10.428927
Epoch 749 
Overall Loss: 13.136897
Rec Loss: 10.929271
KL Loss: 2.207626
Y Loss: 0.973060
T Loss: 10.442741
Epoch 799 
Overall Loss: 13.120091
Rec Loss: 10.910546
KL Loss: 2.209545
Y Loss: 0.962128
T Loss: 10.429482
Epoch 849 
Overall Loss: 13.135233
Rec Loss: 10.924523
KL Loss: 2.210710
Y Loss: 0.937081
T Loss: 10.455982
Epoch 899 
Overall Loss: 13.140000
Rec Loss: 10.913097
KL Loss: 2.226903
Y Loss: 0.952146
T Loss: 10.437023
Epoch 949 
Overall Loss: 13.127258
Rec Loss: 10.886802
KL Loss: 2.240456
Y Loss: 0.972623
T Loss: 10.400490
Epoch 999 
Overall Loss: 13.143564
Rec Loss: 10.907684
KL Loss: 2.235880
Y Loss: 0.963972
T Loss: 10.425698
Epoch 1049 
Overall Loss: 13.125693
Rec Loss: 10.926700
KL Loss: 2.198993
Y Loss: 0.966024
T Loss: 10.443688
Epoch 1099 
Overall Loss: 13.125917
Rec Loss: 10.907235
KL Loss: 2.218682
Y Loss: 0.937257
T Loss: 10.438606
Epoch 1149 
Overall Loss: 13.096086
Rec Loss: 10.896639
KL Loss: 2.199447
Y Loss: 0.970093
T Loss: 10.411593
Epoch 1199 
Overall Loss: 13.099322
Rec Loss: 10.887428
KL Loss: 2.211894
Y Loss: 0.931097
T Loss: 10.421880
Epoch 1249 
Overall Loss: 13.110251
Rec Loss: 10.874108
KL Loss: 2.236142
Y Loss: 0.913531
T Loss: 10.417342
Epoch 1299 
Overall Loss: 13.107167
Rec Loss: 10.894404
KL Loss: 2.212763
Y Loss: 0.950349
T Loss: 10.419230
Epoch 1349 
Overall Loss: 13.069648
Rec Loss: 10.869547
KL Loss: 2.200101
Y Loss: 0.947556
T Loss: 10.395769
Epoch 1399 
Overall Loss: 13.087404
Rec Loss: 10.878307
KL Loss: 2.209097
Y Loss: 0.969709
T Loss: 10.393452
Epoch 1449 
Overall Loss: 13.055556
Rec Loss: 10.867077
KL Loss: 2.188478
Y Loss: 0.954211
T Loss: 10.389972
Epoch 1499 
Overall Loss: 13.070366
Rec Loss: 10.846509
KL Loss: 2.223857
Y Loss: 0.936788
T Loss: 10.378115
Epoch 1549 
Overall Loss: 13.066899
Rec Loss: 10.846129
KL Loss: 2.220770
Y Loss: 0.939396
T Loss: 10.376431
Epoch 1599 
Overall Loss: 13.068975
Rec Loss: 10.829373
KL Loss: 2.239602
Y Loss: 0.919135
T Loss: 10.369805
Epoch 1649 
Overall Loss: 13.068222
Rec Loss: 10.853209
KL Loss: 2.215013
Y Loss: 0.952377
T Loss: 10.377021
Epoch 1699 
Overall Loss: 13.054552
Rec Loss: 10.807600
KL Loss: 2.246953
Y Loss: 0.921806
T Loss: 10.346697
Epoch 1749 
Overall Loss: 13.081691
Rec Loss: 10.857432
KL Loss: 2.224259
Y Loss: 0.940380
T Loss: 10.387242
Epoch 1799 
Overall Loss: 13.061243
Rec Loss: 10.858933
KL Loss: 2.202311
Y Loss: 0.946629
T Loss: 10.385618
Epoch 1849 
Overall Loss: 13.044937
Rec Loss: 10.850289
KL Loss: 2.194648
Y Loss: 0.964744
T Loss: 10.367917
Epoch 1899 
Overall Loss: 13.027798
Rec Loss: 10.813876
KL Loss: 2.213923
Y Loss: 0.934238
T Loss: 10.346757
Epoch 1949 
Overall Loss: 13.057406
Rec Loss: 10.833465
KL Loss: 2.223941
Y Loss: 0.931849
T Loss: 10.367540
Epoch 1999 
Overall Loss: 13.075530
Rec Loss: 10.813010
KL Loss: 2.262520
Y Loss: 0.949802
T Loss: 10.338109
Epoch 2049 
Overall Loss: 13.025922
Rec Loss: 10.802518
KL Loss: 2.223404
Y Loss: 0.921537
T Loss: 10.341750
Epoch 2099 
Overall Loss: 13.041209
Rec Loss: 10.815093
KL Loss: 2.226116
Y Loss: 0.937069
T Loss: 10.346559
Epoch 2149 
Overall Loss: 13.041047
Rec Loss: 10.814371
KL Loss: 2.226676
Y Loss: 0.931535
T Loss: 10.348603
Epoch 2199 
Overall Loss: 13.023672
Rec Loss: 10.816510
KL Loss: 2.207163
Y Loss: 0.942589
T Loss: 10.345215
Epoch 2249 
Overall Loss: 13.038566
Rec Loss: 10.798897
KL Loss: 2.239669
Y Loss: 0.918479
T Loss: 10.339658
Epoch 2299 
Overall Loss: 13.022980
Rec Loss: 10.793373
KL Loss: 2.229608
Y Loss: 0.936253
T Loss: 10.325247
Epoch 2349 
Overall Loss: 13.030571
Rec Loss: 10.810298
KL Loss: 2.220273
Y Loss: 0.937149
T Loss: 10.341724
Epoch 2399 
Overall Loss: 13.015656
Rec Loss: 10.793000
KL Loss: 2.222656
Y Loss: 0.933022
T Loss: 10.326489
Epoch 2449 
Overall Loss: 13.011407
Rec Loss: 10.786521
KL Loss: 2.224887
Y Loss: 0.924606
T Loss: 10.324218
Epoch 2499 
Overall Loss: 13.001666
Rec Loss: 10.791050
KL Loss: 2.210616
Y Loss: 0.906361
T Loss: 10.337869
Epoch 2549 
Overall Loss: 12.988482
Rec Loss: 10.786765
KL Loss: 2.201717
Y Loss: 0.917505
T Loss: 10.328013
Epoch 2599 
Overall Loss: 13.002006
Rec Loss: 10.793633
KL Loss: 2.208373
Y Loss: 0.930234
T Loss: 10.328516
Epoch 2649 
Overall Loss: 13.011179
Rec Loss: 10.798980
KL Loss: 2.212199
Y Loss: 0.940433
T Loss: 10.328763
Epoch 2699 
Overall Loss: 12.988707
Rec Loss: 10.779409
KL Loss: 2.209299
Y Loss: 0.939189
T Loss: 10.309814
Epoch 2749 
Overall Loss: 12.980044
Rec Loss: 10.786166
KL Loss: 2.193877
Y Loss: 0.903936
T Loss: 10.334198
Epoch 2799 
Overall Loss: 13.000474
Rec Loss: 10.796638
KL Loss: 2.203836
Y Loss: 0.921881
T Loss: 10.335698
Epoch 2849 
Overall Loss: 12.987644
Rec Loss: 10.789340
KL Loss: 2.198303
Y Loss: 0.932658
T Loss: 10.323011
Epoch 2899 
Overall Loss: 12.989530
Rec Loss: 10.780716
KL Loss: 2.208814
Y Loss: 0.927136
T Loss: 10.317148
Epoch 2949 
Overall Loss: 12.987283
Rec Loss: 10.773350
KL Loss: 2.213932
Y Loss: 0.927317
T Loss: 10.309692
Epoch 2999 
Overall Loss: 12.967824
Rec Loss: 10.760967
KL Loss: 2.206858
Y Loss: 0.926739
T Loss: 10.297597
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.061036
Epoch 99
Rec Loss: 2.069199
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.938556
Epoch 99
Rec Loss: 9.935658
Epoch 149
Rec Loss: 9.924924
Epoch 199
Rec Loss: 9.904328
Epoch 249
Rec Loss: 9.921039
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.623678
Insample Error: 1.961536
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.323682
Rec Loss: 18.436436
KL Loss: 2.887246
Y Loss: 9.132609
T Loss: 12.946761
X Loss: 0.923370
Epoch 99 
Overall Loss: 16.910535
Rec Loss: 13.383289
KL Loss: 3.527246
Y Loss: 3.240878
T Loss: 12.930718
X Loss: -1.167868
Epoch 149 
Overall Loss: 15.506408
Rec Loss: 12.040347
KL Loss: 3.466060
Y Loss: 2.448470
T Loss: 12.964669
X Loss: -2.148557
Epoch 199 
Overall Loss: 14.429516
Rec Loss: 10.758477
KL Loss: 3.671039
Y Loss: 1.846351
T Loss: 12.615038
X Loss: -2.779736
Epoch 249 
Overall Loss: 13.964140
Rec Loss: 10.174358
KL Loss: 3.789782
Y Loss: 1.460458
T Loss: 12.473052
X Loss: -3.028923
Epoch 299 
Overall Loss: 13.669272
Rec Loss: 9.749252
KL Loss: 3.920019
Y Loss: 1.212215
T Loss: 12.295031
X Loss: -3.151886
Epoch 349 
Overall Loss: 13.450101
Rec Loss: 9.436862
KL Loss: 4.013240
Y Loss: 1.239670
T Loss: 12.119311
X Loss: -3.302284
Epoch 399 
Overall Loss: 13.336706
Rec Loss: 9.208017
KL Loss: 4.128689
Y Loss: 1.176528
T Loss: 11.995160
X Loss: -3.375407
Epoch 449 
Overall Loss: 13.290145
Rec Loss: 9.090189
KL Loss: 4.199955
Y Loss: 1.137028
T Loss: 11.930345
X Loss: -3.408670
Epoch 499 
Overall Loss: 13.218177
Rec Loss: 9.001805
KL Loss: 4.216372
Y Loss: 1.135524
T Loss: 11.877942
X Loss: -3.443899
Epoch 549 
Overall Loss: 13.177616
Rec Loss: 8.910046
KL Loss: 4.267571
Y Loss: 1.093994
T Loss: 11.847730
X Loss: -3.484682
Epoch 599 
Overall Loss: 13.146213
Rec Loss: 8.873645
KL Loss: 4.272568
Y Loss: 1.071370
T Loss: 11.830169
X Loss: -3.492209
Epoch 649 
Overall Loss: 13.103074
Rec Loss: 8.821121
KL Loss: 4.281952
Y Loss: 1.054454
T Loss: 11.804664
X Loss: -3.510770
Epoch 699 
Overall Loss: 13.069405
Rec Loss: 8.758261
KL Loss: 4.311144
Y Loss: 0.997014
T Loss: 11.781239
X Loss: -3.521486
Epoch 749 
Overall Loss: 13.080609
Rec Loss: 8.750353
KL Loss: 4.330257
Y Loss: 1.016137
T Loss: 11.746825
X Loss: -3.504541
Epoch 799 
Overall Loss: 13.024552
Rec Loss: 8.685355
KL Loss: 4.339197
Y Loss: 1.009746
T Loss: 11.682712
X Loss: -3.502230
Epoch 849 
Overall Loss: 13.010306
Rec Loss: 8.596001
KL Loss: 4.414305
Y Loss: 0.976703
T Loss: 11.608994
X Loss: -3.501344
Epoch 899 
Overall Loss: 12.958550
Rec Loss: 8.466853
KL Loss: 4.491697
Y Loss: 0.964074
T Loss: 11.494801
X Loss: -3.509985
Epoch 949 
Overall Loss: 12.917769
Rec Loss: 8.335709
KL Loss: 4.582060
Y Loss: 0.975533
T Loss: 11.383564
X Loss: -3.535621
Epoch 999 
Overall Loss: 12.868455
Rec Loss: 8.229013
KL Loss: 4.639443
Y Loss: 0.961948
T Loss: 11.306340
X Loss: -3.558301
Epoch 1049 
Overall Loss: 12.839731
Rec Loss: 8.166306
KL Loss: 4.673425
Y Loss: 1.002434
T Loss: 11.260133
X Loss: -3.595044
Epoch 1099 
Overall Loss: 12.814932
Rec Loss: 8.134195
KL Loss: 4.680737
Y Loss: 0.964771
T Loss: 11.235325
X Loss: -3.583515
Epoch 1149 
Overall Loss: 12.810972
Rec Loss: 8.097683
KL Loss: 4.713289
Y Loss: 0.964669
T Loss: 11.218272
X Loss: -3.602924
Epoch 1199 
Overall Loss: 12.798985
Rec Loss: 8.095502
KL Loss: 4.703483
Y Loss: 0.978426
T Loss: 11.207053
X Loss: -3.600764
Epoch 1249 
Overall Loss: 12.792081
Rec Loss: 8.066880
KL Loss: 4.725200
Y Loss: 0.971860
T Loss: 11.203071
X Loss: -3.622121
Epoch 1299 
Overall Loss: 12.796060
Rec Loss: 8.074373
KL Loss: 4.721687
Y Loss: 0.979785
T Loss: 11.206468
X Loss: -3.621988
Epoch 1349 
Overall Loss: 12.751777
Rec Loss: 8.045815
KL Loss: 4.705963
Y Loss: 0.949905
T Loss: 11.209930
X Loss: -3.639067
Epoch 1399 
Overall Loss: 12.777615
Rec Loss: 8.058693
KL Loss: 4.718922
Y Loss: 0.976670
T Loss: 11.198560
X Loss: -3.628202
Epoch 1449 
Overall Loss: 12.757559
Rec Loss: 8.041108
KL Loss: 4.716451
Y Loss: 0.963104
T Loss: 11.177941
X Loss: -3.618385
Epoch 1499 
Overall Loss: 12.764294
Rec Loss: 8.041270
KL Loss: 4.723024
Y Loss: 0.960868
T Loss: 11.191932
X Loss: -3.631096
Epoch 1549 
Overall Loss: 12.766834
Rec Loss: 8.049409
KL Loss: 4.717425
Y Loss: 0.984680
T Loss: 11.192446
X Loss: -3.635377
Epoch 1599 
Overall Loss: 12.731333
Rec Loss: 7.996737
KL Loss: 4.734597
Y Loss: 0.965298
T Loss: 11.184780
X Loss: -3.670693
Epoch 1649 
Overall Loss: 12.738830
Rec Loss: 8.019442
KL Loss: 4.719388
Y Loss: 0.973560
T Loss: 11.188875
X Loss: -3.656213
Epoch 1699 
Overall Loss: 12.729337
Rec Loss: 8.010110
KL Loss: 4.719228
Y Loss: 0.974762
T Loss: 11.182646
X Loss: -3.659917
Epoch 1749 
Overall Loss: 12.740922
Rec Loss: 8.022806
KL Loss: 4.718116
Y Loss: 0.969749
T Loss: 11.181670
X Loss: -3.643738
Epoch 1799 
Overall Loss: 12.710851
Rec Loss: 7.997515
KL Loss: 4.713335
Y Loss: 0.972297
T Loss: 11.168395
X Loss: -3.657029
Epoch 1849 
Overall Loss: 12.743538
Rec Loss: 8.010848
KL Loss: 4.732690
Y Loss: 0.978158
T Loss: 11.191495
X Loss: -3.669727
Epoch 1899 
Overall Loss: 12.721584
Rec Loss: 8.001691
KL Loss: 4.719892
Y Loss: 0.947472
T Loss: 11.176726
X Loss: -3.648771
Epoch 1949 
Overall Loss: 12.723912
Rec Loss: 8.013024
KL Loss: 4.710888
Y Loss: 0.998251
T Loss: 11.175132
X Loss: -3.661234
Epoch 1999 
Overall Loss: 12.695397
Rec Loss: 7.981889
KL Loss: 4.713508
Y Loss: 0.968075
T Loss: 11.166329
X Loss: -3.668478
Epoch 2049 
Overall Loss: 12.717852
Rec Loss: 7.995002
KL Loss: 4.722850
Y Loss: 0.968971
T Loss: 11.172196
X Loss: -3.661679
Epoch 2099 
Overall Loss: 12.729412
Rec Loss: 7.993892
KL Loss: 4.735520
Y Loss: 0.980363
T Loss: 11.178890
X Loss: -3.675180
Epoch 2149 
Overall Loss: 12.737620
Rec Loss: 8.001950
KL Loss: 4.735671
Y Loss: 0.951546
T Loss: 11.182513
X Loss: -3.656336
Epoch 2199 
Overall Loss: 12.674643
Rec Loss: 7.959124
KL Loss: 4.715519
Y Loss: 0.943327
T Loss: 11.165000
X Loss: -3.677539
Epoch 2249 
Overall Loss: 12.713922
Rec Loss: 7.975697
KL Loss: 4.738225
Y Loss: 0.971848
T Loss: 11.168579
X Loss: -3.678806
Epoch 2299 
Overall Loss: 12.708670
Rec Loss: 7.981737
KL Loss: 4.726934
Y Loss: 0.975158
T Loss: 11.182659
X Loss: -3.688502
Epoch 2349 
Overall Loss: 12.713088
Rec Loss: 7.996575
KL Loss: 4.716513
Y Loss: 0.977863
T Loss: 11.177255
X Loss: -3.669611
Epoch 2399 
Overall Loss: 12.722036
Rec Loss: 7.991903
KL Loss: 4.730133
Y Loss: 0.992382
T Loss: 11.183799
X Loss: -3.688086
Epoch 2449 
Overall Loss: 12.676433
Rec Loss: 7.940173
KL Loss: 4.736260
Y Loss: 0.949197
T Loss: 11.156683
X Loss: -3.691108
Epoch 2499 
Overall Loss: 12.706340
Rec Loss: 7.961613
KL Loss: 4.744726
Y Loss: 0.982687
T Loss: 11.171800
X Loss: -3.701530
Epoch 2549 
Overall Loss: 12.694110
Rec Loss: 7.948755
KL Loss: 4.745355
Y Loss: 0.966067
T Loss: 11.164106
X Loss: -3.698384
Epoch 2599 
Overall Loss: 12.702527
Rec Loss: 7.965822
KL Loss: 4.736704
Y Loss: 1.007950
T Loss: 11.184549
X Loss: -3.722701
Epoch 2649 
Overall Loss: 12.707639
Rec Loss: 7.958769
KL Loss: 4.748870
Y Loss: 0.960726
T Loss: 11.176883
X Loss: -3.698477
Epoch 2699 
Overall Loss: 12.700991
Rec Loss: 7.959621
KL Loss: 4.741369
Y Loss: 0.937616
T Loss: 11.179843
X Loss: -3.689029
Epoch 2749 
Overall Loss: 12.709046
Rec Loss: 7.946519
KL Loss: 4.762527
Y Loss: 0.977865
T Loss: 11.174706
X Loss: -3.717120
Epoch 2799 
Overall Loss: 12.698081
Rec Loss: 7.947626
KL Loss: 4.750455
Y Loss: 0.980030
T Loss: 11.160468
X Loss: -3.702857
Epoch 2849 
Overall Loss: 12.689260
Rec Loss: 7.943721
KL Loss: 4.745538
Y Loss: 0.969108
T Loss: 11.166859
X Loss: -3.707691
Epoch 2899 
Overall Loss: 12.693321
Rec Loss: 7.944866
KL Loss: 4.748455
Y Loss: 0.951674
T Loss: 11.193353
X Loss: -3.724324
Epoch 2949 
Overall Loss: 12.689489
Rec Loss: 7.970421
KL Loss: 4.719068
Y Loss: 0.980694
T Loss: 11.181489
X Loss: -3.701415
Epoch 2999 
Overall Loss: 12.671062
Rec Loss: 7.951778
KL Loss: 4.719284
Y Loss: 0.976874
T Loss: 11.181412
X Loss: -3.718070
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.577089
Epoch 99
Rec Loss: 2.585090
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.014106
Epoch 99
Rec Loss: 2.002421
Epoch 149
Rec Loss: 2.002012
Epoch 199
Rec Loss: 1.999806
Epoch 249
Rec Loss: 2.001040
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.586766
Insample Error 2.742282
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.539965
Epoch 99 
Prediction Loss: 3.378250
Epoch 149 
Prediction Loss: 3.192410
Epoch 199 
Prediction Loss: 3.046405
Epoch 249 
Prediction Loss: 2.962332
Epoch 299 
Prediction Loss: 2.842441
Epoch 349 
Prediction Loss: 2.740086
Epoch 399 
Prediction Loss: 2.602233
Epoch 449 
Prediction Loss: 2.481233
Epoch 499 
Prediction Loss: 2.467788
Epoch 549 
Prediction Loss: 2.233490
Epoch 599 
Prediction Loss: 2.191233
Epoch 649 
Prediction Loss: 2.035586
Epoch 699 
Prediction Loss: 2.058430
Epoch 749 
Prediction Loss: 1.917756
Epoch 799 
Prediction Loss: 1.801338
Epoch 849 
Prediction Loss: 1.774706
Epoch 899 
Prediction Loss: 1.706434
Epoch 949 
Prediction Loss: 1.656979
Epoch 999 
Prediction Loss: 1.628496
Epoch 1049 
Prediction Loss: 1.604573
Epoch 1099 
Prediction Loss: 1.538335
Epoch 1149 
Prediction Loss: 1.531454
Epoch 1199 
Prediction Loss: 1.491637
Epoch 1249 
Prediction Loss: 1.441149
Epoch 1299 
Prediction Loss: 1.441698
Epoch 1349 
Prediction Loss: 1.448079
Epoch 1399 
Prediction Loss: 1.377526
Epoch 1449 
Prediction Loss: 1.396093
Epoch 1499 
Prediction Loss: 1.303670
Epoch 1549 
Prediction Loss: 1.315617
Epoch 1599 
Prediction Loss: 1.275672
Epoch 1649 
Prediction Loss: 1.289122
Epoch 1699 
Prediction Loss: 1.266457
Epoch 1749 
Prediction Loss: 1.260001
Epoch 1799 
Prediction Loss: 1.229698
Epoch 1849 
Prediction Loss: 1.204100
Epoch 1899 
Prediction Loss: 1.202603
Epoch 1949 
Prediction Loss: 1.184470
Epoch 1999 
Prediction Loss: 1.174818
Epoch 2049 
Prediction Loss: 1.176930
Epoch 2099 
Prediction Loss: 1.133168
Epoch 2149 
Prediction Loss: 1.153266
Epoch 2199 
Prediction Loss: 1.164842
Epoch 2249 
Prediction Loss: 1.135488
Epoch 2299 
Prediction Loss: 1.116644
Epoch 2349 
Prediction Loss: 1.104693
Epoch 2399 
Prediction Loss: 1.113561
Epoch 2449 
Prediction Loss: 1.101219
Epoch 2499 
Prediction Loss: 1.102375
Epoch 2549 
Prediction Loss: 1.118387
Epoch 2599 
Prediction Loss: 1.079322
Epoch 2649 
Prediction Loss: 1.075049
Epoch 2699 
Prediction Loss: 1.065350
Epoch 2749 
Prediction Loss: 1.065572
Epoch 2799 
Prediction Loss: 1.061166
Epoch 2849 
Prediction Loss: 1.049191
Epoch 2899 
Prediction Loss: 1.082466
Epoch 2949 
Prediction Loss: 1.043834
Epoch 2999 
Prediction Loss: 1.046293
Epoch 3049 
Prediction Loss: 1.042171
Epoch 3099 
Prediction Loss: 1.056390
Epoch 3149 
Prediction Loss: 1.023425
Epoch 3199 
Prediction Loss: 1.005409
Epoch 3249 
Prediction Loss: 1.015556
Epoch 3299 
Prediction Loss: 1.021903
Epoch 3349 
Prediction Loss: 1.018485
Epoch 3399 
Prediction Loss: 1.017413
Epoch 3449 
Prediction Loss: 0.999889
Epoch 3499 
Prediction Loss: 1.001621
Epoch 3549 
Prediction Loss: 0.991380
Epoch 3599 
Prediction Loss: 0.994787
Epoch 3649 
Prediction Loss: 1.027861
Epoch 3699 
Prediction Loss: 1.040736
Epoch 3749 
Prediction Loss: 1.042801
Epoch 3799 
Prediction Loss: 1.006783
Epoch 3849 
Prediction Loss: 0.989824
Epoch 3899 
Prediction Loss: 1.003195
Epoch 3949 
Prediction Loss: 0.979578
Epoch 3999 
Prediction Loss: 0.997146
Epoch 4049 
Prediction Loss: 0.965768
Epoch 4099 
Prediction Loss: 1.001382
Epoch 4149 
Prediction Loss: 0.964756
Epoch 4199 
Prediction Loss: 0.954716
Epoch 4249 
Prediction Loss: 0.979992
Epoch 4299 
Prediction Loss: 0.948775
Epoch 4349 
Prediction Loss: 0.954864
Epoch 4399 
Prediction Loss: 0.950856
Epoch 4449 
Prediction Loss: 0.954188
Epoch 4499 
Prediction Loss: 0.959186
Epoch 4549 
Prediction Loss: 0.949149
Epoch 4599 
Prediction Loss: 0.930193
Epoch 4649 
Prediction Loss: 0.943905
Epoch 4699 
Prediction Loss: 0.931263
Epoch 4749 
Prediction Loss: 0.940424
Epoch 4799 
Prediction Loss: 0.938111
Epoch 4849 
Prediction Loss: 0.932110
Epoch 4899 
Prediction Loss: 0.922446
Epoch 4949 
Prediction Loss: 0.923611
Epoch 4999 
Prediction Loss: 0.941426
Epoch 5049 
Prediction Loss: 0.934513
Epoch 5099 
Prediction Loss: 0.969986
Epoch 5149 
Prediction Loss: 0.910746
Epoch 5199 
Prediction Loss: 0.935037
Epoch 5249 
Prediction Loss: 0.944140
Epoch 5299 
Prediction Loss: 0.915287
Epoch 5349 
Prediction Loss: 0.900454
Epoch 5399 
Prediction Loss: 0.915227
Epoch 5449 
Prediction Loss: 0.908654
Epoch 5499 
Prediction Loss: 0.908954
Epoch 5549 
Prediction Loss: 0.900770
Epoch 5599 
Prediction Loss: 0.912974
Epoch 5649 
Prediction Loss: 0.909187
Epoch 5699 
Prediction Loss: 0.908976
Epoch 5749 
Prediction Loss: 0.909915
Epoch 5799 
Prediction Loss: 0.911752
Epoch 5849 
Prediction Loss: 0.895937
Epoch 5899 
Prediction Loss: 0.897638
Epoch 5949 
Prediction Loss: 0.895848
Epoch 5999 
Prediction Loss: 0.885742
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.941475
Insample Error 4.254234
[31m========== repeat time 6 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.472039
Rec Loss: 11.472989
KL Loss: 1.999049
Y Loss: 1.083937
T Loss: 10.931021
Epoch 99 
Overall Loss: 13.320571
Rec Loss: 11.050472
KL Loss: 2.270100
Y Loss: 0.982840
T Loss: 10.559052
Epoch 149 
Overall Loss: 13.283571
Rec Loss: 10.977051
KL Loss: 2.306521
Y Loss: 0.957550
T Loss: 10.498276
Epoch 199 
Overall Loss: 13.265858
Rec Loss: 10.951517
KL Loss: 2.314341
Y Loss: 0.963206
T Loss: 10.469914
Epoch 249 
Overall Loss: 13.219926
Rec Loss: 10.941929
KL Loss: 2.277997
Y Loss: 0.972750
T Loss: 10.455554
Epoch 299 
Overall Loss: 13.192128
Rec Loss: 10.935544
KL Loss: 2.256584
Y Loss: 0.957452
T Loss: 10.456818
Epoch 349 
Overall Loss: 13.198335
Rec Loss: 10.964273
KL Loss: 2.234062
Y Loss: 1.001817
T Loss: 10.463364
Epoch 399 
Overall Loss: 13.202909
Rec Loss: 10.952369
KL Loss: 2.250540
Y Loss: 0.967570
T Loss: 10.468584
Epoch 449 
Overall Loss: 13.170553
Rec Loss: 10.907822
KL Loss: 2.262731
Y Loss: 0.956498
T Loss: 10.429573
Epoch 499 
Overall Loss: 13.180958
Rec Loss: 10.934729
KL Loss: 2.246228
Y Loss: 0.971113
T Loss: 10.449173
Epoch 549 
Overall Loss: 13.176830
Rec Loss: 10.929569
KL Loss: 2.247262
Y Loss: 0.966116
T Loss: 10.446511
Epoch 599 
Overall Loss: 13.167959
Rec Loss: 10.915385
KL Loss: 2.252574
Y Loss: 0.962614
T Loss: 10.434078
Epoch 649 
Overall Loss: 13.149852
Rec Loss: 10.922841
KL Loss: 2.227012
Y Loss: 0.953386
T Loss: 10.446148
Epoch 699 
Overall Loss: 13.150214
Rec Loss: 10.916845
KL Loss: 2.233369
Y Loss: 0.948961
T Loss: 10.442365
Epoch 749 
Overall Loss: 13.149672
Rec Loss: 10.915713
KL Loss: 2.233959
Y Loss: 0.951339
T Loss: 10.440043
Epoch 799 
Overall Loss: 13.132213
Rec Loss: 10.924814
KL Loss: 2.207399
Y Loss: 0.975395
T Loss: 10.437116
Epoch 849 
Overall Loss: 13.134135
Rec Loss: 10.910411
KL Loss: 2.223724
Y Loss: 0.966200
T Loss: 10.427311
Epoch 899 
Overall Loss: 13.150675
Rec Loss: 10.902566
KL Loss: 2.248109
Y Loss: 0.958538
T Loss: 10.423297
Epoch 949 
Overall Loss: 13.150541
Rec Loss: 10.922765
KL Loss: 2.227776
Y Loss: 0.967649
T Loss: 10.438940
Epoch 999 
Overall Loss: 13.162246
Rec Loss: 10.911903
KL Loss: 2.250343
Y Loss: 0.927941
T Loss: 10.447933
Epoch 1049 
Overall Loss: 13.125584
Rec Loss: 10.916628
KL Loss: 2.208957
Y Loss: 0.959762
T Loss: 10.436747
Epoch 1099 
Overall Loss: 13.129282
Rec Loss: 10.894061
KL Loss: 2.235221
Y Loss: 0.936879
T Loss: 10.425622
Epoch 1149 
Overall Loss: 13.088401
Rec Loss: 10.890549
KL Loss: 2.197851
Y Loss: 0.958696
T Loss: 10.411201
Epoch 1199 
Overall Loss: 13.119302
Rec Loss: 10.892612
KL Loss: 2.226690
Y Loss: 0.949614
T Loss: 10.417805
Epoch 1249 
Overall Loss: 13.105472
Rec Loss: 10.899749
KL Loss: 2.205722
Y Loss: 0.962318
T Loss: 10.418590
Epoch 1299 
Overall Loss: 13.099867
Rec Loss: 10.891630
KL Loss: 2.208237
Y Loss: 0.966096
T Loss: 10.408582
Epoch 1349 
Overall Loss: 13.111912
Rec Loss: 10.870296
KL Loss: 2.241615
Y Loss: 0.974068
T Loss: 10.383263
Epoch 1399 
Overall Loss: 13.087591
Rec Loss: 10.882010
KL Loss: 2.205582
Y Loss: 0.952827
T Loss: 10.405596
Epoch 1449 
Overall Loss: 13.095524
Rec Loss: 10.873020
KL Loss: 2.222504
Y Loss: 0.959754
T Loss: 10.393142
Epoch 1499 
Overall Loss: 13.101580
Rec Loss: 10.892053
KL Loss: 2.209527
Y Loss: 0.971421
T Loss: 10.406343
Epoch 1549 
Overall Loss: 13.096443
Rec Loss: 10.849427
KL Loss: 2.247016
Y Loss: 0.950885
T Loss: 10.373985
Epoch 1599 
Overall Loss: 13.080220
Rec Loss: 10.876184
KL Loss: 2.204037
Y Loss: 0.937601
T Loss: 10.407383
Epoch 1649 
Overall Loss: 13.091098
Rec Loss: 10.896402
KL Loss: 2.194696
Y Loss: 0.958935
T Loss: 10.416934
Epoch 1699 
Overall Loss: 13.062029
Rec Loss: 10.875545
KL Loss: 2.186484
Y Loss: 0.955019
T Loss: 10.398035
Epoch 1749 
Overall Loss: 13.058998
Rec Loss: 10.850126
KL Loss: 2.208872
Y Loss: 0.939968
T Loss: 10.380142
Epoch 1799 
Overall Loss: 13.070941
Rec Loss: 10.840730
KL Loss: 2.230210
Y Loss: 0.935729
T Loss: 10.372865
Epoch 1849 
Overall Loss: 13.064135
Rec Loss: 10.854432
KL Loss: 2.209704
Y Loss: 0.957586
T Loss: 10.375639
Epoch 1899 
Overall Loss: 13.039535
Rec Loss: 10.824639
KL Loss: 2.214896
Y Loss: 0.953478
T Loss: 10.347900
Epoch 1949 
Overall Loss: 13.034650
Rec Loss: 10.856760
KL Loss: 2.177889
Y Loss: 0.935451
T Loss: 10.389035
Epoch 1999 
Overall Loss: 13.068115
Rec Loss: 10.853961
KL Loss: 2.214154
Y Loss: 0.925780
T Loss: 10.391071
Epoch 2049 
Overall Loss: 13.056491
Rec Loss: 10.832920
KL Loss: 2.223571
Y Loss: 0.932584
T Loss: 10.366628
Epoch 2099 
Overall Loss: 13.038847
Rec Loss: 10.855751
KL Loss: 2.183096
Y Loss: 0.924160
T Loss: 10.393671
Epoch 2149 
Overall Loss: 13.048690
Rec Loss: 10.856151
KL Loss: 2.192538
Y Loss: 0.933829
T Loss: 10.389237
Epoch 2199 
Overall Loss: 13.034093
Rec Loss: 10.843229
KL Loss: 2.190864
Y Loss: 0.957932
T Loss: 10.364262
Epoch 2249 
Overall Loss: 13.032817
Rec Loss: 10.836204
KL Loss: 2.196613
Y Loss: 0.959006
T Loss: 10.356701
Epoch 2299 
Overall Loss: 13.032013
Rec Loss: 10.831708
KL Loss: 2.200305
Y Loss: 0.953856
T Loss: 10.354780
Epoch 2349 
Overall Loss: 13.030930
Rec Loss: 10.806615
KL Loss: 2.224315
Y Loss: 0.911260
T Loss: 10.350985
Epoch 2399 
Overall Loss: 13.026890
Rec Loss: 10.826297
KL Loss: 2.200592
Y Loss: 0.940778
T Loss: 10.355908
Epoch 2449 
Overall Loss: 13.018253
Rec Loss: 10.829762
KL Loss: 2.188491
Y Loss: 0.931682
T Loss: 10.363921
Epoch 2499 
Overall Loss: 12.989031
Rec Loss: 10.800310
KL Loss: 2.188721
Y Loss: 0.920792
T Loss: 10.339914
Epoch 2549 
Overall Loss: 13.005580
Rec Loss: 10.817758
KL Loss: 2.187822
Y Loss: 0.944067
T Loss: 10.345725
Epoch 2599 
Overall Loss: 13.005597
Rec Loss: 10.816357
KL Loss: 2.189240
Y Loss: 0.914150
T Loss: 10.359282
Epoch 2649 
Overall Loss: 13.004466
Rec Loss: 10.800951
KL Loss: 2.203516
Y Loss: 0.921130
T Loss: 10.340386
Epoch 2699 
Overall Loss: 13.011490
Rec Loss: 10.818741
KL Loss: 2.192749
Y Loss: 0.941002
T Loss: 10.348240
Epoch 2749 
Overall Loss: 12.969844
Rec Loss: 10.782117
KL Loss: 2.187728
Y Loss: 0.940680
T Loss: 10.311777
Epoch 2799 
Overall Loss: 13.004913
Rec Loss: 10.804281
KL Loss: 2.200632
Y Loss: 0.927913
T Loss: 10.340325
Epoch 2849 
Overall Loss: 12.990163
Rec Loss: 10.799666
KL Loss: 2.190497
Y Loss: 0.935637
T Loss: 10.331847
Epoch 2899 
Overall Loss: 12.992779
Rec Loss: 10.821116
KL Loss: 2.171663
Y Loss: 0.958430
T Loss: 10.341901
Epoch 2949 
Overall Loss: 12.991522
Rec Loss: 10.773304
KL Loss: 2.218218
Y Loss: 0.928276
T Loss: 10.309166
Epoch 2999 
Overall Loss: 12.985878
Rec Loss: 10.787756
KL Loss: 2.198122
Y Loss: 0.910334
T Loss: 10.332589
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.058557
Epoch 99
Rec Loss: 2.076819
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.954958
Epoch 99
Rec Loss: 9.926602
Epoch 149
Rec Loss: 9.919034
Epoch 199
Rec Loss: 9.919365
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.641986
Insample Error: 1.982425
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.329624
Rec Loss: 18.324539
KL Loss: 3.005085
Y Loss: 9.798588
T Loss: 12.904171
X Loss: 0.521073
Epoch 99 
Overall Loss: 16.141136
Rec Loss: 12.720862
KL Loss: 3.420274
Y Loss: 3.252141
T Loss: 12.794667
X Loss: -1.699876
Epoch 149 
Overall Loss: 14.717109
Rec Loss: 11.225740
KL Loss: 3.491369
Y Loss: 2.032289
T Loss: 12.677620
X Loss: -2.468024
Epoch 199 
Overall Loss: 14.203323
Rec Loss: 10.534461
KL Loss: 3.668862
Y Loss: 1.523855
T Loss: 12.630628
X Loss: -2.858093
Epoch 249 
Overall Loss: 13.909758
Rec Loss: 10.164550
KL Loss: 3.745208
Y Loss: 1.232914
T Loss: 12.579935
X Loss: -3.031842
Epoch 299 
Overall Loss: 13.694878
Rec Loss: 9.837109
KL Loss: 3.857769
Y Loss: 1.153157
T Loss: 12.432946
X Loss: -3.172415
Epoch 349 
Overall Loss: 13.507590
Rec Loss: 9.486296
KL Loss: 4.021294
Y Loss: 1.128857
T Loss: 12.197528
X Loss: -3.275661
Epoch 399 
Overall Loss: 13.322826
Rec Loss: 9.228049
KL Loss: 4.094776
Y Loss: 1.123555
T Loss: 12.016986
X Loss: -3.350714
Epoch 449 
Overall Loss: 13.258483
Rec Loss: 9.059928
KL Loss: 4.198556
Y Loss: 1.090414
T Loss: 11.933386
X Loss: -3.418665
Epoch 499 
Overall Loss: 13.208951
Rec Loss: 8.999194
KL Loss: 4.209757
Y Loss: 1.065044
T Loss: 11.885847
X Loss: -3.419175
Epoch 549 
Overall Loss: 13.172071
Rec Loss: 8.904868
KL Loss: 4.267202
Y Loss: 1.059822
T Loss: 11.862465
X Loss: -3.487507
Epoch 599 
Overall Loss: 13.141246
Rec Loss: 8.888233
KL Loss: 4.253013
Y Loss: 1.033509
T Loss: 11.850281
X Loss: -3.478802
Epoch 649 
Overall Loss: 13.130531
Rec Loss: 8.863089
KL Loss: 4.267442
Y Loss: 1.021146
T Loss: 11.830114
X Loss: -3.477598
Epoch 699 
Overall Loss: 13.095835
Rec Loss: 8.833007
KL Loss: 4.262828
Y Loss: 1.015462
T Loss: 11.808659
X Loss: -3.483383
Epoch 749 
Overall Loss: 13.060966
Rec Loss: 8.812493
KL Loss: 4.248473
Y Loss: 0.988333
T Loss: 11.803071
X Loss: -3.484744
Epoch 799 
Overall Loss: 13.067514
Rec Loss: 8.821815
KL Loss: 4.245700
Y Loss: 1.012503
T Loss: 11.790758
X Loss: -3.475194
Epoch 849 
Overall Loss: 13.049028
Rec Loss: 8.818336
KL Loss: 4.230692
Y Loss: 1.000475
T Loss: 11.788637
X Loss: -3.470538
Epoch 899 
Overall Loss: 13.038036
Rec Loss: 8.811078
KL Loss: 4.226958
Y Loss: 0.982763
T Loss: 11.779664
X Loss: -3.459967
Epoch 949 
Overall Loss: 13.039327
Rec Loss: 8.802953
KL Loss: 4.236374
Y Loss: 0.978452
T Loss: 11.789411
X Loss: -3.475684
Epoch 999 
Overall Loss: 13.031515
Rec Loss: 8.793864
KL Loss: 4.237650
Y Loss: 0.968928
T Loss: 11.765719
X Loss: -3.456318
Epoch 1049 
Overall Loss: 13.014193
Rec Loss: 8.791029
KL Loss: 4.223164
Y Loss: 0.969521
T Loss: 11.760650
X Loss: -3.454382
Epoch 1099 
Overall Loss: 13.000210
Rec Loss: 8.738009
KL Loss: 4.262201
Y Loss: 0.965027
T Loss: 11.726881
X Loss: -3.471385
Epoch 1149 
Overall Loss: 12.948646
Rec Loss: 8.681800
KL Loss: 4.266846
Y Loss: 0.959093
T Loss: 11.675637
X Loss: -3.473384
Epoch 1199 
Overall Loss: 12.933404
Rec Loss: 8.574140
KL Loss: 4.359265
Y Loss: 1.004651
T Loss: 11.550892
X Loss: -3.479078
Epoch 1249 
Overall Loss: 12.878477
Rec Loss: 8.403320
KL Loss: 4.475157
Y Loss: 0.978130
T Loss: 11.421587
X Loss: -3.507333
Epoch 1299 
Overall Loss: 12.847754
Rec Loss: 8.331730
KL Loss: 4.516024
Y Loss: 0.955089
T Loss: 11.360865
X Loss: -3.506680
Epoch 1349 
Overall Loss: 12.805615
Rec Loss: 8.239350
KL Loss: 4.566266
Y Loss: 0.953597
T Loss: 11.298306
X Loss: -3.535755
Epoch 1399 
Overall Loss: 12.816716
Rec Loss: 8.239618
KL Loss: 4.577098
Y Loss: 0.973466
T Loss: 11.262976
X Loss: -3.510090
Epoch 1449 
Overall Loss: 12.781072
Rec Loss: 8.154497
KL Loss: 4.626575
Y Loss: 0.961835
T Loss: 11.234654
X Loss: -3.561075
Epoch 1499 
Overall Loss: 12.803775
Rec Loss: 8.141510
KL Loss: 4.662265
Y Loss: 0.988422
T Loss: 11.202913
X Loss: -3.555614
Epoch 1549 
Overall Loss: 12.774569
Rec Loss: 8.118009
KL Loss: 4.656560
Y Loss: 0.971431
T Loss: 11.195136
X Loss: -3.562842
Epoch 1599 
Overall Loss: 12.770507
Rec Loss: 8.127073
KL Loss: 4.643434
Y Loss: 0.970101
T Loss: 11.198718
X Loss: -3.556696
Epoch 1649 
Overall Loss: 12.754192
Rec Loss: 8.068393
KL Loss: 4.685799
Y Loss: 0.973849
T Loss: 11.171016
X Loss: -3.589548
Epoch 1699 
Overall Loss: 12.762148
Rec Loss: 8.056373
KL Loss: 4.705775
Y Loss: 0.941658
T Loss: 11.174910
X Loss: -3.589366
Epoch 1749 
Overall Loss: 12.731812
Rec Loss: 8.062042
KL Loss: 4.669771
Y Loss: 0.973881
T Loss: 11.173195
X Loss: -3.598094
Epoch 1799 
Overall Loss: 12.731716
Rec Loss: 8.035192
KL Loss: 4.696524
Y Loss: 0.969634
T Loss: 11.144998
X Loss: -3.594623
Epoch 1849 
Overall Loss: 12.737467
Rec Loss: 8.043352
KL Loss: 4.694115
Y Loss: 0.964921
T Loss: 11.177078
X Loss: -3.616187
Epoch 1899 
Overall Loss: 12.739176
Rec Loss: 8.033812
KL Loss: 4.705363
Y Loss: 0.959100
T Loss: 11.165733
X Loss: -3.611470
Epoch 1949 
Overall Loss: 12.723385
Rec Loss: 8.028715
KL Loss: 4.694670
Y Loss: 0.965476
T Loss: 11.163718
X Loss: -3.617741
Epoch 1999 
Overall Loss: 12.728484
Rec Loss: 8.033234
KL Loss: 4.695251
Y Loss: 0.992768
T Loss: 11.155160
X Loss: -3.618310
Epoch 2049 
Overall Loss: 12.700358
Rec Loss: 8.021454
KL Loss: 4.678904
Y Loss: 0.956084
T Loss: 11.173815
X Loss: -3.630402
Epoch 2099 
Overall Loss: 12.727224
Rec Loss: 8.039040
KL Loss: 4.688184
Y Loss: 0.973025
T Loss: 11.184193
X Loss: -3.631666
Epoch 2149 
Overall Loss: 12.725863
Rec Loss: 8.018652
KL Loss: 4.707210
Y Loss: 0.969218
T Loss: 11.169916
X Loss: -3.635873
Epoch 2199 
Overall Loss: 12.736492
Rec Loss: 8.047158
KL Loss: 4.689334
Y Loss: 0.990144
T Loss: 11.180404
X Loss: -3.628318
Epoch 2249 
Overall Loss: 12.700088
Rec Loss: 7.997311
KL Loss: 4.702776
Y Loss: 0.959458
T Loss: 11.169590
X Loss: -3.652008
Epoch 2299 
Overall Loss: 12.710321
Rec Loss: 8.018631
KL Loss: 4.691690
Y Loss: 0.986284
T Loss: 11.161874
X Loss: -3.636385
Epoch 2349 
Overall Loss: 12.713878
Rec Loss: 8.029026
KL Loss: 4.684852
Y Loss: 0.970534
T Loss: 11.178147
X Loss: -3.634388
Epoch 2399 
Overall Loss: 12.679770
Rec Loss: 7.974136
KL Loss: 4.705633
Y Loss: 0.940788
T Loss: 11.153755
X Loss: -3.650013
Epoch 2449 
Overall Loss: 12.710453
Rec Loss: 8.014113
KL Loss: 4.696340
Y Loss: 0.990677
T Loss: 11.158881
X Loss: -3.640106
Epoch 2499 
Overall Loss: 12.695886
Rec Loss: 7.974398
KL Loss: 4.721487
Y Loss: 0.985360
T Loss: 11.131743
X Loss: -3.650024
Epoch 2549 
Overall Loss: 12.717244
Rec Loss: 8.026066
KL Loss: 4.691178
Y Loss: 0.982163
T Loss: 11.170801
X Loss: -3.635816
Epoch 2599 
Overall Loss: 12.696589
Rec Loss: 7.979482
KL Loss: 4.717108
Y Loss: 0.957339
T Loss: 11.153199
X Loss: -3.652387
Epoch 2649 
Overall Loss: 12.674881
Rec Loss: 7.966751
KL Loss: 4.708130
Y Loss: 0.951666
T Loss: 11.149508
X Loss: -3.658590
Epoch 2699 
Overall Loss: 12.692313
Rec Loss: 7.987291
KL Loss: 4.705022
Y Loss: 0.969434
T Loss: 11.165083
X Loss: -3.662509
Epoch 2749 
Overall Loss: 12.668785
Rec Loss: 7.985876
KL Loss: 4.682910
Y Loss: 0.987325
T Loss: 11.148030
X Loss: -3.655817
Epoch 2799 
Overall Loss: 12.684858
Rec Loss: 7.963922
KL Loss: 4.720937
Y Loss: 0.970033
T Loss: 11.140218
X Loss: -3.661312
Epoch 2849 
Overall Loss: 12.679790
Rec Loss: 7.968345
KL Loss: 4.711444
Y Loss: 0.983929
T Loss: 11.154551
X Loss: -3.678171
Epoch 2899 
Overall Loss: 12.693271
Rec Loss: 7.978278
KL Loss: 4.714992
Y Loss: 0.963948
T Loss: 11.148641
X Loss: -3.652337
Epoch 2949 
Overall Loss: 12.677609
Rec Loss: 7.953731
KL Loss: 4.723878
Y Loss: 0.946806
T Loss: 11.156933
X Loss: -3.676604
Epoch 2999 
Overall Loss: 12.690872
Rec Loss: 7.970911
KL Loss: 4.719961
Y Loss: 0.979205
T Loss: 11.164768
X Loss: -3.683459
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.584415
Epoch 99
Rec Loss: 2.589553
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 1.999927
Epoch 99
Rec Loss: 2.001100
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.579593
Insample Error 2.771630
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.568480
Epoch 99 
Prediction Loss: 3.342255
Epoch 149 
Prediction Loss: 3.179429
Epoch 199 
Prediction Loss: 3.068511
Epoch 249 
Prediction Loss: 2.991016
Epoch 299 
Prediction Loss: 2.839622
Epoch 349 
Prediction Loss: 2.732888
Epoch 399 
Prediction Loss: 2.650119
Epoch 449 
Prediction Loss: 2.526663
Epoch 499 
Prediction Loss: 2.470423
Epoch 549 
Prediction Loss: 2.240509
Epoch 599 
Prediction Loss: 2.132474
Epoch 649 
Prediction Loss: 2.074283
Epoch 699 
Prediction Loss: 2.000281
Epoch 749 
Prediction Loss: 1.933470
Epoch 799 
Prediction Loss: 1.806393
Epoch 849 
Prediction Loss: 1.783740
Epoch 899 
Prediction Loss: 1.717596
Epoch 949 
Prediction Loss: 1.634041
Epoch 999 
Prediction Loss: 1.595147
Epoch 1049 
Prediction Loss: 1.571166
Epoch 1099 
Prediction Loss: 1.523075
Epoch 1149 
Prediction Loss: 1.498696
Epoch 1199 
Prediction Loss: 1.470376
Epoch 1249 
Prediction Loss: 1.410469
Epoch 1299 
Prediction Loss: 1.431093
Epoch 1349 
Prediction Loss: 1.414835
Epoch 1399 
Prediction Loss: 1.390663
Epoch 1449 
Prediction Loss: 1.323529
Epoch 1499 
Prediction Loss: 1.315215
Epoch 1549 
Prediction Loss: 1.297161
Epoch 1599 
Prediction Loss: 1.264287
Epoch 1649 
Prediction Loss: 1.226445
Epoch 1699 
Prediction Loss: 1.228513
Epoch 1749 
Prediction Loss: 1.307672
Epoch 1799 
Prediction Loss: 1.208617
Epoch 1849 
Prediction Loss: 1.180687
Epoch 1899 
Prediction Loss: 1.172789
Epoch 1949 
Prediction Loss: 1.162220
Epoch 1999 
Prediction Loss: 1.170081
Epoch 2049 
Prediction Loss: 1.150233
Epoch 2099 
Prediction Loss: 1.127837
Epoch 2149 
Prediction Loss: 1.111861
Epoch 2199 
Prediction Loss: 1.117081
Epoch 2249 
Prediction Loss: 1.113171
Epoch 2299 
Prediction Loss: 1.109672
Epoch 2349 
Prediction Loss: 1.082363
Epoch 2399 
Prediction Loss: 1.145187
Epoch 2449 
Prediction Loss: 1.104796
Epoch 2499 
Prediction Loss: 1.060648
Epoch 2549 
Prediction Loss: 1.031155
Epoch 2599 
Prediction Loss: 1.039773
Epoch 2649 
Prediction Loss: 1.036339
Epoch 2699 
Prediction Loss: 1.036637
Epoch 2749 
Prediction Loss: 1.002437
Epoch 2799 
Prediction Loss: 1.001308
Epoch 2849 
Prediction Loss: 1.092976
Epoch 2899 
Prediction Loss: 1.006999
Epoch 2949 
Prediction Loss: 0.999058
Epoch 2999 
Prediction Loss: 0.990356
Epoch 3049 
Prediction Loss: 1.050491
Epoch 3099 
Prediction Loss: 0.996238
Epoch 3149 
Prediction Loss: 1.004254
Epoch 3199 
Prediction Loss: 0.982893
Epoch 3249 
Prediction Loss: 0.975620
Epoch 3299 
Prediction Loss: 0.990459
Epoch 3349 
Prediction Loss: 0.964305
Epoch 3399 
Prediction Loss: 0.956857
Epoch 3449 
Prediction Loss: 0.958662
Epoch 3499 
Prediction Loss: 0.950396
Epoch 3549 
Prediction Loss: 0.954698
Epoch 3599 
Prediction Loss: 0.929769
Epoch 3649 
Prediction Loss: 1.020638
Epoch 3699 
Prediction Loss: 0.954377
Epoch 3749 
Prediction Loss: 0.961596
Epoch 3799 
Prediction Loss: 0.949147
Epoch 3849 
Prediction Loss: 0.927746
Epoch 3899 
Prediction Loss: 0.926469
Epoch 3949 
Prediction Loss: 0.911106
Epoch 3999 
Prediction Loss: 0.939250
Epoch 4049 
Prediction Loss: 0.945814
Epoch 4099 
Prediction Loss: 0.959463
Epoch 4149 
Prediction Loss: 0.910405
Epoch 4199 
Prediction Loss: 0.937830
Epoch 4249 
Prediction Loss: 0.906708
Epoch 4299 
Prediction Loss: 0.912474
Epoch 4349 
Prediction Loss: 0.900793
Epoch 4399 
Prediction Loss: 0.918586
Epoch 4449 
Prediction Loss: 0.928366
Epoch 4499 
Prediction Loss: 0.908759
Epoch 4549 
Prediction Loss: 0.901441
Epoch 4599 
Prediction Loss: 0.950267
Epoch 4649 
Prediction Loss: 0.907177
Epoch 4699 
Prediction Loss: 0.901228
Epoch 4749 
Prediction Loss: 0.911336
Epoch 4799 
Prediction Loss: 0.899018
Epoch 4849 
Prediction Loss: 0.879652
Epoch 4899 
Prediction Loss: 0.878571
Epoch 4949 
Prediction Loss: 0.881090
Epoch 4999 
Prediction Loss: 0.885435
Epoch 5049 
Prediction Loss: 0.886178
Epoch 5099 
Prediction Loss: 0.857069
Epoch 5149 
Prediction Loss: 0.880964
Epoch 5199 
Prediction Loss: 0.872026
Epoch 5249 
Prediction Loss: 0.885976
Epoch 5299 
Prediction Loss: 0.873295
Epoch 5349 
Prediction Loss: 0.876687
Epoch 5399 
Prediction Loss: 0.881720
Epoch 5449 
Prediction Loss: 0.885340
Epoch 5499 
Prediction Loss: 0.861945
Epoch 5549 
Prediction Loss: 0.888701
Epoch 5599 
Prediction Loss: 0.848340
Epoch 5649 
Prediction Loss: 0.864787
Epoch 5699 
Prediction Loss: 0.859038
Epoch 5749 
Prediction Loss: 0.853239
Epoch 5799 
Prediction Loss: 0.879057
Epoch 5849 
Prediction Loss: 0.868758
Epoch 5899 
Prediction Loss: 0.854664
Epoch 5949 
Prediction Loss: 0.842828
Epoch 5999 
Prediction Loss: 0.865944
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.919744
Insample Error 4.312776
[31m========== repeat time 7 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.515757
Rec Loss: 11.750924
KL Loss: 1.764833
Y Loss: 1.039282
T Loss: 11.231282
Epoch 99 
Overall Loss: 13.353635
Rec Loss: 11.338092
KL Loss: 2.015542
Y Loss: 0.967004
T Loss: 10.854590
Epoch 149 
Overall Loss: 13.324320
Rec Loss: 11.321439
KL Loss: 2.002881
Y Loss: 0.988963
T Loss: 10.826957
Epoch 199 
Overall Loss: 13.291073
Rec Loss: 11.304015
KL Loss: 1.987058
Y Loss: 0.987898
T Loss: 10.810067
Epoch 249 
Overall Loss: 13.239309
Rec Loss: 11.017787
KL Loss: 2.221522
Y Loss: 0.934398
T Loss: 10.550588
Epoch 299 
Overall Loss: 13.197269
Rec Loss: 10.968204
KL Loss: 2.229065
Y Loss: 0.932514
T Loss: 10.501947
Epoch 349 
Overall Loss: 13.224709
Rec Loss: 10.981032
KL Loss: 2.243677
Y Loss: 0.966347
T Loss: 10.497858
Epoch 399 
Overall Loss: 13.161343
Rec Loss: 10.951243
KL Loss: 2.210099
Y Loss: 0.971354
T Loss: 10.465566
Epoch 449 
Overall Loss: 13.160129
Rec Loss: 10.940923
KL Loss: 2.219207
Y Loss: 0.961459
T Loss: 10.460193
Epoch 499 
Overall Loss: 13.161055
Rec Loss: 10.937686
KL Loss: 2.223369
Y Loss: 0.954055
T Loss: 10.460658
Epoch 549 
Overall Loss: 13.185179
Rec Loss: 10.958282
KL Loss: 2.226896
Y Loss: 0.971186
T Loss: 10.472689
Epoch 599 
Overall Loss: 13.163520
Rec Loss: 10.948402
KL Loss: 2.215118
Y Loss: 0.975897
T Loss: 10.460454
Epoch 649 
Overall Loss: 13.151051
Rec Loss: 10.940111
KL Loss: 2.210941
Y Loss: 0.954134
T Loss: 10.463043
Epoch 699 
Overall Loss: 13.127272
Rec Loss: 10.927374
KL Loss: 2.199898
Y Loss: 0.962054
T Loss: 10.446347
Epoch 749 
Overall Loss: 13.118206
Rec Loss: 10.904644
KL Loss: 2.213561
Y Loss: 0.938289
T Loss: 10.435500
Epoch 799 
Overall Loss: 13.118109
Rec Loss: 10.903362
KL Loss: 2.214748
Y Loss: 0.944905
T Loss: 10.430909
Epoch 849 
Overall Loss: 13.116453
Rec Loss: 10.908343
KL Loss: 2.208110
Y Loss: 0.941034
T Loss: 10.437827
Epoch 899 
Overall Loss: 13.128816
Rec Loss: 10.925720
KL Loss: 2.203096
Y Loss: 0.941492
T Loss: 10.454974
Epoch 949 
Overall Loss: 13.127327
Rec Loss: 10.916474
KL Loss: 2.210853
Y Loss: 0.961123
T Loss: 10.435912
Epoch 999 
Overall Loss: 13.119445
Rec Loss: 10.910096
KL Loss: 2.209349
Y Loss: 0.973730
T Loss: 10.423231
Epoch 1049 
Overall Loss: 13.096554
Rec Loss: 10.900768
KL Loss: 2.195786
Y Loss: 0.973358
T Loss: 10.414089
Epoch 1099 
Overall Loss: 13.085459
Rec Loss: 10.875461
KL Loss: 2.209998
Y Loss: 0.956635
T Loss: 10.397143
Epoch 1149 
Overall Loss: 13.096348
Rec Loss: 10.886513
KL Loss: 2.209835
Y Loss: 0.952882
T Loss: 10.410071
Epoch 1199 
Overall Loss: 13.094516
Rec Loss: 10.877661
KL Loss: 2.216855
Y Loss: 0.944294
T Loss: 10.405514
Epoch 1249 
Overall Loss: 13.079378
Rec Loss: 10.861910
KL Loss: 2.217467
Y Loss: 0.937554
T Loss: 10.393133
Epoch 1299 
Overall Loss: 13.086616
Rec Loss: 10.883140
KL Loss: 2.203476
Y Loss: 0.942291
T Loss: 10.411994
Epoch 1349 
Overall Loss: 13.086984
Rec Loss: 10.894906
KL Loss: 2.192078
Y Loss: 0.972495
T Loss: 10.408658
Epoch 1399 
Overall Loss: 13.087117
Rec Loss: 10.868056
KL Loss: 2.219060
Y Loss: 0.921187
T Loss: 10.407463
Epoch 1449 
Overall Loss: 13.092221
Rec Loss: 10.881076
KL Loss: 2.211145
Y Loss: 0.915314
T Loss: 10.423419
Epoch 1499 
Overall Loss: 13.050779
Rec Loss: 10.858351
KL Loss: 2.192428
Y Loss: 0.946327
T Loss: 10.385188
Epoch 1549 
Overall Loss: 13.062484
Rec Loss: 10.858231
KL Loss: 2.204254
Y Loss: 0.944795
T Loss: 10.385833
Epoch 1599 
Overall Loss: 13.086566
Rec Loss: 10.895687
KL Loss: 2.190879
Y Loss: 0.960838
T Loss: 10.415268
Epoch 1649 
Overall Loss: 13.048322
Rec Loss: 10.853436
KL Loss: 2.194887
Y Loss: 0.955884
T Loss: 10.375493
Epoch 1699 
Overall Loss: 13.047634
Rec Loss: 10.832318
KL Loss: 2.215316
Y Loss: 0.931770
T Loss: 10.366433
Epoch 1749 
Overall Loss: 13.086713
Rec Loss: 10.883778
KL Loss: 2.202935
Y Loss: 0.949044
T Loss: 10.409256
Epoch 1799 
Overall Loss: 13.050545
Rec Loss: 10.838817
KL Loss: 2.211728
Y Loss: 0.915356
T Loss: 10.381139
Epoch 1849 
Overall Loss: 13.043561
Rec Loss: 10.840865
KL Loss: 2.202696
Y Loss: 0.932704
T Loss: 10.374513
Epoch 1899 
Overall Loss: 13.062743
Rec Loss: 10.831023
KL Loss: 2.231720
Y Loss: 0.939944
T Loss: 10.361051
Epoch 1949 
Overall Loss: 13.047067
Rec Loss: 10.857065
KL Loss: 2.190002
Y Loss: 0.943244
T Loss: 10.385443
Epoch 1999 
Overall Loss: 13.040039
Rec Loss: 10.842633
KL Loss: 2.197407
Y Loss: 0.945290
T Loss: 10.369987
Epoch 2049 
Overall Loss: 13.032718
Rec Loss: 10.843157
KL Loss: 2.189561
Y Loss: 0.929000
T Loss: 10.378657
Epoch 2099 
Overall Loss: 13.028731
Rec Loss: 10.819263
KL Loss: 2.209468
Y Loss: 0.913702
T Loss: 10.362412
Epoch 2149 
Overall Loss: 13.037991
Rec Loss: 10.825489
KL Loss: 2.212502
Y Loss: 0.939423
T Loss: 10.355778
Epoch 2199 
Overall Loss: 13.030648
Rec Loss: 10.821891
KL Loss: 2.208757
Y Loss: 0.942353
T Loss: 10.350715
Epoch 2249 
Overall Loss: 13.004112
Rec Loss: 10.811677
KL Loss: 2.192435
Y Loss: 0.921737
T Loss: 10.350809
Epoch 2299 
Overall Loss: 13.011978
Rec Loss: 10.804279
KL Loss: 2.207698
Y Loss: 0.920804
T Loss: 10.343878
Epoch 2349 
Overall Loss: 13.005355
Rec Loss: 10.815378
KL Loss: 2.189977
Y Loss: 0.942854
T Loss: 10.343951
Epoch 2399 
Overall Loss: 13.036748
Rec Loss: 10.820726
KL Loss: 2.216021
Y Loss: 0.941154
T Loss: 10.350149
Epoch 2449 
Overall Loss: 12.998743
Rec Loss: 10.804422
KL Loss: 2.194320
Y Loss: 0.930747
T Loss: 10.339049
Epoch 2499 
Overall Loss: 13.037578
Rec Loss: 10.818275
KL Loss: 2.219303
Y Loss: 0.933448
T Loss: 10.351551
Epoch 2549 
Overall Loss: 13.000524
Rec Loss: 10.835894
KL Loss: 2.164629
Y Loss: 0.971969
T Loss: 10.349910
Epoch 2599 
Overall Loss: 13.008124
Rec Loss: 10.819700
KL Loss: 2.188423
Y Loss: 0.925631
T Loss: 10.356885
Epoch 2649 
Overall Loss: 12.984652
Rec Loss: 10.794412
KL Loss: 2.190240
Y Loss: 0.914300
T Loss: 10.337262
Epoch 2699 
Overall Loss: 12.968158
Rec Loss: 10.796094
KL Loss: 2.172063
Y Loss: 0.930392
T Loss: 10.330898
Epoch 2749 
Overall Loss: 12.990457
Rec Loss: 10.799300
KL Loss: 2.191156
Y Loss: 0.948651
T Loss: 10.324975
Epoch 2799 
Overall Loss: 13.000264
Rec Loss: 10.802768
KL Loss: 2.197496
Y Loss: 0.944244
T Loss: 10.330646
Epoch 2849 
Overall Loss: 12.981988
Rec Loss: 10.796796
KL Loss: 2.185192
Y Loss: 0.913959
T Loss: 10.339816
Epoch 2899 
Overall Loss: 12.981956
Rec Loss: 10.803867
KL Loss: 2.178089
Y Loss: 0.950625
T Loss: 10.328554
Epoch 2949 
Overall Loss: 12.989552
Rec Loss: 10.788995
KL Loss: 2.200557
Y Loss: 0.952803
T Loss: 10.312594
Epoch 2999 
Overall Loss: 12.971233
Rec Loss: 10.784711
KL Loss: 2.186522
Y Loss: 0.936457
T Loss: 10.316483
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.041820
Epoch 99
Rec Loss: 2.055112
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.964190
Epoch 99
Rec Loss: 9.924066
Epoch 149
Rec Loss: 9.927559
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.651004
Insample Error: 2.033470
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.135273
Rec Loss: 18.084243
KL Loss: 3.051029
Y Loss: 8.334605
T Loss: 12.920617
X Loss: 0.996324
Epoch 99 
Overall Loss: 16.312238
Rec Loss: 12.802115
KL Loss: 3.510123
Y Loss: 2.869136
T Loss: 12.898702
X Loss: -1.531155
Epoch 149 
Overall Loss: 14.655374
Rec Loss: 11.105697
KL Loss: 3.549677
Y Loss: 2.051567
T Loss: 12.613263
X Loss: -2.533349
Epoch 199 
Overall Loss: 14.101867
Rec Loss: 10.366115
KL Loss: 3.735752
Y Loss: 1.527899
T Loss: 12.481912
X Loss: -2.879746
Epoch 249 
Overall Loss: 13.803740
Rec Loss: 9.940496
KL Loss: 3.863244
Y Loss: 1.351041
T Loss: 12.346544
X Loss: -3.081568
Epoch 299 
Overall Loss: 13.597835
Rec Loss: 9.633290
KL Loss: 3.964545
Y Loss: 1.268305
T Loss: 12.204509
X Loss: -3.205371
Epoch 349 
Overall Loss: 13.470007
Rec Loss: 9.388558
KL Loss: 4.081449
Y Loss: 1.217389
T Loss: 12.106971
X Loss: -3.327107
Epoch 399 
Overall Loss: 13.352703
Rec Loss: 9.200257
KL Loss: 4.152446
Y Loss: 1.203016
T Loss: 12.000392
X Loss: -3.401643
Epoch 449 
Overall Loss: 13.279400
Rec Loss: 9.039483
KL Loss: 4.239917
Y Loss: 1.143149
T Loss: 11.950433
X Loss: -3.482525
Epoch 499 
Overall Loss: 13.211344
Rec Loss: 8.927105
KL Loss: 4.284239
Y Loss: 1.133598
T Loss: 11.886689
X Loss: -3.526382
Epoch 549 
Overall Loss: 13.194872
Rec Loss: 8.855384
KL Loss: 4.339488
Y Loss: 1.117312
T Loss: 11.844685
X Loss: -3.547956
Epoch 599 
Overall Loss: 13.119123
Rec Loss: 8.703133
KL Loss: 4.415990
Y Loss: 1.087482
T Loss: 11.770058
X Loss: -3.610667
Epoch 649 
Overall Loss: 13.039357
Rec Loss: 8.471859
KL Loss: 4.567498
Y Loss: 1.090969
T Loss: 11.553360
X Loss: -3.626986
Epoch 699 
Overall Loss: 12.966208
Rec Loss: 8.252137
KL Loss: 4.714071
Y Loss: 1.068265
T Loss: 11.379629
X Loss: -3.661624
Epoch 749 
Overall Loss: 12.909052
Rec Loss: 8.138426
KL Loss: 4.770626
Y Loss: 1.032398
T Loss: 11.289173
X Loss: -3.666946
Epoch 799 
Overall Loss: 12.886984
Rec Loss: 8.081207
KL Loss: 4.805777
Y Loss: 1.028352
T Loss: 11.248717
X Loss: -3.681686
Epoch 849 
Overall Loss: 12.875459
Rec Loss: 8.079049
KL Loss: 4.796411
Y Loss: 1.016189
T Loss: 11.240945
X Loss: -3.669991
Epoch 899 
Overall Loss: 12.858818
Rec Loss: 8.058622
KL Loss: 4.800196
Y Loss: 1.032717
T Loss: 11.211309
X Loss: -3.669045
Epoch 949 
Overall Loss: 12.862905
Rec Loss: 8.063072
KL Loss: 4.799834
Y Loss: 1.016557
T Loss: 11.222443
X Loss: -3.667650
Epoch 999 
Overall Loss: 12.829524
Rec Loss: 8.019800
KL Loss: 4.809723
Y Loss: 1.014282
T Loss: 11.185564
X Loss: -3.672905
Epoch 1049 
Overall Loss: 12.837689
Rec Loss: 8.037066
KL Loss: 4.800623
Y Loss: 1.029427
T Loss: 11.203904
X Loss: -3.681551
Epoch 1099 
Overall Loss: 12.813788
Rec Loss: 8.013831
KL Loss: 4.799957
Y Loss: 1.020276
T Loss: 11.188371
X Loss: -3.684678
Epoch 1149 
Overall Loss: 12.800620
Rec Loss: 8.018550
KL Loss: 4.782070
Y Loss: 0.980192
T Loss: 11.190603
X Loss: -3.662150
Epoch 1199 
Overall Loss: 12.802345
Rec Loss: 8.004317
KL Loss: 4.798028
Y Loss: 0.983709
T Loss: 11.196021
X Loss: -3.683558
Epoch 1249 
Overall Loss: 12.828412
Rec Loss: 8.020513
KL Loss: 4.807898
Y Loss: 0.976686
T Loss: 11.202124
X Loss: -3.669954
Epoch 1299 
Overall Loss: 12.782218
Rec Loss: 8.003787
KL Loss: 4.778431
Y Loss: 0.980587
T Loss: 11.192770
X Loss: -3.679277
Epoch 1349 
Overall Loss: 12.768149
Rec Loss: 7.977281
KL Loss: 4.790868
Y Loss: 0.968727
T Loss: 11.175577
X Loss: -3.682659
Epoch 1399 
Overall Loss: 12.770935
Rec Loss: 7.989024
KL Loss: 4.781911
Y Loss: 0.974772
T Loss: 11.179315
X Loss: -3.677677
Epoch 1449 
Overall Loss: 12.748452
Rec Loss: 7.971346
KL Loss: 4.777105
Y Loss: 0.971354
T Loss: 11.163723
X Loss: -3.678054
Epoch 1499 
Overall Loss: 12.737668
Rec Loss: 7.953262
KL Loss: 4.784406
Y Loss: 0.970350
T Loss: 11.149716
X Loss: -3.681629
Epoch 1549 
Overall Loss: 12.744298
Rec Loss: 7.948971
KL Loss: 4.795327
Y Loss: 0.959003
T Loss: 11.165958
X Loss: -3.696489
Epoch 1599 
Overall Loss: 12.758797
Rec Loss: 7.952560
KL Loss: 4.806236
Y Loss: 0.976785
T Loss: 11.145121
X Loss: -3.680953
Epoch 1649 
Overall Loss: 12.740281
Rec Loss: 7.912574
KL Loss: 4.827708
Y Loss: 0.928137
T Loss: 11.139502
X Loss: -3.690997
Epoch 1699 
Overall Loss: 12.704187
Rec Loss: 7.881869
KL Loss: 4.822318
Y Loss: 0.968319
T Loss: 11.093238
X Loss: -3.695529
Epoch 1749 
Overall Loss: 12.700189
Rec Loss: 7.823909
KL Loss: 4.876280
Y Loss: 0.977520
T Loss: 11.039301
X Loss: -3.704152
Epoch 1799 
Overall Loss: 12.666046
Rec Loss: 7.777529
KL Loss: 4.888517
Y Loss: 0.973746
T Loss: 10.980040
X Loss: -3.689384
Epoch 1849 
Overall Loss: 12.665514
Rec Loss: 7.732858
KL Loss: 4.932656
Y Loss: 0.960695
T Loss: 10.945087
X Loss: -3.692577
Epoch 1899 
Overall Loss: 12.667205
Rec Loss: 7.708265
KL Loss: 4.958940
Y Loss: 0.965787
T Loss: 10.899127
X Loss: -3.673756
Epoch 1949 
Overall Loss: 12.669200
Rec Loss: 7.694014
KL Loss: 4.975186
Y Loss: 0.988648
T Loss: 10.882242
X Loss: -3.682552
Epoch 1999 
Overall Loss: 12.665413
Rec Loss: 7.676815
KL Loss: 4.988598
Y Loss: 0.984260
T Loss: 10.882631
X Loss: -3.697946
Epoch 2049 
Overall Loss: 12.652997
Rec Loss: 7.649924
KL Loss: 5.003073
Y Loss: 0.956927
T Loss: 10.876720
X Loss: -3.705259
Epoch 2099 
Overall Loss: 12.655946
Rec Loss: 7.640927
KL Loss: 5.015019
Y Loss: 0.957031
T Loss: 10.860760
X Loss: -3.698348
Epoch 2149 
Overall Loss: 12.640869
Rec Loss: 7.649135
KL Loss: 4.991733
Y Loss: 0.966171
T Loss: 10.849794
X Loss: -3.683744
Epoch 2199 
Overall Loss: 12.657817
Rec Loss: 7.653526
KL Loss: 5.004291
Y Loss: 0.964502
T Loss: 10.865786
X Loss: -3.694510
Epoch 2249 
Overall Loss: 12.641845
Rec Loss: 7.637956
KL Loss: 5.003889
Y Loss: 0.965005
T Loss: 10.848655
X Loss: -3.693202
Epoch 2299 
Overall Loss: 12.640725
Rec Loss: 7.642819
KL Loss: 4.997906
Y Loss: 0.960335
T Loss: 10.846795
X Loss: -3.684143
Epoch 2349 
Overall Loss: 12.649175
Rec Loss: 7.623981
KL Loss: 5.025193
Y Loss: 0.959502
T Loss: 10.828279
X Loss: -3.684049
Epoch 2399 
Overall Loss: 12.619729
Rec Loss: 7.579669
KL Loss: 5.040060
Y Loss: 0.968441
T Loss: 10.814118
X Loss: -3.718670
Epoch 2449 
Overall Loss: 12.625567
Rec Loss: 7.615523
KL Loss: 5.010044
Y Loss: 0.957717
T Loss: 10.837817
X Loss: -3.701152
Epoch 2499 
Overall Loss: 12.649210
Rec Loss: 7.612559
KL Loss: 5.036651
Y Loss: 0.965251
T Loss: 10.850449
X Loss: -3.720516
Epoch 2549 
Overall Loss: 12.638003
Rec Loss: 7.613765
KL Loss: 5.024238
Y Loss: 0.970021
T Loss: 10.840019
X Loss: -3.711265
Epoch 2599 
Overall Loss: 12.633367
Rec Loss: 7.605865
KL Loss: 5.027502
Y Loss: 0.957217
T Loss: 10.834112
X Loss: -3.706856
Epoch 2649 
Overall Loss: 12.616529
Rec Loss: 7.601168
KL Loss: 5.015361
Y Loss: 0.963713
T Loss: 10.836806
X Loss: -3.717494
Epoch 2699 
Overall Loss: 12.592210
Rec Loss: 7.576964
KL Loss: 5.015246
Y Loss: 0.957426
T Loss: 10.829779
X Loss: -3.731529
Epoch 2749 
Overall Loss: 12.625242
Rec Loss: 7.598775
KL Loss: 5.026466
Y Loss: 0.958009
T Loss: 10.821562
X Loss: -3.701792
Epoch 2799 
Overall Loss: 12.608280
Rec Loss: 7.597491
KL Loss: 5.010789
Y Loss: 0.954297
T Loss: 10.831664
X Loss: -3.711322
Epoch 2849 
Overall Loss: 12.627554
Rec Loss: 7.615422
KL Loss: 5.012132
Y Loss: 0.982905
T Loss: 10.835727
X Loss: -3.711758
Epoch 2899 
Overall Loss: 12.622477
Rec Loss: 7.593368
KL Loss: 5.029109
Y Loss: 0.951211
T Loss: 10.823093
X Loss: -3.705330
Epoch 2949 
Overall Loss: 12.636347
Rec Loss: 7.625264
KL Loss: 5.011083
Y Loss: 0.979488
T Loss: 10.838640
X Loss: -3.703119
Epoch 2999 
Overall Loss: 12.614064
Rec Loss: 7.602937
KL Loss: 5.011127
Y Loss: 0.967819
T Loss: 10.818542
X Loss: -3.699514
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.419348
Epoch 99
Rec Loss: 2.420527
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.012451
Epoch 99
Rec Loss: 2.000606
Epoch 149
Rec Loss: 2.000660
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.575684
Insample Error 2.797604
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.589398
Epoch 99 
Prediction Loss: 3.380549
Epoch 149 
Prediction Loss: 3.155168
Epoch 199 
Prediction Loss: 3.062161
Epoch 249 
Prediction Loss: 2.848140
Epoch 299 
Prediction Loss: 2.730828
Epoch 349 
Prediction Loss: 2.611062
Epoch 399 
Prediction Loss: 2.540466
Epoch 449 
Prediction Loss: 2.346417
Epoch 499 
Prediction Loss: 2.286857
Epoch 549 
Prediction Loss: 2.250398
Epoch 599 
Prediction Loss: 2.121081
Epoch 649 
Prediction Loss: 1.979845
Epoch 699 
Prediction Loss: 1.908539
Epoch 749 
Prediction Loss: 1.909873
Epoch 799 
Prediction Loss: 1.902702
Epoch 849 
Prediction Loss: 1.744662
Epoch 899 
Prediction Loss: 1.718212
Epoch 949 
Prediction Loss: 1.709309
Epoch 999 
Prediction Loss: 1.630444
Epoch 1049 
Prediction Loss: 1.587905
Epoch 1099 
Prediction Loss: 1.565144
Epoch 1149 
Prediction Loss: 1.581954
Epoch 1199 
Prediction Loss: 1.520509
Epoch 1249 
Prediction Loss: 1.482990
Epoch 1299 
Prediction Loss: 1.434855
Epoch 1349 
Prediction Loss: 1.443330
Epoch 1399 
Prediction Loss: 1.443244
Epoch 1449 
Prediction Loss: 1.359202
Epoch 1499 
Prediction Loss: 1.373488
Epoch 1549 
Prediction Loss: 1.335202
Epoch 1599 
Prediction Loss: 1.297567
Epoch 1649 
Prediction Loss: 1.338846
Epoch 1699 
Prediction Loss: 1.264199
Epoch 1749 
Prediction Loss: 1.319813
Epoch 1799 
Prediction Loss: 1.311077
Epoch 1849 
Prediction Loss: 1.224277
Epoch 1899 
Prediction Loss: 1.201569
Epoch 1949 
Prediction Loss: 1.215008
Epoch 1999 
Prediction Loss: 1.219425
Epoch 2049 
Prediction Loss: 1.195854
Epoch 2099 
Prediction Loss: 1.176293
Epoch 2149 
Prediction Loss: 1.192889
Epoch 2199 
Prediction Loss: 1.166508
Epoch 2249 
Prediction Loss: 1.182881
Epoch 2299 
Prediction Loss: 1.191978
Epoch 2349 
Prediction Loss: 1.136711
Epoch 2399 
Prediction Loss: 1.114840
Epoch 2449 
Prediction Loss: 1.106574
Epoch 2499 
Prediction Loss: 1.093678
Epoch 2549 
Prediction Loss: 1.096769
Epoch 2599 
Prediction Loss: 1.093295
Epoch 2649 
Prediction Loss: 1.082753
Epoch 2699 
Prediction Loss: 1.078612
Epoch 2749 
Prediction Loss: 1.087896
Epoch 2799 
Prediction Loss: 1.066401
Epoch 2849 
Prediction Loss: 1.119389
Epoch 2899 
Prediction Loss: 1.073413
Epoch 2949 
Prediction Loss: 1.067702
Epoch 2999 
Prediction Loss: 1.039973
Epoch 3049 
Prediction Loss: 1.039273
Epoch 3099 
Prediction Loss: 1.042652
Epoch 3149 
Prediction Loss: 1.075474
Epoch 3199 
Prediction Loss: 1.013575
Epoch 3249 
Prediction Loss: 1.046467
Epoch 3299 
Prediction Loss: 0.999881
Epoch 3349 
Prediction Loss: 0.985827
Epoch 3399 
Prediction Loss: 1.018752
Epoch 3449 
Prediction Loss: 1.001519
Epoch 3499 
Prediction Loss: 0.987687
Epoch 3549 
Prediction Loss: 0.976904
Epoch 3599 
Prediction Loss: 0.988614
Epoch 3649 
Prediction Loss: 1.001432
Epoch 3699 
Prediction Loss: 0.956094
Epoch 3749 
Prediction Loss: 1.013632
Epoch 3799 
Prediction Loss: 0.964059
Epoch 3849 
Prediction Loss: 0.958351
Epoch 3899 
Prediction Loss: 0.967325
Epoch 3949 
Prediction Loss: 0.949526
Epoch 3999 
Prediction Loss: 1.024297
Epoch 4049 
Prediction Loss: 0.924762
Epoch 4099 
Prediction Loss: 0.946527
Epoch 4149 
Prediction Loss: 0.931910
Epoch 4199 
Prediction Loss: 0.959113
Epoch 4249 
Prediction Loss: 0.961979
Epoch 4299 
Prediction Loss: 0.923094
Epoch 4349 
Prediction Loss: 0.920240
Epoch 4399 
Prediction Loss: 0.983185
Epoch 4449 
Prediction Loss: 0.927289
Epoch 4499 
Prediction Loss: 0.908865
Epoch 4549 
Prediction Loss: 0.904377
Epoch 4599 
Prediction Loss: 0.949931
Epoch 4649 
Prediction Loss: 0.920745
Epoch 4699 
Prediction Loss: 0.886848
Epoch 4749 
Prediction Loss: 0.943138
Epoch 4799 
Prediction Loss: 0.897888
Epoch 4849 
Prediction Loss: 0.894877
Epoch 4899 
Prediction Loss: 0.898667
Epoch 4949 
Prediction Loss: 0.905494
Epoch 4999 
Prediction Loss: 0.879411
Epoch 5049 
Prediction Loss: 0.886229
Epoch 5099 
Prediction Loss: 0.894630
Epoch 5149 
Prediction Loss: 0.921407
Epoch 5199 
Prediction Loss: 0.907026
Epoch 5249 
Prediction Loss: 0.899538
Epoch 5299 
Prediction Loss: 0.895262
Epoch 5349 
Prediction Loss: 0.888656
Epoch 5399 
Prediction Loss: 0.859756
Epoch 5449 
Prediction Loss: 0.868863
Epoch 5499 
Prediction Loss: 0.885357
Epoch 5549 
Prediction Loss: 0.874161
Epoch 5599 
Prediction Loss: 0.861349
Epoch 5649 
Prediction Loss: 0.874402
Epoch 5699 
Prediction Loss: 0.866172
Epoch 5749 
Prediction Loss: 0.869162
Epoch 5799 
Prediction Loss: 0.841763
Epoch 5849 
Prediction Loss: 0.857934
Epoch 5899 
Prediction Loss: 0.860012
Epoch 5949 
Prediction Loss: 0.843919
Epoch 5999 
Prediction Loss: 0.856464
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.910658
Insample Error 4.231523
[31m========== repeat time 8 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.550265
Rec Loss: 11.730426
KL Loss: 1.819839
Y Loss: 1.026379
T Loss: 11.217236
Epoch 99 
Overall Loss: 13.388398
Rec Loss: 11.339569
KL Loss: 2.048829
Y Loss: 0.980593
T Loss: 10.849272
Epoch 149 
Overall Loss: 13.295322
Rec Loss: 11.141395
KL Loss: 2.153927
Y Loss: 0.980422
T Loss: 10.651184
Epoch 199 
Overall Loss: 13.261121
Rec Loss: 11.030319
KL Loss: 2.230802
Y Loss: 0.991207
T Loss: 10.534715
Epoch 249 
Overall Loss: 13.247095
Rec Loss: 10.995663
KL Loss: 2.251433
Y Loss: 0.967650
T Loss: 10.511837
Epoch 299 
Overall Loss: 13.236362
Rec Loss: 10.986840
KL Loss: 2.249521
Y Loss: 0.974998
T Loss: 10.499341
Epoch 349 
Overall Loss: 13.223098
Rec Loss: 11.000044
KL Loss: 2.223053
Y Loss: 0.999852
T Loss: 10.500119
Epoch 399 
Overall Loss: 13.182427
Rec Loss: 10.971975
KL Loss: 2.210452
Y Loss: 0.972135
T Loss: 10.485908
Epoch 449 
Overall Loss: 13.183429
Rec Loss: 10.956617
KL Loss: 2.226812
Y Loss: 0.960811
T Loss: 10.476211
Epoch 499 
Overall Loss: 13.172937
Rec Loss: 10.951702
KL Loss: 2.221235
Y Loss: 0.966500
T Loss: 10.468452
Epoch 549 
Overall Loss: 13.160710
Rec Loss: 10.964482
KL Loss: 2.196228
Y Loss: 0.993861
T Loss: 10.467552
Epoch 599 
Overall Loss: 13.176557
Rec Loss: 10.947550
KL Loss: 2.229007
Y Loss: 0.973639
T Loss: 10.460730
Epoch 649 
Overall Loss: 13.171920
Rec Loss: 10.934231
KL Loss: 2.237689
Y Loss: 0.957575
T Loss: 10.455443
Epoch 699 
Overall Loss: 13.140373
Rec Loss: 10.954935
KL Loss: 2.185438
Y Loss: 0.977322
T Loss: 10.466274
Epoch 749 
Overall Loss: 13.137758
Rec Loss: 10.938211
KL Loss: 2.199547
Y Loss: 0.972378
T Loss: 10.452022
Epoch 799 
Overall Loss: 13.131567
Rec Loss: 10.906463
KL Loss: 2.225104
Y Loss: 0.950106
T Loss: 10.431409
Epoch 849 
Overall Loss: 13.142476
Rec Loss: 10.933975
KL Loss: 2.208500
Y Loss: 0.961775
T Loss: 10.453088
Epoch 899 
Overall Loss: 13.109542
Rec Loss: 10.898944
KL Loss: 2.210598
Y Loss: 0.957189
T Loss: 10.420349
Epoch 949 
Overall Loss: 13.124128
Rec Loss: 10.909488
KL Loss: 2.214640
Y Loss: 0.932001
T Loss: 10.443487
Epoch 999 
Overall Loss: 13.100222
Rec Loss: 10.888722
KL Loss: 2.211500
Y Loss: 0.962623
T Loss: 10.407410
Epoch 1049 
Overall Loss: 13.108437
Rec Loss: 10.891841
KL Loss: 2.216596
Y Loss: 0.945668
T Loss: 10.419007
Epoch 1099 
Overall Loss: 13.116392
Rec Loss: 10.895732
KL Loss: 2.220660
Y Loss: 0.959085
T Loss: 10.416190
Epoch 1149 
Overall Loss: 13.105009
Rec Loss: 10.883098
KL Loss: 2.221910
Y Loss: 0.955948
T Loss: 10.405124
Epoch 1199 
Overall Loss: 13.118896
Rec Loss: 10.902021
KL Loss: 2.216875
Y Loss: 0.963114
T Loss: 10.420464
Epoch 1249 
Overall Loss: 13.124567
Rec Loss: 10.871723
KL Loss: 2.252844
Y Loss: 0.951692
T Loss: 10.395877
Epoch 1299 
Overall Loss: 13.110329
Rec Loss: 10.882355
KL Loss: 2.227975
Y Loss: 0.961418
T Loss: 10.401645
Epoch 1349 
Overall Loss: 13.098125
Rec Loss: 10.896914
KL Loss: 2.201212
Y Loss: 0.954803
T Loss: 10.419512
Epoch 1399 
Overall Loss: 13.090334
Rec Loss: 10.872142
KL Loss: 2.218192
Y Loss: 0.958306
T Loss: 10.392989
Epoch 1449 
Overall Loss: 13.092834
Rec Loss: 10.880414
KL Loss: 2.212420
Y Loss: 0.965571
T Loss: 10.397628
Epoch 1499 
Overall Loss: 13.078169
Rec Loss: 10.871849
KL Loss: 2.206321
Y Loss: 0.924297
T Loss: 10.409700
Epoch 1549 
Overall Loss: 13.076636
Rec Loss: 10.873619
KL Loss: 2.203017
Y Loss: 0.958554
T Loss: 10.394342
Epoch 1599 
Overall Loss: 13.081761
Rec Loss: 10.874443
KL Loss: 2.207318
Y Loss: 0.949048
T Loss: 10.399919
Epoch 1649 
Overall Loss: 13.053689
Rec Loss: 10.864982
KL Loss: 2.188707
Y Loss: 0.972130
T Loss: 10.378917
Epoch 1699 
Overall Loss: 13.068494
Rec Loss: 10.878509
KL Loss: 2.189985
Y Loss: 0.964798
T Loss: 10.396110
Epoch 1749 
Overall Loss: 13.052965
Rec Loss: 10.841425
KL Loss: 2.211540
Y Loss: 0.929310
T Loss: 10.376770
Epoch 1799 
Overall Loss: 13.077634
Rec Loss: 10.862837
KL Loss: 2.214798
Y Loss: 0.936471
T Loss: 10.394602
Epoch 1849 
Overall Loss: 13.035451
Rec Loss: 10.832868
KL Loss: 2.202583
Y Loss: 0.957289
T Loss: 10.354224
Epoch 1899 
Overall Loss: 13.070643
Rec Loss: 10.835959
KL Loss: 2.234685
Y Loss: 0.948465
T Loss: 10.361726
Epoch 1949 
Overall Loss: 13.032659
Rec Loss: 10.814982
KL Loss: 2.217677
Y Loss: 0.932353
T Loss: 10.348806
Epoch 1999 
Overall Loss: 13.048752
Rec Loss: 10.828938
KL Loss: 2.219813
Y Loss: 0.970995
T Loss: 10.343441
Epoch 2049 
Overall Loss: 13.037295
Rec Loss: 10.814190
KL Loss: 2.223105
Y Loss: 0.911845
T Loss: 10.358268
Epoch 2099 
Overall Loss: 13.034904
Rec Loss: 10.810680
KL Loss: 2.224225
Y Loss: 0.943751
T Loss: 10.338804
Epoch 2149 
Overall Loss: 13.039748
Rec Loss: 10.826962
KL Loss: 2.212786
Y Loss: 0.933394
T Loss: 10.360264
Epoch 2199 
Overall Loss: 13.033718
Rec Loss: 10.814511
KL Loss: 2.219207
Y Loss: 0.920244
T Loss: 10.354389
Epoch 2249 
Overall Loss: 13.022992
Rec Loss: 10.840557
KL Loss: 2.182435
Y Loss: 0.961654
T Loss: 10.359730
Epoch 2299 
Overall Loss: 13.019227
Rec Loss: 10.798762
KL Loss: 2.220466
Y Loss: 0.944897
T Loss: 10.326314
Epoch 2349 
Overall Loss: 13.025573
Rec Loss: 10.824255
KL Loss: 2.201318
Y Loss: 0.951535
T Loss: 10.348487
Epoch 2399 
Overall Loss: 13.020144
Rec Loss: 10.816224
KL Loss: 2.203921
Y Loss: 0.927628
T Loss: 10.352410
Epoch 2449 
Overall Loss: 13.014865
Rec Loss: 10.801137
KL Loss: 2.213728
Y Loss: 0.921511
T Loss: 10.340382
Epoch 2499 
Overall Loss: 13.002253
Rec Loss: 10.790208
KL Loss: 2.212045
Y Loss: 0.929012
T Loss: 10.325702
Epoch 2549 
Overall Loss: 13.010026
Rec Loss: 10.814655
KL Loss: 2.195371
Y Loss: 0.936670
T Loss: 10.346320
Epoch 2599 
Overall Loss: 12.990991
Rec Loss: 10.810495
KL Loss: 2.180497
Y Loss: 0.946876
T Loss: 10.337057
Epoch 2649 
Overall Loss: 13.011684
Rec Loss: 10.789754
KL Loss: 2.221930
Y Loss: 0.944770
T Loss: 10.317369
Epoch 2699 
Overall Loss: 12.975583
Rec Loss: 10.792900
KL Loss: 2.182683
Y Loss: 0.927442
T Loss: 10.329179
Epoch 2749 
Overall Loss: 12.985348
Rec Loss: 10.785621
KL Loss: 2.199727
Y Loss: 0.933211
T Loss: 10.319015
Epoch 2799 
Overall Loss: 12.982087
Rec Loss: 10.779555
KL Loss: 2.202532
Y Loss: 0.937924
T Loss: 10.310593
Epoch 2849 
Overall Loss: 12.988415
Rec Loss: 10.812932
KL Loss: 2.175483
Y Loss: 0.923156
T Loss: 10.351354
Epoch 2899 
Overall Loss: 13.002261
Rec Loss: 10.788787
KL Loss: 2.213474
Y Loss: 0.934620
T Loss: 10.321478
Epoch 2949 
Overall Loss: 12.971260
Rec Loss: 10.752330
KL Loss: 2.218930
Y Loss: 0.931686
T Loss: 10.286487
Epoch 2999 
Overall Loss: 12.994843
Rec Loss: 10.819997
KL Loss: 2.174845
Y Loss: 0.950198
T Loss: 10.344898
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.059624
Epoch 99
Rec Loss: 2.054767
Epoch 149
Rec Loss: 2.050494
Epoch 199
Rec Loss: 2.053992
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.935104
Epoch 99
Rec Loss: 9.915432
Epoch 149
Rec Loss: 9.913808
Epoch 199
Rec Loss: 9.896009
Epoch 249
Rec Loss: 9.902181
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.638534
Insample Error: 2.055245
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.294631
Rec Loss: 18.212507
KL Loss: 3.082123
Y Loss: 8.595398
T Loss: 13.019268
X Loss: 0.895541
Epoch 99 
Overall Loss: 16.324072
Rec Loss: 12.772855
KL Loss: 3.551217
Y Loss: 2.878576
T Loss: 12.903364
X Loss: -1.569796
Epoch 149 
Overall Loss: 15.115182
Rec Loss: 11.664086
KL Loss: 3.451095
Y Loss: 2.371861
T Loss: 12.852669
X Loss: -2.374513
Epoch 199 
Overall Loss: 14.479981
Rec Loss: 10.739975
KL Loss: 3.740006
Y Loss: 1.886475
T Loss: 12.610978
X Loss: -2.814240
Epoch 249 
Overall Loss: 14.106919
Rec Loss: 10.259141
KL Loss: 3.847777
Y Loss: 1.686025
T Loss: 12.451327
X Loss: -3.035198
Epoch 299 
Overall Loss: 13.691467
Rec Loss: 9.647349
KL Loss: 4.044117
Y Loss: 1.384753
T Loss: 12.163406
X Loss: -3.208434
Epoch 349 
Overall Loss: 13.428945
Rec Loss: 9.130756
KL Loss: 4.298190
Y Loss: 1.249985
T Loss: 11.816694
X Loss: -3.310931
Epoch 399 
Overall Loss: 13.320449
Rec Loss: 8.950525
KL Loss: 4.369924
Y Loss: 1.183274
T Loss: 11.762557
X Loss: -3.403669
Epoch 449 
Overall Loss: 13.273079
Rec Loss: 8.891160
KL Loss: 4.381919
Y Loss: 1.145397
T Loss: 11.767625
X Loss: -3.449163
Epoch 499 
Overall Loss: 13.203816
Rec Loss: 8.801042
KL Loss: 4.402774
Y Loss: 1.093700
T Loss: 11.751225
X Loss: -3.497033
Epoch 549 
Overall Loss: 13.189376
Rec Loss: 8.761734
KL Loss: 4.427642
Y Loss: 1.102910
T Loss: 11.752930
X Loss: -3.542650
Epoch 599 
Overall Loss: 13.158480
Rec Loss: 8.720097
KL Loss: 4.438383
Y Loss: 1.075447
T Loss: 11.742468
X Loss: -3.560095
Epoch 649 
Overall Loss: 13.126622
Rec Loss: 8.665181
KL Loss: 4.461442
Y Loss: 1.060168
T Loss: 11.713145
X Loss: -3.578048
Epoch 699 
Overall Loss: 13.102001
Rec Loss: 8.577552
KL Loss: 4.524449
Y Loss: 1.048948
T Loss: 11.669991
X Loss: -3.616913
Epoch 749 
Overall Loss: 13.064728
Rec Loss: 8.487272
KL Loss: 4.577456
Y Loss: 1.020509
T Loss: 11.628110
X Loss: -3.651093
Epoch 799 
Overall Loss: 13.006670
Rec Loss: 8.374025
KL Loss: 4.632646
Y Loss: 1.035365
T Loss: 11.545731
X Loss: -3.689389
Epoch 849 
Overall Loss: 12.977355
Rec Loss: 8.265079
KL Loss: 4.712276
Y Loss: 1.036412
T Loss: 11.495705
X Loss: -3.748833
Epoch 899 
Overall Loss: 12.932369
Rec Loss: 8.155161
KL Loss: 4.777208
Y Loss: 1.032580
T Loss: 11.426230
X Loss: -3.787359
Epoch 949 
Overall Loss: 12.897738
Rec Loss: 8.064446
KL Loss: 4.833292
Y Loss: 0.993058
T Loss: 11.387749
X Loss: -3.819832
Epoch 999 
Overall Loss: 12.895521
Rec Loss: 8.008854
KL Loss: 4.886667
Y Loss: 1.015615
T Loss: 11.331418
X Loss: -3.830372
Epoch 1049 
Overall Loss: 12.859946
Rec Loss: 7.958029
KL Loss: 4.901918
Y Loss: 1.016978
T Loss: 11.317438
X Loss: -3.867898
Epoch 1099 
Overall Loss: 12.854607
Rec Loss: 7.933849
KL Loss: 4.920757
Y Loss: 1.026267
T Loss: 11.303394
X Loss: -3.882679
Epoch 1149 
Overall Loss: 12.827797
Rec Loss: 7.886759
KL Loss: 4.941038
Y Loss: 1.013355
T Loss: 11.261344
X Loss: -3.881262
Epoch 1199 
Overall Loss: 12.821219
Rec Loss: 7.882102
KL Loss: 4.939117
Y Loss: 1.002510
T Loss: 11.251079
X Loss: -3.870232
Epoch 1249 
Overall Loss: 12.815287
Rec Loss: 7.866221
KL Loss: 4.949065
Y Loss: 1.025980
T Loss: 11.257446
X Loss: -3.904215
Epoch 1299 
Overall Loss: 12.810336
Rec Loss: 7.848520
KL Loss: 4.961816
Y Loss: 0.970444
T Loss: 11.253688
X Loss: -3.890390
Epoch 1349 
Overall Loss: 12.790715
Rec Loss: 7.825073
KL Loss: 4.965643
Y Loss: 0.971709
T Loss: 11.253091
X Loss: -3.913872
Epoch 1399 
Overall Loss: 12.778622
Rec Loss: 7.830800
KL Loss: 4.947821
Y Loss: 0.966681
T Loss: 11.249427
X Loss: -3.901968
Epoch 1449 
Overall Loss: 12.796165
Rec Loss: 7.837137
KL Loss: 4.959029
Y Loss: 1.007095
T Loss: 11.229342
X Loss: -3.895752
Epoch 1499 
Overall Loss: 12.763613
Rec Loss: 7.821352
KL Loss: 4.942261
Y Loss: 0.965768
T Loss: 11.229570
X Loss: -3.891102
Epoch 1549 
Overall Loss: 12.767746
Rec Loss: 7.805298
KL Loss: 4.962448
Y Loss: 0.974914
T Loss: 11.230898
X Loss: -3.913057
Epoch 1599 
Overall Loss: 12.739074
Rec Loss: 7.798377
KL Loss: 4.940697
Y Loss: 1.002448
T Loss: 11.210858
X Loss: -3.913705
Epoch 1649 
Overall Loss: 12.740191
Rec Loss: 7.787641
KL Loss: 4.952550
Y Loss: 0.967510
T Loss: 11.206641
X Loss: -3.902755
Epoch 1699 
Overall Loss: 12.744150
Rec Loss: 7.808119
KL Loss: 4.936031
Y Loss: 1.006776
T Loss: 11.212238
X Loss: -3.907507
Epoch 1749 
Overall Loss: 12.719681
Rec Loss: 7.768643
KL Loss: 4.951038
Y Loss: 0.977097
T Loss: 11.198804
X Loss: -3.918710
Epoch 1799 
Overall Loss: 12.745217
Rec Loss: 7.784271
KL Loss: 4.960946
Y Loss: 1.008105
T Loss: 11.197111
X Loss: -3.916893
Epoch 1849 
Overall Loss: 12.725992
Rec Loss: 7.775852
KL Loss: 4.950139
Y Loss: 0.995085
T Loss: 11.195357
X Loss: -3.917048
Epoch 1899 
Overall Loss: 12.744509
Rec Loss: 7.763790
KL Loss: 4.980720
Y Loss: 0.995544
T Loss: 11.178069
X Loss: -3.912051
Epoch 1949 
Overall Loss: 12.709126
Rec Loss: 7.701525
KL Loss: 5.007601
Y Loss: 0.990351
T Loss: 11.146216
X Loss: -3.939868
Epoch 1999 
Overall Loss: 12.682977
Rec Loss: 7.672414
KL Loss: 5.010563
Y Loss: 0.956039
T Loss: 11.133809
X Loss: -3.939414
Epoch 2049 
Overall Loss: 12.650022
Rec Loss: 7.605790
KL Loss: 5.044232
Y Loss: 0.959518
T Loss: 11.054266
X Loss: -3.928235
Epoch 2099 
Overall Loss: 12.683182
Rec Loss: 7.567945
KL Loss: 5.115237
Y Loss: 0.960438
T Loss: 11.015408
X Loss: -3.927682
Epoch 2149 
Overall Loss: 12.667287
Rec Loss: 7.504067
KL Loss: 5.163219
Y Loss: 0.994777
T Loss: 10.952993
X Loss: -3.946315
Epoch 2199 
Overall Loss: 12.640142
Rec Loss: 7.450306
KL Loss: 5.189836
Y Loss: 0.972670
T Loss: 10.912204
X Loss: -3.948233
Epoch 2249 
Overall Loss: 12.652518
Rec Loss: 7.452705
KL Loss: 5.199813
Y Loss: 0.992536
T Loss: 10.905023
X Loss: -3.948586
Epoch 2299 
Overall Loss: 12.662495
Rec Loss: 7.441469
KL Loss: 5.221026
Y Loss: 0.987193
T Loss: 10.877118
X Loss: -3.929245
Epoch 2349 
Overall Loss: 12.646118
Rec Loss: 7.471919
KL Loss: 5.174199
Y Loss: 0.976667
T Loss: 10.913221
X Loss: -3.929636
Epoch 2399 
Overall Loss: 12.649815
Rec Loss: 7.440257
KL Loss: 5.209558
Y Loss: 1.005088
T Loss: 10.891671
X Loss: -3.953958
Epoch 2449 
Overall Loss: 12.639148
Rec Loss: 7.433933
KL Loss: 5.205214
Y Loss: 0.989151
T Loss: 10.881573
X Loss: -3.942216
Epoch 2499 
Overall Loss: 12.614963
Rec Loss: 7.397516
KL Loss: 5.217447
Y Loss: 0.966629
T Loss: 10.877288
X Loss: -3.963087
Epoch 2549 
Overall Loss: 12.635497
Rec Loss: 7.414360
KL Loss: 5.221137
Y Loss: 0.976025
T Loss: 10.875686
X Loss: -3.949338
Epoch 2599 
Overall Loss: 12.604371
Rec Loss: 7.399821
KL Loss: 5.204550
Y Loss: 0.989264
T Loss: 10.879293
X Loss: -3.974104
Epoch 2649 
Overall Loss: 12.622058
Rec Loss: 7.402640
KL Loss: 5.219419
Y Loss: 0.967442
T Loss: 10.872602
X Loss: -3.953683
Epoch 2699 
Overall Loss: 12.622854
Rec Loss: 7.396191
KL Loss: 5.226663
Y Loss: 0.974681
T Loss: 10.886719
X Loss: -3.977868
Epoch 2749 
Overall Loss: 12.611562
Rec Loss: 7.384249
KL Loss: 5.227314
Y Loss: 0.965741
T Loss: 10.868720
X Loss: -3.967341
Epoch 2799 
Overall Loss: 12.613306
Rec Loss: 7.393975
KL Loss: 5.219331
Y Loss: 0.957037
T Loss: 10.865931
X Loss: -3.950474
Epoch 2849 
Overall Loss: 12.631205
Rec Loss: 7.395981
KL Loss: 5.235225
Y Loss: 0.969948
T Loss: 10.872233
X Loss: -3.961226
Epoch 2899 
Overall Loss: 12.621944
Rec Loss: 7.371844
KL Loss: 5.250100
Y Loss: 0.995548
T Loss: 10.860377
X Loss: -3.986307
Epoch 2949 
Overall Loss: 12.605447
Rec Loss: 7.364658
KL Loss: 5.240789
Y Loss: 0.961404
T Loss: 10.869627
X Loss: -3.985670
Epoch 2999 
Overall Loss: 12.637808
Rec Loss: 7.416455
KL Loss: 5.221353
Y Loss: 0.992201
T Loss: 10.879060
X Loss: -3.958705
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.409939
Epoch 99
Rec Loss: 2.394850
Epoch 149
Rec Loss: 2.412852
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.012117
Epoch 99
Rec Loss: 1.999392
Epoch 149
Rec Loss: 2.000755
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.583597
Insample Error 3.164277
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.574526
Epoch 99 
Prediction Loss: 3.374694
Epoch 149 
Prediction Loss: 3.209127
Epoch 199 
Prediction Loss: 3.045540
Epoch 249 
Prediction Loss: 2.863104
Epoch 299 
Prediction Loss: 2.791320
Epoch 349 
Prediction Loss: 2.536940
Epoch 399 
Prediction Loss: 2.437199
Epoch 449 
Prediction Loss: 2.262295
Epoch 499 
Prediction Loss: 2.186013
Epoch 549 
Prediction Loss: 2.006982
Epoch 599 
Prediction Loss: 1.930614
Epoch 649 
Prediction Loss: 1.863727
Epoch 699 
Prediction Loss: 1.788300
Epoch 749 
Prediction Loss: 1.741743
Epoch 799 
Prediction Loss: 1.671420
Epoch 849 
Prediction Loss: 1.633226
Epoch 899 
Prediction Loss: 1.594108
Epoch 949 
Prediction Loss: 1.532917
Epoch 999 
Prediction Loss: 1.504700
Epoch 1049 
Prediction Loss: 1.456688
Epoch 1099 
Prediction Loss: 1.423129
Epoch 1149 
Prediction Loss: 1.428082
Epoch 1199 
Prediction Loss: 1.375750
Epoch 1249 
Prediction Loss: 1.358880
Epoch 1299 
Prediction Loss: 1.313940
Epoch 1349 
Prediction Loss: 1.298527
Epoch 1399 
Prediction Loss: 1.274703
Epoch 1449 
Prediction Loss: 1.274725
Epoch 1499 
Prediction Loss: 1.270203
Epoch 1549 
Prediction Loss: 1.244013
Epoch 1599 
Prediction Loss: 1.197694
Epoch 1649 
Prediction Loss: 1.181738
Epoch 1699 
Prediction Loss: 1.190284
Epoch 1749 
Prediction Loss: 1.181841
Epoch 1799 
Prediction Loss: 1.160110
Epoch 1849 
Prediction Loss: 1.126795
Epoch 1899 
Prediction Loss: 1.141985
Epoch 1949 
Prediction Loss: 1.138025
Epoch 1999 
Prediction Loss: 1.116786
Epoch 2049 
Prediction Loss: 1.093203
Epoch 2099 
Prediction Loss: 1.098713
Epoch 2149 
Prediction Loss: 1.082717
Epoch 2199 
Prediction Loss: 1.091293
Epoch 2249 
Prediction Loss: 1.061053
Epoch 2299 
Prediction Loss: 1.091446
Epoch 2349 
Prediction Loss: 1.036828
Epoch 2399 
Prediction Loss: 1.048661
Epoch 2449 
Prediction Loss: 1.031252
Epoch 2499 
Prediction Loss: 1.043049
Epoch 2549 
Prediction Loss: 1.034842
Epoch 2599 
Prediction Loss: 1.006260
Epoch 2649 
Prediction Loss: 1.010604
Epoch 2699 
Prediction Loss: 0.997009
Epoch 2749 
Prediction Loss: 1.000999
Epoch 2799 
Prediction Loss: 0.982136
Epoch 2849 
Prediction Loss: 0.988127
Epoch 2899 
Prediction Loss: 1.008152
Epoch 2949 
Prediction Loss: 0.981368
Epoch 2999 
Prediction Loss: 0.997377
Epoch 3049 
Prediction Loss: 0.955752
Epoch 3099 
Prediction Loss: 0.969653
Epoch 3149 
Prediction Loss: 0.966262
Epoch 3199 
Prediction Loss: 0.960109
Epoch 3249 
Prediction Loss: 0.979211
Epoch 3299 
Prediction Loss: 0.946667
Epoch 3349 
Prediction Loss: 0.950009
Epoch 3399 
Prediction Loss: 0.935482
Epoch 3449 
Prediction Loss: 0.939864
Epoch 3499 
Prediction Loss: 0.931929
Epoch 3549 
Prediction Loss: 0.938032
Epoch 3599 
Prediction Loss: 0.926754
Epoch 3649 
Prediction Loss: 0.939026
Epoch 3699 
Prediction Loss: 0.935441
Epoch 3749 
Prediction Loss: 0.933903
Epoch 3799 
Prediction Loss: 0.906324
Epoch 3849 
Prediction Loss: 0.925724
Epoch 3899 
Prediction Loss: 0.906348
Epoch 3949 
Prediction Loss: 0.910902
Epoch 3999 
Prediction Loss: 0.931435
Epoch 4049 
Prediction Loss: 0.894992
Epoch 4099 
Prediction Loss: 0.903791
Epoch 4149 
Prediction Loss: 0.907721
Epoch 4199 
Prediction Loss: 0.922462
Epoch 4249 
Prediction Loss: 0.908860
Epoch 4299 
Prediction Loss: 0.907616
Epoch 4349 
Prediction Loss: 0.913479
Epoch 4399 
Prediction Loss: 0.889022
Epoch 4449 
Prediction Loss: 0.881874
Epoch 4499 
Prediction Loss: 0.895922
Epoch 4549 
Prediction Loss: 0.869007
Epoch 4599 
Prediction Loss: 0.885130
Epoch 4649 
Prediction Loss: 0.901012
Epoch 4699 
Prediction Loss: 0.862679
Epoch 4749 
Prediction Loss: 0.877542
Epoch 4799 
Prediction Loss: 0.876146
Epoch 4849 
Prediction Loss: 0.868176
Epoch 4899 
Prediction Loss: 0.879418
Epoch 4949 
Prediction Loss: 0.894331
Epoch 4999 
Prediction Loss: 0.875306
Epoch 5049 
Prediction Loss: 0.922687
Epoch 5099 
Prediction Loss: 0.867514
Epoch 5149 
Prediction Loss: 0.874055
Epoch 5199 
Prediction Loss: 0.866416
Epoch 5249 
Prediction Loss: 0.852032
Epoch 5299 
Prediction Loss: 0.839889
Epoch 5349 
Prediction Loss: 0.843003
Epoch 5399 
Prediction Loss: 0.843102
Epoch 5449 
Prediction Loss: 0.835502
Epoch 5499 
Prediction Loss: 0.847082
Epoch 5549 
Prediction Loss: 0.834388
Epoch 5599 
Prediction Loss: 0.850472
Epoch 5649 
Prediction Loss: 0.831396
Epoch 5699 
Prediction Loss: 0.825918
Epoch 5749 
Prediction Loss: 0.821248
Epoch 5799 
Prediction Loss: 0.811364
Epoch 5849 
Prediction Loss: 0.812335
Epoch 5899 
Prediction Loss: 0.806795
Epoch 5949 
Prediction Loss: 0.820842
Epoch 5999 
Prediction Loss: 0.874254
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.904171
Insample Error 4.327651
[31m========== repeat time 9 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.498615
Rec Loss: 11.557642
KL Loss: 1.940974
Y Loss: 1.018061
T Loss: 11.048611
Epoch 99 
Overall Loss: 13.366312
Rec Loss: 11.309878
KL Loss: 2.056434
Y Loss: 0.960856
T Loss: 10.829450
Epoch 149 
Overall Loss: 13.286647
Rec Loss: 11.211788
KL Loss: 2.074858
Y Loss: 0.974275
T Loss: 10.724651
Epoch 199 
Overall Loss: 13.251568
Rec Loss: 11.027625
KL Loss: 2.223943
Y Loss: 0.971289
T Loss: 10.541980
Epoch 249 
Overall Loss: 13.211004
Rec Loss: 10.983278
KL Loss: 2.227726
Y Loss: 0.960086
T Loss: 10.503235
Epoch 299 
Overall Loss: 13.193864
Rec Loss: 10.944762
KL Loss: 2.249102
Y Loss: 0.961823
T Loss: 10.463851
Epoch 349 
Overall Loss: 13.189385
Rec Loss: 10.975107
KL Loss: 2.214277
Y Loss: 0.990160
T Loss: 10.480027
Epoch 399 
Overall Loss: 13.170555
Rec Loss: 10.941661
KL Loss: 2.228894
Y Loss: 0.956662
T Loss: 10.463330
Epoch 449 
Overall Loss: 13.189778
Rec Loss: 10.947383
KL Loss: 2.242395
Y Loss: 0.984836
T Loss: 10.454965
Epoch 499 
Overall Loss: 13.171201
Rec Loss: 10.950324
KL Loss: 2.220878
Y Loss: 0.987622
T Loss: 10.456512
Epoch 549 
Overall Loss: 13.158426
Rec Loss: 10.944203
KL Loss: 2.214223
Y Loss: 0.968843
T Loss: 10.459782
Epoch 599 
Overall Loss: 13.171633
Rec Loss: 10.946667
KL Loss: 2.224966
Y Loss: 0.964503
T Loss: 10.464415
Epoch 649 
Overall Loss: 13.145043
Rec Loss: 10.915315
KL Loss: 2.229729
Y Loss: 0.956185
T Loss: 10.437222
Epoch 699 
Overall Loss: 13.137630
Rec Loss: 10.936372
KL Loss: 2.201258
Y Loss: 0.959060
T Loss: 10.456842
Epoch 749 
Overall Loss: 13.127829
Rec Loss: 10.884922
KL Loss: 2.242907
Y Loss: 0.945089
T Loss: 10.412378
Epoch 799 
Overall Loss: 13.121214
Rec Loss: 10.892673
KL Loss: 2.228541
Y Loss: 0.956708
T Loss: 10.414319
Epoch 849 
Overall Loss: 13.131620
Rec Loss: 10.927318
KL Loss: 2.204301
Y Loss: 0.964873
T Loss: 10.444882
Epoch 899 
Overall Loss: 13.093821
Rec Loss: 10.887572
KL Loss: 2.206249
Y Loss: 0.948018
T Loss: 10.413563
Epoch 949 
Overall Loss: 13.115931
Rec Loss: 10.895720
KL Loss: 2.220211
Y Loss: 0.959572
T Loss: 10.415934
Epoch 999 
Overall Loss: 13.089511
Rec Loss: 10.892742
KL Loss: 2.196769
Y Loss: 0.953585
T Loss: 10.415949
Epoch 1049 
Overall Loss: 13.115611
Rec Loss: 10.912067
KL Loss: 2.203543
Y Loss: 0.960632
T Loss: 10.431751
Epoch 1099 
Overall Loss: 13.116570
Rec Loss: 10.911360
KL Loss: 2.205209
Y Loss: 0.972792
T Loss: 10.424964
Epoch 1149 
Overall Loss: 13.123353
Rec Loss: 10.898665
KL Loss: 2.224687
Y Loss: 0.966562
T Loss: 10.415385
Epoch 1199 
Overall Loss: 13.086947
Rec Loss: 10.873857
KL Loss: 2.213090
Y Loss: 0.964157
T Loss: 10.391779
Epoch 1249 
Overall Loss: 13.076833
Rec Loss: 10.871461
KL Loss: 2.205372
Y Loss: 0.943329
T Loss: 10.399797
Epoch 1299 
Overall Loss: 13.121398
Rec Loss: 10.876834
KL Loss: 2.244563
Y Loss: 0.957109
T Loss: 10.398280
Epoch 1349 
Overall Loss: 13.083439
Rec Loss: 10.848544
KL Loss: 2.234895
Y Loss: 0.925684
T Loss: 10.385702
Epoch 1399 
Overall Loss: 13.079372
Rec Loss: 10.851888
KL Loss: 2.227485
Y Loss: 0.949530
T Loss: 10.377123
Epoch 1449 
Overall Loss: 13.065406
Rec Loss: 10.875103
KL Loss: 2.190302
Y Loss: 0.958961
T Loss: 10.395623
Epoch 1499 
Overall Loss: 13.076769
Rec Loss: 10.875710
KL Loss: 2.201059
Y Loss: 0.960817
T Loss: 10.395302
Epoch 1549 
Overall Loss: 13.070971
Rec Loss: 10.863946
KL Loss: 2.207025
Y Loss: 0.973988
T Loss: 10.376951
Epoch 1599 
Overall Loss: 13.043821
Rec Loss: 10.836766
KL Loss: 2.207055
Y Loss: 0.947261
T Loss: 10.363136
Epoch 1649 
Overall Loss: 13.046797
Rec Loss: 10.822438
KL Loss: 2.224360
Y Loss: 0.954991
T Loss: 10.344942
Epoch 1699 
Overall Loss: 13.052864
Rec Loss: 10.827449
KL Loss: 2.225414
Y Loss: 0.947234
T Loss: 10.353832
Epoch 1749 
Overall Loss: 13.045132
Rec Loss: 10.853026
KL Loss: 2.192105
Y Loss: 0.971042
T Loss: 10.367506
Epoch 1799 
Overall Loss: 13.048558
Rec Loss: 10.846740
KL Loss: 2.201818
Y Loss: 0.955461
T Loss: 10.369010
Epoch 1849 
Overall Loss: 13.041576
Rec Loss: 10.846721
KL Loss: 2.194855
Y Loss: 0.932788
T Loss: 10.380327
Epoch 1899 
Overall Loss: 13.055513
Rec Loss: 10.852265
KL Loss: 2.203248
Y Loss: 0.948212
T Loss: 10.378159
Epoch 1949 
Overall Loss: 13.063723
Rec Loss: 10.853524
KL Loss: 2.210198
Y Loss: 0.952693
T Loss: 10.377178
Epoch 1999 
Overall Loss: 13.052497
Rec Loss: 10.825298
KL Loss: 2.227199
Y Loss: 0.941837
T Loss: 10.354380
Epoch 2049 
Overall Loss: 13.034563
Rec Loss: 10.827882
KL Loss: 2.206681
Y Loss: 0.929998
T Loss: 10.362883
Epoch 2099 
Overall Loss: 13.029406
Rec Loss: 10.832242
KL Loss: 2.197163
Y Loss: 0.935988
T Loss: 10.364249
Epoch 2149 
Overall Loss: 13.018855
Rec Loss: 10.811731
KL Loss: 2.207124
Y Loss: 0.940858
T Loss: 10.341302
Epoch 2199 
Overall Loss: 13.008922
Rec Loss: 10.811886
KL Loss: 2.197036
Y Loss: 0.938566
T Loss: 10.342603
Epoch 2249 
Overall Loss: 13.021753
Rec Loss: 10.817344
KL Loss: 2.204409
Y Loss: 0.933375
T Loss: 10.350657
Epoch 2299 
Overall Loss: 13.044221
Rec Loss: 10.832116
KL Loss: 2.212105
Y Loss: 0.957400
T Loss: 10.353416
Epoch 2349 
Overall Loss: 12.995404
Rec Loss: 10.776655
KL Loss: 2.218749
Y Loss: 0.914192
T Loss: 10.319560
Epoch 2399 
Overall Loss: 13.024550
Rec Loss: 10.814887
KL Loss: 2.209663
Y Loss: 0.955951
T Loss: 10.336912
Epoch 2449 
Overall Loss: 13.011591
Rec Loss: 10.808859
KL Loss: 2.202732
Y Loss: 0.949063
T Loss: 10.334327
Epoch 2499 
Overall Loss: 13.005863
Rec Loss: 10.818477
KL Loss: 2.187386
Y Loss: 0.922151
T Loss: 10.357402
Epoch 2549 
Overall Loss: 12.985380
Rec Loss: 10.785223
KL Loss: 2.200156
Y Loss: 0.927806
T Loss: 10.321320
Epoch 2599 
Overall Loss: 13.002227
Rec Loss: 10.811608
KL Loss: 2.190619
Y Loss: 0.962809
T Loss: 10.330203
Epoch 2649 
Overall Loss: 13.013836
Rec Loss: 10.809390
KL Loss: 2.204446
Y Loss: 0.944344
T Loss: 10.337218
Epoch 2699 
Overall Loss: 12.999777
Rec Loss: 10.813138
KL Loss: 2.186640
Y Loss: 0.929704
T Loss: 10.348286
Epoch 2749 
Overall Loss: 12.987071
Rec Loss: 10.793428
KL Loss: 2.193643
Y Loss: 0.931241
T Loss: 10.327808
Epoch 2799 
Overall Loss: 13.001591
Rec Loss: 10.816500
KL Loss: 2.185091
Y Loss: 0.936611
T Loss: 10.348195
Epoch 2849 
Overall Loss: 13.017136
Rec Loss: 10.803018
KL Loss: 2.214118
Y Loss: 0.912309
T Loss: 10.346864
Epoch 2899 
Overall Loss: 12.977670
Rec Loss: 10.779959
KL Loss: 2.197711
Y Loss: 0.912489
T Loss: 10.323714
Epoch 2949 
Overall Loss: 12.966767
Rec Loss: 10.777746
KL Loss: 2.189020
Y Loss: 0.943781
T Loss: 10.305856
Epoch 2999 
Overall Loss: 12.984035
Rec Loss: 10.787240
KL Loss: 2.196796
Y Loss: 0.931512
T Loss: 10.321483
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.071002
Epoch 99
Rec Loss: 2.062423
Epoch 149
Rec Loss: 2.067623
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.928972
Epoch 99
Rec Loss: 9.914245
Epoch 149
Rec Loss: 9.930442
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.628869
Insample Error: 2.029609
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.639051
Rec Loss: 18.673618
KL Loss: 2.965433
Y Loss: 9.492493
T Loss: 13.099278
X Loss: 0.828094
Epoch 99 
Overall Loss: 16.383705
Rec Loss: 12.746894
KL Loss: 3.636811
Y Loss: 2.876160
T Loss: 12.934108
X Loss: -1.625294
Epoch 149 
Overall Loss: 15.205888
Rec Loss: 11.853545
KL Loss: 3.352343
Y Loss: 2.451482
T Loss: 12.978018
X Loss: -2.350215
Epoch 199 
Overall Loss: 14.676983
Rec Loss: 11.184560
KL Loss: 3.492423
Y Loss: 2.034653
T Loss: 12.852102
X Loss: -2.684868
Epoch 249 
Overall Loss: 14.213117
Rec Loss: 10.491028
KL Loss: 3.722090
Y Loss: 1.705668
T Loss: 12.500510
X Loss: -2.862315
Epoch 299 
Overall Loss: 13.737888
Rec Loss: 9.824980
KL Loss: 3.912908
Y Loss: 1.513415
T Loss: 12.036863
X Loss: -2.968590
Epoch 349 
Overall Loss: 13.461955
Rec Loss: 9.312802
KL Loss: 4.149152
Y Loss: 1.251279
T Loss: 11.743898
X Loss: -3.056735
Epoch 399 
Overall Loss: 13.283385
Rec Loss: 9.098159
KL Loss: 4.185227
Y Loss: 1.102527
T Loss: 11.704946
X Loss: -3.158051
Epoch 449 
Overall Loss: 13.233330
Rec Loss: 9.020024
KL Loss: 4.213306
Y Loss: 1.056987
T Loss: 11.693393
X Loss: -3.201862
Epoch 499 
Overall Loss: 13.174157
Rec Loss: 8.912551
KL Loss: 4.261605
Y Loss: 1.040461
T Loss: 11.649463
X Loss: -3.257143
Epoch 549 
Overall Loss: 13.132471
Rec Loss: 8.811050
KL Loss: 4.321421
Y Loss: 1.037402
T Loss: 11.622959
X Loss: -3.330610
Epoch 599 
Overall Loss: 13.051628
Rec Loss: 8.676342
KL Loss: 4.375286
Y Loss: 1.026459
T Loss: 11.527318
X Loss: -3.364205
Epoch 649 
Overall Loss: 13.010932
Rec Loss: 8.541059
KL Loss: 4.469873
Y Loss: 1.025625
T Loss: 11.456070
X Loss: -3.427824
Epoch 699 
Overall Loss: 12.944679
Rec Loss: 8.385934
KL Loss: 4.558745
Y Loss: 0.981506
T Loss: 11.377960
X Loss: -3.482779
Epoch 749 
Overall Loss: 12.927014
Rec Loss: 8.313533
KL Loss: 4.613481
Y Loss: 1.019874
T Loss: 11.304603
X Loss: -3.501008
Epoch 799 
Overall Loss: 12.880365
Rec Loss: 8.255928
KL Loss: 4.624437
Y Loss: 1.003369
T Loss: 11.273390
X Loss: -3.519147
Epoch 849 
Overall Loss: 12.880865
Rec Loss: 8.191225
KL Loss: 4.689640
Y Loss: 0.979472
T Loss: 11.266124
X Loss: -3.564636
Epoch 899 
Overall Loss: 12.852385
Rec Loss: 8.171577
KL Loss: 4.680807
Y Loss: 0.986973
T Loss: 11.220827
X Loss: -3.542737
Epoch 949 
Overall Loss: 12.814780
Rec Loss: 8.127250
KL Loss: 4.687530
Y Loss: 0.986463
T Loss: 11.215686
X Loss: -3.581667
Epoch 999 
Overall Loss: 12.810727
Rec Loss: 8.083435
KL Loss: 4.727292
Y Loss: 0.965750
T Loss: 11.212884
X Loss: -3.612325
Epoch 1049 
Overall Loss: 12.817862
Rec Loss: 8.113311
KL Loss: 4.704550
Y Loss: 0.968270
T Loss: 11.224320
X Loss: -3.595144
Epoch 1099 
Overall Loss: 12.831633
Rec Loss: 8.109596
KL Loss: 4.722038
Y Loss: 0.977781
T Loss: 11.221197
X Loss: -3.600492
Epoch 1149 
Overall Loss: 12.799869
Rec Loss: 8.097433
KL Loss: 4.702436
Y Loss: 0.978396
T Loss: 11.203990
X Loss: -3.595755
Epoch 1199 
Overall Loss: 12.776245
Rec Loss: 8.066895
KL Loss: 4.709350
Y Loss: 0.962184
T Loss: 11.205624
X Loss: -3.619821
Epoch 1249 
Overall Loss: 12.801442
Rec Loss: 8.053152
KL Loss: 4.748290
Y Loss: 0.978947
T Loss: 11.190442
X Loss: -3.626763
Epoch 1299 
Overall Loss: 12.784212
Rec Loss: 8.048683
KL Loss: 4.735529
Y Loss: 0.981637
T Loss: 11.206384
X Loss: -3.648520
Epoch 1349 
Overall Loss: 12.762201
Rec Loss: 8.010126
KL Loss: 4.752075
Y Loss: 0.965553
T Loss: 11.185474
X Loss: -3.658124
Epoch 1399 
Overall Loss: 12.773507
Rec Loss: 8.027968
KL Loss: 4.745539
Y Loss: 0.969962
T Loss: 11.192363
X Loss: -3.649376
Epoch 1449 
Overall Loss: 12.760447
Rec Loss: 8.018266
KL Loss: 4.742181
Y Loss: 0.965405
T Loss: 11.197003
X Loss: -3.661439
Epoch 1499 
Overall Loss: 12.748118
Rec Loss: 8.007900
KL Loss: 4.740217
Y Loss: 0.960128
T Loss: 11.194695
X Loss: -3.666858
Epoch 1549 
Overall Loss: 12.739115
Rec Loss: 8.001343
KL Loss: 4.737773
Y Loss: 0.966133
T Loss: 11.193251
X Loss: -3.674975
Epoch 1599 
Overall Loss: 12.732292
Rec Loss: 7.994949
KL Loss: 4.737343
Y Loss: 0.961008
T Loss: 11.202740
X Loss: -3.688295
Epoch 1649 
Overall Loss: 12.725645
Rec Loss: 7.984005
KL Loss: 4.741640
Y Loss: 0.967756
T Loss: 11.187487
X Loss: -3.687360
Epoch 1699 
Overall Loss: 12.721287
Rec Loss: 7.976176
KL Loss: 4.745111
Y Loss: 0.971718
T Loss: 11.186003
X Loss: -3.695686
Epoch 1749 
Overall Loss: 12.718215
Rec Loss: 7.979011
KL Loss: 4.739204
Y Loss: 0.965279
T Loss: 11.179782
X Loss: -3.683410
Epoch 1799 
Overall Loss: 12.704359
Rec Loss: 7.973093
KL Loss: 4.731266
Y Loss: 0.960805
T Loss: 11.185555
X Loss: -3.692865
Epoch 1849 
Overall Loss: 12.725066
Rec Loss: 7.972323
KL Loss: 4.752743
Y Loss: 0.983908
T Loss: 11.177779
X Loss: -3.697411
Epoch 1899 
Overall Loss: 12.706144
Rec Loss: 7.951084
KL Loss: 4.755060
Y Loss: 0.973201
T Loss: 11.169477
X Loss: -3.704994
Epoch 1949 
Overall Loss: 12.723888
Rec Loss: 7.973549
KL Loss: 4.750339
Y Loss: 0.989328
T Loss: 11.191678
X Loss: -3.712793
Epoch 1999 
Overall Loss: 12.716723
Rec Loss: 7.968411
KL Loss: 4.748311
Y Loss: 0.987928
T Loss: 11.186427
X Loss: -3.711979
Epoch 2049 
Overall Loss: 12.726969
Rec Loss: 7.956770
KL Loss: 4.770199
Y Loss: 0.975280
T Loss: 11.190648
X Loss: -3.721518
Epoch 2099 
Overall Loss: 12.728259
Rec Loss: 7.939349
KL Loss: 4.788910
Y Loss: 0.979219
T Loss: 11.181797
X Loss: -3.732058
Epoch 2149 
Overall Loss: 12.665056
Rec Loss: 7.887279
KL Loss: 4.777777
Y Loss: 0.945074
T Loss: 11.173422
X Loss: -3.758680
Epoch 2199 
Overall Loss: 12.686743
Rec Loss: 7.918405
KL Loss: 4.768338
Y Loss: 0.969693
T Loss: 11.181140
X Loss: -3.747582
Epoch 2249 
Overall Loss: 12.697711
Rec Loss: 7.934761
KL Loss: 4.762951
Y Loss: 0.965004
T Loss: 11.186703
X Loss: -3.734445
Epoch 2299 
Overall Loss: 12.739739
Rec Loss: 7.938662
KL Loss: 4.801077
Y Loss: 0.964426
T Loss: 11.188135
X Loss: -3.731686
Epoch 2349 
Overall Loss: 12.712087
Rec Loss: 7.916862
KL Loss: 4.795226
Y Loss: 0.976268
T Loss: 11.166532
X Loss: -3.737804
Epoch 2399 
Overall Loss: 12.678115
Rec Loss: 7.883857
KL Loss: 4.794258
Y Loss: 0.983796
T Loss: 11.143118
X Loss: -3.751160
Epoch 2449 
Overall Loss: 12.664200
Rec Loss: 7.840963
KL Loss: 4.823237
Y Loss: 0.967432
T Loss: 11.124064
X Loss: -3.766817
Epoch 2499 
Overall Loss: 12.679595
Rec Loss: 7.810959
KL Loss: 4.868636
Y Loss: 0.961392
T Loss: 11.096313
X Loss: -3.766050
Epoch 2549 
Overall Loss: 12.655885
Rec Loss: 7.755379
KL Loss: 4.900506
Y Loss: 0.966128
T Loss: 11.054098
X Loss: -3.781783
Epoch 2599 
Overall Loss: 12.658070
Rec Loss: 7.724549
KL Loss: 4.933521
Y Loss: 0.981373
T Loss: 11.002689
X Loss: -3.768827
Epoch 2649 
Overall Loss: 12.658855
Rec Loss: 7.652426
KL Loss: 5.006429
Y Loss: 0.982882
T Loss: 10.939263
X Loss: -3.778278
Epoch 2699 
Overall Loss: 12.630204
Rec Loss: 7.606889
KL Loss: 5.023315
Y Loss: 0.975300
T Loss: 10.898362
X Loss: -3.779123
Epoch 2749 
Overall Loss: 12.638538
Rec Loss: 7.595508
KL Loss: 5.043030
Y Loss: 0.986211
T Loss: 10.903748
X Loss: -3.801346
Epoch 2799 
Overall Loss: 12.602761
Rec Loss: 7.546801
KL Loss: 5.055960
Y Loss: 0.947720
T Loss: 10.883647
X Loss: -3.810705
Epoch 2849 
Overall Loss: 12.619465
Rec Loss: 7.549184
KL Loss: 5.070280
Y Loss: 0.978006
T Loss: 10.866468
X Loss: -3.806287
Epoch 2899 
Overall Loss: 12.628576
Rec Loss: 7.559233
KL Loss: 5.069343
Y Loss: 0.969129
T Loss: 10.859921
X Loss: -3.785252
Epoch 2949 
Overall Loss: 12.618172
Rec Loss: 7.554337
KL Loss: 5.063835
Y Loss: 0.966340
T Loss: 10.859870
X Loss: -3.788703
Epoch 2999 
Overall Loss: 12.613644
Rec Loss: 7.540803
KL Loss: 5.072841
Y Loss: 0.950095
T Loss: 10.861573
X Loss: -3.795818
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.407669
Epoch 99
Rec Loss: 2.399149
Epoch 149
Rec Loss: 2.408952
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.009437
Epoch 99
Rec Loss: 2.006027
Epoch 149
Rec Loss: 2.004049
Epoch 199
Rec Loss: 2.000499
Epoch 249
Rec Loss: 2.004740
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.577541
Insample Error 2.795162
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.580816
Epoch 99 
Prediction Loss: 3.344002
Epoch 149 
Prediction Loss: 3.178705
Epoch 199 
Prediction Loss: 3.020701
Epoch 249 
Prediction Loss: 2.862824
Epoch 299 
Prediction Loss: 2.696698
Epoch 349 
Prediction Loss: 2.567179
Epoch 399 
Prediction Loss: 2.412836
Epoch 449 
Prediction Loss: 2.299925
Epoch 499 
Prediction Loss: 2.187508
Epoch 549 
Prediction Loss: 2.054716
Epoch 599 
Prediction Loss: 1.949390
Epoch 649 
Prediction Loss: 1.899696
Epoch 699 
Prediction Loss: 1.783465
Epoch 749 
Prediction Loss: 1.704910
Epoch 799 
Prediction Loss: 1.624241
Epoch 849 
Prediction Loss: 1.587799
Epoch 899 
Prediction Loss: 1.526306
Epoch 949 
Prediction Loss: 1.478303
Epoch 999 
Prediction Loss: 1.431150
Epoch 1049 
Prediction Loss: 1.420817
Epoch 1099 
Prediction Loss: 1.352305
Epoch 1149 
Prediction Loss: 1.330320
Epoch 1199 
Prediction Loss: 1.323983
Epoch 1249 
Prediction Loss: 1.274967
Epoch 1299 
Prediction Loss: 1.244415
Epoch 1349 
Prediction Loss: 1.217199
Epoch 1399 
Prediction Loss: 1.219316
Epoch 1449 
Prediction Loss: 1.186843
Epoch 1499 
Prediction Loss: 1.179366
Epoch 1549 
Prediction Loss: 1.166710
Epoch 1599 
Prediction Loss: 1.190506
Epoch 1649 
Prediction Loss: 1.114050
Epoch 1699 
Prediction Loss: 1.108652
Epoch 1749 
Prediction Loss: 1.116267
Epoch 1799 
Prediction Loss: 1.092926
Epoch 1849 
Prediction Loss: 1.142877
Epoch 1899 
Prediction Loss: 1.076144
Epoch 1949 
Prediction Loss: 1.062002
Epoch 1999 
Prediction Loss: 1.079767
Epoch 2049 
Prediction Loss: 1.037134
Epoch 2099 
Prediction Loss: 1.028511
Epoch 2149 
Prediction Loss: 1.035652
Epoch 2199 
Prediction Loss: 1.022057
Epoch 2249 
Prediction Loss: 1.044638
Epoch 2299 
Prediction Loss: 1.005825
Epoch 2349 
Prediction Loss: 1.018772
Epoch 2399 
Prediction Loss: 1.015343
Epoch 2449 
Prediction Loss: 0.989488
Epoch 2499 
Prediction Loss: 0.987685
Epoch 2549 
Prediction Loss: 0.974069
Epoch 2599 
Prediction Loss: 0.977953
Epoch 2649 
Prediction Loss: 0.989868
Epoch 2699 
Prediction Loss: 0.965044
Epoch 2749 
Prediction Loss: 0.959944
Epoch 2799 
Prediction Loss: 0.988241
Epoch 2849 
Prediction Loss: 0.960734
Epoch 2899 
Prediction Loss: 0.981373
Epoch 2949 
Prediction Loss: 0.980171
Epoch 2999 
Prediction Loss: 0.940964
Epoch 3049 
Prediction Loss: 0.938536
Epoch 3099 
Prediction Loss: 0.944974
Epoch 3149 
Prediction Loss: 0.925330
Epoch 3199 
Prediction Loss: 0.905241
Epoch 3249 
Prediction Loss: 0.918252
Epoch 3299 
Prediction Loss: 0.935726
Epoch 3349 
Prediction Loss: 0.911132
Epoch 3399 
Prediction Loss: 0.921665
Epoch 3449 
Prediction Loss: 0.887941
Epoch 3499 
Prediction Loss: 0.912313
Epoch 3549 
Prediction Loss: 0.949473
Epoch 3599 
Prediction Loss: 0.909197
Epoch 3649 
Prediction Loss: 0.892286
Epoch 3699 
Prediction Loss: 0.940799
Epoch 3749 
Prediction Loss: 0.902338
Epoch 3799 
Prediction Loss: 0.882846
Epoch 3849 
Prediction Loss: 0.875049
Epoch 3899 
Prediction Loss: 0.894949
Epoch 3949 
Prediction Loss: 0.880736
Epoch 3999 
Prediction Loss: 0.880449
Epoch 4049 
Prediction Loss: 0.913224
Epoch 4099 
Prediction Loss: 0.865127
Epoch 4149 
Prediction Loss: 0.862000
Epoch 4199 
Prediction Loss: 0.891851
Epoch 4249 
Prediction Loss: 0.870696
Epoch 4299 
Prediction Loss: 0.862417
Epoch 4349 
Prediction Loss: 0.865141
Epoch 4399 
Prediction Loss: 0.884574
Epoch 4449 
Prediction Loss: 0.853519
Epoch 4499 
Prediction Loss: 0.863866
Epoch 4549 
Prediction Loss: 0.846905
Epoch 4599 
Prediction Loss: 0.850966
Epoch 4649 
Prediction Loss: 0.897677
Epoch 4699 
Prediction Loss: 0.825337
Epoch 4749 
Prediction Loss: 0.849024
Epoch 4799 
Prediction Loss: 0.855128
Epoch 4849 
Prediction Loss: 0.832998
Epoch 4899 
Prediction Loss: 0.824188
Epoch 4949 
Prediction Loss: 0.846553
Epoch 4999 
Prediction Loss: 0.821265
Epoch 5049 
Prediction Loss: 0.822064
Epoch 5099 
Prediction Loss: 0.835417
Epoch 5149 
Prediction Loss: 0.823789
Epoch 5199 
Prediction Loss: 0.815914
Epoch 5249 
Prediction Loss: 0.867184
Epoch 5299 
Prediction Loss: 0.835165
Epoch 5349 
Prediction Loss: 0.802039
Epoch 5399 
Prediction Loss: 0.811473
Epoch 5449 
Prediction Loss: 0.803548
Epoch 5499 
Prediction Loss: 0.815240
Epoch 5549 
Prediction Loss: 0.832530
Epoch 5599 
Prediction Loss: 0.797783
Epoch 5649 
Prediction Loss: 0.804468
Epoch 5699 
Prediction Loss: 0.810836
Epoch 5749 
Prediction Loss: 0.816870
Epoch 5799 
Prediction Loss: 0.799595
Epoch 5849 
Prediction Loss: 0.802071
Epoch 5899 
Prediction Loss: 0.799299
Epoch 5949 
Prediction Loss: 0.833989
Epoch 5999 
Prediction Loss: 0.773102
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.874057
Insample Error 4.189667
[31m========== repeat time 10 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.473524
Rec Loss: 11.643185
KL Loss: 1.830339
Y Loss: 0.998837
T Loss: 11.143767
Epoch 99 
Overall Loss: 13.348512
Rec Loss: 11.356692
KL Loss: 1.991820
Y Loss: 0.994809
T Loss: 10.859288
Epoch 149 
Overall Loss: 13.305276
Rec Loss: 11.304047
KL Loss: 2.001230
Y Loss: 0.972418
T Loss: 10.817837
Epoch 199 
Overall Loss: 13.238214
Rec Loss: 11.009416
KL Loss: 2.228798
Y Loss: 0.971347
T Loss: 10.523742
Epoch 249 
Overall Loss: 13.206332
Rec Loss: 11.015006
KL Loss: 2.191325
Y Loss: 0.976951
T Loss: 10.526531
Epoch 299 
Overall Loss: 13.216130
Rec Loss: 10.974088
KL Loss: 2.242042
Y Loss: 0.969962
T Loss: 10.489107
Epoch 349 
Overall Loss: 13.203291
Rec Loss: 10.946586
KL Loss: 2.256704
Y Loss: 0.974989
T Loss: 10.459092
Epoch 399 
Overall Loss: 13.179933
Rec Loss: 10.964488
KL Loss: 2.215446
Y Loss: 0.981275
T Loss: 10.473850
Epoch 449 
Overall Loss: 13.175052
Rec Loss: 10.938957
KL Loss: 2.236095
Y Loss: 0.953900
T Loss: 10.462007
Epoch 499 
Overall Loss: 13.171339
Rec Loss: 10.933921
KL Loss: 2.237418
Y Loss: 0.962775
T Loss: 10.452534
Epoch 549 
Overall Loss: 13.173066
Rec Loss: 10.946502
KL Loss: 2.226565
Y Loss: 0.980238
T Loss: 10.456382
Epoch 599 
Overall Loss: 13.147346
Rec Loss: 10.911975
KL Loss: 2.235372
Y Loss: 0.978185
T Loss: 10.422882
Epoch 649 
Overall Loss: 13.123401
Rec Loss: 10.919003
KL Loss: 2.204398
Y Loss: 0.949851
T Loss: 10.444078
Epoch 699 
Overall Loss: 13.155287
Rec Loss: 10.939276
KL Loss: 2.216011
Y Loss: 0.982318
T Loss: 10.448117
Epoch 749 
Overall Loss: 13.124305
Rec Loss: 10.915656
KL Loss: 2.208649
Y Loss: 0.953369
T Loss: 10.438972
Epoch 799 
Overall Loss: 13.122348
Rec Loss: 10.906735
KL Loss: 2.215613
Y Loss: 0.961546
T Loss: 10.425962
Epoch 849 
Overall Loss: 13.130553
Rec Loss: 10.903789
KL Loss: 2.226763
Y Loss: 0.960834
T Loss: 10.423372
Epoch 899 
Overall Loss: 13.097550
Rec Loss: 10.905408
KL Loss: 2.192142
Y Loss: 0.962949
T Loss: 10.423933
Epoch 949 
Overall Loss: 13.154733
Rec Loss: 10.925383
KL Loss: 2.229350
Y Loss: 0.957554
T Loss: 10.446606
Epoch 999 
Overall Loss: 13.121901
Rec Loss: 10.900150
KL Loss: 2.221752
Y Loss: 0.956902
T Loss: 10.421699
Epoch 1049 
Overall Loss: 13.096914
Rec Loss: 10.887748
KL Loss: 2.209167
Y Loss: 0.964343
T Loss: 10.405576
Epoch 1099 
Overall Loss: 13.095989
Rec Loss: 10.886943
KL Loss: 2.209046
Y Loss: 0.958469
T Loss: 10.407708
Epoch 1149 
Overall Loss: 13.084503
Rec Loss: 10.866248
KL Loss: 2.218255
Y Loss: 0.940687
T Loss: 10.395905
Epoch 1199 
Overall Loss: 13.098791
Rec Loss: 10.892712
KL Loss: 2.206079
Y Loss: 0.952216
T Loss: 10.416604
Epoch 1249 
Overall Loss: 13.091787
Rec Loss: 10.876376
KL Loss: 2.215410
Y Loss: 0.952912
T Loss: 10.399921
Epoch 1299 
Overall Loss: 13.103601
Rec Loss: 10.889623
KL Loss: 2.213978
Y Loss: 0.954973
T Loss: 10.412136
Epoch 1349 
Overall Loss: 13.099082
Rec Loss: 10.900026
KL Loss: 2.199056
Y Loss: 0.944672
T Loss: 10.427690
Epoch 1399 
Overall Loss: 13.085456
Rec Loss: 10.888369
KL Loss: 2.197087
Y Loss: 0.971535
T Loss: 10.402602
Epoch 1449 
Overall Loss: 13.095748
Rec Loss: 10.868569
KL Loss: 2.227179
Y Loss: 0.941687
T Loss: 10.397725
Epoch 1499 
Overall Loss: 13.063498
Rec Loss: 10.866260
KL Loss: 2.197238
Y Loss: 0.949743
T Loss: 10.391388
Epoch 1549 
Overall Loss: 13.072877
Rec Loss: 10.868570
KL Loss: 2.204307
Y Loss: 0.953413
T Loss: 10.391863
Epoch 1599 
Overall Loss: 13.086974
Rec Loss: 10.867044
KL Loss: 2.219930
Y Loss: 0.957707
T Loss: 10.388191
Epoch 1649 
Overall Loss: 13.060550
Rec Loss: 10.866639
KL Loss: 2.193911
Y Loss: 0.949911
T Loss: 10.391684
Epoch 1699 
Overall Loss: 13.063146
Rec Loss: 10.853317
KL Loss: 2.209829
Y Loss: 0.948155
T Loss: 10.379240
Epoch 1749 
Overall Loss: 13.065769
Rec Loss: 10.870233
KL Loss: 2.195536
Y Loss: 0.954984
T Loss: 10.392741
Epoch 1799 
Overall Loss: 13.049688
Rec Loss: 10.827621
KL Loss: 2.222067
Y Loss: 0.942991
T Loss: 10.356126
Epoch 1849 
Overall Loss: 13.063399
Rec Loss: 10.834509
KL Loss: 2.228890
Y Loss: 0.935317
T Loss: 10.366850
Epoch 1899 
Overall Loss: 13.053593
Rec Loss: 10.834190
KL Loss: 2.219404
Y Loss: 0.947615
T Loss: 10.360382
Epoch 1949 
Overall Loss: 13.054078
Rec Loss: 10.829069
KL Loss: 2.225009
Y Loss: 0.938024
T Loss: 10.360057
Epoch 1999 
Overall Loss: 13.082633
Rec Loss: 10.843739
KL Loss: 2.238894
Y Loss: 0.959055
T Loss: 10.364212
Epoch 2049 
Overall Loss: 13.043999
Rec Loss: 10.842793
KL Loss: 2.201206
Y Loss: 0.951937
T Loss: 10.366825
Epoch 2099 
Overall Loss: 13.031756
Rec Loss: 10.809204
KL Loss: 2.222552
Y Loss: 0.923286
T Loss: 10.347561
Epoch 2149 
Overall Loss: 13.022403
Rec Loss: 10.830086
KL Loss: 2.192317
Y Loss: 0.954417
T Loss: 10.352878
Epoch 2199 
Overall Loss: 13.031432
Rec Loss: 10.830824
KL Loss: 2.200608
Y Loss: 0.958750
T Loss: 10.351449
Epoch 2249 
Overall Loss: 13.022928
Rec Loss: 10.815033
KL Loss: 2.207895
Y Loss: 0.914823
T Loss: 10.357621
Epoch 2299 
Overall Loss: 13.045017
Rec Loss: 10.837137
KL Loss: 2.207880
Y Loss: 0.945645
T Loss: 10.364314
Epoch 2349 
Overall Loss: 13.040971
Rec Loss: 10.824850
KL Loss: 2.216121
Y Loss: 0.925670
T Loss: 10.362016
Epoch 2399 
Overall Loss: 13.031832
Rec Loss: 10.801208
KL Loss: 2.230624
Y Loss: 0.935930
T Loss: 10.333243
Epoch 2449 
Overall Loss: 13.015528
Rec Loss: 10.771684
KL Loss: 2.243844
Y Loss: 0.915300
T Loss: 10.314034
Epoch 2499 
Overall Loss: 13.047527
Rec Loss: 10.801049
KL Loss: 2.246479
Y Loss: 0.942653
T Loss: 10.329722
Epoch 2549 
Overall Loss: 12.994065
Rec Loss: 10.799796
KL Loss: 2.194269
Y Loss: 0.896520
T Loss: 10.351536
Epoch 2599 
Overall Loss: 13.015637
Rec Loss: 10.790429
KL Loss: 2.225208
Y Loss: 0.930523
T Loss: 10.325167
Epoch 2649 
Overall Loss: 12.996338
Rec Loss: 10.786194
KL Loss: 2.210144
Y Loss: 0.909367
T Loss: 10.331510
Epoch 2699 
Overall Loss: 13.001251
Rec Loss: 10.789439
KL Loss: 2.211813
Y Loss: 0.941702
T Loss: 10.318588
Epoch 2749 
Overall Loss: 12.986144
Rec Loss: 10.773295
KL Loss: 2.212849
Y Loss: 0.925010
T Loss: 10.310790
Epoch 2799 
Overall Loss: 13.008080
Rec Loss: 10.794439
KL Loss: 2.213641
Y Loss: 0.921723
T Loss: 10.333577
Epoch 2849 
Overall Loss: 12.984471
Rec Loss: 10.787307
KL Loss: 2.197163
Y Loss: 0.925829
T Loss: 10.324393
Epoch 2899 
Overall Loss: 12.979784
Rec Loss: 10.772475
KL Loss: 2.207309
Y Loss: 0.945810
T Loss: 10.299570
Epoch 2949 
Overall Loss: 13.011627
Rec Loss: 10.788376
KL Loss: 2.223252
Y Loss: 0.956057
T Loss: 10.310348
Epoch 2999 
Overall Loss: 12.982339
Rec Loss: 10.786216
KL Loss: 2.196123
Y Loss: 0.928902
T Loss: 10.321765
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.042110
Epoch 99
Rec Loss: 2.059917
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.954277
Epoch 99
Rec Loss: 9.912944
Epoch 149
Rec Loss: 9.914793
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.630916
Insample Error: 1.976292
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 20.611893
Rec Loss: 17.253755
KL Loss: 3.358138
Y Loss: 7.258810
T Loss: 12.881425
X Loss: 0.742925
Epoch 99 
Overall Loss: 16.263702
Rec Loss: 12.681712
KL Loss: 3.581991
Y Loss: 2.801962
T Loss: 12.948387
X Loss: -1.667656
Epoch 149 
Overall Loss: 15.159096
Rec Loss: 11.797669
KL Loss: 3.361427
Y Loss: 2.537232
T Loss: 12.923138
X Loss: -2.394085
Epoch 199 
Overall Loss: 14.311452
Rec Loss: 10.510289
KL Loss: 3.801163
Y Loss: 2.080900
T Loss: 12.289096
X Loss: -2.819257
Epoch 249 
Overall Loss: 13.730549
Rec Loss: 9.629629
KL Loss: 4.100920
Y Loss: 1.636805
T Loss: 11.859471
X Loss: -3.048244
Epoch 299 
Overall Loss: 13.512840
Rec Loss: 9.344506
KL Loss: 4.168333
Y Loss: 1.384623
T Loss: 11.817879
X Loss: -3.165683
Epoch 349 
Overall Loss: 13.398034
Rec Loss: 9.220623
KL Loss: 4.177410
Y Loss: 1.268071
T Loss: 11.811783
X Loss: -3.225195
Epoch 399 
Overall Loss: 13.313041
Rec Loss: 9.112496
KL Loss: 4.200545
Y Loss: 1.188067
T Loss: 11.825334
X Loss: -3.306871
Epoch 449 
Overall Loss: 13.237389
Rec Loss: 8.989319
KL Loss: 4.248071
Y Loss: 1.140107
T Loss: 11.777972
X Loss: -3.358707
Epoch 499 
Overall Loss: 13.196800
Rec Loss: 8.896815
KL Loss: 4.299986
Y Loss: 1.099279
T Loss: 11.701262
X Loss: -3.354086
Epoch 549 
Overall Loss: 13.114880
Rec Loss: 8.759227
KL Loss: 4.355653
Y Loss: 1.071170
T Loss: 11.633584
X Loss: -3.409941
Epoch 599 
Overall Loss: 13.069004
Rec Loss: 8.637030
KL Loss: 4.431975
Y Loss: 1.048948
T Loss: 11.534154
X Loss: -3.421599
Epoch 649 
Overall Loss: 12.979885
Rec Loss: 8.452391
KL Loss: 4.527494
Y Loss: 1.064350
T Loss: 11.383415
X Loss: -3.463199
Epoch 699 
Overall Loss: 12.955656
Rec Loss: 8.354141
KL Loss: 4.601514
Y Loss: 1.066529
T Loss: 11.295899
X Loss: -3.475023
Epoch 749 
Overall Loss: 12.919042
Rec Loss: 8.243083
KL Loss: 4.675959
Y Loss: 1.049289
T Loss: 11.207863
X Loss: -3.489424
Epoch 799 
Overall Loss: 12.899002
Rec Loss: 8.163215
KL Loss: 4.735787
Y Loss: 1.043332
T Loss: 11.172371
X Loss: -3.530822
Epoch 849 
Overall Loss: 12.860215
Rec Loss: 8.109147
KL Loss: 4.751067
Y Loss: 1.011444
T Loss: 11.110997
X Loss: -3.507571
Epoch 899 
Overall Loss: 12.841175
Rec Loss: 8.043802
KL Loss: 4.797374
Y Loss: 0.991936
T Loss: 11.085246
X Loss: -3.537411
Epoch 949 
Overall Loss: 12.837589
Rec Loss: 8.011813
KL Loss: 4.825776
Y Loss: 1.003475
T Loss: 11.047457
X Loss: -3.537382
Epoch 999 
Overall Loss: 12.814302
Rec Loss: 7.953108
KL Loss: 4.861194
Y Loss: 0.988054
T Loss: 11.005490
X Loss: -3.546410
Epoch 1049 
Overall Loss: 12.776022
Rec Loss: 7.891851
KL Loss: 4.884171
Y Loss: 0.973303
T Loss: 10.962244
X Loss: -3.557045
Epoch 1099 
Overall Loss: 12.764995
Rec Loss: 7.862183
KL Loss: 4.902813
Y Loss: 0.992030
T Loss: 10.927461
X Loss: -3.561293
Epoch 1149 
Overall Loss: 12.763669
Rec Loss: 7.827791
KL Loss: 4.935878
Y Loss: 1.013530
T Loss: 10.900171
X Loss: -3.579145
Epoch 1199 
Overall Loss: 12.766537
Rec Loss: 7.835142
KL Loss: 4.931395
Y Loss: 0.991130
T Loss: 10.914222
X Loss: -3.574645
Epoch 1249 
Overall Loss: 12.737945
Rec Loss: 7.783494
KL Loss: 4.954450
Y Loss: 0.970608
T Loss: 10.879722
X Loss: -3.581532
Epoch 1299 
Overall Loss: 12.760598
Rec Loss: 7.808319
KL Loss: 4.952279
Y Loss: 0.993767
T Loss: 10.886084
X Loss: -3.574648
Epoch 1349 
Overall Loss: 12.706894
Rec Loss: 7.753911
KL Loss: 4.952983
Y Loss: 0.972663
T Loss: 10.866187
X Loss: -3.598608
Epoch 1399 
Overall Loss: 12.726312
Rec Loss: 7.775470
KL Loss: 4.950842
Y Loss: 0.986473
T Loss: 10.863918
X Loss: -3.581685
Epoch 1449 
Overall Loss: 12.712547
Rec Loss: 7.749666
KL Loss: 4.962882
Y Loss: 0.978667
T Loss: 10.866666
X Loss: -3.606334
Epoch 1499 
Overall Loss: 12.708422
Rec Loss: 7.707117
KL Loss: 5.001304
Y Loss: 0.971736
T Loss: 10.842808
X Loss: -3.621559
Epoch 1549 
Overall Loss: 12.716019
Rec Loss: 7.741084
KL Loss: 4.974934
Y Loss: 0.979950
T Loss: 10.855284
X Loss: -3.604175
Epoch 1599 
Overall Loss: 12.670740
Rec Loss: 7.720867
KL Loss: 4.949874
Y Loss: 0.971299
T Loss: 10.839851
X Loss: -3.604634
Epoch 1649 
Overall Loss: 12.670920
Rec Loss: 7.686702
KL Loss: 4.984218
Y Loss: 0.979380
T Loss: 10.839604
X Loss: -3.642593
Epoch 1699 
Overall Loss: 12.707069
Rec Loss: 7.742597
KL Loss: 4.964472
Y Loss: 0.995972
T Loss: 10.853655
X Loss: -3.609044
Epoch 1749 
Overall Loss: 12.712976
Rec Loss: 7.741334
KL Loss: 4.971642
Y Loss: 0.984886
T Loss: 10.859229
X Loss: -3.610338
Epoch 1799 
Overall Loss: 12.664307
Rec Loss: 7.693808
KL Loss: 4.970500
Y Loss: 0.979466
T Loss: 10.836758
X Loss: -3.632683
Epoch 1849 
Overall Loss: 12.702798
Rec Loss: 7.733453
KL Loss: 4.969346
Y Loss: 0.981975
T Loss: 10.842932
X Loss: -3.600467
Epoch 1899 
Overall Loss: 12.648959
Rec Loss: 7.660361
KL Loss: 4.988598
Y Loss: 0.949032
T Loss: 10.824991
X Loss: -3.639146
Epoch 1949 
Overall Loss: 12.671020
Rec Loss: 7.692189
KL Loss: 4.978831
Y Loss: 0.958753
T Loss: 10.837375
X Loss: -3.624563
Epoch 1999 
Overall Loss: 12.708480
Rec Loss: 7.737683
KL Loss: 4.970796
Y Loss: 0.983608
T Loss: 10.859464
X Loss: -3.613584
Epoch 2049 
Overall Loss: 12.665008
Rec Loss: 7.711381
KL Loss: 4.953626
Y Loss: 0.976231
T Loss: 10.845418
X Loss: -3.622152
Epoch 2099 
Overall Loss: 12.665860
Rec Loss: 7.696896
KL Loss: 4.968965
Y Loss: 0.988271
T Loss: 10.814721
X Loss: -3.611960
Epoch 2149 
Overall Loss: 12.647995
Rec Loss: 7.687400
KL Loss: 4.960595
Y Loss: 0.948718
T Loss: 10.847195
X Loss: -3.634154
Epoch 2199 
Overall Loss: 12.617130
Rec Loss: 7.656889
KL Loss: 4.960241
Y Loss: 0.961733
T Loss: 10.817636
X Loss: -3.641614
Epoch 2249 
Overall Loss: 12.676028
Rec Loss: 7.708253
KL Loss: 4.967776
Y Loss: 0.990531
T Loss: 10.842568
X Loss: -3.629580
Epoch 2299 
Overall Loss: 12.626569
Rec Loss: 7.639756
KL Loss: 4.986813
Y Loss: 0.957792
T Loss: 10.814038
X Loss: -3.653178
Epoch 2349 
Overall Loss: 12.643253
Rec Loss: 7.673651
KL Loss: 4.969603
Y Loss: 0.961290
T Loss: 10.824636
X Loss: -3.631630
Epoch 2399 
Overall Loss: 12.649505
Rec Loss: 7.686415
KL Loss: 4.963090
Y Loss: 0.987437
T Loss: 10.830769
X Loss: -3.638072
Epoch 2449 
Overall Loss: 12.634543
Rec Loss: 7.662540
KL Loss: 4.972003
Y Loss: 0.934472
T Loss: 10.830572
X Loss: -3.635268
Epoch 2499 
Overall Loss: 12.671773
Rec Loss: 7.670583
KL Loss: 5.001190
Y Loss: 0.972823
T Loss: 10.834527
X Loss: -3.650356
Epoch 2549 
Overall Loss: 12.629812
Rec Loss: 7.670509
KL Loss: 4.959303
Y Loss: 1.013311
T Loss: 10.823255
X Loss: -3.659401
Epoch 2599 
Overall Loss: 12.648232
Rec Loss: 7.675255
KL Loss: 4.972977
Y Loss: 0.977033
T Loss: 10.833375
X Loss: -3.646636
Epoch 2649 
Overall Loss: 12.632881
Rec Loss: 7.668288
KL Loss: 4.964593
Y Loss: 0.968498
T Loss: 10.820652
X Loss: -3.636613
Epoch 2699 
Overall Loss: 12.620697
Rec Loss: 7.646286
KL Loss: 4.974411
Y Loss: 0.976536
T Loss: 10.820296
X Loss: -3.662278
Epoch 2749 
Overall Loss: 12.633819
Rec Loss: 7.652688
KL Loss: 4.981131
Y Loss: 0.958084
T Loss: 10.840985
X Loss: -3.667339
Epoch 2799 
Overall Loss: 12.611285
Rec Loss: 7.624282
KL Loss: 4.987003
Y Loss: 0.957694
T Loss: 10.809845
X Loss: -3.664410
Epoch 2849 
Overall Loss: 12.632877
Rec Loss: 7.642375
KL Loss: 4.990502
Y Loss: 0.962603
T Loss: 10.834489
X Loss: -3.673416
Epoch 2899 
Overall Loss: 12.645342
Rec Loss: 7.635805
KL Loss: 5.009538
Y Loss: 0.970507
T Loss: 10.816213
X Loss: -3.665662
Epoch 2949 
Overall Loss: 12.616552
Rec Loss: 7.638621
KL Loss: 4.977931
Y Loss: 0.956097
T Loss: 10.821561
X Loss: -3.660988
Epoch 2999 
Overall Loss: 12.622894
Rec Loss: 7.646577
KL Loss: 4.976317
Y Loss: 0.988139
T Loss: 10.823012
X Loss: -3.670504
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.404361
Epoch 99
Rec Loss: 2.403388
Epoch 149
Rec Loss: 2.398661
Epoch 199
Rec Loss: 2.400454
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.001798
Epoch 99
Rec Loss: 2.001785
Epoch 149
Rec Loss: 2.002961
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.571164
Insample Error 2.820741
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 3.673661
Epoch 99 
Prediction Loss: 3.403746
Epoch 149 
Prediction Loss: 3.169022
Epoch 199 
Prediction Loss: 3.066923
Epoch 249 
Prediction Loss: 2.922932
Epoch 299 
Prediction Loss: 2.729868
Epoch 349 
Prediction Loss: 2.603723
Epoch 399 
Prediction Loss: 2.411991
Epoch 449 
Prediction Loss: 2.260459
Epoch 499 
Prediction Loss: 2.123600
Epoch 549 
Prediction Loss: 2.025648
Epoch 599 
Prediction Loss: 1.940868
Epoch 649 
Prediction Loss: 1.858426
Epoch 699 
Prediction Loss: 1.811046
Epoch 749 
Prediction Loss: 1.731794
Epoch 799 
Prediction Loss: 1.630161
Epoch 849 
Prediction Loss: 1.569277
Epoch 899 
Prediction Loss: 1.647532
Epoch 949 
Prediction Loss: 1.459622
Epoch 999 
Prediction Loss: 1.441033
Epoch 1049 
Prediction Loss: 1.414737
Epoch 1099 
Prediction Loss: 1.377478
Epoch 1149 
Prediction Loss: 1.334951
Epoch 1199 
Prediction Loss: 1.347567
Epoch 1249 
Prediction Loss: 1.286019
Epoch 1299 
Prediction Loss: 1.260559
Epoch 1349 
Prediction Loss: 1.272999
Epoch 1399 
Prediction Loss: 1.229641
Epoch 1449 
Prediction Loss: 1.203200
Epoch 1499 
Prediction Loss: 1.176240
Epoch 1549 
Prediction Loss: 1.147431
Epoch 1599 
Prediction Loss: 1.129949
Epoch 1649 
Prediction Loss: 1.121500
Epoch 1699 
Prediction Loss: 1.092557
Epoch 1749 
Prediction Loss: 1.084116
Epoch 1799 
Prediction Loss: 1.054736
Epoch 1849 
Prediction Loss: 1.060060
Epoch 1899 
Prediction Loss: 1.045933
Epoch 1949 
Prediction Loss: 1.039450
Epoch 1999 
Prediction Loss: 1.023544
Epoch 2049 
Prediction Loss: 0.998913
Epoch 2099 
Prediction Loss: 1.009779
Epoch 2149 
Prediction Loss: 1.010761
Epoch 2199 
Prediction Loss: 0.991768
Epoch 2249 
Prediction Loss: 0.981135
Epoch 2299 
Prediction Loss: 0.987298
Epoch 2349 
Prediction Loss: 0.958629
Epoch 2399 
Prediction Loss: 0.999956
Epoch 2449 
Prediction Loss: 0.971084
Epoch 2499 
Prediction Loss: 0.962733
Epoch 2549 
Prediction Loss: 0.934054
Epoch 2599 
Prediction Loss: 1.014377
Epoch 2649 
Prediction Loss: 0.936448
Epoch 2699 
Prediction Loss: 0.931029
Epoch 2749 
Prediction Loss: 0.946917
Epoch 2799 
Prediction Loss: 0.913363
Epoch 2849 
Prediction Loss: 0.974805
Epoch 2899 
Prediction Loss: 0.907906
Epoch 2949 
Prediction Loss: 0.894619
Epoch 2999 
Prediction Loss: 0.935540
Epoch 3049 
Prediction Loss: 0.892460
Epoch 3099 
Prediction Loss: 0.899610
Epoch 3149 
Prediction Loss: 0.883284
Epoch 3199 
Prediction Loss: 0.868952
Epoch 3249 
Prediction Loss: 0.894346
Epoch 3299 
Prediction Loss: 0.878859
Epoch 3349 
Prediction Loss: 0.859167
Epoch 3399 
Prediction Loss: 0.907908
Epoch 3449 
Prediction Loss: 0.842959
Epoch 3499 
Prediction Loss: 0.876052
Epoch 3549 
Prediction Loss: 0.870730
Epoch 3599 
Prediction Loss: 0.837957
Epoch 3649 
Prediction Loss: 0.849356
Epoch 3699 
Prediction Loss: 0.861696
Epoch 3749 
Prediction Loss: 0.835892
Epoch 3799 
Prediction Loss: 0.837719
Epoch 3849 
Prediction Loss: 0.828136
Epoch 3899 
Prediction Loss: 0.809714
Epoch 3949 
Prediction Loss: 0.821661
Epoch 3999 
Prediction Loss: 0.836838
Epoch 4049 
Prediction Loss: 0.807458
Epoch 4099 
Prediction Loss: 0.818575
Epoch 4149 
Prediction Loss: 0.805300
Epoch 4199 
Prediction Loss: 0.800208
Epoch 4249 
Prediction Loss: 0.805657
Epoch 4299 
Prediction Loss: 0.811662
Epoch 4349 
Prediction Loss: 0.809535
Epoch 4399 
Prediction Loss: 0.794064
Epoch 4449 
Prediction Loss: 0.797100
Epoch 4499 
Prediction Loss: 0.830484
Epoch 4549 
Prediction Loss: 0.785351
Epoch 4599 
Prediction Loss: 0.772023
Epoch 4649 
Prediction Loss: 0.773505
Epoch 4699 
Prediction Loss: 0.779787
Epoch 4749 
Prediction Loss: 0.774307
Epoch 4799 
Prediction Loss: 0.774972
Epoch 4849 
Prediction Loss: 0.784917
Epoch 4899 
Prediction Loss: 0.764205
Epoch 4949 
Prediction Loss: 0.788892
Epoch 4999 
Prediction Loss: 0.773593
Epoch 5049 
Prediction Loss: 0.760924
Epoch 5099 
Prediction Loss: 0.796689
Epoch 5149 
Prediction Loss: 0.781158
Epoch 5199 
Prediction Loss: 0.767725
Epoch 5249 
Prediction Loss: 0.773983
Epoch 5299 
Prediction Loss: 0.777241
Epoch 5349 
Prediction Loss: 0.758555
Epoch 5399 
Prediction Loss: 0.773986
Epoch 5449 
Prediction Loss: 0.768357
Epoch 5499 
Prediction Loss: 0.775695
Epoch 5549 
Prediction Loss: 0.764855
Epoch 5599 
Prediction Loss: 0.747303
Epoch 5649 
Prediction Loss: 0.756698
Epoch 5699 
Prediction Loss: 0.759143
Epoch 5749 
Prediction Loss: 0.773194
Epoch 5799 
Prediction Loss: 0.745734
Epoch 5849 
Prediction Loss: 0.751502
Epoch 5899 
Prediction Loss: 0.739165
Epoch 5949 
Prediction Loss: 0.755461
Epoch 5999 
Prediction Loss: 0.732230
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.852252
Insample Error 4.259917
Ours, Train RMSE
0.6193, 
0.6337, 
0.6285, 
0.6384, 
0.6237, 
0.6420, 
0.6510, 
0.6385, 
0.6289, 
0.6309, 
CEVAE, Train RMSE
0.5662, 
0.5654, 
0.5714, 
0.5768, 
0.5868, 
0.5796, 
0.5757, 
0.5836, 
0.5775, 
0.5712, 
Ours, Insample RMSE
1.9444, 
1.9355, 
2.0371, 
2.0304, 
1.9615, 
1.9824, 
2.0335, 
2.0552, 
2.0296, 
1.9763, 
CEVAE, Insample RMSE
2.7417, 
2.7603, 
2.6817, 
2.6911, 
2.7423, 
2.7716, 
2.7976, 
3.1643, 
2.7952, 
2.8207, 
Direct Regression, Insample RMSE
4.2535, 
4.2505, 
4.1427, 
4.2554, 
4.2542, 
4.3128, 
4.2315, 
4.3277, 
4.1897, 
4.2599, 
Train, RMSE mean 0.6335 std 0.0088
CEVAE, RMSE mean 0.5754 std 0.0066
Ours, RMSE mean 1.9986 std 0.0412, reconstruct confounder 2.0487 (0.0089) noise 9.9152 (0.0110)
CEVAE, RMSE mean 2.7967 std 0.1296, reconstruct confounder 2.4193 (0.0845) noise 1.9996 (0.0027)
Direct Regression, RMSE mean 4.2478 std 0.0506
