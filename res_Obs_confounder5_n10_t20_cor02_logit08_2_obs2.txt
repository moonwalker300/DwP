Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=5, mask=0, nlayer=50, obsm=2, stop=5000, ycof=0.5, ylayer=50)
Y Mean 1.254702, Std 3.319627 
Test Y Mean -0.014820, Std 3.289810 
Observe confounder 2, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.871605
Rec Loss: 11.419143
KL Loss: 1.452461
Y Loss: 1.000658
T Loss: 10.918814
Epoch 99 
Overall Loss: 12.803927
Rec Loss: 11.399871
KL Loss: 1.404056
Y Loss: 0.969495
T Loss: 10.915124
Epoch 149 
Overall Loss: 12.758797
Rec Loss: 11.379913
KL Loss: 1.378884
Y Loss: 0.954664
T Loss: 10.902581
Epoch 199 
Overall Loss: 12.759199
Rec Loss: 11.391041
KL Loss: 1.368158
Y Loss: 0.977075
T Loss: 10.902503
Epoch 249 
Overall Loss: 12.719418
Rec Loss: 11.362571
KL Loss: 1.356847
Y Loss: 0.946229
T Loss: 10.889456
Epoch 299 
Overall Loss: 12.688867
Rec Loss: 11.235734
KL Loss: 1.453133
Y Loss: 0.951542
T Loss: 10.759963
Epoch 349 
Overall Loss: 12.646883
Rec Loss: 11.040256
KL Loss: 1.606627
Y Loss: 0.962876
T Loss: 10.558818
Epoch 399 
Overall Loss: 12.610404
Rec Loss: 11.012004
KL Loss: 1.598400
Y Loss: 0.959517
T Loss: 10.532245
Epoch 449 
Overall Loss: 12.606959
Rec Loss: 10.998900
KL Loss: 1.608059
Y Loss: 0.948258
T Loss: 10.524772
Epoch 499 
Overall Loss: 12.616888
Rec Loss: 10.965063
KL Loss: 1.651825
Y Loss: 0.940832
T Loss: 10.494647
Epoch 549 
Overall Loss: 12.602323
Rec Loss: 10.981161
KL Loss: 1.621162
Y Loss: 0.932520
T Loss: 10.514901
Epoch 599 
Overall Loss: 12.590301
Rec Loss: 10.969063
KL Loss: 1.621237
Y Loss: 0.941594
T Loss: 10.498267
Epoch 649 
Overall Loss: 12.602526
Rec Loss: 10.979567
KL Loss: 1.622959
Y Loss: 0.963251
T Loss: 10.497941
Epoch 699 
Overall Loss: 12.576548
Rec Loss: 10.952213
KL Loss: 1.624335
Y Loss: 0.933277
T Loss: 10.485575
Epoch 749 
Overall Loss: 12.586601
Rec Loss: 10.959170
KL Loss: 1.627431
Y Loss: 0.944380
T Loss: 10.486980
Epoch 799 
Overall Loss: 12.563781
Rec Loss: 10.954122
KL Loss: 1.609659
Y Loss: 0.941722
T Loss: 10.483261
Epoch 849 
Overall Loss: 12.566425
Rec Loss: 10.944684
KL Loss: 1.621741
Y Loss: 0.918044
T Loss: 10.485662
Epoch 899 
Overall Loss: 12.598506
Rec Loss: 10.941440
KL Loss: 1.657066
Y Loss: 0.909150
T Loss: 10.486865
Epoch 949 
Overall Loss: 12.561254
Rec Loss: 10.953891
KL Loss: 1.607363
Y Loss: 0.945935
T Loss: 10.480924
Epoch 999 
Overall Loss: 12.576714
Rec Loss: 10.953649
KL Loss: 1.623065
Y Loss: 0.930327
T Loss: 10.488486
Epoch 1049 
Overall Loss: 12.576267
Rec Loss: 10.944059
KL Loss: 1.632208
Y Loss: 0.916822
T Loss: 10.485648
Epoch 1099 
Overall Loss: 12.553419
Rec Loss: 10.929378
KL Loss: 1.624041
Y Loss: 0.912279
T Loss: 10.473239
Epoch 1149 
Overall Loss: 12.565371
Rec Loss: 10.924964
KL Loss: 1.640407
Y Loss: 0.934739
T Loss: 10.457595
Epoch 1199 
Overall Loss: 12.551721
Rec Loss: 10.912905
KL Loss: 1.638816
Y Loss: 0.930103
T Loss: 10.447854
Epoch 1249 
Overall Loss: 12.533070
Rec Loss: 10.925417
KL Loss: 1.607653
Y Loss: 0.919464
T Loss: 10.465686
Epoch 1299 
Overall Loss: 12.521003
Rec Loss: 10.901805
KL Loss: 1.619199
Y Loss: 0.920159
T Loss: 10.441725
Epoch 1349 
Overall Loss: 12.539645
Rec Loss: 10.916994
KL Loss: 1.622652
Y Loss: 0.923998
T Loss: 10.454994
Epoch 1399 
Overall Loss: 12.526816
Rec Loss: 10.898998
KL Loss: 1.627818
Y Loss: 0.899444
T Loss: 10.449276
Epoch 1449 
Overall Loss: 12.529160
Rec Loss: 10.887980
KL Loss: 1.641179
Y Loss: 0.884529
T Loss: 10.445716
Epoch 1499 
Overall Loss: 12.512385
Rec Loss: 10.917806
KL Loss: 1.594579
Y Loss: 0.900439
T Loss: 10.467587
Epoch 1549 
Overall Loss: 12.511574
Rec Loss: 10.893867
KL Loss: 1.617706
Y Loss: 0.891832
T Loss: 10.447952
Epoch 1599 
Overall Loss: 12.492162
Rec Loss: 10.871153
KL Loss: 1.621009
Y Loss: 0.892778
T Loss: 10.424764
Epoch 1649 
Overall Loss: 12.506239
Rec Loss: 10.875456
KL Loss: 1.630784
Y Loss: 0.921036
T Loss: 10.414938
Epoch 1699 
Overall Loss: 12.514772
Rec Loss: 10.903123
KL Loss: 1.611648
Y Loss: 0.940622
T Loss: 10.432812
Epoch 1749 
Overall Loss: 12.491675
Rec Loss: 10.862400
KL Loss: 1.629275
Y Loss: 0.893804
T Loss: 10.415498
Epoch 1799 
Overall Loss: 12.509437
Rec Loss: 10.905420
KL Loss: 1.604017
Y Loss: 0.903245
T Loss: 10.453798
Epoch 1849 
Overall Loss: 12.514472
Rec Loss: 10.888663
KL Loss: 1.625809
Y Loss: 0.916997
T Loss: 10.430164
Epoch 1899 
Overall Loss: 12.512955
Rec Loss: 10.873048
KL Loss: 1.639907
Y Loss: 0.893665
T Loss: 10.426216
Epoch 1949 
Overall Loss: 12.482885
Rec Loss: 10.864742
KL Loss: 1.618143
Y Loss: 0.887415
T Loss: 10.421034
Epoch 1999 
Overall Loss: 12.468672
Rec Loss: 10.846632
KL Loss: 1.622041
Y Loss: 0.901223
T Loss: 10.396020
Epoch 2049 
Overall Loss: 12.470764
Rec Loss: 10.877472
KL Loss: 1.593292
Y Loss: 0.895642
T Loss: 10.429651
Epoch 2099 
Overall Loss: 12.476499
Rec Loss: 10.871429
KL Loss: 1.605070
Y Loss: 0.895115
T Loss: 10.423872
Epoch 2149 
Overall Loss: 12.500272
Rec Loss: 10.865193
KL Loss: 1.635079
Y Loss: 0.905832
T Loss: 10.412277
Epoch 2199 
Overall Loss: 12.492672
Rec Loss: 10.863607
KL Loss: 1.629065
Y Loss: 0.886827
T Loss: 10.420193
Epoch 2249 
Overall Loss: 12.477443
Rec Loss: 10.852118
KL Loss: 1.625325
Y Loss: 0.905451
T Loss: 10.399393
Epoch 2299 
Overall Loss: 12.474377
Rec Loss: 10.856190
KL Loss: 1.618188
Y Loss: 0.896071
T Loss: 10.408154
Epoch 2349 
Overall Loss: 12.462097
Rec Loss: 10.866269
KL Loss: 1.595827
Y Loss: 0.910077
T Loss: 10.411231
Epoch 2399 
Overall Loss: 12.445864
Rec Loss: 10.830740
KL Loss: 1.615124
Y Loss: 0.886102
T Loss: 10.387689
Epoch 2449 
Overall Loss: 12.450857
Rec Loss: 10.851192
KL Loss: 1.599665
Y Loss: 0.909948
T Loss: 10.396217
Epoch 2499 
Overall Loss: 12.475922
Rec Loss: 10.853647
KL Loss: 1.622275
Y Loss: 0.915781
T Loss: 10.395756
Epoch 2549 
Overall Loss: 12.447473
Rec Loss: 10.826604
KL Loss: 1.620869
Y Loss: 0.886978
T Loss: 10.383115
Epoch 2599 
Overall Loss: 12.438020
Rec Loss: 10.826338
KL Loss: 1.611681
Y Loss: 0.894058
T Loss: 10.379309
Epoch 2649 
Overall Loss: 12.444034
Rec Loss: 10.792334
KL Loss: 1.651701
Y Loss: 0.879864
T Loss: 10.352402
Epoch 2699 
Overall Loss: 12.444192
Rec Loss: 10.835514
KL Loss: 1.608679
Y Loss: 0.897729
T Loss: 10.386649
Epoch 2749 
Overall Loss: 12.434320
Rec Loss: 10.825053
KL Loss: 1.609267
Y Loss: 0.888836
T Loss: 10.380635
Epoch 2799 
Overall Loss: 12.426419
Rec Loss: 10.812296
KL Loss: 1.614122
Y Loss: 0.868609
T Loss: 10.377992
Epoch 2849 
Overall Loss: 12.438683
Rec Loss: 10.823433
KL Loss: 1.615250
Y Loss: 0.864356
T Loss: 10.391255
Epoch 2899 
Overall Loss: 12.430984
Rec Loss: 10.823442
KL Loss: 1.607543
Y Loss: 0.879986
T Loss: 10.383449
Epoch 2949 
Overall Loss: 12.436642
Rec Loss: 10.808845
KL Loss: 1.627796
Y Loss: 0.867275
T Loss: 10.375208
Epoch 2999 
Overall Loss: 12.413776
Rec Loss: 10.792823
KL Loss: 1.620953
Y Loss: 0.866642
T Loss: 10.359502
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.525192
Epoch 99
Rec Loss: 1.522767
Epoch 149
Rec Loss: 1.517352
Epoch 199
Rec Loss: 1.520017
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.870451
Epoch 99
Rec Loss: 9.862931
Epoch 149
Rec Loss: 9.867283
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.734779
Insample Error: 1.522695
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 19.148304
Rec Loss: 16.678460
KL Loss: 2.469843
Y Loss: 4.675419
T Loss: 13.270495
X Loss: 1.070256
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.606754
Epoch 99
Rec Loss: 3.610584
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.717987
Epoch 99
Rec Loss: 2.711996
Epoch 149
Rec Loss: 2.717209
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 1.607400
Insample Error 2.495800
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.961993
Epoch 99 
Prediction Loss: 1.852691
Epoch 149 
Prediction Loss: 1.746314
Epoch 199 
Prediction Loss: 1.720938
Epoch 249 
Prediction Loss: 1.671982
Epoch 299 
Prediction Loss: 1.601803
Epoch 349 
Prediction Loss: 1.497348
Epoch 399 
Prediction Loss: 1.446050
Epoch 449 
Prediction Loss: 1.380388
Epoch 499 
Prediction Loss: 1.326346
Epoch 549 
Prediction Loss: 1.258595
Epoch 599 
Prediction Loss: 1.206896
Epoch 649 
Prediction Loss: 1.197398
Epoch 699 
Prediction Loss: 1.138626
Epoch 749 
Prediction Loss: 1.096827
Epoch 799 
Prediction Loss: 1.051813
Epoch 849 
Prediction Loss: 1.013540
Epoch 899 
Prediction Loss: 0.991808
Epoch 949 
Prediction Loss: 0.973206
Epoch 999 
Prediction Loss: 0.917115
Epoch 1049 
Prediction Loss: 0.942965
Epoch 1099 
Prediction Loss: 0.858700
Epoch 1149 
Prediction Loss: 0.847383
Epoch 1199 
Prediction Loss: 0.838313
Epoch 1249 
Prediction Loss: 0.817062
Epoch 1299 
Prediction Loss: 0.797842
Epoch 1349 
Prediction Loss: 0.768801
Epoch 1399 
Prediction Loss: 0.812843
Epoch 1449 
Prediction Loss: 0.781732
Epoch 1499 
Prediction Loss: 0.755827
Epoch 1549 
Prediction Loss: 0.780020
Epoch 1599 
Prediction Loss: 0.719729
Epoch 1649 
Prediction Loss: 0.727735
Epoch 1699 
Prediction Loss: 0.722545
Epoch 1749 
Prediction Loss: 0.721518
Epoch 1799 
Prediction Loss: 0.710731
Epoch 1849 
Prediction Loss: 0.687362
Epoch 1899 
Prediction Loss: 0.690902
Epoch 1949 
Prediction Loss: 0.686466
Epoch 1999 
Prediction Loss: 0.684693
Epoch 2049 
Prediction Loss: 0.681586
Epoch 2099 
Prediction Loss: 0.713731
Epoch 2149 
Prediction Loss: 0.656694
Epoch 2199 
Prediction Loss: 0.655371
Epoch 2249 
Prediction Loss: 0.659635
Epoch 2299 
Prediction Loss: 0.658716
Epoch 2349 
Prediction Loss: 0.677923
Epoch 2399 
Prediction Loss: 0.651260
Epoch 2449 
Prediction Loss: 0.652914
Epoch 2499 
Prediction Loss: 0.637130
Epoch 2549 
Prediction Loss: 0.634556
Epoch 2599 
Prediction Loss: 0.624154
Epoch 2649 
Prediction Loss: 0.652470
Epoch 2699 
Prediction Loss: 0.607885
Epoch 2749 
Prediction Loss: 0.622244
Epoch 2799 
Prediction Loss: 0.619748
Epoch 2849 
Prediction Loss: 0.603814
Epoch 2899 
Prediction Loss: 0.609993
Epoch 2949 
Prediction Loss: 0.623572
Epoch 2999 
Prediction Loss: 0.621368
Epoch 3049 
Prediction Loss: 0.622127
Epoch 3099 
Prediction Loss: 0.602469
Epoch 3149 
Prediction Loss: 0.644718
Epoch 3199 
Prediction Loss: 0.603417
Epoch 3249 
Prediction Loss: 0.615128
Epoch 3299 
Prediction Loss: 0.586295
Epoch 3349 
Prediction Loss: 0.588886
Epoch 3399 
Prediction Loss: 0.578178
Epoch 3449 
Prediction Loss: 0.592661
Epoch 3499 
Prediction Loss: 0.590463
Epoch 3549 
Prediction Loss: 0.573088
Epoch 3599 
Prediction Loss: 0.583532
Epoch 3649 
Prediction Loss: 0.585597
Epoch 3699 
Prediction Loss: 0.580487
Epoch 3749 
Prediction Loss: 0.560146
Epoch 3799 
Prediction Loss: 0.589494
Epoch 3849 
Prediction Loss: 0.562135
Epoch 3899 
Prediction Loss: 0.587659
Epoch 3949 
Prediction Loss: 0.559532
Epoch 3999 
Prediction Loss: 0.558112
Epoch 4049 
Prediction Loss: 0.569085
Epoch 4099 
Prediction Loss: 0.553921
Epoch 4149 
Prediction Loss: 0.566220
Epoch 4199 
Prediction Loss: 0.556115
Epoch 4249 
Prediction Loss: 0.561993
Epoch 4299 
Prediction Loss: 0.550262
Epoch 4349 
Prediction Loss: 0.568929
Epoch 4399 
Prediction Loss: 0.547285
Epoch 4449 
Prediction Loss: 0.553067
Epoch 4499 
Prediction Loss: 0.532472
Epoch 4549 
Prediction Loss: 0.533147
Epoch 4599 
Prediction Loss: 0.538795
Epoch 4649 
Prediction Loss: 0.527686
Epoch 4699 
Prediction Loss: 0.533692
Epoch 4749 
Prediction Loss: 0.527766
Epoch 4799 
Prediction Loss: 0.546357
Epoch 4849 
Prediction Loss: 0.533011
Epoch 4899 
Prediction Loss: 0.527092
Epoch 4949 
Prediction Loss: 0.523678
Epoch 4999 
Prediction Loss: 0.519708
Epoch 5049 
Prediction Loss: 0.518800
Epoch 5099 
Prediction Loss: 0.522359
Epoch 5149 
Prediction Loss: 0.520880
Epoch 5199 
Prediction Loss: 0.538774
Epoch 5249 
Prediction Loss: 0.517439
Epoch 5299 
Prediction Loss: 0.525125
Epoch 5349 
Prediction Loss: 0.540377
Epoch 5399 
Prediction Loss: 0.510508
Epoch 5449 
Prediction Loss: 0.513487
Epoch 5499 
Prediction Loss: 0.529246
Epoch 5549 
Prediction Loss: 0.529587
Epoch 5599 
Prediction Loss: 0.515002
Epoch 5649 
Prediction Loss: 0.510879
Epoch 5699 
Prediction Loss: 0.508098
Epoch 5749 
Prediction Loss: 0.528718
Epoch 5799 
Prediction Loss: 0.502782
Epoch 5849 
Prediction Loss: 0.516657
Epoch 5899 
Prediction Loss: 0.500745
Epoch 5949 
Prediction Loss: 0.502786
Epoch 5999 
Prediction Loss: 0.514316
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.714825
Insample Error 3.076642
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.864049
Rec Loss: 11.418492
KL Loss: 1.445557
Y Loss: 1.012014
T Loss: 10.912485
Epoch 99 
Overall Loss: 12.753117
Rec Loss: 11.109087
KL Loss: 1.644029
Y Loss: 0.948653
T Loss: 10.634761
Epoch 149 
Overall Loss: 12.684298
Rec Loss: 11.041410
KL Loss: 1.642888
Y Loss: 0.955041
T Loss: 10.563890
Epoch 199 
Overall Loss: 12.669706
Rec Loss: 11.016667
KL Loss: 1.653039
Y Loss: 0.931001
T Loss: 10.551167
Epoch 249 
Overall Loss: 12.656671
Rec Loss: 11.006400
KL Loss: 1.650271
Y Loss: 0.940489
T Loss: 10.536155
Epoch 299 
Overall Loss: 12.648816
Rec Loss: 11.017862
KL Loss: 1.630953
Y Loss: 0.954427
T Loss: 10.540649
Epoch 349 
Overall Loss: 12.632182
Rec Loss: 10.970763
KL Loss: 1.661419
Y Loss: 0.936213
T Loss: 10.502656
Epoch 399 
Overall Loss: 12.617173
Rec Loss: 10.959473
KL Loss: 1.657700
Y Loss: 0.928551
T Loss: 10.495198
Epoch 449 
Overall Loss: 12.632190
Rec Loss: 10.978672
KL Loss: 1.653518
Y Loss: 0.933490
T Loss: 10.511927
Epoch 499 
Overall Loss: 12.603064
Rec Loss: 10.972292
KL Loss: 1.630772
Y Loss: 0.927712
T Loss: 10.508436
Epoch 549 
Overall Loss: 12.601954
Rec Loss: 10.990404
KL Loss: 1.611551
Y Loss: 0.936555
T Loss: 10.522126
Epoch 599 
Overall Loss: 12.589835
Rec Loss: 10.956615
KL Loss: 1.633220
Y Loss: 0.930646
T Loss: 10.491292
Epoch 649 
Overall Loss: 12.591423
Rec Loss: 10.948636
KL Loss: 1.642787
Y Loss: 0.937411
T Loss: 10.479931
Epoch 699 
Overall Loss: 12.591616
Rec Loss: 10.951637
KL Loss: 1.639979
Y Loss: 0.926019
T Loss: 10.488628
Epoch 749 
Overall Loss: 12.580577
Rec Loss: 10.968216
KL Loss: 1.612362
Y Loss: 0.920588
T Loss: 10.507922
Epoch 799 
Overall Loss: 12.551098
Rec Loss: 10.941230
KL Loss: 1.609868
Y Loss: 0.945331
T Loss: 10.468565
Epoch 849 
Overall Loss: 12.583486
Rec Loss: 10.938212
KL Loss: 1.645275
Y Loss: 0.953517
T Loss: 10.461453
Epoch 899 
Overall Loss: 12.571062
Rec Loss: 10.954516
KL Loss: 1.616546
Y Loss: 0.915884
T Loss: 10.496574
Epoch 949 
Overall Loss: 12.556204
Rec Loss: 10.925854
KL Loss: 1.630350
Y Loss: 0.921257
T Loss: 10.465225
Epoch 999 
Overall Loss: 12.564657
Rec Loss: 10.931520
KL Loss: 1.633137
Y Loss: 0.910138
T Loss: 10.476451
Epoch 1049 
Overall Loss: 12.570319
Rec Loss: 10.921298
KL Loss: 1.649021
Y Loss: 0.915475
T Loss: 10.463560
Epoch 1099 
Overall Loss: 12.549621
Rec Loss: 10.921237
KL Loss: 1.628384
Y Loss: 0.902996
T Loss: 10.469739
Epoch 1149 
Overall Loss: 12.550579
Rec Loss: 10.929010
KL Loss: 1.621568
Y Loss: 0.934953
T Loss: 10.461534
Epoch 1199 
Overall Loss: 12.536594
Rec Loss: 10.896890
KL Loss: 1.639704
Y Loss: 0.896472
T Loss: 10.448654
Epoch 1249 
Overall Loss: 12.534565
Rec Loss: 10.918906
KL Loss: 1.615659
Y Loss: 0.923162
T Loss: 10.457326
Epoch 1299 
Overall Loss: 12.540376
Rec Loss: 10.915065
KL Loss: 1.625311
Y Loss: 0.892418
T Loss: 10.468856
Epoch 1349 
Overall Loss: 12.518198
Rec Loss: 10.910270
KL Loss: 1.607929
Y Loss: 0.917521
T Loss: 10.451509
Epoch 1399 
Overall Loss: 12.524866
Rec Loss: 10.891037
KL Loss: 1.633829
Y Loss: 0.910529
T Loss: 10.435773
Epoch 1449 
Overall Loss: 12.533821
Rec Loss: 10.905221
KL Loss: 1.628600
Y Loss: 0.901946
T Loss: 10.454248
Epoch 1499 
Overall Loss: 12.537583
Rec Loss: 10.888318
KL Loss: 1.649266
Y Loss: 0.896300
T Loss: 10.440168
Epoch 1549 
Overall Loss: 12.526783
Rec Loss: 10.887668
KL Loss: 1.639115
Y Loss: 0.910147
T Loss: 10.432595
Epoch 1599 
Overall Loss: 12.523651
Rec Loss: 10.893377
KL Loss: 1.630275
Y Loss: 0.885951
T Loss: 10.450401
Epoch 1649 
Overall Loss: 12.511101
Rec Loss: 10.883904
KL Loss: 1.627197
Y Loss: 0.917096
T Loss: 10.425356
Epoch 1699 
Overall Loss: 12.518755
Rec Loss: 10.897821
KL Loss: 1.620934
Y Loss: 0.898764
T Loss: 10.448439
Epoch 1749 
Overall Loss: 12.475472
Rec Loss: 10.855271
KL Loss: 1.620201
Y Loss: 0.873543
T Loss: 10.418499
Epoch 1799 
Overall Loss: 12.510514
Rec Loss: 10.868399
KL Loss: 1.642116
Y Loss: 0.915491
T Loss: 10.410653
Epoch 1849 
Overall Loss: 12.478371
Rec Loss: 10.868358
KL Loss: 1.610013
Y Loss: 0.906250
T Loss: 10.415233
Epoch 1899 
Overall Loss: 12.489539
Rec Loss: 10.852943
KL Loss: 1.636596
Y Loss: 0.894845
T Loss: 10.405521
Epoch 1949 
Overall Loss: 12.464654
Rec Loss: 10.836374
KL Loss: 1.628280
Y Loss: 0.880182
T Loss: 10.396283
Epoch 1999 
Overall Loss: 12.489233
Rec Loss: 10.857136
KL Loss: 1.632097
Y Loss: 0.891584
T Loss: 10.411344
Epoch 2049 
Overall Loss: 12.477267
Rec Loss: 10.822968
KL Loss: 1.654299
Y Loss: 0.893070
T Loss: 10.376433
Epoch 2099 
Overall Loss: 12.452233
Rec Loss: 10.818478
KL Loss: 1.633755
Y Loss: 0.888118
T Loss: 10.374419
Epoch 2149 
Overall Loss: 12.454086
Rec Loss: 10.849056
KL Loss: 1.605030
Y Loss: 0.892222
T Loss: 10.402945
Epoch 2199 
Overall Loss: 12.459411
Rec Loss: 10.830866
KL Loss: 1.628545
Y Loss: 0.885372
T Loss: 10.388181
Epoch 2249 
Overall Loss: 12.456562
Rec Loss: 10.819182
KL Loss: 1.637380
Y Loss: 0.869147
T Loss: 10.384609
Epoch 2299 
Overall Loss: 12.447498
Rec Loss: 10.813545
KL Loss: 1.633953
Y Loss: 0.886514
T Loss: 10.370288
Epoch 2349 
Overall Loss: 12.449898
Rec Loss: 10.816061
KL Loss: 1.633837
Y Loss: 0.896507
T Loss: 10.367808
Epoch 2399 
Overall Loss: 12.456999
Rec Loss: 10.820867
KL Loss: 1.636132
Y Loss: 0.877126
T Loss: 10.382304
Epoch 2449 
Overall Loss: 12.440093
Rec Loss: 10.840187
KL Loss: 1.599907
Y Loss: 0.887318
T Loss: 10.396528
Epoch 2499 
Overall Loss: 12.435498
Rec Loss: 10.822640
KL Loss: 1.612858
Y Loss: 0.888955
T Loss: 10.378163
Epoch 2549 
Overall Loss: 12.453694
Rec Loss: 10.803140
KL Loss: 1.650555
Y Loss: 0.886433
T Loss: 10.359923
Epoch 2599 
Overall Loss: 12.445767
Rec Loss: 10.806901
KL Loss: 1.638866
Y Loss: 0.875792
T Loss: 10.369005
Epoch 2649 
Overall Loss: 12.411796
Rec Loss: 10.807063
KL Loss: 1.604733
Y Loss: 0.878555
T Loss: 10.367785
Epoch 2699 
Overall Loss: 12.442643
Rec Loss: 10.807539
KL Loss: 1.635103
Y Loss: 0.870763
T Loss: 10.372158
Epoch 2749 
Overall Loss: 12.439654
Rec Loss: 10.807955
KL Loss: 1.631699
Y Loss: 0.870323
T Loss: 10.372793
Epoch 2799 
Overall Loss: 12.428882
Rec Loss: 10.805647
KL Loss: 1.623234
Y Loss: 0.877807
T Loss: 10.366744
Epoch 2849 
Overall Loss: 12.427893
Rec Loss: 10.805360
KL Loss: 1.622533
Y Loss: 0.866840
T Loss: 10.371940
Epoch 2899 
Overall Loss: 12.422266
Rec Loss: 10.800390
KL Loss: 1.621876
Y Loss: 0.878194
T Loss: 10.361292
Epoch 2949 
Overall Loss: 12.431348
Rec Loss: 10.817199
KL Loss: 1.614149
Y Loss: 0.869121
T Loss: 10.382639
Epoch 2999 
Overall Loss: 12.416441
Rec Loss: 10.807092
KL Loss: 1.609349
Y Loss: 0.883143
T Loss: 10.365521
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.535723
Epoch 99
Rec Loss: 1.518878
Epoch 149
Rec Loss: 1.515265
Epoch 199
Rec Loss: 1.515148
Epoch 249
Rec Loss: 1.504117
Epoch 299
Rec Loss: 1.515561
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.879789
Epoch 99
Rec Loss: 9.880233
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.739113
Insample Error: 1.545314
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 19.116453
Rec Loss: 16.698895
KL Loss: 2.417559
Y Loss: 4.524335
T Loss: 13.272924
X Loss: 1.163804
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.583862
Epoch 99
Rec Loss: 3.588406
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.752669
Epoch 99
Rec Loss: 2.727856
Epoch 149
Rec Loss: 2.735882
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 1.609254
Insample Error 2.553194
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.936269
Epoch 99 
Prediction Loss: 1.803263
Epoch 149 
Prediction Loss: 1.742214
Epoch 199 
Prediction Loss: 1.651730
Epoch 249 
Prediction Loss: 1.596282
Epoch 299 
Prediction Loss: 1.517692
Epoch 349 
Prediction Loss: 1.422604
Epoch 399 
Prediction Loss: 1.345791
Epoch 449 
Prediction Loss: 1.284276
Epoch 499 
Prediction Loss: 1.230267
Epoch 549 
Prediction Loss: 1.162788
Epoch 599 
Prediction Loss: 1.112893
Epoch 649 
Prediction Loss: 1.047856
Epoch 699 
Prediction Loss: 1.007654
Epoch 749 
Prediction Loss: 0.989534
Epoch 799 
Prediction Loss: 0.949372
Epoch 849 
Prediction Loss: 0.916828
Epoch 899 
Prediction Loss: 0.916607
Epoch 949 
Prediction Loss: 0.897741
Epoch 999 
Prediction Loss: 0.848627
Epoch 1049 
Prediction Loss: 0.825400
Epoch 1099 
Prediction Loss: 0.816179
Epoch 1149 
Prediction Loss: 0.805689
Epoch 1199 
Prediction Loss: 0.771752
Epoch 1249 
Prediction Loss: 0.773766
Epoch 1299 
Prediction Loss: 0.768816
Epoch 1349 
Prediction Loss: 0.756810
Epoch 1399 
Prediction Loss: 0.746525
Epoch 1449 
Prediction Loss: 0.739090
Epoch 1499 
Prediction Loss: 0.724291
Epoch 1549 
Prediction Loss: 0.698854
Epoch 1599 
Prediction Loss: 0.693711
Epoch 1649 
Prediction Loss: 0.688922
Epoch 1699 
Prediction Loss: 0.688658
Epoch 1749 
Prediction Loss: 0.660925
Epoch 1799 
Prediction Loss: 0.652774
Epoch 1849 
Prediction Loss: 0.649256
Epoch 1899 
Prediction Loss: 0.632823
Epoch 1949 
Prediction Loss: 0.686555
Epoch 1999 
Prediction Loss: 0.632540
Epoch 2049 
Prediction Loss: 0.629893
Epoch 2099 
Prediction Loss: 0.621573
Epoch 2149 
Prediction Loss: 0.609862
Epoch 2199 
Prediction Loss: 0.607646
Epoch 2249 
Prediction Loss: 0.610732
Epoch 2299 
Prediction Loss: 0.597295
Epoch 2349 
Prediction Loss: 0.613901
Epoch 2399 
Prediction Loss: 0.608822
Epoch 2449 
Prediction Loss: 0.579465
Epoch 2499 
Prediction Loss: 0.569915
Epoch 2549 
Prediction Loss: 0.566681
Epoch 2599 
Prediction Loss: 0.564613
Epoch 2649 
Prediction Loss: 0.571635
Epoch 2699 
Prediction Loss: 0.560513
Epoch 2749 
Prediction Loss: 0.559091
Epoch 2799 
Prediction Loss: 0.556401
Epoch 2849 
Prediction Loss: 0.547993
Epoch 2899 
Prediction Loss: 0.551683
Epoch 2949 
Prediction Loss: 0.550215
Epoch 2999 
Prediction Loss: 0.553488
Epoch 3049 
Prediction Loss: 0.548150
Epoch 3099 
Prediction Loss: 0.537801
Epoch 3149 
Prediction Loss: 0.550699
Epoch 3199 
Prediction Loss: 0.540322
Epoch 3249 
Prediction Loss: 0.538217
Epoch 3299 
Prediction Loss: 0.534825
Epoch 3349 
Prediction Loss: 0.533451
Epoch 3399 
Prediction Loss: 0.524350
Epoch 3449 
Prediction Loss: 0.527842
Epoch 3499 
Prediction Loss: 0.526942
Epoch 3549 
Prediction Loss: 0.548830
Epoch 3599 
Prediction Loss: 0.524079
Epoch 3649 
Prediction Loss: 0.539376
Epoch 3699 
Prediction Loss: 0.517879
Epoch 3749 
Prediction Loss: 0.524897
Epoch 3799 
Prediction Loss: 0.516734
Epoch 3849 
Prediction Loss: 0.509538
Epoch 3899 
Prediction Loss: 0.496814
Epoch 3949 
Prediction Loss: 0.511255
Epoch 3999 
Prediction Loss: 0.514929
Epoch 4049 
Prediction Loss: 0.523032
Epoch 4099 
Prediction Loss: 0.507682
Epoch 4149 
Prediction Loss: 0.528713
Epoch 4199 
Prediction Loss: 0.517840
Epoch 4249 
Prediction Loss: 0.503993
Epoch 4299 
Prediction Loss: 0.498161
Epoch 4349 
Prediction Loss: 0.516810
Epoch 4399 
Prediction Loss: 0.518110
Epoch 4449 
Prediction Loss: 0.504442
Epoch 4499 
Prediction Loss: 0.502844
Epoch 4549 
Prediction Loss: 0.495018
Epoch 4599 
Prediction Loss: 0.485249
Epoch 4649 
Prediction Loss: 0.500995
Epoch 4699 
Prediction Loss: 0.493906
Epoch 4749 
Prediction Loss: 0.483417
Epoch 4799 
Prediction Loss: 0.505866
Epoch 4849 
Prediction Loss: 0.484063
Epoch 4899 
Prediction Loss: 0.503063
Epoch 4949 
Prediction Loss: 0.488731
Epoch 4999 
Prediction Loss: 0.484068
Epoch 5049 
Prediction Loss: 0.484424
Epoch 5099 
Prediction Loss: 0.500120
Epoch 5149 
Prediction Loss: 0.486413
Epoch 5199 
Prediction Loss: 0.479433
Epoch 5249 
Prediction Loss: 0.514657
Epoch 5299 
Prediction Loss: 0.490108
Epoch 5349 
Prediction Loss: 0.491447
Epoch 5399 
Prediction Loss: 0.470807
Epoch 5449 
Prediction Loss: 0.473602
Epoch 5499 
Prediction Loss: 0.474466
Epoch 5549 
Prediction Loss: 0.480101
Epoch 5599 
Prediction Loss: 0.491479
Epoch 5649 
Prediction Loss: 0.489264
Epoch 5699 
Prediction Loss: 0.475383
Epoch 5749 
Prediction Loss: 0.461114
Epoch 5799 
Prediction Loss: 0.466755
Epoch 5849 
Prediction Loss: 0.474624
Epoch 5899 
Prediction Loss: 0.477535
Epoch 5949 
Prediction Loss: 0.488264
Epoch 5999 
Prediction Loss: 0.465089
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.699430
Insample Error 3.069827
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.879179
Rec Loss: 11.424681
KL Loss: 1.454498
Y Loss: 0.995430
T Loss: 10.926966
Epoch 99 
Overall Loss: 12.698549
Rec Loss: 11.027172
KL Loss: 1.671376
Y Loss: 0.949009
T Loss: 10.552668
Epoch 149 
Overall Loss: 12.694212
Rec Loss: 11.058511
KL Loss: 1.635702
Y Loss: 0.963157
T Loss: 10.576932
Epoch 199 
Overall Loss: 12.661396
Rec Loss: 10.988771
KL Loss: 1.672625
Y Loss: 0.940685
T Loss: 10.518429
Epoch 249 
Overall Loss: 12.651467
Rec Loss: 11.002319
KL Loss: 1.649148
Y Loss: 0.964200
T Loss: 10.520219
Epoch 299 
Overall Loss: 12.646698
Rec Loss: 11.010058
KL Loss: 1.636640
Y Loss: 0.953405
T Loss: 10.533356
Epoch 349 
Overall Loss: 12.637351
Rec Loss: 10.990492
KL Loss: 1.646859
Y Loss: 0.943968
T Loss: 10.518508
Epoch 399 
Overall Loss: 12.631932
Rec Loss: 11.010152
KL Loss: 1.621780
Y Loss: 0.961609
T Loss: 10.529347
Epoch 449 
Overall Loss: 12.609808
Rec Loss: 10.968931
KL Loss: 1.640877
Y Loss: 0.943612
T Loss: 10.497125
Epoch 499 
Overall Loss: 12.606670
Rec Loss: 10.963062
KL Loss: 1.643608
Y Loss: 0.936771
T Loss: 10.494676
Epoch 549 
Overall Loss: 12.626513
Rec Loss: 10.979194
KL Loss: 1.647319
Y Loss: 0.931031
T Loss: 10.513678
Epoch 599 
Overall Loss: 12.613999
Rec Loss: 10.963329
KL Loss: 1.650671
Y Loss: 0.938205
T Loss: 10.494226
Epoch 649 
Overall Loss: 12.595115
Rec Loss: 10.954485
KL Loss: 1.640630
Y Loss: 0.935342
T Loss: 10.486814
Epoch 699 
Overall Loss: 12.589230
Rec Loss: 10.956440
KL Loss: 1.632790
Y Loss: 0.957748
T Loss: 10.477566
Epoch 749 
Overall Loss: 12.584861
Rec Loss: 10.926979
KL Loss: 1.657883
Y Loss: 0.915209
T Loss: 10.469374
Epoch 799 
Overall Loss: 12.575390
Rec Loss: 10.937516
KL Loss: 1.637874
Y Loss: 0.911480
T Loss: 10.481776
Epoch 849 
Overall Loss: 12.555124
Rec Loss: 10.953245
KL Loss: 1.601878
Y Loss: 0.939586
T Loss: 10.483452
Epoch 899 
Overall Loss: 12.565996
Rec Loss: 10.922745
KL Loss: 1.643251
Y Loss: 0.916907
T Loss: 10.464291
Epoch 949 
Overall Loss: 12.584903
Rec Loss: 10.936005
KL Loss: 1.648898
Y Loss: 0.923678
T Loss: 10.474165
Epoch 999 
Overall Loss: 12.568281
Rec Loss: 10.908731
KL Loss: 1.659550
Y Loss: 0.904071
T Loss: 10.456695
Epoch 1049 
Overall Loss: 12.543590
Rec Loss: 10.919761
KL Loss: 1.623829
Y Loss: 0.929483
T Loss: 10.455020
Epoch 1099 
Overall Loss: 12.551336
Rec Loss: 10.910109
KL Loss: 1.641228
Y Loss: 0.925001
T Loss: 10.447608
Epoch 1149 
Overall Loss: 12.546498
Rec Loss: 10.903305
KL Loss: 1.643193
Y Loss: 0.911274
T Loss: 10.447668
Epoch 1199 
Overall Loss: 12.530216
Rec Loss: 10.905458
KL Loss: 1.624759
Y Loss: 0.912756
T Loss: 10.449080
Epoch 1249 
Overall Loss: 12.538606
Rec Loss: 10.909137
KL Loss: 1.629469
Y Loss: 0.919344
T Loss: 10.449465
Epoch 1299 
Overall Loss: 12.528999
Rec Loss: 10.906411
KL Loss: 1.622588
Y Loss: 0.919732
T Loss: 10.446545
Epoch 1349 
Overall Loss: 12.509909
Rec Loss: 10.888523
KL Loss: 1.621386
Y Loss: 0.908456
T Loss: 10.434295
Epoch 1399 
Overall Loss: 12.529648
Rec Loss: 10.884370
KL Loss: 1.645278
Y Loss: 0.923255
T Loss: 10.422742
Epoch 1449 
Overall Loss: 12.520553
Rec Loss: 10.864617
KL Loss: 1.655936
Y Loss: 0.921625
T Loss: 10.403804
Epoch 1499 
Overall Loss: 12.500799
Rec Loss: 10.863537
KL Loss: 1.637263
Y Loss: 0.906913
T Loss: 10.410081
Epoch 1549 
Overall Loss: 12.515684
Rec Loss: 10.857274
KL Loss: 1.658410
Y Loss: 0.893546
T Loss: 10.410502
Epoch 1599 
Overall Loss: 12.517331
Rec Loss: 10.900354
KL Loss: 1.616978
Y Loss: 0.916077
T Loss: 10.442315
Epoch 1649 
Overall Loss: 12.497444
Rec Loss: 10.866203
KL Loss: 1.631241
Y Loss: 0.914800
T Loss: 10.408803
Epoch 1699 
Overall Loss: 12.491592
Rec Loss: 10.855804
KL Loss: 1.635787
Y Loss: 0.917445
T Loss: 10.397082
Epoch 1749 
Overall Loss: 12.501200
Rec Loss: 10.854602
KL Loss: 1.646598
Y Loss: 0.881544
T Loss: 10.413830
Epoch 1799 
Overall Loss: 12.483112
Rec Loss: 10.845238
KL Loss: 1.637874
Y Loss: 0.900293
T Loss: 10.395091
Epoch 1849 
Overall Loss: 12.497947
Rec Loss: 10.885288
KL Loss: 1.612659
Y Loss: 0.908766
T Loss: 10.430905
Epoch 1899 
Overall Loss: 12.471125
Rec Loss: 10.841449
KL Loss: 1.629677
Y Loss: 0.871590
T Loss: 10.405653
Epoch 1949 
Overall Loss: 12.484054
Rec Loss: 10.824689
KL Loss: 1.659366
Y Loss: 0.863598
T Loss: 10.392890
Epoch 1999 
Overall Loss: 12.505079
Rec Loss: 10.850406
KL Loss: 1.654673
Y Loss: 0.856039
T Loss: 10.422387
Epoch 2049 
Overall Loss: 12.473164
Rec Loss: 10.842637
KL Loss: 1.630527
Y Loss: 0.881704
T Loss: 10.401784
Epoch 2099 
Overall Loss: 12.485630
Rec Loss: 10.860700
KL Loss: 1.624930
Y Loss: 0.902320
T Loss: 10.409540
Epoch 2149 
Overall Loss: 12.463875
Rec Loss: 10.830204
KL Loss: 1.633671
Y Loss: 0.886725
T Loss: 10.386842
Epoch 2199 
Overall Loss: 12.465088
Rec Loss: 10.823598
KL Loss: 1.641491
Y Loss: 0.880744
T Loss: 10.383226
Epoch 2249 
Overall Loss: 12.465953
Rec Loss: 10.817464
KL Loss: 1.648489
Y Loss: 0.881062
T Loss: 10.376933
Epoch 2299 
Overall Loss: 12.466620
Rec Loss: 10.835665
KL Loss: 1.630955
Y Loss: 0.888737
T Loss: 10.391297
Epoch 2349 
Overall Loss: 12.460634
Rec Loss: 10.802927
KL Loss: 1.657708
Y Loss: 0.884912
T Loss: 10.360471
Epoch 2399 
Overall Loss: 12.449470
Rec Loss: 10.803943
KL Loss: 1.645527
Y Loss: 0.885506
T Loss: 10.361190
Epoch 2449 
Overall Loss: 12.471588
Rec Loss: 10.815718
KL Loss: 1.655871
Y Loss: 0.902547
T Loss: 10.364444
Epoch 2499 
Overall Loss: 12.448366
Rec Loss: 10.810285
KL Loss: 1.638081
Y Loss: 0.874882
T Loss: 10.372844
Epoch 2549 
Overall Loss: 12.460211
Rec Loss: 10.814621
KL Loss: 1.645590
Y Loss: 0.886354
T Loss: 10.371444
Epoch 2599 
Overall Loss: 12.442157
Rec Loss: 10.797861
KL Loss: 1.644295
Y Loss: 0.870798
T Loss: 10.362463
Epoch 2649 
Overall Loss: 12.424681
Rec Loss: 10.802662
KL Loss: 1.622019
Y Loss: 0.877865
T Loss: 10.363729
Epoch 2699 
Overall Loss: 12.440850
Rec Loss: 10.807794
KL Loss: 1.633056
Y Loss: 0.867556
T Loss: 10.374016
Epoch 2749 
Overall Loss: 12.434190
Rec Loss: 10.800868
KL Loss: 1.633321
Y Loss: 0.884847
T Loss: 10.358444
Epoch 2799 
Overall Loss: 12.427995
Rec Loss: 10.802739
KL Loss: 1.625256
Y Loss: 0.877055
T Loss: 10.364211
Epoch 2849 
Overall Loss: 12.439397
Rec Loss: 10.822197
KL Loss: 1.617200
Y Loss: 0.888444
T Loss: 10.377975
Epoch 2899 
Overall Loss: 12.424124
Rec Loss: 10.805628
KL Loss: 1.618496
Y Loss: 0.870055
T Loss: 10.370601
Epoch 2949 
Overall Loss: 12.418811
Rec Loss: 10.780959
KL Loss: 1.637852
Y Loss: 0.873934
T Loss: 10.343992
Epoch 2999 
Overall Loss: 12.425276
Rec Loss: 10.786192
KL Loss: 1.639083
Y Loss: 0.864860
T Loss: 10.353763
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.505198
Epoch 99
Rec Loss: 1.494894
Epoch 149
Rec Loss: 1.481461
Epoch 199
Rec Loss: 1.489161
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.880949
Epoch 99
Rec Loss: 9.864355
Epoch 149
Rec Loss: 9.847306
Epoch 199
Rec Loss: 9.848953
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.713953
Insample Error: 1.486099
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 19.739181
Rec Loss: 17.751985
KL Loss: 1.987197
Y Loss: 5.794057
T Loss: 13.499155
X Loss: 1.355801
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.686480
Epoch 99
Rec Loss: 3.672284
Epoch 149
Rec Loss: 3.683628
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.726798
Epoch 99
Rec Loss: 2.702579
Epoch 149
Rec Loss: 2.702042
Epoch 199
Rec Loss: 2.708520
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 1.783031
Insample Error 2.778467
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.891462
Epoch 99 
Prediction Loss: 1.791369
Epoch 149 
Prediction Loss: 1.750391
Epoch 199 
Prediction Loss: 1.675249
Epoch 249 
Prediction Loss: 1.637857
Epoch 299 
Prediction Loss: 1.591592
Epoch 349 
Prediction Loss: 1.481426
Epoch 399 
Prediction Loss: 1.417087
Epoch 449 
Prediction Loss: 1.346925
Epoch 499 
Prediction Loss: 1.287765
Epoch 549 
Prediction Loss: 1.284056
Epoch 599 
Prediction Loss: 1.240287
Epoch 649 
Prediction Loss: 1.163560
Epoch 699 
Prediction Loss: 1.098268
Epoch 749 
Prediction Loss: 1.132168
Epoch 799 
Prediction Loss: 1.024191
Epoch 849 
Prediction Loss: 1.016579
Epoch 899 
Prediction Loss: 0.999149
Epoch 949 
Prediction Loss: 0.947494
Epoch 999 
Prediction Loss: 0.928284
Epoch 1049 
Prediction Loss: 0.913608
Epoch 1099 
Prediction Loss: 0.869367
Epoch 1149 
Prediction Loss: 0.888853
Epoch 1199 
Prediction Loss: 0.861924
Epoch 1249 
Prediction Loss: 0.860374
Epoch 1299 
Prediction Loss: 0.814728
Epoch 1349 
Prediction Loss: 0.811739
Epoch 1399 
Prediction Loss: 0.779704
Epoch 1449 
Prediction Loss: 0.787327
Epoch 1499 
Prediction Loss: 0.756923
Epoch 1549 
Prediction Loss: 0.753990
Epoch 1599 
Prediction Loss: 0.736949
Epoch 1649 
Prediction Loss: 0.740659
Epoch 1699 
Prediction Loss: 0.743898
Epoch 1749 
Prediction Loss: 0.712795
Epoch 1799 
Prediction Loss: 0.708618
Epoch 1849 
Prediction Loss: 0.745179
Epoch 1899 
Prediction Loss: 0.709306
Epoch 1949 
Prediction Loss: 0.687994
Epoch 1999 
Prediction Loss: 0.703382
Epoch 2049 
Prediction Loss: 0.687347
Epoch 2099 
Prediction Loss: 0.671648
Epoch 2149 
Prediction Loss: 0.667943
Epoch 2199 
Prediction Loss: 0.668097
Epoch 2249 
Prediction Loss: 0.672880
Epoch 2299 
Prediction Loss: 0.648600
Epoch 2349 
Prediction Loss: 0.649640
Epoch 2399 
Prediction Loss: 0.675578
Epoch 2449 
Prediction Loss: 0.642613
Epoch 2499 
Prediction Loss: 0.644856
Epoch 2549 
Prediction Loss: 0.632830
Epoch 2599 
Prediction Loss: 0.633742
Epoch 2649 
Prediction Loss: 0.627627
Epoch 2699 
Prediction Loss: 0.633611
Epoch 2749 
Prediction Loss: 0.626307
Epoch 2799 
Prediction Loss: 0.613201
Epoch 2849 
Prediction Loss: 0.618660
Epoch 2899 
Prediction Loss: 0.627971
Epoch 2949 
Prediction Loss: 0.623560
Epoch 2999 
Prediction Loss: 0.634136
Epoch 3049 
Prediction Loss: 0.606254
Epoch 3099 
Prediction Loss: 0.634134
Epoch 3149 
Prediction Loss: 0.596844
Epoch 3199 
Prediction Loss: 0.611477
Epoch 3249 
Prediction Loss: 0.601140
Epoch 3299 
Prediction Loss: 0.607147
Epoch 3349 
Prediction Loss: 0.600125
Epoch 3399 
Prediction Loss: 0.604792
Epoch 3449 
Prediction Loss: 0.618639
Epoch 3499 
Prediction Loss: 0.584633
Epoch 3549 
Prediction Loss: 0.591154
Epoch 3599 
Prediction Loss: 0.580874
Epoch 3649 
Prediction Loss: 0.589648
Epoch 3699 
Prediction Loss: 0.586069
Epoch 3749 
Prediction Loss: 0.587526
Epoch 3799 
Prediction Loss: 0.586569
Epoch 3849 
Prediction Loss: 0.584052
Epoch 3899 
Prediction Loss: 0.577328
Epoch 3949 
Prediction Loss: 0.569242
Epoch 3999 
Prediction Loss: 0.583407
Epoch 4049 
Prediction Loss: 0.602738
Epoch 4099 
Prediction Loss: 0.575164
Epoch 4149 
Prediction Loss: 0.577395
Epoch 4199 
Prediction Loss: 0.564637
Epoch 4249 
Prediction Loss: 0.576854
Epoch 4299 
Prediction Loss: 0.566012
Epoch 4349 
Prediction Loss: 0.577367
Epoch 4399 
Prediction Loss: 0.570015
Epoch 4449 
Prediction Loss: 0.592148
Epoch 4499 
Prediction Loss: 0.574296
Epoch 4549 
Prediction Loss: 0.563423
Epoch 4599 
Prediction Loss: 0.589486
Epoch 4649 
Prediction Loss: 0.563285
Epoch 4699 
Prediction Loss: 0.557641
Epoch 4749 
Prediction Loss: 0.554571
Epoch 4799 
Prediction Loss: 0.570175
Epoch 4849 
Prediction Loss: 0.560085
Epoch 4899 
Prediction Loss: 0.548994
Epoch 4949 
Prediction Loss: 0.551291
Epoch 4999 
Prediction Loss: 0.549346
Epoch 5049 
Prediction Loss: 0.555561
Epoch 5099 
Prediction Loss: 0.541902
Epoch 5149 
Prediction Loss: 0.556649
Epoch 5199 
Prediction Loss: 0.552856
Epoch 5249 
Prediction Loss: 0.553631
Epoch 5299 
Prediction Loss: 0.549986
Epoch 5349 
Prediction Loss: 0.543408
Epoch 5399 
Prediction Loss: 0.551930
Epoch 5449 
Prediction Loss: 0.546706
Epoch 5499 
Prediction Loss: 0.541981
Epoch 5549 
Prediction Loss: 0.546650
Epoch 5599 
Prediction Loss: 0.545434
Epoch 5649 
Prediction Loss: 0.557968
Epoch 5699 
Prediction Loss: 0.534643
Epoch 5749 
Prediction Loss: 0.534693
Epoch 5799 
Prediction Loss: 0.536307
Epoch 5849 
Prediction Loss: 0.539024
Epoch 5899 
Prediction Loss: 0.546590
Epoch 5949 
Prediction Loss: 0.538073
Epoch 5999 
Prediction Loss: 0.528307
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.720482
Insample Error 3.009513
Ours, Train RMSE
0.7348, 
0.7391, 
0.7140, 
CEVAE, Train RMSE
1.6074, 
1.6093, 
1.7830, 
Ours, Insample RMSE
1.5227, 
1.5453, 
1.4861, 
CEVAE, Insample RMSE
2.4958, 
2.5532, 
2.7785, 
Direct Regression, Insample RMSE
3.0766, 
3.0698, 
3.0095, 
Train, RMSE mean 0.7293 std 0.0110
CEVAE, RMSE mean 1.6666 std 0.0824
Ours, RMSE mean 1.5180 std 0.0244, reconstruct confounder 1.5010 (0.0148) noise 9.8633 (0.0133)
CEVAE, RMSE mean 2.6092 std 0.1220, reconstruct confounder 3.6210 (0.0375) noise 2.7140 (0.0106)
Direct Regression, RMSE mean 3.0520 std 0.0302
Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=5, mask=0, nlayer=50, obsm=2, stop=5000, ycof=0.5, ylayer=50)
Y Mean 2.635484, Std 4.326354 
Test Y Mean 0.032706, Std 4.125860 
Observe confounder 2, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.039594
Rec Loss: 11.274521
KL Loss: 1.765073
Y Loss: 0.972708
T Loss: 10.788166
Epoch 99 
Overall Loss: 12.861499
Rec Loss: 11.099393
KL Loss: 1.762106
Y Loss: 0.942427
T Loss: 10.628179
Epoch 149 
Overall Loss: 12.773616
Rec Loss: 10.912725
KL Loss: 1.860891
Y Loss: 0.921917
T Loss: 10.451766
Epoch 199 
Overall Loss: 12.756311
Rec Loss: 10.912388
KL Loss: 1.843922
Y Loss: 0.921232
T Loss: 10.451772
Epoch 249 
Overall Loss: 12.716229
Rec Loss: 10.889766
KL Loss: 1.826464
Y Loss: 0.932631
T Loss: 10.423450
Epoch 299 
Overall Loss: 12.716995
Rec Loss: 10.920358
KL Loss: 1.796637
Y Loss: 0.947045
T Loss: 10.446836
Epoch 349 
Overall Loss: 12.703702
Rec Loss: 10.886242
KL Loss: 1.817460
Y Loss: 0.920984
T Loss: 10.425750
Epoch 399 
Overall Loss: 12.675454
Rec Loss: 10.889814
KL Loss: 1.785639
Y Loss: 0.920114
T Loss: 10.429758
Epoch 449 
Overall Loss: 12.661285
Rec Loss: 10.873535
KL Loss: 1.787751
Y Loss: 0.917363
T Loss: 10.414853
Epoch 499 
Overall Loss: 12.679111
Rec Loss: 10.868256
KL Loss: 1.810855
Y Loss: 0.911144
T Loss: 10.412685
Epoch 549 
Overall Loss: 12.639744
Rec Loss: 10.863785
KL Loss: 1.775958
Y Loss: 0.914403
T Loss: 10.406584
Epoch 599 
Overall Loss: 12.625555
Rec Loss: 10.863880
KL Loss: 1.761675
Y Loss: 0.880208
T Loss: 10.423776
Epoch 649 
Overall Loss: 12.635926
Rec Loss: 10.867638
KL Loss: 1.768288
Y Loss: 0.897533
T Loss: 10.418872
Epoch 699 
Overall Loss: 12.642709
Rec Loss: 10.855678
KL Loss: 1.787032
Y Loss: 0.907797
T Loss: 10.401779
Epoch 749 
Overall Loss: 12.619769
Rec Loss: 10.849187
KL Loss: 1.770582
Y Loss: 0.900361
T Loss: 10.399006
Epoch 799 
Overall Loss: 12.613635
Rec Loss: 10.866308
KL Loss: 1.747327
Y Loss: 0.901271
T Loss: 10.415672
Epoch 849 
Overall Loss: 12.624536
Rec Loss: 10.867594
KL Loss: 1.756941
Y Loss: 0.883651
T Loss: 10.425769
Epoch 899 
Overall Loss: 12.616386
Rec Loss: 10.849987
KL Loss: 1.766399
Y Loss: 0.906110
T Loss: 10.396932
Epoch 949 
Overall Loss: 12.595016
Rec Loss: 10.827874
KL Loss: 1.767143
Y Loss: 0.872968
T Loss: 10.391390
Epoch 999 
Overall Loss: 12.612716
Rec Loss: 10.862302
KL Loss: 1.750414
Y Loss: 0.880673
T Loss: 10.421966
Epoch 1049 
Overall Loss: 12.588611
Rec Loss: 10.811526
KL Loss: 1.777085
Y Loss: 0.884527
T Loss: 10.369263
Epoch 1099 
Overall Loss: 12.583597
Rec Loss: 10.827275
KL Loss: 1.756322
Y Loss: 0.862427
T Loss: 10.396061
Epoch 1149 
Overall Loss: 12.609557
Rec Loss: 10.821256
KL Loss: 1.788302
Y Loss: 0.862410
T Loss: 10.390051
Epoch 1199 
Overall Loss: 12.577734
Rec Loss: 10.843213
KL Loss: 1.734522
Y Loss: 0.872797
T Loss: 10.406814
Epoch 1249 
Overall Loss: 12.582123
Rec Loss: 10.819419
KL Loss: 1.762705
Y Loss: 0.866199
T Loss: 10.386319
Epoch 1299 
Overall Loss: 12.575835
Rec Loss: 10.848952
KL Loss: 1.726882
Y Loss: 0.883318
T Loss: 10.407293
Epoch 1349 
Overall Loss: 12.572850
Rec Loss: 10.812382
KL Loss: 1.760468
Y Loss: 0.855804
T Loss: 10.384480
Epoch 1399 
Overall Loss: 12.554999
Rec Loss: 10.813063
KL Loss: 1.741936
Y Loss: 0.846227
T Loss: 10.389950
Epoch 1449 
Overall Loss: 12.562816
Rec Loss: 10.823472
KL Loss: 1.739344
Y Loss: 0.868894
T Loss: 10.389025
Epoch 1499 
Overall Loss: 12.582257
Rec Loss: 10.821610
KL Loss: 1.760646
Y Loss: 0.877702
T Loss: 10.382760
Epoch 1549 
Overall Loss: 12.555972
Rec Loss: 10.803527
KL Loss: 1.752445
Y Loss: 0.859288
T Loss: 10.373883
Epoch 1599 
Overall Loss: 12.572149
Rec Loss: 10.810775
KL Loss: 1.761375
Y Loss: 0.851679
T Loss: 10.384935
Epoch 1649 
Overall Loss: 12.552071
Rec Loss: 10.801288
KL Loss: 1.750784
Y Loss: 0.842896
T Loss: 10.379840
Epoch 1699 
Overall Loss: 12.544072
Rec Loss: 10.784811
KL Loss: 1.759261
Y Loss: 0.858273
T Loss: 10.355675
Epoch 1749 
Overall Loss: 12.557984
Rec Loss: 10.809936
KL Loss: 1.748047
Y Loss: 0.852925
T Loss: 10.383474
Epoch 1799 
Overall Loss: 12.525633
Rec Loss: 10.794862
KL Loss: 1.730771
Y Loss: 0.864713
T Loss: 10.362506
Epoch 1849 
Overall Loss: 12.532949
Rec Loss: 10.791627
KL Loss: 1.741322
Y Loss: 0.862157
T Loss: 10.360548
Epoch 1899 
Overall Loss: 12.546012
Rec Loss: 10.775782
KL Loss: 1.770230
Y Loss: 0.839933
T Loss: 10.355815
Epoch 1949 
Overall Loss: 12.519922
Rec Loss: 10.771795
KL Loss: 1.748127
Y Loss: 0.841678
T Loss: 10.350956
Epoch 1999 
Overall Loss: 12.526376
Rec Loss: 10.810453
KL Loss: 1.715923
Y Loss: 0.859972
T Loss: 10.380467
Epoch 2049 
Overall Loss: 12.520778
Rec Loss: 10.791995
KL Loss: 1.728784
Y Loss: 0.842232
T Loss: 10.370879
Epoch 2099 
Overall Loss: 12.524975
Rec Loss: 10.795718
KL Loss: 1.729257
Y Loss: 0.859294
T Loss: 10.366071
Epoch 2149 
Overall Loss: 12.522312
Rec Loss: 10.782091
KL Loss: 1.740222
Y Loss: 0.852000
T Loss: 10.356090
Epoch 2199 
Overall Loss: 12.515463
Rec Loss: 10.773133
KL Loss: 1.742330
Y Loss: 0.846383
T Loss: 10.349942
Epoch 2249 
Overall Loss: 12.520846
Rec Loss: 10.777807
KL Loss: 1.743040
Y Loss: 0.847146
T Loss: 10.354234
Epoch 2299 
Overall Loss: 12.501388
Rec Loss: 10.760022
KL Loss: 1.741366
Y Loss: 0.865760
T Loss: 10.327141
Epoch 2349 
Overall Loss: 12.503579
Rec Loss: 10.750345
KL Loss: 1.753234
Y Loss: 0.846362
T Loss: 10.327165
Epoch 2399 
Overall Loss: 12.477744
Rec Loss: 10.758687
KL Loss: 1.719057
Y Loss: 0.839075
T Loss: 10.339149
Epoch 2449 
Overall Loss: 12.490403
Rec Loss: 10.782798
KL Loss: 1.707605
Y Loss: 0.859435
T Loss: 10.353080
Epoch 2499 
Overall Loss: 12.473991
Rec Loss: 10.753813
KL Loss: 1.720178
Y Loss: 0.841296
T Loss: 10.333165
Epoch 2549 
Overall Loss: 12.522442
Rec Loss: 10.784924
KL Loss: 1.737519
Y Loss: 0.856934
T Loss: 10.356457
Epoch 2599 
Overall Loss: 12.479756
Rec Loss: 10.757005
KL Loss: 1.722750
Y Loss: 0.836091
T Loss: 10.338960
Epoch 2649 
Overall Loss: 12.467908
Rec Loss: 10.745335
KL Loss: 1.722574
Y Loss: 0.835593
T Loss: 10.327538
Epoch 2699 
Overall Loss: 12.468973
Rec Loss: 10.735135
KL Loss: 1.733838
Y Loss: 0.838787
T Loss: 10.315742
Epoch 2749 
Overall Loss: 12.459276
Rec Loss: 10.730815
KL Loss: 1.728461
Y Loss: 0.832474
T Loss: 10.314579
Epoch 2799 
Overall Loss: 12.467551
Rec Loss: 10.755366
KL Loss: 1.712184
Y Loss: 0.853925
T Loss: 10.328404
Epoch 2849 
Overall Loss: 12.457848
Rec Loss: 10.736614
KL Loss: 1.721234
Y Loss: 0.840293
T Loss: 10.316467
Epoch 2899 
Overall Loss: 12.474424
Rec Loss: 10.756586
KL Loss: 1.717838
Y Loss: 0.852690
T Loss: 10.330241
Epoch 2949 
Overall Loss: 12.460123
Rec Loss: 10.737837
KL Loss: 1.722285
Y Loss: 0.831361
T Loss: 10.322157
Epoch 2999 
Overall Loss: 12.463714
Rec Loss: 10.741789
KL Loss: 1.721925
Y Loss: 0.834224
T Loss: 10.324677
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.485480
Epoch 99
Rec Loss: 1.468418
Epoch 149
Rec Loss: 1.479591
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.933151
Epoch 99
Rec Loss: 9.927431
Epoch 149
Rec Loss: 9.903753
Epoch 199
Rec Loss: 9.917029
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.687207
Insample Error: 1.881240
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.792294
Rec Loss: 18.824763
KL Loss: 2.967531
Y Loss: 9.371863
T Loss: 13.008880
X Loss: 1.129951
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.626747
Epoch 99
Rec Loss: 3.637011
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.800502
Epoch 99
Rec Loss: 2.800201
Epoch 149
Rec Loss: 2.765696
Epoch 199
Rec Loss: 2.762381
Epoch 249
Rec Loss: 2.793518
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.351152
Insample Error 3.629184
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.596248
Epoch 99 
Prediction Loss: 2.376815
Epoch 149 
Prediction Loss: 2.215601
Epoch 199 
Prediction Loss: 2.148380
Epoch 249 
Prediction Loss: 2.005573
Epoch 299 
Prediction Loss: 1.976330
Epoch 349 
Prediction Loss: 1.853429
Epoch 399 
Prediction Loss: 1.750297
Epoch 449 
Prediction Loss: 1.660936
Epoch 499 
Prediction Loss: 1.598282
Epoch 549 
Prediction Loss: 1.510607
Epoch 599 
Prediction Loss: 1.405147
Epoch 649 
Prediction Loss: 1.387658
Epoch 699 
Prediction Loss: 1.317857
Epoch 749 
Prediction Loss: 1.272445
Epoch 799 
Prediction Loss: 1.255172
Epoch 849 
Prediction Loss: 1.219318
Epoch 899 
Prediction Loss: 1.154114
Epoch 949 
Prediction Loss: 1.128248
Epoch 999 
Prediction Loss: 1.098953
Epoch 1049 
Prediction Loss: 1.067455
Epoch 1099 
Prediction Loss: 1.072003
Epoch 1149 
Prediction Loss: 1.005867
Epoch 1199 
Prediction Loss: 1.017050
Epoch 1249 
Prediction Loss: 0.996531
Epoch 1299 
Prediction Loss: 0.936246
Epoch 1349 
Prediction Loss: 0.932166
Epoch 1399 
Prediction Loss: 0.924532
Epoch 1449 
Prediction Loss: 0.932141
Epoch 1499 
Prediction Loss: 0.919994
Epoch 1549 
Prediction Loss: 0.870242
Epoch 1599 
Prediction Loss: 0.867295
Epoch 1649 
Prediction Loss: 0.856051
Epoch 1699 
Prediction Loss: 0.851232
Epoch 1749 
Prediction Loss: 0.893818
Epoch 1799 
Prediction Loss: 0.814701
Epoch 1849 
Prediction Loss: 0.813356
Epoch 1899 
Prediction Loss: 0.794999
Epoch 1949 
Prediction Loss: 0.802792
Epoch 1999 
Prediction Loss: 0.782410
Epoch 2049 
Prediction Loss: 0.786651
Epoch 2099 
Prediction Loss: 0.783047
Epoch 2149 
Prediction Loss: 0.781413
Epoch 2199 
Prediction Loss: 0.758309
Epoch 2249 
Prediction Loss: 0.755038
Epoch 2299 
Prediction Loss: 0.769678
Epoch 2349 
Prediction Loss: 0.773912
Epoch 2399 
Prediction Loss: 0.765631
Epoch 2449 
Prediction Loss: 0.734662
Epoch 2499 
Prediction Loss: 0.729345
Epoch 2549 
Prediction Loss: 0.725022
Epoch 2599 
Prediction Loss: 0.715890
Epoch 2649 
Prediction Loss: 0.700631
Epoch 2699 
Prediction Loss: 0.718763
Epoch 2749 
Prediction Loss: 0.713088
Epoch 2799 
Prediction Loss: 0.703907
Epoch 2849 
Prediction Loss: 0.709966
Epoch 2899 
Prediction Loss: 0.704314
Epoch 2949 
Prediction Loss: 0.725866
Epoch 2999 
Prediction Loss: 0.700607
Epoch 3049 
Prediction Loss: 0.705858
Epoch 3099 
Prediction Loss: 0.665372
Epoch 3149 
Prediction Loss: 0.680797
Epoch 3199 
Prediction Loss: 0.668518
Epoch 3249 
Prediction Loss: 0.712003
Epoch 3299 
Prediction Loss: 0.663379
Epoch 3349 
Prediction Loss: 0.659919
Epoch 3399 
Prediction Loss: 0.689198
Epoch 3449 
Prediction Loss: 0.666116
Epoch 3499 
Prediction Loss: 0.646905
Epoch 3549 
Prediction Loss: 0.647951
Epoch 3599 
Prediction Loss: 0.667901
Epoch 3649 
Prediction Loss: 0.638901
Epoch 3699 
Prediction Loss: 0.630451
Epoch 3749 
Prediction Loss: 0.636571
Epoch 3799 
Prediction Loss: 0.630833
Epoch 3849 
Prediction Loss: 0.640800
Epoch 3899 
Prediction Loss: 0.621958
Epoch 3949 
Prediction Loss: 0.637390
Epoch 3999 
Prediction Loss: 0.609208
Epoch 4049 
Prediction Loss: 0.627401
Epoch 4099 
Prediction Loss: 0.614425
Epoch 4149 
Prediction Loss: 0.663248
Epoch 4199 
Prediction Loss: 0.620232
Epoch 4249 
Prediction Loss: 0.605131
Epoch 4299 
Prediction Loss: 0.630702
Epoch 4349 
Prediction Loss: 0.621680
Epoch 4399 
Prediction Loss: 0.634392
Epoch 4449 
Prediction Loss: 0.595397
Epoch 4499 
Prediction Loss: 0.601261
Epoch 4549 
Prediction Loss: 0.606508
Epoch 4599 
Prediction Loss: 0.603168
Epoch 4649 
Prediction Loss: 0.608207
Epoch 4699 
Prediction Loss: 0.600295
Epoch 4749 
Prediction Loss: 0.602706
Epoch 4799 
Prediction Loss: 0.590919
Epoch 4849 
Prediction Loss: 0.598010
Epoch 4899 
Prediction Loss: 0.583988
Epoch 4949 
Prediction Loss: 0.587020
Epoch 4999 
Prediction Loss: 0.591970
Epoch 5049 
Prediction Loss: 0.611325
Epoch 5099 
Prediction Loss: 0.596963
Epoch 5149 
Prediction Loss: 0.619252
Epoch 5199 
Prediction Loss: 0.598699
Epoch 5249 
Prediction Loss: 0.576962
Epoch 5299 
Prediction Loss: 0.592070
Epoch 5349 
Prediction Loss: 0.581262
Epoch 5399 
Prediction Loss: 0.604015
Epoch 5449 
Prediction Loss: 0.602766
Epoch 5499 
Prediction Loss: 0.586101
Epoch 5549 
Prediction Loss: 0.578477
Epoch 5599 
Prediction Loss: 0.592846
Epoch 5649 
Prediction Loss: 0.576915
Epoch 5699 
Prediction Loss: 0.577045
Epoch 5749 
Prediction Loss: 0.572187
Epoch 5799 
Prediction Loss: 0.611716
Epoch 5849 
Prediction Loss: 0.603414
Epoch 5899 
Prediction Loss: 0.573122
Epoch 5949 
Prediction Loss: 0.567232
Epoch 5999 
Prediction Loss: 0.594403
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.749283
Insample Error 3.573236
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.054761
Rec Loss: 11.308627
KL Loss: 1.746134
Y Loss: 0.997934
T Loss: 10.809660
Epoch 99 
Overall Loss: 12.855961
Rec Loss: 11.009905
KL Loss: 1.846057
Y Loss: 0.940790
T Loss: 10.539510
Epoch 149 
Overall Loss: 12.781981
Rec Loss: 10.903197
KL Loss: 1.878784
Y Loss: 0.933691
T Loss: 10.436351
Epoch 199 
Overall Loss: 12.757726
Rec Loss: 10.899568
KL Loss: 1.858158
Y Loss: 0.914080
T Loss: 10.442528
Epoch 249 
Overall Loss: 12.712094
Rec Loss: 10.871832
KL Loss: 1.840262
Y Loss: 0.923332
T Loss: 10.410166
Epoch 299 
Overall Loss: 12.696338
Rec Loss: 10.876154
KL Loss: 1.820184
Y Loss: 0.914980
T Loss: 10.418664
Epoch 349 
Overall Loss: 12.689948
Rec Loss: 10.864559
KL Loss: 1.825389
Y Loss: 0.907766
T Loss: 10.410676
Epoch 399 
Overall Loss: 12.678382
Rec Loss: 10.871404
KL Loss: 1.806978
Y Loss: 0.914746
T Loss: 10.414031
Epoch 449 
Overall Loss: 12.659089
Rec Loss: 10.866466
KL Loss: 1.792623
Y Loss: 0.905363
T Loss: 10.413784
Epoch 499 
Overall Loss: 12.671182
Rec Loss: 10.874052
KL Loss: 1.797130
Y Loss: 0.923551
T Loss: 10.412277
Epoch 549 
Overall Loss: 12.621038
Rec Loss: 10.844131
KL Loss: 1.776907
Y Loss: 0.888063
T Loss: 10.400100
Epoch 599 
Overall Loss: 12.649102
Rec Loss: 10.843172
KL Loss: 1.805930
Y Loss: 0.891566
T Loss: 10.397388
Epoch 649 
Overall Loss: 12.674131
Rec Loss: 10.863891
KL Loss: 1.810239
Y Loss: 0.894682
T Loss: 10.416550
Epoch 699 
Overall Loss: 12.643303
Rec Loss: 10.865852
KL Loss: 1.777451
Y Loss: 0.900577
T Loss: 10.415564
Epoch 749 
Overall Loss: 12.629705
Rec Loss: 10.860261
KL Loss: 1.769445
Y Loss: 0.889028
T Loss: 10.415747
Epoch 799 
Overall Loss: 12.622658
Rec Loss: 10.838655
KL Loss: 1.784003
Y Loss: 0.880941
T Loss: 10.398185
Epoch 849 
Overall Loss: 12.605312
Rec Loss: 10.844650
KL Loss: 1.760662
Y Loss: 0.865133
T Loss: 10.412084
Epoch 899 
Overall Loss: 12.592924
Rec Loss: 10.832906
KL Loss: 1.760018
Y Loss: 0.894463
T Loss: 10.385674
Epoch 949 
Overall Loss: 12.604177
Rec Loss: 10.842344
KL Loss: 1.761834
Y Loss: 0.876456
T Loss: 10.404116
Epoch 999 
Overall Loss: 12.602133
Rec Loss: 10.831622
KL Loss: 1.770511
Y Loss: 0.881172
T Loss: 10.391036
Epoch 1049 
Overall Loss: 12.601620
Rec Loss: 10.821543
KL Loss: 1.780077
Y Loss: 0.863104
T Loss: 10.389991
Epoch 1099 
Overall Loss: 12.619751
Rec Loss: 10.836168
KL Loss: 1.783583
Y Loss: 0.871025
T Loss: 10.400655
Epoch 1149 
Overall Loss: 12.584579
Rec Loss: 10.835875
KL Loss: 1.748704
Y Loss: 0.864382
T Loss: 10.403684
Epoch 1199 
Overall Loss: 12.576603
Rec Loss: 10.825134
KL Loss: 1.751469
Y Loss: 0.881636
T Loss: 10.384316
Epoch 1249 
Overall Loss: 12.552425
Rec Loss: 10.826405
KL Loss: 1.726020
Y Loss: 0.863122
T Loss: 10.394844
Epoch 1299 
Overall Loss: 12.587301
Rec Loss: 10.838880
KL Loss: 1.748420
Y Loss: 0.870583
T Loss: 10.403589
Epoch 1349 
Overall Loss: 12.561053
Rec Loss: 10.825961
KL Loss: 1.735093
Y Loss: 0.880446
T Loss: 10.385738
Epoch 1399 
Overall Loss: 12.556740
Rec Loss: 10.812058
KL Loss: 1.744681
Y Loss: 0.865656
T Loss: 10.379230
Epoch 1449 
Overall Loss: 12.555146
Rec Loss: 10.824782
KL Loss: 1.730364
Y Loss: 0.890875
T Loss: 10.379345
Epoch 1499 
Overall Loss: 12.561500
Rec Loss: 10.799328
KL Loss: 1.762172
Y Loss: 0.863653
T Loss: 10.367501
Epoch 1549 
Overall Loss: 12.555086
Rec Loss: 10.812955
KL Loss: 1.742131
Y Loss: 0.871870
T Loss: 10.377020
Epoch 1599 
Overall Loss: 12.543659
Rec Loss: 10.789241
KL Loss: 1.754418
Y Loss: 0.865167
T Loss: 10.356658
Epoch 1649 
Overall Loss: 12.552634
Rec Loss: 10.810877
KL Loss: 1.741757
Y Loss: 0.845168
T Loss: 10.388293
Epoch 1699 
Overall Loss: 12.536793
Rec Loss: 10.790544
KL Loss: 1.746250
Y Loss: 0.870515
T Loss: 10.355286
Epoch 1749 
Overall Loss: 12.542925
Rec Loss: 10.794537
KL Loss: 1.748388
Y Loss: 0.839578
T Loss: 10.374748
Epoch 1799 
Overall Loss: 12.525164
Rec Loss: 10.809527
KL Loss: 1.715637
Y Loss: 0.866779
T Loss: 10.376137
Epoch 1849 
Overall Loss: 12.517217
Rec Loss: 10.792585
KL Loss: 1.724632
Y Loss: 0.840701
T Loss: 10.372235
Epoch 1899 
Overall Loss: 12.556825
Rec Loss: 10.796304
KL Loss: 1.760521
Y Loss: 0.861893
T Loss: 10.365358
Epoch 1949 
Overall Loss: 12.533441
Rec Loss: 10.800614
KL Loss: 1.732827
Y Loss: 0.852326
T Loss: 10.374451
Epoch 1999 
Overall Loss: 12.499518
Rec Loss: 10.770369
KL Loss: 1.729150
Y Loss: 0.840583
T Loss: 10.350077
Epoch 2049 
Overall Loss: 12.499387
Rec Loss: 10.765732
KL Loss: 1.733655
Y Loss: 0.847895
T Loss: 10.341784
Epoch 2099 
Overall Loss: 12.487332
Rec Loss: 10.770857
KL Loss: 1.716475
Y Loss: 0.848451
T Loss: 10.346632
Epoch 2149 
Overall Loss: 12.509694
Rec Loss: 10.782973
KL Loss: 1.726721
Y Loss: 0.838367
T Loss: 10.363790
Epoch 2199 
Overall Loss: 12.474671
Rec Loss: 10.762277
KL Loss: 1.712395
Y Loss: 0.859933
T Loss: 10.332310
Epoch 2249 
Overall Loss: 12.493191
Rec Loss: 10.756734
KL Loss: 1.736457
Y Loss: 0.848319
T Loss: 10.332575
Epoch 2299 
Overall Loss: 12.484718
Rec Loss: 10.756667
KL Loss: 1.728050
Y Loss: 0.851252
T Loss: 10.331041
Epoch 2349 
Overall Loss: 12.504927
Rec Loss: 10.765732
KL Loss: 1.739195
Y Loss: 0.841151
T Loss: 10.345156
Epoch 2399 
Overall Loss: 12.476272
Rec Loss: 10.744614
KL Loss: 1.731658
Y Loss: 0.837567
T Loss: 10.325831
Epoch 2449 
Overall Loss: 12.476989
Rec Loss: 10.754110
KL Loss: 1.722879
Y Loss: 0.835347
T Loss: 10.336436
Epoch 2499 
Overall Loss: 12.490187
Rec Loss: 10.752981
KL Loss: 1.737206
Y Loss: 0.838086
T Loss: 10.333938
Epoch 2549 
Overall Loss: 12.480162
Rec Loss: 10.740320
KL Loss: 1.739842
Y Loss: 0.844175
T Loss: 10.318233
Epoch 2599 
Overall Loss: 12.500544
Rec Loss: 10.753975
KL Loss: 1.746569
Y Loss: 0.867858
T Loss: 10.320046
Epoch 2649 
Overall Loss: 12.453456
Rec Loss: 10.734783
KL Loss: 1.718673
Y Loss: 0.832207
T Loss: 10.318679
Epoch 2699 
Overall Loss: 12.477906
Rec Loss: 10.758394
KL Loss: 1.719512
Y Loss: 0.869014
T Loss: 10.323887
Epoch 2749 
Overall Loss: 12.463747
Rec Loss: 10.746725
KL Loss: 1.717022
Y Loss: 0.845376
T Loss: 10.324036
Epoch 2799 
Overall Loss: 12.455718
Rec Loss: 10.728006
KL Loss: 1.727713
Y Loss: 0.849746
T Loss: 10.303133
Epoch 2849 
Overall Loss: 12.469352
Rec Loss: 10.765069
KL Loss: 1.704284
Y Loss: 0.875005
T Loss: 10.327566
Epoch 2899 
Overall Loss: 12.448037
Rec Loss: 10.731312
KL Loss: 1.716725
Y Loss: 0.851243
T Loss: 10.305691
Epoch 2949 
Overall Loss: 12.436527
Rec Loss: 10.734942
KL Loss: 1.701585
Y Loss: 0.837295
T Loss: 10.316295
Epoch 2999 
Overall Loss: 12.456139
Rec Loss: 10.728027
KL Loss: 1.728112
Y Loss: 0.838487
T Loss: 10.308784
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.467262
Epoch 99
Rec Loss: 1.471701
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.924917
Epoch 99
Rec Loss: 9.918575
Epoch 149
Rec Loss: 9.907242
Epoch 199
Rec Loss: 9.901043
Epoch 249
Rec Loss: 9.899864
Epoch 299
Rec Loss: 9.892565
Epoch 349
Rec Loss: 9.883409
Epoch 399
Rec Loss: 9.881594
Epoch 449
Rec Loss: 9.887650
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.689373
Insample Error: 1.905622
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.506346
Rec Loss: 18.369319
KL Loss: 3.137028
Y Loss: 8.809697
T Loss: 12.892676
X Loss: 1.071794
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.524689
Epoch 99
Rec Loss: 3.524035
Epoch 149
Rec Loss: 3.522456
Epoch 199
Rec Loss: 3.521055
Epoch 249
Rec Loss: 3.527541
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.848307
Epoch 99
Rec Loss: 2.846542
Epoch 149
Rec Loss: 2.834639
Epoch 199
Rec Loss: 2.851596
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.333836
Insample Error 3.690147
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.506691
Epoch 99 
Prediction Loss: 2.337848
Epoch 149 
Prediction Loss: 2.241114
Epoch 199 
Prediction Loss: 2.144621
Epoch 249 
Prediction Loss: 2.020768
Epoch 299 
Prediction Loss: 1.972719
Epoch 349 
Prediction Loss: 1.823403
Epoch 399 
Prediction Loss: 1.729531
Epoch 449 
Prediction Loss: 1.719629
Epoch 499 
Prediction Loss: 1.571792
Epoch 549 
Prediction Loss: 1.475531
Epoch 599 
Prediction Loss: 1.414477
Epoch 649 
Prediction Loss: 1.382210
Epoch 699 
Prediction Loss: 1.290323
Epoch 749 
Prediction Loss: 1.277404
Epoch 799 
Prediction Loss: 1.197402
Epoch 849 
Prediction Loss: 1.164087
Epoch 899 
Prediction Loss: 1.115229
Epoch 949 
Prediction Loss: 1.108047
Epoch 999 
Prediction Loss: 1.061718
Epoch 1049 
Prediction Loss: 1.039905
Epoch 1099 
Prediction Loss: 1.008629
Epoch 1149 
Prediction Loss: 0.986022
Epoch 1199 
Prediction Loss: 0.987288
Epoch 1249 
Prediction Loss: 1.034186
Epoch 1299 
Prediction Loss: 0.966605
Epoch 1349 
Prediction Loss: 0.904775
Epoch 1399 
Prediction Loss: 0.917722
Epoch 1449 
Prediction Loss: 0.919999
Epoch 1499 
Prediction Loss: 0.874493
Epoch 1549 
Prediction Loss: 0.870450
Epoch 1599 
Prediction Loss: 0.856435
Epoch 1649 
Prediction Loss: 0.830993
Epoch 1699 
Prediction Loss: 0.836164
Epoch 1749 
Prediction Loss: 0.829539
Epoch 1799 
Prediction Loss: 0.800749
Epoch 1849 
Prediction Loss: 0.790867
Epoch 1899 
Prediction Loss: 0.793227
Epoch 1949 
Prediction Loss: 0.784498
Epoch 1999 
Prediction Loss: 0.765761
Epoch 2049 
Prediction Loss: 0.783952
Epoch 2099 
Prediction Loss: 0.786688
Epoch 2149 
Prediction Loss: 0.754440
Epoch 2199 
Prediction Loss: 0.748486
Epoch 2249 
Prediction Loss: 0.758085
Epoch 2299 
Prediction Loss: 0.721462
Epoch 2349 
Prediction Loss: 0.726879
Epoch 2399 
Prediction Loss: 0.705740
Epoch 2449 
Prediction Loss: 0.729328
Epoch 2499 
Prediction Loss: 0.727419
Epoch 2549 
Prediction Loss: 0.781121
Epoch 2599 
Prediction Loss: 0.707194
Epoch 2649 
Prediction Loss: 0.691529
Epoch 2699 
Prediction Loss: 0.692622
Epoch 2749 
Prediction Loss: 0.697904
Epoch 2799 
Prediction Loss: 0.704539
Epoch 2849 
Prediction Loss: 0.693602
Epoch 2899 
Prediction Loss: 0.680052
Epoch 2949 
Prediction Loss: 0.671836
Epoch 2999 
Prediction Loss: 0.697176
Epoch 3049 
Prediction Loss: 0.653691
Epoch 3099 
Prediction Loss: 0.652340
Epoch 3149 
Prediction Loss: 0.656474
Epoch 3199 
Prediction Loss: 0.667043
Epoch 3249 
Prediction Loss: 0.655049
Epoch 3299 
Prediction Loss: 0.662849
Epoch 3349 
Prediction Loss: 0.634836
Epoch 3399 
Prediction Loss: 0.638837
Epoch 3449 
Prediction Loss: 0.643995
Epoch 3499 
Prediction Loss: 0.629675
Epoch 3549 
Prediction Loss: 0.641778
Epoch 3599 
Prediction Loss: 0.623092
Epoch 3649 
Prediction Loss: 0.679169
Epoch 3699 
Prediction Loss: 0.611425
Epoch 3749 
Prediction Loss: 0.612011
Epoch 3799 
Prediction Loss: 0.617514
Epoch 3849 
Prediction Loss: 0.628227
Epoch 3899 
Prediction Loss: 0.619904
Epoch 3949 
Prediction Loss: 0.610197
Epoch 3999 
Prediction Loss: 0.602311
Epoch 4049 
Prediction Loss: 0.632319
Epoch 4099 
Prediction Loss: 0.603608
Epoch 4149 
Prediction Loss: 0.617318
Epoch 4199 
Prediction Loss: 0.592032
Epoch 4249 
Prediction Loss: 0.623261
Epoch 4299 
Prediction Loss: 0.582380
Epoch 4349 
Prediction Loss: 0.605162
Epoch 4399 
Prediction Loss: 0.596629
Epoch 4449 
Prediction Loss: 0.589235
Epoch 4499 
Prediction Loss: 0.593684
Epoch 4549 
Prediction Loss: 0.619553
Epoch 4599 
Prediction Loss: 0.581045
Epoch 4649 
Prediction Loss: 0.575448
Epoch 4699 
Prediction Loss: 0.584168
Epoch 4749 
Prediction Loss: 0.580079
Epoch 4799 
Prediction Loss: 0.579519
Epoch 4849 
Prediction Loss: 0.555526
Epoch 4899 
Prediction Loss: 0.580146
Epoch 4949 
Prediction Loss: 0.584685
Epoch 4999 
Prediction Loss: 0.583165
Epoch 5049 
Prediction Loss: 0.552875
Epoch 5099 
Prediction Loss: 0.566529
Epoch 5149 
Prediction Loss: 0.570858
Epoch 5199 
Prediction Loss: 0.553192
Epoch 5249 
Prediction Loss: 0.591615
Epoch 5299 
Prediction Loss: 0.562774
Epoch 5349 
Prediction Loss: 0.566011
Epoch 5399 
Prediction Loss: 0.548217
Epoch 5449 
Prediction Loss: 0.560814
Epoch 5499 
Prediction Loss: 0.551386
Epoch 5549 
Prediction Loss: 0.543289
Epoch 5599 
Prediction Loss: 0.560744
Epoch 5649 
Prediction Loss: 0.557926
Epoch 5699 
Prediction Loss: 0.542137
Epoch 5749 
Prediction Loss: 0.541746
Epoch 5799 
Prediction Loss: 0.555095
Epoch 5849 
Prediction Loss: 0.567101
Epoch 5899 
Prediction Loss: 0.557404
Epoch 5949 
Prediction Loss: 0.540178
Epoch 5999 
Prediction Loss: 0.562226
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.725639
Insample Error 3.609327
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.037327
Rec Loss: 11.271574
KL Loss: 1.765753
Y Loss: 1.016080
T Loss: 10.763534
Epoch 99 
Overall Loss: 12.900096
Rec Loss: 11.209849
KL Loss: 1.690246
Y Loss: 0.918903
T Loss: 10.750398
Epoch 149 
Overall Loss: 12.822905
Rec Loss: 11.204607
KL Loss: 1.618298
Y Loss: 0.955348
T Loss: 10.726933
Epoch 199 
Overall Loss: 12.707146
Rec Loss: 10.917065
KL Loss: 1.790081
Y Loss: 0.913239
T Loss: 10.460446
Epoch 249 
Overall Loss: 12.700996
Rec Loss: 10.922272
KL Loss: 1.778724
Y Loss: 0.921906
T Loss: 10.461319
Epoch 299 
Overall Loss: 12.708445
Rec Loss: 10.905818
KL Loss: 1.802627
Y Loss: 0.947407
T Loss: 10.432114
Epoch 349 
Overall Loss: 12.667832
Rec Loss: 10.887527
KL Loss: 1.780305
Y Loss: 0.928931
T Loss: 10.423061
Epoch 399 
Overall Loss: 12.666925
Rec Loss: 10.892610
KL Loss: 1.774315
Y Loss: 0.925655
T Loss: 10.429782
Epoch 449 
Overall Loss: 12.652820
Rec Loss: 10.885885
KL Loss: 1.766935
Y Loss: 0.926590
T Loss: 10.422590
Epoch 499 
Overall Loss: 12.645980
Rec Loss: 10.854772
KL Loss: 1.791209
Y Loss: 0.891389
T Loss: 10.409078
Epoch 549 
Overall Loss: 12.658937
Rec Loss: 10.883520
KL Loss: 1.775417
Y Loss: 0.915795
T Loss: 10.425622
Epoch 599 
Overall Loss: 12.646041
Rec Loss: 10.864925
KL Loss: 1.781116
Y Loss: 0.879076
T Loss: 10.425387
Epoch 649 
Overall Loss: 12.635609
Rec Loss: 10.879155
KL Loss: 1.756454
Y Loss: 0.895014
T Loss: 10.431648
Epoch 699 
Overall Loss: 12.614572
Rec Loss: 10.853199
KL Loss: 1.761373
Y Loss: 0.876051
T Loss: 10.415173
Epoch 749 
Overall Loss: 12.636701
Rec Loss: 10.853725
KL Loss: 1.782976
Y Loss: 0.887626
T Loss: 10.409912
Epoch 799 
Overall Loss: 12.630531
Rec Loss: 10.862374
KL Loss: 1.768156
Y Loss: 0.864400
T Loss: 10.430174
Epoch 849 
Overall Loss: 12.624888
Rec Loss: 10.858135
KL Loss: 1.766753
Y Loss: 0.914667
T Loss: 10.400801
Epoch 899 
Overall Loss: 12.605315
Rec Loss: 10.844566
KL Loss: 1.760749
Y Loss: 0.903890
T Loss: 10.392621
Epoch 949 
Overall Loss: 12.609494
Rec Loss: 10.850011
KL Loss: 1.759483
Y Loss: 0.882408
T Loss: 10.408807
Epoch 999 
Overall Loss: 12.607262
Rec Loss: 10.850175
KL Loss: 1.757087
Y Loss: 0.877869
T Loss: 10.411240
Epoch 1049 
Overall Loss: 12.601861
Rec Loss: 10.846694
KL Loss: 1.755167
Y Loss: 0.890259
T Loss: 10.401564
Epoch 1099 
Overall Loss: 12.572066
Rec Loss: 10.831696
KL Loss: 1.740370
Y Loss: 0.853715
T Loss: 10.404838
Epoch 1149 
Overall Loss: 12.587251
Rec Loss: 10.824389
KL Loss: 1.762862
Y Loss: 0.876843
T Loss: 10.385968
Epoch 1199 
Overall Loss: 12.574406
Rec Loss: 10.809279
KL Loss: 1.765127
Y Loss: 0.873459
T Loss: 10.372550
Epoch 1249 
Overall Loss: 12.570089
Rec Loss: 10.815413
KL Loss: 1.754677
Y Loss: 0.869927
T Loss: 10.380449
Epoch 1299 
Overall Loss: 12.571391
Rec Loss: 10.822219
KL Loss: 1.749172
Y Loss: 0.885559
T Loss: 10.379440
Epoch 1349 
Overall Loss: 12.577173
Rec Loss: 10.843950
KL Loss: 1.733223
Y Loss: 0.882591
T Loss: 10.402655
Epoch 1399 
Overall Loss: 12.548860
Rec Loss: 10.831170
KL Loss: 1.717690
Y Loss: 0.875218
T Loss: 10.393561
Epoch 1449 
Overall Loss: 12.573393
Rec Loss: 10.832978
KL Loss: 1.740416
Y Loss: 0.880995
T Loss: 10.392480
Epoch 1499 
Overall Loss: 12.525766
Rec Loss: 10.788476
KL Loss: 1.737291
Y Loss: 0.862991
T Loss: 10.356980
Epoch 1549 
Overall Loss: 12.554991
Rec Loss: 10.784111
KL Loss: 1.770880
Y Loss: 0.845050
T Loss: 10.361586
Epoch 1599 
Overall Loss: 12.540494
Rec Loss: 10.804891
KL Loss: 1.735603
Y Loss: 0.859069
T Loss: 10.375356
Epoch 1649 
Overall Loss: 12.549543
Rec Loss: 10.812873
KL Loss: 1.736670
Y Loss: 0.855393
T Loss: 10.385177
Epoch 1699 
Overall Loss: 12.532106
Rec Loss: 10.807716
KL Loss: 1.724390
Y Loss: 0.860906
T Loss: 10.377263
Epoch 1749 
Overall Loss: 12.559726
Rec Loss: 10.793439
KL Loss: 1.766287
Y Loss: 0.861764
T Loss: 10.362557
Epoch 1799 
Overall Loss: 12.517004
Rec Loss: 10.786461
KL Loss: 1.730543
Y Loss: 0.841182
T Loss: 10.365870
Epoch 1849 
Overall Loss: 12.524997
Rec Loss: 10.794397
KL Loss: 1.730600
Y Loss: 0.877914
T Loss: 10.355441
Epoch 1899 
Overall Loss: 12.523753
Rec Loss: 10.783319
KL Loss: 1.740434
Y Loss: 0.862009
T Loss: 10.352315
Epoch 1949 
Overall Loss: 12.538049
Rec Loss: 10.789641
KL Loss: 1.748408
Y Loss: 0.858734
T Loss: 10.360274
Epoch 1999 
Overall Loss: 12.515465
Rec Loss: 10.791181
KL Loss: 1.724284
Y Loss: 0.850929
T Loss: 10.365717
Epoch 2049 
Overall Loss: 12.512534
Rec Loss: 10.759737
KL Loss: 1.752797
Y Loss: 0.837514
T Loss: 10.340980
Epoch 2099 
Overall Loss: 12.520791
Rec Loss: 10.784330
KL Loss: 1.736461
Y Loss: 0.841129
T Loss: 10.363765
Epoch 2149 
Overall Loss: 12.484071
Rec Loss: 10.772033
KL Loss: 1.712038
Y Loss: 0.851213
T Loss: 10.346426
Epoch 2199 
Overall Loss: 12.486986
Rec Loss: 10.784414
KL Loss: 1.702572
Y Loss: 0.847464
T Loss: 10.360683
Epoch 2249 
Overall Loss: 12.518489
Rec Loss: 10.774242
KL Loss: 1.744247
Y Loss: 0.856054
T Loss: 10.346215
Epoch 2299 
Overall Loss: 12.495741
Rec Loss: 10.770827
KL Loss: 1.724914
Y Loss: 0.850970
T Loss: 10.345342
Epoch 2349 
Overall Loss: 12.493434
Rec Loss: 10.767592
KL Loss: 1.725842
Y Loss: 0.857457
T Loss: 10.338863
Epoch 2399 
Overall Loss: 12.487270
Rec Loss: 10.747960
KL Loss: 1.739311
Y Loss: 0.851660
T Loss: 10.322130
Epoch 2449 
Overall Loss: 12.480017
Rec Loss: 10.737978
KL Loss: 1.742040
Y Loss: 0.848182
T Loss: 10.313887
Epoch 2499 
Overall Loss: 12.486358
Rec Loss: 10.765435
KL Loss: 1.720924
Y Loss: 0.850420
T Loss: 10.340225
Epoch 2549 
Overall Loss: 12.499284
Rec Loss: 10.765259
KL Loss: 1.734025
Y Loss: 0.839644
T Loss: 10.345437
Epoch 2599 
Overall Loss: 12.488632
Rec Loss: 10.761371
KL Loss: 1.727261
Y Loss: 0.846741
T Loss: 10.338000
Epoch 2649 
Overall Loss: 12.472819
Rec Loss: 10.773761
KL Loss: 1.699057
Y Loss: 0.850384
T Loss: 10.348569
Epoch 2699 
Overall Loss: 12.493105
Rec Loss: 10.759473
KL Loss: 1.733633
Y Loss: 0.832946
T Loss: 10.342999
Epoch 2749 
Overall Loss: 12.496212
Rec Loss: 10.762598
KL Loss: 1.733614
Y Loss: 0.855115
T Loss: 10.335040
Epoch 2799 
Overall Loss: 12.467704
Rec Loss: 10.748234
KL Loss: 1.719470
Y Loss: 0.869624
T Loss: 10.313421
Epoch 2849 
Overall Loss: 12.465003
Rec Loss: 10.763741
KL Loss: 1.701262
Y Loss: 0.853280
T Loss: 10.337101
Epoch 2899 
Overall Loss: 12.479130
Rec Loss: 10.748024
KL Loss: 1.731106
Y Loss: 0.882546
T Loss: 10.306751
Epoch 2949 
Overall Loss: 12.442039
Rec Loss: 10.727723
KL Loss: 1.714317
Y Loss: 0.839032
T Loss: 10.308207
Epoch 2999 
Overall Loss: 12.460543
Rec Loss: 10.723091
KL Loss: 1.737452
Y Loss: 0.830176
T Loss: 10.308003
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.477934
Epoch 99
Rec Loss: 1.464178
Epoch 149
Rec Loss: 1.454914
Epoch 199
Rec Loss: 1.470079
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.920654
Epoch 99
Rec Loss: 9.908171
Epoch 149
Rec Loss: 9.897537
Epoch 199
Rec Loss: 9.890923
Epoch 249
Rec Loss: 9.901949
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.689956
Insample Error: 1.863454
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.334742
Rec Loss: 19.798589
KL Loss: 2.536153
Y Loss: 10.280926
T Loss: 13.319373
X Loss: 1.338752
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.608061
Epoch 99
Rec Loss: 3.605019
Epoch 149
Rec Loss: 3.603678
Epoch 199
Rec Loss: 3.600484
Epoch 249
Rec Loss: 3.603868
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.981258
Epoch 99
Rec Loss: 2.994279
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.376737
Insample Error 3.820144
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.501781
Epoch 99 
Prediction Loss: 2.302183
Epoch 149 
Prediction Loss: 2.198784
Epoch 199 
Prediction Loss: 2.143720
Epoch 249 
Prediction Loss: 2.012237
Epoch 299 
Prediction Loss: 1.963792
Epoch 349 
Prediction Loss: 1.851220
Epoch 399 
Prediction Loss: 1.801198
Epoch 449 
Prediction Loss: 1.692513
Epoch 499 
Prediction Loss: 1.603596
Epoch 549 
Prediction Loss: 1.521081
Epoch 599 
Prediction Loss: 1.437935
Epoch 649 
Prediction Loss: 1.391577
Epoch 699 
Prediction Loss: 1.300660
Epoch 749 
Prediction Loss: 1.263815
Epoch 799 
Prediction Loss: 1.214881
Epoch 849 
Prediction Loss: 1.187254
Epoch 899 
Prediction Loss: 1.184464
Epoch 949 
Prediction Loss: 1.050542
Epoch 999 
Prediction Loss: 1.059999
Epoch 1049 
Prediction Loss: 0.996108
Epoch 1099 
Prediction Loss: 0.964580
Epoch 1149 
Prediction Loss: 0.941035
Epoch 1199 
Prediction Loss: 0.929704
Epoch 1249 
Prediction Loss: 0.909400
Epoch 1299 
Prediction Loss: 0.879432
Epoch 1349 
Prediction Loss: 0.866683
Epoch 1399 
Prediction Loss: 0.887106
Epoch 1449 
Prediction Loss: 0.831128
Epoch 1499 
Prediction Loss: 0.813345
Epoch 1549 
Prediction Loss: 0.821731
Epoch 1599 
Prediction Loss: 0.817298
Epoch 1649 
Prediction Loss: 0.772038
Epoch 1699 
Prediction Loss: 0.783914
Epoch 1749 
Prediction Loss: 0.759355
Epoch 1799 
Prediction Loss: 0.766960
Epoch 1849 
Prediction Loss: 0.727386
Epoch 1899 
Prediction Loss: 0.736593
Epoch 1949 
Prediction Loss: 0.744314
Epoch 1999 
Prediction Loss: 0.747352
Epoch 2049 
Prediction Loss: 0.715045
Epoch 2099 
Prediction Loss: 0.714719
Epoch 2149 
Prediction Loss: 0.698492
Epoch 2199 
Prediction Loss: 0.709062
Epoch 2249 
Prediction Loss: 0.681409
Epoch 2299 
Prediction Loss: 0.671117
Epoch 2349 
Prediction Loss: 0.676687
Epoch 2399 
Prediction Loss: 0.689990
Epoch 2449 
Prediction Loss: 0.655484
Epoch 2499 
Prediction Loss: 0.644132
Epoch 2549 
Prediction Loss: 0.656155
Epoch 2599 
Prediction Loss: 0.656530
Epoch 2649 
Prediction Loss: 0.652265
Epoch 2699 
Prediction Loss: 0.651009
Epoch 2749 
Prediction Loss: 0.640488
Epoch 2799 
Prediction Loss: 0.637479
Epoch 2849 
Prediction Loss: 0.626782
Epoch 2899 
Prediction Loss: 0.624024
Epoch 2949 
Prediction Loss: 0.623127
Epoch 2999 
Prediction Loss: 0.622773
Epoch 3049 
Prediction Loss: 0.616642
Epoch 3099 
Prediction Loss: 0.623659
Epoch 3149 
Prediction Loss: 0.611325
Epoch 3199 
Prediction Loss: 0.599376
Epoch 3249 
Prediction Loss: 0.603980
Epoch 3299 
Prediction Loss: 0.610605
Epoch 3349 
Prediction Loss: 0.634808
Epoch 3399 
Prediction Loss: 0.599722
Epoch 3449 
Prediction Loss: 0.599379
Epoch 3499 
Prediction Loss: 0.601748
Epoch 3549 
Prediction Loss: 0.595957
Epoch 3599 
Prediction Loss: 0.621457
Epoch 3649 
Prediction Loss: 0.580223
Epoch 3699 
Prediction Loss: 0.588238
Epoch 3749 
Prediction Loss: 0.587864
Epoch 3799 
Prediction Loss: 0.598123
Epoch 3849 
Prediction Loss: 0.583727
Epoch 3899 
Prediction Loss: 0.589774
Epoch 3949 
Prediction Loss: 0.575569
Epoch 3999 
Prediction Loss: 0.586951
Epoch 4049 
Prediction Loss: 0.563671
Epoch 4099 
Prediction Loss: 0.569839
Epoch 4149 
Prediction Loss: 0.590119
Epoch 4199 
Prediction Loss: 0.564480
Epoch 4249 
Prediction Loss: 0.573761
Epoch 4299 
Prediction Loss: 0.585245
Epoch 4349 
Prediction Loss: 0.569447
Epoch 4399 
Prediction Loss: 0.557159
Epoch 4449 
Prediction Loss: 0.565131
Epoch 4499 
Prediction Loss: 0.556262
Epoch 4549 
Prediction Loss: 0.560807
Epoch 4599 
Prediction Loss: 0.556156
Epoch 4649 
Prediction Loss: 0.548289
Epoch 4699 
Prediction Loss: 0.561124
Epoch 4749 
Prediction Loss: 0.547598
Epoch 4799 
Prediction Loss: 0.541030
Epoch 4849 
Prediction Loss: 0.560174
Epoch 4899 
Prediction Loss: 0.556565
Epoch 4949 
Prediction Loss: 0.548997
Epoch 4999 
Prediction Loss: 0.539809
Epoch 5049 
Prediction Loss: 0.546707
Epoch 5099 
Prediction Loss: 0.547073
Epoch 5149 
Prediction Loss: 0.543571
Epoch 5199 
Prediction Loss: 0.534569
Epoch 5249 
Prediction Loss: 0.529278
Epoch 5299 
Prediction Loss: 0.565133
Epoch 5349 
Prediction Loss: 0.541048
Epoch 5399 
Prediction Loss: 0.534534
Epoch 5449 
Prediction Loss: 0.535432
Epoch 5499 
Prediction Loss: 0.581802
Epoch 5549 
Prediction Loss: 0.524346
Epoch 5599 
Prediction Loss: 0.550998
Epoch 5649 
Prediction Loss: 0.537886
Epoch 5699 
Prediction Loss: 0.524938
Epoch 5749 
Prediction Loss: 0.522984
Epoch 5799 
Prediction Loss: 0.531105
Epoch 5849 
Prediction Loss: 0.551681
Epoch 5899 
Prediction Loss: 0.552423
Epoch 5949 
Prediction Loss: 0.517817
Epoch 5999 
Prediction Loss: 0.516720
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.724567
Insample Error 3.605866
Ours, Train RMSE
0.6872, 
0.6894, 
0.6900, 
CEVAE, Train RMSE
2.3512, 
2.3338, 
2.3767, 
Ours, Insample RMSE
1.8812, 
1.9056, 
1.8635, 
CEVAE, Insample RMSE
3.6292, 
3.6901, 
3.8201, 
Direct Regression, Insample RMSE
3.5732, 
3.6093, 
3.6059, 
Train, RMSE mean 0.6888 std 0.0012
CEVAE, RMSE mean 2.3539 std 0.0176
Ours, RMSE mean 1.8834 std 0.0173, reconstruct confounder 1.4635 (0.0061) noise 9.8921 (0.0091)
CEVAE, RMSE mean 3.7132 std 0.0796, reconstruct confounder 3.5828 (0.0449) noise 2.8594 (0.0911)
Direct Regression, RMSE mean 3.5961 std 0.0163
Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=5, mask=0, nlayer=50, obsm=2, stop=5000, ycof=0.5, ylayer=50)
Y Mean 2.635484, Std 4.326354 
Test Y Mean 0.032706, Std 4.125860 
Observe confounder 2, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.039594
Rec Loss: 11.274521
KL Loss: 1.765073
Y Loss: 0.972708
T Loss: 10.788166
Epoch 99 
Overall Loss: 12.861499
Rec Loss: 11.099393
KL Loss: 1.762106
Y Loss: 0.942427
T Loss: 10.628179
Epoch 149 
Overall Loss: 12.773616
Rec Loss: 10.912725
KL Loss: 1.860891
Y Loss: 0.921917
T Loss: 10.451766
Epoch 199 
Overall Loss: 12.756311
Rec Loss: 10.912388
KL Loss: 1.843922
Y Loss: 0.921232
T Loss: 10.451772
Epoch 249 
Overall Loss: 12.716229
Rec Loss: 10.889766
KL Loss: 1.826464
Y Loss: 0.932631
T Loss: 10.423450
Epoch 299 
Overall Loss: 12.716995
Rec Loss: 10.920358
KL Loss: 1.796637
Y Loss: 0.947045
T Loss: 10.446836
Epoch 349 
Overall Loss: 12.703702
Rec Loss: 10.886242
KL Loss: 1.817460
Y Loss: 0.920984
T Loss: 10.425750
Epoch 399 
Overall Loss: 12.675454
Rec Loss: 10.889814
KL Loss: 1.785639
Y Loss: 0.920114
T Loss: 10.429758
Epoch 449 
Overall Loss: 12.661285
Rec Loss: 10.873535
KL Loss: 1.787751
Y Loss: 0.917363
T Loss: 10.414853
Epoch 499 
Overall Loss: 12.679111
Rec Loss: 10.868256
KL Loss: 1.810855
Y Loss: 0.911144
T Loss: 10.412685
Epoch 549 
Overall Loss: 12.639744
Rec Loss: 10.863785
KL Loss: 1.775958
Y Loss: 0.914403
T Loss: 10.406584
Epoch 599 
Overall Loss: 12.625555
Rec Loss: 10.863880
KL Loss: 1.761675
Y Loss: 0.880208
T Loss: 10.423776
Epoch 649 
Overall Loss: 12.635926
Rec Loss: 10.867638
KL Loss: 1.768288
Y Loss: 0.897533
T Loss: 10.418872
Epoch 699 
Overall Loss: 12.642709
Rec Loss: 10.855678
KL Loss: 1.787032
Y Loss: 0.907797
T Loss: 10.401779
Epoch 749 
Overall Loss: 12.619769
Rec Loss: 10.849187
KL Loss: 1.770582
Y Loss: 0.900361
T Loss: 10.399006
Epoch 799 
Overall Loss: 12.613635
Rec Loss: 10.866308
KL Loss: 1.747327
Y Loss: 0.901271
T Loss: 10.415672
Epoch 849 
Overall Loss: 12.624536
Rec Loss: 10.867594
KL Loss: 1.756941
Y Loss: 0.883651
T Loss: 10.425769
Epoch 899 
Overall Loss: 12.616386
Rec Loss: 10.849987
KL Loss: 1.766399
Y Loss: 0.906110
T Loss: 10.396932
Epoch 949 
Overall Loss: 12.595016
Rec Loss: 10.827874
KL Loss: 1.767143
Y Loss: 0.872968
T Loss: 10.391390
Epoch 999 
Overall Loss: 12.612716
Rec Loss: 10.862302
KL Loss: 1.750414
Y Loss: 0.880673
T Loss: 10.421966
Epoch 1049 
Overall Loss: 12.588611
Rec Loss: 10.811526
KL Loss: 1.777085
Y Loss: 0.884527
T Loss: 10.369263
Epoch 1099 
Overall Loss: 12.583597
Rec Loss: 10.827275
KL Loss: 1.756322
Y Loss: 0.862427
T Loss: 10.396061
Epoch 1149 
Overall Loss: 12.609557
Rec Loss: 10.821256
KL Loss: 1.788302
Y Loss: 0.862410
T Loss: 10.390051
Epoch 1199 
Overall Loss: 12.577734
Rec Loss: 10.843213
KL Loss: 1.734522
Y Loss: 0.872797
T Loss: 10.406814
Epoch 1249 
Overall Loss: 12.582123
Rec Loss: 10.819419
KL Loss: 1.762705
Y Loss: 0.866199
T Loss: 10.386319
Epoch 1299 
Overall Loss: 12.575835
Rec Loss: 10.848952
KL Loss: 1.726882
Y Loss: 0.883318
T Loss: 10.407293
Epoch 1349 
Overall Loss: 12.572850
Rec Loss: 10.812382
KL Loss: 1.760468
Y Loss: 0.855804
T Loss: 10.384480
Epoch 1399 
Overall Loss: 12.554999
Rec Loss: 10.813063
KL Loss: 1.741936
Y Loss: 0.846227
T Loss: 10.389950
Epoch 1449 
Overall Loss: 12.562816
Rec Loss: 10.823472
KL Loss: 1.739344
Y Loss: 0.868894
T Loss: 10.389025
Epoch 1499 
Overall Loss: 12.582257
Rec Loss: 10.821610
KL Loss: 1.760646
Y Loss: 0.877702
T Loss: 10.382760
Epoch 1549 
Overall Loss: 12.555972
Rec Loss: 10.803527
KL Loss: 1.752445
Y Loss: 0.859288
T Loss: 10.373883
Epoch 1599 
Overall Loss: 12.572149
Rec Loss: 10.810775
KL Loss: 1.761375
Y Loss: 0.851679
T Loss: 10.384935
Epoch 1649 
Overall Loss: 12.552071
Rec Loss: 10.801288
KL Loss: 1.750784
Y Loss: 0.842896
T Loss: 10.379840
Epoch 1699 
Overall Loss: 12.544072
Rec Loss: 10.784811
KL Loss: 1.759261
Y Loss: 0.858273
T Loss: 10.355675
Epoch 1749 
Overall Loss: 12.557984
Rec Loss: 10.809936
KL Loss: 1.748047
Y Loss: 0.852925
T Loss: 10.383474
Epoch 1799 
Overall Loss: 12.525633
Rec Loss: 10.794862
KL Loss: 1.730771
Y Loss: 0.864713
T Loss: 10.362506
Epoch 1849 
Overall Loss: 12.532949
Rec Loss: 10.791627
KL Loss: 1.741322
Y Loss: 0.862157
T Loss: 10.360548
Epoch 1899 
Overall Loss: 12.546012
Rec Loss: 10.775782
KL Loss: 1.770230
Y Loss: 0.839933
T Loss: 10.355815
Epoch 1949 
Overall Loss: 12.519922
Rec Loss: 10.771795
KL Loss: 1.748127
Y Loss: 0.841678
T Loss: 10.350956
Epoch 1999 
Overall Loss: 12.526376
Rec Loss: 10.810453
KL Loss: 1.715923
Y Loss: 0.859972
T Loss: 10.380467
Epoch 2049 
Overall Loss: 12.520778
Rec Loss: 10.791995
KL Loss: 1.728784
Y Loss: 0.842232
T Loss: 10.370879
Epoch 2099 
Overall Loss: 12.524975
Rec Loss: 10.795718
KL Loss: 1.729257
Y Loss: 0.859294
T Loss: 10.366071
Epoch 2149 
Overall Loss: 12.522312
Rec Loss: 10.782091
KL Loss: 1.740222
Y Loss: 0.852000
T Loss: 10.356090
Epoch 2199 
Overall Loss: 12.515463
Rec Loss: 10.773133
KL Loss: 1.742330
Y Loss: 0.846383
T Loss: 10.349942
Epoch 2249 
Overall Loss: 12.520846
Rec Loss: 10.777807
KL Loss: 1.743040
Y Loss: 0.847146
T Loss: 10.354234
Epoch 2299 
Overall Loss: 12.501388
Rec Loss: 10.760022
KL Loss: 1.741366
Y Loss: 0.865760
T Loss: 10.327141
Epoch 2349 
Overall Loss: 12.503579
Rec Loss: 10.750345
KL Loss: 1.753234
Y Loss: 0.846362
T Loss: 10.327165
Epoch 2399 
Overall Loss: 12.477744
Rec Loss: 10.758687
KL Loss: 1.719057
Y Loss: 0.839075
T Loss: 10.339149
Epoch 2449 
Overall Loss: 12.490403
Rec Loss: 10.782798
KL Loss: 1.707605
Y Loss: 0.859435
T Loss: 10.353080
Epoch 2499 
Overall Loss: 12.473991
Rec Loss: 10.753813
KL Loss: 1.720178
Y Loss: 0.841296
T Loss: 10.333165
Epoch 2549 
Overall Loss: 12.522442
Rec Loss: 10.784924
KL Loss: 1.737519
Y Loss: 0.856934
T Loss: 10.356457
Epoch 2599 
Overall Loss: 12.479756
Rec Loss: 10.757005
KL Loss: 1.722750
Y Loss: 0.836091
T Loss: 10.338960
Epoch 2649 
Overall Loss: 12.467908
Rec Loss: 10.745335
KL Loss: 1.722574
Y Loss: 0.835593
T Loss: 10.327538
Epoch 2699 
Overall Loss: 12.468973
Rec Loss: 10.735135
KL Loss: 1.733838
Y Loss: 0.838787
T Loss: 10.315742
Epoch 2749 
Overall Loss: 12.459276
Rec Loss: 10.730815
KL Loss: 1.728461
Y Loss: 0.832474
T Loss: 10.314579
Epoch 2799 
Overall Loss: 12.467551
Rec Loss: 10.755366
KL Loss: 1.712184
Y Loss: 0.853925
T Loss: 10.328404
Epoch 2849 
Overall Loss: 12.457848
Rec Loss: 10.736614
KL Loss: 1.721234
Y Loss: 0.840293
T Loss: 10.316467
Epoch 2899 
Overall Loss: 12.474424
Rec Loss: 10.756586
KL Loss: 1.717838
Y Loss: 0.852690
T Loss: 10.330241
Epoch 2949 
Overall Loss: 12.460123
Rec Loss: 10.737837
KL Loss: 1.722285
Y Loss: 0.831361
T Loss: 10.322157
Epoch 2999 
Overall Loss: 12.463714
Rec Loss: 10.741789
KL Loss: 1.721925
Y Loss: 0.834224
T Loss: 10.324677
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.485480
Epoch 99
Rec Loss: 1.468418
Epoch 149
Rec Loss: 1.479591
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.933151
Epoch 99
Rec Loss: 9.927431
Epoch 149
Rec Loss: 9.903753
Epoch 199
Rec Loss: 9.917029
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.687207
Insample Error: 1.881240
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.792294
Rec Loss: 18.824763
KL Loss: 2.967531
Y Loss: 9.371863
T Loss: 13.008880
X Loss: 1.129951
Epoch 99 
Overall Loss: 16.452398
Rec Loss: 13.222169
KL Loss: 3.230229
Y Loss: 3.373776
T Loss: 12.995505
X Loss: -1.460224
Epoch 149 
Overall Loss: 15.695250
Rec Loss: 12.430931
KL Loss: 3.264319
Y Loss: 2.666223
T Loss: 13.081418
X Loss: -1.983598
Epoch 199 
Overall Loss: 15.183562
Rec Loss: 11.863564
KL Loss: 3.319998
Y Loss: 2.276163
T Loss: 12.919554
X Loss: -2.194072
Epoch 249 
Overall Loss: 14.324746
Rec Loss: 10.495250
KL Loss: 3.829496
Y Loss: 1.860647
T Loss: 12.080442
X Loss: -2.515516
Epoch 299 
Overall Loss: 13.880396
Rec Loss: 9.678821
KL Loss: 4.201574
Y Loss: 1.449555
T Loss: 11.725379
X Loss: -2.771334
Epoch 349 
Overall Loss: 13.642085
Rec Loss: 9.346945
KL Loss: 4.295141
Y Loss: 1.212424
T Loss: 11.655443
X Loss: -2.914711
Epoch 399 
Overall Loss: 13.501076
Rec Loss: 9.123431
KL Loss: 4.377645
Y Loss: 1.178937
T Loss: 11.591900
X Loss: -3.057938
Epoch 449 
Overall Loss: 13.374202
Rec Loss: 8.887972
KL Loss: 4.486231
Y Loss: 1.114928
T Loss: 11.514462
X Loss: -3.183954
Epoch 499 
Overall Loss: 13.305962
Rec Loss: 8.738190
KL Loss: 4.567772
Y Loss: 1.113591
T Loss: 11.455446
X Loss: -3.274051
Epoch 549 
Overall Loss: 13.202725
Rec Loss: 8.506035
KL Loss: 4.696691
Y Loss: 1.124631
T Loss: 11.296500
X Loss: -3.352781
Epoch 599 
Overall Loss: 13.070664
Rec Loss: 8.081526
KL Loss: 4.989138
Y Loss: 1.096637
T Loss: 10.994774
X Loss: -3.461566
Epoch 649 
Overall Loss: 13.041493
Rec Loss: 7.906569
KL Loss: 5.134924
Y Loss: 1.079882
T Loss: 10.895138
X Loss: -3.528510
Epoch 699 
Overall Loss: 12.950041
Rec Loss: 7.784658
KL Loss: 5.165382
Y Loss: 1.062177
T Loss: 10.801520
X Loss: -3.547950
Epoch 749 
Overall Loss: 12.903617
Rec Loss: 7.703589
KL Loss: 5.200028
Y Loss: 1.034927
T Loss: 10.764980
X Loss: -3.578855
Epoch 799 
Overall Loss: 12.924542
Rec Loss: 7.709070
KL Loss: 5.215472
Y Loss: 1.054248
T Loss: 10.754979
X Loss: -3.573033
Epoch 849 
Overall Loss: 12.907837
Rec Loss: 7.685124
KL Loss: 5.222713
Y Loss: 1.028310
T Loss: 10.761306
X Loss: -3.590337
Epoch 899 
Overall Loss: 12.892648
Rec Loss: 7.659680
KL Loss: 5.232968
Y Loss: 1.002709
T Loss: 10.760748
X Loss: -3.602422
Epoch 949 
Overall Loss: 12.846783
Rec Loss: 7.613306
KL Loss: 5.233477
Y Loss: 0.995946
T Loss: 10.735132
X Loss: -3.619799
Epoch 999 
Overall Loss: 12.848562
Rec Loss: 7.595226
KL Loss: 5.253336
Y Loss: 0.992045
T Loss: 10.725180
X Loss: -3.625975
Epoch 1049 
Overall Loss: 12.836841
Rec Loss: 7.570048
KL Loss: 5.266792
Y Loss: 0.972719
T Loss: 10.731183
X Loss: -3.647495
Epoch 1099 
Overall Loss: 12.795088
Rec Loss: 7.536988
KL Loss: 5.258100
Y Loss: 0.974397
T Loss: 10.722702
X Loss: -3.672912
Epoch 1149 
Overall Loss: 12.814995
Rec Loss: 7.536119
KL Loss: 5.278876
Y Loss: 0.972180
T Loss: 10.730757
X Loss: -3.680729
Epoch 1199 
Overall Loss: 12.779543
Rec Loss: 7.522728
KL Loss: 5.256815
Y Loss: 0.983949
T Loss: 10.723115
X Loss: -3.692362
Epoch 1249 
Overall Loss: 12.768755
Rec Loss: 7.498119
KL Loss: 5.270637
Y Loss: 0.977888
T Loss: 10.705875
X Loss: -3.696701
Epoch 1299 
Overall Loss: 12.763473
Rec Loss: 7.478059
KL Loss: 5.285415
Y Loss: 0.960144
T Loss: 10.704750
X Loss: -3.706763
Epoch 1349 
Overall Loss: 12.788165
Rec Loss: 7.496648
KL Loss: 5.291517
Y Loss: 0.953114
T Loss: 10.729211
X Loss: -3.709120
Epoch 1399 
Overall Loss: 12.732981
Rec Loss: 7.457919
KL Loss: 5.275063
Y Loss: 0.956246
T Loss: 10.698283
X Loss: -3.718487
Epoch 1449 
Overall Loss: 12.766003
Rec Loss: 7.465475
KL Loss: 5.300528
Y Loss: 0.925145
T Loss: 10.715685
X Loss: -3.712782
Epoch 1499 
Overall Loss: 12.717871
Rec Loss: 7.408912
KL Loss: 5.308958
Y Loss: 0.969348
T Loss: 10.679044
X Loss: -3.754806
Epoch 1549 
Overall Loss: 12.698459
Rec Loss: 7.397873
KL Loss: 5.300587
Y Loss: 0.971701
T Loss: 10.686121
X Loss: -3.774099
Epoch 1599 
Overall Loss: 12.699335
Rec Loss: 7.379484
KL Loss: 5.319852
Y Loss: 0.960698
T Loss: 10.691233
X Loss: -3.792098
Epoch 1649 
Overall Loss: 12.706639
Rec Loss: 7.360521
KL Loss: 5.346118
Y Loss: 0.948811
T Loss: 10.713661
X Loss: -3.827546
Epoch 1699 
Overall Loss: 12.697391
Rec Loss: 7.346954
KL Loss: 5.350437
Y Loss: 0.955103
T Loss: 10.706735
X Loss: -3.837332
Epoch 1749 
Overall Loss: 12.694105
Rec Loss: 7.329648
KL Loss: 5.364457
Y Loss: 0.973965
T Loss: 10.694616
X Loss: -3.851951
Epoch 1799 
Overall Loss: 12.676783
Rec Loss: 7.315724
KL Loss: 5.361059
Y Loss: 0.952674
T Loss: 10.711575
X Loss: -3.872188
Epoch 1849 
Overall Loss: 12.686212
Rec Loss: 7.314887
KL Loss: 5.371325
Y Loss: 0.960194
T Loss: 10.717100
X Loss: -3.882310
Epoch 1899 
Overall Loss: 12.650869
Rec Loss: 7.257311
KL Loss: 5.393558
Y Loss: 0.945880
T Loss: 10.701154
X Loss: -3.916783
Epoch 1949 
Overall Loss: 12.652190
Rec Loss: 7.225675
KL Loss: 5.426515
Y Loss: 0.951685
T Loss: 10.703794
X Loss: -3.953961
Epoch 1999 
Overall Loss: 12.678198
Rec Loss: 7.259830
KL Loss: 5.418368
Y Loss: 0.970011
T Loss: 10.724010
X Loss: -3.949186
Epoch 2049 
Overall Loss: 12.666835
Rec Loss: 7.217341
KL Loss: 5.449494
Y Loss: 0.928099
T Loss: 10.718397
X Loss: -3.965106
Epoch 2099 
Overall Loss: 12.646590
Rec Loss: 7.190302
KL Loss: 5.456287
Y Loss: 0.936104
T Loss: 10.712489
X Loss: -3.990239
Epoch 2149 
Overall Loss: 12.672978
Rec Loss: 7.218236
KL Loss: 5.454741
Y Loss: 0.975004
T Loss: 10.711610
X Loss: -3.980876
Epoch 2199 
Overall Loss: 12.642515
Rec Loss: 7.136905
KL Loss: 5.505610
Y Loss: 0.913757
T Loss: 10.703384
X Loss: -4.023358
Epoch 2249 
Overall Loss: 12.650319
Rec Loss: 7.146123
KL Loss: 5.504196
Y Loss: 0.942918
T Loss: 10.690449
X Loss: -4.015786
Epoch 2299 
Overall Loss: 12.645641
Rec Loss: 7.140129
KL Loss: 5.505512
Y Loss: 0.958528
T Loss: 10.713623
X Loss: -4.052758
Epoch 2349 
Overall Loss: 12.646210
Rec Loss: 7.129574
KL Loss: 5.516636
Y Loss: 0.954662
T Loss: 10.717026
X Loss: -4.064782
Epoch 2399 
Overall Loss: 12.603520
Rec Loss: 7.082081
KL Loss: 5.521439
Y Loss: 0.927385
T Loss: 10.714227
X Loss: -4.095838
Epoch 2449 
Overall Loss: 12.619001
Rec Loss: 7.079746
KL Loss: 5.539255
Y Loss: 0.936390
T Loss: 10.709074
X Loss: -4.097523
Epoch 2499 
Overall Loss: 12.622933
Rec Loss: 7.083869
KL Loss: 5.539064
Y Loss: 0.932257
T Loss: 10.710222
X Loss: -4.092481
Epoch 2549 
Overall Loss: 12.624425
Rec Loss: 7.089982
KL Loss: 5.534443
Y Loss: 0.955327
T Loss: 10.721927
X Loss: -4.109609
Epoch 2599 
Overall Loss: 12.631345
Rec Loss: 7.040238
KL Loss: 5.591107
Y Loss: 0.916185
T Loss: 10.713340
X Loss: -4.131195
Epoch 2649 
Overall Loss: 12.599573
Rec Loss: 7.028629
KL Loss: 5.570944
Y Loss: 0.944359
T Loss: 10.705847
X Loss: -4.149398
Epoch 2699 
Overall Loss: 12.627648
Rec Loss: 7.032735
KL Loss: 5.594913
Y Loss: 0.951298
T Loss: 10.725747
X Loss: -4.168661
Epoch 2749 
Overall Loss: 12.597903
Rec Loss: 7.013552
KL Loss: 5.584351
Y Loss: 0.936005
T Loss: 10.701547
X Loss: -4.155997
Epoch 2799 
Overall Loss: 12.585697
Rec Loss: 6.986789
KL Loss: 5.598908
Y Loss: 0.945367
T Loss: 10.697208
X Loss: -4.183102
Epoch 2849 
Overall Loss: 12.624956
Rec Loss: 7.022168
KL Loss: 5.602788
Y Loss: 0.936734
T Loss: 10.736411
X Loss: -4.182609
Epoch 2899 
Overall Loss: 12.606757
Rec Loss: 6.991628
KL Loss: 5.615129
Y Loss: 0.921430
T Loss: 10.726236
X Loss: -4.195324
Epoch 2949 
Overall Loss: 12.584954
Rec Loss: 6.973558
KL Loss: 5.611396
Y Loss: 0.918474
T Loss: 10.716506
X Loss: -4.202185
Epoch 2999 
Overall Loss: 12.577284
Rec Loss: 6.961837
KL Loss: 5.615447
Y Loss: 0.931745
T Loss: 10.717968
X Loss: -4.222004
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.915892
Epoch 99
Rec Loss: 1.910559
Epoch 149
Rec Loss: 1.921059
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.007664
Epoch 99
Rec Loss: 1.998915
Epoch 149
Rec Loss: 2.001237
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.672730
Insample Error 2.603836
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.596248
Epoch 99 
Prediction Loss: 2.376815
Epoch 149 
Prediction Loss: 2.215601
Epoch 199 
Prediction Loss: 2.148380
Epoch 249 
Prediction Loss: 2.005573
Epoch 299 
Prediction Loss: 1.976330
Epoch 349 
Prediction Loss: 1.853429
Epoch 399 
Prediction Loss: 1.750297
Epoch 449 
Prediction Loss: 1.660936
Epoch 499 
Prediction Loss: 1.598282
Epoch 549 
Prediction Loss: 1.510607
Epoch 599 
Prediction Loss: 1.405147
Epoch 649 
Prediction Loss: 1.387658
Epoch 699 
Prediction Loss: 1.317857
Epoch 749 
Prediction Loss: 1.272445
Epoch 799 
Prediction Loss: 1.255172
Epoch 849 
Prediction Loss: 1.219318
Epoch 899 
Prediction Loss: 1.154114
Epoch 949 
Prediction Loss: 1.128248
Epoch 999 
Prediction Loss: 1.098953
Epoch 1049 
Prediction Loss: 1.067455
Epoch 1099 
Prediction Loss: 1.072003
Epoch 1149 
Prediction Loss: 1.005867
Epoch 1199 
Prediction Loss: 1.017050
Epoch 1249 
Prediction Loss: 0.996531
Epoch 1299 
Prediction Loss: 0.936246
Epoch 1349 
Prediction Loss: 0.932166
Epoch 1399 
Prediction Loss: 0.924532
Epoch 1449 
Prediction Loss: 0.932141
Epoch 1499 
Prediction Loss: 0.919994
Epoch 1549 
Prediction Loss: 0.870242
Epoch 1599 
Prediction Loss: 0.867295
Epoch 1649 
Prediction Loss: 0.856051
Epoch 1699 
Prediction Loss: 0.851232
Epoch 1749 
Prediction Loss: 0.893818
Epoch 1799 
Prediction Loss: 0.814701
Epoch 1849 
Prediction Loss: 0.813356
Epoch 1899 
Prediction Loss: 0.794999
Epoch 1949 
Prediction Loss: 0.802792
Epoch 1999 
Prediction Loss: 0.782410
Epoch 2049 
Prediction Loss: 0.786651
Epoch 2099 
Prediction Loss: 0.783047
Epoch 2149 
Prediction Loss: 0.781413
Epoch 2199 
Prediction Loss: 0.758309
Epoch 2249 
Prediction Loss: 0.755038
Epoch 2299 
Prediction Loss: 0.769678
Epoch 2349 
Prediction Loss: 0.773912
Epoch 2399 
Prediction Loss: 0.765631
Epoch 2449 
Prediction Loss: 0.734662
Epoch 2499 
Prediction Loss: 0.729345
Epoch 2549 
Prediction Loss: 0.725022
Epoch 2599 
Prediction Loss: 0.715890
Epoch 2649 
Prediction Loss: 0.700631
Epoch 2699 
Prediction Loss: 0.718763
Epoch 2749 
Prediction Loss: 0.713088
Epoch 2799 
Prediction Loss: 0.703907
Epoch 2849 
Prediction Loss: 0.709966
Epoch 2899 
Prediction Loss: 0.704314
Epoch 2949 
Prediction Loss: 0.725866
Epoch 2999 
Prediction Loss: 0.700607
Epoch 3049 
Prediction Loss: 0.705858
Epoch 3099 
Prediction Loss: 0.665372
Epoch 3149 
Prediction Loss: 0.680797
Epoch 3199 
Prediction Loss: 0.668518
Epoch 3249 
Prediction Loss: 0.712003
Epoch 3299 
Prediction Loss: 0.663379
Epoch 3349 
Prediction Loss: 0.659919
Epoch 3399 
Prediction Loss: 0.689198
Epoch 3449 
Prediction Loss: 0.666116
Epoch 3499 
Prediction Loss: 0.646905
Epoch 3549 
Prediction Loss: 0.647951
Epoch 3599 
Prediction Loss: 0.667901
Epoch 3649 
Prediction Loss: 0.638901
Epoch 3699 
Prediction Loss: 0.630451
Epoch 3749 
Prediction Loss: 0.636571
Epoch 3799 
Prediction Loss: 0.630833
Epoch 3849 
Prediction Loss: 0.640800
Epoch 3899 
Prediction Loss: 0.621958
Epoch 3949 
Prediction Loss: 0.637390
Epoch 3999 
Prediction Loss: 0.609208
Epoch 4049 
Prediction Loss: 0.627401
Epoch 4099 
Prediction Loss: 0.614425
Epoch 4149 
Prediction Loss: 0.663248
Epoch 4199 
Prediction Loss: 0.620232
Epoch 4249 
Prediction Loss: 0.605131
Epoch 4299 
Prediction Loss: 0.630702
Epoch 4349 
Prediction Loss: 0.621680
Epoch 4399 
Prediction Loss: 0.634392
Epoch 4449 
Prediction Loss: 0.595397
Epoch 4499 
Prediction Loss: 0.601261
Epoch 4549 
Prediction Loss: 0.606508
Epoch 4599 
Prediction Loss: 0.603168
Epoch 4649 
Prediction Loss: 0.608207
Epoch 4699 
Prediction Loss: 0.600295
Epoch 4749 
Prediction Loss: 0.602706
Epoch 4799 
Prediction Loss: 0.590919
Epoch 4849 
Prediction Loss: 0.598010
Epoch 4899 
Prediction Loss: 0.583988
Epoch 4949 
Prediction Loss: 0.587020
Epoch 4999 
Prediction Loss: 0.591970
Epoch 5049 
Prediction Loss: 0.611325
Epoch 5099 
Prediction Loss: 0.596963
Epoch 5149 
Prediction Loss: 0.619252
Epoch 5199 
Prediction Loss: 0.598699
Epoch 5249 
Prediction Loss: 0.576962
Epoch 5299 
Prediction Loss: 0.592070
Epoch 5349 
Prediction Loss: 0.581262
Epoch 5399 
Prediction Loss: 0.604015
Epoch 5449 
Prediction Loss: 0.602766
Epoch 5499 
Prediction Loss: 0.586101
Epoch 5549 
Prediction Loss: 0.578477
Epoch 5599 
Prediction Loss: 0.592846
Epoch 5649 
Prediction Loss: 0.576915
Epoch 5699 
Prediction Loss: 0.577045
Epoch 5749 
Prediction Loss: 0.572187
Epoch 5799 
Prediction Loss: 0.611716
Epoch 5849 
Prediction Loss: 0.603414
Epoch 5899 
Prediction Loss: 0.573122
Epoch 5949 
Prediction Loss: 0.567232
Epoch 5999 
Prediction Loss: 0.594403
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.749283
Insample Error 3.573236
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.054761
Rec Loss: 11.308627
KL Loss: 1.746134
Y Loss: 0.997934
T Loss: 10.809660
Epoch 99 
Overall Loss: 12.855961
Rec Loss: 11.009905
KL Loss: 1.846057
Y Loss: 0.940790
T Loss: 10.539510
Epoch 149 
Overall Loss: 12.781981
Rec Loss: 10.903197
KL Loss: 1.878784
Y Loss: 0.933691
T Loss: 10.436351
Epoch 199 
Overall Loss: 12.757726
Rec Loss: 10.899568
KL Loss: 1.858158
Y Loss: 0.914080
T Loss: 10.442528
Epoch 249 
Overall Loss: 12.712094
Rec Loss: 10.871832
KL Loss: 1.840262
Y Loss: 0.923332
T Loss: 10.410166
Epoch 299 
Overall Loss: 12.696338
Rec Loss: 10.876154
KL Loss: 1.820184
Y Loss: 0.914980
T Loss: 10.418664
Epoch 349 
Overall Loss: 12.689948
Rec Loss: 10.864559
KL Loss: 1.825389
Y Loss: 0.907766
T Loss: 10.410676
Epoch 399 
Overall Loss: 12.678382
Rec Loss: 10.871404
KL Loss: 1.806978
Y Loss: 0.914746
T Loss: 10.414031
Epoch 449 
Overall Loss: 12.659089
Rec Loss: 10.866466
KL Loss: 1.792623
Y Loss: 0.905363
T Loss: 10.413784
Epoch 499 
Overall Loss: 12.671182
Rec Loss: 10.874052
KL Loss: 1.797130
Y Loss: 0.923551
T Loss: 10.412277
Epoch 549 
Overall Loss: 12.621038
Rec Loss: 10.844131
KL Loss: 1.776907
Y Loss: 0.888063
T Loss: 10.400100
Epoch 599 
Overall Loss: 12.649102
Rec Loss: 10.843172
KL Loss: 1.805930
Y Loss: 0.891566
T Loss: 10.397388
Epoch 649 
Overall Loss: 12.674131
Rec Loss: 10.863891
KL Loss: 1.810239
Y Loss: 0.894682
T Loss: 10.416550
Epoch 699 
Overall Loss: 12.643303
Rec Loss: 10.865852
KL Loss: 1.777451
Y Loss: 0.900577
T Loss: 10.415564
Epoch 749 
Overall Loss: 12.629705
Rec Loss: 10.860261
KL Loss: 1.769445
Y Loss: 0.889028
T Loss: 10.415747
Epoch 799 
Overall Loss: 12.622658
Rec Loss: 10.838655
KL Loss: 1.784003
Y Loss: 0.880941
T Loss: 10.398185
Epoch 849 
Overall Loss: 12.605312
Rec Loss: 10.844650
KL Loss: 1.760662
Y Loss: 0.865133
T Loss: 10.412084
Epoch 899 
Overall Loss: 12.592924
Rec Loss: 10.832906
KL Loss: 1.760018
Y Loss: 0.894463
T Loss: 10.385674
Epoch 949 
Overall Loss: 12.604177
Rec Loss: 10.842344
KL Loss: 1.761834
Y Loss: 0.876456
T Loss: 10.404116
Epoch 999 
Overall Loss: 12.602133
Rec Loss: 10.831622
KL Loss: 1.770511
Y Loss: 0.881172
T Loss: 10.391036
Epoch 1049 
Overall Loss: 12.601620
Rec Loss: 10.821543
KL Loss: 1.780077
Y Loss: 0.863104
T Loss: 10.389991
Epoch 1099 
Overall Loss: 12.619751
Rec Loss: 10.836168
KL Loss: 1.783583
Y Loss: 0.871025
T Loss: 10.400655
Epoch 1149 
Overall Loss: 12.584579
Rec Loss: 10.835875
KL Loss: 1.748704
Y Loss: 0.864382
T Loss: 10.403684
Epoch 1199 
Overall Loss: 12.576603
Rec Loss: 10.825134
KL Loss: 1.751469
Y Loss: 0.881636
T Loss: 10.384316
Epoch 1249 
Overall Loss: 12.552425
Rec Loss: 10.826405
KL Loss: 1.726020
Y Loss: 0.863122
T Loss: 10.394844
Epoch 1299 
Overall Loss: 12.587301
Rec Loss: 10.838880
KL Loss: 1.748420
Y Loss: 0.870583
T Loss: 10.403589
Epoch 1349 
Overall Loss: 12.561053
Rec Loss: 10.825961
KL Loss: 1.735093
Y Loss: 0.880446
T Loss: 10.385738
Epoch 1399 
Overall Loss: 12.556740
Rec Loss: 10.812058
KL Loss: 1.744681
Y Loss: 0.865656
T Loss: 10.379230
Epoch 1449 
Overall Loss: 12.555146
Rec Loss: 10.824782
KL Loss: 1.730364
Y Loss: 0.890875
T Loss: 10.379345
Epoch 1499 
Overall Loss: 12.561500
Rec Loss: 10.799328
KL Loss: 1.762172
Y Loss: 0.863653
T Loss: 10.367501
Epoch 1549 
Overall Loss: 12.555086
Rec Loss: 10.812955
KL Loss: 1.742131
Y Loss: 0.871870
T Loss: 10.377020
Epoch 1599 
Overall Loss: 12.543659
Rec Loss: 10.789241
KL Loss: 1.754418
Y Loss: 0.865167
T Loss: 10.356658
Epoch 1649 
Overall Loss: 12.552634
Rec Loss: 10.810877
KL Loss: 1.741757
Y Loss: 0.845168
T Loss: 10.388293
Epoch 1699 
Overall Loss: 12.536793
Rec Loss: 10.790544
KL Loss: 1.746250
Y Loss: 0.870515
T Loss: 10.355286
Epoch 1749 
Overall Loss: 12.542925
Rec Loss: 10.794537
KL Loss: 1.748388
Y Loss: 0.839578
T Loss: 10.374748
Epoch 1799 
Overall Loss: 12.525164
Rec Loss: 10.809527
KL Loss: 1.715637
Y Loss: 0.866779
T Loss: 10.376137
Epoch 1849 
Overall Loss: 12.517217
Rec Loss: 10.792585
KL Loss: 1.724632
Y Loss: 0.840701
T Loss: 10.372235
Epoch 1899 
Overall Loss: 12.556825
Rec Loss: 10.796304
KL Loss: 1.760521
Y Loss: 0.861893
T Loss: 10.365358
Epoch 1949 
Overall Loss: 12.533441
Rec Loss: 10.800614
KL Loss: 1.732827
Y Loss: 0.852326
T Loss: 10.374451
Epoch 1999 
Overall Loss: 12.499518
Rec Loss: 10.770369
KL Loss: 1.729150
Y Loss: 0.840583
T Loss: 10.350077
Epoch 2049 
Overall Loss: 12.499387
Rec Loss: 10.765732
KL Loss: 1.733655
Y Loss: 0.847895
T Loss: 10.341784
Epoch 2099 
Overall Loss: 12.487332
Rec Loss: 10.770857
KL Loss: 1.716475
Y Loss: 0.848451
T Loss: 10.346632
Epoch 2149 
Overall Loss: 12.509694
Rec Loss: 10.782973
KL Loss: 1.726721
Y Loss: 0.838367
T Loss: 10.363790
Epoch 2199 
Overall Loss: 12.474671
Rec Loss: 10.762277
KL Loss: 1.712395
Y Loss: 0.859933
T Loss: 10.332310
Epoch 2249 
Overall Loss: 12.493191
Rec Loss: 10.756734
KL Loss: 1.736457
Y Loss: 0.848319
T Loss: 10.332575
Epoch 2299 
Overall Loss: 12.484718
Rec Loss: 10.756667
KL Loss: 1.728050
Y Loss: 0.851252
T Loss: 10.331041
Epoch 2349 
Overall Loss: 12.504927
Rec Loss: 10.765732
KL Loss: 1.739195
Y Loss: 0.841151
T Loss: 10.345156
Epoch 2399 
Overall Loss: 12.476272
Rec Loss: 10.744614
KL Loss: 1.731658
Y Loss: 0.837567
T Loss: 10.325831
Epoch 2449 
Overall Loss: 12.476989
Rec Loss: 10.754110
KL Loss: 1.722879
Y Loss: 0.835347
T Loss: 10.336436
Epoch 2499 
Overall Loss: 12.490187
Rec Loss: 10.752981
KL Loss: 1.737206
Y Loss: 0.838086
T Loss: 10.333938
Epoch 2549 
Overall Loss: 12.480162
Rec Loss: 10.740320
KL Loss: 1.739842
Y Loss: 0.844175
T Loss: 10.318233
Epoch 2599 
Overall Loss: 12.500544
Rec Loss: 10.753975
KL Loss: 1.746569
Y Loss: 0.867858
T Loss: 10.320046
Epoch 2649 
Overall Loss: 12.453456
Rec Loss: 10.734783
KL Loss: 1.718673
Y Loss: 0.832207
T Loss: 10.318679
Epoch 2699 
Overall Loss: 12.477906
Rec Loss: 10.758394
KL Loss: 1.719512
Y Loss: 0.869014
T Loss: 10.323887
Epoch 2749 
Overall Loss: 12.463747
Rec Loss: 10.746725
KL Loss: 1.717022
Y Loss: 0.845376
T Loss: 10.324036
Epoch 2799 
Overall Loss: 12.455718
Rec Loss: 10.728006
KL Loss: 1.727713
Y Loss: 0.849746
T Loss: 10.303133
Epoch 2849 
Overall Loss: 12.469352
Rec Loss: 10.765069
KL Loss: 1.704284
Y Loss: 0.875005
T Loss: 10.327566
Epoch 2899 
Overall Loss: 12.448037
Rec Loss: 10.731312
KL Loss: 1.716725
Y Loss: 0.851243
T Loss: 10.305691
Epoch 2949 
Overall Loss: 12.436527
Rec Loss: 10.734942
KL Loss: 1.701585
Y Loss: 0.837295
T Loss: 10.316295
Epoch 2999 
Overall Loss: 12.456139
Rec Loss: 10.728027
KL Loss: 1.728112
Y Loss: 0.838487
T Loss: 10.308784
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.467262
Epoch 99
Rec Loss: 1.471701
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.924917
Epoch 99
Rec Loss: 9.918575
Epoch 149
Rec Loss: 9.907242
Epoch 199
Rec Loss: 9.901043
Epoch 249
Rec Loss: 9.899864
Epoch 299
Rec Loss: 9.892565
Epoch 349
Rec Loss: 9.883409
Epoch 399
Rec Loss: 9.881594
Epoch 449
Rec Loss: 9.887650
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.689373
Insample Error: 1.905622
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.506346
Rec Loss: 18.369319
KL Loss: 3.137028
Y Loss: 8.809697
T Loss: 12.892676
X Loss: 1.071794
Epoch 99 
Overall Loss: 16.413792
Rec Loss: 12.946465
KL Loss: 3.467327
Y Loss: 2.725701
T Loss: 12.810812
X Loss: -1.227198
Epoch 149 
Overall Loss: 15.072843
Rec Loss: 11.445231
KL Loss: 3.627612
Y Loss: 1.780801
T Loss: 12.574968
X Loss: -2.020137
Epoch 199 
Overall Loss: 14.446559
Rec Loss: 10.614321
KL Loss: 3.832238
Y Loss: 1.280303
T Loss: 12.422966
X Loss: -2.448797
Epoch 249 
Overall Loss: 14.114126
Rec Loss: 10.136635
KL Loss: 3.977492
Y Loss: 1.109067
T Loss: 12.274361
X Loss: -2.692260
Epoch 299 
Overall Loss: 13.886294
Rec Loss: 9.773920
KL Loss: 4.112375
Y Loss: 1.008817
T Loss: 12.138155
X Loss: -2.868644
Epoch 349 
Overall Loss: 13.760229
Rec Loss: 9.517133
KL Loss: 4.243096
Y Loss: 0.985927
T Loss: 12.017752
X Loss: -2.993582
Epoch 399 
Overall Loss: 13.609205
Rec Loss: 9.285815
KL Loss: 4.323389
Y Loss: 0.926486
T Loss: 11.930326
X Loss: -3.107754
Epoch 449 
Overall Loss: 13.524917
Rec Loss: 9.055718
KL Loss: 4.469199
Y Loss: 0.932661
T Loss: 11.802985
X Loss: -3.213598
Epoch 499 
Overall Loss: 13.419006
Rec Loss: 8.725556
KL Loss: 4.693450
Y Loss: 0.928023
T Loss: 11.616282
X Loss: -3.354737
Epoch 549 
Overall Loss: 13.323916
Rec Loss: 8.500329
KL Loss: 4.823587
Y Loss: 0.944505
T Loss: 11.507493
X Loss: -3.479417
Epoch 599 
Overall Loss: 13.249391
Rec Loss: 8.332474
KL Loss: 4.916918
Y Loss: 0.939131
T Loss: 11.438298
X Loss: -3.575390
Epoch 649 
Overall Loss: 13.214803
Rec Loss: 8.260195
KL Loss: 4.954608
Y Loss: 0.960508
T Loss: 11.382114
X Loss: -3.602173
Epoch 699 
Overall Loss: 13.156978
Rec Loss: 8.149552
KL Loss: 5.007426
Y Loss: 0.934668
T Loss: 11.326567
X Loss: -3.644349
Epoch 749 
Overall Loss: 13.093423
Rec Loss: 7.980610
KL Loss: 5.112813
Y Loss: 0.936212
T Loss: 11.213684
X Loss: -3.701180
Epoch 799 
Overall Loss: 12.976592
Rec Loss: 7.660997
KL Loss: 5.315595
Y Loss: 0.928778
T Loss: 10.955097
X Loss: -3.758489
Epoch 849 
Overall Loss: 12.910945
Rec Loss: 7.449711
KL Loss: 5.461234
Y Loss: 0.890822
T Loss: 10.820907
X Loss: -3.816608
Epoch 899 
Overall Loss: 12.890380
Rec Loss: 7.376473
KL Loss: 5.513906
Y Loss: 0.894598
T Loss: 10.791966
X Loss: -3.862792
Epoch 949 
Overall Loss: 12.861136
Rec Loss: 7.323452
KL Loss: 5.537684
Y Loss: 0.901971
T Loss: 10.760966
X Loss: -3.888501
Epoch 999 
Overall Loss: 12.837171
Rec Loss: 7.260895
KL Loss: 5.576276
Y Loss: 0.887600
T Loss: 10.737894
X Loss: -3.920799
Epoch 1049 
Overall Loss: 12.856289
Rec Loss: 7.263785
KL Loss: 5.592504
Y Loss: 0.912827
T Loss: 10.743825
X Loss: -3.936454
Epoch 1099 
Overall Loss: 12.799970
Rec Loss: 7.209112
KL Loss: 5.590858
Y Loss: 0.923450
T Loss: 10.723605
X Loss: -3.976217
Epoch 1149 
Overall Loss: 12.811726
Rec Loss: 7.169597
KL Loss: 5.642129
Y Loss: 0.890436
T Loss: 10.743415
X Loss: -4.019036
Epoch 1199 
Overall Loss: 12.748219
Rec Loss: 7.101473
KL Loss: 5.646747
Y Loss: 0.912284
T Loss: 10.700330
X Loss: -4.054999
Epoch 1249 
Overall Loss: 12.771501
Rec Loss: 7.122397
KL Loss: 5.649103
Y Loss: 0.892495
T Loss: 10.726355
X Loss: -4.050205
Epoch 1299 
Overall Loss: 12.775442
Rec Loss: 7.112297
KL Loss: 5.663145
Y Loss: 0.922017
T Loss: 10.725547
X Loss: -4.074258
Epoch 1349 
Overall Loss: 12.757790
Rec Loss: 7.082006
KL Loss: 5.675784
Y Loss: 0.911555
T Loss: 10.733631
X Loss: -4.107402
Epoch 1399 
Overall Loss: 12.728485
Rec Loss: 7.031839
KL Loss: 5.696646
Y Loss: 0.902113
T Loss: 10.715424
X Loss: -4.134641
Epoch 1449 
Overall Loss: 12.723758
Rec Loss: 7.022474
KL Loss: 5.701284
Y Loss: 0.904049
T Loss: 10.719364
X Loss: -4.148914
Epoch 1499 
Overall Loss: 12.731167
Rec Loss: 6.983450
KL Loss: 5.747717
Y Loss: 0.899375
T Loss: 10.705380
X Loss: -4.171617
Epoch 1549 
Overall Loss: 12.713877
Rec Loss: 6.956251
KL Loss: 5.757626
Y Loss: 0.898527
T Loss: 10.697099
X Loss: -4.190111
Epoch 1599 
Overall Loss: 12.719906
Rec Loss: 6.977242
KL Loss: 5.742664
Y Loss: 0.898659
T Loss: 10.722719
X Loss: -4.194806
Epoch 1649 
Overall Loss: 12.721017
Rec Loss: 6.947868
KL Loss: 5.773149
Y Loss: 0.889647
T Loss: 10.725924
X Loss: -4.222880
Epoch 1699 
Overall Loss: 12.698937
Rec Loss: 6.922708
KL Loss: 5.776230
Y Loss: 0.882120
T Loss: 10.732547
X Loss: -4.250899
Epoch 1749 
Overall Loss: 12.673781
Rec Loss: 6.879100
KL Loss: 5.794681
Y Loss: 0.913424
T Loss: 10.719911
X Loss: -4.297522
Epoch 1799 
Overall Loss: 12.693396
Rec Loss: 6.917360
KL Loss: 5.776036
Y Loss: 0.910710
T Loss: 10.725199
X Loss: -4.263194
Epoch 1849 
Overall Loss: 12.659683
Rec Loss: 6.863775
KL Loss: 5.795909
Y Loss: 0.890651
T Loss: 10.729847
X Loss: -4.311398
Epoch 1899 
Overall Loss: 12.703058
Rec Loss: 6.904530
KL Loss: 5.798529
Y Loss: 0.929694
T Loss: 10.729082
X Loss: -4.289399
Epoch 1949 
Overall Loss: 12.636104
Rec Loss: 6.809843
KL Loss: 5.826261
Y Loss: 0.901615
T Loss: 10.708372
X Loss: -4.349336
Epoch 1999 
Overall Loss: 12.680875
Rec Loss: 6.841100
KL Loss: 5.839775
Y Loss: 0.901358
T Loss: 10.733249
X Loss: -4.342828
Epoch 2049 
Overall Loss: 12.663047
Rec Loss: 6.822143
KL Loss: 5.840904
Y Loss: 0.922709
T Loss: 10.736577
X Loss: -4.375788
Epoch 2099 
Overall Loss: 12.622940
Rec Loss: 6.771483
KL Loss: 5.851457
Y Loss: 0.896933
T Loss: 10.735742
X Loss: -4.412725
Epoch 2149 
Overall Loss: 12.627906
Rec Loss: 6.765847
KL Loss: 5.862060
Y Loss: 0.900784
T Loss: 10.716883
X Loss: -4.401429
Epoch 2199 
Overall Loss: 12.671505
Rec Loss: 6.778630
KL Loss: 5.892875
Y Loss: 0.912110
T Loss: 10.733577
X Loss: -4.411002
Epoch 2249 
Overall Loss: 12.657438
Rec Loss: 6.771418
KL Loss: 5.886020
Y Loss: 0.918491
T Loss: 10.724995
X Loss: -4.412823
Epoch 2299 
Overall Loss: 12.653503
Rec Loss: 6.745854
KL Loss: 5.907649
Y Loss: 0.911875
T Loss: 10.736283
X Loss: -4.446366
Epoch 2349 
Overall Loss: 12.663877
Rec Loss: 6.743484
KL Loss: 5.920394
Y Loss: 0.922783
T Loss: 10.744328
X Loss: -4.462236
Epoch 2399 
Overall Loss: 12.620055
Rec Loss: 6.696535
KL Loss: 5.923520
Y Loss: 0.915562
T Loss: 10.743843
X Loss: -4.505089
Epoch 2449 
Overall Loss: 12.622736
Rec Loss: 6.673460
KL Loss: 5.949276
Y Loss: 0.925702
T Loss: 10.728251
X Loss: -4.517642
Epoch 2499 
Overall Loss: 12.673755
Rec Loss: 6.732417
KL Loss: 5.941338
Y Loss: 0.916820
T Loss: 10.742811
X Loss: -4.468804
Epoch 2549 
Overall Loss: 12.621482
Rec Loss: 6.681454
KL Loss: 5.940028
Y Loss: 0.925208
T Loss: 10.734887
X Loss: -4.516037
Epoch 2599 
Overall Loss: 12.635077
Rec Loss: 6.690234
KL Loss: 5.944843
Y Loss: 0.921214
T Loss: 10.752921
X Loss: -4.523294
Epoch 2649 
Overall Loss: 12.606240
Rec Loss: 6.647348
KL Loss: 5.958892
Y Loss: 0.924526
T Loss: 10.740257
X Loss: -4.555172
Epoch 2699 
Overall Loss: 12.613560
Rec Loss: 6.653259
KL Loss: 5.960302
Y Loss: 0.921927
T Loss: 10.737534
X Loss: -4.545239
Epoch 2749 
Overall Loss: 12.605948
Rec Loss: 6.626353
KL Loss: 5.979595
Y Loss: 0.912167
T Loss: 10.730750
X Loss: -4.560481
Epoch 2799 
Overall Loss: 12.609850
Rec Loss: 6.602960
KL Loss: 6.006889
Y Loss: 0.907148
T Loss: 10.740652
X Loss: -4.591266
Epoch 2849 
Overall Loss: 12.615661
Rec Loss: 6.626459
KL Loss: 5.989202
Y Loss: 0.914293
T Loss: 10.748729
X Loss: -4.579417
Epoch 2899 
Overall Loss: 12.604961
Rec Loss: 6.629851
KL Loss: 5.975109
Y Loss: 0.931969
T Loss: 10.753967
X Loss: -4.590100
Epoch 2949 
Overall Loss: 12.632776
Rec Loss: 6.605687
KL Loss: 6.027089
Y Loss: 0.929844
T Loss: 10.748291
X Loss: -4.607527
Epoch 2999 
Overall Loss: 12.620231
Rec Loss: 6.595199
KL Loss: 6.025032
Y Loss: 0.921558
T Loss: 10.742234
X Loss: -4.607814
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.793672
Epoch 99
Rec Loss: 1.789900
Epoch 149
Rec Loss: 1.802396
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.012525
Epoch 99
Rec Loss: 2.005004
Epoch 149
Rec Loss: 2.006913
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.662345
Insample Error 2.482530
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.506691
Epoch 99 
Prediction Loss: 2.337848
Epoch 149 
Prediction Loss: 2.241114
Epoch 199 
Prediction Loss: 2.144621
Epoch 249 
Prediction Loss: 2.020768
Epoch 299 
Prediction Loss: 1.972719
Epoch 349 
Prediction Loss: 1.823403
Epoch 399 
Prediction Loss: 1.729531
Epoch 449 
Prediction Loss: 1.719629
Epoch 499 
Prediction Loss: 1.571792
Epoch 549 
Prediction Loss: 1.475531
Epoch 599 
Prediction Loss: 1.414477
Epoch 649 
Prediction Loss: 1.382210
Epoch 699 
Prediction Loss: 1.290323
Epoch 749 
Prediction Loss: 1.277404
Epoch 799 
Prediction Loss: 1.197402
Epoch 849 
Prediction Loss: 1.164087
Epoch 899 
Prediction Loss: 1.115229
Epoch 949 
Prediction Loss: 1.108047
Epoch 999 
Prediction Loss: 1.061718
Epoch 1049 
Prediction Loss: 1.039905
Epoch 1099 
Prediction Loss: 1.008629
Epoch 1149 
Prediction Loss: 0.986022
Epoch 1199 
Prediction Loss: 0.987288
Epoch 1249 
Prediction Loss: 1.034186
Epoch 1299 
Prediction Loss: 0.966605
Epoch 1349 
Prediction Loss: 0.904775
Epoch 1399 
Prediction Loss: 0.917722
Epoch 1449 
Prediction Loss: 0.919999
Epoch 1499 
Prediction Loss: 0.874493
Epoch 1549 
Prediction Loss: 0.870450
Epoch 1599 
Prediction Loss: 0.856435
Epoch 1649 
Prediction Loss: 0.830993
Epoch 1699 
Prediction Loss: 0.836164
Epoch 1749 
Prediction Loss: 0.829539
Epoch 1799 
Prediction Loss: 0.800749
Epoch 1849 
Prediction Loss: 0.790867
Epoch 1899 
Prediction Loss: 0.793227
Epoch 1949 
Prediction Loss: 0.784498
Epoch 1999 
Prediction Loss: 0.765761
Epoch 2049 
Prediction Loss: 0.783952
Epoch 2099 
Prediction Loss: 0.786688
Epoch 2149 
Prediction Loss: 0.754440
Epoch 2199 
Prediction Loss: 0.748486
Epoch 2249 
Prediction Loss: 0.758085
Epoch 2299 
Prediction Loss: 0.721462
Epoch 2349 
Prediction Loss: 0.726879
Epoch 2399 
Prediction Loss: 0.705740
Epoch 2449 
Prediction Loss: 0.729328
Epoch 2499 
Prediction Loss: 0.727419
Epoch 2549 
Prediction Loss: 0.781121
Epoch 2599 
Prediction Loss: 0.707194
Epoch 2649 
Prediction Loss: 0.691529
Epoch 2699 
Prediction Loss: 0.692622
Epoch 2749 
Prediction Loss: 0.697904
Epoch 2799 
Prediction Loss: 0.704539
Epoch 2849 
Prediction Loss: 0.693602
Epoch 2899 
Prediction Loss: 0.680052
Epoch 2949 
Prediction Loss: 0.671836
Epoch 2999 
Prediction Loss: 0.697176
Epoch 3049 
Prediction Loss: 0.653691
Epoch 3099 
Prediction Loss: 0.652340
Epoch 3149 
Prediction Loss: 0.656474
Epoch 3199 
Prediction Loss: 0.667043
Epoch 3249 
Prediction Loss: 0.655049
Epoch 3299 
Prediction Loss: 0.662849
Epoch 3349 
Prediction Loss: 0.634836
Epoch 3399 
Prediction Loss: 0.638837
Epoch 3449 
Prediction Loss: 0.643995
Epoch 3499 
Prediction Loss: 0.629675
Epoch 3549 
Prediction Loss: 0.641778
Epoch 3599 
Prediction Loss: 0.623092
Epoch 3649 
Prediction Loss: 0.679169
Epoch 3699 
Prediction Loss: 0.611425
Epoch 3749 
Prediction Loss: 0.612011
Epoch 3799 
Prediction Loss: 0.617514
Epoch 3849 
Prediction Loss: 0.628227
Epoch 3899 
Prediction Loss: 0.619904
Epoch 3949 
Prediction Loss: 0.610197
Epoch 3999 
Prediction Loss: 0.602311
Epoch 4049 
Prediction Loss: 0.632319
Epoch 4099 
Prediction Loss: 0.603608
Epoch 4149 
Prediction Loss: 0.617318
Epoch 4199 
Prediction Loss: 0.592032
Epoch 4249 
Prediction Loss: 0.623261
Epoch 4299 
Prediction Loss: 0.582380
Epoch 4349 
Prediction Loss: 0.605162
Epoch 4399 
Prediction Loss: 0.596629
Epoch 4449 
Prediction Loss: 0.589235
Epoch 4499 
Prediction Loss: 0.593684
Epoch 4549 
Prediction Loss: 0.619553
Epoch 4599 
Prediction Loss: 0.581045
Epoch 4649 
Prediction Loss: 0.575448
Epoch 4699 
Prediction Loss: 0.584168
Epoch 4749 
Prediction Loss: 0.580079
Epoch 4799 
Prediction Loss: 0.579519
Epoch 4849 
Prediction Loss: 0.555526
Epoch 4899 
Prediction Loss: 0.580146
Epoch 4949 
Prediction Loss: 0.584685
Epoch 4999 
Prediction Loss: 0.583165
Epoch 5049 
Prediction Loss: 0.552875
Epoch 5099 
Prediction Loss: 0.566529
Epoch 5149 
Prediction Loss: 0.570858
Epoch 5199 
Prediction Loss: 0.553192
Epoch 5249 
Prediction Loss: 0.591615
Epoch 5299 
Prediction Loss: 0.562774
Epoch 5349 
Prediction Loss: 0.566011
Epoch 5399 
Prediction Loss: 0.548217
Epoch 5449 
Prediction Loss: 0.560814
Epoch 5499 
Prediction Loss: 0.551386
Epoch 5549 
Prediction Loss: 0.543289
Epoch 5599 
Prediction Loss: 0.560744
Epoch 5649 
Prediction Loss: 0.557926
Epoch 5699 
Prediction Loss: 0.542137
Epoch 5749 
Prediction Loss: 0.541746
Epoch 5799 
Prediction Loss: 0.555095
Epoch 5849 
Prediction Loss: 0.567101
Epoch 5899 
Prediction Loss: 0.557404
Epoch 5949 
Prediction Loss: 0.540178
Epoch 5999 
Prediction Loss: 0.562226
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.725639
Insample Error 3.609327
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.037327
Rec Loss: 11.271574
KL Loss: 1.765753
Y Loss: 1.016080
T Loss: 10.763534
Epoch 99 
Overall Loss: 12.900096
Rec Loss: 11.209849
KL Loss: 1.690246
Y Loss: 0.918903
T Loss: 10.750398
Epoch 149 
Overall Loss: 12.822905
Rec Loss: 11.204607
KL Loss: 1.618298
Y Loss: 0.955348
T Loss: 10.726933
Epoch 199 
Overall Loss: 12.707146
Rec Loss: 10.917065
KL Loss: 1.790081
Y Loss: 0.913239
T Loss: 10.460446
Epoch 249 
Overall Loss: 12.700996
Rec Loss: 10.922272
KL Loss: 1.778724
Y Loss: 0.921906
T Loss: 10.461319
Epoch 299 
Overall Loss: 12.708445
Rec Loss: 10.905818
KL Loss: 1.802627
Y Loss: 0.947407
T Loss: 10.432114
Epoch 349 
Overall Loss: 12.667832
Rec Loss: 10.887527
KL Loss: 1.780305
Y Loss: 0.928931
T Loss: 10.423061
Epoch 399 
Overall Loss: 12.666925
Rec Loss: 10.892610
KL Loss: 1.774315
Y Loss: 0.925655
T Loss: 10.429782
Epoch 449 
Overall Loss: 12.652820
Rec Loss: 10.885885
KL Loss: 1.766935
Y Loss: 0.926590
T Loss: 10.422590
Epoch 499 
Overall Loss: 12.645980
Rec Loss: 10.854772
KL Loss: 1.791209
Y Loss: 0.891389
T Loss: 10.409078
Epoch 549 
Overall Loss: 12.658937
Rec Loss: 10.883520
KL Loss: 1.775417
Y Loss: 0.915795
T Loss: 10.425622
Epoch 599 
Overall Loss: 12.646041
Rec Loss: 10.864925
KL Loss: 1.781116
Y Loss: 0.879076
T Loss: 10.425387
Epoch 649 
Overall Loss: 12.635609
Rec Loss: 10.879155
KL Loss: 1.756454
Y Loss: 0.895014
T Loss: 10.431648
Epoch 699 
Overall Loss: 12.614572
Rec Loss: 10.853199
KL Loss: 1.761373
Y Loss: 0.876051
T Loss: 10.415173
Epoch 749 
Overall Loss: 12.636701
Rec Loss: 10.853725
KL Loss: 1.782976
Y Loss: 0.887626
T Loss: 10.409912
Epoch 799 
Overall Loss: 12.630531
Rec Loss: 10.862374
KL Loss: 1.768156
Y Loss: 0.864400
T Loss: 10.430174
Epoch 849 
Overall Loss: 12.624888
Rec Loss: 10.858135
KL Loss: 1.766753
Y Loss: 0.914667
T Loss: 10.400801
Epoch 899 
Overall Loss: 12.605315
Rec Loss: 10.844566
KL Loss: 1.760749
Y Loss: 0.903890
T Loss: 10.392621
Epoch 949 
Overall Loss: 12.609494
Rec Loss: 10.850011
KL Loss: 1.759483
Y Loss: 0.882408
T Loss: 10.408807
Epoch 999 
Overall Loss: 12.607262
Rec Loss: 10.850175
KL Loss: 1.757087
Y Loss: 0.877869
T Loss: 10.411240
Epoch 1049 
Overall Loss: 12.601861
Rec Loss: 10.846694
KL Loss: 1.755167
Y Loss: 0.890259
T Loss: 10.401564
Epoch 1099 
Overall Loss: 12.572066
Rec Loss: 10.831696
KL Loss: 1.740370
Y Loss: 0.853715
T Loss: 10.404838
Epoch 1149 
Overall Loss: 12.587251
Rec Loss: 10.824389
KL Loss: 1.762862
Y Loss: 0.876843
T Loss: 10.385968
Epoch 1199 
Overall Loss: 12.574406
Rec Loss: 10.809279
KL Loss: 1.765127
Y Loss: 0.873459
T Loss: 10.372550
Epoch 1249 
Overall Loss: 12.570089
Rec Loss: 10.815413
KL Loss: 1.754677
Y Loss: 0.869927
T Loss: 10.380449
Epoch 1299 
Overall Loss: 12.571391
Rec Loss: 10.822219
KL Loss: 1.749172
Y Loss: 0.885559
T Loss: 10.379440
Epoch 1349 
Overall Loss: 12.577173
Rec Loss: 10.843950
KL Loss: 1.733223
Y Loss: 0.882591
T Loss: 10.402655
Epoch 1399 
Overall Loss: 12.548860
Rec Loss: 10.831170
KL Loss: 1.717690
Y Loss: 0.875218
T Loss: 10.393561
Epoch 1449 
Overall Loss: 12.573393
Rec Loss: 10.832978
KL Loss: 1.740416
Y Loss: 0.880995
T Loss: 10.392480
Epoch 1499 
Overall Loss: 12.525766
Rec Loss: 10.788476
KL Loss: 1.737291
Y Loss: 0.862991
T Loss: 10.356980
Epoch 1549 
Overall Loss: 12.554991
Rec Loss: 10.784111
KL Loss: 1.770880
Y Loss: 0.845050
T Loss: 10.361586
Epoch 1599 
Overall Loss: 12.540494
Rec Loss: 10.804891
KL Loss: 1.735603
Y Loss: 0.859069
T Loss: 10.375356
Epoch 1649 
Overall Loss: 12.549543
Rec Loss: 10.812873
KL Loss: 1.736670
Y Loss: 0.855393
T Loss: 10.385177
Epoch 1699 
Overall Loss: 12.532106
Rec Loss: 10.807716
KL Loss: 1.724390
Y Loss: 0.860906
T Loss: 10.377263
Epoch 1749 
Overall Loss: 12.559726
Rec Loss: 10.793439
KL Loss: 1.766287
Y Loss: 0.861764
T Loss: 10.362557
Epoch 1799 
Overall Loss: 12.517004
Rec Loss: 10.786461
KL Loss: 1.730543
Y Loss: 0.841182
T Loss: 10.365870
Epoch 1849 
Overall Loss: 12.524997
Rec Loss: 10.794397
KL Loss: 1.730600
Y Loss: 0.877914
T Loss: 10.355441
Epoch 1899 
Overall Loss: 12.523753
Rec Loss: 10.783319
KL Loss: 1.740434
Y Loss: 0.862009
T Loss: 10.352315
Epoch 1949 
Overall Loss: 12.538049
Rec Loss: 10.789641
KL Loss: 1.748408
Y Loss: 0.858734
T Loss: 10.360274
Epoch 1999 
Overall Loss: 12.515465
Rec Loss: 10.791181
KL Loss: 1.724284
Y Loss: 0.850929
T Loss: 10.365717
Epoch 2049 
Overall Loss: 12.512534
Rec Loss: 10.759737
KL Loss: 1.752797
Y Loss: 0.837514
T Loss: 10.340980
Epoch 2099 
Overall Loss: 12.520791
Rec Loss: 10.784330
KL Loss: 1.736461
Y Loss: 0.841129
T Loss: 10.363765
Epoch 2149 
Overall Loss: 12.484071
Rec Loss: 10.772033
KL Loss: 1.712038
Y Loss: 0.851213
T Loss: 10.346426
Epoch 2199 
Overall Loss: 12.486986
Rec Loss: 10.784414
KL Loss: 1.702572
Y Loss: 0.847464
T Loss: 10.360683
Epoch 2249 
Overall Loss: 12.518489
Rec Loss: 10.774242
KL Loss: 1.744247
Y Loss: 0.856054
T Loss: 10.346215
Epoch 2299 
Overall Loss: 12.495741
Rec Loss: 10.770827
KL Loss: 1.724914
Y Loss: 0.850970
T Loss: 10.345342
Epoch 2349 
Overall Loss: 12.493434
Rec Loss: 10.767592
KL Loss: 1.725842
Y Loss: 0.857457
T Loss: 10.338863
Epoch 2399 
Overall Loss: 12.487270
Rec Loss: 10.747960
KL Loss: 1.739311
Y Loss: 0.851660
T Loss: 10.322130
Epoch 2449 
Overall Loss: 12.480017
Rec Loss: 10.737978
KL Loss: 1.742040
Y Loss: 0.848182
T Loss: 10.313887
Epoch 2499 
Overall Loss: 12.486358
Rec Loss: 10.765435
KL Loss: 1.720924
Y Loss: 0.850420
T Loss: 10.340225
Epoch 2549 
Overall Loss: 12.499284
Rec Loss: 10.765259
KL Loss: 1.734025
Y Loss: 0.839644
T Loss: 10.345437
Epoch 2599 
Overall Loss: 12.488632
Rec Loss: 10.761371
KL Loss: 1.727261
Y Loss: 0.846741
T Loss: 10.338000
Epoch 2649 
Overall Loss: 12.472819
Rec Loss: 10.773761
KL Loss: 1.699057
Y Loss: 0.850384
T Loss: 10.348569
Epoch 2699 
Overall Loss: 12.493105
Rec Loss: 10.759473
KL Loss: 1.733633
Y Loss: 0.832946
T Loss: 10.342999
Epoch 2749 
Overall Loss: 12.496212
Rec Loss: 10.762598
KL Loss: 1.733614
Y Loss: 0.855115
T Loss: 10.335040
Epoch 2799 
Overall Loss: 12.467704
Rec Loss: 10.748234
KL Loss: 1.719470
Y Loss: 0.869624
T Loss: 10.313421
Epoch 2849 
Overall Loss: 12.465003
Rec Loss: 10.763741
KL Loss: 1.701262
Y Loss: 0.853280
T Loss: 10.337101
Epoch 2899 
Overall Loss: 12.479130
Rec Loss: 10.748024
KL Loss: 1.731106
Y Loss: 0.882546
T Loss: 10.306751
Epoch 2949 
Overall Loss: 12.442039
Rec Loss: 10.727723
KL Loss: 1.714317
Y Loss: 0.839032
T Loss: 10.308207
Epoch 2999 
Overall Loss: 12.460543
Rec Loss: 10.723091
KL Loss: 1.737452
Y Loss: 0.830176
T Loss: 10.308003
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.477934
Epoch 99
Rec Loss: 1.464178
Epoch 149
Rec Loss: 1.454914
Epoch 199
Rec Loss: 1.470079
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.920654
Epoch 99
Rec Loss: 9.908171
Epoch 149
Rec Loss: 9.897537
Epoch 199
Rec Loss: 9.890923
Epoch 249
Rec Loss: 9.901949
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.689956
Insample Error: 1.863454
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.334742
Rec Loss: 19.798589
KL Loss: 2.536153
Y Loss: 10.280926
T Loss: 13.319373
X Loss: 1.338752
Epoch 99 
Overall Loss: 16.718430
Rec Loss: 13.277514
KL Loss: 3.440916
Y Loss: 2.823657
T Loss: 12.944379
X Loss: -1.078693
Epoch 149 
Overall Loss: 15.555078
Rec Loss: 12.242994
KL Loss: 3.312084
Y Loss: 1.990660
T Loss: 12.919456
X Loss: -1.671792
Epoch 199 
Overall Loss: 14.746006
Rec Loss: 11.335543
KL Loss: 3.410464
Y Loss: 1.386844
T Loss: 12.744412
X Loss: -2.102291
Epoch 249 
Overall Loss: 14.388980
Rec Loss: 10.786157
KL Loss: 3.602823
Y Loss: 1.044825
T Loss: 12.635915
X Loss: -2.372171
Epoch 299 
Overall Loss: 14.089409
Rec Loss: 10.304470
KL Loss: 3.784939
Y Loss: 1.000420
T Loss: 12.452453
X Loss: -2.648193
Epoch 349 
Overall Loss: 13.658609
Rec Loss: 9.466920
KL Loss: 4.191689
Y Loss: 1.001938
T Loss: 11.885083
X Loss: -2.919131
Epoch 399 
Overall Loss: 13.476425
Rec Loss: 8.963251
KL Loss: 4.513173
Y Loss: 0.972898
T Loss: 11.546946
X Loss: -3.070144
Epoch 449 
Overall Loss: 13.364929
Rec Loss: 8.721153
KL Loss: 4.643776
Y Loss: 0.985744
T Loss: 11.433464
X Loss: -3.205183
Epoch 499 
Overall Loss: 13.321751
Rec Loss: 8.615721
KL Loss: 4.706030
Y Loss: 0.982685
T Loss: 11.373653
X Loss: -3.249274
Epoch 549 
Overall Loss: 13.280068
Rec Loss: 8.527249
KL Loss: 4.752819
Y Loss: 0.974625
T Loss: 11.340300
X Loss: -3.300364
Epoch 599 
Overall Loss: 13.241033
Rec Loss: 8.454134
KL Loss: 4.786898
Y Loss: 1.004926
T Loss: 11.303423
X Loss: -3.351752
Epoch 649 
Overall Loss: 13.150017
Rec Loss: 8.267492
KL Loss: 4.882525
Y Loss: 0.984306
T Loss: 11.150094
X Loss: -3.374756
Epoch 699 
Overall Loss: 13.029658
Rec Loss: 7.995495
KL Loss: 5.034164
Y Loss: 1.003827
T Loss: 10.935643
X Loss: -3.442062
Epoch 749 
Overall Loss: 13.015274
Rec Loss: 7.846179
KL Loss: 5.169095
Y Loss: 1.004455
T Loss: 10.808703
X Loss: -3.464752
Epoch 799 
Overall Loss: 12.964795
Rec Loss: 7.737436
KL Loss: 5.227359
Y Loss: 1.020865
T Loss: 10.748524
X Loss: -3.521521
Epoch 849 
Overall Loss: 12.904252
Rec Loss: 7.663594
KL Loss: 5.240658
Y Loss: 0.984819
T Loss: 10.712795
X Loss: -3.541610
Epoch 899 
Overall Loss: 12.868334
Rec Loss: 7.585371
KL Loss: 5.282963
Y Loss: 0.980740
T Loss: 10.691018
X Loss: -3.596017
Epoch 949 
Overall Loss: 12.847498
Rec Loss: 7.584126
KL Loss: 5.263372
Y Loss: 0.959189
T Loss: 10.710897
X Loss: -3.606365
Epoch 999 
Overall Loss: 12.848269
Rec Loss: 7.540859
KL Loss: 5.307410
Y Loss: 0.962518
T Loss: 10.685992
X Loss: -3.626392
Epoch 1049 
Overall Loss: 12.846752
Rec Loss: 7.541209
KL Loss: 5.305543
Y Loss: 0.983547
T Loss: 10.714759
X Loss: -3.665324
Epoch 1099 
Overall Loss: 12.788810
Rec Loss: 7.453511
KL Loss: 5.335298
Y Loss: 0.957112
T Loss: 10.666404
X Loss: -3.691448
Epoch 1149 
Overall Loss: 12.768755
Rec Loss: 7.407642
KL Loss: 5.361113
Y Loss: 0.940423
T Loss: 10.670904
X Loss: -3.733474
Epoch 1199 
Overall Loss: 12.759338
Rec Loss: 7.385245
KL Loss: 5.374093
Y Loss: 0.951062
T Loss: 10.678854
X Loss: -3.769140
Epoch 1249 
Overall Loss: 12.772828
Rec Loss: 7.388397
KL Loss: 5.384431
Y Loss: 0.957316
T Loss: 10.692972
X Loss: -3.783233
Epoch 1299 
Overall Loss: 12.768297
Rec Loss: 7.381641
KL Loss: 5.386656
Y Loss: 0.977636
T Loss: 10.675635
X Loss: -3.782811
Epoch 1349 
Overall Loss: 12.727354
Rec Loss: 7.312531
KL Loss: 5.414823
Y Loss: 0.934094
T Loss: 10.684334
X Loss: -3.838850
Epoch 1399 
Overall Loss: 12.721469
Rec Loss: 7.288962
KL Loss: 5.432507
Y Loss: 0.938855
T Loss: 10.679888
X Loss: -3.860353
Epoch 1449 
Overall Loss: 12.724918
Rec Loss: 7.284843
KL Loss: 5.440075
Y Loss: 0.936620
T Loss: 10.705443
X Loss: -3.888910
Epoch 1499 
Overall Loss: 12.743903
Rec Loss: 7.289631
KL Loss: 5.454273
Y Loss: 0.938206
T Loss: 10.705589
X Loss: -3.885061
Epoch 1549 
Overall Loss: 12.722211
Rec Loss: 7.253554
KL Loss: 5.468656
Y Loss: 0.946621
T Loss: 10.708766
X Loss: -3.928522
Epoch 1599 
Overall Loss: 12.700733
Rec Loss: 7.213399
KL Loss: 5.487334
Y Loss: 0.938270
T Loss: 10.699059
X Loss: -3.954795
Epoch 1649 
Overall Loss: 12.680480
Rec Loss: 7.202190
KL Loss: 5.478290
Y Loss: 0.937727
T Loss: 10.682712
X Loss: -3.949385
Epoch 1699 
Overall Loss: 12.707533
Rec Loss: 7.208578
KL Loss: 5.498955
Y Loss: 0.933891
T Loss: 10.708176
X Loss: -3.966544
Epoch 1749 
Overall Loss: 12.701967
Rec Loss: 7.176870
KL Loss: 5.525097
Y Loss: 0.931861
T Loss: 10.709603
X Loss: -3.998664
Epoch 1799 
Overall Loss: 12.679301
Rec Loss: 7.136101
KL Loss: 5.543200
Y Loss: 0.930947
T Loss: 10.699946
X Loss: -4.029319
Epoch 1849 
Overall Loss: 12.660958
Rec Loss: 7.125704
KL Loss: 5.535254
Y Loss: 0.932149
T Loss: 10.710122
X Loss: -4.050493
Epoch 1899 
Overall Loss: 12.678025
Rec Loss: 7.105797
KL Loss: 5.572228
Y Loss: 0.928842
T Loss: 10.710812
X Loss: -4.069436
Epoch 1949 
Overall Loss: 12.658208
Rec Loss: 7.075645
KL Loss: 5.582563
Y Loss: 0.929742
T Loss: 10.710533
X Loss: -4.099759
Epoch 1999 
Overall Loss: 12.621739
Rec Loss: 7.043868
KL Loss: 5.577871
Y Loss: 0.929483
T Loss: 10.703605
X Loss: -4.124478
Epoch 2049 
Overall Loss: 12.665149
Rec Loss: 7.036868
KL Loss: 5.628280
Y Loss: 0.925708
T Loss: 10.722063
X Loss: -4.148049
Epoch 2099 
Overall Loss: 12.660363
Rec Loss: 7.031148
KL Loss: 5.629215
Y Loss: 0.933322
T Loss: 10.718248
X Loss: -4.153760
Epoch 2149 
Overall Loss: 12.633444
Rec Loss: 6.991421
KL Loss: 5.642023
Y Loss: 0.914666
T Loss: 10.706043
X Loss: -4.171956
Epoch 2199 
Overall Loss: 12.640663
Rec Loss: 7.000650
KL Loss: 5.640013
Y Loss: 0.938663
T Loss: 10.723840
X Loss: -4.192521
Epoch 2249 
Overall Loss: 12.628768
Rec Loss: 6.994612
KL Loss: 5.634156
Y Loss: 0.901355
T Loss: 10.735468
X Loss: -4.191534
Epoch 2299 
Overall Loss: 12.636643
Rec Loss: 6.980499
KL Loss: 5.656144
Y Loss: 0.923221
T Loss: 10.716450
X Loss: -4.197562
Epoch 2349 
Overall Loss: 12.636807
Rec Loss: 6.964590
KL Loss: 5.672217
Y Loss: 0.933662
T Loss: 10.724693
X Loss: -4.226934
Epoch 2399 
Overall Loss: 12.617183
Rec Loss: 6.945745
KL Loss: 5.671438
Y Loss: 0.928177
T Loss: 10.701551
X Loss: -4.219894
Epoch 2449 
Overall Loss: 12.602855
Rec Loss: 6.925667
KL Loss: 5.677189
Y Loss: 0.906646
T Loss: 10.721879
X Loss: -4.249536
Epoch 2499 
Overall Loss: 12.638021
Rec Loss: 6.939551
KL Loss: 5.698470
Y Loss: 0.931491
T Loss: 10.711561
X Loss: -4.237755
Epoch 2549 
Overall Loss: 12.643637
Rec Loss: 6.925664
KL Loss: 5.717973
Y Loss: 0.922314
T Loss: 10.716915
X Loss: -4.252408
Epoch 2599 
Overall Loss: 12.629858
Rec Loss: 6.904799
KL Loss: 5.725059
Y Loss: 0.904918
T Loss: 10.724981
X Loss: -4.272641
Epoch 2649 
Overall Loss: 12.601069
Rec Loss: 6.911185
KL Loss: 5.689884
Y Loss: 0.942388
T Loss: 10.717178
X Loss: -4.277186
Epoch 2699 
Overall Loss: 12.620226
Rec Loss: 6.901027
KL Loss: 5.719199
Y Loss: 0.927276
T Loss: 10.718886
X Loss: -4.281497
Epoch 2749 
Overall Loss: 12.637072
Rec Loss: 6.901235
KL Loss: 5.735837
Y Loss: 0.928934
T Loss: 10.729997
X Loss: -4.293228
Epoch 2799 
Overall Loss: 12.623354
Rec Loss: 6.882043
KL Loss: 5.741312
Y Loss: 0.925397
T Loss: 10.726651
X Loss: -4.307306
Epoch 2849 
Overall Loss: 12.639053
Rec Loss: 6.887236
KL Loss: 5.751817
Y Loss: 0.947583
T Loss: 10.719779
X Loss: -4.306335
Epoch 2899 
Overall Loss: 12.609592
Rec Loss: 6.861639
KL Loss: 5.747953
Y Loss: 0.924648
T Loss: 10.733691
X Loss: -4.334375
Epoch 2949 
Overall Loss: 12.595402
Rec Loss: 6.837126
KL Loss: 5.758276
Y Loss: 0.931248
T Loss: 10.707724
X Loss: -4.336221
Epoch 2999 
Overall Loss: 12.624620
Rec Loss: 6.851961
KL Loss: 5.772658
Y Loss: 0.928819
T Loss: 10.737848
X Loss: -4.350295
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.869503
Epoch 99
Rec Loss: 1.846582
Epoch 149
Rec Loss: 1.856716
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.000099
Epoch 99
Rec Loss: 2.001323
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.660032
Insample Error 2.546165
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.501781
Epoch 99 
Prediction Loss: 2.302183
Epoch 149 
Prediction Loss: 2.198784
Epoch 199 
Prediction Loss: 2.143720
Epoch 249 
Prediction Loss: 2.012237
Epoch 299 
Prediction Loss: 1.963792
Epoch 349 
Prediction Loss: 1.851220
Epoch 399 
Prediction Loss: 1.801198
Epoch 449 
Prediction Loss: 1.692513
Epoch 499 
Prediction Loss: 1.603596
Epoch 549 
Prediction Loss: 1.521081
Epoch 599 
Prediction Loss: 1.437935
Epoch 649 
Prediction Loss: 1.391577
Epoch 699 
Prediction Loss: 1.300660
Epoch 749 
Prediction Loss: 1.263815
Epoch 799 
Prediction Loss: 1.214881
Epoch 849 
Prediction Loss: 1.187254
Epoch 899 
Prediction Loss: 1.184464
Epoch 949 
Prediction Loss: 1.050542
Epoch 999 
Prediction Loss: 1.059999
Epoch 1049 
Prediction Loss: 0.996108
Epoch 1099 
Prediction Loss: 0.964580
Epoch 1149 
Prediction Loss: 0.941035
Epoch 1199 
Prediction Loss: 0.929704
Epoch 1249 
Prediction Loss: 0.909400
Epoch 1299 
Prediction Loss: 0.879432
Epoch 1349 
Prediction Loss: 0.866683
Epoch 1399 
Prediction Loss: 0.887106
Epoch 1449 
Prediction Loss: 0.831128
Epoch 1499 
Prediction Loss: 0.813345
Epoch 1549 
Prediction Loss: 0.821731
Epoch 1599 
Prediction Loss: 0.817298
Epoch 1649 
Prediction Loss: 0.772038
Epoch 1699 
Prediction Loss: 0.783914
Epoch 1749 
Prediction Loss: 0.759355
Epoch 1799 
Prediction Loss: 0.766960
Epoch 1849 
Prediction Loss: 0.727386
Epoch 1899 
Prediction Loss: 0.736593
Epoch 1949 
Prediction Loss: 0.744314
Epoch 1999 
Prediction Loss: 0.747352
Epoch 2049 
Prediction Loss: 0.715045
Epoch 2099 
Prediction Loss: 0.714719
Epoch 2149 
Prediction Loss: 0.698492
Epoch 2199 
Prediction Loss: 0.709062
Epoch 2249 
Prediction Loss: 0.681409
Epoch 2299 
Prediction Loss: 0.671117
Epoch 2349 
Prediction Loss: 0.676687
Epoch 2399 
Prediction Loss: 0.689990
Epoch 2449 
Prediction Loss: 0.655484
Epoch 2499 
Prediction Loss: 0.644132
Epoch 2549 
Prediction Loss: 0.656155
Epoch 2599 
Prediction Loss: 0.656530
Epoch 2649 
Prediction Loss: 0.652265
Epoch 2699 
Prediction Loss: 0.651009
Epoch 2749 
Prediction Loss: 0.640488
Epoch 2799 
Prediction Loss: 0.637479
Epoch 2849 
Prediction Loss: 0.626782
Epoch 2899 
Prediction Loss: 0.624024
Epoch 2949 
Prediction Loss: 0.623127
Epoch 2999 
Prediction Loss: 0.622773
Epoch 3049 
Prediction Loss: 0.616642
Epoch 3099 
Prediction Loss: 0.623659
Epoch 3149 
Prediction Loss: 0.611325
Epoch 3199 
Prediction Loss: 0.599376
Epoch 3249 
Prediction Loss: 0.603980
Epoch 3299 
Prediction Loss: 0.610605
Epoch 3349 
Prediction Loss: 0.634808
Epoch 3399 
Prediction Loss: 0.599722
Epoch 3449 
Prediction Loss: 0.599379
Epoch 3499 
Prediction Loss: 0.601748
Epoch 3549 
Prediction Loss: 0.595957
Epoch 3599 
Prediction Loss: 0.621457
Epoch 3649 
Prediction Loss: 0.580223
Epoch 3699 
Prediction Loss: 0.588238
Epoch 3749 
Prediction Loss: 0.587864
Epoch 3799 
Prediction Loss: 0.598123
Epoch 3849 
Prediction Loss: 0.583727
Epoch 3899 
Prediction Loss: 0.589774
Epoch 3949 
Prediction Loss: 0.575569
Epoch 3999 
Prediction Loss: 0.586951
Epoch 4049 
Prediction Loss: 0.563671
Epoch 4099 
Prediction Loss: 0.569839
Epoch 4149 
Prediction Loss: 0.590119
Epoch 4199 
Prediction Loss: 0.564480
Epoch 4249 
Prediction Loss: 0.573761
Epoch 4299 
Prediction Loss: 0.585245
Epoch 4349 
Prediction Loss: 0.569447
Epoch 4399 
Prediction Loss: 0.557159
Epoch 4449 
Prediction Loss: 0.565131
Epoch 4499 
Prediction Loss: 0.556262
Epoch 4549 
Prediction Loss: 0.560807
Epoch 4599 
Prediction Loss: 0.556156
Epoch 4649 
Prediction Loss: 0.548289
Epoch 4699 
Prediction Loss: 0.561124
Epoch 4749 
Prediction Loss: 0.547598
Epoch 4799 
Prediction Loss: 0.541030
Epoch 4849 
Prediction Loss: 0.560174
Epoch 4899 
Prediction Loss: 0.556565
Epoch 4949 
Prediction Loss: 0.548997
Epoch 4999 
Prediction Loss: 0.539809
Epoch 5049 
Prediction Loss: 0.546707
Epoch 5099 
Prediction Loss: 0.547073
Epoch 5149 
Prediction Loss: 0.543571
Epoch 5199 
Prediction Loss: 0.534569
Epoch 5249 
Prediction Loss: 0.529278
Epoch 5299 
Prediction Loss: 0.565133
Epoch 5349 
Prediction Loss: 0.541048
Epoch 5399 
Prediction Loss: 0.534534
Epoch 5449 
Prediction Loss: 0.535432
Epoch 5499 
Prediction Loss: 0.581802
Epoch 5549 
Prediction Loss: 0.524346
Epoch 5599 
Prediction Loss: 0.550998
Epoch 5649 
Prediction Loss: 0.537886
Epoch 5699 
Prediction Loss: 0.524938
Epoch 5749 
Prediction Loss: 0.522984
Epoch 5799 
Prediction Loss: 0.531105
Epoch 5849 
Prediction Loss: 0.551681
Epoch 5899 
Prediction Loss: 0.552423
Epoch 5949 
Prediction Loss: 0.517817
Epoch 5999 
Prediction Loss: 0.516720
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.724567
Insample Error 3.605866
[31m========== repeat time 4 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.058032
Rec Loss: 11.332982
KL Loss: 1.725050
Y Loss: 1.029952
T Loss: 10.818006
Epoch 99 
Overall Loss: 12.860476
Rec Loss: 10.960718
KL Loss: 1.899758
Y Loss: 0.961939
T Loss: 10.479749
Epoch 149 
Overall Loss: 12.789341
Rec Loss: 10.898377
KL Loss: 1.890965
Y Loss: 0.926760
T Loss: 10.434996
Epoch 199 
Overall Loss: 12.706081
Rec Loss: 10.892977
KL Loss: 1.813104
Y Loss: 0.945927
T Loss: 10.420014
Epoch 249 
Overall Loss: 12.717093
Rec Loss: 10.882784
KL Loss: 1.834309
Y Loss: 0.932130
T Loss: 10.416719
Epoch 299 
Overall Loss: 12.696977
Rec Loss: 10.907848
KL Loss: 1.789130
Y Loss: 0.923411
T Loss: 10.446142
Epoch 349 
Overall Loss: 12.675705
Rec Loss: 10.886922
KL Loss: 1.788784
Y Loss: 0.902756
T Loss: 10.435544
Epoch 399 
Overall Loss: 12.679648
Rec Loss: 10.883024
KL Loss: 1.796624
Y Loss: 0.914756
T Loss: 10.425646
Epoch 449 
Overall Loss: 12.675425
Rec Loss: 10.898819
KL Loss: 1.776606
Y Loss: 0.933186
T Loss: 10.432226
Epoch 499 
Overall Loss: 12.652448
Rec Loss: 10.878959
KL Loss: 1.773489
Y Loss: 0.920444
T Loss: 10.418737
Epoch 549 
Overall Loss: 12.650838
Rec Loss: 10.859508
KL Loss: 1.791329
Y Loss: 0.892993
T Loss: 10.413012
Epoch 599 
Overall Loss: 12.641043
Rec Loss: 10.872888
KL Loss: 1.768156
Y Loss: 0.887887
T Loss: 10.428945
Epoch 649 
Overall Loss: 12.630123
Rec Loss: 10.884340
KL Loss: 1.745783
Y Loss: 0.907836
T Loss: 10.430422
Epoch 699 
Overall Loss: 12.625417
Rec Loss: 10.871862
KL Loss: 1.753556
Y Loss: 0.910598
T Loss: 10.416562
Epoch 749 
Overall Loss: 12.614969
Rec Loss: 10.875466
KL Loss: 1.739503
Y Loss: 0.904103
T Loss: 10.423414
Epoch 799 
Overall Loss: 12.624657
Rec Loss: 10.856433
KL Loss: 1.768224
Y Loss: 0.876470
T Loss: 10.418198
Epoch 849 
Overall Loss: 12.612798
Rec Loss: 10.845712
KL Loss: 1.767087
Y Loss: 0.890377
T Loss: 10.400523
Epoch 899 
Overall Loss: 12.605514
Rec Loss: 10.875922
KL Loss: 1.729592
Y Loss: 0.907957
T Loss: 10.421943
Epoch 949 
Overall Loss: 12.582653
Rec Loss: 10.844652
KL Loss: 1.738001
Y Loss: 0.866933
T Loss: 10.411185
Epoch 999 
Overall Loss: 12.616623
Rec Loss: 10.855368
KL Loss: 1.761254
Y Loss: 0.877865
T Loss: 10.416436
Epoch 1049 
Overall Loss: 12.614880
Rec Loss: 10.845838
KL Loss: 1.769042
Y Loss: 0.864500
T Loss: 10.413589
Epoch 1099 
Overall Loss: 12.569180
Rec Loss: 10.838975
KL Loss: 1.730205
Y Loss: 0.878733
T Loss: 10.399609
Epoch 1149 
Overall Loss: 12.567424
Rec Loss: 10.829726
KL Loss: 1.737699
Y Loss: 0.887211
T Loss: 10.386121
Epoch 1199 
Overall Loss: 12.584077
Rec Loss: 10.835431
KL Loss: 1.748646
Y Loss: 0.879406
T Loss: 10.395728
Epoch 1249 
Overall Loss: 12.566900
Rec Loss: 10.816158
KL Loss: 1.750741
Y Loss: 0.857146
T Loss: 10.387585
Epoch 1299 
Overall Loss: 12.582374
Rec Loss: 10.828355
KL Loss: 1.754020
Y Loss: 0.852708
T Loss: 10.402001
Epoch 1349 
Overall Loss: 12.551463
Rec Loss: 10.817202
KL Loss: 1.734261
Y Loss: 0.848113
T Loss: 10.393146
Epoch 1399 
Overall Loss: 12.545988
Rec Loss: 10.798190
KL Loss: 1.747797
Y Loss: 0.864446
T Loss: 10.365968
Epoch 1449 
Overall Loss: 12.557674
Rec Loss: 10.812880
KL Loss: 1.744794
Y Loss: 0.877178
T Loss: 10.374291
Epoch 1499 
Overall Loss: 12.560828
Rec Loss: 10.821805
KL Loss: 1.739023
Y Loss: 0.871664
T Loss: 10.385973
Epoch 1549 
Overall Loss: 12.539150
Rec Loss: 10.800040
KL Loss: 1.739109
Y Loss: 0.861286
T Loss: 10.369397
Epoch 1599 
Overall Loss: 12.570914
Rec Loss: 10.846031
KL Loss: 1.724882
Y Loss: 0.896604
T Loss: 10.397729
Epoch 1649 
Overall Loss: 12.557350
Rec Loss: 10.829997
KL Loss: 1.727353
Y Loss: 0.862840
T Loss: 10.398577
Epoch 1699 
Overall Loss: 12.546975
Rec Loss: 10.817518
KL Loss: 1.729457
Y Loss: 0.848283
T Loss: 10.393377
Epoch 1749 
Overall Loss: 12.544218
Rec Loss: 10.770884
KL Loss: 1.773334
Y Loss: 0.869962
T Loss: 10.335903
Epoch 1799 
Overall Loss: 12.512956
Rec Loss: 10.782531
KL Loss: 1.730425
Y Loss: 0.842624
T Loss: 10.361219
Epoch 1849 
Overall Loss: 12.515600
Rec Loss: 10.793992
KL Loss: 1.721608
Y Loss: 0.861987
T Loss: 10.362999
Epoch 1899 
Overall Loss: 12.524279
Rec Loss: 10.793154
KL Loss: 1.731126
Y Loss: 0.860637
T Loss: 10.362835
Epoch 1949 
Overall Loss: 12.517093
Rec Loss: 10.776470
KL Loss: 1.740623
Y Loss: 0.847413
T Loss: 10.352763
Epoch 1999 
Overall Loss: 12.496691
Rec Loss: 10.782556
KL Loss: 1.714134
Y Loss: 0.850638
T Loss: 10.357237
Epoch 2049 
Overall Loss: 12.535076
Rec Loss: 10.782320
KL Loss: 1.752756
Y Loss: 0.863544
T Loss: 10.350548
Epoch 2099 
Overall Loss: 12.496469
Rec Loss: 10.759522
KL Loss: 1.736946
Y Loss: 0.842475
T Loss: 10.338285
Epoch 2149 
Overall Loss: 12.495924
Rec Loss: 10.760703
KL Loss: 1.735221
Y Loss: 0.845082
T Loss: 10.338163
Epoch 2199 
Overall Loss: 12.502061
Rec Loss: 10.788955
KL Loss: 1.713106
Y Loss: 0.843356
T Loss: 10.367277
Epoch 2249 
Overall Loss: 12.483350
Rec Loss: 10.743893
KL Loss: 1.739457
Y Loss: 0.825267
T Loss: 10.331259
Epoch 2299 
Overall Loss: 12.501108
Rec Loss: 10.782267
KL Loss: 1.718841
Y Loss: 0.849287
T Loss: 10.357623
Epoch 2349 
Overall Loss: 12.506295
Rec Loss: 10.769337
KL Loss: 1.736958
Y Loss: 0.848619
T Loss: 10.345027
Epoch 2399 
Overall Loss: 12.497444
Rec Loss: 10.759157
KL Loss: 1.738287
Y Loss: 0.856668
T Loss: 10.330823
Epoch 2449 
Overall Loss: 12.478345
Rec Loss: 10.735185
KL Loss: 1.743160
Y Loss: 0.834254
T Loss: 10.318058
Epoch 2499 
Overall Loss: 12.477348
Rec Loss: 10.744559
KL Loss: 1.732789
Y Loss: 0.853123
T Loss: 10.317998
Epoch 2549 
Overall Loss: 12.482683
Rec Loss: 10.730651
KL Loss: 1.752032
Y Loss: 0.828814
T Loss: 10.316244
Epoch 2599 
Overall Loss: 12.478318
Rec Loss: 10.746167
KL Loss: 1.732150
Y Loss: 0.840572
T Loss: 10.325881
Epoch 2649 
Overall Loss: 12.470715
Rec Loss: 10.739791
KL Loss: 1.730924
Y Loss: 0.846098
T Loss: 10.316741
Epoch 2699 
Overall Loss: 12.460302
Rec Loss: 10.725384
KL Loss: 1.734918
Y Loss: 0.824982
T Loss: 10.312893
Epoch 2749 
Overall Loss: 12.450590
Rec Loss: 10.752297
KL Loss: 1.698293
Y Loss: 0.840563
T Loss: 10.332015
Epoch 2799 
Overall Loss: 12.451558
Rec Loss: 10.719659
KL Loss: 1.731899
Y Loss: 0.842897
T Loss: 10.298211
Epoch 2849 
Overall Loss: 12.450169
Rec Loss: 10.722737
KL Loss: 1.727431
Y Loss: 0.834336
T Loss: 10.305569
Epoch 2899 
Overall Loss: 12.463659
Rec Loss: 10.768665
KL Loss: 1.694994
Y Loss: 0.852560
T Loss: 10.342385
Epoch 2949 
Overall Loss: 12.455139
Rec Loss: 10.756253
KL Loss: 1.698886
Y Loss: 0.849779
T Loss: 10.331364
Epoch 2999 
Overall Loss: 12.430986
Rec Loss: 10.728603
KL Loss: 1.702383
Y Loss: 0.817722
T Loss: 10.319742
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.505766
Epoch 99
Rec Loss: 1.482055
Epoch 149
Rec Loss: 1.484283
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.934801
Epoch 99
Rec Loss: 9.933953
Epoch 149
Rec Loss: 9.917197
Epoch 199
Rec Loss: 9.925059
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.685602
Insample Error: 1.843621
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.603361
Rec Loss: 19.902152
KL Loss: 2.701209
Y Loss: 11.176748
T Loss: 13.115842
X Loss: 1.197936
Epoch 99 
Overall Loss: 16.830351
Rec Loss: 13.318110
KL Loss: 3.512241
Y Loss: 3.163585
T Loss: 12.898044
X Loss: -1.161726
Epoch 149 
Overall Loss: 15.425329
Rec Loss: 12.022134
KL Loss: 3.403195
Y Loss: 2.356860
T Loss: 12.846039
X Loss: -2.002335
Epoch 199 
Overall Loss: 14.621358
Rec Loss: 10.921790
KL Loss: 3.699568
Y Loss: 1.648779
T Loss: 12.611053
X Loss: -2.513652
Epoch 249 
Overall Loss: 14.165436
Rec Loss: 10.274133
KL Loss: 3.891303
Y Loss: 1.347017
T Loss: 12.428492
X Loss: -2.827867
Epoch 299 
Overall Loss: 13.933607
Rec Loss: 9.825966
KL Loss: 4.107641
Y Loss: 1.228832
T Loss: 12.181142
X Loss: -2.969592
Epoch 349 
Overall Loss: 13.745517
Rec Loss: 9.478286
KL Loss: 4.267231
Y Loss: 1.141441
T Loss: 11.951632
X Loss: -3.044067
Epoch 399 
Overall Loss: 13.544569
Rec Loss: 9.084225
KL Loss: 4.460343
Y Loss: 1.103872
T Loss: 11.685991
X Loss: -3.153701
Epoch 449 
Overall Loss: 13.408197
Rec Loss: 8.831555
KL Loss: 4.576642
Y Loss: 1.124987
T Loss: 11.523469
X Loss: -3.254408
Epoch 499 
Overall Loss: 13.292483
Rec Loss: 8.545137
KL Loss: 4.747347
Y Loss: 1.064477
T Loss: 11.389209
X Loss: -3.376311
Epoch 549 
Overall Loss: 13.159696
Rec Loss: 8.157711
KL Loss: 5.001985
Y Loss: 1.049035
T Loss: 11.158357
X Loss: -3.525164
Epoch 599 
Overall Loss: 13.069527
Rec Loss: 7.817669
KL Loss: 5.251858
Y Loss: 1.068880
T Loss: 10.946226
X Loss: -3.662997
Epoch 649 
Overall Loss: 13.017590
Rec Loss: 7.690909
KL Loss: 5.326682
Y Loss: 1.087790
T Loss: 10.863842
X Loss: -3.716828
Epoch 699 
Overall Loss: 12.963326
Rec Loss: 7.552664
KL Loss: 5.410662
Y Loss: 1.030919
T Loss: 10.818217
X Loss: -3.781012
Epoch 749 
Overall Loss: 12.951231
Rec Loss: 7.509369
KL Loss: 5.441862
Y Loss: 1.034897
T Loss: 10.802687
X Loss: -3.810766
Epoch 799 
Overall Loss: 12.899010
Rec Loss: 7.469922
KL Loss: 5.429088
Y Loss: 1.016280
T Loss: 10.776785
X Loss: -3.815004
Epoch 849 
Overall Loss: 12.877687
Rec Loss: 7.421737
KL Loss: 5.455951
Y Loss: 0.991476
T Loss: 10.782832
X Loss: -3.856833
Epoch 899 
Overall Loss: 12.876984
Rec Loss: 7.401360
KL Loss: 5.475624
Y Loss: 1.000719
T Loss: 10.765574
X Loss: -3.864574
Epoch 949 
Overall Loss: 12.889173
Rec Loss: 7.388482
KL Loss: 5.500691
Y Loss: 0.996172
T Loss: 10.758870
X Loss: -3.868474
Epoch 999 
Overall Loss: 12.863684
Rec Loss: 7.366292
KL Loss: 5.497392
Y Loss: 0.984869
T Loss: 10.761334
X Loss: -3.887476
Epoch 1049 
Overall Loss: 12.845776
Rec Loss: 7.362007
KL Loss: 5.483770
Y Loss: 0.990463
T Loss: 10.754220
X Loss: -3.887445
Epoch 1099 
Overall Loss: 12.827924
Rec Loss: 7.333468
KL Loss: 5.494456
Y Loss: 0.968212
T Loss: 10.755852
X Loss: -3.906489
Epoch 1149 
Overall Loss: 12.797672
Rec Loss: 7.287605
KL Loss: 5.510067
Y Loss: 0.958182
T Loss: 10.748903
X Loss: -3.940390
Epoch 1199 
Overall Loss: 12.810659
Rec Loss: 7.301539
KL Loss: 5.509120
Y Loss: 0.967492
T Loss: 10.737429
X Loss: -3.919636
Epoch 1249 
Overall Loss: 12.773032
Rec Loss: 7.309130
KL Loss: 5.463902
Y Loss: 0.973357
T Loss: 10.753862
X Loss: -3.931410
Epoch 1299 
Overall Loss: 12.812955
Rec Loss: 7.306810
KL Loss: 5.506145
Y Loss: 0.980396
T Loss: 10.739461
X Loss: -3.922850
Epoch 1349 
Overall Loss: 12.771378
Rec Loss: 7.301843
KL Loss: 5.469536
Y Loss: 0.964663
T Loss: 10.731558
X Loss: -3.912047
Epoch 1399 
Overall Loss: 12.747784
Rec Loss: 7.276098
KL Loss: 5.471686
Y Loss: 0.955247
T Loss: 10.722837
X Loss: -3.924363
Epoch 1449 
Overall Loss: 12.748050
Rec Loss: 7.258099
KL Loss: 5.489951
Y Loss: 0.961134
T Loss: 10.734867
X Loss: -3.957334
Epoch 1499 
Overall Loss: 12.724943
Rec Loss: 7.247376
KL Loss: 5.477567
Y Loss: 0.952625
T Loss: 10.720891
X Loss: -3.949828
Epoch 1549 
Overall Loss: 12.725737
Rec Loss: 7.258965
KL Loss: 5.466772
Y Loss: 0.958964
T Loss: 10.734281
X Loss: -3.954798
Epoch 1599 
Overall Loss: 12.687339
Rec Loss: 7.202602
KL Loss: 5.484738
Y Loss: 0.942075
T Loss: 10.707701
X Loss: -3.976137
Epoch 1649 
Overall Loss: 12.710649
Rec Loss: 7.240539
KL Loss: 5.470111
Y Loss: 0.956547
T Loss: 10.728272
X Loss: -3.966006
Epoch 1699 
Overall Loss: 12.714854
Rec Loss: 7.222980
KL Loss: 5.491874
Y Loss: 0.948603
T Loss: 10.729614
X Loss: -3.980936
Epoch 1749 
Overall Loss: 12.723953
Rec Loss: 7.227475
KL Loss: 5.496478
Y Loss: 0.966690
T Loss: 10.723283
X Loss: -3.979153
Epoch 1799 
Overall Loss: 12.689704
Rec Loss: 7.201820
KL Loss: 5.487884
Y Loss: 0.923117
T Loss: 10.727950
X Loss: -3.987689
Epoch 1849 
Overall Loss: 12.723116
Rec Loss: 7.202187
KL Loss: 5.520929
Y Loss: 0.953992
T Loss: 10.731227
X Loss: -4.006036
Epoch 1899 
Overall Loss: 12.700606
Rec Loss: 7.214556
KL Loss: 5.486050
Y Loss: 0.935951
T Loss: 10.743074
X Loss: -3.996494
Epoch 1949 
Overall Loss: 12.685514
Rec Loss: 7.188172
KL Loss: 5.497341
Y Loss: 0.961578
T Loss: 10.709092
X Loss: -4.001709
Epoch 1999 
Overall Loss: 12.673844
Rec Loss: 7.180845
KL Loss: 5.492998
Y Loss: 0.939045
T Loss: 10.731405
X Loss: -4.020083
Epoch 2049 
Overall Loss: 12.685700
Rec Loss: 7.171985
KL Loss: 5.513715
Y Loss: 0.947087
T Loss: 10.728931
X Loss: -4.030489
Epoch 2099 
Overall Loss: 12.672865
Rec Loss: 7.140493
KL Loss: 5.532372
Y Loss: 0.953383
T Loss: 10.724356
X Loss: -4.060554
Epoch 2149 
Overall Loss: 12.675368
Rec Loss: 7.128490
KL Loss: 5.546877
Y Loss: 0.929659
T Loss: 10.729563
X Loss: -4.065902
Epoch 2199 
Overall Loss: 12.658394
Rec Loss: 7.120715
KL Loss: 5.537679
Y Loss: 0.926359
T Loss: 10.719584
X Loss: -4.062049
Epoch 2249 
Overall Loss: 12.657052
Rec Loss: 7.062993
KL Loss: 5.594058
Y Loss: 0.929880
T Loss: 10.706319
X Loss: -4.108266
Epoch 2299 
Overall Loss: 12.646530
Rec Loss: 7.090355
KL Loss: 5.556175
Y Loss: 0.927755
T Loss: 10.714551
X Loss: -4.088073
Epoch 2349 
Overall Loss: 12.655375
Rec Loss: 7.092026
KL Loss: 5.563350
Y Loss: 0.922810
T Loss: 10.719303
X Loss: -4.088683
Epoch 2399 
Overall Loss: 12.647732
Rec Loss: 7.050449
KL Loss: 5.597283
Y Loss: 0.929622
T Loss: 10.718263
X Loss: -4.132625
Epoch 2449 
Overall Loss: 12.653675
Rec Loss: 7.041211
KL Loss: 5.612464
Y Loss: 0.935853
T Loss: 10.734631
X Loss: -4.161347
Epoch 2499 
Overall Loss: 12.648873
Rec Loss: 7.035472
KL Loss: 5.613401
Y Loss: 0.913331
T Loss: 10.755320
X Loss: -4.176513
Epoch 2549 
Overall Loss: 12.640512
Rec Loss: 6.990749
KL Loss: 5.649763
Y Loss: 0.915106
T Loss: 10.724219
X Loss: -4.191023
Epoch 2599 
Overall Loss: 12.624719
Rec Loss: 6.968037
KL Loss: 5.656682
Y Loss: 0.919058
T Loss: 10.726147
X Loss: -4.217640
Epoch 2649 
Overall Loss: 12.605247
Rec Loss: 6.940186
KL Loss: 5.665061
Y Loss: 0.913562
T Loss: 10.707953
X Loss: -4.224547
Epoch 2699 
Overall Loss: 12.629439
Rec Loss: 6.976185
KL Loss: 5.653254
Y Loss: 0.942296
T Loss: 10.718374
X Loss: -4.213337
Epoch 2749 
Overall Loss: 12.591186
Rec Loss: 6.910788
KL Loss: 5.680398
Y Loss: 0.928670
T Loss: 10.709336
X Loss: -4.262883
Epoch 2799 
Overall Loss: 12.590786
Rec Loss: 6.923130
KL Loss: 5.667656
Y Loss: 0.936514
T Loss: 10.715163
X Loss: -4.260290
Epoch 2849 
Overall Loss: 12.592442
Rec Loss: 6.882858
KL Loss: 5.709584
Y Loss: 0.903479
T Loss: 10.701331
X Loss: -4.270212
Epoch 2899 
Overall Loss: 12.620067
Rec Loss: 6.909881
KL Loss: 5.710186
Y Loss: 0.922569
T Loss: 10.721567
X Loss: -4.272971
Epoch 2949 
Overall Loss: 12.637208
Rec Loss: 6.922817
KL Loss: 5.714391
Y Loss: 0.934991
T Loss: 10.734668
X Loss: -4.279346
Epoch 2999 
Overall Loss: 12.587876
Rec Loss: 6.877715
KL Loss: 5.710161
Y Loss: 0.898723
T Loss: 10.730171
X Loss: -4.301818
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.870520
Epoch 99
Rec Loss: 1.879646
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.012801
Epoch 99
Rec Loss: 1.998168
Epoch 149
Rec Loss: 1.996662
Epoch 199
Rec Loss: 2.004199
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.643056
Insample Error 2.481717
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.476642
Epoch 99 
Prediction Loss: 2.362509
Epoch 149 
Prediction Loss: 2.282213
Epoch 199 
Prediction Loss: 2.107307
Epoch 249 
Prediction Loss: 2.049188
Epoch 299 
Prediction Loss: 1.962875
Epoch 349 
Prediction Loss: 1.905821
Epoch 399 
Prediction Loss: 1.818178
Epoch 449 
Prediction Loss: 1.746117
Epoch 499 
Prediction Loss: 1.697236
Epoch 549 
Prediction Loss: 1.614170
Epoch 599 
Prediction Loss: 1.514014
Epoch 649 
Prediction Loss: 1.438134
Epoch 699 
Prediction Loss: 1.386997
Epoch 749 
Prediction Loss: 1.325805
Epoch 799 
Prediction Loss: 1.275821
Epoch 849 
Prediction Loss: 1.246020
Epoch 899 
Prediction Loss: 1.191295
Epoch 949 
Prediction Loss: 1.265455
Epoch 999 
Prediction Loss: 1.128915
Epoch 1049 
Prediction Loss: 1.105949
Epoch 1099 
Prediction Loss: 1.038367
Epoch 1149 
Prediction Loss: 1.019933
Epoch 1199 
Prediction Loss: 0.998787
Epoch 1249 
Prediction Loss: 0.969468
Epoch 1299 
Prediction Loss: 0.977254
Epoch 1349 
Prediction Loss: 0.936944
Epoch 1399 
Prediction Loss: 0.885913
Epoch 1449 
Prediction Loss: 0.908995
Epoch 1499 
Prediction Loss: 0.897153
Epoch 1549 
Prediction Loss: 0.852162
Epoch 1599 
Prediction Loss: 0.822651
Epoch 1649 
Prediction Loss: 0.834762
Epoch 1699 
Prediction Loss: 0.835320
Epoch 1749 
Prediction Loss: 0.819314
Epoch 1799 
Prediction Loss: 0.804460
Epoch 1849 
Prediction Loss: 0.757007
Epoch 1899 
Prediction Loss: 0.769288
Epoch 1949 
Prediction Loss: 0.766064
Epoch 1999 
Prediction Loss: 0.749909
Epoch 2049 
Prediction Loss: 0.756859
Epoch 2099 
Prediction Loss: 0.761416
Epoch 2149 
Prediction Loss: 0.735765
Epoch 2199 
Prediction Loss: 0.730637
Epoch 2249 
Prediction Loss: 0.726060
Epoch 2299 
Prediction Loss: 0.704916
Epoch 2349 
Prediction Loss: 0.706659
Epoch 2399 
Prediction Loss: 0.711853
Epoch 2449 
Prediction Loss: 0.724530
Epoch 2499 
Prediction Loss: 0.720642
Epoch 2549 
Prediction Loss: 0.715648
Epoch 2599 
Prediction Loss: 0.706224
Epoch 2649 
Prediction Loss: 0.697929
Epoch 2699 
Prediction Loss: 0.675860
Epoch 2749 
Prediction Loss: 0.693668
Epoch 2799 
Prediction Loss: 0.660868
Epoch 2849 
Prediction Loss: 0.685768
Epoch 2899 
Prediction Loss: 0.709294
Epoch 2949 
Prediction Loss: 0.674322
Epoch 2999 
Prediction Loss: 0.677742
Epoch 3049 
Prediction Loss: 0.684885
Epoch 3099 
Prediction Loss: 0.654715
Epoch 3149 
Prediction Loss: 0.660327
Epoch 3199 
Prediction Loss: 0.627808
Epoch 3249 
Prediction Loss: 0.654995
Epoch 3299 
Prediction Loss: 0.628283
Epoch 3349 
Prediction Loss: 0.634733
Epoch 3399 
Prediction Loss: 0.648988
Epoch 3449 
Prediction Loss: 0.635374
Epoch 3499 
Prediction Loss: 0.625746
Epoch 3549 
Prediction Loss: 0.622422
Epoch 3599 
Prediction Loss: 0.654608
Epoch 3649 
Prediction Loss: 0.637523
Epoch 3699 
Prediction Loss: 0.624036
Epoch 3749 
Prediction Loss: 0.616253
Epoch 3799 
Prediction Loss: 0.608973
Epoch 3849 
Prediction Loss: 0.606112
Epoch 3899 
Prediction Loss: 0.626573
Epoch 3949 
Prediction Loss: 0.603270
Epoch 3999 
Prediction Loss: 0.607591
Epoch 4049 
Prediction Loss: 0.648756
Epoch 4099 
Prediction Loss: 0.600618
Epoch 4149 
Prediction Loss: 0.594732
Epoch 4199 
Prediction Loss: 0.602303
Epoch 4249 
Prediction Loss: 0.592946
Epoch 4299 
Prediction Loss: 0.624023
Epoch 4349 
Prediction Loss: 0.598266
Epoch 4399 
Prediction Loss: 0.604490
Epoch 4449 
Prediction Loss: 0.586019
Epoch 4499 
Prediction Loss: 0.617251
Epoch 4549 
Prediction Loss: 0.569941
Epoch 4599 
Prediction Loss: 0.579500
Epoch 4649 
Prediction Loss: 0.582114
Epoch 4699 
Prediction Loss: 0.575330
Epoch 4749 
Prediction Loss: 0.576695
Epoch 4799 
Prediction Loss: 0.620554
Epoch 4849 
Prediction Loss: 0.588378
Epoch 4899 
Prediction Loss: 0.578466
Epoch 4949 
Prediction Loss: 0.585647
Epoch 4999 
Prediction Loss: 0.572424
Epoch 5049 
Prediction Loss: 0.574615
Epoch 5099 
Prediction Loss: 0.599658
Epoch 5149 
Prediction Loss: 0.592064
Epoch 5199 
Prediction Loss: 0.567420
Epoch 5249 
Prediction Loss: 0.574881
Epoch 5299 
Prediction Loss: 0.555123
Epoch 5349 
Prediction Loss: 0.558438
Epoch 5399 
Prediction Loss: 0.591896
Epoch 5449 
Prediction Loss: 0.570005
Epoch 5499 
Prediction Loss: 0.557536
Epoch 5549 
Prediction Loss: 0.592304
Epoch 5599 
Prediction Loss: 0.559601
Epoch 5649 
Prediction Loss: 0.551403
Epoch 5699 
Prediction Loss: 0.547892
Epoch 5749 
Prediction Loss: 0.562161
Epoch 5799 
Prediction Loss: 0.555547
Epoch 5849 
Prediction Loss: 0.550544
Epoch 5899 
Prediction Loss: 0.553350
Epoch 5949 
Prediction Loss: 0.546657
Epoch 5999 
Prediction Loss: 0.549413
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.723903
Insample Error 3.643939
[31m========== repeat time 5 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.073699
Rec Loss: 11.347573
KL Loss: 1.726126
Y Loss: 0.993525
T Loss: 10.850811
Epoch 99 
Overall Loss: 12.881317
Rec Loss: 11.118169
KL Loss: 1.763147
Y Loss: 0.951556
T Loss: 10.642391
Epoch 149 
Overall Loss: 12.783539
Rec Loss: 10.882493
KL Loss: 1.901046
Y Loss: 0.930708
T Loss: 10.417139
Epoch 199 
Overall Loss: 12.755898
Rec Loss: 10.911036
KL Loss: 1.844862
Y Loss: 0.961415
T Loss: 10.430329
Epoch 249 
Overall Loss: 12.713306
Rec Loss: 10.885306
KL Loss: 1.828000
Y Loss: 0.920669
T Loss: 10.424971
Epoch 299 
Overall Loss: 12.684796
Rec Loss: 10.871633
KL Loss: 1.813163
Y Loss: 0.912831
T Loss: 10.415218
Epoch 349 
Overall Loss: 12.695358
Rec Loss: 10.880776
KL Loss: 1.814582
Y Loss: 0.919420
T Loss: 10.421066
Epoch 399 
Overall Loss: 12.693904
Rec Loss: 10.910126
KL Loss: 1.783778
Y Loss: 0.917107
T Loss: 10.451572
Epoch 449 
Overall Loss: 12.638273
Rec Loss: 10.863399
KL Loss: 1.774874
Y Loss: 0.918430
T Loss: 10.404185
Epoch 499 
Overall Loss: 12.657807
Rec Loss: 10.889063
KL Loss: 1.768744
Y Loss: 0.930605
T Loss: 10.423760
Epoch 549 
Overall Loss: 12.684125
Rec Loss: 10.901467
KL Loss: 1.782658
Y Loss: 0.940626
T Loss: 10.431154
Epoch 599 
Overall Loss: 12.646501
Rec Loss: 10.868129
KL Loss: 1.778372
Y Loss: 0.895726
T Loss: 10.420266
Epoch 649 
Overall Loss: 12.631966
Rec Loss: 10.860685
KL Loss: 1.771282
Y Loss: 0.890255
T Loss: 10.415557
Epoch 699 
Overall Loss: 12.634859
Rec Loss: 10.874288
KL Loss: 1.760571
Y Loss: 0.890825
T Loss: 10.428876
Epoch 749 
Overall Loss: 12.636425
Rec Loss: 10.861695
KL Loss: 1.774730
Y Loss: 0.904542
T Loss: 10.409424
Epoch 799 
Overall Loss: 12.612648
Rec Loss: 10.856035
KL Loss: 1.756613
Y Loss: 0.896135
T Loss: 10.407968
Epoch 849 
Overall Loss: 12.634493
Rec Loss: 10.861817
KL Loss: 1.772677
Y Loss: 0.899871
T Loss: 10.411881
Epoch 899 
Overall Loss: 12.589947
Rec Loss: 10.844905
KL Loss: 1.745042
Y Loss: 0.883304
T Loss: 10.403252
Epoch 949 
Overall Loss: 12.591739
Rec Loss: 10.856498
KL Loss: 1.735241
Y Loss: 0.889408
T Loss: 10.411793
Epoch 999 
Overall Loss: 12.579038
Rec Loss: 10.851961
KL Loss: 1.727077
Y Loss: 0.903860
T Loss: 10.400031
Epoch 1049 
Overall Loss: 12.600428
Rec Loss: 10.826841
KL Loss: 1.773587
Y Loss: 0.908239
T Loss: 10.372721
Epoch 1099 
Overall Loss: 12.577975
Rec Loss: 10.830944
KL Loss: 1.747031
Y Loss: 0.890085
T Loss: 10.385902
Epoch 1149 
Overall Loss: 12.572970
Rec Loss: 10.821186
KL Loss: 1.751784
Y Loss: 0.864367
T Loss: 10.389003
Epoch 1199 
Overall Loss: 12.587010
Rec Loss: 10.847474
KL Loss: 1.739536
Y Loss: 0.879806
T Loss: 10.407571
Epoch 1249 
Overall Loss: 12.560776
Rec Loss: 10.832935
KL Loss: 1.727841
Y Loss: 0.859105
T Loss: 10.403383
Epoch 1299 
Overall Loss: 12.577792
Rec Loss: 10.824526
KL Loss: 1.753266
Y Loss: 0.863864
T Loss: 10.392594
Epoch 1349 
Overall Loss: 12.552797
Rec Loss: 10.805448
KL Loss: 1.747349
Y Loss: 0.857310
T Loss: 10.376793
Epoch 1399 
Overall Loss: 12.557248
Rec Loss: 10.817372
KL Loss: 1.739877
Y Loss: 0.857527
T Loss: 10.388608
Epoch 1449 
Overall Loss: 12.557404
Rec Loss: 10.799369
KL Loss: 1.758035
Y Loss: 0.852255
T Loss: 10.373242
Epoch 1499 
Overall Loss: 12.558477
Rec Loss: 10.799310
KL Loss: 1.759167
Y Loss: 0.867203
T Loss: 10.365709
Epoch 1549 
Overall Loss: 12.555433
Rec Loss: 10.807535
KL Loss: 1.747897
Y Loss: 0.872120
T Loss: 10.371475
Epoch 1599 
Overall Loss: 12.536500
Rec Loss: 10.811470
KL Loss: 1.725030
Y Loss: 0.873377
T Loss: 10.374782
Epoch 1649 
Overall Loss: 12.546163
Rec Loss: 10.783908
KL Loss: 1.762255
Y Loss: 0.841702
T Loss: 10.363057
Epoch 1699 
Overall Loss: 12.567600
Rec Loss: 10.830546
KL Loss: 1.737054
Y Loss: 0.871149
T Loss: 10.394971
Epoch 1749 
Overall Loss: 12.531692
Rec Loss: 10.796555
KL Loss: 1.735137
Y Loss: 0.867576
T Loss: 10.362767
Epoch 1799 
Overall Loss: 12.527876
Rec Loss: 10.797843
KL Loss: 1.730034
Y Loss: 0.844005
T Loss: 10.375840
Epoch 1849 
Overall Loss: 12.523302
Rec Loss: 10.788425
KL Loss: 1.734877
Y Loss: 0.839480
T Loss: 10.368685
Epoch 1899 
Overall Loss: 12.533417
Rec Loss: 10.819569
KL Loss: 1.713847
Y Loss: 0.868871
T Loss: 10.385134
Epoch 1949 
Overall Loss: 12.520625
Rec Loss: 10.794004
KL Loss: 1.726621
Y Loss: 0.847925
T Loss: 10.370042
Epoch 1999 
Overall Loss: 12.506860
Rec Loss: 10.787499
KL Loss: 1.719361
Y Loss: 0.858473
T Loss: 10.358263
Epoch 2049 
Overall Loss: 12.523781
Rec Loss: 10.773075
KL Loss: 1.750706
Y Loss: 0.828125
T Loss: 10.359012
Epoch 2099 
Overall Loss: 12.507655
Rec Loss: 10.781036
KL Loss: 1.726618
Y Loss: 0.873555
T Loss: 10.344259
Epoch 2149 
Overall Loss: 12.521790
Rec Loss: 10.787127
KL Loss: 1.734662
Y Loss: 0.855347
T Loss: 10.359454
Epoch 2199 
Overall Loss: 12.511658
Rec Loss: 10.762589
KL Loss: 1.749069
Y Loss: 0.854121
T Loss: 10.335529
Epoch 2249 
Overall Loss: 12.518849
Rec Loss: 10.783399
KL Loss: 1.735450
Y Loss: 0.836516
T Loss: 10.365140
Epoch 2299 
Overall Loss: 12.496298
Rec Loss: 10.767849
KL Loss: 1.728449
Y Loss: 0.872255
T Loss: 10.331722
Epoch 2349 
Overall Loss: 12.512026
Rec Loss: 10.770499
KL Loss: 1.741527
Y Loss: 0.857583
T Loss: 10.341707
Epoch 2399 
Overall Loss: 12.509483
Rec Loss: 10.756031
KL Loss: 1.753452
Y Loss: 0.832770
T Loss: 10.339646
Epoch 2449 
Overall Loss: 12.478612
Rec Loss: 10.746071
KL Loss: 1.732540
Y Loss: 0.834322
T Loss: 10.328910
Epoch 2499 
Overall Loss: 12.483957
Rec Loss: 10.754486
KL Loss: 1.729471
Y Loss: 0.839466
T Loss: 10.334753
Epoch 2549 
Overall Loss: 12.498602
Rec Loss: 10.754358
KL Loss: 1.744245
Y Loss: 0.844578
T Loss: 10.332069
Epoch 2599 
Overall Loss: 12.464035
Rec Loss: 10.757166
KL Loss: 1.706869
Y Loss: 0.867064
T Loss: 10.323634
Epoch 2649 
Overall Loss: 12.472298
Rec Loss: 10.741170
KL Loss: 1.731128
Y Loss: 0.857914
T Loss: 10.312213
Epoch 2699 
Overall Loss: 12.483636
Rec Loss: 10.740258
KL Loss: 1.743378
Y Loss: 0.855711
T Loss: 10.312402
Epoch 2749 
Overall Loss: 12.494243
Rec Loss: 10.742436
KL Loss: 1.751807
Y Loss: 0.848345
T Loss: 10.318263
Epoch 2799 
Overall Loss: 12.467917
Rec Loss: 10.738845
KL Loss: 1.729073
Y Loss: 0.835529
T Loss: 10.321080
Epoch 2849 
Overall Loss: 12.445419
Rec Loss: 10.722496
KL Loss: 1.722923
Y Loss: 0.853514
T Loss: 10.295739
Epoch 2899 
Overall Loss: 12.470652
Rec Loss: 10.763333
KL Loss: 1.707319
Y Loss: 0.842770
T Loss: 10.341948
Epoch 2949 
Overall Loss: 12.450920
Rec Loss: 10.736700
KL Loss: 1.714221
Y Loss: 0.836996
T Loss: 10.318202
Epoch 2999 
Overall Loss: 12.453995
Rec Loss: 10.705453
KL Loss: 1.748542
Y Loss: 0.824370
T Loss: 10.293268
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.465887
Epoch 99
Rec Loss: 1.460273
Epoch 149
Rec Loss: 1.469292
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.925924
Epoch 99
Rec Loss: 9.918648
Epoch 149
Rec Loss: 9.914787
Epoch 199
Rec Loss: 9.915452
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.678914
Insample Error: 1.819900
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.278798
Rec Loss: 18.128768
KL Loss: 3.150030
Y Loss: 9.271455
T Loss: 12.909223
X Loss: 0.583818
Epoch 99 
Overall Loss: 16.605024
Rec Loss: 13.169248
KL Loss: 3.435776
Y Loss: 3.421355
T Loss: 12.912308
X Loss: -1.453737
Epoch 149 
Overall Loss: 15.609346
Rec Loss: 12.301336
KL Loss: 3.308010
Y Loss: 2.633360
T Loss: 12.978172
X Loss: -1.993516
Epoch 199 
Overall Loss: 14.818747
Rec Loss: 11.341940
KL Loss: 3.476807
Y Loss: 1.962784
T Loss: 12.642186
X Loss: -2.281638
Epoch 249 
Overall Loss: 14.386222
Rec Loss: 10.730440
KL Loss: 3.655782
Y Loss: 1.501851
T Loss: 12.446851
X Loss: -2.467337
Epoch 299 
Overall Loss: 14.141992
Rec Loss: 10.402105
KL Loss: 3.739887
Y Loss: 1.271936
T Loss: 12.347852
X Loss: -2.581714
Epoch 349 
Overall Loss: 14.012110
Rec Loss: 10.167350
KL Loss: 3.844760
Y Loss: 1.153788
T Loss: 12.274693
X Loss: -2.684237
Epoch 399 
Overall Loss: 13.919190
Rec Loss: 10.013888
KL Loss: 3.905302
Y Loss: 1.090568
T Loss: 12.193498
X Loss: -2.724894
Epoch 449 
Overall Loss: 13.712703
Rec Loss: 9.620448
KL Loss: 4.092255
Y Loss: 1.045229
T Loss: 11.933923
X Loss: -2.836089
Epoch 499 
Overall Loss: 13.481315
Rec Loss: 9.065003
KL Loss: 4.416312
Y Loss: 1.014642
T Loss: 11.615131
X Loss: -3.057450
Epoch 549 
Overall Loss: 13.316629
Rec Loss: 8.663706
KL Loss: 4.652923
Y Loss: 1.030006
T Loss: 11.342931
X Loss: -3.194229
Epoch 599 
Overall Loss: 13.173137
Rec Loss: 8.308042
KL Loss: 4.865094
Y Loss: 1.019139
T Loss: 11.127923
X Loss: -3.329450
Epoch 649 
Overall Loss: 13.069727
Rec Loss: 8.042923
KL Loss: 5.026804
Y Loss: 1.010273
T Loss: 10.957305
X Loss: -3.419518
Epoch 699 
Overall Loss: 13.016369
Rec Loss: 7.886978
KL Loss: 5.129391
Y Loss: 1.013365
T Loss: 10.843025
X Loss: -3.462729
Epoch 749 
Overall Loss: 12.993766
Rec Loss: 7.782362
KL Loss: 5.211404
Y Loss: 1.006188
T Loss: 10.819560
X Loss: -3.540293
Epoch 799 
Overall Loss: 12.897996
Rec Loss: 7.704534
KL Loss: 5.193462
Y Loss: 0.973574
T Loss: 10.772511
X Loss: -3.554764
Epoch 849 
Overall Loss: 12.885423
Rec Loss: 7.619679
KL Loss: 5.265744
Y Loss: 0.956355
T Loss: 10.729495
X Loss: -3.587994
Epoch 899 
Overall Loss: 12.836710
Rec Loss: 7.545071
KL Loss: 5.291639
Y Loss: 0.941192
T Loss: 10.692272
X Loss: -3.617797
Epoch 949 
Overall Loss: 12.852822
Rec Loss: 7.563061
KL Loss: 5.289760
Y Loss: 0.961173
T Loss: 10.703888
X Loss: -3.621414
Epoch 999 
Overall Loss: 12.827729
Rec Loss: 7.504947
KL Loss: 5.322781
Y Loss: 0.925662
T Loss: 10.698222
X Loss: -3.656106
Epoch 1049 
Overall Loss: 12.787958
Rec Loss: 7.465303
KL Loss: 5.322655
Y Loss: 0.938137
T Loss: 10.680438
X Loss: -3.684203
Epoch 1099 
Overall Loss: 12.746779
Rec Loss: 7.397292
KL Loss: 5.349486
Y Loss: 0.919617
T Loss: 10.660570
X Loss: -3.723086
Epoch 1149 
Overall Loss: 12.801361
Rec Loss: 7.447834
KL Loss: 5.353526
Y Loss: 0.936544
T Loss: 10.693277
X Loss: -3.713715
Epoch 1199 
Overall Loss: 12.785199
Rec Loss: 7.410946
KL Loss: 5.374252
Y Loss: 0.933023
T Loss: 10.686016
X Loss: -3.741581
Epoch 1249 
Overall Loss: 12.768318
Rec Loss: 7.424061
KL Loss: 5.344257
Y Loss: 0.953113
T Loss: 10.685568
X Loss: -3.738064
Epoch 1299 
Overall Loss: 12.748158
Rec Loss: 7.352815
KL Loss: 5.395343
Y Loss: 0.917464
T Loss: 10.674582
X Loss: -3.780500
Epoch 1349 
Overall Loss: 12.746554
Rec Loss: 7.367573
KL Loss: 5.378981
Y Loss: 0.947837
T Loss: 10.668606
X Loss: -3.774951
Epoch 1399 
Overall Loss: 12.730436
Rec Loss: 7.338382
KL Loss: 5.392054
Y Loss: 0.928956
T Loss: 10.665367
X Loss: -3.791463
Epoch 1449 
Overall Loss: 12.724135
Rec Loss: 7.326043
KL Loss: 5.398091
Y Loss: 0.915715
T Loss: 10.672506
X Loss: -3.804320
Epoch 1499 
Overall Loss: 12.700282
Rec Loss: 7.288633
KL Loss: 5.411649
Y Loss: 0.927255
T Loss: 10.668740
X Loss: -3.843735
Epoch 1549 
Overall Loss: 12.703353
Rec Loss: 7.291462
KL Loss: 5.411891
Y Loss: 0.927586
T Loss: 10.680017
X Loss: -3.852348
Epoch 1599 
Overall Loss: 12.684858
Rec Loss: 7.252243
KL Loss: 5.432615
Y Loss: 0.905050
T Loss: 10.656286
X Loss: -3.856568
Epoch 1649 
Overall Loss: 12.704909
Rec Loss: 7.276825
KL Loss: 5.428084
Y Loss: 0.925408
T Loss: 10.686359
X Loss: -3.872238
Epoch 1699 
Overall Loss: 12.720603
Rec Loss: 7.270912
KL Loss: 5.449691
Y Loss: 0.914593
T Loss: 10.689067
X Loss: -3.875451
Epoch 1749 
Overall Loss: 12.696340
Rec Loss: 7.248447
KL Loss: 5.447892
Y Loss: 0.928577
T Loss: 10.681409
X Loss: -3.897250
Epoch 1799 
Overall Loss: 12.669095
Rec Loss: 7.203388
KL Loss: 5.465707
Y Loss: 0.929343
T Loss: 10.664984
X Loss: -3.926268
Epoch 1849 
Overall Loss: 12.658886
Rec Loss: 7.209728
KL Loss: 5.449158
Y Loss: 0.923095
T Loss: 10.680188
X Loss: -3.932008
Epoch 1899 
Overall Loss: 12.637077
Rec Loss: 7.157389
KL Loss: 5.479687
Y Loss: 0.929374
T Loss: 10.662897
X Loss: -3.970195
Epoch 1949 
Overall Loss: 12.659637
Rec Loss: 7.150655
KL Loss: 5.508982
Y Loss: 0.928650
T Loss: 10.670612
X Loss: -3.984282
Epoch 1999 
Overall Loss: 12.634147
Rec Loss: 7.131362
KL Loss: 5.502784
Y Loss: 0.908464
T Loss: 10.684451
X Loss: -4.007320
Epoch 2049 
Overall Loss: 12.651325
Rec Loss: 7.129543
KL Loss: 5.521782
Y Loss: 0.906797
T Loss: 10.690394
X Loss: -4.014249
Epoch 2099 
Overall Loss: 12.648849
Rec Loss: 7.111128
KL Loss: 5.537721
Y Loss: 0.913374
T Loss: 10.699031
X Loss: -4.044590
Epoch 2149 
Overall Loss: 12.641697
Rec Loss: 7.086218
KL Loss: 5.555479
Y Loss: 0.881794
T Loss: 10.686831
X Loss: -4.041510
Epoch 2199 
Overall Loss: 12.636332
Rec Loss: 7.089660
KL Loss: 5.546672
Y Loss: 0.901059
T Loss: 10.711410
X Loss: -4.072279
Epoch 2249 
Overall Loss: 12.623224
Rec Loss: 7.072241
KL Loss: 5.550983
Y Loss: 0.896875
T Loss: 10.692132
X Loss: -4.068328
Epoch 2299 
Overall Loss: 12.636052
Rec Loss: 7.042525
KL Loss: 5.593526
Y Loss: 0.918744
T Loss: 10.695570
X Loss: -4.112416
Epoch 2349 
Overall Loss: 12.636599
Rec Loss: 7.063350
KL Loss: 5.573249
Y Loss: 0.911780
T Loss: 10.712177
X Loss: -4.104716
Epoch 2399 
Overall Loss: 12.652748
Rec Loss: 7.058133
KL Loss: 5.594614
Y Loss: 0.916863
T Loss: 10.704840
X Loss: -4.105138
Epoch 2449 
Overall Loss: 12.613549
Rec Loss: 7.029186
KL Loss: 5.584363
Y Loss: 0.916912
T Loss: 10.700400
X Loss: -4.129669
Epoch 2499 
Overall Loss: 12.617510
Rec Loss: 6.995667
KL Loss: 5.621843
Y Loss: 0.896100
T Loss: 10.693659
X Loss: -4.146042
Epoch 2549 
Overall Loss: 12.627047
Rec Loss: 6.993910
KL Loss: 5.633138
Y Loss: 0.909067
T Loss: 10.722002
X Loss: -4.182626
Epoch 2599 
Overall Loss: 12.625988
Rec Loss: 7.017298
KL Loss: 5.608690
Y Loss: 0.937182
T Loss: 10.699506
X Loss: -4.150799
Epoch 2649 
Overall Loss: 12.614699
Rec Loss: 6.989301
KL Loss: 5.625398
Y Loss: 0.909995
T Loss: 10.713427
X Loss: -4.179124
Epoch 2699 
Overall Loss: 12.610467
Rec Loss: 7.018417
KL Loss: 5.592049
Y Loss: 0.943339
T Loss: 10.724535
X Loss: -4.177787
Epoch 2749 
Overall Loss: 12.627206
Rec Loss: 6.967104
KL Loss: 5.660102
Y Loss: 0.925102
T Loss: 10.702772
X Loss: -4.198219
Epoch 2799 
Overall Loss: 12.599837
Rec Loss: 6.952432
KL Loss: 5.647406
Y Loss: 0.926191
T Loss: 10.694243
X Loss: -4.204907
Epoch 2849 
Overall Loss: 12.609542
Rec Loss: 6.952999
KL Loss: 5.656543
Y Loss: 0.916483
T Loss: 10.714281
X Loss: -4.219523
Epoch 2899 
Overall Loss: 12.630534
Rec Loss: 6.964508
KL Loss: 5.666026
Y Loss: 0.916865
T Loss: 10.725354
X Loss: -4.219278
Epoch 2949 
Overall Loss: 12.618474
Rec Loss: 6.938434
KL Loss: 5.680040
Y Loss: 0.923962
T Loss: 10.716795
X Loss: -4.240342
Epoch 2999 
Overall Loss: 12.601665
Rec Loss: 6.929711
KL Loss: 5.671954
Y Loss: 0.892571
T Loss: 10.713621
X Loss: -4.230196
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.884764
Epoch 99
Rec Loss: 1.888613
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.009361
Epoch 99
Rec Loss: 1.997852
Epoch 149
Rec Loss: 1.998175
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.644181
Insample Error 2.504550
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.522592
Epoch 99 
Prediction Loss: 2.392721
Epoch 149 
Prediction Loss: 2.205991
Epoch 199 
Prediction Loss: 2.163665
Epoch 249 
Prediction Loss: 2.025874
Epoch 299 
Prediction Loss: 1.961999
Epoch 349 
Prediction Loss: 1.813800
Epoch 399 
Prediction Loss: 1.784007
Epoch 449 
Prediction Loss: 1.651772
Epoch 499 
Prediction Loss: 1.636209
Epoch 549 
Prediction Loss: 1.508945
Epoch 599 
Prediction Loss: 1.455674
Epoch 649 
Prediction Loss: 1.354766
Epoch 699 
Prediction Loss: 1.290818
Epoch 749 
Prediction Loss: 1.223914
Epoch 799 
Prediction Loss: 1.181004
Epoch 849 
Prediction Loss: 1.130215
Epoch 899 
Prediction Loss: 1.055806
Epoch 949 
Prediction Loss: 1.038505
Epoch 999 
Prediction Loss: 1.016433
Epoch 1049 
Prediction Loss: 0.981592
Epoch 1099 
Prediction Loss: 0.997938
Epoch 1149 
Prediction Loss: 0.952043
Epoch 1199 
Prediction Loss: 0.904474
Epoch 1249 
Prediction Loss: 0.886712
Epoch 1299 
Prediction Loss: 0.850827
Epoch 1349 
Prediction Loss: 0.855354
Epoch 1399 
Prediction Loss: 0.823262
Epoch 1449 
Prediction Loss: 0.810492
Epoch 1499 
Prediction Loss: 0.787419
Epoch 1549 
Prediction Loss: 0.798248
Epoch 1599 
Prediction Loss: 0.785463
Epoch 1649 
Prediction Loss: 0.755227
Epoch 1699 
Prediction Loss: 0.779976
Epoch 1749 
Prediction Loss: 0.806289
Epoch 1799 
Prediction Loss: 0.754637
Epoch 1849 
Prediction Loss: 0.737565
Epoch 1899 
Prediction Loss: 0.740135
Epoch 1949 
Prediction Loss: 0.749897
Epoch 1999 
Prediction Loss: 0.738363
Epoch 2049 
Prediction Loss: 0.723628
Epoch 2099 
Prediction Loss: 0.704269
Epoch 2149 
Prediction Loss: 0.699444
Epoch 2199 
Prediction Loss: 0.682240
Epoch 2249 
Prediction Loss: 0.697716
Epoch 2299 
Prediction Loss: 0.678580
Epoch 2349 
Prediction Loss: 0.683670
Epoch 2399 
Prediction Loss: 0.663912
Epoch 2449 
Prediction Loss: 0.665020
Epoch 2499 
Prediction Loss: 0.680139
Epoch 2549 
Prediction Loss: 0.656420
Epoch 2599 
Prediction Loss: 0.688042
Epoch 2649 
Prediction Loss: 0.663451
Epoch 2699 
Prediction Loss: 0.656232
Epoch 2749 
Prediction Loss: 0.632148
Epoch 2799 
Prediction Loss: 0.626175
Epoch 2849 
Prediction Loss: 0.608088
Epoch 2899 
Prediction Loss: 0.620934
Epoch 2949 
Prediction Loss: 0.613322
Epoch 2999 
Prediction Loss: 0.617463
Epoch 3049 
Prediction Loss: 0.607264
Epoch 3099 
Prediction Loss: 0.605571
Epoch 3149 
Prediction Loss: 0.607827
Epoch 3199 
Prediction Loss: 0.606945
Epoch 3249 
Prediction Loss: 0.582963
Epoch 3299 
Prediction Loss: 0.596706
Epoch 3349 
Prediction Loss: 0.595118
Epoch 3399 
Prediction Loss: 0.617051
Epoch 3449 
Prediction Loss: 0.592321
Epoch 3499 
Prediction Loss: 0.586934
Epoch 3549 
Prediction Loss: 0.615462
Epoch 3599 
Prediction Loss: 0.578725
Epoch 3649 
Prediction Loss: 0.569673
Epoch 3699 
Prediction Loss: 0.579516
Epoch 3749 
Prediction Loss: 0.585577
Epoch 3799 
Prediction Loss: 0.560318
Epoch 3849 
Prediction Loss: 0.626381
Epoch 3899 
Prediction Loss: 0.586840
Epoch 3949 
Prediction Loss: 0.582234
Epoch 3999 
Prediction Loss: 0.569713
Epoch 4049 
Prediction Loss: 0.580329
Epoch 4099 
Prediction Loss: 0.587970
Epoch 4149 
Prediction Loss: 0.566162
Epoch 4199 
Prediction Loss: 0.562740
Epoch 4249 
Prediction Loss: 0.558297
Epoch 4299 
Prediction Loss: 0.564792
Epoch 4349 
Prediction Loss: 0.584697
Epoch 4399 
Prediction Loss: 0.572820
Epoch 4449 
Prediction Loss: 0.546301
Epoch 4499 
Prediction Loss: 0.542097
Epoch 4549 
Prediction Loss: 0.555246
Epoch 4599 
Prediction Loss: 0.545874
Epoch 4649 
Prediction Loss: 0.542694
Epoch 4699 
Prediction Loss: 0.548932
Epoch 4749 
Prediction Loss: 0.549117
Epoch 4799 
Prediction Loss: 0.545543
Epoch 4849 
Prediction Loss: 0.541043
Epoch 4899 
Prediction Loss: 0.540046
Epoch 4949 
Prediction Loss: 0.574413
Epoch 4999 
Prediction Loss: 0.550907
Epoch 5049 
Prediction Loss: 0.561171
Epoch 5099 
Prediction Loss: 0.534694
Epoch 5149 
Prediction Loss: 0.539993
Epoch 5199 
Prediction Loss: 0.539414
Epoch 5249 
Prediction Loss: 0.530843
Epoch 5299 
Prediction Loss: 0.541384
Epoch 5349 
Prediction Loss: 0.545602
Epoch 5399 
Prediction Loss: 0.532630
Epoch 5449 
Prediction Loss: 0.530901
Epoch 5499 
Prediction Loss: 0.526825
Epoch 5549 
Prediction Loss: 0.533891
Epoch 5599 
Prediction Loss: 0.536832
Epoch 5649 
Prediction Loss: 0.557471
Epoch 5699 
Prediction Loss: 0.525208
Epoch 5749 
Prediction Loss: 0.523123
Epoch 5799 
Prediction Loss: 0.523735
Epoch 5849 
Prediction Loss: 0.530700
Epoch 5899 
Prediction Loss: 0.512759
Epoch 5949 
Prediction Loss: 0.541237
Epoch 5999 
Prediction Loss: 0.526323
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.712447
Insample Error 3.643480
[31m========== repeat time 6 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.083019
Rec Loss: 11.319950
KL Loss: 1.763068
Y Loss: 1.027102
T Loss: 10.806399
Epoch 99 
Overall Loss: 12.920697
Rec Loss: 11.200330
KL Loss: 1.720367
Y Loss: 0.942327
T Loss: 10.729166
Epoch 149 
Overall Loss: 12.854464
Rec Loss: 11.202324
KL Loss: 1.652140
Y Loss: 0.927337
T Loss: 10.738656
Epoch 199 
Overall Loss: 12.787811
Rec Loss: 11.186771
KL Loss: 1.601040
Y Loss: 0.923456
T Loss: 10.725042
Epoch 249 
Overall Loss: 12.718721
Rec Loss: 10.933017
KL Loss: 1.785703
Y Loss: 0.927569
T Loss: 10.469233
Epoch 299 
Overall Loss: 12.698096
Rec Loss: 10.894305
KL Loss: 1.803791
Y Loss: 0.920088
T Loss: 10.434261
Epoch 349 
Overall Loss: 12.705639
Rec Loss: 10.893641
KL Loss: 1.811998
Y Loss: 0.901914
T Loss: 10.442683
Epoch 399 
Overall Loss: 12.673072
Rec Loss: 10.876582
KL Loss: 1.796490
Y Loss: 0.896454
T Loss: 10.428355
Epoch 449 
Overall Loss: 12.670167
Rec Loss: 10.889807
KL Loss: 1.780360
Y Loss: 0.909903
T Loss: 10.434856
Epoch 499 
Overall Loss: 12.660694
Rec Loss: 10.873356
KL Loss: 1.787338
Y Loss: 0.893030
T Loss: 10.426841
Epoch 549 
Overall Loss: 12.659986
Rec Loss: 10.874805
KL Loss: 1.785181
Y Loss: 0.913562
T Loss: 10.418024
Epoch 599 
Overall Loss: 12.632787
Rec Loss: 10.821687
KL Loss: 1.811100
Y Loss: 0.891195
T Loss: 10.376089
Epoch 649 
Overall Loss: 12.652672
Rec Loss: 10.885776
KL Loss: 1.766896
Y Loss: 0.890577
T Loss: 10.440487
Epoch 699 
Overall Loss: 12.635310
Rec Loss: 10.860704
KL Loss: 1.774605
Y Loss: 0.898227
T Loss: 10.411591
Epoch 749 
Overall Loss: 12.626267
Rec Loss: 10.860919
KL Loss: 1.765348
Y Loss: 0.881675
T Loss: 10.420082
Epoch 799 
Overall Loss: 12.606592
Rec Loss: 10.850232
KL Loss: 1.756359
Y Loss: 0.884658
T Loss: 10.407903
Epoch 849 
Overall Loss: 12.612247
Rec Loss: 10.866850
KL Loss: 1.745396
Y Loss: 0.905454
T Loss: 10.414123
Epoch 899 
Overall Loss: 12.599738
Rec Loss: 10.858048
KL Loss: 1.741690
Y Loss: 0.879076
T Loss: 10.418510
Epoch 949 
Overall Loss: 12.595240
Rec Loss: 10.844175
KL Loss: 1.751065
Y Loss: 0.877928
T Loss: 10.405211
Epoch 999 
Overall Loss: 12.608032
Rec Loss: 10.845130
KL Loss: 1.762902
Y Loss: 0.874432
T Loss: 10.407914
Epoch 1049 
Overall Loss: 12.608680
Rec Loss: 10.840261
KL Loss: 1.768419
Y Loss: 0.873851
T Loss: 10.403335
Epoch 1099 
Overall Loss: 12.583746
Rec Loss: 10.840751
KL Loss: 1.742995
Y Loss: 0.871128
T Loss: 10.405187
Epoch 1149 
Overall Loss: 12.581804
Rec Loss: 10.836203
KL Loss: 1.745601
Y Loss: 0.873328
T Loss: 10.399539
Epoch 1199 
Overall Loss: 12.576003
Rec Loss: 10.839524
KL Loss: 1.736479
Y Loss: 0.899757
T Loss: 10.389646
Epoch 1249 
Overall Loss: 12.567689
Rec Loss: 10.820647
KL Loss: 1.747042
Y Loss: 0.849258
T Loss: 10.396017
Epoch 1299 
Overall Loss: 12.567478
Rec Loss: 10.824861
KL Loss: 1.742618
Y Loss: 0.865477
T Loss: 10.392122
Epoch 1349 
Overall Loss: 12.559454
Rec Loss: 10.804906
KL Loss: 1.754548
Y Loss: 0.857201
T Loss: 10.376306
Epoch 1399 
Overall Loss: 12.578184
Rec Loss: 10.827261
KL Loss: 1.750923
Y Loss: 0.878284
T Loss: 10.388119
Epoch 1449 
Overall Loss: 12.556813
Rec Loss: 10.814716
KL Loss: 1.742097
Y Loss: 0.833703
T Loss: 10.397864
Epoch 1499 
Overall Loss: 12.570928
Rec Loss: 10.810619
KL Loss: 1.760309
Y Loss: 0.880972
T Loss: 10.370132
Epoch 1549 
Overall Loss: 12.580549
Rec Loss: 10.823837
KL Loss: 1.756712
Y Loss: 0.867671
T Loss: 10.390001
Epoch 1599 
Overall Loss: 12.526503
Rec Loss: 10.806434
KL Loss: 1.720069
Y Loss: 0.857524
T Loss: 10.377672
Epoch 1649 
Overall Loss: 12.545760
Rec Loss: 10.818715
KL Loss: 1.727045
Y Loss: 0.860113
T Loss: 10.388658
Epoch 1699 
Overall Loss: 12.573003
Rec Loss: 10.813798
KL Loss: 1.759205
Y Loss: 0.872062
T Loss: 10.377767
Epoch 1749 
Overall Loss: 12.513045
Rec Loss: 10.773910
KL Loss: 1.739135
Y Loss: 0.841351
T Loss: 10.353235
Epoch 1799 
Overall Loss: 12.545326
Rec Loss: 10.792524
KL Loss: 1.752802
Y Loss: 0.862536
T Loss: 10.361256
Epoch 1849 
Overall Loss: 12.520036
Rec Loss: 10.804232
KL Loss: 1.715804
Y Loss: 0.872561
T Loss: 10.367951
Epoch 1899 
Overall Loss: 12.519020
Rec Loss: 10.776326
KL Loss: 1.742694
Y Loss: 0.849961
T Loss: 10.351345
Epoch 1949 
Overall Loss: 12.525218
Rec Loss: 10.768556
KL Loss: 1.756661
Y Loss: 0.868731
T Loss: 10.334191
Epoch 1999 
Overall Loss: 12.499072
Rec Loss: 10.752529
KL Loss: 1.746544
Y Loss: 0.846793
T Loss: 10.329132
Epoch 2049 
Overall Loss: 12.523332
Rec Loss: 10.793477
KL Loss: 1.729855
Y Loss: 0.862017
T Loss: 10.362469
Epoch 2099 
Overall Loss: 12.517374
Rec Loss: 10.780936
KL Loss: 1.736438
Y Loss: 0.856214
T Loss: 10.352828
Epoch 2149 
Overall Loss: 12.518323
Rec Loss: 10.752666
KL Loss: 1.765657
Y Loss: 0.846831
T Loss: 10.329250
Epoch 2199 
Overall Loss: 12.511806
Rec Loss: 10.772415
KL Loss: 1.739391
Y Loss: 0.854587
T Loss: 10.345122
Epoch 2249 
Overall Loss: 12.477385
Rec Loss: 10.748807
KL Loss: 1.728578
Y Loss: 0.844214
T Loss: 10.326700
Epoch 2299 
Overall Loss: 12.521590
Rec Loss: 10.783376
KL Loss: 1.738214
Y Loss: 0.853909
T Loss: 10.356422
Epoch 2349 
Overall Loss: 12.500543
Rec Loss: 10.788560
KL Loss: 1.711983
Y Loss: 0.853332
T Loss: 10.361894
Epoch 2399 
Overall Loss: 12.481167
Rec Loss: 10.752180
KL Loss: 1.728987
Y Loss: 0.827987
T Loss: 10.338186
Epoch 2449 
Overall Loss: 12.477556
Rec Loss: 10.753059
KL Loss: 1.724496
Y Loss: 0.846822
T Loss: 10.329649
Epoch 2499 
Overall Loss: 12.488217
Rec Loss: 10.764212
KL Loss: 1.724005
Y Loss: 0.853570
T Loss: 10.337427
Epoch 2549 
Overall Loss: 12.476658
Rec Loss: 10.741535
KL Loss: 1.735123
Y Loss: 0.838904
T Loss: 10.322083
Epoch 2599 
Overall Loss: 12.479656
Rec Loss: 10.747487
KL Loss: 1.732169
Y Loss: 0.848460
T Loss: 10.323256
Epoch 2649 
Overall Loss: 12.470092
Rec Loss: 10.745905
KL Loss: 1.724187
Y Loss: 0.846405
T Loss: 10.322702
Epoch 2699 
Overall Loss: 12.484696
Rec Loss: 10.753925
KL Loss: 1.730772
Y Loss: 0.833645
T Loss: 10.337102
Epoch 2749 
Overall Loss: 12.449375
Rec Loss: 10.742953
KL Loss: 1.706422
Y Loss: 0.854798
T Loss: 10.315554
Epoch 2799 
Overall Loss: 12.465097
Rec Loss: 10.747624
KL Loss: 1.717473
Y Loss: 0.843663
T Loss: 10.325792
Epoch 2849 
Overall Loss: 12.428466
Rec Loss: 10.717318
KL Loss: 1.711148
Y Loss: 0.818123
T Loss: 10.308257
Epoch 2899 
Overall Loss: 12.462817
Rec Loss: 10.757688
KL Loss: 1.705129
Y Loss: 0.828685
T Loss: 10.343345
Epoch 2949 
Overall Loss: 12.455274
Rec Loss: 10.710937
KL Loss: 1.744337
Y Loss: 0.838333
T Loss: 10.291770
Epoch 2999 
Overall Loss: 12.443637
Rec Loss: 10.739535
KL Loss: 1.704103
Y Loss: 0.840179
T Loss: 10.319446
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.484754
Epoch 99
Rec Loss: 1.472119
Epoch 149
Rec Loss: 1.463104
Epoch 199
Rec Loss: 1.486575
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.908646
Epoch 99
Rec Loss: 9.901136
Epoch 149
Rec Loss: 9.902060
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.689911
Insample Error: 1.847080
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.097844
Rec Loss: 19.102319
KL Loss: 2.995527
Y Loss: 9.375521
T Loss: 12.933099
X Loss: 1.481459
Epoch 99 
Overall Loss: 16.605654
Rec Loss: 13.217246
KL Loss: 3.388408
Y Loss: 3.130683
T Loss: 12.914085
X Loss: -1.262180
Epoch 149 
Overall Loss: 15.570812
Rec Loss: 12.253418
KL Loss: 3.317394
Y Loss: 2.305777
T Loss: 12.964803
X Loss: -1.864273
Epoch 199 
Overall Loss: 14.861067
Rec Loss: 11.452010
KL Loss: 3.409057
Y Loss: 1.718728
T Loss: 12.787146
X Loss: -2.194500
Epoch 249 
Overall Loss: 14.375460
Rec Loss: 10.768945
KL Loss: 3.606515
Y Loss: 1.284844
T Loss: 12.528441
X Loss: -2.401918
Epoch 299 
Overall Loss: 13.932459
Rec Loss: 10.004937
KL Loss: 3.927521
Y Loss: 1.116980
T Loss: 12.066671
X Loss: -2.620225
Epoch 349 
Overall Loss: 13.611233
Rec Loss: 9.272915
KL Loss: 4.338318
Y Loss: 1.028811
T Loss: 11.625620
X Loss: -2.867110
Epoch 399 
Overall Loss: 13.479618
Rec Loss: 9.063991
KL Loss: 4.415628
Y Loss: 1.041463
T Loss: 11.531882
X Loss: -2.988622
Epoch 449 
Overall Loss: 13.396226
Rec Loss: 8.886630
KL Loss: 4.509595
Y Loss: 1.044914
T Loss: 11.477457
X Loss: -3.113284
Epoch 499 
Overall Loss: 13.316013
Rec Loss: 8.759629
KL Loss: 4.556383
Y Loss: 1.067870
T Loss: 11.427826
X Loss: -3.202132
Epoch 549 
Overall Loss: 13.264150
Rec Loss: 8.664548
KL Loss: 4.599602
Y Loss: 1.033950
T Loss: 11.410403
X Loss: -3.262830
Epoch 599 
Overall Loss: 13.242762
Rec Loss: 8.640197
KL Loss: 4.602565
Y Loss: 1.039982
T Loss: 11.374227
X Loss: -3.254021
Epoch 649 
Overall Loss: 13.226795
Rec Loss: 8.576861
KL Loss: 4.649934
Y Loss: 1.049684
T Loss: 11.365436
X Loss: -3.313417
Epoch 699 
Overall Loss: 13.161405
Rec Loss: 8.493890
KL Loss: 4.667515
Y Loss: 1.017952
T Loss: 11.340642
X Loss: -3.355728
Epoch 749 
Overall Loss: 13.144244
Rec Loss: 8.454919
KL Loss: 4.689325
Y Loss: 0.965453
T Loss: 11.344699
X Loss: -3.372507
Epoch 799 
Overall Loss: 13.152934
Rec Loss: 8.482351
KL Loss: 4.670583
Y Loss: 1.026715
T Loss: 11.337478
X Loss: -3.368484
Epoch 849 
Overall Loss: 13.122650
Rec Loss: 8.421125
KL Loss: 4.701525
Y Loss: 0.978786
T Loss: 11.332047
X Loss: -3.400315
Epoch 899 
Overall Loss: 13.116553
Rec Loss: 8.390326
KL Loss: 4.726227
Y Loss: 0.972724
T Loss: 11.337989
X Loss: -3.434024
Epoch 949 
Overall Loss: 13.085485
Rec Loss: 8.384134
KL Loss: 4.701352
Y Loss: 0.958895
T Loss: 11.349276
X Loss: -3.444589
Epoch 999 
Overall Loss: 13.037194
Rec Loss: 8.313910
KL Loss: 4.723284
Y Loss: 0.964012
T Loss: 11.310521
X Loss: -3.478617
Epoch 1049 
Overall Loss: 13.065915
Rec Loss: 8.329792
KL Loss: 4.736123
Y Loss: 0.983482
T Loss: 11.320878
X Loss: -3.482827
Epoch 1099 
Overall Loss: 13.063793
Rec Loss: 8.319106
KL Loss: 4.744687
Y Loss: 0.933299
T Loss: 11.350392
X Loss: -3.497935
Epoch 1149 
Overall Loss: 13.032107
Rec Loss: 8.267037
KL Loss: 4.765070
Y Loss: 0.981188
T Loss: 11.325687
X Loss: -3.549244
Epoch 1199 
Overall Loss: 13.026827
Rec Loss: 8.239048
KL Loss: 4.787780
Y Loss: 0.956052
T Loss: 11.317948
X Loss: -3.556926
Epoch 1249 
Overall Loss: 13.024483
Rec Loss: 8.222202
KL Loss: 4.802280
Y Loss: 0.967793
T Loss: 11.312642
X Loss: -3.574336
Epoch 1299 
Overall Loss: 12.957160
Rec Loss: 8.132936
KL Loss: 4.824223
Y Loss: 0.935465
T Loss: 11.281228
X Loss: -3.616024
Epoch 1349 
Overall Loss: 12.943031
Rec Loss: 8.054992
KL Loss: 4.888039
Y Loss: 0.944443
T Loss: 11.231829
X Loss: -3.649058
Epoch 1399 
Overall Loss: 12.869089
Rec Loss: 7.801978
KL Loss: 5.067111
Y Loss: 0.958051
T Loss: 11.014736
X Loss: -3.691783
Epoch 1449 
Overall Loss: 12.760984
Rec Loss: 7.510086
KL Loss: 5.250898
Y Loss: 0.943863
T Loss: 10.802081
X Loss: -3.763927
Epoch 1499 
Overall Loss: 12.747291
Rec Loss: 7.428700
KL Loss: 5.318592
Y Loss: 0.965205
T Loss: 10.741353
X Loss: -3.795255
Epoch 1549 
Overall Loss: 12.762624
Rec Loss: 7.383993
KL Loss: 5.378631
Y Loss: 0.948994
T Loss: 10.744215
X Loss: -3.834719
Epoch 1599 
Overall Loss: 12.695419
Rec Loss: 7.291327
KL Loss: 5.404093
Y Loss: 0.938244
T Loss: 10.709515
X Loss: -3.887310
Epoch 1649 
Overall Loss: 12.687441
Rec Loss: 7.268867
KL Loss: 5.418574
Y Loss: 0.932020
T Loss: 10.706777
X Loss: -3.903920
Epoch 1699 
Overall Loss: 12.687404
Rec Loss: 7.233721
KL Loss: 5.453683
Y Loss: 0.920233
T Loss: 10.696790
X Loss: -3.923185
Epoch 1749 
Overall Loss: 12.689997
Rec Loss: 7.231739
KL Loss: 5.458258
Y Loss: 0.943404
T Loss: 10.700702
X Loss: -3.940665
Epoch 1799 
Overall Loss: 12.707286
Rec Loss: 7.222150
KL Loss: 5.485136
Y Loss: 0.933350
T Loss: 10.706388
X Loss: -3.950914
Epoch 1849 
Overall Loss: 12.664173
Rec Loss: 7.177032
KL Loss: 5.487141
Y Loss: 0.936313
T Loss: 10.703171
X Loss: -3.994295
Epoch 1899 
Overall Loss: 12.671661
Rec Loss: 7.166534
KL Loss: 5.505128
Y Loss: 0.920798
T Loss: 10.711181
X Loss: -4.005046
Epoch 1949 
Overall Loss: 12.649268
Rec Loss: 7.142627
KL Loss: 5.506641
Y Loss: 0.929874
T Loss: 10.698331
X Loss: -4.020641
Epoch 1999 
Overall Loss: 12.648265
Rec Loss: 7.107698
KL Loss: 5.540567
Y Loss: 0.928808
T Loss: 10.699574
X Loss: -4.056280
Epoch 2049 
Overall Loss: 12.639693
Rec Loss: 7.105965
KL Loss: 5.533727
Y Loss: 0.933946
T Loss: 10.708422
X Loss: -4.069430
Epoch 2099 
Overall Loss: 12.629726
Rec Loss: 7.082871
KL Loss: 5.546855
Y Loss: 0.931826
T Loss: 10.698744
X Loss: -4.081787
Epoch 2149 
Overall Loss: 12.639925
Rec Loss: 7.066779
KL Loss: 5.573147
Y Loss: 0.918668
T Loss: 10.698912
X Loss: -4.091467
Epoch 2199 
Overall Loss: 12.626123
Rec Loss: 7.028370
KL Loss: 5.597753
Y Loss: 0.923629
T Loss: 10.691879
X Loss: -4.125324
Epoch 2249 
Overall Loss: 12.623728
Rec Loss: 7.020563
KL Loss: 5.603165
Y Loss: 0.932157
T Loss: 10.686544
X Loss: -4.132060
Epoch 2299 
Overall Loss: 12.653783
Rec Loss: 7.062108
KL Loss: 5.591675
Y Loss: 0.952104
T Loss: 10.716494
X Loss: -4.130437
Epoch 2349 
Overall Loss: 12.635217
Rec Loss: 7.004481
KL Loss: 5.630737
Y Loss: 0.940108
T Loss: 10.695551
X Loss: -4.161124
Epoch 2399 
Overall Loss: 12.640116
Rec Loss: 7.020581
KL Loss: 5.619536
Y Loss: 0.926573
T Loss: 10.719906
X Loss: -4.162612
Epoch 2449 
Overall Loss: 12.628026
Rec Loss: 6.996366
KL Loss: 5.631659
Y Loss: 0.924370
T Loss: 10.710316
X Loss: -4.176135
Epoch 2499 
Overall Loss: 12.578112
Rec Loss: 6.956696
KL Loss: 5.621415
Y Loss: 0.921908
T Loss: 10.697846
X Loss: -4.202104
Epoch 2549 
Overall Loss: 12.599933
Rec Loss: 6.939227
KL Loss: 5.660706
Y Loss: 0.887176
T Loss: 10.709983
X Loss: -4.214345
Epoch 2599 
Overall Loss: 12.595752
Rec Loss: 6.958612
KL Loss: 5.637140
Y Loss: 0.937358
T Loss: 10.706336
X Loss: -4.216403
Epoch 2649 
Overall Loss: 12.598614
Rec Loss: 6.935109
KL Loss: 5.663505
Y Loss: 0.900322
T Loss: 10.708195
X Loss: -4.223247
Epoch 2699 
Overall Loss: 12.624122
Rec Loss: 6.939601
KL Loss: 5.684521
Y Loss: 0.916953
T Loss: 10.702696
X Loss: -4.221571
Epoch 2749 
Overall Loss: 12.583737
Rec Loss: 6.924204
KL Loss: 5.659532
Y Loss: 0.923619
T Loss: 10.703595
X Loss: -4.241201
Epoch 2799 
Overall Loss: 12.617840
Rec Loss: 6.947604
KL Loss: 5.670236
Y Loss: 0.921327
T Loss: 10.737836
X Loss: -4.250895
Epoch 2849 
Overall Loss: 12.575465
Rec Loss: 6.906979
KL Loss: 5.668487
Y Loss: 0.936475
T Loss: 10.709430
X Loss: -4.270688
Epoch 2899 
Overall Loss: 12.597037
Rec Loss: 6.893870
KL Loss: 5.703167
Y Loss: 0.909081
T Loss: 10.714332
X Loss: -4.275002
Epoch 2949 
Overall Loss: 12.586937
Rec Loss: 6.893140
KL Loss: 5.693797
Y Loss: 0.916249
T Loss: 10.702884
X Loss: -4.267869
Epoch 2999 
Overall Loss: 12.565073
Rec Loss: 6.840477
KL Loss: 5.724596
Y Loss: 0.915391
T Loss: 10.688181
X Loss: -4.305400
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.892302
Epoch 99
Rec Loss: 1.876625
Epoch 149
Rec Loss: 1.875881
Epoch 199
Rec Loss: 1.892289
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 1.999259
Epoch 99
Rec Loss: 2.001946
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.659291
Insample Error 2.550636
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.511639
Epoch 99 
Prediction Loss: 2.287170
Epoch 149 
Prediction Loss: 2.109970
Epoch 199 
Prediction Loss: 2.047907
Epoch 249 
Prediction Loss: 1.951010
Epoch 299 
Prediction Loss: 1.794872
Epoch 349 
Prediction Loss: 1.654483
Epoch 399 
Prediction Loss: 1.580500
Epoch 449 
Prediction Loss: 1.462150
Epoch 499 
Prediction Loss: 1.452785
Epoch 549 
Prediction Loss: 1.282437
Epoch 599 
Prediction Loss: 1.229937
Epoch 649 
Prediction Loss: 1.199337
Epoch 699 
Prediction Loss: 1.135757
Epoch 749 
Prediction Loss: 1.104419
Epoch 799 
Prediction Loss: 1.068863
Epoch 849 
Prediction Loss: 1.024346
Epoch 899 
Prediction Loss: 0.997129
Epoch 949 
Prediction Loss: 0.966800
Epoch 999 
Prediction Loss: 0.942956
Epoch 1049 
Prediction Loss: 0.942267
Epoch 1099 
Prediction Loss: 0.882318
Epoch 1149 
Prediction Loss: 0.936121
Epoch 1199 
Prediction Loss: 0.871775
Epoch 1249 
Prediction Loss: 0.859051
Epoch 1299 
Prediction Loss: 0.842972
Epoch 1349 
Prediction Loss: 0.807180
Epoch 1399 
Prediction Loss: 0.805419
Epoch 1449 
Prediction Loss: 0.780794
Epoch 1499 
Prediction Loss: 0.780372
Epoch 1549 
Prediction Loss: 0.759867
Epoch 1599 
Prediction Loss: 0.783208
Epoch 1649 
Prediction Loss: 0.774737
Epoch 1699 
Prediction Loss: 0.737258
Epoch 1749 
Prediction Loss: 0.765583
Epoch 1799 
Prediction Loss: 0.720876
Epoch 1849 
Prediction Loss: 0.723810
Epoch 1899 
Prediction Loss: 0.720861
Epoch 1949 
Prediction Loss: 0.705048
Epoch 1999 
Prediction Loss: 0.690284
Epoch 2049 
Prediction Loss: 0.695219
Epoch 2099 
Prediction Loss: 0.683699
Epoch 2149 
Prediction Loss: 0.687989
Epoch 2199 
Prediction Loss: 0.675573
Epoch 2249 
Prediction Loss: 0.660382
Epoch 2299 
Prediction Loss: 0.662682
Epoch 2349 
Prediction Loss: 0.675915
Epoch 2399 
Prediction Loss: 0.648344
Epoch 2449 
Prediction Loss: 0.662461
Epoch 2499 
Prediction Loss: 0.641658
Epoch 2549 
Prediction Loss: 0.640849
Epoch 2599 
Prediction Loss: 0.638232
Epoch 2649 
Prediction Loss: 0.636017
Epoch 2699 
Prediction Loss: 0.642119
Epoch 2749 
Prediction Loss: 0.633586
Epoch 2799 
Prediction Loss: 0.661315
Epoch 2849 
Prediction Loss: 0.635392
Epoch 2899 
Prediction Loss: 0.610023
Epoch 2949 
Prediction Loss: 0.624184
Epoch 2999 
Prediction Loss: 0.625954
Epoch 3049 
Prediction Loss: 0.626376
Epoch 3099 
Prediction Loss: 0.595315
Epoch 3149 
Prediction Loss: 0.606051
Epoch 3199 
Prediction Loss: 0.586935
Epoch 3249 
Prediction Loss: 0.611811
Epoch 3299 
Prediction Loss: 0.589036
Epoch 3349 
Prediction Loss: 0.594736
Epoch 3399 
Prediction Loss: 0.605577
Epoch 3449 
Prediction Loss: 0.581328
Epoch 3499 
Prediction Loss: 0.587385
Epoch 3549 
Prediction Loss: 0.580743
Epoch 3599 
Prediction Loss: 0.589636
Epoch 3649 
Prediction Loss: 0.571418
Epoch 3699 
Prediction Loss: 0.583652
Epoch 3749 
Prediction Loss: 0.565106
Epoch 3799 
Prediction Loss: 0.558478
Epoch 3849 
Prediction Loss: 0.600723
Epoch 3899 
Prediction Loss: 0.562164
Epoch 3949 
Prediction Loss: 0.583703
Epoch 3999 
Prediction Loss: 0.563862
Epoch 4049 
Prediction Loss: 0.572515
Epoch 4099 
Prediction Loss: 0.559168
Epoch 4149 
Prediction Loss: 0.563455
Epoch 4199 
Prediction Loss: 0.555552
Epoch 4249 
Prediction Loss: 0.541540
Epoch 4299 
Prediction Loss: 0.549876
Epoch 4349 
Prediction Loss: 0.547454
Epoch 4399 
Prediction Loss: 0.551130
Epoch 4449 
Prediction Loss: 0.566550
Epoch 4499 
Prediction Loss: 0.552911
Epoch 4549 
Prediction Loss: 0.550612
Epoch 4599 
Prediction Loss: 0.546228
Epoch 4649 
Prediction Loss: 0.538620
Epoch 4699 
Prediction Loss: 0.531358
Epoch 4749 
Prediction Loss: 0.531902
Epoch 4799 
Prediction Loss: 0.534642
Epoch 4849 
Prediction Loss: 0.531271
Epoch 4899 
Prediction Loss: 0.535065
Epoch 4949 
Prediction Loss: 0.538182
Epoch 4999 
Prediction Loss: 0.522200
Epoch 5049 
Prediction Loss: 0.530425
Epoch 5099 
Prediction Loss: 0.533430
Epoch 5149 
Prediction Loss: 0.521229
Epoch 5199 
Prediction Loss: 0.521354
Epoch 5249 
Prediction Loss: 0.512758
Epoch 5299 
Prediction Loss: 0.536078
Epoch 5349 
Prediction Loss: 0.537463
Epoch 5399 
Prediction Loss: 0.507910
Epoch 5449 
Prediction Loss: 0.511885
Epoch 5499 
Prediction Loss: 0.511878
Epoch 5549 
Prediction Loss: 0.518511
Epoch 5599 
Prediction Loss: 0.516582
Epoch 5649 
Prediction Loss: 0.534603
Epoch 5699 
Prediction Loss: 0.506466
Epoch 5749 
Prediction Loss: 0.510480
Epoch 5799 
Prediction Loss: 0.509159
Epoch 5849 
Prediction Loss: 0.533763
Epoch 5899 
Prediction Loss: 0.527034
Epoch 5949 
Prediction Loss: 0.505386
Epoch 5999 
Prediction Loss: 0.515020
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.717481
Insample Error 3.605918
[31m========== repeat time 7 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.057769
Rec Loss: 11.293533
KL Loss: 1.764236
Y Loss: 0.981230
T Loss: 10.802918
Epoch 99 
Overall Loss: 12.895017
Rec Loss: 11.223073
KL Loss: 1.671944
Y Loss: 0.930471
T Loss: 10.757838
Epoch 149 
Overall Loss: 12.813496
Rec Loss: 11.211551
KL Loss: 1.601945
Y Loss: 0.935279
T Loss: 10.743911
Epoch 199 
Overall Loss: 12.789761
Rec Loss: 11.190016
KL Loss: 1.599746
Y Loss: 0.926904
T Loss: 10.726563
Epoch 249 
Overall Loss: 12.776046
Rec Loss: 11.181694
KL Loss: 1.594352
Y Loss: 0.932573
T Loss: 10.715408
Epoch 299 
Overall Loss: 12.691452
Rec Loss: 10.923700
KL Loss: 1.767752
Y Loss: 0.944001
T Loss: 10.451700
Epoch 349 
Overall Loss: 12.677450
Rec Loss: 10.879678
KL Loss: 1.797772
Y Loss: 0.913196
T Loss: 10.423080
Epoch 399 
Overall Loss: 12.680960
Rec Loss: 10.869638
KL Loss: 1.811322
Y Loss: 0.922330
T Loss: 10.408473
Epoch 449 
Overall Loss: 12.674423
Rec Loss: 10.855723
KL Loss: 1.818700
Y Loss: 0.884233
T Loss: 10.413606
Epoch 499 
Overall Loss: 12.665437
Rec Loss: 10.881483
KL Loss: 1.783954
Y Loss: 0.912480
T Loss: 10.425243
Epoch 549 
Overall Loss: 12.654440
Rec Loss: 10.900140
KL Loss: 1.754300
Y Loss: 0.910077
T Loss: 10.445101
Epoch 599 
Overall Loss: 12.659066
Rec Loss: 10.889037
KL Loss: 1.770029
Y Loss: 0.894675
T Loss: 10.441700
Epoch 649 
Overall Loss: 12.644147
Rec Loss: 10.867007
KL Loss: 1.777140
Y Loss: 0.885381
T Loss: 10.424316
Epoch 699 
Overall Loss: 12.623247
Rec Loss: 10.857541
KL Loss: 1.765706
Y Loss: 0.887440
T Loss: 10.413821
Epoch 749 
Overall Loss: 12.636121
Rec Loss: 10.875686
KL Loss: 1.760435
Y Loss: 0.894298
T Loss: 10.428537
Epoch 799 
Overall Loss: 12.617326
Rec Loss: 10.859490
KL Loss: 1.757836
Y Loss: 0.879231
T Loss: 10.419874
Epoch 849 
Overall Loss: 12.625285
Rec Loss: 10.859662
KL Loss: 1.765623
Y Loss: 0.905746
T Loss: 10.406789
Epoch 899 
Overall Loss: 12.601080
Rec Loss: 10.861549
KL Loss: 1.739531
Y Loss: 0.895710
T Loss: 10.413694
Epoch 949 
Overall Loss: 12.597943
Rec Loss: 10.821759
KL Loss: 1.776184
Y Loss: 0.851030
T Loss: 10.396244
Epoch 999 
Overall Loss: 12.606608
Rec Loss: 10.853907
KL Loss: 1.752701
Y Loss: 0.888740
T Loss: 10.409537
Epoch 1049 
Overall Loss: 12.588186
Rec Loss: 10.825087
KL Loss: 1.763099
Y Loss: 0.892593
T Loss: 10.378790
Epoch 1099 
Overall Loss: 12.582223
Rec Loss: 10.839033
KL Loss: 1.743190
Y Loss: 0.871160
T Loss: 10.403453
Epoch 1149 
Overall Loss: 12.574684
Rec Loss: 10.825196
KL Loss: 1.749489
Y Loss: 0.861852
T Loss: 10.394270
Epoch 1199 
Overall Loss: 12.584852
Rec Loss: 10.850368
KL Loss: 1.734485
Y Loss: 0.891586
T Loss: 10.404575
Epoch 1249 
Overall Loss: 12.596206
Rec Loss: 10.835981
KL Loss: 1.760225
Y Loss: 0.874111
T Loss: 10.398925
Epoch 1299 
Overall Loss: 12.556450
Rec Loss: 10.836869
KL Loss: 1.719580
Y Loss: 0.889179
T Loss: 10.392279
Epoch 1349 
Overall Loss: 12.568103
Rec Loss: 10.814385
KL Loss: 1.753718
Y Loss: 0.868669
T Loss: 10.380051
Epoch 1399 
Overall Loss: 12.579944
Rec Loss: 10.833496
KL Loss: 1.746448
Y Loss: 0.883278
T Loss: 10.391857
Epoch 1449 
Overall Loss: 12.558361
Rec Loss: 10.820064
KL Loss: 1.738297
Y Loss: 0.856461
T Loss: 10.391834
Epoch 1499 
Overall Loss: 12.535608
Rec Loss: 10.803594
KL Loss: 1.732014
Y Loss: 0.862953
T Loss: 10.372117
Epoch 1549 
Overall Loss: 12.521398
Rec Loss: 10.788581
KL Loss: 1.732816
Y Loss: 0.861593
T Loss: 10.357785
Epoch 1599 
Overall Loss: 12.552606
Rec Loss: 10.819816
KL Loss: 1.732790
Y Loss: 0.884969
T Loss: 10.377332
Epoch 1649 
Overall Loss: 12.556094
Rec Loss: 10.819580
KL Loss: 1.736514
Y Loss: 0.860064
T Loss: 10.389548
Epoch 1699 
Overall Loss: 12.529990
Rec Loss: 10.810744
KL Loss: 1.719246
Y Loss: 0.851226
T Loss: 10.385131
Epoch 1749 
Overall Loss: 12.512274
Rec Loss: 10.766753
KL Loss: 1.745520
Y Loss: 0.841697
T Loss: 10.345905
Epoch 1799 
Overall Loss: 12.509361
Rec Loss: 10.787739
KL Loss: 1.721622
Y Loss: 0.855153
T Loss: 10.360162
Epoch 1849 
Overall Loss: 12.529960
Rec Loss: 10.794653
KL Loss: 1.735308
Y Loss: 0.859350
T Loss: 10.364977
Epoch 1899 
Overall Loss: 12.508624
Rec Loss: 10.774026
KL Loss: 1.734599
Y Loss: 0.854380
T Loss: 10.346836
Epoch 1949 
Overall Loss: 12.524966
Rec Loss: 10.806084
KL Loss: 1.718882
Y Loss: 0.868577
T Loss: 10.371795
Epoch 1999 
Overall Loss: 12.510839
Rec Loss: 10.774002
KL Loss: 1.736837
Y Loss: 0.849591
T Loss: 10.349207
Epoch 2049 
Overall Loss: 12.525463
Rec Loss: 10.806535
KL Loss: 1.718928
Y Loss: 0.855825
T Loss: 10.378623
Epoch 2099 
Overall Loss: 12.499216
Rec Loss: 10.772312
KL Loss: 1.726905
Y Loss: 0.841971
T Loss: 10.351326
Epoch 2149 
Overall Loss: 12.489891
Rec Loss: 10.789709
KL Loss: 1.700182
Y Loss: 0.876047
T Loss: 10.351686
Epoch 2199 
Overall Loss: 12.502098
Rec Loss: 10.785077
KL Loss: 1.717020
Y Loss: 0.861076
T Loss: 10.354539
Epoch 2249 
Overall Loss: 12.497443
Rec Loss: 10.763126
KL Loss: 1.734316
Y Loss: 0.836585
T Loss: 10.344834
Epoch 2299 
Overall Loss: 12.481784
Rec Loss: 10.755302
KL Loss: 1.726482
Y Loss: 0.837102
T Loss: 10.336752
Epoch 2349 
Overall Loss: 12.488050
Rec Loss: 10.774970
KL Loss: 1.713080
Y Loss: 0.863063
T Loss: 10.343438
Epoch 2399 
Overall Loss: 12.499662
Rec Loss: 10.762963
KL Loss: 1.736700
Y Loss: 0.854555
T Loss: 10.335686
Epoch 2449 
Overall Loss: 12.458810
Rec Loss: 10.737815
KL Loss: 1.720995
Y Loss: 0.849767
T Loss: 10.312931
Epoch 2499 
Overall Loss: 12.502783
Rec Loss: 10.755515
KL Loss: 1.747268
Y Loss: 0.867498
T Loss: 10.321766
Epoch 2549 
Overall Loss: 12.464324
Rec Loss: 10.758626
KL Loss: 1.705698
Y Loss: 0.827071
T Loss: 10.345091
Epoch 2599 
Overall Loss: 12.480545
Rec Loss: 10.735873
KL Loss: 1.744673
Y Loss: 0.836712
T Loss: 10.317517
Epoch 2649 
Overall Loss: 12.464969
Rec Loss: 10.748750
KL Loss: 1.716220
Y Loss: 0.840267
T Loss: 10.328616
Epoch 2699 
Overall Loss: 12.453102
Rec Loss: 10.714288
KL Loss: 1.738814
Y Loss: 0.820429
T Loss: 10.304074
Epoch 2749 
Overall Loss: 12.472824
Rec Loss: 10.738849
KL Loss: 1.733975
Y Loss: 0.838938
T Loss: 10.319380
Epoch 2799 
Overall Loss: 12.460258
Rec Loss: 10.726969
KL Loss: 1.733289
Y Loss: 0.845827
T Loss: 10.304055
Epoch 2849 
Overall Loss: 12.448083
Rec Loss: 10.750474
KL Loss: 1.697608
Y Loss: 0.859226
T Loss: 10.320862
Epoch 2899 
Overall Loss: 12.456782
Rec Loss: 10.752603
KL Loss: 1.704179
Y Loss: 0.845889
T Loss: 10.329658
Epoch 2949 
Overall Loss: 12.464655
Rec Loss: 10.749282
KL Loss: 1.715373
Y Loss: 0.832279
T Loss: 10.333142
Epoch 2999 
Overall Loss: 12.439808
Rec Loss: 10.731132
KL Loss: 1.708675
Y Loss: 0.825880
T Loss: 10.318192
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.479746
Epoch 99
Rec Loss: 1.473378
Epoch 149
Rec Loss: 1.464255
Epoch 199
Rec Loss: 1.456248
Epoch 249
Rec Loss: 1.465897
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.935379
Epoch 99
Rec Loss: 9.918139
Epoch 149
Rec Loss: 9.902796
Epoch 199
Rec Loss: 9.920989
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.691729
Insample Error: 1.901762
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.828380
Rec Loss: 20.216392
KL Loss: 2.611989
Y Loss: 11.301417
T Loss: 13.021305
X Loss: 1.544377
Epoch 99 
Overall Loss: 17.253107
Rec Loss: 13.758323
KL Loss: 3.494784
Y Loss: 3.653137
T Loss: 12.797039
X Loss: -0.865284
Epoch 149 
Overall Loss: 15.517579
Rec Loss: 11.610013
KL Loss: 3.907566
Y Loss: 2.263439
T Loss: 12.364608
X Loss: -1.886315
Epoch 199 
Overall Loss: 14.493536
Rec Loss: 10.336068
KL Loss: 4.157469
Y Loss: 1.545664
T Loss: 11.908336
X Loss: -2.345100
Epoch 249 
Overall Loss: 14.021753
Rec Loss: 9.663528
KL Loss: 4.358225
Y Loss: 1.186468
T Loss: 11.713498
X Loss: -2.643204
Epoch 299 
Overall Loss: 13.731697
Rec Loss: 9.223970
KL Loss: 4.507727
Y Loss: 1.072139
T Loss: 11.598345
X Loss: -2.910445
Epoch 349 
Overall Loss: 13.535404
Rec Loss: 8.887545
KL Loss: 4.647860
Y Loss: 0.993873
T Loss: 11.489896
X Loss: -3.099287
Epoch 399 
Overall Loss: 13.447614
Rec Loss: 8.670461
KL Loss: 4.777152
Y Loss: 0.961353
T Loss: 11.433441
X Loss: -3.243656
Epoch 449 
Overall Loss: 13.360207
Rec Loss: 8.530278
KL Loss: 4.829929
Y Loss: 0.954600
T Loss: 11.402359
X Loss: -3.349381
Epoch 499 
Overall Loss: 13.320413
Rec Loss: 8.479625
KL Loss: 4.840789
Y Loss: 0.952343
T Loss: 11.384612
X Loss: -3.381159
Epoch 549 
Overall Loss: 13.299834
Rec Loss: 8.433244
KL Loss: 4.866590
Y Loss: 0.957638
T Loss: 11.374595
X Loss: -3.420170
Epoch 599 
Overall Loss: 13.253161
Rec Loss: 8.375442
KL Loss: 4.877718
Y Loss: 0.943250
T Loss: 11.366508
X Loss: -3.462691
Epoch 649 
Overall Loss: 13.225420
Rec Loss: 8.326379
KL Loss: 4.899041
Y Loss: 0.944233
T Loss: 11.345526
X Loss: -3.491264
Epoch 699 
Overall Loss: 13.177078
Rec Loss: 8.227535
KL Loss: 4.949543
Y Loss: 0.886401
T Loss: 11.318675
X Loss: -3.534341
Epoch 749 
Overall Loss: 13.100433
Rec Loss: 8.070444
KL Loss: 5.029989
Y Loss: 0.909843
T Loss: 11.218925
X Loss: -3.603402
Epoch 799 
Overall Loss: 13.028224
Rec Loss: 7.863561
KL Loss: 5.164663
Y Loss: 0.890900
T Loss: 11.094520
X Loss: -3.676409
Epoch 849 
Overall Loss: 12.939240
Rec Loss: 7.614958
KL Loss: 5.324282
Y Loss: 0.875173
T Loss: 10.935107
X Loss: -3.757736
Epoch 899 
Overall Loss: 12.917089
Rec Loss: 7.503462
KL Loss: 5.413627
Y Loss: 0.912313
T Loss: 10.857199
X Loss: -3.809894
Epoch 949 
Overall Loss: 12.877769
Rec Loss: 7.400576
KL Loss: 5.477193
Y Loss: 0.911189
T Loss: 10.793194
X Loss: -3.848213
Epoch 999 
Overall Loss: 12.877725
Rec Loss: 7.382177
KL Loss: 5.495548
Y Loss: 0.927808
T Loss: 10.782481
X Loss: -3.864209
Epoch 1049 
Overall Loss: 12.811086
Rec Loss: 7.300428
KL Loss: 5.510658
Y Loss: 0.891563
T Loss: 10.762291
X Loss: -3.907645
Epoch 1099 
Overall Loss: 12.790663
Rec Loss: 7.272724
KL Loss: 5.517939
Y Loss: 0.936590
T Loss: 10.740017
X Loss: -3.935589
Epoch 1149 
Overall Loss: 12.776537
Rec Loss: 7.230058
KL Loss: 5.546478
Y Loss: 0.918010
T Loss: 10.740964
X Loss: -3.969911
Epoch 1199 
Overall Loss: 12.758684
Rec Loss: 7.175258
KL Loss: 5.583426
Y Loss: 0.912252
T Loss: 10.732154
X Loss: -4.013022
Epoch 1249 
Overall Loss: 12.801513
Rec Loss: 7.207661
KL Loss: 5.593852
Y Loss: 0.914811
T Loss: 10.742958
X Loss: -3.992702
Epoch 1299 
Overall Loss: 12.745501
Rec Loss: 7.153674
KL Loss: 5.591827
Y Loss: 0.925063
T Loss: 10.732769
X Loss: -4.041626
Epoch 1349 
Overall Loss: 12.748084
Rec Loss: 7.118408
KL Loss: 5.629676
Y Loss: 0.896668
T Loss: 10.732259
X Loss: -4.062185
Epoch 1399 
Overall Loss: 12.748314
Rec Loss: 7.096329
KL Loss: 5.651985
Y Loss: 0.901899
T Loss: 10.741853
X Loss: -4.096474
Epoch 1449 
Overall Loss: 12.697725
Rec Loss: 7.074179
KL Loss: 5.623546
Y Loss: 0.906596
T Loss: 10.729677
X Loss: -4.108797
Epoch 1499 
Overall Loss: 12.662893
Rec Loss: 7.014585
KL Loss: 5.648307
Y Loss: 0.906069
T Loss: 10.706000
X Loss: -4.144449
Epoch 1549 
Overall Loss: 12.686866
Rec Loss: 7.034792
KL Loss: 5.652074
Y Loss: 0.899395
T Loss: 10.704173
X Loss: -4.119079
Epoch 1599 
Overall Loss: 12.705989
Rec Loss: 7.030315
KL Loss: 5.675674
Y Loss: 0.918693
T Loss: 10.721530
X Loss: -4.150561
Epoch 1649 
Overall Loss: 12.697974
Rec Loss: 7.030221
KL Loss: 5.667753
Y Loss: 0.905608
T Loss: 10.738911
X Loss: -4.161494
Epoch 1699 
Overall Loss: 12.687652
Rec Loss: 6.978658
KL Loss: 5.708994
Y Loss: 0.920195
T Loss: 10.737613
X Loss: -4.219052
Epoch 1749 
Overall Loss: 12.677279
Rec Loss: 6.942091
KL Loss: 5.735188
Y Loss: 0.899519
T Loss: 10.727579
X Loss: -4.235248
Epoch 1799 
Overall Loss: 12.645920
Rec Loss: 6.920769
KL Loss: 5.725150
Y Loss: 0.910630
T Loss: 10.732373
X Loss: -4.266918
Epoch 1849 
Overall Loss: 12.648784
Rec Loss: 6.936126
KL Loss: 5.712658
Y Loss: 0.912584
T Loss: 10.725578
X Loss: -4.245744
Epoch 1899 
Overall Loss: 12.666820
Rec Loss: 6.893743
KL Loss: 5.773076
Y Loss: 0.907402
T Loss: 10.721842
X Loss: -4.281799
Epoch 1949 
Overall Loss: 12.644869
Rec Loss: 6.876302
KL Loss: 5.768568
Y Loss: 0.902656
T Loss: 10.733205
X Loss: -4.308231
Epoch 1999 
Overall Loss: 12.662737
Rec Loss: 6.911231
KL Loss: 5.751506
Y Loss: 0.921618
T Loss: 10.752438
X Loss: -4.302016
Epoch 2049 
Overall Loss: 12.675441
Rec Loss: 6.887625
KL Loss: 5.787816
Y Loss: 0.922592
T Loss: 10.724792
X Loss: -4.298464
Epoch 2099 
Overall Loss: 12.663605
Rec Loss: 6.897012
KL Loss: 5.766593
Y Loss: 0.929553
T Loss: 10.746947
X Loss: -4.314712
Epoch 2149 
Overall Loss: 12.650281
Rec Loss: 6.848150
KL Loss: 5.802131
Y Loss: 0.914114
T Loss: 10.745093
X Loss: -4.354000
Epoch 2199 
Overall Loss: 12.631672
Rec Loss: 6.819386
KL Loss: 5.812286
Y Loss: 0.907119
T Loss: 10.742981
X Loss: -4.377155
Epoch 2249 
Overall Loss: 12.631531
Rec Loss: 6.815057
KL Loss: 5.816474
Y Loss: 0.929077
T Loss: 10.742511
X Loss: -4.391992
Epoch 2299 
Overall Loss: 12.611162
Rec Loss: 6.805083
KL Loss: 5.806079
Y Loss: 0.908706
T Loss: 10.728576
X Loss: -4.377847
Epoch 2349 
Overall Loss: 12.607072
Rec Loss: 6.752115
KL Loss: 5.854957
Y Loss: 0.915042
T Loss: 10.733601
X Loss: -4.439006
Epoch 2399 
Overall Loss: 12.623763
Rec Loss: 6.783448
KL Loss: 5.840316
Y Loss: 0.916750
T Loss: 10.740027
X Loss: -4.414954
Epoch 2449 
Overall Loss: 12.606968
Rec Loss: 6.734252
KL Loss: 5.872717
Y Loss: 0.913771
T Loss: 10.741809
X Loss: -4.464443
Epoch 2499 
Overall Loss: 12.627703
Rec Loss: 6.750115
KL Loss: 5.877588
Y Loss: 0.908933
T Loss: 10.743725
X Loss: -4.448076
Epoch 2549 
Overall Loss: 12.627046
Rec Loss: 6.737753
KL Loss: 5.889293
Y Loss: 0.912525
T Loss: 10.741870
X Loss: -4.460379
Epoch 2599 
Overall Loss: 12.595810
Rec Loss: 6.730454
KL Loss: 5.865356
Y Loss: 0.939638
T Loss: 10.723228
X Loss: -4.462593
Epoch 2649 
Overall Loss: 12.622760
Rec Loss: 6.706323
KL Loss: 5.916436
Y Loss: 0.918841
T Loss: 10.744291
X Loss: -4.497388
Epoch 2699 
Overall Loss: 12.589243
Rec Loss: 6.661764
KL Loss: 5.927479
Y Loss: 0.889620
T Loss: 10.730321
X Loss: -4.513367
Epoch 2749 
Overall Loss: 12.601310
Rec Loss: 6.692754
KL Loss: 5.908556
Y Loss: 0.926689
T Loss: 10.741891
X Loss: -4.512481
Epoch 2799 
Overall Loss: 12.600911
Rec Loss: 6.672831
KL Loss: 5.928080
Y Loss: 0.919911
T Loss: 10.743510
X Loss: -4.530635
Epoch 2849 
Overall Loss: 12.583826
Rec Loss: 6.649326
KL Loss: 5.934500
Y Loss: 0.919373
T Loss: 10.733166
X Loss: -4.543527
Epoch 2899 
Overall Loss: 12.601738
Rec Loss: 6.658173
KL Loss: 5.943565
Y Loss: 0.932935
T Loss: 10.745329
X Loss: -4.553624
Epoch 2949 
Overall Loss: 12.601366
Rec Loss: 6.653133
KL Loss: 5.948233
Y Loss: 0.919494
T Loss: 10.749582
X Loss: -4.556196
Epoch 2999 
Overall Loss: 12.575121
Rec Loss: 6.636408
KL Loss: 5.938712
Y Loss: 0.925451
T Loss: 10.738788
X Loss: -4.565105
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.828097
Epoch 99
Rec Loss: 1.829451
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.013158
Epoch 99
Rec Loss: 2.005189
Epoch 149
Rec Loss: 2.005250
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.652077
Insample Error 2.648014
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.494724
Epoch 99 
Prediction Loss: 2.307909
Epoch 149 
Prediction Loss: 2.162124
Epoch 199 
Prediction Loss: 2.156226
Epoch 249 
Prediction Loss: 1.957362
Epoch 299 
Prediction Loss: 1.845625
Epoch 349 
Prediction Loss: 1.754745
Epoch 399 
Prediction Loss: 1.699838
Epoch 449 
Prediction Loss: 1.583081
Epoch 499 
Prediction Loss: 1.521871
Epoch 549 
Prediction Loss: 1.577224
Epoch 599 
Prediction Loss: 1.454921
Epoch 649 
Prediction Loss: 1.353021
Epoch 699 
Prediction Loss: 1.314719
Epoch 749 
Prediction Loss: 1.273584
Epoch 799 
Prediction Loss: 1.218952
Epoch 849 
Prediction Loss: 1.165222
Epoch 899 
Prediction Loss: 1.128905
Epoch 949 
Prediction Loss: 1.080834
Epoch 999 
Prediction Loss: 1.068474
Epoch 1049 
Prediction Loss: 1.065455
Epoch 1099 
Prediction Loss: 1.040749
Epoch 1149 
Prediction Loss: 1.000165
Epoch 1199 
Prediction Loss: 1.018668
Epoch 1249 
Prediction Loss: 0.939678
Epoch 1299 
Prediction Loss: 0.936473
Epoch 1349 
Prediction Loss: 0.938117
Epoch 1399 
Prediction Loss: 0.904565
Epoch 1449 
Prediction Loss: 0.885038
Epoch 1499 
Prediction Loss: 0.861699
Epoch 1549 
Prediction Loss: 0.846687
Epoch 1599 
Prediction Loss: 0.825436
Epoch 1649 
Prediction Loss: 0.820245
Epoch 1699 
Prediction Loss: 0.806323
Epoch 1749 
Prediction Loss: 0.817370
Epoch 1799 
Prediction Loss: 0.789168
Epoch 1849 
Prediction Loss: 0.774392
Epoch 1899 
Prediction Loss: 0.783304
Epoch 1949 
Prediction Loss: 0.762728
Epoch 1999 
Prediction Loss: 0.762077
Epoch 2049 
Prediction Loss: 0.740086
Epoch 2099 
Prediction Loss: 0.742757
Epoch 2149 
Prediction Loss: 0.719224
Epoch 2199 
Prediction Loss: 0.718184
Epoch 2249 
Prediction Loss: 0.743709
Epoch 2299 
Prediction Loss: 0.707417
Epoch 2349 
Prediction Loss: 0.696023
Epoch 2399 
Prediction Loss: 0.704004
Epoch 2449 
Prediction Loss: 0.704216
Epoch 2499 
Prediction Loss: 0.699054
Epoch 2549 
Prediction Loss: 0.684302
Epoch 2599 
Prediction Loss: 0.675648
Epoch 2649 
Prediction Loss: 0.680377
Epoch 2699 
Prediction Loss: 0.673507
Epoch 2749 
Prediction Loss: 0.668591
Epoch 2799 
Prediction Loss: 0.681756
Epoch 2849 
Prediction Loss: 0.674033
Epoch 2899 
Prediction Loss: 0.684310
Epoch 2949 
Prediction Loss: 0.695490
Epoch 2999 
Prediction Loss: 0.650779
Epoch 3049 
Prediction Loss: 0.676104
Epoch 3099 
Prediction Loss: 0.709088
Epoch 3149 
Prediction Loss: 0.665633
Epoch 3199 
Prediction Loss: 0.640905
Epoch 3249 
Prediction Loss: 0.642296
Epoch 3299 
Prediction Loss: 0.642135
Epoch 3349 
Prediction Loss: 0.633462
Epoch 3399 
Prediction Loss: 0.641820
Epoch 3449 
Prediction Loss: 0.631823
Epoch 3499 
Prediction Loss: 0.635919
Epoch 3549 
Prediction Loss: 0.624335
Epoch 3599 
Prediction Loss: 0.622992
Epoch 3649 
Prediction Loss: 0.637581
Epoch 3699 
Prediction Loss: 0.637207
Epoch 3749 
Prediction Loss: 0.643568
Epoch 3799 
Prediction Loss: 0.603622
Epoch 3849 
Prediction Loss: 0.620385
Epoch 3899 
Prediction Loss: 0.617714
Epoch 3949 
Prediction Loss: 0.608616
Epoch 3999 
Prediction Loss: 0.621187
Epoch 4049 
Prediction Loss: 0.612190
Epoch 4099 
Prediction Loss: 0.609927
Epoch 4149 
Prediction Loss: 0.604900
Epoch 4199 
Prediction Loss: 0.604513
Epoch 4249 
Prediction Loss: 0.605570
Epoch 4299 
Prediction Loss: 0.593890
Epoch 4349 
Prediction Loss: 0.609522
Epoch 4399 
Prediction Loss: 0.602036
Epoch 4449 
Prediction Loss: 0.624103
Epoch 4499 
Prediction Loss: 0.606732
Epoch 4549 
Prediction Loss: 0.606164
Epoch 4599 
Prediction Loss: 0.590159
Epoch 4649 
Prediction Loss: 0.586281
Epoch 4699 
Prediction Loss: 0.602251
Epoch 4749 
Prediction Loss: 0.590484
Epoch 4799 
Prediction Loss: 0.583734
Epoch 4849 
Prediction Loss: 0.602107
Epoch 4899 
Prediction Loss: 0.587446
Epoch 4949 
Prediction Loss: 0.590116
Epoch 4999 
Prediction Loss: 0.587481
Epoch 5049 
Prediction Loss: 0.587486
Epoch 5099 
Prediction Loss: 0.581217
Epoch 5149 
Prediction Loss: 0.597470
Epoch 5199 
Prediction Loss: 0.589209
Epoch 5249 
Prediction Loss: 0.598050
Epoch 5299 
Prediction Loss: 0.568582
Epoch 5349 
Prediction Loss: 0.580307
Epoch 5399 
Prediction Loss: 0.579558
Epoch 5449 
Prediction Loss: 0.570393
Epoch 5499 
Prediction Loss: 0.568031
Epoch 5549 
Prediction Loss: 0.577698
Epoch 5599 
Prediction Loss: 0.568522
Epoch 5649 
Prediction Loss: 0.569423
Epoch 5699 
Prediction Loss: 0.581161
Epoch 5749 
Prediction Loss: 0.561046
Epoch 5799 
Prediction Loss: 0.575594
Epoch 5849 
Prediction Loss: 0.576970
Epoch 5899 
Prediction Loss: 0.588731
Epoch 5949 
Prediction Loss: 0.562150
Epoch 5999 
Prediction Loss: 0.573512
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.739542
Insample Error 3.533701
[31m========== repeat time 8 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.144484
Rec Loss: 11.354034
KL Loss: 1.790450
Y Loss: 1.180576
T Loss: 10.763746
Epoch 99 
Overall Loss: 12.919414
Rec Loss: 11.204340
KL Loss: 1.715073
Y Loss: 0.947868
T Loss: 10.730407
Epoch 149 
Overall Loss: 12.779946
Rec Loss: 10.982036
KL Loss: 1.797910
Y Loss: 0.933951
T Loss: 10.515060
Epoch 199 
Overall Loss: 12.754005
Rec Loss: 10.929874
KL Loss: 1.824131
Y Loss: 0.910319
T Loss: 10.474715
Epoch 249 
Overall Loss: 12.732514
Rec Loss: 10.899797
KL Loss: 1.832716
Y Loss: 0.901664
T Loss: 10.448965
Epoch 299 
Overall Loss: 12.703781
Rec Loss: 10.902200
KL Loss: 1.801580
Y Loss: 0.913365
T Loss: 10.445518
Epoch 349 
Overall Loss: 12.689114
Rec Loss: 10.883697
KL Loss: 1.805417
Y Loss: 0.929138
T Loss: 10.419128
Epoch 399 
Overall Loss: 12.678416
Rec Loss: 10.871627
KL Loss: 1.806790
Y Loss: 0.915623
T Loss: 10.413815
Epoch 449 
Overall Loss: 12.688473
Rec Loss: 10.910965
KL Loss: 1.777508
Y Loss: 0.915048
T Loss: 10.453440
Epoch 499 
Overall Loss: 12.657174
Rec Loss: 10.887042
KL Loss: 1.770132
Y Loss: 0.890109
T Loss: 10.441987
Epoch 549 
Overall Loss: 12.649579
Rec Loss: 10.886525
KL Loss: 1.763055
Y Loss: 0.901717
T Loss: 10.435666
Epoch 599 
Overall Loss: 12.642469
Rec Loss: 10.888931
KL Loss: 1.753538
Y Loss: 0.918336
T Loss: 10.429763
Epoch 649 
Overall Loss: 12.627943
Rec Loss: 10.868602
KL Loss: 1.759341
Y Loss: 0.920774
T Loss: 10.408216
Epoch 699 
Overall Loss: 12.614302
Rec Loss: 10.858313
KL Loss: 1.755989
Y Loss: 0.889793
T Loss: 10.413417
Epoch 749 
Overall Loss: 12.617836
Rec Loss: 10.859987
KL Loss: 1.757850
Y Loss: 0.879061
T Loss: 10.420456
Epoch 799 
Overall Loss: 12.614218
Rec Loss: 10.828380
KL Loss: 1.785838
Y Loss: 0.860765
T Loss: 10.397998
Epoch 849 
Overall Loss: 12.589792
Rec Loss: 10.845413
KL Loss: 1.744379
Y Loss: 0.872036
T Loss: 10.409396
Epoch 899 
Overall Loss: 12.598689
Rec Loss: 10.848582
KL Loss: 1.750107
Y Loss: 0.874368
T Loss: 10.411398
Epoch 949 
Overall Loss: 12.593224
Rec Loss: 10.853077
KL Loss: 1.740147
Y Loss: 0.885480
T Loss: 10.410337
Epoch 999 
Overall Loss: 12.598054
Rec Loss: 10.845810
KL Loss: 1.752244
Y Loss: 0.878225
T Loss: 10.406697
Epoch 1049 
Overall Loss: 12.593501
Rec Loss: 10.831749
KL Loss: 1.761752
Y Loss: 0.873603
T Loss: 10.394948
Epoch 1099 
Overall Loss: 12.586114
Rec Loss: 10.818281
KL Loss: 1.767833
Y Loss: 0.873596
T Loss: 10.381483
Epoch 1149 
Overall Loss: 12.592849
Rec Loss: 10.829317
KL Loss: 1.763531
Y Loss: 0.905833
T Loss: 10.376400
Epoch 1199 
Overall Loss: 12.588409
Rec Loss: 10.818016
KL Loss: 1.770392
Y Loss: 0.878986
T Loss: 10.378523
Epoch 1249 
Overall Loss: 12.562377
Rec Loss: 10.831488
KL Loss: 1.730889
Y Loss: 0.888619
T Loss: 10.387178
Epoch 1299 
Overall Loss: 12.583629
Rec Loss: 10.822431
KL Loss: 1.761199
Y Loss: 0.861431
T Loss: 10.391715
Epoch 1349 
Overall Loss: 12.570168
Rec Loss: 10.817083
KL Loss: 1.753085
Y Loss: 0.878785
T Loss: 10.377690
Epoch 1399 
Overall Loss: 12.566983
Rec Loss: 10.822614
KL Loss: 1.744368
Y Loss: 0.863105
T Loss: 10.391062
Epoch 1449 
Overall Loss: 12.555179
Rec Loss: 10.812681
KL Loss: 1.742499
Y Loss: 0.861552
T Loss: 10.381905
Epoch 1499 
Overall Loss: 12.571920
Rec Loss: 10.830408
KL Loss: 1.741511
Y Loss: 0.876604
T Loss: 10.392106
Epoch 1549 
Overall Loss: 12.543821
Rec Loss: 10.783852
KL Loss: 1.759970
Y Loss: 0.844447
T Loss: 10.361628
Epoch 1599 
Overall Loss: 12.544928
Rec Loss: 10.791986
KL Loss: 1.752941
Y Loss: 0.867360
T Loss: 10.358306
Epoch 1649 
Overall Loss: 12.544983
Rec Loss: 10.784669
KL Loss: 1.760315
Y Loss: 0.859996
T Loss: 10.354670
Epoch 1699 
Overall Loss: 12.544102
Rec Loss: 10.822156
KL Loss: 1.721946
Y Loss: 0.873507
T Loss: 10.385403
Epoch 1749 
Overall Loss: 12.519970
Rec Loss: 10.791291
KL Loss: 1.728679
Y Loss: 0.852496
T Loss: 10.365043
Epoch 1799 
Overall Loss: 12.537110
Rec Loss: 10.782344
KL Loss: 1.754766
Y Loss: 0.859084
T Loss: 10.352802
Epoch 1849 
Overall Loss: 12.522109
Rec Loss: 10.790891
KL Loss: 1.731217
Y Loss: 0.853333
T Loss: 10.364225
Epoch 1899 
Overall Loss: 12.528635
Rec Loss: 10.779634
KL Loss: 1.749001
Y Loss: 0.849661
T Loss: 10.354803
Epoch 1949 
Overall Loss: 12.513184
Rec Loss: 10.780102
KL Loss: 1.733081
Y Loss: 0.838558
T Loss: 10.360823
Epoch 1999 
Overall Loss: 12.498054
Rec Loss: 10.760847
KL Loss: 1.737207
Y Loss: 0.851837
T Loss: 10.334929
Epoch 2049 
Overall Loss: 12.498631
Rec Loss: 10.771494
KL Loss: 1.727138
Y Loss: 0.834908
T Loss: 10.354040
Epoch 2099 
Overall Loss: 12.494879
Rec Loss: 10.750210
KL Loss: 1.744669
Y Loss: 0.840022
T Loss: 10.330199
Epoch 2149 
Overall Loss: 12.500197
Rec Loss: 10.765818
KL Loss: 1.734379
Y Loss: 0.833065
T Loss: 10.349285
Epoch 2199 
Overall Loss: 12.486798
Rec Loss: 10.757015
KL Loss: 1.729783
Y Loss: 0.839102
T Loss: 10.337463
Epoch 2249 
Overall Loss: 12.489379
Rec Loss: 10.772786
KL Loss: 1.716594
Y Loss: 0.841323
T Loss: 10.352124
Epoch 2299 
Overall Loss: 12.494284
Rec Loss: 10.778938
KL Loss: 1.715346
Y Loss: 0.849083
T Loss: 10.354397
Epoch 2349 
Overall Loss: 12.487925
Rec Loss: 10.745748
KL Loss: 1.742177
Y Loss: 0.830778
T Loss: 10.330359
Epoch 2399 
Overall Loss: 12.482183
Rec Loss: 10.752950
KL Loss: 1.729233
Y Loss: 0.846060
T Loss: 10.329920
Epoch 2449 
Overall Loss: 12.474273
Rec Loss: 10.750076
KL Loss: 1.724197
Y Loss: 0.838305
T Loss: 10.330923
Epoch 2499 
Overall Loss: 12.484140
Rec Loss: 10.770425
KL Loss: 1.713715
Y Loss: 0.835675
T Loss: 10.352588
Epoch 2549 
Overall Loss: 12.480429
Rec Loss: 10.749053
KL Loss: 1.731376
Y Loss: 0.845348
T Loss: 10.326379
Epoch 2599 
Overall Loss: 12.449130
Rec Loss: 10.751063
KL Loss: 1.698067
Y Loss: 0.852759
T Loss: 10.324684
Epoch 2649 
Overall Loss: 12.468910
Rec Loss: 10.737863
KL Loss: 1.731048
Y Loss: 0.845051
T Loss: 10.315337
Epoch 2699 
Overall Loss: 12.458145
Rec Loss: 10.741035
KL Loss: 1.717111
Y Loss: 0.821613
T Loss: 10.330228
Epoch 2749 
Overall Loss: 12.468709
Rec Loss: 10.747307
KL Loss: 1.721403
Y Loss: 0.848652
T Loss: 10.322981
Epoch 2799 
Overall Loss: 12.468319
Rec Loss: 10.735069
KL Loss: 1.733251
Y Loss: 0.822008
T Loss: 10.324064
Epoch 2849 
Overall Loss: 12.450851
Rec Loss: 10.725666
KL Loss: 1.725185
Y Loss: 0.836259
T Loss: 10.307536
Epoch 2899 
Overall Loss: 12.455496
Rec Loss: 10.747512
KL Loss: 1.707984
Y Loss: 0.852704
T Loss: 10.321160
Epoch 2949 
Overall Loss: 12.450871
Rec Loss: 10.735038
KL Loss: 1.715832
Y Loss: 0.831385
T Loss: 10.319346
Epoch 2999 
Overall Loss: 12.470201
Rec Loss: 10.712099
KL Loss: 1.758103
Y Loss: 0.829696
T Loss: 10.297251
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.482559
Epoch 99
Rec Loss: 1.498780
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.918862
Epoch 99
Rec Loss: 9.909375
Epoch 149
Rec Loss: 9.904559
Epoch 199
Rec Loss: 9.900956
Epoch 249
Rec Loss: 9.897862
Epoch 299
Rec Loss: 9.885398
Epoch 349
Rec Loss: 9.900627
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.687223
Insample Error: 2.064389
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.672362
Rec Loss: 18.489066
KL Loss: 3.183296
Y Loss: 8.967904
T Loss: 12.890005
X Loss: 1.115110
Epoch 99 
Overall Loss: 16.969000
Rec Loss: 13.203516
KL Loss: 3.765484
Y Loss: 3.102452
T Loss: 12.843840
X Loss: -1.191550
Epoch 149 
Overall Loss: 15.532689
Rec Loss: 11.670438
KL Loss: 3.862251
Y Loss: 2.067831
T Loss: 12.572834
X Loss: -1.936312
Epoch 199 
Overall Loss: 14.727166
Rec Loss: 10.608500
KL Loss: 4.118666
Y Loss: 1.610931
T Loss: 12.349374
X Loss: -2.546339
Epoch 249 
Overall Loss: 14.213936
Rec Loss: 9.870193
KL Loss: 4.343743
Y Loss: 1.369225
T Loss: 12.175499
X Loss: -2.989919
Epoch 299 
Overall Loss: 13.880972
Rec Loss: 9.195748
KL Loss: 4.685224
Y Loss: 1.178897
T Loss: 11.964626
X Loss: -3.358327
Epoch 349 
Overall Loss: 13.588661
Rec Loss: 8.648279
KL Loss: 4.940382
Y Loss: 1.113538
T Loss: 11.697640
X Loss: -3.606130
Epoch 399 
Overall Loss: 13.455260
Rec Loss: 8.283277
KL Loss: 5.171983
Y Loss: 1.079484
T Loss: 11.555682
X Loss: -3.812147
Epoch 449 
Overall Loss: 13.321274
Rec Loss: 7.987943
KL Loss: 5.333331
Y Loss: 1.054870
T Loss: 11.412290
X Loss: -3.951782
Epoch 499 
Overall Loss: 13.180825
Rec Loss: 7.656644
KL Loss: 5.524182
Y Loss: 1.066539
T Loss: 11.157729
X Loss: -4.034354
Epoch 549 
Overall Loss: 13.101047
Rec Loss: 7.349996
KL Loss: 5.751051
Y Loss: 1.051347
T Loss: 10.961759
X Loss: -4.137437
Epoch 599 
Overall Loss: 13.047325
Rec Loss: 7.210601
KL Loss: 5.836723
Y Loss: 1.036225
T Loss: 10.895974
X Loss: -4.203485
Epoch 649 
Overall Loss: 12.974263
Rec Loss: 7.107207
KL Loss: 5.867056
Y Loss: 1.019801
T Loss: 10.846699
X Loss: -4.249392
Epoch 699 
Overall Loss: 12.920347
Rec Loss: 7.032476
KL Loss: 5.887871
Y Loss: 1.018298
T Loss: 10.809177
X Loss: -4.285849
Epoch 749 
Overall Loss: 12.908100
Rec Loss: 6.996486
KL Loss: 5.911614
Y Loss: 0.993858
T Loss: 10.804477
X Loss: -4.304920
Epoch 799 
Overall Loss: 12.903222
Rec Loss: 6.945490
KL Loss: 5.957732
Y Loss: 0.965162
T Loss: 10.798659
X Loss: -4.335750
Epoch 849 
Overall Loss: 12.894368
Rec Loss: 6.941884
KL Loss: 5.952484
Y Loss: 1.003863
T Loss: 10.798997
X Loss: -4.359044
Epoch 899 
Overall Loss: 12.881452
Rec Loss: 6.921268
KL Loss: 5.960185
Y Loss: 0.977770
T Loss: 10.789243
X Loss: -4.356861
Epoch 949 
Overall Loss: 12.844112
Rec Loss: 6.859267
KL Loss: 5.984845
Y Loss: 0.969770
T Loss: 10.753185
X Loss: -4.378803
Epoch 999 
Overall Loss: 12.849966
Rec Loss: 6.877572
KL Loss: 5.972393
Y Loss: 0.965192
T Loss: 10.770973
X Loss: -4.375997
Epoch 1049 
Overall Loss: 12.827934
Rec Loss: 6.847678
KL Loss: 5.980255
Y Loss: 0.968577
T Loss: 10.771734
X Loss: -4.408344
Epoch 1099 
Overall Loss: 12.819263
Rec Loss: 6.813879
KL Loss: 6.005384
Y Loss: 0.933955
T Loss: 10.769984
X Loss: -4.423083
Epoch 1149 
Overall Loss: 12.812546
Rec Loss: 6.795597
KL Loss: 6.016949
Y Loss: 0.937663
T Loss: 10.765606
X Loss: -4.438841
Epoch 1199 
Overall Loss: 12.800291
Rec Loss: 6.811234
KL Loss: 5.989057
Y Loss: 0.956625
T Loss: 10.778741
X Loss: -4.445820
Epoch 1249 
Overall Loss: 12.770756
Rec Loss: 6.756517
KL Loss: 6.014239
Y Loss: 0.943536
T Loss: 10.759498
X Loss: -4.474749
Epoch 1299 
Overall Loss: 12.768790
Rec Loss: 6.771308
KL Loss: 5.997482
Y Loss: 0.962221
T Loss: 10.762247
X Loss: -4.472050
Epoch 1349 
Overall Loss: 12.767934
Rec Loss: 6.757317
KL Loss: 6.010617
Y Loss: 0.947705
T Loss: 10.775686
X Loss: -4.492221
Epoch 1399 
Overall Loss: 12.737137
Rec Loss: 6.733062
KL Loss: 6.004074
Y Loss: 0.925650
T Loss: 10.758849
X Loss: -4.488612
Epoch 1449 
Overall Loss: 12.723411
Rec Loss: 6.696857
KL Loss: 6.026554
Y Loss: 0.936293
T Loss: 10.774070
X Loss: -4.545359
Epoch 1499 
Overall Loss: 12.717932
Rec Loss: 6.688788
KL Loss: 6.029143
Y Loss: 0.936809
T Loss: 10.750972
X Loss: -4.530588
Epoch 1549 
Overall Loss: 12.735627
Rec Loss: 6.696902
KL Loss: 6.038726
Y Loss: 0.942084
T Loss: 10.761386
X Loss: -4.535526
Epoch 1599 
Overall Loss: 12.697485
Rec Loss: 6.659464
KL Loss: 6.038021
Y Loss: 0.941647
T Loss: 10.754901
X Loss: -4.566260
Epoch 1649 
Overall Loss: 12.664175
Rec Loss: 6.641954
KL Loss: 6.022221
Y Loss: 0.927905
T Loss: 10.743465
X Loss: -4.565463
Epoch 1699 
Overall Loss: 12.689155
Rec Loss: 6.635733
KL Loss: 6.053423
Y Loss: 0.964434
T Loss: 10.763574
X Loss: -4.610058
Epoch 1749 
Overall Loss: 12.679926
Rec Loss: 6.639088
KL Loss: 6.040838
Y Loss: 0.928297
T Loss: 10.767354
X Loss: -4.592415
Epoch 1799 
Overall Loss: 12.695625
Rec Loss: 6.642144
KL Loss: 6.053480
Y Loss: 0.947712
T Loss: 10.753411
X Loss: -4.585122
Epoch 1849 
Overall Loss: 12.694576
Rec Loss: 6.639583
KL Loss: 6.054993
Y Loss: 0.955645
T Loss: 10.771916
X Loss: -4.610155
Epoch 1899 
Overall Loss: 12.689548
Rec Loss: 6.607499
KL Loss: 6.082049
Y Loss: 0.936789
T Loss: 10.750472
X Loss: -4.611368
Epoch 1949 
Overall Loss: 12.659572
Rec Loss: 6.558422
KL Loss: 6.101150
Y Loss: 0.935627
T Loss: 10.754426
X Loss: -4.663818
Epoch 1999 
Overall Loss: 12.632372
Rec Loss: 6.548457
KL Loss: 6.083915
Y Loss: 0.947510
T Loss: 10.763199
X Loss: -4.688496
Epoch 2049 
Overall Loss: 12.637634
Rec Loss: 6.559393
KL Loss: 6.078240
Y Loss: 0.956486
T Loss: 10.751586
X Loss: -4.670436
Epoch 2099 
Overall Loss: 12.632399
Rec Loss: 6.546889
KL Loss: 6.085510
Y Loss: 0.959320
T Loss: 10.764195
X Loss: -4.696966
Epoch 2149 
Overall Loss: 12.665406
Rec Loss: 6.556745
KL Loss: 6.108661
Y Loss: 0.953008
T Loss: 10.757560
X Loss: -4.677319
Epoch 2199 
Overall Loss: 12.621225
Rec Loss: 6.498350
KL Loss: 6.122874
Y Loss: 0.937527
T Loss: 10.758188
X Loss: -4.728601
Epoch 2249 
Overall Loss: 12.612688
Rec Loss: 6.498719
KL Loss: 6.113969
Y Loss: 0.923552
T Loss: 10.755391
X Loss: -4.718447
Epoch 2299 
Overall Loss: 12.634506
Rec Loss: 6.516003
KL Loss: 6.118503
Y Loss: 0.947987
T Loss: 10.771743
X Loss: -4.729734
Epoch 2349 
Overall Loss: 12.645290
Rec Loss: 6.506449
KL Loss: 6.138841
Y Loss: 0.931128
T Loss: 10.767554
X Loss: -4.726669
Epoch 2399 
Overall Loss: 12.656159
Rec Loss: 6.502471
KL Loss: 6.153688
Y Loss: 0.951751
T Loss: 10.750890
X Loss: -4.724294
Epoch 2449 
Overall Loss: 12.603860
Rec Loss: 6.460843
KL Loss: 6.143017
Y Loss: 0.948849
T Loss: 10.749973
X Loss: -4.763555
Epoch 2499 
Overall Loss: 12.613858
Rec Loss: 6.455524
KL Loss: 6.158334
Y Loss: 0.936472
T Loss: 10.764382
X Loss: -4.777093
Epoch 2549 
Overall Loss: 12.617777
Rec Loss: 6.434711
KL Loss: 6.183066
Y Loss: 0.920245
T Loss: 10.755248
X Loss: -4.780659
Epoch 2599 
Overall Loss: 12.613128
Rec Loss: 6.424767
KL Loss: 6.188361
Y Loss: 0.940648
T Loss: 10.756958
X Loss: -4.802515
Epoch 2649 
Overall Loss: 12.619241
Rec Loss: 6.444942
KL Loss: 6.174300
Y Loss: 0.940437
T Loss: 10.765101
X Loss: -4.790377
Epoch 2699 
Overall Loss: 12.614110
Rec Loss: 6.446347
KL Loss: 6.167763
Y Loss: 0.945864
T Loss: 10.780463
X Loss: -4.807048
Epoch 2749 
Overall Loss: 12.633576
Rec Loss: 6.440723
KL Loss: 6.192853
Y Loss: 0.959699
T Loss: 10.762630
X Loss: -4.801757
Epoch 2799 
Overall Loss: 12.592933
Rec Loss: 6.393842
KL Loss: 6.199090
Y Loss: 0.963313
T Loss: 10.755585
X Loss: -4.843399
Epoch 2849 
Overall Loss: 12.593271
Rec Loss: 6.389830
KL Loss: 6.203441
Y Loss: 0.939056
T Loss: 10.748168
X Loss: -4.827865
Epoch 2899 
Overall Loss: 12.599651
Rec Loss: 6.398248
KL Loss: 6.201403
Y Loss: 0.963472
T Loss: 10.767841
X Loss: -4.851329
Epoch 2949 
Overall Loss: 12.585740
Rec Loss: 6.384462
KL Loss: 6.201278
Y Loss: 0.965200
T Loss: 10.754464
X Loss: -4.852602
Epoch 2999 
Overall Loss: 12.629825
Rec Loss: 6.407301
KL Loss: 6.222524
Y Loss: 0.926612
T Loss: 10.764445
X Loss: -4.820450
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.759163
Epoch 99
Rec Loss: 1.769764
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.006100
Epoch 99
Rec Loss: 1.995931
Epoch 149
Rec Loss: 1.992998
Epoch 199
Rec Loss: 2.000668
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.662610
Insample Error 2.466503
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.515957
Epoch 99 
Prediction Loss: 2.315488
Epoch 149 
Prediction Loss: 2.336995
Epoch 199 
Prediction Loss: 2.180081
Epoch 249 
Prediction Loss: 2.022277
Epoch 299 
Prediction Loss: 1.992735
Epoch 349 
Prediction Loss: 1.820483
Epoch 399 
Prediction Loss: 1.751644
Epoch 449 
Prediction Loss: 1.682205
Epoch 499 
Prediction Loss: 1.604378
Epoch 549 
Prediction Loss: 1.524336
Epoch 599 
Prediction Loss: 1.496842
Epoch 649 
Prediction Loss: 1.426712
Epoch 699 
Prediction Loss: 1.370753
Epoch 749 
Prediction Loss: 1.344272
Epoch 799 
Prediction Loss: 1.287452
Epoch 849 
Prediction Loss: 1.210064
Epoch 899 
Prediction Loss: 1.181964
Epoch 949 
Prediction Loss: 1.178590
Epoch 999 
Prediction Loss: 1.134932
Epoch 1049 
Prediction Loss: 1.145255
Epoch 1099 
Prediction Loss: 1.081840
Epoch 1149 
Prediction Loss: 1.048885
Epoch 1199 
Prediction Loss: 1.020788
Epoch 1249 
Prediction Loss: 1.058441
Epoch 1299 
Prediction Loss: 0.988320
Epoch 1349 
Prediction Loss: 0.980916
Epoch 1399 
Prediction Loss: 0.975248
Epoch 1449 
Prediction Loss: 0.986538
Epoch 1499 
Prediction Loss: 0.966672
Epoch 1549 
Prediction Loss: 0.928520
Epoch 1599 
Prediction Loss: 0.907568
Epoch 1649 
Prediction Loss: 0.906520
Epoch 1699 
Prediction Loss: 0.877849
Epoch 1749 
Prediction Loss: 0.880704
Epoch 1799 
Prediction Loss: 0.857447
Epoch 1849 
Prediction Loss: 0.851020
Epoch 1899 
Prediction Loss: 0.832705
Epoch 1949 
Prediction Loss: 0.837253
Epoch 1999 
Prediction Loss: 0.879534
Epoch 2049 
Prediction Loss: 0.854119
Epoch 2099 
Prediction Loss: 0.841088
Epoch 2149 
Prediction Loss: 0.792527
Epoch 2199 
Prediction Loss: 0.801372
Epoch 2249 
Prediction Loss: 0.776040
Epoch 2299 
Prediction Loss: 0.796572
Epoch 2349 
Prediction Loss: 0.777135
Epoch 2399 
Prediction Loss: 0.776472
Epoch 2449 
Prediction Loss: 0.800373
Epoch 2499 
Prediction Loss: 0.796378
Epoch 2549 
Prediction Loss: 0.747201
Epoch 2599 
Prediction Loss: 0.759630
Epoch 2649 
Prediction Loss: 0.771105
Epoch 2699 
Prediction Loss: 0.732361
Epoch 2749 
Prediction Loss: 0.734408
Epoch 2799 
Prediction Loss: 0.743959
Epoch 2849 
Prediction Loss: 0.725570
Epoch 2899 
Prediction Loss: 0.717088
Epoch 2949 
Prediction Loss: 0.710246
Epoch 2999 
Prediction Loss: 0.714377
Epoch 3049 
Prediction Loss: 0.725506
Epoch 3099 
Prediction Loss: 0.719342
Epoch 3149 
Prediction Loss: 0.695037
Epoch 3199 
Prediction Loss: 0.697607
Epoch 3249 
Prediction Loss: 0.701857
Epoch 3299 
Prediction Loss: 0.691312
Epoch 3349 
Prediction Loss: 0.708826
Epoch 3399 
Prediction Loss: 0.675510
Epoch 3449 
Prediction Loss: 0.725121
Epoch 3499 
Prediction Loss: 0.681270
Epoch 3549 
Prediction Loss: 0.684471
Epoch 3599 
Prediction Loss: 0.748548
Epoch 3649 
Prediction Loss: 0.665979
Epoch 3699 
Prediction Loss: 0.655826
Epoch 3749 
Prediction Loss: 0.650405
Epoch 3799 
Prediction Loss: 0.701109
Epoch 3849 
Prediction Loss: 0.668655
Epoch 3899 
Prediction Loss: 0.699952
Epoch 3949 
Prediction Loss: 0.690537
Epoch 3999 
Prediction Loss: 0.639867
Epoch 4049 
Prediction Loss: 0.645871
Epoch 4099 
Prediction Loss: 0.706680
Epoch 4149 
Prediction Loss: 0.661419
Epoch 4199 
Prediction Loss: 0.642656
Epoch 4249 
Prediction Loss: 0.653148
Epoch 4299 
Prediction Loss: 0.639712
Epoch 4349 
Prediction Loss: 0.635857
Epoch 4399 
Prediction Loss: 0.654881
Epoch 4449 
Prediction Loss: 0.646146
Epoch 4499 
Prediction Loss: 0.636004
Epoch 4549 
Prediction Loss: 0.633787
Epoch 4599 
Prediction Loss: 0.634670
Epoch 4649 
Prediction Loss: 0.621202
Epoch 4699 
Prediction Loss: 0.649743
Epoch 4749 
Prediction Loss: 0.610304
Epoch 4799 
Prediction Loss: 0.619974
Epoch 4849 
Prediction Loss: 0.648232
Epoch 4899 
Prediction Loss: 0.633468
Epoch 4949 
Prediction Loss: 0.603213
Epoch 4999 
Prediction Loss: 0.621215
Epoch 5049 
Prediction Loss: 0.628571
Epoch 5099 
Prediction Loss: 0.620438
Epoch 5149 
Prediction Loss: 0.627138
Epoch 5199 
Prediction Loss: 0.612152
Epoch 5249 
Prediction Loss: 0.626465
Epoch 5299 
Prediction Loss: 0.635016
Epoch 5349 
Prediction Loss: 0.638103
Epoch 5399 
Prediction Loss: 0.595098
Epoch 5449 
Prediction Loss: 0.653551
Epoch 5499 
Prediction Loss: 0.591866
Epoch 5549 
Prediction Loss: 0.588288
Epoch 5599 
Prediction Loss: 0.616573
Epoch 5649 
Prediction Loss: 0.602583
Epoch 5699 
Prediction Loss: 0.578328
Epoch 5749 
Prediction Loss: 0.627700
Epoch 5799 
Prediction Loss: 0.586891
Epoch 5849 
Prediction Loss: 0.617957
Epoch 5899 
Prediction Loss: 0.618276
Epoch 5949 
Prediction Loss: 0.577004
Epoch 5999 
Prediction Loss: 0.608562
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.789768
Insample Error 3.501397
[31m========== repeat time 9 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.056860
Rec Loss: 11.298368
KL Loss: 1.758492
Y Loss: 0.990112
T Loss: 10.803312
Epoch 99 
Overall Loss: 12.870636
Rec Loss: 11.198911
KL Loss: 1.671726
Y Loss: 0.940994
T Loss: 10.728413
Epoch 149 
Overall Loss: 12.773783
Rec Loss: 10.932381
KL Loss: 1.841402
Y Loss: 0.937238
T Loss: 10.463762
Epoch 199 
Overall Loss: 12.709616
Rec Loss: 10.863146
KL Loss: 1.846470
Y Loss: 0.915739
T Loss: 10.405277
Epoch 249 
Overall Loss: 12.715661
Rec Loss: 10.887050
KL Loss: 1.828611
Y Loss: 0.913130
T Loss: 10.430485
Epoch 299 
Overall Loss: 12.703779
Rec Loss: 10.892897
KL Loss: 1.810882
Y Loss: 0.928615
T Loss: 10.428589
Epoch 349 
Overall Loss: 12.693783
Rec Loss: 10.908648
KL Loss: 1.785135
Y Loss: 0.934155
T Loss: 10.441571
Epoch 399 
Overall Loss: 12.679627
Rec Loss: 10.890128
KL Loss: 1.789499
Y Loss: 0.921023
T Loss: 10.429616
Epoch 449 
Overall Loss: 12.639344
Rec Loss: 10.875282
KL Loss: 1.764062
Y Loss: 0.902557
T Loss: 10.424003
Epoch 499 
Overall Loss: 12.643754
Rec Loss: 10.887698
KL Loss: 1.756056
Y Loss: 0.916975
T Loss: 10.429210
Epoch 549 
Overall Loss: 12.650725
Rec Loss: 10.856773
KL Loss: 1.793952
Y Loss: 0.871733
T Loss: 10.420906
Epoch 599 
Overall Loss: 12.620805
Rec Loss: 10.862505
KL Loss: 1.758300
Y Loss: 0.896145
T Loss: 10.414432
Epoch 649 
Overall Loss: 12.627727
Rec Loss: 10.867077
KL Loss: 1.760650
Y Loss: 0.895579
T Loss: 10.419288
Epoch 699 
Overall Loss: 12.612834
Rec Loss: 10.876443
KL Loss: 1.736392
Y Loss: 0.906793
T Loss: 10.423047
Epoch 749 
Overall Loss: 12.624907
Rec Loss: 10.843707
KL Loss: 1.781200
Y Loss: 0.876982
T Loss: 10.405216
Epoch 799 
Overall Loss: 12.638793
Rec Loss: 10.852330
KL Loss: 1.786462
Y Loss: 0.873917
T Loss: 10.415372
Epoch 849 
Overall Loss: 12.598840
Rec Loss: 10.845479
KL Loss: 1.753362
Y Loss: 0.879780
T Loss: 10.405589
Epoch 899 
Overall Loss: 12.604939
Rec Loss: 10.853947
KL Loss: 1.750992
Y Loss: 0.883045
T Loss: 10.412425
Epoch 949 
Overall Loss: 12.604430
Rec Loss: 10.830532
KL Loss: 1.773897
Y Loss: 0.866567
T Loss: 10.397249
Epoch 999 
Overall Loss: 12.577438
Rec Loss: 10.827535
KL Loss: 1.749904
Y Loss: 0.879745
T Loss: 10.387662
Epoch 1049 
Overall Loss: 12.606199
Rec Loss: 10.849488
KL Loss: 1.756710
Y Loss: 0.878330
T Loss: 10.410324
Epoch 1099 
Overall Loss: 12.593696
Rec Loss: 10.832855
KL Loss: 1.760841
Y Loss: 0.875036
T Loss: 10.395337
Epoch 1149 
Overall Loss: 12.574399
Rec Loss: 10.826260
KL Loss: 1.748139
Y Loss: 0.882030
T Loss: 10.385245
Epoch 1199 
Overall Loss: 12.584815
Rec Loss: 10.857008
KL Loss: 1.727807
Y Loss: 0.871667
T Loss: 10.421175
Epoch 1249 
Overall Loss: 12.580914
Rec Loss: 10.832551
KL Loss: 1.748363
Y Loss: 0.870860
T Loss: 10.397121
Epoch 1299 
Overall Loss: 12.567320
Rec Loss: 10.831538
KL Loss: 1.735782
Y Loss: 0.862545
T Loss: 10.400265
Epoch 1349 
Overall Loss: 12.563798
Rec Loss: 10.828614
KL Loss: 1.735185
Y Loss: 0.875178
T Loss: 10.391025
Epoch 1399 
Overall Loss: 12.563055
Rec Loss: 10.823773
KL Loss: 1.739282
Y Loss: 0.865394
T Loss: 10.391076
Epoch 1449 
Overall Loss: 12.584887
Rec Loss: 10.845747
KL Loss: 1.739139
Y Loss: 0.887544
T Loss: 10.401976
Epoch 1499 
Overall Loss: 12.554703
Rec Loss: 10.806151
KL Loss: 1.748552
Y Loss: 0.847385
T Loss: 10.382459
Epoch 1549 
Overall Loss: 12.532455
Rec Loss: 10.792390
KL Loss: 1.740065
Y Loss: 0.854702
T Loss: 10.365040
Epoch 1599 
Overall Loss: 12.548614
Rec Loss: 10.788425
KL Loss: 1.760190
Y Loss: 0.837297
T Loss: 10.369776
Epoch 1649 
Overall Loss: 12.543795
Rec Loss: 10.786750
KL Loss: 1.757045
Y Loss: 0.847704
T Loss: 10.362898
Epoch 1699 
Overall Loss: 12.540335
Rec Loss: 10.800988
KL Loss: 1.739347
Y Loss: 0.858687
T Loss: 10.371644
Epoch 1749 
Overall Loss: 12.526554
Rec Loss: 10.789960
KL Loss: 1.736594
Y Loss: 0.860844
T Loss: 10.359538
Epoch 1799 
Overall Loss: 12.530289
Rec Loss: 10.802684
KL Loss: 1.727605
Y Loss: 0.869071
T Loss: 10.368148
Epoch 1849 
Overall Loss: 12.533632
Rec Loss: 10.799970
KL Loss: 1.733662
Y Loss: 0.847147
T Loss: 10.376396
Epoch 1899 
Overall Loss: 12.530487
Rec Loss: 10.784649
KL Loss: 1.745838
Y Loss: 0.859917
T Loss: 10.354691
Epoch 1949 
Overall Loss: 12.524725
Rec Loss: 10.793818
KL Loss: 1.730907
Y Loss: 0.822234
T Loss: 10.382701
Epoch 1999 
Overall Loss: 12.519657
Rec Loss: 10.781023
KL Loss: 1.738633
Y Loss: 0.847806
T Loss: 10.357120
Epoch 2049 
Overall Loss: 12.531834
Rec Loss: 10.793646
KL Loss: 1.738188
Y Loss: 0.852760
T Loss: 10.367266
Epoch 2099 
Overall Loss: 12.515121
Rec Loss: 10.775956
KL Loss: 1.739165
Y Loss: 0.852655
T Loss: 10.349628
Epoch 2149 
Overall Loss: 12.513209
Rec Loss: 10.805324
KL Loss: 1.707885
Y Loss: 0.862776
T Loss: 10.373937
Epoch 2199 
Overall Loss: 12.503418
Rec Loss: 10.770808
KL Loss: 1.732610
Y Loss: 0.850102
T Loss: 10.345757
Epoch 2249 
Overall Loss: 12.464120
Rec Loss: 10.760977
KL Loss: 1.703143
Y Loss: 0.842699
T Loss: 10.339628
Epoch 2299 
Overall Loss: 12.515282
Rec Loss: 10.798537
KL Loss: 1.716746
Y Loss: 0.856971
T Loss: 10.370052
Epoch 2349 
Overall Loss: 12.501467
Rec Loss: 10.755855
KL Loss: 1.745611
Y Loss: 0.840373
T Loss: 10.335669
Epoch 2399 
Overall Loss: 12.476720
Rec Loss: 10.759716
KL Loss: 1.717004
Y Loss: 0.853816
T Loss: 10.332808
Epoch 2449 
Overall Loss: 12.463381
Rec Loss: 10.736226
KL Loss: 1.727155
Y Loss: 0.851526
T Loss: 10.310463
Epoch 2499 
Overall Loss: 12.505598
Rec Loss: 10.769764
KL Loss: 1.735834
Y Loss: 0.843966
T Loss: 10.347781
Epoch 2549 
Overall Loss: 12.463425
Rec Loss: 10.738491
KL Loss: 1.724934
Y Loss: 0.835972
T Loss: 10.320505
Epoch 2599 
Overall Loss: 12.476337
Rec Loss: 10.757501
KL Loss: 1.718836
Y Loss: 0.849002
T Loss: 10.333000
Epoch 2649 
Overall Loss: 12.454435
Rec Loss: 10.731716
KL Loss: 1.722719
Y Loss: 0.836013
T Loss: 10.313709
Epoch 2699 
Overall Loss: 12.492321
Rec Loss: 10.754701
KL Loss: 1.737620
Y Loss: 0.867188
T Loss: 10.321107
Epoch 2749 
Overall Loss: 12.477564
Rec Loss: 10.739054
KL Loss: 1.738511
Y Loss: 0.831277
T Loss: 10.323415
Epoch 2799 
Overall Loss: 12.452242
Rec Loss: 10.746645
KL Loss: 1.705597
Y Loss: 0.858045
T Loss: 10.317623
Epoch 2849 
Overall Loss: 12.475152
Rec Loss: 10.723136
KL Loss: 1.752016
Y Loss: 0.826992
T Loss: 10.309639
Epoch 2899 
Overall Loss: 12.440580
Rec Loss: 10.744248
KL Loss: 1.696332
Y Loss: 0.822912
T Loss: 10.332792
Epoch 2949 
Overall Loss: 12.453402
Rec Loss: 10.725701
KL Loss: 1.727700
Y Loss: 0.828381
T Loss: 10.311511
Epoch 2999 
Overall Loss: 12.448588
Rec Loss: 10.708564
KL Loss: 1.740023
Y Loss: 0.814486
T Loss: 10.301321
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.468731
Epoch 99
Rec Loss: 1.466217
Epoch 149
Rec Loss: 1.462958
Epoch 199
Rec Loss: 1.457805
Epoch 249
Rec Loss: 1.457523
Epoch 299
Rec Loss: 1.456905
Epoch 349
Rec Loss: 1.465848
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.931563
Epoch 99
Rec Loss: 9.927066
Epoch 149
Rec Loss: 9.902515
Epoch 199
Rec Loss: 9.908526
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.685943
Insample Error: 1.847933
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.316714
Rec Loss: 19.443283
KL Loss: 2.873430
Y Loss: 10.116406
T Loss: 12.978026
X Loss: 1.407055
Epoch 99 
Overall Loss: 16.724923
Rec Loss: 13.234333
KL Loss: 3.490591
Y Loss: 3.527377
T Loss: 12.941569
X Loss: -1.470925
Epoch 149 
Overall Loss: 15.678368
Rec Loss: 12.371515
KL Loss: 3.306853
Y Loss: 2.679830
T Loss: 12.992140
X Loss: -1.960540
Epoch 199 
Overall Loss: 14.845779
Rec Loss: 11.249466
KL Loss: 3.596313
Y Loss: 2.041104
T Loss: 12.530750
X Loss: -2.301837
Epoch 249 
Overall Loss: 14.140587
Rec Loss: 10.072991
KL Loss: 4.067596
Y Loss: 1.567740
T Loss: 11.843685
X Loss: -2.554564
Epoch 299 
Overall Loss: 13.814032
Rec Loss: 9.573852
KL Loss: 4.240181
Y Loss: 1.384977
T Loss: 11.621171
X Loss: -2.739808
Epoch 349 
Overall Loss: 13.668943
Rec Loss: 9.360798
KL Loss: 4.308145
Y Loss: 1.329527
T Loss: 11.567291
X Loss: -2.871257
Epoch 399 
Overall Loss: 13.564516
Rec Loss: 9.159867
KL Loss: 4.404649
Y Loss: 1.284508
T Loss: 11.521400
X Loss: -3.003787
Epoch 449 
Overall Loss: 13.452971
Rec Loss: 8.975024
KL Loss: 4.477947
Y Loss: 1.237327
T Loss: 11.474240
X Loss: -3.117879
Epoch 499 
Overall Loss: 13.366360
Rec Loss: 8.855099
KL Loss: 4.511261
Y Loss: 1.234079
T Loss: 11.437126
X Loss: -3.199067
Epoch 549 
Overall Loss: 13.317544
Rec Loss: 8.720551
KL Loss: 4.596993
Y Loss: 1.185040
T Loss: 11.401714
X Loss: -3.273684
Epoch 599 
Overall Loss: 13.239350
Rec Loss: 8.574168
KL Loss: 4.665183
Y Loss: 1.169796
T Loss: 11.346323
X Loss: -3.357053
Epoch 649 
Overall Loss: 13.113408
Rec Loss: 8.337460
KL Loss: 4.775948
Y Loss: 1.075634
T Loss: 11.202576
X Loss: -3.402933
Epoch 699 
Overall Loss: 13.043500
Rec Loss: 8.010541
KL Loss: 5.032959
Y Loss: 1.091615
T Loss: 10.957688
X Loss: -3.492955
Epoch 749 
Overall Loss: 12.950349
Rec Loss: 7.787658
KL Loss: 5.162691
Y Loss: 1.070162
T Loss: 10.799556
X Loss: -3.546979
Epoch 799 
Overall Loss: 12.939335
Rec Loss: 7.708925
KL Loss: 5.230410
Y Loss: 1.032902
T Loss: 10.777019
X Loss: -3.584545
Epoch 849 
Overall Loss: 12.859571
Rec Loss: 7.639649
KL Loss: 5.219922
Y Loss: 1.018492
T Loss: 10.742701
X Loss: -3.612298
Epoch 899 
Overall Loss: 12.847781
Rec Loss: 7.624857
KL Loss: 5.222924
Y Loss: 1.027555
T Loss: 10.733839
X Loss: -3.622759
Epoch 949 
Overall Loss: 12.850455
Rec Loss: 7.595728
KL Loss: 5.254727
Y Loss: 1.000580
T Loss: 10.716082
X Loss: -3.620644
Epoch 999 
Overall Loss: 12.832798
Rec Loss: 7.577331
KL Loss: 5.255467
Y Loss: 1.005965
T Loss: 10.734002
X Loss: -3.659654
Epoch 1049 
Overall Loss: 12.815610
Rec Loss: 7.560894
KL Loss: 5.254715
Y Loss: 0.992798
T Loss: 10.705344
X Loss: -3.640849
Epoch 1099 
Overall Loss: 12.790888
Rec Loss: 7.520806
KL Loss: 5.270082
Y Loss: 0.990873
T Loss: 10.693429
X Loss: -3.668059
Epoch 1149 
Overall Loss: 12.802759
Rec Loss: 7.526462
KL Loss: 5.276297
Y Loss: 1.006671
T Loss: 10.731147
X Loss: -3.708021
Epoch 1199 
Overall Loss: 12.764659
Rec Loss: 7.486427
KL Loss: 5.278232
Y Loss: 0.998258
T Loss: 10.701558
X Loss: -3.714260
Epoch 1249 
Overall Loss: 12.774461
Rec Loss: 7.471998
KL Loss: 5.302463
Y Loss: 1.000201
T Loss: 10.718274
X Loss: -3.746376
Epoch 1299 
Overall Loss: 12.743646
Rec Loss: 7.442451
KL Loss: 5.301196
Y Loss: 0.963560
T Loss: 10.717801
X Loss: -3.757130
Epoch 1349 
Overall Loss: 12.761949
Rec Loss: 7.421571
KL Loss: 5.340378
Y Loss: 0.960065
T Loss: 10.717720
X Loss: -3.776181
Epoch 1399 
Overall Loss: 12.710436
Rec Loss: 7.374604
KL Loss: 5.335832
Y Loss: 0.932099
T Loss: 10.690682
X Loss: -3.782127
Epoch 1449 
Overall Loss: 12.736417
Rec Loss: 7.386074
KL Loss: 5.350343
Y Loss: 0.960951
T Loss: 10.713956
X Loss: -3.808358
Epoch 1499 
Overall Loss: 12.693638
Rec Loss: 7.331505
KL Loss: 5.362132
Y Loss: 0.945039
T Loss: 10.706082
X Loss: -3.847097
Epoch 1549 
Overall Loss: 12.703821
Rec Loss: 7.344614
KL Loss: 5.359207
Y Loss: 0.967459
T Loss: 10.727583
X Loss: -3.866698
Epoch 1599 
Overall Loss: 12.720801
Rec Loss: 7.312679
KL Loss: 5.408122
Y Loss: 0.977084
T Loss: 10.709962
X Loss: -3.885825
Epoch 1649 
Overall Loss: 12.698742
Rec Loss: 7.280757
KL Loss: 5.417985
Y Loss: 0.951364
T Loss: 10.701895
X Loss: -3.896820
Epoch 1699 
Overall Loss: 12.673241
Rec Loss: 7.251571
KL Loss: 5.421670
Y Loss: 0.951590
T Loss: 10.687041
X Loss: -3.911266
Epoch 1749 
Overall Loss: 12.658597
Rec Loss: 7.229385
KL Loss: 5.429212
Y Loss: 0.949518
T Loss: 10.696919
X Loss: -3.942294
Epoch 1799 
Overall Loss: 12.679126
Rec Loss: 7.243605
KL Loss: 5.435522
Y Loss: 0.962060
T Loss: 10.700425
X Loss: -3.937850
Epoch 1849 
Overall Loss: 12.651465
Rec Loss: 7.186710
KL Loss: 5.464755
Y Loss: 0.941854
T Loss: 10.690840
X Loss: -3.975056
Epoch 1899 
Overall Loss: 12.662093
Rec Loss: 7.205912
KL Loss: 5.456181
Y Loss: 0.949382
T Loss: 10.717731
X Loss: -3.986510
Epoch 1949 
Overall Loss: 12.674174
Rec Loss: 7.208124
KL Loss: 5.466050
Y Loss: 0.952471
T Loss: 10.723115
X Loss: -3.991226
Epoch 1999 
Overall Loss: 12.681750
Rec Loss: 7.175888
KL Loss: 5.505861
Y Loss: 0.927780
T Loss: 10.723042
X Loss: -4.011043
Epoch 2049 
Overall Loss: 12.646478
Rec Loss: 7.143612
KL Loss: 5.502865
Y Loss: 0.929913
T Loss: 10.720138
X Loss: -4.041482
Epoch 2099 
Overall Loss: 12.646983
Rec Loss: 7.126115
KL Loss: 5.520868
Y Loss: 0.940638
T Loss: 10.704614
X Loss: -4.048818
Epoch 2149 
Overall Loss: 12.651868
Rec Loss: 7.119731
KL Loss: 5.532136
Y Loss: 0.943711
T Loss: 10.703417
X Loss: -4.055542
Epoch 2199 
Overall Loss: 12.642737
Rec Loss: 7.112897
KL Loss: 5.529840
Y Loss: 0.917401
T Loss: 10.709650
X Loss: -4.055453
Epoch 2249 
Overall Loss: 12.596441
Rec Loss: 7.075158
KL Loss: 5.521282
Y Loss: 0.916673
T Loss: 10.694493
X Loss: -4.077671
Epoch 2299 
Overall Loss: 12.654311
Rec Loss: 7.132360
KL Loss: 5.521951
Y Loss: 0.965201
T Loss: 10.727607
X Loss: -4.077847
Epoch 2349 
Overall Loss: 12.640855
Rec Loss: 7.090666
KL Loss: 5.550188
Y Loss: 0.943364
T Loss: 10.701133
X Loss: -4.082148
Epoch 2399 
Overall Loss: 12.635603
Rec Loss: 7.084807
KL Loss: 5.550796
Y Loss: 0.935026
T Loss: 10.722140
X Loss: -4.104846
Epoch 2449 
Overall Loss: 12.604295
Rec Loss: 7.015549
KL Loss: 5.588747
Y Loss: 0.933886
T Loss: 10.696325
X Loss: -4.147719
Epoch 2499 
Overall Loss: 12.619863
Rec Loss: 7.051159
KL Loss: 5.568704
Y Loss: 0.940554
T Loss: 10.710811
X Loss: -4.129929
Epoch 2549 
Overall Loss: 12.621330
Rec Loss: 7.025608
KL Loss: 5.595722
Y Loss: 0.923745
T Loss: 10.702442
X Loss: -4.138707
Epoch 2599 
Overall Loss: 12.602556
Rec Loss: 7.016573
KL Loss: 5.585982
Y Loss: 0.922778
T Loss: 10.717443
X Loss: -4.162259
Epoch 2649 
Overall Loss: 12.613308
Rec Loss: 6.999930
KL Loss: 5.613378
Y Loss: 0.946428
T Loss: 10.709021
X Loss: -4.182304
Epoch 2699 
Overall Loss: 12.615454
Rec Loss: 7.026886
KL Loss: 5.588568
Y Loss: 0.938292
T Loss: 10.728304
X Loss: -4.170564
Epoch 2749 
Overall Loss: 12.614976
Rec Loss: 7.013484
KL Loss: 5.601492
Y Loss: 0.941731
T Loss: 10.716371
X Loss: -4.173753
Epoch 2799 
Overall Loss: 12.602265
Rec Loss: 6.993315
KL Loss: 5.608950
Y Loss: 0.911703
T Loss: 10.704812
X Loss: -4.167348
Epoch 2849 
Overall Loss: 12.595470
Rec Loss: 6.966848
KL Loss: 5.628622
Y Loss: 0.950338
T Loss: 10.702116
X Loss: -4.210437
Epoch 2899 
Overall Loss: 12.579355
Rec Loss: 6.948723
KL Loss: 5.630632
Y Loss: 0.916275
T Loss: 10.704714
X Loss: -4.214128
Epoch 2949 
Overall Loss: 12.602690
Rec Loss: 6.969366
KL Loss: 5.633325
Y Loss: 0.928718
T Loss: 10.709645
X Loss: -4.204639
Epoch 2999 
Overall Loss: 12.621370
Rec Loss: 6.981525
KL Loss: 5.639845
Y Loss: 0.915383
T Loss: 10.719396
X Loss: -4.195563
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.905734
Epoch 99
Rec Loss: 1.914249
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.005228
Epoch 99
Rec Loss: 1.999456
Epoch 149
Rec Loss: 1.999422
Epoch 199
Rec Loss: 2.003289
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.660636
Insample Error 2.628964
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.549635
Epoch 99 
Prediction Loss: 2.299574
Epoch 149 
Prediction Loss: 2.211734
Epoch 199 
Prediction Loss: 2.129618
Epoch 249 
Prediction Loss: 2.024427
Epoch 299 
Prediction Loss: 1.933286
Epoch 349 
Prediction Loss: 1.845203
Epoch 399 
Prediction Loss: 1.743695
Epoch 449 
Prediction Loss: 1.717528
Epoch 499 
Prediction Loss: 1.605499
Epoch 549 
Prediction Loss: 1.512174
Epoch 599 
Prediction Loss: 1.485089
Epoch 649 
Prediction Loss: 1.414249
Epoch 699 
Prediction Loss: 1.370116
Epoch 749 
Prediction Loss: 1.335104
Epoch 799 
Prediction Loss: 1.274324
Epoch 849 
Prediction Loss: 1.239159
Epoch 899 
Prediction Loss: 1.189096
Epoch 949 
Prediction Loss: 1.178153
Epoch 999 
Prediction Loss: 1.135037
Epoch 1049 
Prediction Loss: 1.087121
Epoch 1099 
Prediction Loss: 1.088025
Epoch 1149 
Prediction Loss: 1.055817
Epoch 1199 
Prediction Loss: 1.091393
Epoch 1249 
Prediction Loss: 1.038861
Epoch 1299 
Prediction Loss: 0.989526
Epoch 1349 
Prediction Loss: 0.976952
Epoch 1399 
Prediction Loss: 0.945573
Epoch 1449 
Prediction Loss: 0.936603
Epoch 1499 
Prediction Loss: 0.936123
Epoch 1549 
Prediction Loss: 0.906301
Epoch 1599 
Prediction Loss: 0.932936
Epoch 1649 
Prediction Loss: 0.922580
Epoch 1699 
Prediction Loss: 0.898609
Epoch 1749 
Prediction Loss: 0.894698
Epoch 1799 
Prediction Loss: 0.849498
Epoch 1849 
Prediction Loss: 0.843017
Epoch 1899 
Prediction Loss: 0.834805
Epoch 1949 
Prediction Loss: 0.848915
Epoch 1999 
Prediction Loss: 0.824762
Epoch 2049 
Prediction Loss: 0.801618
Epoch 2099 
Prediction Loss: 0.790772
Epoch 2149 
Prediction Loss: 0.800702
Epoch 2199 
Prediction Loss: 0.787985
Epoch 2249 
Prediction Loss: 0.772235
Epoch 2299 
Prediction Loss: 0.764754
Epoch 2349 
Prediction Loss: 0.757674
Epoch 2399 
Prediction Loss: 0.752398
Epoch 2449 
Prediction Loss: 0.743068
Epoch 2499 
Prediction Loss: 0.759537
Epoch 2549 
Prediction Loss: 0.735779
Epoch 2599 
Prediction Loss: 0.740274
Epoch 2649 
Prediction Loss: 0.729591
Epoch 2699 
Prediction Loss: 0.747644
Epoch 2749 
Prediction Loss: 0.712882
Epoch 2799 
Prediction Loss: 0.717888
Epoch 2849 
Prediction Loss: 0.709564
Epoch 2899 
Prediction Loss: 0.712725
Epoch 2949 
Prediction Loss: 0.713927
Epoch 2999 
Prediction Loss: 0.707748
Epoch 3049 
Prediction Loss: 0.704894
Epoch 3099 
Prediction Loss: 0.695091
Epoch 3149 
Prediction Loss: 0.687461
Epoch 3199 
Prediction Loss: 0.681915
Epoch 3249 
Prediction Loss: 0.706104
Epoch 3299 
Prediction Loss: 0.670052
Epoch 3349 
Prediction Loss: 0.692168
Epoch 3399 
Prediction Loss: 0.677451
Epoch 3449 
Prediction Loss: 0.683580
Epoch 3499 
Prediction Loss: 0.678891
Epoch 3549 
Prediction Loss: 0.664280
Epoch 3599 
Prediction Loss: 0.686812
Epoch 3649 
Prediction Loss: 0.661223
Epoch 3699 
Prediction Loss: 0.670094
Epoch 3749 
Prediction Loss: 0.661057
Epoch 3799 
Prediction Loss: 0.653408
Epoch 3849 
Prediction Loss: 0.677501
Epoch 3899 
Prediction Loss: 0.673988
Epoch 3949 
Prediction Loss: 0.640861
Epoch 3999 
Prediction Loss: 0.642244
Epoch 4049 
Prediction Loss: 0.636573
Epoch 4099 
Prediction Loss: 0.648545
Epoch 4149 
Prediction Loss: 0.648101
Epoch 4199 
Prediction Loss: 0.617508
Epoch 4249 
Prediction Loss: 0.635742
Epoch 4299 
Prediction Loss: 0.619754
Epoch 4349 
Prediction Loss: 0.641647
Epoch 4399 
Prediction Loss: 0.660943
Epoch 4449 
Prediction Loss: 0.640422
Epoch 4499 
Prediction Loss: 0.642730
Epoch 4549 
Prediction Loss: 0.633684
Epoch 4599 
Prediction Loss: 0.617891
Epoch 4649 
Prediction Loss: 0.639171
Epoch 4699 
Prediction Loss: 0.609501
Epoch 4749 
Prediction Loss: 0.629240
Epoch 4799 
Prediction Loss: 0.617015
Epoch 4849 
Prediction Loss: 0.598788
Epoch 4899 
Prediction Loss: 0.632855
Epoch 4949 
Prediction Loss: 0.602658
Epoch 4999 
Prediction Loss: 0.607021
Epoch 5049 
Prediction Loss: 0.592193
Epoch 5099 
Prediction Loss: 0.601594
Epoch 5149 
Prediction Loss: 0.610995
Epoch 5199 
Prediction Loss: 0.599879
Epoch 5249 
Prediction Loss: 0.595245
Epoch 5299 
Prediction Loss: 0.617287
Epoch 5349 
Prediction Loss: 0.593196
Epoch 5399 
Prediction Loss: 0.589761
Epoch 5449 
Prediction Loss: 0.613919
Epoch 5499 
Prediction Loss: 0.590577
Epoch 5549 
Prediction Loss: 0.609778
Epoch 5599 
Prediction Loss: 0.593601
Epoch 5649 
Prediction Loss: 0.611571
Epoch 5699 
Prediction Loss: 0.582065
Epoch 5749 
Prediction Loss: 0.638308
Epoch 5799 
Prediction Loss: 0.595812
Epoch 5849 
Prediction Loss: 0.586577
Epoch 5899 
Prediction Loss: 0.580493
Epoch 5949 
Prediction Loss: 0.633962
Epoch 5999 
Prediction Loss: 0.579883
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.764554
Insample Error 3.510688
[31m========== repeat time 10 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 13.064857
Rec Loss: 11.328997
KL Loss: 1.735860
Y Loss: 1.017484
T Loss: 10.820255
Epoch 99 
Overall Loss: 12.924705
Rec Loss: 11.232827
KL Loss: 1.691878
Y Loss: 0.971955
T Loss: 10.746850
Epoch 149 
Overall Loss: 12.785387
Rec Loss: 10.967431
KL Loss: 1.817956
Y Loss: 0.930725
T Loss: 10.502068
Epoch 199 
Overall Loss: 12.746279
Rec Loss: 10.925825
KL Loss: 1.820454
Y Loss: 0.928699
T Loss: 10.461476
Epoch 249 
Overall Loss: 12.731561
Rec Loss: 10.910889
KL Loss: 1.820672
Y Loss: 0.922043
T Loss: 10.449867
Epoch 299 
Overall Loss: 12.697835
Rec Loss: 10.896895
KL Loss: 1.800940
Y Loss: 0.906728
T Loss: 10.443531
Epoch 349 
Overall Loss: 12.691659
Rec Loss: 10.927438
KL Loss: 1.764221
Y Loss: 0.926896
T Loss: 10.463990
Epoch 399 
Overall Loss: 12.669920
Rec Loss: 10.880772
KL Loss: 1.789149
Y Loss: 0.913718
T Loss: 10.423913
Epoch 449 
Overall Loss: 12.659182
Rec Loss: 10.909438
KL Loss: 1.749744
Y Loss: 0.935620
T Loss: 10.441628
Epoch 499 
Overall Loss: 12.662044
Rec Loss: 10.909353
KL Loss: 1.752691
Y Loss: 0.921771
T Loss: 10.448468
Epoch 549 
Overall Loss: 12.655913
Rec Loss: 10.906252
KL Loss: 1.749661
Y Loss: 0.905374
T Loss: 10.453565
Epoch 599 
Overall Loss: 12.651970
Rec Loss: 10.900802
KL Loss: 1.751168
Y Loss: 0.914894
T Loss: 10.443356
Epoch 649 
Overall Loss: 12.633714
Rec Loss: 10.879849
KL Loss: 1.753865
Y Loss: 0.911690
T Loss: 10.424005
Epoch 699 
Overall Loss: 12.615604
Rec Loss: 10.867169
KL Loss: 1.748435
Y Loss: 0.927252
T Loss: 10.403543
Epoch 749 
Overall Loss: 12.621249
Rec Loss: 10.859365
KL Loss: 1.761884
Y Loss: 0.877281
T Loss: 10.420725
Epoch 799 
Overall Loss: 12.629419
Rec Loss: 10.862402
KL Loss: 1.767017
Y Loss: 0.901673
T Loss: 10.411565
Epoch 849 
Overall Loss: 12.629265
Rec Loss: 10.863477
KL Loss: 1.765788
Y Loss: 0.886941
T Loss: 10.420007
Epoch 899 
Overall Loss: 12.615380
Rec Loss: 10.851344
KL Loss: 1.764036
Y Loss: 0.896237
T Loss: 10.403226
Epoch 949 
Overall Loss: 12.588902
Rec Loss: 10.842338
KL Loss: 1.746565
Y Loss: 0.888175
T Loss: 10.398250
Epoch 999 
Overall Loss: 12.627334
Rec Loss: 10.868323
KL Loss: 1.759011
Y Loss: 0.894999
T Loss: 10.420823
Epoch 1049 
Overall Loss: 12.590982
Rec Loss: 10.850031
KL Loss: 1.740951
Y Loss: 0.892740
T Loss: 10.403661
Epoch 1099 
Overall Loss: 12.594282
Rec Loss: 10.852946
KL Loss: 1.741335
Y Loss: 0.902631
T Loss: 10.401631
Epoch 1149 
Overall Loss: 12.572243
Rec Loss: 10.814705
KL Loss: 1.757538
Y Loss: 0.877147
T Loss: 10.376132
Epoch 1199 
Overall Loss: 12.595595
Rec Loss: 10.852769
KL Loss: 1.742826
Y Loss: 0.882722
T Loss: 10.411407
Epoch 1249 
Overall Loss: 12.589469
Rec Loss: 10.836302
KL Loss: 1.753167
Y Loss: 0.882109
T Loss: 10.395247
Epoch 1299 
Overall Loss: 12.582775
Rec Loss: 10.825746
KL Loss: 1.757030
Y Loss: 0.857786
T Loss: 10.396853
Epoch 1349 
Overall Loss: 12.573729
Rec Loss: 10.826622
KL Loss: 1.747107
Y Loss: 0.885572
T Loss: 10.383836
Epoch 1399 
Overall Loss: 12.581078
Rec Loss: 10.830546
KL Loss: 1.750533
Y Loss: 0.871592
T Loss: 10.394750
Epoch 1449 
Overall Loss: 12.581231
Rec Loss: 10.835931
KL Loss: 1.745300
Y Loss: 0.874100
T Loss: 10.398881
Epoch 1499 
Overall Loss: 12.564643
Rec Loss: 10.844277
KL Loss: 1.720366
Y Loss: 0.877931
T Loss: 10.405311
Epoch 1549 
Overall Loss: 12.553508
Rec Loss: 10.797929
KL Loss: 1.755579
Y Loss: 0.873495
T Loss: 10.361182
Epoch 1599 
Overall Loss: 12.527989
Rec Loss: 10.795657
KL Loss: 1.732332
Y Loss: 0.871361
T Loss: 10.359976
Epoch 1649 
Overall Loss: 12.547167
Rec Loss: 10.822551
KL Loss: 1.724616
Y Loss: 0.863888
T Loss: 10.390607
Epoch 1699 
Overall Loss: 12.540062
Rec Loss: 10.806360
KL Loss: 1.733702
Y Loss: 0.850911
T Loss: 10.380904
Epoch 1749 
Overall Loss: 12.535866
Rec Loss: 10.779965
KL Loss: 1.755901
Y Loss: 0.860634
T Loss: 10.349649
Epoch 1799 
Overall Loss: 12.528619
Rec Loss: 10.778182
KL Loss: 1.750437
Y Loss: 0.836983
T Loss: 10.359690
Epoch 1849 
Overall Loss: 12.545302
Rec Loss: 10.806336
KL Loss: 1.738966
Y Loss: 0.864167
T Loss: 10.374253
Epoch 1899 
Overall Loss: 12.525432
Rec Loss: 10.811456
KL Loss: 1.713976
Y Loss: 0.873419
T Loss: 10.374747
Epoch 1949 
Overall Loss: 12.513533
Rec Loss: 10.760195
KL Loss: 1.753337
Y Loss: 0.851364
T Loss: 10.334513
Epoch 1999 
Overall Loss: 12.508906
Rec Loss: 10.779315
KL Loss: 1.729592
Y Loss: 0.848163
T Loss: 10.355234
Epoch 2049 
Overall Loss: 12.500987
Rec Loss: 10.786750
KL Loss: 1.714237
Y Loss: 0.847820
T Loss: 10.362840
Epoch 2099 
Overall Loss: 12.482210
Rec Loss: 10.760146
KL Loss: 1.722063
Y Loss: 0.852496
T Loss: 10.333898
Epoch 2149 
Overall Loss: 12.497232
Rec Loss: 10.758260
KL Loss: 1.738972
Y Loss: 0.839091
T Loss: 10.338715
Epoch 2199 
Overall Loss: 12.509528
Rec Loss: 10.767348
KL Loss: 1.742179
Y Loss: 0.876938
T Loss: 10.328880
Epoch 2249 
Overall Loss: 12.485246
Rec Loss: 10.750482
KL Loss: 1.734764
Y Loss: 0.842264
T Loss: 10.329350
Epoch 2299 
Overall Loss: 12.495007
Rec Loss: 10.788556
KL Loss: 1.706451
Y Loss: 0.840682
T Loss: 10.368215
Epoch 2349 
Overall Loss: 12.502212
Rec Loss: 10.764087
KL Loss: 1.738126
Y Loss: 0.847115
T Loss: 10.340529
Epoch 2399 
Overall Loss: 12.485509
Rec Loss: 10.772723
KL Loss: 1.712785
Y Loss: 0.843389
T Loss: 10.351029
Epoch 2449 
Overall Loss: 12.484371
Rec Loss: 10.772475
KL Loss: 1.711896
Y Loss: 0.848315
T Loss: 10.348317
Epoch 2499 
Overall Loss: 12.484466
Rec Loss: 10.750226
KL Loss: 1.734239
Y Loss: 0.854591
T Loss: 10.322931
Epoch 2549 
Overall Loss: 12.472966
Rec Loss: 10.767525
KL Loss: 1.705441
Y Loss: 0.854187
T Loss: 10.340432
Epoch 2599 
Overall Loss: 12.467562
Rec Loss: 10.737300
KL Loss: 1.730261
Y Loss: 0.841678
T Loss: 10.316461
Epoch 2649 
Overall Loss: 12.464248
Rec Loss: 10.754236
KL Loss: 1.710012
Y Loss: 0.848444
T Loss: 10.330013
Epoch 2699 
Overall Loss: 12.451428
Rec Loss: 10.740517
KL Loss: 1.710911
Y Loss: 0.851115
T Loss: 10.314960
Epoch 2749 
Overall Loss: 12.490923
Rec Loss: 10.751151
KL Loss: 1.739772
Y Loss: 0.864531
T Loss: 10.318885
Epoch 2799 
Overall Loss: 12.458956
Rec Loss: 10.727464
KL Loss: 1.731492
Y Loss: 0.827057
T Loss: 10.313935
Epoch 2849 
Overall Loss: 12.454042
Rec Loss: 10.756055
KL Loss: 1.697987
Y Loss: 0.840284
T Loss: 10.335913
Epoch 2899 
Overall Loss: 12.456604
Rec Loss: 10.750132
KL Loss: 1.706472
Y Loss: 0.846490
T Loss: 10.326887
Epoch 2949 
Overall Loss: 12.447186
Rec Loss: 10.722527
KL Loss: 1.724659
Y Loss: 0.818407
T Loss: 10.313323
Epoch 2999 
Overall Loss: 12.444924
Rec Loss: 10.734833
KL Loss: 1.710090
Y Loss: 0.828401
T Loss: 10.320633
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.477256
Epoch 99
Rec Loss: 1.471416
Epoch 149
Rec Loss: 1.472327
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.910975
Epoch 99
Rec Loss: 9.920360
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.694410
Insample Error: 1.933582
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.898225
Rec Loss: 20.509199
KL Loss: 2.389027
Y Loss: 11.372877
T Loss: 13.059373
X Loss: 1.763387
Epoch 99 
Overall Loss: 16.875763
Rec Loss: 13.343019
KL Loss: 3.532744
Y Loss: 3.429939
T Loss: 12.856312
X Loss: -1.228262
Epoch 149 
Overall Loss: 15.306944
Rec Loss: 11.633976
KL Loss: 3.672968
Y Loss: 2.239867
T Loss: 12.594810
X Loss: -2.080768
Epoch 199 
Overall Loss: 14.725562
Rec Loss: 10.858982
KL Loss: 3.866580
Y Loss: 1.734994
T Loss: 12.543413
X Loss: -2.551928
Epoch 249 
Overall Loss: 14.321440
Rec Loss: 10.333444
KL Loss: 3.987996
Y Loss: 1.351185
T Loss: 12.466319
X Loss: -2.808468
Epoch 299 
Overall Loss: 14.039372
Rec Loss: 9.914770
KL Loss: 4.124602
Y Loss: 1.124639
T Loss: 12.321774
X Loss: -2.969323
Epoch 349 
Overall Loss: 13.839912
Rec Loss: 9.576493
KL Loss: 4.263420
Y Loss: 1.078343
T Loss: 12.142122
X Loss: -3.104800
Epoch 399 
Overall Loss: 13.599602
Rec Loss: 9.107044
KL Loss: 4.492559
Y Loss: 1.035380
T Loss: 11.894389
X Loss: -3.305036
Epoch 449 
Overall Loss: 13.496334
Rec Loss: 8.752437
KL Loss: 4.743897
Y Loss: 1.021105
T Loss: 11.700522
X Loss: -3.458639
Epoch 499 
Overall Loss: 13.381758
Rec Loss: 8.501482
KL Loss: 4.880275
Y Loss: 1.028907
T Loss: 11.579404
X Loss: -3.592375
Epoch 549 
Overall Loss: 13.323604
Rec Loss: 8.357251
KL Loss: 4.966353
Y Loss: 1.039879
T Loss: 11.532724
X Loss: -3.695412
Epoch 599 
Overall Loss: 13.258035
Rec Loss: 8.256773
KL Loss: 5.001262
Y Loss: 1.030102
T Loss: 11.504347
X Loss: -3.762625
Epoch 649 
Overall Loss: 13.221751
Rec Loss: 8.221020
KL Loss: 5.000731
Y Loss: 1.025835
T Loss: 11.483127
X Loss: -3.775024
Epoch 699 
Overall Loss: 13.180625
Rec Loss: 8.123221
KL Loss: 5.057404
Y Loss: 1.000324
T Loss: 11.459169
X Loss: -3.836111
Epoch 749 
Overall Loss: 13.189227
Rec Loss: 8.122544
KL Loss: 5.066684
Y Loss: 1.011938
T Loss: 11.454104
X Loss: -3.837529
Epoch 799 
Overall Loss: 13.138096
Rec Loss: 8.054579
KL Loss: 5.083517
Y Loss: 0.989325
T Loss: 11.419241
X Loss: -3.859323
Epoch 849 
Overall Loss: 13.089507
Rec Loss: 7.971332
KL Loss: 5.118175
Y Loss: 0.988202
T Loss: 11.333488
X Loss: -3.856257
Epoch 899 
Overall Loss: 12.956618
Rec Loss: 7.592847
KL Loss: 5.363771
Y Loss: 0.945959
T Loss: 11.064293
X Loss: -3.944425
Epoch 949 
Overall Loss: 12.879976
Rec Loss: 7.348245
KL Loss: 5.531731
Y Loss: 0.964955
T Loss: 10.836905
X Loss: -3.971137
Epoch 999 
Overall Loss: 12.869692
Rec Loss: 7.252175
KL Loss: 5.617516
Y Loss: 0.925279
T Loss: 10.781943
X Loss: -3.992407
Epoch 1049 
Overall Loss: 12.831522
Rec Loss: 7.230576
KL Loss: 5.600947
Y Loss: 0.958256
T Loss: 10.750882
X Loss: -3.999434
Epoch 1099 
Overall Loss: 12.824618
Rec Loss: 7.157526
KL Loss: 5.667092
Y Loss: 0.923933
T Loss: 10.732928
X Loss: -4.037369
Epoch 1149 
Overall Loss: 12.796149
Rec Loss: 7.123301
KL Loss: 5.672848
Y Loss: 0.920822
T Loss: 10.747552
X Loss: -4.084662
Epoch 1199 
Overall Loss: 12.800516
Rec Loss: 7.118623
KL Loss: 5.681893
Y Loss: 0.918072
T Loss: 10.741079
X Loss: -4.081492
Epoch 1249 
Overall Loss: 12.759834
Rec Loss: 7.062248
KL Loss: 5.697586
Y Loss: 0.884421
T Loss: 10.722681
X Loss: -4.102644
Epoch 1299 
Overall Loss: 12.757278
Rec Loss: 7.075275
KL Loss: 5.682003
Y Loss: 0.927449
T Loss: 10.725633
X Loss: -4.114083
Epoch 1349 
Overall Loss: 12.721711
Rec Loss: 7.020120
KL Loss: 5.701590
Y Loss: 0.900027
T Loss: 10.713781
X Loss: -4.143674
Epoch 1399 
Overall Loss: 12.730297
Rec Loss: 7.024833
KL Loss: 5.705463
Y Loss: 0.914271
T Loss: 10.712239
X Loss: -4.144541
Epoch 1449 
Overall Loss: 12.744195
Rec Loss: 7.018678
KL Loss: 5.725517
Y Loss: 0.914561
T Loss: 10.718117
X Loss: -4.156719
Epoch 1499 
Overall Loss: 12.728105
Rec Loss: 6.968526
KL Loss: 5.759578
Y Loss: 0.906032
T Loss: 10.706607
X Loss: -4.191097
Epoch 1549 
Overall Loss: 12.719008
Rec Loss: 6.975643
KL Loss: 5.743365
Y Loss: 0.917403
T Loss: 10.732091
X Loss: -4.215150
Epoch 1599 
Overall Loss: 12.706386
Rec Loss: 6.936072
KL Loss: 5.770314
Y Loss: 0.892473
T Loss: 10.712974
X Loss: -4.223138
Epoch 1649 
Overall Loss: 12.715213
Rec Loss: 6.937702
KL Loss: 5.777512
Y Loss: 0.918321
T Loss: 10.726563
X Loss: -4.248022
Epoch 1699 
Overall Loss: 12.726538
Rec Loss: 6.928359
KL Loss: 5.798179
Y Loss: 0.907594
T Loss: 10.723694
X Loss: -4.249132
Epoch 1749 
Overall Loss: 12.688038
Rec Loss: 6.885965
KL Loss: 5.802073
Y Loss: 0.900818
T Loss: 10.713621
X Loss: -4.278065
Epoch 1799 
Overall Loss: 12.698710
Rec Loss: 6.904913
KL Loss: 5.793797
Y Loss: 0.921115
T Loss: 10.718508
X Loss: -4.274153
Epoch 1849 
Overall Loss: 12.683302
Rec Loss: 6.870267
KL Loss: 5.813035
Y Loss: 0.903823
T Loss: 10.707051
X Loss: -4.288695
Epoch 1899 
Overall Loss: 12.667483
Rec Loss: 6.860837
KL Loss: 5.806646
Y Loss: 0.898930
T Loss: 10.720606
X Loss: -4.309234
Epoch 1949 
Overall Loss: 12.681270
Rec Loss: 6.846493
KL Loss: 5.834777
Y Loss: 0.911779
T Loss: 10.712017
X Loss: -4.321414
Epoch 1999 
Overall Loss: 12.659527
Rec Loss: 6.846507
KL Loss: 5.813020
Y Loss: 0.900167
T Loss: 10.722291
X Loss: -4.325868
Epoch 2049 
Overall Loss: 12.643230
Rec Loss: 6.831345
KL Loss: 5.811885
Y Loss: 0.923306
T Loss: 10.709155
X Loss: -4.339463
Epoch 2099 
Overall Loss: 12.666215
Rec Loss: 6.842405
KL Loss: 5.823810
Y Loss: 0.927356
T Loss: 10.709226
X Loss: -4.330499
Epoch 2149 
Overall Loss: 12.635885
Rec Loss: 6.790730
KL Loss: 5.845155
Y Loss: 0.915657
T Loss: 10.723923
X Loss: -4.391022
Epoch 2199 
Overall Loss: 12.640875
Rec Loss: 6.789971
KL Loss: 5.850903
Y Loss: 0.926076
T Loss: 10.702293
X Loss: -4.375360
Epoch 2249 
Overall Loss: 12.647358
Rec Loss: 6.786588
KL Loss: 5.860770
Y Loss: 0.919181
T Loss: 10.733134
X Loss: -4.406137
Epoch 2299 
Overall Loss: 12.633071
Rec Loss: 6.775251
KL Loss: 5.857820
Y Loss: 0.925429
T Loss: 10.708141
X Loss: -4.395604
Epoch 2349 
Overall Loss: 12.655437
Rec Loss: 6.755747
KL Loss: 5.899691
Y Loss: 0.918230
T Loss: 10.715962
X Loss: -4.419331
Epoch 2399 
Overall Loss: 12.661751
Rec Loss: 6.750590
KL Loss: 5.911162
Y Loss: 0.921540
T Loss: 10.715564
X Loss: -4.425745
Epoch 2449 
Overall Loss: 12.648049
Rec Loss: 6.750807
KL Loss: 5.897243
Y Loss: 0.919825
T Loss: 10.719870
X Loss: -4.428976
Epoch 2499 
Overall Loss: 12.646563
Rec Loss: 6.722753
KL Loss: 5.923809
Y Loss: 0.895618
T Loss: 10.720075
X Loss: -4.445131
Epoch 2549 
Overall Loss: 12.648201
Rec Loss: 6.716218
KL Loss: 5.931983
Y Loss: 0.913608
T Loss: 10.733094
X Loss: -4.473681
Epoch 2599 
Overall Loss: 12.608533
Rec Loss: 6.700561
KL Loss: 5.907972
Y Loss: 0.925869
T Loss: 10.715918
X Loss: -4.478291
Epoch 2649 
Overall Loss: 12.622709
Rec Loss: 6.675679
KL Loss: 5.947029
Y Loss: 0.912213
T Loss: 10.706694
X Loss: -4.487121
Epoch 2699 
Overall Loss: 12.629558
Rec Loss: 6.681655
KL Loss: 5.947903
Y Loss: 0.911199
T Loss: 10.720390
X Loss: -4.494334
Epoch 2749 
Overall Loss: 12.608069
Rec Loss: 6.651145
KL Loss: 5.956924
Y Loss: 0.925138
T Loss: 10.705800
X Loss: -4.517223
Epoch 2799 
Overall Loss: 12.617361
Rec Loss: 6.641264
KL Loss: 5.976097
Y Loss: 0.911625
T Loss: 10.724505
X Loss: -4.539054
Epoch 2849 
Overall Loss: 12.585434
Rec Loss: 6.640055
KL Loss: 5.945378
Y Loss: 0.920511
T Loss: 10.715712
X Loss: -4.535913
Epoch 2899 
Overall Loss: 12.625584
Rec Loss: 6.635519
KL Loss: 5.990064
Y Loss: 0.896503
T Loss: 10.731937
X Loss: -4.544669
Epoch 2949 
Overall Loss: 12.610607
Rec Loss: 6.641937
KL Loss: 5.968670
Y Loss: 0.926164
T Loss: 10.723447
X Loss: -4.544593
Epoch 2999 
Overall Loss: 12.600599
Rec Loss: 6.620244
KL Loss: 5.980355
Y Loss: 0.893699
T Loss: 10.710796
X Loss: -4.537402
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.801649
Epoch 99
Rec Loss: 1.799519
Epoch 149
Rec Loss: 1.790540
Epoch 199
Rec Loss: 1.809524
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.013070
Epoch 99
Rec Loss: 2.008889
Epoch 149
Rec Loss: 2.005209
Epoch 199
Rec Loss: 2.001928
Epoch 249
Rec Loss: 2.002181
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.655181
Insample Error 2.490373
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 2.532287
Epoch 99 
Prediction Loss: 2.366765
Epoch 149 
Prediction Loss: 2.205859
Epoch 199 
Prediction Loss: 2.179155
Epoch 249 
Prediction Loss: 2.043848
Epoch 299 
Prediction Loss: 1.923021
Epoch 349 
Prediction Loss: 1.832471
Epoch 399 
Prediction Loss: 1.703094
Epoch 449 
Prediction Loss: 1.648733
Epoch 499 
Prediction Loss: 1.554237
Epoch 549 
Prediction Loss: 1.449779
Epoch 599 
Prediction Loss: 1.387823
Epoch 649 
Prediction Loss: 1.350180
Epoch 699 
Prediction Loss: 1.280585
Epoch 749 
Prediction Loss: 1.239730
Epoch 799 
Prediction Loss: 1.202282
Epoch 849 
Prediction Loss: 1.170231
Epoch 899 
Prediction Loss: 1.159440
Epoch 949 
Prediction Loss: 1.079085
Epoch 999 
Prediction Loss: 1.047991
Epoch 1049 
Prediction Loss: 1.026311
Epoch 1099 
Prediction Loss: 1.006282
Epoch 1149 
Prediction Loss: 1.005305
Epoch 1199 
Prediction Loss: 0.948790
Epoch 1249 
Prediction Loss: 0.953531
Epoch 1299 
Prediction Loss: 0.920865
Epoch 1349 
Prediction Loss: 0.914090
Epoch 1399 
Prediction Loss: 0.883750
Epoch 1449 
Prediction Loss: 0.872934
Epoch 1499 
Prediction Loss: 0.890653
Epoch 1549 
Prediction Loss: 0.843941
Epoch 1599 
Prediction Loss: 0.828526
Epoch 1649 
Prediction Loss: 0.824926
Epoch 1699 
Prediction Loss: 0.799075
Epoch 1749 
Prediction Loss: 0.804794
Epoch 1799 
Prediction Loss: 0.802955
Epoch 1849 
Prediction Loss: 0.800719
Epoch 1899 
Prediction Loss: 0.754750
Epoch 1949 
Prediction Loss: 0.765686
Epoch 1999 
Prediction Loss: 0.745049
Epoch 2049 
Prediction Loss: 0.731109
Epoch 2099 
Prediction Loss: 0.727048
Epoch 2149 
Prediction Loss: 0.733406
Epoch 2199 
Prediction Loss: 0.736802
Epoch 2249 
Prediction Loss: 0.706629
Epoch 2299 
Prediction Loss: 0.701133
Epoch 2349 
Prediction Loss: 0.709686
Epoch 2399 
Prediction Loss: 0.697653
Epoch 2449 
Prediction Loss: 0.680734
Epoch 2499 
Prediction Loss: 0.679550
Epoch 2549 
Prediction Loss: 0.674837
Epoch 2599 
Prediction Loss: 0.675846
Epoch 2649 
Prediction Loss: 0.677151
Epoch 2699 
Prediction Loss: 0.650848
Epoch 2749 
Prediction Loss: 0.662047
Epoch 2799 
Prediction Loss: 0.650206
Epoch 2849 
Prediction Loss: 0.626395
Epoch 2899 
Prediction Loss: 0.642490
Epoch 2949 
Prediction Loss: 0.640286
Epoch 2999 
Prediction Loss: 0.614221
Epoch 3049 
Prediction Loss: 0.625700
Epoch 3099 
Prediction Loss: 0.648465
Epoch 3149 
Prediction Loss: 0.615646
Epoch 3199 
Prediction Loss: 0.619719
Epoch 3249 
Prediction Loss: 0.613588
Epoch 3299 
Prediction Loss: 0.603389
Epoch 3349 
Prediction Loss: 0.604311
Epoch 3399 
Prediction Loss: 0.614122
Epoch 3449 
Prediction Loss: 0.588682
Epoch 3499 
Prediction Loss: 0.589022
Epoch 3549 
Prediction Loss: 0.600350
Epoch 3599 
Prediction Loss: 0.594402
Epoch 3649 
Prediction Loss: 0.588554
Epoch 3699 
Prediction Loss: 0.582886
Epoch 3749 
Prediction Loss: 0.581758
Epoch 3799 
Prediction Loss: 0.602719
Epoch 3849 
Prediction Loss: 0.579333
Epoch 3899 
Prediction Loss: 0.589748
Epoch 3949 
Prediction Loss: 0.592739
Epoch 3999 
Prediction Loss: 0.573031
Epoch 4049 
Prediction Loss: 0.588181
Epoch 4099 
Prediction Loss: 0.570113
Epoch 4149 
Prediction Loss: 0.568563
Epoch 4199 
Prediction Loss: 0.588045
Epoch 4249 
Prediction Loss: 0.565157
Epoch 4299 
Prediction Loss: 0.586024
Epoch 4349 
Prediction Loss: 0.553841
Epoch 4399 
Prediction Loss: 0.546626
Epoch 4449 
Prediction Loss: 0.560509
Epoch 4499 
Prediction Loss: 0.568958
Epoch 4549 
Prediction Loss: 0.566950
Epoch 4599 
Prediction Loss: 0.546534
Epoch 4649 
Prediction Loss: 0.561667
Epoch 4699 
Prediction Loss: 0.554265
Epoch 4749 
Prediction Loss: 0.556718
Epoch 4799 
Prediction Loss: 0.551127
Epoch 4849 
Prediction Loss: 0.544422
Epoch 4899 
Prediction Loss: 0.538677
Epoch 4949 
Prediction Loss: 0.551824
Epoch 4999 
Prediction Loss: 0.552633
Epoch 5049 
Prediction Loss: 0.536152
Epoch 5099 
Prediction Loss: 0.554318
Epoch 5149 
Prediction Loss: 0.550834
Epoch 5199 
Prediction Loss: 0.546901
Epoch 5249 
Prediction Loss: 0.537383
Epoch 5299 
Prediction Loss: 0.526958
Epoch 5349 
Prediction Loss: 0.529659
Epoch 5399 
Prediction Loss: 0.531753
Epoch 5449 
Prediction Loss: 0.536117
Epoch 5499 
Prediction Loss: 0.520586
Epoch 5549 
Prediction Loss: 0.535018
Epoch 5599 
Prediction Loss: 0.542945
Epoch 5649 
Prediction Loss: 0.528339
Epoch 5699 
Prediction Loss: 0.531927
Epoch 5749 
Prediction Loss: 0.521088
Epoch 5799 
Prediction Loss: 0.521468
Epoch 5849 
Prediction Loss: 0.543492
Epoch 5899 
Prediction Loss: 0.521615
Epoch 5949 
Prediction Loss: 0.583779
Epoch 5999 
Prediction Loss: 0.527364
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.710845
Insample Error 3.609101
Ours, Train RMSE
0.6872, 
0.6894, 
0.6900, 
0.6856, 
0.6789, 
0.6899, 
0.6917, 
0.6872, 
0.6859, 
0.6944, 
CEVAE, Train RMSE
0.6727, 
0.6623, 
0.6600, 
0.6431, 
0.6442, 
0.6593, 
0.6521, 
0.6626, 
0.6606, 
0.6552, 
Ours, Insample RMSE
1.8812, 
1.9056, 
1.8635, 
1.8436, 
1.8199, 
1.8471, 
1.9018, 
2.0644, 
1.8479, 
1.9336, 
CEVAE, Insample RMSE
2.6038, 
2.4825, 
2.5462, 
2.4817, 
2.5046, 
2.5506, 
2.6480, 
2.4665, 
2.6290, 
2.4904, 
Direct Regression, Insample RMSE
3.5732, 
3.6093, 
3.6059, 
3.6439, 
3.6435, 
3.6059, 
3.5337, 
3.5014, 
3.5107, 
3.6091, 
Train, RMSE mean 0.6880 std 0.0040
CEVAE, RMSE mean 0.6572 std 0.0085
Ours, RMSE mean 1.8909 std 0.0664, reconstruct confounder 1.4663 (0.0095) noise 9.9011 (0.0113)
CEVAE, RMSE mean 2.5403 std 0.0630, reconstruct confounder 1.8462 (0.0498) noise 1.9997 (0.0035)
Direct Regression, RMSE mean 3.5837 std 0.0492
