Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=5, mask=0, nlayer=50, obsm=3, stop=5000, ycof=0.5, ylayer=50)
Y Mean 0.772934, Std 2.409118 
Test Y Mean -0.016149, Std 2.420079 
Observe confounder 3, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.424282
Rec Loss: 10.640564
KL Loss: 0.783718
Y Loss: 0.549891
T Loss: 10.365618
Epoch 99 
Overall Loss: 11.332384
Rec Loss: 10.590347
KL Loss: 0.742037
Y Loss: 0.457987
T Loss: 10.361354
Epoch 149 
Overall Loss: 11.236118
Rec Loss: 10.330891
KL Loss: 0.905228
Y Loss: 0.418893
T Loss: 10.121444
Epoch 199 
Overall Loss: 11.231968
Rec Loss: 10.301448
KL Loss: 0.930519
Y Loss: 0.407240
T Loss: 10.097828
Epoch 249 
Overall Loss: 11.201739
Rec Loss: 10.263783
KL Loss: 0.937956
Y Loss: 0.397023
T Loss: 10.065272
Epoch 299 
Overall Loss: 11.199632
Rec Loss: 10.288430
KL Loss: 0.911201
Y Loss: 0.391289
T Loss: 10.092786
Epoch 349 
Overall Loss: 11.186925
Rec Loss: 10.232182
KL Loss: 0.954743
Y Loss: 0.387905
T Loss: 10.038229
Epoch 399 
Overall Loss: 11.180731
Rec Loss: 10.269792
KL Loss: 0.910939
Y Loss: 0.387926
T Loss: 10.075829
Epoch 449 
Overall Loss: 11.185072
Rec Loss: 10.261003
KL Loss: 0.924069
Y Loss: 0.389452
T Loss: 10.066277
Epoch 499 
Overall Loss: 11.165243
Rec Loss: 10.247830
KL Loss: 0.917413
Y Loss: 0.383812
T Loss: 10.055924
Epoch 549 
Overall Loss: 11.172888
Rec Loss: 10.262395
KL Loss: 0.910492
Y Loss: 0.383513
T Loss: 10.070639
Epoch 599 
Overall Loss: 11.169713
Rec Loss: 10.230791
KL Loss: 0.938922
Y Loss: 0.372485
T Loss: 10.044549
Epoch 649 
Overall Loss: 11.170837
Rec Loss: 10.236752
KL Loss: 0.934085
Y Loss: 0.372015
T Loss: 10.050744
Epoch 699 
Overall Loss: 11.143600
Rec Loss: 10.227481
KL Loss: 0.916119
Y Loss: 0.368936
T Loss: 10.043013
Epoch 749 
Overall Loss: 11.151994
Rec Loss: 10.237160
KL Loss: 0.914834
Y Loss: 0.366555
T Loss: 10.053883
Epoch 799 
Overall Loss: 11.138097
Rec Loss: 10.218375
KL Loss: 0.919722
Y Loss: 0.367222
T Loss: 10.034764
Epoch 849 
Overall Loss: 11.145936
Rec Loss: 10.223048
KL Loss: 0.922888
Y Loss: 0.368810
T Loss: 10.038643
Epoch 899 
Overall Loss: 11.139612
Rec Loss: 10.220156
KL Loss: 0.919456
Y Loss: 0.366984
T Loss: 10.036664
Epoch 949 
Overall Loss: 11.137527
Rec Loss: 10.208062
KL Loss: 0.929465
Y Loss: 0.368049
T Loss: 10.024038
Epoch 999 
Overall Loss: 11.130472
Rec Loss: 10.198867
KL Loss: 0.931605
Y Loss: 0.364487
T Loss: 10.016623
Epoch 1049 
Overall Loss: 11.139058
Rec Loss: 10.205858
KL Loss: 0.933201
Y Loss: 0.361665
T Loss: 10.025025
Epoch 1099 
Overall Loss: 11.124429
Rec Loss: 10.195905
KL Loss: 0.928524
Y Loss: 0.359651
T Loss: 10.016080
Epoch 1149 
Overall Loss: 11.141997
Rec Loss: 10.202260
KL Loss: 0.939737
Y Loss: 0.362094
T Loss: 10.021213
Epoch 1199 
Overall Loss: 11.110688
Rec Loss: 10.187216
KL Loss: 0.923472
Y Loss: 0.360458
T Loss: 10.006987
Epoch 1249 
Overall Loss: 11.121574
Rec Loss: 10.188126
KL Loss: 0.933448
Y Loss: 0.364645
T Loss: 10.005803
Epoch 1299 
Overall Loss: 11.111440
Rec Loss: 10.174602
KL Loss: 0.936838
Y Loss: 0.356001
T Loss: 9.996601
Epoch 1349 
Overall Loss: 11.120070
Rec Loss: 10.177969
KL Loss: 0.942101
Y Loss: 0.362636
T Loss: 9.996651
Epoch 1399 
Overall Loss: 11.103143
Rec Loss: 10.178620
KL Loss: 0.924522
Y Loss: 0.353971
T Loss: 10.001635
Epoch 1449 
Overall Loss: 11.108781
Rec Loss: 10.182982
KL Loss: 0.925799
Y Loss: 0.356865
T Loss: 10.004549
Epoch 1499 
Overall Loss: 11.079958
Rec Loss: 10.157809
KL Loss: 0.922149
Y Loss: 0.352236
T Loss: 9.981691
Epoch 1549 
Overall Loss: 11.087707
Rec Loss: 10.161811
KL Loss: 0.925896
Y Loss: 0.355335
T Loss: 9.984144
Epoch 1599 
Overall Loss: 11.090756
Rec Loss: 10.166902
KL Loss: 0.923854
Y Loss: 0.351718
T Loss: 9.991043
Epoch 1649 
Overall Loss: 11.096436
Rec Loss: 10.150737
KL Loss: 0.945699
Y Loss: 0.352075
T Loss: 9.974700
Epoch 1699 
Overall Loss: 11.081759
Rec Loss: 10.163847
KL Loss: 0.917913
Y Loss: 0.350032
T Loss: 9.988830
Epoch 1749 
Overall Loss: 11.111990
Rec Loss: 10.150792
KL Loss: 0.961199
Y Loss: 0.347531
T Loss: 9.977025
Epoch 1799 
Overall Loss: 11.069898
Rec Loss: 10.146819
KL Loss: 0.923079
Y Loss: 0.345788
T Loss: 9.973925
Epoch 1849 
Overall Loss: 11.068836
Rec Loss: 10.146963
KL Loss: 0.921873
Y Loss: 0.350041
T Loss: 9.971943
Epoch 1899 
Overall Loss: 11.072157
Rec Loss: 10.135281
KL Loss: 0.936876
Y Loss: 0.343874
T Loss: 9.963344
Epoch 1949 
Overall Loss: 11.084274
Rec Loss: 10.138948
KL Loss: 0.945327
Y Loss: 0.348764
T Loss: 9.964566
Epoch 1999 
Overall Loss: 11.083775
Rec Loss: 10.152762
KL Loss: 0.931012
Y Loss: 0.350101
T Loss: 9.977712
Epoch 2049 
Overall Loss: 11.050269
Rec Loss: 10.127133
KL Loss: 0.923136
Y Loss: 0.341410
T Loss: 9.956428
Epoch 2099 
Overall Loss: 11.057481
Rec Loss: 10.143019
KL Loss: 0.914461
Y Loss: 0.341035
T Loss: 9.972502
Epoch 2149 
Overall Loss: 11.076979
Rec Loss: 10.136667
KL Loss: 0.940313
Y Loss: 0.339167
T Loss: 9.967083
Epoch 2199 
Overall Loss: 11.046123
Rec Loss: 10.115877
KL Loss: 0.930246
Y Loss: 0.338098
T Loss: 9.946828
Epoch 2249 
Overall Loss: 11.058344
Rec Loss: 10.127501
KL Loss: 0.930843
Y Loss: 0.336173
T Loss: 9.959414
Epoch 2299 
Overall Loss: 11.054396
Rec Loss: 10.125159
KL Loss: 0.929237
Y Loss: 0.340081
T Loss: 9.955119
Epoch 2349 
Overall Loss: 11.061602
Rec Loss: 10.123378
KL Loss: 0.938224
Y Loss: 0.344012
T Loss: 9.951371
Epoch 2399 
Overall Loss: 11.066004
Rec Loss: 10.104992
KL Loss: 0.961011
Y Loss: 0.336389
T Loss: 9.936798
Epoch 2449 
Overall Loss: 11.050885
Rec Loss: 10.099550
KL Loss: 0.951334
Y Loss: 0.337993
T Loss: 9.930554
Epoch 2499 
Overall Loss: 11.037653
Rec Loss: 10.105998
KL Loss: 0.931655
Y Loss: 0.339323
T Loss: 9.936337
Epoch 2549 
Overall Loss: 11.048304
Rec Loss: 10.112974
KL Loss: 0.935330
Y Loss: 0.338650
T Loss: 9.943650
Epoch 2599 
Overall Loss: 11.037156
Rec Loss: 10.104148
KL Loss: 0.933008
Y Loss: 0.335381
T Loss: 9.936458
Epoch 2649 
Overall Loss: 11.034114
Rec Loss: 10.099661
KL Loss: 0.934453
Y Loss: 0.330943
T Loss: 9.934189
Epoch 2699 
Overall Loss: 11.034977
Rec Loss: 10.087626
KL Loss: 0.947351
Y Loss: 0.333157
T Loss: 9.921048
Epoch 2749 
Overall Loss: 11.047922
Rec Loss: 10.099632
KL Loss: 0.948290
Y Loss: 0.329319
T Loss: 9.934972
Epoch 2799 
Overall Loss: 11.034496
Rec Loss: 10.084495
KL Loss: 0.950001
Y Loss: 0.336661
T Loss: 9.916165
Epoch 2849 
Overall Loss: 11.037550
Rec Loss: 10.091783
KL Loss: 0.945767
Y Loss: 0.328574
T Loss: 9.927496
Epoch 2899 
Overall Loss: 11.016766
Rec Loss: 10.070062
KL Loss: 0.946704
Y Loss: 0.331042
T Loss: 9.904541
Epoch 2949 
Overall Loss: 11.028646
Rec Loss: 10.087075
KL Loss: 0.941571
Y Loss: 0.337583
T Loss: 9.918283
Epoch 2999 
Overall Loss: 11.007044
Rec Loss: 10.084381
KL Loss: 0.922664
Y Loss: 0.331901
T Loss: 9.918430
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.178713
Epoch 99
Rec Loss: 1.164090
Epoch 149
Rec Loss: 1.164922
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.843668
Epoch 99
Rec Loss: 9.826119
Epoch 149
Rec Loss: 9.826203
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.560590
Insample Error: 1.236284
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 17.752985
Rec Loss: 15.563899
KL Loss: 2.189086
Y Loss: 2.075016
T Loss: 12.959649
X Loss: 1.566742
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.574761
Epoch 99
Rec Loss: 3.570308
Epoch 149
Rec Loss: 3.564707
Epoch 199
Rec Loss: 3.568536
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.712251
Epoch 99
Rec Loss: 2.678266
Epoch 149
Rec Loss: 2.662051
Epoch 199
Rec Loss: 2.716801
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 1.148024
Insample Error 1.916062
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.411743
Epoch 99 
Prediction Loss: 0.387311
Epoch 149 
Prediction Loss: 0.366871
Epoch 199 
Prediction Loss: 0.368698
Epoch 249 
Prediction Loss: 0.349327
Epoch 299 
Prediction Loss: 0.339472
Epoch 349 
Prediction Loss: 0.352339
Epoch 399 
Prediction Loss: 0.326997
Epoch 449 
Prediction Loss: 0.334014
Epoch 499 
Prediction Loss: 0.313720
Epoch 549 
Prediction Loss: 0.305340
Epoch 599 
Prediction Loss: 0.303593
Epoch 649 
Prediction Loss: 0.286239
Epoch 699 
Prediction Loss: 0.282975
Epoch 749 
Prediction Loss: 0.281110
Epoch 799 
Prediction Loss: 0.271487
Epoch 849 
Prediction Loss: 0.273246
Epoch 899 
Prediction Loss: 0.262854
Epoch 949 
Prediction Loss: 0.257090
Epoch 999 
Prediction Loss: 0.246214
Epoch 1049 
Prediction Loss: 0.245543
Epoch 1099 
Prediction Loss: 0.243064
Epoch 1149 
Prediction Loss: 0.236860
Epoch 1199 
Prediction Loss: 0.220400
Epoch 1249 
Prediction Loss: 0.214929
Epoch 1299 
Prediction Loss: 0.212715
Epoch 1349 
Prediction Loss: 0.205872
Epoch 1399 
Prediction Loss: 0.209049
Epoch 1449 
Prediction Loss: 0.198799
Epoch 1499 
Prediction Loss: 0.190946
Epoch 1549 
Prediction Loss: 0.187351
Epoch 1599 
Prediction Loss: 0.196184
Epoch 1649 
Prediction Loss: 0.188867
Epoch 1699 
Prediction Loss: 0.184785
Epoch 1749 
Prediction Loss: 0.179712
Epoch 1799 
Prediction Loss: 0.179699
Epoch 1849 
Prediction Loss: 0.173956
Epoch 1899 
Prediction Loss: 0.173041
Epoch 1949 
Prediction Loss: 0.172402
Epoch 1999 
Prediction Loss: 0.169268
Epoch 2049 
Prediction Loss: 0.163349
Epoch 2099 
Prediction Loss: 0.161239
Epoch 2149 
Prediction Loss: 0.160609
Epoch 2199 
Prediction Loss: 0.163087
Epoch 2249 
Prediction Loss: 0.158188
Epoch 2299 
Prediction Loss: 0.162527
Epoch 2349 
Prediction Loss: 0.154518
Epoch 2399 
Prediction Loss: 0.153267
Epoch 2449 
Prediction Loss: 0.158922
Epoch 2499 
Prediction Loss: 0.152006
Epoch 2549 
Prediction Loss: 0.150458
Epoch 2599 
Prediction Loss: 0.155759
Epoch 2649 
Prediction Loss: 0.146183
Epoch 2699 
Prediction Loss: 0.147863
Epoch 2749 
Prediction Loss: 0.149401
Epoch 2799 
Prediction Loss: 0.153240
Epoch 2849 
Prediction Loss: 0.147499
Epoch 2899 
Prediction Loss: 0.148376
Epoch 2949 
Prediction Loss: 0.145231
Epoch 2999 
Prediction Loss: 0.156784
Epoch 3049 
Prediction Loss: 0.145259
Epoch 3099 
Prediction Loss: 0.146446
Epoch 3149 
Prediction Loss: 0.140029
Epoch 3199 
Prediction Loss: 0.140039
Epoch 3249 
Prediction Loss: 0.136168
Epoch 3299 
Prediction Loss: 0.135537
Epoch 3349 
Prediction Loss: 0.136081
Epoch 3399 
Prediction Loss: 0.134189
Epoch 3449 
Prediction Loss: 0.134196
Epoch 3499 
Prediction Loss: 0.134638
Epoch 3549 
Prediction Loss: 0.134204
Epoch 3599 
Prediction Loss: 0.131738
Epoch 3649 
Prediction Loss: 0.130645
Epoch 3699 
Prediction Loss: 0.132817
Epoch 3749 
Prediction Loss: 0.128351
Epoch 3799 
Prediction Loss: 0.130277
Epoch 3849 
Prediction Loss: 0.137512
Epoch 3899 
Prediction Loss: 0.136352
Epoch 3949 
Prediction Loss: 0.130881
Epoch 3999 
Prediction Loss: 0.134401
Epoch 4049 
Prediction Loss: 0.129757
Epoch 4099 
Prediction Loss: 0.131789
Epoch 4149 
Prediction Loss: 0.126374
Epoch 4199 
Prediction Loss: 0.126724
Epoch 4249 
Prediction Loss: 0.122811
Epoch 4299 
Prediction Loss: 0.126472
Epoch 4349 
Prediction Loss: 0.122860
Epoch 4399 
Prediction Loss: 0.122657
Epoch 4449 
Prediction Loss: 0.124604
Epoch 4499 
Prediction Loss: 0.122090
Epoch 4549 
Prediction Loss: 0.126463
Epoch 4599 
Prediction Loss: 0.121060
Epoch 4649 
Prediction Loss: 0.122596
Epoch 4699 
Prediction Loss: 0.126482
Epoch 4749 
Prediction Loss: 0.119843
Epoch 4799 
Prediction Loss: 0.120187
Epoch 4849 
Prediction Loss: 0.125910
Epoch 4899 
Prediction Loss: 0.135462
Epoch 4949 
Prediction Loss: 0.119533
Epoch 4999 
Prediction Loss: 0.122584
Epoch 5049 
Prediction Loss: 0.122195
Epoch 5099 
Prediction Loss: 0.123212
Epoch 5149 
Prediction Loss: 0.125604
Epoch 5199 
Prediction Loss: 0.128277
Epoch 5249 
Prediction Loss: 0.119614
Epoch 5299 
Prediction Loss: 0.116565
Epoch 5349 
Prediction Loss: 0.120916
Epoch 5399 
Prediction Loss: 0.120041
Epoch 5449 
Prediction Loss: 0.115949
Epoch 5499 
Prediction Loss: 0.122153
Epoch 5549 
Prediction Loss: 0.119673
Epoch 5599 
Prediction Loss: 0.121973
Epoch 5649 
Prediction Loss: 0.128061
Epoch 5699 
Prediction Loss: 0.126281
Epoch 5749 
Prediction Loss: 0.118441
Epoch 5799 
Prediction Loss: 0.118112
Epoch 5849 
Prediction Loss: 0.114733
Epoch 5899 
Prediction Loss: 0.121414
Epoch 5949 
Prediction Loss: 0.117604
Epoch 5999 
Prediction Loss: 0.116749
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.334461
Insample Error 1.455179
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.416294
Rec Loss: 10.643941
KL Loss: 0.772353
Y Loss: 0.549566
T Loss: 10.369158
Epoch 99 
Overall Loss: 11.298686
Rec Loss: 10.445489
KL Loss: 0.853197
Y Loss: 0.465999
T Loss: 10.212490
Epoch 149 
Overall Loss: 11.257331
Rec Loss: 10.334580
KL Loss: 0.922751
Y Loss: 0.416381
T Loss: 10.126390
Epoch 199 
Overall Loss: 11.205726
Rec Loss: 10.280027
KL Loss: 0.925699
Y Loss: 0.405460
T Loss: 10.077297
Epoch 249 
Overall Loss: 11.237415
Rec Loss: 10.284029
KL Loss: 0.953386
Y Loss: 0.398642
T Loss: 10.084708
Epoch 299 
Overall Loss: 11.208175
Rec Loss: 10.280585
KL Loss: 0.927590
Y Loss: 0.393478
T Loss: 10.083846
Epoch 349 
Overall Loss: 11.198086
Rec Loss: 10.264708
KL Loss: 0.933378
Y Loss: 0.385887
T Loss: 10.071764
Epoch 399 
Overall Loss: 11.167625
Rec Loss: 10.246348
KL Loss: 0.921276
Y Loss: 0.384929
T Loss: 10.053884
Epoch 449 
Overall Loss: 11.175858
Rec Loss: 10.258386
KL Loss: 0.917472
Y Loss: 0.380909
T Loss: 10.067931
Epoch 499 
Overall Loss: 11.181210
Rec Loss: 10.247277
KL Loss: 0.933932
Y Loss: 0.382470
T Loss: 10.056042
Epoch 549 
Overall Loss: 11.164432
Rec Loss: 10.245257
KL Loss: 0.919175
Y Loss: 0.374471
T Loss: 10.058022
Epoch 599 
Overall Loss: 11.143862
Rec Loss: 10.215975
KL Loss: 0.927887
Y Loss: 0.379936
T Loss: 10.026007
Epoch 649 
Overall Loss: 11.166361
Rec Loss: 10.227160
KL Loss: 0.939202
Y Loss: 0.376885
T Loss: 10.038717
Epoch 699 
Overall Loss: 11.139883
Rec Loss: 10.218407
KL Loss: 0.921477
Y Loss: 0.370761
T Loss: 10.033026
Epoch 749 
Overall Loss: 11.160863
Rec Loss: 10.220864
KL Loss: 0.939999
Y Loss: 0.372327
T Loss: 10.034701
Epoch 799 
Overall Loss: 11.160494
Rec Loss: 10.240680
KL Loss: 0.919814
Y Loss: 0.365987
T Loss: 10.057687
Epoch 849 
Overall Loss: 11.139286
Rec Loss: 10.221176
KL Loss: 0.918110
Y Loss: 0.369060
T Loss: 10.036646
Epoch 899 
Overall Loss: 11.137015
Rec Loss: 10.218655
KL Loss: 0.918360
Y Loss: 0.370581
T Loss: 10.033365
Epoch 949 
Overall Loss: 11.129374
Rec Loss: 10.185721
KL Loss: 0.943653
Y Loss: 0.368566
T Loss: 10.001438
Epoch 999 
Overall Loss: 11.144755
Rec Loss: 10.215431
KL Loss: 0.929324
Y Loss: 0.365129
T Loss: 10.032867
Epoch 1049 
Overall Loss: 11.133007
Rec Loss: 10.212114
KL Loss: 0.920893
Y Loss: 0.362325
T Loss: 10.030952
Epoch 1099 
Overall Loss: 11.126909
Rec Loss: 10.184496
KL Loss: 0.942413
Y Loss: 0.361472
T Loss: 10.003760
Epoch 1149 
Overall Loss: 11.108434
Rec Loss: 10.183246
KL Loss: 0.925188
Y Loss: 0.364007
T Loss: 10.001243
Epoch 1199 
Overall Loss: 11.112478
Rec Loss: 10.165263
KL Loss: 0.947215
Y Loss: 0.361707
T Loss: 9.984410
Epoch 1249 
Overall Loss: 11.126152
Rec Loss: 10.178130
KL Loss: 0.948021
Y Loss: 0.360119
T Loss: 9.998071
Epoch 1299 
Overall Loss: 11.104940
Rec Loss: 10.180944
KL Loss: 0.923996
Y Loss: 0.357945
T Loss: 10.001972
Epoch 1349 
Overall Loss: 11.112508
Rec Loss: 10.188382
KL Loss: 0.924126
Y Loss: 0.368312
T Loss: 10.004226
Epoch 1399 
Overall Loss: 11.116287
Rec Loss: 10.163141
KL Loss: 0.953147
Y Loss: 0.360281
T Loss: 9.983000
Epoch 1449 
Overall Loss: 11.091786
Rec Loss: 10.172656
KL Loss: 0.919130
Y Loss: 0.353736
T Loss: 9.995788
Epoch 1499 
Overall Loss: 11.107294
Rec Loss: 10.156003
KL Loss: 0.951291
Y Loss: 0.364275
T Loss: 9.973866
Epoch 1549 
Overall Loss: 11.099346
Rec Loss: 10.166386
KL Loss: 0.932961
Y Loss: 0.355707
T Loss: 9.988532
Epoch 1599 
Overall Loss: 11.088534
Rec Loss: 10.149486
KL Loss: 0.939049
Y Loss: 0.355601
T Loss: 9.971685
Epoch 1649 
Overall Loss: 11.101879
Rec Loss: 10.172669
KL Loss: 0.929210
Y Loss: 0.359549
T Loss: 9.992894
Epoch 1699 
Overall Loss: 11.095358
Rec Loss: 10.166992
KL Loss: 0.928366
Y Loss: 0.354809
T Loss: 9.989587
Epoch 1749 
Overall Loss: 11.089961
Rec Loss: 10.155668
KL Loss: 0.934294
Y Loss: 0.354352
T Loss: 9.978492
Epoch 1799 
Overall Loss: 11.083945
Rec Loss: 10.144972
KL Loss: 0.938973
Y Loss: 0.352750
T Loss: 9.968597
Epoch 1849 
Overall Loss: 11.076112
Rec Loss: 10.155202
KL Loss: 0.920910
Y Loss: 0.357426
T Loss: 9.976489
Epoch 1899 
Overall Loss: 11.087196
Rec Loss: 10.142738
KL Loss: 0.944458
Y Loss: 0.351725
T Loss: 9.966875
Epoch 1949 
Overall Loss: 11.076816
Rec Loss: 10.131211
KL Loss: 0.945606
Y Loss: 0.355595
T Loss: 9.953413
Epoch 1999 
Overall Loss: 11.072978
Rec Loss: 10.141155
KL Loss: 0.931823
Y Loss: 0.351379
T Loss: 9.965465
Epoch 2049 
Overall Loss: 11.067540
Rec Loss: 10.126938
KL Loss: 0.940602
Y Loss: 0.355162
T Loss: 9.949357
Epoch 2099 
Overall Loss: 11.071210
Rec Loss: 10.141364
KL Loss: 0.929847
Y Loss: 0.351838
T Loss: 9.965444
Epoch 2149 
Overall Loss: 11.072172
Rec Loss: 10.114422
KL Loss: 0.957751
Y Loss: 0.345526
T Loss: 9.941658
Epoch 2199 
Overall Loss: 11.067819
Rec Loss: 10.118859
KL Loss: 0.948961
Y Loss: 0.350688
T Loss: 9.943514
Epoch 2249 
Overall Loss: 11.048395
Rec Loss: 10.112942
KL Loss: 0.935453
Y Loss: 0.345227
T Loss: 9.940329
Epoch 2299 
Overall Loss: 11.059347
Rec Loss: 10.120891
KL Loss: 0.938457
Y Loss: 0.352356
T Loss: 9.944713
Epoch 2349 
Overall Loss: 11.047042
Rec Loss: 10.121371
KL Loss: 0.925670
Y Loss: 0.345929
T Loss: 9.948407
Epoch 2399 
Overall Loss: 11.058827
Rec Loss: 10.136505
KL Loss: 0.922323
Y Loss: 0.359170
T Loss: 9.956920
Epoch 2449 
Overall Loss: 11.053577
Rec Loss: 10.105592
KL Loss: 0.947985
Y Loss: 0.347953
T Loss: 9.931616
Epoch 2499 
Overall Loss: 11.056377
Rec Loss: 10.114490
KL Loss: 0.941887
Y Loss: 0.344507
T Loss: 9.942237
Epoch 2549 
Overall Loss: 11.038566
Rec Loss: 10.106911
KL Loss: 0.931655
Y Loss: 0.345968
T Loss: 9.933927
Epoch 2599 
Overall Loss: 11.040277
Rec Loss: 10.102197
KL Loss: 0.938079
Y Loss: 0.343003
T Loss: 9.930695
Epoch 2649 
Overall Loss: 11.043930
Rec Loss: 10.105521
KL Loss: 0.938409
Y Loss: 0.346990
T Loss: 9.932027
Epoch 2699 
Overall Loss: 11.034675
Rec Loss: 10.093316
KL Loss: 0.941359
Y Loss: 0.345787
T Loss: 9.920423
Epoch 2749 
Overall Loss: 11.036474
Rec Loss: 10.104248
KL Loss: 0.932226
Y Loss: 0.343654
T Loss: 9.932421
Epoch 2799 
Overall Loss: 11.025648
Rec Loss: 10.082633
KL Loss: 0.943015
Y Loss: 0.340362
T Loss: 9.912452
Epoch 2849 
Overall Loss: 11.053000
Rec Loss: 10.092616
KL Loss: 0.960384
Y Loss: 0.338645
T Loss: 9.923294
Epoch 2899 
Overall Loss: 11.039530
Rec Loss: 10.089095
KL Loss: 0.950435
Y Loss: 0.340729
T Loss: 9.918730
Epoch 2949 
Overall Loss: 11.030693
Rec Loss: 10.094257
KL Loss: 0.936436
Y Loss: 0.340385
T Loss: 9.924065
Epoch 2999 
Overall Loss: 11.003039
Rec Loss: 10.074805
KL Loss: 0.928234
Y Loss: 0.338965
T Loss: 9.905322
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.189442
Epoch 99
Rec Loss: 1.169514
Epoch 149
Rec Loss: 1.165085
Epoch 199
Rec Loss: 1.164311
Epoch 249
Rec Loss: 1.159502
Epoch 299
Rec Loss: 1.171099
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.838162
Epoch 99
Rec Loss: 9.804271
Epoch 149
Rec Loss: 9.790995
Epoch 199
Rec Loss: 9.807207
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.568164
Insample Error: 1.267983
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 18.218778
Rec Loss: 16.180420
KL Loss: 2.038357
Y Loss: 1.828501
T Loss: 13.055899
X Loss: 2.210270
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.650494
Epoch 99
Rec Loss: 3.648654
Epoch 149
Rec Loss: 3.644710
Epoch 199
Rec Loss: 3.651957
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 3.272103
Epoch 99
Rec Loss: 3.249867
Epoch 149
Rec Loss: 3.216347
Epoch 199
Rec Loss: 3.229084
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 1.028546
Insample Error 1.767747
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.403996
Epoch 99 
Prediction Loss: 0.374112
Epoch 149 
Prediction Loss: 0.364155
Epoch 199 
Prediction Loss: 0.347283
Epoch 249 
Prediction Loss: 0.341826
Epoch 299 
Prediction Loss: 0.333279
Epoch 349 
Prediction Loss: 0.325613
Epoch 399 
Prediction Loss: 0.323358
Epoch 449 
Prediction Loss: 0.308030
Epoch 499 
Prediction Loss: 0.295885
Epoch 549 
Prediction Loss: 0.299086
Epoch 599 
Prediction Loss: 0.276965
Epoch 649 
Prediction Loss: 0.276036
Epoch 699 
Prediction Loss: 0.263415
Epoch 749 
Prediction Loss: 0.247350
Epoch 799 
Prediction Loss: 0.246376
Epoch 849 
Prediction Loss: 0.237572
Epoch 899 
Prediction Loss: 0.228436
Epoch 949 
Prediction Loss: 0.218570
Epoch 999 
Prediction Loss: 0.222582
Epoch 1049 
Prediction Loss: 0.205111
Epoch 1099 
Prediction Loss: 0.203844
Epoch 1149 
Prediction Loss: 0.194010
Epoch 1199 
Prediction Loss: 0.192591
Epoch 1249 
Prediction Loss: 0.198096
Epoch 1299 
Prediction Loss: 0.192801
Epoch 1349 
Prediction Loss: 0.182511
Epoch 1399 
Prediction Loss: 0.181989
Epoch 1449 
Prediction Loss: 0.174723
Epoch 1499 
Prediction Loss: 0.168036
Epoch 1549 
Prediction Loss: 0.165902
Epoch 1599 
Prediction Loss: 0.162194
Epoch 1649 
Prediction Loss: 0.160386
Epoch 1699 
Prediction Loss: 0.163297
Epoch 1749 
Prediction Loss: 0.162269
Epoch 1799 
Prediction Loss: 0.156557
Epoch 1849 
Prediction Loss: 0.149085
Epoch 1899 
Prediction Loss: 0.147990
Epoch 1949 
Prediction Loss: 0.146469
Epoch 1999 
Prediction Loss: 0.145893
Epoch 2049 
Prediction Loss: 0.143307
Epoch 2099 
Prediction Loss: 0.146019
Epoch 2149 
Prediction Loss: 0.145683
Epoch 2199 
Prediction Loss: 0.143400
Epoch 2249 
Prediction Loss: 0.137035
Epoch 2299 
Prediction Loss: 0.137349
Epoch 2349 
Prediction Loss: 0.138447
Epoch 2399 
Prediction Loss: 0.139518
Epoch 2449 
Prediction Loss: 0.135791
Epoch 2499 
Prediction Loss: 0.134851
Epoch 2549 
Prediction Loss: 0.135223
Epoch 2599 
Prediction Loss: 0.134045
Epoch 2649 
Prediction Loss: 0.138854
Epoch 2699 
Prediction Loss: 0.131405
Epoch 2749 
Prediction Loss: 0.128703
Epoch 2799 
Prediction Loss: 0.126475
Epoch 2849 
Prediction Loss: 0.126696
Epoch 2899 
Prediction Loss: 0.128618
Epoch 2949 
Prediction Loss: 0.125316
Epoch 2999 
Prediction Loss: 0.128650
Epoch 3049 
Prediction Loss: 0.124652
Epoch 3099 
Prediction Loss: 0.122892
Epoch 3149 
Prediction Loss: 0.122712
Epoch 3199 
Prediction Loss: 0.127510
Epoch 3249 
Prediction Loss: 0.125666
Epoch 3299 
Prediction Loss: 0.122825
Epoch 3349 
Prediction Loss: 0.136501
Epoch 3399 
Prediction Loss: 0.119753
Epoch 3449 
Prediction Loss: 0.124865
Epoch 3499 
Prediction Loss: 0.130177
Epoch 3549 
Prediction Loss: 0.127182
Epoch 3599 
Prediction Loss: 0.122736
Epoch 3649 
Prediction Loss: 0.119576
Epoch 3699 
Prediction Loss: 0.116866
Epoch 3749 
Prediction Loss: 0.120719
Epoch 3799 
Prediction Loss: 0.117957
Epoch 3849 
Prediction Loss: 0.118763
Epoch 3899 
Prediction Loss: 0.113507
Epoch 3949 
Prediction Loss: 0.116843
Epoch 3999 
Prediction Loss: 0.114430
Epoch 4049 
Prediction Loss: 0.120056
Epoch 4099 
Prediction Loss: 0.118943
Epoch 4149 
Prediction Loss: 0.117807
Epoch 4199 
Prediction Loss: 0.115040
Epoch 4249 
Prediction Loss: 0.120104
Epoch 4299 
Prediction Loss: 0.116746
Epoch 4349 
Prediction Loss: 0.113725
Epoch 4399 
Prediction Loss: 0.114840
Epoch 4449 
Prediction Loss: 0.120843
Epoch 4499 
Prediction Loss: 0.113014
Epoch 4549 
Prediction Loss: 0.119744
Epoch 4599 
Prediction Loss: 0.117317
Epoch 4649 
Prediction Loss: 0.112799
Epoch 4699 
Prediction Loss: 0.110833
Epoch 4749 
Prediction Loss: 0.110131
Epoch 4799 
Prediction Loss: 0.114705
Epoch 4849 
Prediction Loss: 0.115735
Epoch 4899 
Prediction Loss: 0.110265
Epoch 4949 
Prediction Loss: 0.114379
Epoch 4999 
Prediction Loss: 0.112929
Epoch 5049 
Prediction Loss: 0.114466
Epoch 5099 
Prediction Loss: 0.107315
Epoch 5149 
Prediction Loss: 0.109319
Epoch 5199 
Prediction Loss: 0.113857
Epoch 5249 
Prediction Loss: 0.111339
Epoch 5299 
Prediction Loss: 0.109318
Epoch 5349 
Prediction Loss: 0.105135
Epoch 5399 
Prediction Loss: 0.110255
Epoch 5449 
Prediction Loss: 0.105765
Epoch 5499 
Prediction Loss: 0.110233
Epoch 5549 
Prediction Loss: 0.110199
Epoch 5599 
Prediction Loss: 0.109124
Epoch 5649 
Prediction Loss: 0.108621
Epoch 5699 
Prediction Loss: 0.106611
Epoch 5749 
Prediction Loss: 0.106816
Epoch 5799 
Prediction Loss: 0.108765
Epoch 5849 
Prediction Loss: 0.109034
Epoch 5899 
Prediction Loss: 0.106965
Epoch 5949 
Prediction Loss: 0.107068
Epoch 5999 
Prediction Loss: 0.103434
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.320590
Insample Error 1.477314
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.504455
Rec Loss: 10.751915
KL Loss: 0.752540
Y Loss: 0.534653
T Loss: 10.484589
Epoch 99 
Overall Loss: 11.324904
Rec Loss: 10.587647
KL Loss: 0.737256
Y Loss: 0.448090
T Loss: 10.363602
Epoch 149 
Overall Loss: 11.302084
Rec Loss: 10.512887
KL Loss: 0.789196
Y Loss: 0.424956
T Loss: 10.300409
Epoch 199 
Overall Loss: 11.244405
Rec Loss: 10.319380
KL Loss: 0.925024
Y Loss: 0.404507
T Loss: 10.117126
Epoch 249 
Overall Loss: 11.212166
Rec Loss: 10.275913
KL Loss: 0.936253
Y Loss: 0.395108
T Loss: 10.078359
Epoch 299 
Overall Loss: 11.229541
Rec Loss: 10.287384
KL Loss: 0.942157
Y Loss: 0.392914
T Loss: 10.090927
Epoch 349 
Overall Loss: 11.206191
Rec Loss: 10.260423
KL Loss: 0.945768
Y Loss: 0.386329
T Loss: 10.067259
Epoch 399 
Overall Loss: 11.184479
Rec Loss: 10.252294
KL Loss: 0.932185
Y Loss: 0.382671
T Loss: 10.060959
Epoch 449 
Overall Loss: 11.175699
Rec Loss: 10.257378
KL Loss: 0.918321
Y Loss: 0.380081
T Loss: 10.067338
Epoch 499 
Overall Loss: 11.184159
Rec Loss: 10.258403
KL Loss: 0.925755
Y Loss: 0.374720
T Loss: 10.071043
Epoch 549 
Overall Loss: 11.173150
Rec Loss: 10.251183
KL Loss: 0.921967
Y Loss: 0.378987
T Loss: 10.061690
Epoch 599 
Overall Loss: 11.169267
Rec Loss: 10.244155
KL Loss: 0.925113
Y Loss: 0.363603
T Loss: 10.062353
Epoch 649 
Overall Loss: 11.173043
Rec Loss: 10.234470
KL Loss: 0.938573
Y Loss: 0.367365
T Loss: 10.050787
Epoch 699 
Overall Loss: 11.164827
Rec Loss: 10.209526
KL Loss: 0.955300
Y Loss: 0.362527
T Loss: 10.028263
Epoch 749 
Overall Loss: 11.159570
Rec Loss: 10.227176
KL Loss: 0.932394
Y Loss: 0.363906
T Loss: 10.045223
Epoch 799 
Overall Loss: 11.152632
Rec Loss: 10.220418
KL Loss: 0.932213
Y Loss: 0.360796
T Loss: 10.040021
Epoch 849 
Overall Loss: 11.129560
Rec Loss: 10.202032
KL Loss: 0.927528
Y Loss: 0.361962
T Loss: 10.021051
Epoch 899 
Overall Loss: 11.155271
Rec Loss: 10.237626
KL Loss: 0.917645
Y Loss: 0.361180
T Loss: 10.057036
Epoch 949 
Overall Loss: 11.139190
Rec Loss: 10.203781
KL Loss: 0.935409
Y Loss: 0.362521
T Loss: 10.022521
Epoch 999 
Overall Loss: 11.129997
Rec Loss: 10.198611
KL Loss: 0.931387
Y Loss: 0.354762
T Loss: 10.021230
Epoch 1049 
Overall Loss: 11.123965
Rec Loss: 10.206266
KL Loss: 0.917699
Y Loss: 0.355209
T Loss: 10.028661
Epoch 1099 
Overall Loss: 11.119213
Rec Loss: 10.204991
KL Loss: 0.914223
Y Loss: 0.357567
T Loss: 10.026207
Epoch 1149 
Overall Loss: 11.135323
Rec Loss: 10.212159
KL Loss: 0.923164
Y Loss: 0.353749
T Loss: 10.035284
Epoch 1199 
Overall Loss: 11.125446
Rec Loss: 10.198519
KL Loss: 0.926926
Y Loss: 0.355736
T Loss: 10.020652
Epoch 1249 
Overall Loss: 11.121742
Rec Loss: 10.200975
KL Loss: 0.920767
Y Loss: 0.352248
T Loss: 10.024851
Epoch 1299 
Overall Loss: 11.130648
Rec Loss: 10.202554
KL Loss: 0.928094
Y Loss: 0.353139
T Loss: 10.025984
Epoch 1349 
Overall Loss: 11.108286
Rec Loss: 10.187960
KL Loss: 0.920326
Y Loss: 0.346912
T Loss: 10.014504
Epoch 1399 
Overall Loss: 11.104475
Rec Loss: 10.174135
KL Loss: 0.930340
Y Loss: 0.344877
T Loss: 10.001696
Epoch 1449 
Overall Loss: 11.104695
Rec Loss: 10.174750
KL Loss: 0.929945
Y Loss: 0.344952
T Loss: 10.002274
Epoch 1499 
Overall Loss: 11.110345
Rec Loss: 10.198021
KL Loss: 0.912324
Y Loss: 0.344902
T Loss: 10.025570
Epoch 1549 
Overall Loss: 11.086029
Rec Loss: 10.171805
KL Loss: 0.914224
Y Loss: 0.341917
T Loss: 10.000846
Epoch 1599 
Overall Loss: 11.117098
Rec Loss: 10.193036
KL Loss: 0.924062
Y Loss: 0.342649
T Loss: 10.021712
Epoch 1649 
Overall Loss: 11.107579
Rec Loss: 10.184381
KL Loss: 0.923197
Y Loss: 0.343455
T Loss: 10.012654
Epoch 1699 
Overall Loss: 11.101528
Rec Loss: 10.162058
KL Loss: 0.939470
Y Loss: 0.344606
T Loss: 9.989755
Epoch 1749 
Overall Loss: 11.086148
Rec Loss: 10.160334
KL Loss: 0.925814
Y Loss: 0.341412
T Loss: 9.989628
Epoch 1799 
Overall Loss: 11.079237
Rec Loss: 10.154259
KL Loss: 0.924978
Y Loss: 0.340094
T Loss: 9.984212
Epoch 1849 
Overall Loss: 11.077578
Rec Loss: 10.154837
KL Loss: 0.922742
Y Loss: 0.337758
T Loss: 9.985958
Epoch 1899 
Overall Loss: 11.085729
Rec Loss: 10.156327
KL Loss: 0.929401
Y Loss: 0.334144
T Loss: 9.989255
Epoch 1949 
Overall Loss: 11.065651
Rec Loss: 10.144680
KL Loss: 0.920971
Y Loss: 0.335611
T Loss: 9.976874
Epoch 1999 
Overall Loss: 11.051505
Rec Loss: 10.141789
KL Loss: 0.909716
Y Loss: 0.334241
T Loss: 9.974668
Epoch 2049 
Overall Loss: 11.060885
Rec Loss: 10.122677
KL Loss: 0.938208
Y Loss: 0.336578
T Loss: 9.954388
Epoch 2099 
Overall Loss: 11.069941
Rec Loss: 10.122523
KL Loss: 0.947418
Y Loss: 0.333074
T Loss: 9.955986
Epoch 2149 
Overall Loss: 11.061899
Rec Loss: 10.144952
KL Loss: 0.916947
Y Loss: 0.329414
T Loss: 9.980245
Epoch 2199 
Overall Loss: 11.059827
Rec Loss: 10.137772
KL Loss: 0.922055
Y Loss: 0.329352
T Loss: 9.973096
Epoch 2249 
Overall Loss: 11.042375
Rec Loss: 10.114906
KL Loss: 0.927469
Y Loss: 0.327828
T Loss: 9.950993
Epoch 2299 
Overall Loss: 11.059680
Rec Loss: 10.139980
KL Loss: 0.919700
Y Loss: 0.329546
T Loss: 9.975207
Epoch 2349 
Overall Loss: 11.049829
Rec Loss: 10.115658
KL Loss: 0.934172
Y Loss: 0.328254
T Loss: 9.951531
Epoch 2399 
Overall Loss: 11.049128
Rec Loss: 10.130287
KL Loss: 0.918841
Y Loss: 0.329191
T Loss: 9.965691
Epoch 2449 
Overall Loss: 11.040368
Rec Loss: 10.122600
KL Loss: 0.917768
Y Loss: 0.325589
T Loss: 9.959805
Epoch 2499 
Overall Loss: 11.057761
Rec Loss: 10.116524
KL Loss: 0.941236
Y Loss: 0.323600
T Loss: 9.954724
Epoch 2549 
Overall Loss: 11.039316
Rec Loss: 10.106020
KL Loss: 0.933295
Y Loss: 0.325080
T Loss: 9.943481
Epoch 2599 
Overall Loss: 11.059307
Rec Loss: 10.110835
KL Loss: 0.948472
Y Loss: 0.323809
T Loss: 9.948931
Epoch 2649 
Overall Loss: 11.039862
Rec Loss: 10.115511
KL Loss: 0.924350
Y Loss: 0.325486
T Loss: 9.952769
Epoch 2699 
Overall Loss: 11.047371
Rec Loss: 10.117317
KL Loss: 0.930055
Y Loss: 0.320013
T Loss: 9.957310
Epoch 2749 
Overall Loss: 11.028163
Rec Loss: 10.101081
KL Loss: 0.927082
Y Loss: 0.319656
T Loss: 9.941253
Epoch 2799 
Overall Loss: 11.024562
Rec Loss: 10.088623
KL Loss: 0.935939
Y Loss: 0.319615
T Loss: 9.928816
Epoch 2849 
Overall Loss: 11.031407
Rec Loss: 10.086450
KL Loss: 0.944958
Y Loss: 0.321501
T Loss: 9.925699
Epoch 2899 
Overall Loss: 11.028238
Rec Loss: 10.097422
KL Loss: 0.930817
Y Loss: 0.320992
T Loss: 9.936925
Epoch 2949 
Overall Loss: 11.009460
Rec Loss: 10.096633
KL Loss: 0.912828
Y Loss: 0.317439
T Loss: 9.937913
Epoch 2999 
Overall Loss: 11.003870
Rec Loss: 10.079171
KL Loss: 0.924699
Y Loss: 0.317835
T Loss: 9.920253
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.173337
Epoch 99
Rec Loss: 1.150173
Epoch 149
Rec Loss: 1.146229
Epoch 199
Rec Loss: 1.160091
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.827057
Epoch 99
Rec Loss: 9.830895
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.554520
Insample Error: 1.245919
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 18.053763
Rec Loss: 15.919281
KL Loss: 2.134482
Y Loss: 1.501973
T Loss: 13.230119
X Loss: 1.938176
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.608052
Epoch 99
Rec Loss: 3.622605
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.984139
Epoch 99
Rec Loss: 2.962851
Epoch 149
Rec Loss: 2.933562
Epoch 199
Rec Loss: 2.975742
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.892859
Insample Error 1.657454
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.429022
Epoch 99 
Prediction Loss: 0.384923
Epoch 149 
Prediction Loss: 0.375734
Epoch 199 
Prediction Loss: 0.355675
Epoch 249 
Prediction Loss: 0.350439
Epoch 299 
Prediction Loss: 0.344280
Epoch 349 
Prediction Loss: 0.331945
Epoch 399 
Prediction Loss: 0.322581
Epoch 449 
Prediction Loss: 0.331433
Epoch 499 
Prediction Loss: 0.311583
Epoch 549 
Prediction Loss: 0.296231
Epoch 599 
Prediction Loss: 0.293466
Epoch 649 
Prediction Loss: 0.281767
Epoch 699 
Prediction Loss: 0.268598
Epoch 749 
Prediction Loss: 0.257381
Epoch 799 
Prediction Loss: 0.250572
Epoch 849 
Prediction Loss: 0.247285
Epoch 899 
Prediction Loss: 0.235017
Epoch 949 
Prediction Loss: 0.231003
Epoch 999 
Prediction Loss: 0.222750
Epoch 1049 
Prediction Loss: 0.218149
Epoch 1099 
Prediction Loss: 0.206835
Epoch 1149 
Prediction Loss: 0.206818
Epoch 1199 
Prediction Loss: 0.199466
Epoch 1249 
Prediction Loss: 0.203140
Epoch 1299 
Prediction Loss: 0.193805
Epoch 1349 
Prediction Loss: 0.185128
Epoch 1399 
Prediction Loss: 0.183439
Epoch 1449 
Prediction Loss: 0.177372
Epoch 1499 
Prediction Loss: 0.174766
Epoch 1549 
Prediction Loss: 0.173695
Epoch 1599 
Prediction Loss: 0.166659
Epoch 1649 
Prediction Loss: 0.169064
Epoch 1699 
Prediction Loss: 0.168697
Epoch 1749 
Prediction Loss: 0.162374
Epoch 1799 
Prediction Loss: 0.160172
Epoch 1849 
Prediction Loss: 0.153776
Epoch 1899 
Prediction Loss: 0.154713
Epoch 1949 
Prediction Loss: 0.152057
Epoch 1999 
Prediction Loss: 0.149849
Epoch 2049 
Prediction Loss: 0.149608
Epoch 2099 
Prediction Loss: 0.148521
Epoch 2149 
Prediction Loss: 0.148538
Epoch 2199 
Prediction Loss: 0.150929
Epoch 2249 
Prediction Loss: 0.149874
Epoch 2299 
Prediction Loss: 0.144323
Epoch 2349 
Prediction Loss: 0.147270
Epoch 2399 
Prediction Loss: 0.144022
Epoch 2449 
Prediction Loss: 0.141399
Epoch 2499 
Prediction Loss: 0.135257
Epoch 2549 
Prediction Loss: 0.136327
Epoch 2599 
Prediction Loss: 0.136103
Epoch 2649 
Prediction Loss: 0.134804
Epoch 2699 
Prediction Loss: 0.140065
Epoch 2749 
Prediction Loss: 0.135102
Epoch 2799 
Prediction Loss: 0.135664
Epoch 2849 
Prediction Loss: 0.134063
Epoch 2899 
Prediction Loss: 0.132088
Epoch 2949 
Prediction Loss: 0.145424
Epoch 2999 
Prediction Loss: 0.133689
Epoch 3049 
Prediction Loss: 0.130110
Epoch 3099 
Prediction Loss: 0.127792
Epoch 3149 
Prediction Loss: 0.132469
Epoch 3199 
Prediction Loss: 0.124601
Epoch 3249 
Prediction Loss: 0.127773
Epoch 3299 
Prediction Loss: 0.124667
Epoch 3349 
Prediction Loss: 0.130749
Epoch 3399 
Prediction Loss: 0.126394
Epoch 3449 
Prediction Loss: 0.123578
Epoch 3499 
Prediction Loss: 0.128802
Epoch 3549 
Prediction Loss: 0.122973
Epoch 3599 
Prediction Loss: 0.123726
Epoch 3649 
Prediction Loss: 0.122282
Epoch 3699 
Prediction Loss: 0.119060
Epoch 3749 
Prediction Loss: 0.121149
Epoch 3799 
Prediction Loss: 0.123649
Epoch 3849 
Prediction Loss: 0.126078
Epoch 3899 
Prediction Loss: 0.123356
Epoch 3949 
Prediction Loss: 0.125238
Epoch 3999 
Prediction Loss: 0.120445
Epoch 4049 
Prediction Loss: 0.120848
Epoch 4099 
Prediction Loss: 0.118353
Epoch 4149 
Prediction Loss: 0.116035
Epoch 4199 
Prediction Loss: 0.119533
Epoch 4249 
Prediction Loss: 0.117468
Epoch 4299 
Prediction Loss: 0.117624
Epoch 4349 
Prediction Loss: 0.116619
Epoch 4399 
Prediction Loss: 0.120580
Epoch 4449 
Prediction Loss: 0.130960
Epoch 4499 
Prediction Loss: 0.116838
Epoch 4549 
Prediction Loss: 0.114371
Epoch 4599 
Prediction Loss: 0.114280
Epoch 4649 
Prediction Loss: 0.113234
Epoch 4699 
Prediction Loss: 0.113653
Epoch 4749 
Prediction Loss: 0.111878
Epoch 4799 
Prediction Loss: 0.116925
Epoch 4849 
Prediction Loss: 0.114916
Epoch 4899 
Prediction Loss: 0.114392
Epoch 4949 
Prediction Loss: 0.114275
Epoch 4999 
Prediction Loss: 0.118939
Epoch 5049 
Prediction Loss: 0.109434
Epoch 5099 
Prediction Loss: 0.112780
Epoch 5149 
Prediction Loss: 0.115262
Epoch 5199 
Prediction Loss: 0.110735
Epoch 5249 
Prediction Loss: 0.116421
Epoch 5299 
Prediction Loss: 0.111606
Epoch 5349 
Prediction Loss: 0.113041
Epoch 5399 
Prediction Loss: 0.111009
Epoch 5449 
Prediction Loss: 0.111458
Epoch 5499 
Prediction Loss: 0.109849
Epoch 5549 
Prediction Loss: 0.106766
Epoch 5599 
Prediction Loss: 0.109127
Epoch 5649 
Prediction Loss: 0.110695
Epoch 5699 
Prediction Loss: 0.116058
Epoch 5749 
Prediction Loss: 0.126935
Epoch 5799 
Prediction Loss: 0.110925
Epoch 5849 
Prediction Loss: 0.113299
Epoch 5899 
Prediction Loss: 0.108492
Epoch 5949 
Prediction Loss: 0.107371
Epoch 5999 
Prediction Loss: 0.110132
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.323990
Insample Error 1.472737
Ours, Train RMSE
0.5606, 
0.5682, 
0.5545, 
CEVAE, Train RMSE
1.1480, 
1.0285, 
0.8929, 
Ours, Insample RMSE
1.2363, 
1.2680, 
1.2459, 
CEVAE, Insample RMSE
1.9161, 
1.7677, 
1.6575, 
Direct Regression, Insample RMSE
1.4552, 
1.4773, 
1.4727, 
Train, RMSE mean 0.5611 std 0.0056
CEVAE, RMSE mean 1.0231 std 0.1042
Ours, RMSE mean 1.2501 std 0.0133, reconstruct confounder 1.1566 (0.0076) noise 9.8147 (0.0168)
CEVAE, RMSE mean 1.7804 std 0.1060, reconstruct confounder 3.6058 (0.0327) noise 2.9373 (0.2263)
Direct Regression, RMSE mean 1.4684 std 0.0095
Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=5, mask=0, nlayer=50, obsm=3, stop=5000, ycof=0.5, ylayer=50)
Y Mean 2.635484, Std 4.326354 
Test Y Mean 0.032706, Std 4.125860 
Observe confounder 3, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.624262
Rec Loss: 10.858091
KL Loss: 1.766172
Y Loss: 0.969655
T Loss: 10.373263
Epoch 99 
Overall Loss: 12.417309
Rec Loss: 10.815242
KL Loss: 1.602067
Y Loss: 0.884510
T Loss: 10.372986
Epoch 149 
Overall Loss: 12.317357
Rec Loss: 10.818485
KL Loss: 1.498871
Y Loss: 0.838679
T Loss: 10.399146
Epoch 199 
Overall Loss: 12.306859
Rec Loss: 10.844920
KL Loss: 1.461938
Y Loss: 0.861837
T Loss: 10.414002
Epoch 249 
Overall Loss: 12.269203
Rec Loss: 10.824696
KL Loss: 1.444507
Y Loss: 0.831922
T Loss: 10.408734
Epoch 299 
Overall Loss: 12.262667
Rec Loss: 10.836637
KL Loss: 1.426031
Y Loss: 0.844243
T Loss: 10.414515
Epoch 349 
Overall Loss: 12.230128
Rec Loss: 10.782523
KL Loss: 1.447604
Y Loss: 0.812467
T Loss: 10.376290
Epoch 399 
Overall Loss: 12.227327
Rec Loss: 10.802290
KL Loss: 1.425037
Y Loss: 0.804704
T Loss: 10.399938
Epoch 449 
Overall Loss: 12.219665
Rec Loss: 10.794603
KL Loss: 1.425062
Y Loss: 0.824018
T Loss: 10.382594
Epoch 499 
Overall Loss: 12.216097
Rec Loss: 10.804912
KL Loss: 1.411185
Y Loss: 0.815613
T Loss: 10.397106
Epoch 549 
Overall Loss: 12.191597
Rec Loss: 10.805781
KL Loss: 1.385816
Y Loss: 0.801133
T Loss: 10.405214
Epoch 599 
Overall Loss: 12.184618
Rec Loss: 10.791408
KL Loss: 1.393211
Y Loss: 0.787076
T Loss: 10.397870
Epoch 649 
Overall Loss: 12.178365
Rec Loss: 10.804877
KL Loss: 1.373488
Y Loss: 0.798034
T Loss: 10.405860
Epoch 699 
Overall Loss: 12.188107
Rec Loss: 10.778167
KL Loss: 1.409940
Y Loss: 0.789922
T Loss: 10.383206
Epoch 749 
Overall Loss: 12.169411
Rec Loss: 10.780591
KL Loss: 1.388820
Y Loss: 0.797827
T Loss: 10.381678
Epoch 799 
Overall Loss: 12.156972
Rec Loss: 10.798814
KL Loss: 1.358158
Y Loss: 0.798869
T Loss: 10.399380
Epoch 849 
Overall Loss: 12.149493
Rec Loss: 10.775320
KL Loss: 1.374173
Y Loss: 0.796073
T Loss: 10.377284
Epoch 899 
Overall Loss: 12.145772
Rec Loss: 10.776061
KL Loss: 1.369712
Y Loss: 0.797383
T Loss: 10.377369
Epoch 949 
Overall Loss: 12.119842
Rec Loss: 10.738249
KL Loss: 1.381592
Y Loss: 0.767697
T Loss: 10.354401
Epoch 999 
Overall Loss: 12.139108
Rec Loss: 10.768173
KL Loss: 1.370934
Y Loss: 0.780212
T Loss: 10.378067
Epoch 1049 
Overall Loss: 12.150560
Rec Loss: 10.782433
KL Loss: 1.368127
Y Loss: 0.787000
T Loss: 10.388933
Epoch 1099 
Overall Loss: 12.140378
Rec Loss: 10.767271
KL Loss: 1.373107
Y Loss: 0.773966
T Loss: 10.380288
Epoch 1149 
Overall Loss: 12.127224
Rec Loss: 10.765426
KL Loss: 1.361798
Y Loss: 0.766656
T Loss: 10.382098
Epoch 1199 
Overall Loss: 12.100639
Rec Loss: 10.746705
KL Loss: 1.353933
Y Loss: 0.778863
T Loss: 10.357274
Epoch 1249 
Overall Loss: 12.126055
Rec Loss: 10.749758
KL Loss: 1.376296
Y Loss: 0.772899
T Loss: 10.363309
Epoch 1299 
Overall Loss: 12.115929
Rec Loss: 10.752706
KL Loss: 1.363223
Y Loss: 0.773567
T Loss: 10.365923
Epoch 1349 
Overall Loss: 12.097512
Rec Loss: 10.753386
KL Loss: 1.344125
Y Loss: 0.764130
T Loss: 10.371322
Epoch 1399 
Overall Loss: 12.093381
Rec Loss: 10.750436
KL Loss: 1.342945
Y Loss: 0.766462
T Loss: 10.367204
Epoch 1449 
Overall Loss: 12.103405
Rec Loss: 10.758715
KL Loss: 1.344690
Y Loss: 0.772534
T Loss: 10.372448
Epoch 1499 
Overall Loss: 12.086248
Rec Loss: 10.745405
KL Loss: 1.340842
Y Loss: 0.774235
T Loss: 10.358288
Epoch 1549 
Overall Loss: 12.098139
Rec Loss: 10.743832
KL Loss: 1.354307
Y Loss: 0.758342
T Loss: 10.364661
Epoch 1599 
Overall Loss: 12.083414
Rec Loss: 10.738831
KL Loss: 1.344583
Y Loss: 0.769624
T Loss: 10.354019
Epoch 1649 
Overall Loss: 12.080704
Rec Loss: 10.723206
KL Loss: 1.357498
Y Loss: 0.755568
T Loss: 10.345422
Epoch 1699 
Overall Loss: 12.072957
Rec Loss: 10.725129
KL Loss: 1.347829
Y Loss: 0.748845
T Loss: 10.350705
Epoch 1749 
Overall Loss: 12.084280
Rec Loss: 10.713453
KL Loss: 1.370826
Y Loss: 0.759574
T Loss: 10.333666
Epoch 1799 
Overall Loss: 12.052924
Rec Loss: 10.705328
KL Loss: 1.347596
Y Loss: 0.752162
T Loss: 10.329247
Epoch 1849 
Overall Loss: 12.062528
Rec Loss: 10.728651
KL Loss: 1.333878
Y Loss: 0.760382
T Loss: 10.348459
Epoch 1899 
Overall Loss: 12.080325
Rec Loss: 10.715443
KL Loss: 1.364882
Y Loss: 0.756003
T Loss: 10.337442
Epoch 1949 
Overall Loss: 12.079993
Rec Loss: 10.713658
KL Loss: 1.366334
Y Loss: 0.757119
T Loss: 10.335099
Epoch 1999 
Overall Loss: 12.059105
Rec Loss: 10.703004
KL Loss: 1.356101
Y Loss: 0.743635
T Loss: 10.331186
Epoch 2049 
Overall Loss: 12.035194
Rec Loss: 10.711166
KL Loss: 1.324027
Y Loss: 0.748932
T Loss: 10.336700
Epoch 2099 
Overall Loss: 12.034809
Rec Loss: 10.703012
KL Loss: 1.331797
Y Loss: 0.754981
T Loss: 10.325522
Epoch 2149 
Overall Loss: 12.051223
Rec Loss: 10.693828
KL Loss: 1.357395
Y Loss: 0.735327
T Loss: 10.326164
Epoch 2199 
Overall Loss: 12.024816
Rec Loss: 10.684849
KL Loss: 1.339967
Y Loss: 0.735312
T Loss: 10.317194
Epoch 2249 
Overall Loss: 12.034405
Rec Loss: 10.697588
KL Loss: 1.336817
Y Loss: 0.741763
T Loss: 10.326707
Epoch 2299 
Overall Loss: 12.024883
Rec Loss: 10.699555
KL Loss: 1.325328
Y Loss: 0.744576
T Loss: 10.327267
Epoch 2349 
Overall Loss: 12.022224
Rec Loss: 10.678831
KL Loss: 1.343393
Y Loss: 0.731133
T Loss: 10.313264
Epoch 2399 
Overall Loss: 12.034194
Rec Loss: 10.677792
KL Loss: 1.356402
Y Loss: 0.738405
T Loss: 10.308590
Epoch 2449 
Overall Loss: 12.031759
Rec Loss: 10.694037
KL Loss: 1.337722
Y Loss: 0.752343
T Loss: 10.317865
Epoch 2499 
Overall Loss: 12.015647
Rec Loss: 10.695299
KL Loss: 1.320347
Y Loss: 0.747570
T Loss: 10.321514
Epoch 2549 
Overall Loss: 12.026519
Rec Loss: 10.699693
KL Loss: 1.326826
Y Loss: 0.749003
T Loss: 10.325192
Epoch 2599 
Overall Loss: 11.992860
Rec Loss: 10.667739
KL Loss: 1.325121
Y Loss: 0.728979
T Loss: 10.303249
Epoch 2649 
Overall Loss: 12.008456
Rec Loss: 10.681826
KL Loss: 1.326630
Y Loss: 0.740757
T Loss: 10.311448
Epoch 2699 
Overall Loss: 12.004570
Rec Loss: 10.651696
KL Loss: 1.352874
Y Loss: 0.728031
T Loss: 10.287681
Epoch 2749 
Overall Loss: 11.999857
Rec Loss: 10.649252
KL Loss: 1.350605
Y Loss: 0.722873
T Loss: 10.287816
Epoch 2799 
Overall Loss: 12.004610
Rec Loss: 10.657455
KL Loss: 1.347155
Y Loss: 0.716681
T Loss: 10.299115
Epoch 2849 
Overall Loss: 11.995890
Rec Loss: 10.651533
KL Loss: 1.344358
Y Loss: 0.710236
T Loss: 10.296415
Epoch 2899 
Overall Loss: 11.984081
Rec Loss: 10.637480
KL Loss: 1.346602
Y Loss: 0.705594
T Loss: 10.284683
Epoch 2949 
Overall Loss: 11.999680
Rec Loss: 10.648721
KL Loss: 1.350958
Y Loss: 0.731310
T Loss: 10.283067
Epoch 2999 
Overall Loss: 11.976558
Rec Loss: 10.645531
KL Loss: 1.331026
Y Loss: 0.716772
T Loss: 10.287145
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.829096
Epoch 99
Rec Loss: 0.832131
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.936053
Epoch 99
Rec Loss: 9.902436
Epoch 149
Rec Loss: 9.904724
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.669881
Insample Error: 1.827145
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 23.271263
Rec Loss: 20.519005
KL Loss: 2.752257
Y Loss: 11.555564
T Loss: 13.059212
X Loss: 1.682011
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.624193
Epoch 99
Rec Loss: 3.627520
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.718131
Epoch 99
Rec Loss: 2.741255
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.695907
Insample Error 3.647084
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.859922
Epoch 99 
Prediction Loss: 1.737207
Epoch 149 
Prediction Loss: 1.647401
Epoch 199 
Prediction Loss: 1.540906
Epoch 249 
Prediction Loss: 1.458946
Epoch 299 
Prediction Loss: 1.415312
Epoch 349 
Prediction Loss: 1.327998
Epoch 399 
Prediction Loss: 1.238024
Epoch 449 
Prediction Loss: 1.144870
Epoch 499 
Prediction Loss: 1.170658
Epoch 549 
Prediction Loss: 1.053330
Epoch 599 
Prediction Loss: 0.992561
Epoch 649 
Prediction Loss: 0.951842
Epoch 699 
Prediction Loss: 0.899614
Epoch 749 
Prediction Loss: 0.861646
Epoch 799 
Prediction Loss: 0.835560
Epoch 849 
Prediction Loss: 0.820956
Epoch 899 
Prediction Loss: 0.787871
Epoch 949 
Prediction Loss: 0.742264
Epoch 999 
Prediction Loss: 0.740077
Epoch 1049 
Prediction Loss: 0.709264
Epoch 1099 
Prediction Loss: 0.682720
Epoch 1149 
Prediction Loss: 0.663047
Epoch 1199 
Prediction Loss: 0.648562
Epoch 1249 
Prediction Loss: 0.648009
Epoch 1299 
Prediction Loss: 0.638777
Epoch 1349 
Prediction Loss: 0.610509
Epoch 1399 
Prediction Loss: 0.592661
Epoch 1449 
Prediction Loss: 0.579098
Epoch 1499 
Prediction Loss: 0.560880
Epoch 1549 
Prediction Loss: 0.557072
Epoch 1599 
Prediction Loss: 0.555211
Epoch 1649 
Prediction Loss: 0.541583
Epoch 1699 
Prediction Loss: 0.528634
Epoch 1749 
Prediction Loss: 0.529056
Epoch 1799 
Prediction Loss: 0.532983
Epoch 1849 
Prediction Loss: 0.503411
Epoch 1899 
Prediction Loss: 0.499598
Epoch 1949 
Prediction Loss: 0.512816
Epoch 1999 
Prediction Loss: 0.496282
Epoch 2049 
Prediction Loss: 0.482354
Epoch 2099 
Prediction Loss: 0.494073
Epoch 2149 
Prediction Loss: 0.471971
Epoch 2199 
Prediction Loss: 0.479350
Epoch 2249 
Prediction Loss: 0.472065
Epoch 2299 
Prediction Loss: 0.468454
Epoch 2349 
Prediction Loss: 0.456169
Epoch 2399 
Prediction Loss: 0.450375
Epoch 2449 
Prediction Loss: 0.439993
Epoch 2499 
Prediction Loss: 0.462719
Epoch 2549 
Prediction Loss: 0.445113
Epoch 2599 
Prediction Loss: 0.447901
Epoch 2649 
Prediction Loss: 0.427835
Epoch 2699 
Prediction Loss: 0.425450
Epoch 2749 
Prediction Loss: 0.416377
Epoch 2799 
Prediction Loss: 0.428324
Epoch 2849 
Prediction Loss: 0.431966
Epoch 2899 
Prediction Loss: 0.428000
Epoch 2949 
Prediction Loss: 0.417709
Epoch 2999 
Prediction Loss: 0.436697
Epoch 3049 
Prediction Loss: 0.418095
Epoch 3099 
Prediction Loss: 0.399376
Epoch 3149 
Prediction Loss: 0.405951
Epoch 3199 
Prediction Loss: 0.423024
Epoch 3249 
Prediction Loss: 0.412492
Epoch 3299 
Prediction Loss: 0.398217
Epoch 3349 
Prediction Loss: 0.402469
Epoch 3399 
Prediction Loss: 0.394395
Epoch 3449 
Prediction Loss: 0.403969
Epoch 3499 
Prediction Loss: 0.398703
Epoch 3549 
Prediction Loss: 0.394372
Epoch 3599 
Prediction Loss: 0.410407
Epoch 3649 
Prediction Loss: 0.385002
Epoch 3699 
Prediction Loss: 0.385436
Epoch 3749 
Prediction Loss: 0.396828
Epoch 3799 
Prediction Loss: 0.382155
Epoch 3849 
Prediction Loss: 0.380570
Epoch 3899 
Prediction Loss: 0.373315
Epoch 3949 
Prediction Loss: 0.385305
Epoch 3999 
Prediction Loss: 0.378387
Epoch 4049 
Prediction Loss: 0.376973
Epoch 4099 
Prediction Loss: 0.368452
Epoch 4149 
Prediction Loss: 0.372929
Epoch 4199 
Prediction Loss: 0.369511
Epoch 4249 
Prediction Loss: 0.382574
Epoch 4299 
Prediction Loss: 0.377607
Epoch 4349 
Prediction Loss: 0.375413
Epoch 4399 
Prediction Loss: 0.379088
Epoch 4449 
Prediction Loss: 0.376960
Epoch 4499 
Prediction Loss: 0.382252
Epoch 4549 
Prediction Loss: 0.372864
Epoch 4599 
Prediction Loss: 0.354023
Epoch 4649 
Prediction Loss: 0.374327
Epoch 4699 
Prediction Loss: 0.365704
Epoch 4749 
Prediction Loss: 0.357264
Epoch 4799 
Prediction Loss: 0.360393
Epoch 4849 
Prediction Loss: 0.378304
Epoch 4899 
Prediction Loss: 0.354120
Epoch 4949 
Prediction Loss: 0.394402
Epoch 4999 
Prediction Loss: 0.354767
Epoch 5049 
Prediction Loss: 0.355102
Epoch 5099 
Prediction Loss: 0.385134
Epoch 5149 
Prediction Loss: 0.360358
Epoch 5199 
Prediction Loss: 0.361884
Epoch 5249 
Prediction Loss: 0.351158
Epoch 5299 
Prediction Loss: 0.347748
Epoch 5349 
Prediction Loss: 0.348508
Epoch 5399 
Prediction Loss: 0.351938
Epoch 5449 
Prediction Loss: 0.352186
Epoch 5499 
Prediction Loss: 0.356061
Epoch 5549 
Prediction Loss: 0.356438
Epoch 5599 
Prediction Loss: 0.346284
Epoch 5649 
Prediction Loss: 0.351891
Epoch 5699 
Prediction Loss: 0.353347
Epoch 5749 
Prediction Loss: 0.343690
Epoch 5799 
Prediction Loss: 0.348855
Epoch 5849 
Prediction Loss: 0.337836
Epoch 5899 
Prediction Loss: 0.350149
Epoch 5949 
Prediction Loss: 0.351100
Epoch 5999 
Prediction Loss: 0.340338
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.574347
Insample Error 3.053640
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.827471
Rec Loss: 11.456707
KL Loss: 1.370764
Y Loss: 0.955057
T Loss: 10.979179
Epoch 99 
Overall Loss: 12.438770
Rec Loss: 10.842729
KL Loss: 1.596042
Y Loss: 0.873302
T Loss: 10.406078
Epoch 149 
Overall Loss: 12.345729
Rec Loss: 10.839184
KL Loss: 1.506545
Y Loss: 0.847872
T Loss: 10.415248
Epoch 199 
Overall Loss: 12.281206
Rec Loss: 10.824977
KL Loss: 1.456229
Y Loss: 0.843833
T Loss: 10.403060
Epoch 249 
Overall Loss: 12.259791
Rec Loss: 10.817337
KL Loss: 1.442454
Y Loss: 0.836331
T Loss: 10.399171
Epoch 299 
Overall Loss: 12.236526
Rec Loss: 10.817662
KL Loss: 1.418864
Y Loss: 0.826687
T Loss: 10.404319
Epoch 349 
Overall Loss: 12.242569
Rec Loss: 10.818539
KL Loss: 1.424030
Y Loss: 0.830029
T Loss: 10.403525
Epoch 399 
Overall Loss: 12.228152
Rec Loss: 10.827512
KL Loss: 1.400641
Y Loss: 0.824254
T Loss: 10.415385
Epoch 449 
Overall Loss: 12.215132
Rec Loss: 10.829566
KL Loss: 1.385566
Y Loss: 0.821821
T Loss: 10.418656
Epoch 499 
Overall Loss: 12.208559
Rec Loss: 10.816369
KL Loss: 1.392190
Y Loss: 0.806689
T Loss: 10.413025
Epoch 549 
Overall Loss: 12.186574
Rec Loss: 10.798829
KL Loss: 1.387744
Y Loss: 0.798869
T Loss: 10.399395
Epoch 599 
Overall Loss: 12.160247
Rec Loss: 10.786229
KL Loss: 1.374018
Y Loss: 0.794805
T Loss: 10.388827
Epoch 649 
Overall Loss: 12.187240
Rec Loss: 10.808634
KL Loss: 1.378607
Y Loss: 0.807602
T Loss: 10.404833
Epoch 699 
Overall Loss: 12.157758
Rec Loss: 10.790726
KL Loss: 1.367031
Y Loss: 0.786693
T Loss: 10.397380
Epoch 749 
Overall Loss: 12.157076
Rec Loss: 10.803333
KL Loss: 1.353743
Y Loss: 0.782983
T Loss: 10.411841
Epoch 799 
Overall Loss: 12.158375
Rec Loss: 10.779699
KL Loss: 1.378677
Y Loss: 0.763241
T Loss: 10.398078
Epoch 849 
Overall Loss: 12.152986
Rec Loss: 10.807711
KL Loss: 1.345275
Y Loss: 0.788120
T Loss: 10.413651
Epoch 899 
Overall Loss: 12.141654
Rec Loss: 10.795687
KL Loss: 1.345967
Y Loss: 0.764813
T Loss: 10.413281
Epoch 949 
Overall Loss: 12.142985
Rec Loss: 10.782651
KL Loss: 1.360333
Y Loss: 0.779535
T Loss: 10.392884
Epoch 999 
Overall Loss: 12.141223
Rec Loss: 10.784250
KL Loss: 1.356973
Y Loss: 0.767636
T Loss: 10.400432
Epoch 1049 
Overall Loss: 12.128375
Rec Loss: 10.781462
KL Loss: 1.346912
Y Loss: 0.790656
T Loss: 10.386134
Epoch 1099 
Overall Loss: 12.115433
Rec Loss: 10.743461
KL Loss: 1.371972
Y Loss: 0.773711
T Loss: 10.356606
Epoch 1149 
Overall Loss: 12.131361
Rec Loss: 10.773644
KL Loss: 1.357717
Y Loss: 0.765859
T Loss: 10.390715
Epoch 1199 
Overall Loss: 12.118582
Rec Loss: 10.756989
KL Loss: 1.361593
Y Loss: 0.769308
T Loss: 10.372335
Epoch 1249 
Overall Loss: 12.099716
Rec Loss: 10.751257
KL Loss: 1.348459
Y Loss: 0.739886
T Loss: 10.381314
Epoch 1299 
Overall Loss: 12.109217
Rec Loss: 10.779318
KL Loss: 1.329898
Y Loss: 0.745420
T Loss: 10.406609
Epoch 1349 
Overall Loss: 12.107184
Rec Loss: 10.753098
KL Loss: 1.354086
Y Loss: 0.742856
T Loss: 10.381670
Epoch 1399 
Overall Loss: 12.107427
Rec Loss: 10.741542
KL Loss: 1.365885
Y Loss: 0.747444
T Loss: 10.367820
Epoch 1449 
Overall Loss: 12.094749
Rec Loss: 10.764266
KL Loss: 1.330483
Y Loss: 0.764089
T Loss: 10.382222
Epoch 1499 
Overall Loss: 12.061124
Rec Loss: 10.747959
KL Loss: 1.313166
Y Loss: 0.774009
T Loss: 10.360954
Epoch 1549 
Overall Loss: 12.069804
Rec Loss: 10.743440
KL Loss: 1.326365
Y Loss: 0.754849
T Loss: 10.366015
Epoch 1599 
Overall Loss: 12.077717
Rec Loss: 10.745289
KL Loss: 1.332428
Y Loss: 0.759218
T Loss: 10.365680
Epoch 1649 
Overall Loss: 12.087512
Rec Loss: 10.759278
KL Loss: 1.328234
Y Loss: 0.764646
T Loss: 10.376955
Epoch 1699 
Overall Loss: 12.074716
Rec Loss: 10.730407
KL Loss: 1.344309
Y Loss: 0.741339
T Loss: 10.359737
Epoch 1749 
Overall Loss: 12.079520
Rec Loss: 10.741757
KL Loss: 1.337763
Y Loss: 0.752405
T Loss: 10.365554
Epoch 1799 
Overall Loss: 12.063597
Rec Loss: 10.704053
KL Loss: 1.359544
Y Loss: 0.727614
T Loss: 10.340246
Epoch 1849 
Overall Loss: 12.037409
Rec Loss: 10.697533
KL Loss: 1.339876
Y Loss: 0.729652
T Loss: 10.332707
Epoch 1899 
Overall Loss: 12.066204
Rec Loss: 10.734712
KL Loss: 1.331492
Y Loss: 0.749962
T Loss: 10.359731
Epoch 1949 
Overall Loss: 12.069877
Rec Loss: 10.746235
KL Loss: 1.323642
Y Loss: 0.770871
T Loss: 10.360799
Epoch 1999 
Overall Loss: 12.072323
Rec Loss: 10.721122
KL Loss: 1.351201
Y Loss: 0.755225
T Loss: 10.343509
Epoch 2049 
Overall Loss: 12.036732
Rec Loss: 10.714283
KL Loss: 1.322448
Y Loss: 0.738222
T Loss: 10.345173
Epoch 2099 
Overall Loss: 12.051956
Rec Loss: 10.707144
KL Loss: 1.344813
Y Loss: 0.741953
T Loss: 10.336167
Epoch 2149 
Overall Loss: 12.039591
Rec Loss: 10.698499
KL Loss: 1.341093
Y Loss: 0.732937
T Loss: 10.332030
Epoch 2199 
Overall Loss: 12.023783
Rec Loss: 10.704140
KL Loss: 1.319643
Y Loss: 0.730058
T Loss: 10.339110
Epoch 2249 
Overall Loss: 12.002120
Rec Loss: 10.675629
KL Loss: 1.326491
Y Loss: 0.739814
T Loss: 10.305722
Epoch 2299 
Overall Loss: 12.046542
Rec Loss: 10.698430
KL Loss: 1.348113
Y Loss: 0.740406
T Loss: 10.328226
Epoch 2349 
Overall Loss: 12.010141
Rec Loss: 10.698987
KL Loss: 1.311154
Y Loss: 0.739389
T Loss: 10.329292
Epoch 2399 
Overall Loss: 12.003541
Rec Loss: 10.673054
KL Loss: 1.330487
Y Loss: 0.729383
T Loss: 10.308362
Epoch 2449 
Overall Loss: 12.017160
Rec Loss: 10.672579
KL Loss: 1.344581
Y Loss: 0.727768
T Loss: 10.308694
Epoch 2499 
Overall Loss: 12.031184
Rec Loss: 10.715612
KL Loss: 1.315572
Y Loss: 0.718365
T Loss: 10.356429
Epoch 2549 
Overall Loss: 12.013157
Rec Loss: 10.672331
KL Loss: 1.340827
Y Loss: 0.720009
T Loss: 10.312327
Epoch 2599 
Overall Loss: 12.005694
Rec Loss: 10.678711
KL Loss: 1.326983
Y Loss: 0.737412
T Loss: 10.310005
Epoch 2649 
Overall Loss: 12.010655
Rec Loss: 10.688070
KL Loss: 1.322585
Y Loss: 0.736770
T Loss: 10.319684
Epoch 2699 
Overall Loss: 11.998157
Rec Loss: 10.677751
KL Loss: 1.320406
Y Loss: 0.721940
T Loss: 10.316781
Epoch 2749 
Overall Loss: 11.993113
Rec Loss: 10.672852
KL Loss: 1.320261
Y Loss: 0.727269
T Loss: 10.309218
Epoch 2799 
Overall Loss: 11.994103
Rec Loss: 10.682630
KL Loss: 1.311474
Y Loss: 0.714876
T Loss: 10.325192
Epoch 2849 
Overall Loss: 12.012223
Rec Loss: 10.658460
KL Loss: 1.353763
Y Loss: 0.729236
T Loss: 10.293842
Epoch 2899 
Overall Loss: 11.987829
Rec Loss: 10.671340
KL Loss: 1.316489
Y Loss: 0.713079
T Loss: 10.314801
Epoch 2949 
Overall Loss: 11.986746
Rec Loss: 10.657005
KL Loss: 1.329741
Y Loss: 0.711279
T Loss: 10.301365
Epoch 2999 
Overall Loss: 11.964631
Rec Loss: 10.647765
KL Loss: 1.316866
Y Loss: 0.714119
T Loss: 10.290705
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.851657
Epoch 99
Rec Loss: 0.841420
Epoch 149
Rec Loss: 0.836471
Epoch 199
Rec Loss: 0.832865
Epoch 249
Rec Loss: 0.826242
Epoch 299
Rec Loss: 0.826479
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.934894
Epoch 99
Rec Loss: 9.924077
Epoch 149
Rec Loss: 9.886563
Epoch 199
Rec Loss: 9.899635
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.671701
Insample Error: 1.886227
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.670890
Rec Loss: 18.558660
KL Loss: 3.112231
Y Loss: 7.161956
T Loss: 12.905640
X Loss: 2.072041
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.599665
Epoch 99
Rec Loss: 3.607835
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 3.162830
Epoch 99
Rec Loss: 3.152435
Epoch 149
Rec Loss: 3.168726
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.089718
Insample Error 3.519061
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.873969
Epoch 99 
Prediction Loss: 1.766509
Epoch 149 
Prediction Loss: 1.661424
Epoch 199 
Prediction Loss: 1.569502
Epoch 249 
Prediction Loss: 1.481834
Epoch 299 
Prediction Loss: 1.441859
Epoch 349 
Prediction Loss: 1.359493
Epoch 399 
Prediction Loss: 1.272640
Epoch 449 
Prediction Loss: 1.248145
Epoch 499 
Prediction Loss: 1.163933
Epoch 549 
Prediction Loss: 1.080925
Epoch 599 
Prediction Loss: 1.028050
Epoch 649 
Prediction Loss: 0.992625
Epoch 699 
Prediction Loss: 0.954757
Epoch 749 
Prediction Loss: 0.912649
Epoch 799 
Prediction Loss: 0.875478
Epoch 849 
Prediction Loss: 0.852644
Epoch 899 
Prediction Loss: 0.825338
Epoch 949 
Prediction Loss: 0.790763
Epoch 999 
Prediction Loss: 0.800231
Epoch 1049 
Prediction Loss: 0.766247
Epoch 1099 
Prediction Loss: 0.784831
Epoch 1149 
Prediction Loss: 0.697370
Epoch 1199 
Prediction Loss: 0.702646
Epoch 1249 
Prediction Loss: 0.680991
Epoch 1299 
Prediction Loss: 0.669283
Epoch 1349 
Prediction Loss: 0.652432
Epoch 1399 
Prediction Loss: 0.629054
Epoch 1449 
Prediction Loss: 0.611491
Epoch 1499 
Prediction Loss: 0.605648
Epoch 1549 
Prediction Loss: 0.588682
Epoch 1599 
Prediction Loss: 0.600004
Epoch 1649 
Prediction Loss: 0.595761
Epoch 1699 
Prediction Loss: 0.572179
Epoch 1749 
Prediction Loss: 0.566502
Epoch 1799 
Prediction Loss: 0.577775
Epoch 1849 
Prediction Loss: 0.558200
Epoch 1899 
Prediction Loss: 0.539353
Epoch 1949 
Prediction Loss: 0.542431
Epoch 1999 
Prediction Loss: 0.515058
Epoch 2049 
Prediction Loss: 0.520597
Epoch 2099 
Prediction Loss: 0.517497
Epoch 2149 
Prediction Loss: 0.529385
Epoch 2199 
Prediction Loss: 0.513452
Epoch 2249 
Prediction Loss: 0.506202
Epoch 2299 
Prediction Loss: 0.502533
Epoch 2349 
Prediction Loss: 0.503193
Epoch 2399 
Prediction Loss: 0.487119
Epoch 2449 
Prediction Loss: 0.488901
Epoch 2499 
Prediction Loss: 0.484948
Epoch 2549 
Prediction Loss: 0.484161
Epoch 2599 
Prediction Loss: 0.489976
Epoch 2649 
Prediction Loss: 0.478598
Epoch 2699 
Prediction Loss: 0.499738
Epoch 2749 
Prediction Loss: 0.463380
Epoch 2799 
Prediction Loss: 0.464684
Epoch 2849 
Prediction Loss: 0.472366
Epoch 2899 
Prediction Loss: 0.464457
Epoch 2949 
Prediction Loss: 0.464902
Epoch 2999 
Prediction Loss: 0.450097
Epoch 3049 
Prediction Loss: 0.447640
Epoch 3099 
Prediction Loss: 0.442369
Epoch 3149 
Prediction Loss: 0.465339
Epoch 3199 
Prediction Loss: 0.437377
Epoch 3249 
Prediction Loss: 0.460565
Epoch 3299 
Prediction Loss: 0.454522
Epoch 3349 
Prediction Loss: 0.443181
Epoch 3399 
Prediction Loss: 0.469317
Epoch 3449 
Prediction Loss: 0.451989
Epoch 3499 
Prediction Loss: 0.445595
Epoch 3549 
Prediction Loss: 0.424931
Epoch 3599 
Prediction Loss: 0.431131
Epoch 3649 
Prediction Loss: 0.421751
Epoch 3699 
Prediction Loss: 0.416866
Epoch 3749 
Prediction Loss: 0.454596
Epoch 3799 
Prediction Loss: 0.435310
Epoch 3849 
Prediction Loss: 0.421877
Epoch 3899 
Prediction Loss: 0.413489
Epoch 3949 
Prediction Loss: 0.404642
Epoch 3999 
Prediction Loss: 0.421228
Epoch 4049 
Prediction Loss: 0.417067
Epoch 4099 
Prediction Loss: 0.420647
Epoch 4149 
Prediction Loss: 0.422787
Epoch 4199 
Prediction Loss: 0.401717
Epoch 4249 
Prediction Loss: 0.401976
Epoch 4299 
Prediction Loss: 0.407306
Epoch 4349 
Prediction Loss: 0.410829
Epoch 4399 
Prediction Loss: 0.395781
Epoch 4449 
Prediction Loss: 0.402853
Epoch 4499 
Prediction Loss: 0.394436
Epoch 4549 
Prediction Loss: 0.410718
Epoch 4599 
Prediction Loss: 0.386829
Epoch 4649 
Prediction Loss: 0.407585
Epoch 4699 
Prediction Loss: 0.424013
Epoch 4749 
Prediction Loss: 0.384492
Epoch 4799 
Prediction Loss: 0.394783
Epoch 4849 
Prediction Loss: 0.394389
Epoch 4899 
Prediction Loss: 0.392572
Epoch 4949 
Prediction Loss: 0.383798
Epoch 4999 
Prediction Loss: 0.419306
Epoch 5049 
Prediction Loss: 0.383488
Epoch 5099 
Prediction Loss: 0.389048
Epoch 5149 
Prediction Loss: 0.398211
Epoch 5199 
Prediction Loss: 0.398250
Epoch 5249 
Prediction Loss: 0.383576
Epoch 5299 
Prediction Loss: 0.384023
Epoch 5349 
Prediction Loss: 0.391083
Epoch 5399 
Prediction Loss: 0.393126
Epoch 5449 
Prediction Loss: 0.377768
Epoch 5499 
Prediction Loss: 0.388212
Epoch 5549 
Prediction Loss: 0.375964
Epoch 5599 
Prediction Loss: 0.390718
Epoch 5649 
Prediction Loss: 0.373402
Epoch 5699 
Prediction Loss: 0.381996
Epoch 5749 
Prediction Loss: 0.374062
Epoch 5799 
Prediction Loss: 0.371210
Epoch 5849 
Prediction Loss: 0.377221
Epoch 5899 
Prediction Loss: 0.388478
Epoch 5949 
Prediction Loss: 0.373564
Epoch 5999 
Prediction Loss: 0.374327
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.597383
Insample Error 2.986861
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.791997
Rec Loss: 11.311547
KL Loss: 1.480449
Y Loss: 1.009118
T Loss: 10.806989
Epoch 99 
Overall Loss: 12.432205
Rec Loss: 10.844397
KL Loss: 1.587809
Y Loss: 0.859778
T Loss: 10.414508
Epoch 149 
Overall Loss: 12.344040
Rec Loss: 10.826838
KL Loss: 1.517203
Y Loss: 0.838342
T Loss: 10.407666
Epoch 199 
Overall Loss: 12.297852
Rec Loss: 10.857161
KL Loss: 1.440691
Y Loss: 0.842058
T Loss: 10.436133
Epoch 249 
Overall Loss: 12.274049
Rec Loss: 10.845798
KL Loss: 1.428251
Y Loss: 0.841364
T Loss: 10.425116
Epoch 299 
Overall Loss: 12.264924
Rec Loss: 10.833113
KL Loss: 1.431811
Y Loss: 0.833310
T Loss: 10.416458
Epoch 349 
Overall Loss: 12.227909
Rec Loss: 10.812406
KL Loss: 1.415503
Y Loss: 0.818746
T Loss: 10.403033
Epoch 399 
Overall Loss: 12.233411
Rec Loss: 10.827770
KL Loss: 1.405640
Y Loss: 0.815719
T Loss: 10.419911
Epoch 449 
Overall Loss: 12.225343
Rec Loss: 10.839186
KL Loss: 1.386156
Y Loss: 0.827834
T Loss: 10.425269
Epoch 499 
Overall Loss: 12.199392
Rec Loss: 10.810886
KL Loss: 1.388506
Y Loss: 0.798134
T Loss: 10.411819
Epoch 549 
Overall Loss: 12.206420
Rec Loss: 10.823568
KL Loss: 1.382853
Y Loss: 0.809641
T Loss: 10.418747
Epoch 599 
Overall Loss: 12.191255
Rec Loss: 10.805048
KL Loss: 1.386207
Y Loss: 0.791128
T Loss: 10.409484
Epoch 649 
Overall Loss: 12.185549
Rec Loss: 10.790355
KL Loss: 1.395194
Y Loss: 0.786714
T Loss: 10.396998
Epoch 699 
Overall Loss: 12.203060
Rec Loss: 10.823772
KL Loss: 1.379288
Y Loss: 0.806628
T Loss: 10.420458
Epoch 749 
Overall Loss: 12.153556
Rec Loss: 10.783948
KL Loss: 1.369608
Y Loss: 0.789402
T Loss: 10.389247
Epoch 799 
Overall Loss: 12.163905
Rec Loss: 10.791369
KL Loss: 1.372536
Y Loss: 0.782562
T Loss: 10.400089
Epoch 849 
Overall Loss: 12.150166
Rec Loss: 10.776756
KL Loss: 1.373409
Y Loss: 0.784278
T Loss: 10.384617
Epoch 899 
Overall Loss: 12.162756
Rec Loss: 10.802326
KL Loss: 1.360430
Y Loss: 0.800377
T Loss: 10.402137
Epoch 949 
Overall Loss: 12.155132
Rec Loss: 10.788727
KL Loss: 1.366405
Y Loss: 0.785999
T Loss: 10.395727
Epoch 999 
Overall Loss: 12.139938
Rec Loss: 10.783195
KL Loss: 1.356743
Y Loss: 0.793144
T Loss: 10.386623
Epoch 1049 
Overall Loss: 12.142830
Rec Loss: 10.795681
KL Loss: 1.347149
Y Loss: 0.776712
T Loss: 10.407325
Epoch 1099 
Overall Loss: 12.114124
Rec Loss: 10.756470
KL Loss: 1.357654
Y Loss: 0.750709
T Loss: 10.381115
Epoch 1149 
Overall Loss: 12.134597
Rec Loss: 10.785594
KL Loss: 1.349003
Y Loss: 0.781350
T Loss: 10.394920
Epoch 1199 
Overall Loss: 12.121822
Rec Loss: 10.769308
KL Loss: 1.352514
Y Loss: 0.774165
T Loss: 10.382225
Epoch 1249 
Overall Loss: 12.137090
Rec Loss: 10.786709
KL Loss: 1.350382
Y Loss: 0.776533
T Loss: 10.398442
Epoch 1299 
Overall Loss: 12.113824
Rec Loss: 10.761423
KL Loss: 1.352401
Y Loss: 0.769790
T Loss: 10.376528
Epoch 1349 
Overall Loss: 12.095312
Rec Loss: 10.754437
KL Loss: 1.340876
Y Loss: 0.761827
T Loss: 10.373523
Epoch 1399 
Overall Loss: 12.099752
Rec Loss: 10.753354
KL Loss: 1.346398
Y Loss: 0.756536
T Loss: 10.375086
Epoch 1449 
Overall Loss: 12.106270
Rec Loss: 10.744915
KL Loss: 1.361355
Y Loss: 0.759553
T Loss: 10.365138
Epoch 1499 
Overall Loss: 12.112376
Rec Loss: 10.758717
KL Loss: 1.353659
Y Loss: 0.769330
T Loss: 10.374052
Epoch 1549 
Overall Loss: 12.071000
Rec Loss: 10.726723
KL Loss: 1.344276
Y Loss: 0.751496
T Loss: 10.350975
Epoch 1599 
Overall Loss: 12.073968
Rec Loss: 10.743867
KL Loss: 1.330101
Y Loss: 0.752828
T Loss: 10.367453
Epoch 1649 
Overall Loss: 12.081915
Rec Loss: 10.735158
KL Loss: 1.346757
Y Loss: 0.753089
T Loss: 10.358613
Epoch 1699 
Overall Loss: 12.080629
Rec Loss: 10.727457
KL Loss: 1.353172
Y Loss: 0.726829
T Loss: 10.364042
Epoch 1749 
Overall Loss: 12.078639
Rec Loss: 10.733683
KL Loss: 1.344956
Y Loss: 0.772935
T Loss: 10.347215
Epoch 1799 
Overall Loss: 12.068562
Rec Loss: 10.719290
KL Loss: 1.349272
Y Loss: 0.748662
T Loss: 10.344959
Epoch 1849 
Overall Loss: 12.049197
Rec Loss: 10.709998
KL Loss: 1.339200
Y Loss: 0.744548
T Loss: 10.337724
Epoch 1899 
Overall Loss: 12.071580
Rec Loss: 10.720976
KL Loss: 1.350604
Y Loss: 0.753180
T Loss: 10.344386
Epoch 1949 
Overall Loss: 12.051632
Rec Loss: 10.707050
KL Loss: 1.344582
Y Loss: 0.736401
T Loss: 10.338849
Epoch 1999 
Overall Loss: 12.041733
Rec Loss: 10.703432
KL Loss: 1.338301
Y Loss: 0.754134
T Loss: 10.326365
Epoch 2049 
Overall Loss: 12.036150
Rec Loss: 10.679172
KL Loss: 1.356978
Y Loss: 0.733447
T Loss: 10.312449
Epoch 2099 
Overall Loss: 12.048270
Rec Loss: 10.719703
KL Loss: 1.328567
Y Loss: 0.747126
T Loss: 10.346140
Epoch 2149 
Overall Loss: 12.028307
Rec Loss: 10.676195
KL Loss: 1.352111
Y Loss: 0.714389
T Loss: 10.319001
Epoch 2199 
Overall Loss: 12.030496
Rec Loss: 10.699824
KL Loss: 1.330672
Y Loss: 0.727622
T Loss: 10.336013
Epoch 2249 
Overall Loss: 12.001326
Rec Loss: 10.682112
KL Loss: 1.319214
Y Loss: 0.728437
T Loss: 10.317893
Epoch 2299 
Overall Loss: 12.029853
Rec Loss: 10.696067
KL Loss: 1.333786
Y Loss: 0.738352
T Loss: 10.326891
Epoch 2349 
Overall Loss: 12.013111
Rec Loss: 10.674087
KL Loss: 1.339024
Y Loss: 0.744770
T Loss: 10.301702
Epoch 2399 
Overall Loss: 12.028057
Rec Loss: 10.678312
KL Loss: 1.349745
Y Loss: 0.717561
T Loss: 10.319532
Epoch 2449 
Overall Loss: 12.034645
Rec Loss: 10.701418
KL Loss: 1.333227
Y Loss: 0.767108
T Loss: 10.317864
Epoch 2499 
Overall Loss: 12.023337
Rec Loss: 10.687589
KL Loss: 1.335748
Y Loss: 0.733553
T Loss: 10.320812
Epoch 2549 
Overall Loss: 12.015490
Rec Loss: 10.687729
KL Loss: 1.327761
Y Loss: 0.754557
T Loss: 10.310450
Epoch 2599 
Overall Loss: 11.998058
Rec Loss: 10.682810
KL Loss: 1.315247
Y Loss: 0.729864
T Loss: 10.317878
Epoch 2649 
Overall Loss: 12.004039
Rec Loss: 10.647809
KL Loss: 1.356230
Y Loss: 0.714652
T Loss: 10.290483
Epoch 2699 
Overall Loss: 12.008991
Rec Loss: 10.664025
KL Loss: 1.344965
Y Loss: 0.736386
T Loss: 10.295832
Epoch 2749 
Overall Loss: 12.023885
Rec Loss: 10.659293
KL Loss: 1.364592
Y Loss: 0.721532
T Loss: 10.298527
Epoch 2799 
Overall Loss: 11.999147
Rec Loss: 10.674113
KL Loss: 1.325033
Y Loss: 0.725854
T Loss: 10.311187
Epoch 2849 
Overall Loss: 12.008479
Rec Loss: 10.672988
KL Loss: 1.335491
Y Loss: 0.721838
T Loss: 10.312070
Epoch 2899 
Overall Loss: 11.987677
Rec Loss: 10.644062
KL Loss: 1.343615
Y Loss: 0.725540
T Loss: 10.281292
Epoch 2949 
Overall Loss: 11.982394
Rec Loss: 10.669454
KL Loss: 1.312939
Y Loss: 0.723356
T Loss: 10.307777
Epoch 2999 
Overall Loss: 11.994757
Rec Loss: 10.656119
KL Loss: 1.338638
Y Loss: 0.746090
T Loss: 10.283074
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.829507
Epoch 99
Rec Loss: 0.822142
Epoch 149
Rec Loss: 0.827758
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.945497
Epoch 99
Rec Loss: 9.906892
Epoch 149
Rec Loss: 9.904060
Epoch 199
Rec Loss: 9.894325
Epoch 249
Rec Loss: 9.882364
Epoch 299
Rec Loss: 9.848833
Epoch 349
Rec Loss: 9.870187
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.673195
Insample Error: 1.804727
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.645823
Rec Loss: 20.097843
KL Loss: 2.547980
Y Loss: 9.403795
T Loss: 13.093911
X Loss: 2.302035
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.574430
Epoch 99
Rec Loss: 3.572700
Epoch 149
Rec Loss: 3.582912
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 3.176704
Epoch 99
Rec Loss: 3.141908
Epoch 149
Rec Loss: 3.170506
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.319302
Insample Error 3.717013
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.957982
Epoch 99 
Prediction Loss: 1.782569
Epoch 149 
Prediction Loss: 1.647372
Epoch 199 
Prediction Loss: 1.563220
Epoch 249 
Prediction Loss: 1.488740
Epoch 299 
Prediction Loss: 1.411540
Epoch 349 
Prediction Loss: 1.333818
Epoch 399 
Prediction Loss: 1.306959
Epoch 449 
Prediction Loss: 1.218546
Epoch 499 
Prediction Loss: 1.163286
Epoch 549 
Prediction Loss: 1.092919
Epoch 599 
Prediction Loss: 1.094552
Epoch 649 
Prediction Loss: 1.015745
Epoch 699 
Prediction Loss: 0.949365
Epoch 749 
Prediction Loss: 0.954649
Epoch 799 
Prediction Loss: 0.906504
Epoch 849 
Prediction Loss: 0.873952
Epoch 899 
Prediction Loss: 0.830979
Epoch 949 
Prediction Loss: 0.824210
Epoch 999 
Prediction Loss: 0.794985
Epoch 1049 
Prediction Loss: 0.744883
Epoch 1099 
Prediction Loss: 0.752893
Epoch 1149 
Prediction Loss: 0.745041
Epoch 1199 
Prediction Loss: 0.728638
Epoch 1249 
Prediction Loss: 0.703504
Epoch 1299 
Prediction Loss: 0.679802
Epoch 1349 
Prediction Loss: 0.705077
Epoch 1399 
Prediction Loss: 0.657709
Epoch 1449 
Prediction Loss: 0.648576
Epoch 1499 
Prediction Loss: 0.676768
Epoch 1549 
Prediction Loss: 0.656001
Epoch 1599 
Prediction Loss: 0.631031
Epoch 1649 
Prediction Loss: 0.597333
Epoch 1699 
Prediction Loss: 0.619096
Epoch 1749 
Prediction Loss: 0.586742
Epoch 1799 
Prediction Loss: 0.587549
Epoch 1849 
Prediction Loss: 0.584501
Epoch 1899 
Prediction Loss: 0.594975
Epoch 1949 
Prediction Loss: 0.560100
Epoch 1999 
Prediction Loss: 0.597973
Epoch 2049 
Prediction Loss: 0.543406
Epoch 2099 
Prediction Loss: 0.540001
Epoch 2149 
Prediction Loss: 0.536478
Epoch 2199 
Prediction Loss: 0.549807
Epoch 2249 
Prediction Loss: 0.557851
Epoch 2299 
Prediction Loss: 0.524013
Epoch 2349 
Prediction Loss: 0.535572
Epoch 2399 
Prediction Loss: 0.512647
Epoch 2449 
Prediction Loss: 0.510280
Epoch 2499 
Prediction Loss: 0.510677
Epoch 2549 
Prediction Loss: 0.489418
Epoch 2599 
Prediction Loss: 0.506379
Epoch 2649 
Prediction Loss: 0.525792
Epoch 2699 
Prediction Loss: 0.492230
Epoch 2749 
Prediction Loss: 0.478446
Epoch 2799 
Prediction Loss: 0.478600
Epoch 2849 
Prediction Loss: 0.467261
Epoch 2899 
Prediction Loss: 0.470353
Epoch 2949 
Prediction Loss: 0.465977
Epoch 2999 
Prediction Loss: 0.475972
Epoch 3049 
Prediction Loss: 0.470536
Epoch 3099 
Prediction Loss: 0.451253
Epoch 3149 
Prediction Loss: 0.457798
Epoch 3199 
Prediction Loss: 0.452039
Epoch 3249 
Prediction Loss: 0.459772
Epoch 3299 
Prediction Loss: 0.445837
Epoch 3349 
Prediction Loss: 0.460041
Epoch 3399 
Prediction Loss: 0.500277
Epoch 3449 
Prediction Loss: 0.446794
Epoch 3499 
Prediction Loss: 0.437950
Epoch 3549 
Prediction Loss: 0.453326
Epoch 3599 
Prediction Loss: 0.424306
Epoch 3649 
Prediction Loss: 0.429822
Epoch 3699 
Prediction Loss: 0.429201
Epoch 3749 
Prediction Loss: 0.426344
Epoch 3799 
Prediction Loss: 0.425075
Epoch 3849 
Prediction Loss: 0.418220
Epoch 3899 
Prediction Loss: 0.409451
Epoch 3949 
Prediction Loss: 0.451331
Epoch 3999 
Prediction Loss: 0.419141
Epoch 4049 
Prediction Loss: 0.417120
Epoch 4099 
Prediction Loss: 0.414550
Epoch 4149 
Prediction Loss: 0.427856
Epoch 4199 
Prediction Loss: 0.403196
Epoch 4249 
Prediction Loss: 0.399483
Epoch 4299 
Prediction Loss: 0.414526
Epoch 4349 
Prediction Loss: 0.417622
Epoch 4399 
Prediction Loss: 0.403643
Epoch 4449 
Prediction Loss: 0.399339
Epoch 4499 
Prediction Loss: 0.433167
Epoch 4549 
Prediction Loss: 0.394643
Epoch 4599 
Prediction Loss: 0.398070
Epoch 4649 
Prediction Loss: 0.391042
Epoch 4699 
Prediction Loss: 0.403938
Epoch 4749 
Prediction Loss: 0.394858
Epoch 4799 
Prediction Loss: 0.387208
Epoch 4849 
Prediction Loss: 0.400437
Epoch 4899 
Prediction Loss: 0.406045
Epoch 4949 
Prediction Loss: 0.390785
Epoch 4999 
Prediction Loss: 0.383897
Epoch 5049 
Prediction Loss: 0.394349
Epoch 5099 
Prediction Loss: 0.379306
Epoch 5149 
Prediction Loss: 0.385227
Epoch 5199 
Prediction Loss: 0.374705
Epoch 5249 
Prediction Loss: 0.387688
Epoch 5299 
Prediction Loss: 0.380435
Epoch 5349 
Prediction Loss: 0.390034
Epoch 5399 
Prediction Loss: 0.381217
Epoch 5449 
Prediction Loss: 0.394202
Epoch 5499 
Prediction Loss: 0.405808
Epoch 5549 
Prediction Loss: 0.386464
Epoch 5599 
Prediction Loss: 0.389066
Epoch 5649 
Prediction Loss: 0.386915
Epoch 5699 
Prediction Loss: 0.399325
Epoch 5749 
Prediction Loss: 0.388145
Epoch 5799 
Prediction Loss: 0.372923
Epoch 5849 
Prediction Loss: 0.367036
Epoch 5899 
Prediction Loss: 0.380297
Epoch 5949 
Prediction Loss: 0.374039
Epoch 5999 
Prediction Loss: 0.375223
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.610657
Insample Error 3.054207
Ours, Train RMSE
0.6699, 
0.6717, 
0.6732, 
CEVAE, Train RMSE
2.6959, 
2.0897, 
2.3193, 
Ours, Insample RMSE
1.8271, 
1.8862, 
1.8047, 
CEVAE, Insample RMSE
3.6471, 
3.5191, 
3.7170, 
Direct Regression, Insample RMSE
3.0536, 
2.9869, 
3.0542, 
Train, RMSE mean 0.6716 std 0.0014
CEVAE, RMSE mean 2.3683 std 0.2499
Ours, RMSE mean 1.8394 std 0.0344, reconstruct confounder 0.8258 (0.0029) noise 9.8793 (0.0225)
CEVAE, RMSE mean 3.6277 std 0.0820, reconstruct confounder 3.5989 (0.0210) noise 3.0042 (0.2023)
Direct Regression, RMSE mean 3.0316 std 0.0316
Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=5, mask=0, nlayer=50, obsm=3, stop=5000, ycof=0.5, ylayer=50)
Y Mean 2.635484, Std 4.326354 
Test Y Mean 0.032706, Std 4.125860 
Observe confounder 3, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.624262
Rec Loss: 10.858091
KL Loss: 1.766172
Y Loss: 0.969655
T Loss: 10.373263
Epoch 99 
Overall Loss: 12.417309
Rec Loss: 10.815242
KL Loss: 1.602067
Y Loss: 0.884510
T Loss: 10.372986
Epoch 149 
Overall Loss: 12.317357
Rec Loss: 10.818485
KL Loss: 1.498871
Y Loss: 0.838679
T Loss: 10.399146
Epoch 199 
Overall Loss: 12.306859
Rec Loss: 10.844920
KL Loss: 1.461938
Y Loss: 0.861837
T Loss: 10.414002
Epoch 249 
Overall Loss: 12.269203
Rec Loss: 10.824696
KL Loss: 1.444507
Y Loss: 0.831922
T Loss: 10.408734
Epoch 299 
Overall Loss: 12.262667
Rec Loss: 10.836637
KL Loss: 1.426031
Y Loss: 0.844243
T Loss: 10.414515
Epoch 349 
Overall Loss: 12.230128
Rec Loss: 10.782523
KL Loss: 1.447604
Y Loss: 0.812467
T Loss: 10.376290
Epoch 399 
Overall Loss: 12.227327
Rec Loss: 10.802290
KL Loss: 1.425037
Y Loss: 0.804704
T Loss: 10.399938
Epoch 449 
Overall Loss: 12.219665
Rec Loss: 10.794603
KL Loss: 1.425062
Y Loss: 0.824018
T Loss: 10.382594
Epoch 499 
Overall Loss: 12.216097
Rec Loss: 10.804912
KL Loss: 1.411185
Y Loss: 0.815613
T Loss: 10.397106
Epoch 549 
Overall Loss: 12.191597
Rec Loss: 10.805781
KL Loss: 1.385816
Y Loss: 0.801133
T Loss: 10.405214
Epoch 599 
Overall Loss: 12.184618
Rec Loss: 10.791408
KL Loss: 1.393211
Y Loss: 0.787076
T Loss: 10.397870
Epoch 649 
Overall Loss: 12.178365
Rec Loss: 10.804877
KL Loss: 1.373488
Y Loss: 0.798034
T Loss: 10.405860
Epoch 699 
Overall Loss: 12.188107
Rec Loss: 10.778167
KL Loss: 1.409940
Y Loss: 0.789922
T Loss: 10.383206
Epoch 749 
Overall Loss: 12.169411
Rec Loss: 10.780591
KL Loss: 1.388820
Y Loss: 0.797827
T Loss: 10.381678
Epoch 799 
Overall Loss: 12.156972
Rec Loss: 10.798814
KL Loss: 1.358158
Y Loss: 0.798869
T Loss: 10.399380
Epoch 849 
Overall Loss: 12.149493
Rec Loss: 10.775320
KL Loss: 1.374173
Y Loss: 0.796073
T Loss: 10.377284
Epoch 899 
Overall Loss: 12.145772
Rec Loss: 10.776061
KL Loss: 1.369712
Y Loss: 0.797383
T Loss: 10.377369
Epoch 949 
Overall Loss: 12.119842
Rec Loss: 10.738249
KL Loss: 1.381592
Y Loss: 0.767697
T Loss: 10.354401
Epoch 999 
Overall Loss: 12.139108
Rec Loss: 10.768173
KL Loss: 1.370934
Y Loss: 0.780212
T Loss: 10.378067
Epoch 1049 
Overall Loss: 12.150560
Rec Loss: 10.782433
KL Loss: 1.368127
Y Loss: 0.787000
T Loss: 10.388933
Epoch 1099 
Overall Loss: 12.140378
Rec Loss: 10.767271
KL Loss: 1.373107
Y Loss: 0.773966
T Loss: 10.380288
Epoch 1149 
Overall Loss: 12.127224
Rec Loss: 10.765426
KL Loss: 1.361798
Y Loss: 0.766656
T Loss: 10.382098
Epoch 1199 
Overall Loss: 12.100639
Rec Loss: 10.746705
KL Loss: 1.353933
Y Loss: 0.778863
T Loss: 10.357274
Epoch 1249 
Overall Loss: 12.126055
Rec Loss: 10.749758
KL Loss: 1.376296
Y Loss: 0.772899
T Loss: 10.363309
Epoch 1299 
Overall Loss: 12.115929
Rec Loss: 10.752706
KL Loss: 1.363223
Y Loss: 0.773567
T Loss: 10.365923
Epoch 1349 
Overall Loss: 12.097512
Rec Loss: 10.753386
KL Loss: 1.344125
Y Loss: 0.764130
T Loss: 10.371322
Epoch 1399 
Overall Loss: 12.093381
Rec Loss: 10.750436
KL Loss: 1.342945
Y Loss: 0.766462
T Loss: 10.367204
Epoch 1449 
Overall Loss: 12.103405
Rec Loss: 10.758715
KL Loss: 1.344690
Y Loss: 0.772534
T Loss: 10.372448
Epoch 1499 
Overall Loss: 12.086248
Rec Loss: 10.745405
KL Loss: 1.340842
Y Loss: 0.774235
T Loss: 10.358288
Epoch 1549 
Overall Loss: 12.098139
Rec Loss: 10.743832
KL Loss: 1.354307
Y Loss: 0.758342
T Loss: 10.364661
Epoch 1599 
Overall Loss: 12.083414
Rec Loss: 10.738831
KL Loss: 1.344583
Y Loss: 0.769624
T Loss: 10.354019
Epoch 1649 
Overall Loss: 12.080704
Rec Loss: 10.723206
KL Loss: 1.357498
Y Loss: 0.755568
T Loss: 10.345422
Epoch 1699 
Overall Loss: 12.072957
Rec Loss: 10.725129
KL Loss: 1.347829
Y Loss: 0.748845
T Loss: 10.350705
Epoch 1749 
Overall Loss: 12.084280
Rec Loss: 10.713453
KL Loss: 1.370826
Y Loss: 0.759574
T Loss: 10.333666
Epoch 1799 
Overall Loss: 12.052924
Rec Loss: 10.705328
KL Loss: 1.347596
Y Loss: 0.752162
T Loss: 10.329247
Epoch 1849 
Overall Loss: 12.062528
Rec Loss: 10.728651
KL Loss: 1.333878
Y Loss: 0.760382
T Loss: 10.348459
Epoch 1899 
Overall Loss: 12.080325
Rec Loss: 10.715443
KL Loss: 1.364882
Y Loss: 0.756003
T Loss: 10.337442
Epoch 1949 
Overall Loss: 12.079993
Rec Loss: 10.713658
KL Loss: 1.366334
Y Loss: 0.757119
T Loss: 10.335099
Epoch 1999 
Overall Loss: 12.059105
Rec Loss: 10.703004
KL Loss: 1.356101
Y Loss: 0.743635
T Loss: 10.331186
Epoch 2049 
Overall Loss: 12.035194
Rec Loss: 10.711166
KL Loss: 1.324027
Y Loss: 0.748932
T Loss: 10.336700
Epoch 2099 
Overall Loss: 12.034809
Rec Loss: 10.703012
KL Loss: 1.331797
Y Loss: 0.754981
T Loss: 10.325522
Epoch 2149 
Overall Loss: 12.051223
Rec Loss: 10.693828
KL Loss: 1.357395
Y Loss: 0.735327
T Loss: 10.326164
Epoch 2199 
Overall Loss: 12.024816
Rec Loss: 10.684849
KL Loss: 1.339967
Y Loss: 0.735312
T Loss: 10.317194
Epoch 2249 
Overall Loss: 12.034405
Rec Loss: 10.697588
KL Loss: 1.336817
Y Loss: 0.741763
T Loss: 10.326707
Epoch 2299 
Overall Loss: 12.024883
Rec Loss: 10.699555
KL Loss: 1.325328
Y Loss: 0.744576
T Loss: 10.327267
Epoch 2349 
Overall Loss: 12.022224
Rec Loss: 10.678831
KL Loss: 1.343393
Y Loss: 0.731133
T Loss: 10.313264
Epoch 2399 
Overall Loss: 12.034194
Rec Loss: 10.677792
KL Loss: 1.356402
Y Loss: 0.738405
T Loss: 10.308590
Epoch 2449 
Overall Loss: 12.031759
Rec Loss: 10.694037
KL Loss: 1.337722
Y Loss: 0.752343
T Loss: 10.317865
Epoch 2499 
Overall Loss: 12.015647
Rec Loss: 10.695299
KL Loss: 1.320347
Y Loss: 0.747570
T Loss: 10.321514
Epoch 2549 
Overall Loss: 12.026519
Rec Loss: 10.699693
KL Loss: 1.326826
Y Loss: 0.749003
T Loss: 10.325192
Epoch 2599 
Overall Loss: 11.992860
Rec Loss: 10.667739
KL Loss: 1.325121
Y Loss: 0.728979
T Loss: 10.303249
Epoch 2649 
Overall Loss: 12.008456
Rec Loss: 10.681826
KL Loss: 1.326630
Y Loss: 0.740757
T Loss: 10.311448
Epoch 2699 
Overall Loss: 12.004570
Rec Loss: 10.651696
KL Loss: 1.352874
Y Loss: 0.728031
T Loss: 10.287681
Epoch 2749 
Overall Loss: 11.999857
Rec Loss: 10.649252
KL Loss: 1.350605
Y Loss: 0.722873
T Loss: 10.287816
Epoch 2799 
Overall Loss: 12.004610
Rec Loss: 10.657455
KL Loss: 1.347155
Y Loss: 0.716681
T Loss: 10.299115
Epoch 2849 
Overall Loss: 11.995890
Rec Loss: 10.651533
KL Loss: 1.344358
Y Loss: 0.710236
T Loss: 10.296415
Epoch 2899 
Overall Loss: 11.984081
Rec Loss: 10.637480
KL Loss: 1.346602
Y Loss: 0.705594
T Loss: 10.284683
Epoch 2949 
Overall Loss: 11.999680
Rec Loss: 10.648721
KL Loss: 1.350958
Y Loss: 0.731310
T Loss: 10.283067
Epoch 2999 
Overall Loss: 11.976558
Rec Loss: 10.645531
KL Loss: 1.331026
Y Loss: 0.716772
T Loss: 10.287145
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.829096
Epoch 99
Rec Loss: 0.832131
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.936053
Epoch 99
Rec Loss: 9.902436
Epoch 149
Rec Loss: 9.904724
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.669881
Insample Error: 1.827145
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 23.271263
Rec Loss: 20.519005
KL Loss: 2.752257
Y Loss: 11.555564
T Loss: 13.059212
X Loss: 1.682011
Epoch 99 
Overall Loss: 17.395118
Rec Loss: 14.006997
KL Loss: 3.388121
Y Loss: 3.986760
T Loss: 12.932047
X Loss: -0.918430
Epoch 149 
Overall Loss: 16.055957
Rec Loss: 12.635345
KL Loss: 3.420612
Y Loss: 2.790312
T Loss: 12.892801
X Loss: -1.652612
Epoch 199 
Overall Loss: 15.121280
Rec Loss: 11.211073
KL Loss: 3.910207
Y Loss: 1.980755
T Loss: 12.338956
X Loss: -2.118260
Epoch 249 
Overall Loss: 14.609993
Rec Loss: 10.450765
KL Loss: 4.159228
Y Loss: 1.601593
T Loss: 11.864665
X Loss: -2.214697
Epoch 299 
Overall Loss: 14.294784
Rec Loss: 10.030392
KL Loss: 4.264392
Y Loss: 1.448344
T Loss: 11.562521
X Loss: -2.256301
Epoch 349 
Overall Loss: 14.064384
Rec Loss: 9.745753
KL Loss: 4.318631
Y Loss: 1.351706
T Loss: 11.427856
X Loss: -2.357956
Epoch 399 
Overall Loss: 13.980964
Rec Loss: 9.581137
KL Loss: 4.399827
Y Loss: 1.322226
T Loss: 11.369330
X Loss: -2.449306
Epoch 449 
Overall Loss: 13.888741
Rec Loss: 9.449652
KL Loss: 4.439089
Y Loss: 1.313207
T Loss: 11.340417
X Loss: -2.547368
Epoch 499 
Overall Loss: 13.803885
Rec Loss: 9.305858
KL Loss: 4.498027
Y Loss: 1.240410
T Loss: 11.299500
X Loss: -2.613847
Epoch 549 
Overall Loss: 13.715367
Rec Loss: 9.184655
KL Loss: 4.530712
Y Loss: 1.167462
T Loss: 11.292795
X Loss: -2.691871
Epoch 599 
Overall Loss: 13.632952
Rec Loss: 9.078324
KL Loss: 4.554628
Y Loss: 1.094180
T Loss: 11.299046
X Loss: -2.767812
Epoch 649 
Overall Loss: 13.599915
Rec Loss: 8.941945
KL Loss: 4.657970
Y Loss: 1.037491
T Loss: 11.285760
X Loss: -2.862560
Epoch 699 
Overall Loss: 13.395738
Rec Loss: 8.430552
KL Loss: 4.965187
Y Loss: 0.997638
T Loss: 11.104639
X Loss: -3.172906
Epoch 749 
Overall Loss: 13.251653
Rec Loss: 7.997127
KL Loss: 5.254525
Y Loss: 0.959777
T Loss: 10.979404
X Loss: -3.462165
Epoch 799 
Overall Loss: 13.191968
Rec Loss: 7.831685
KL Loss: 5.360282
Y Loss: 0.930896
T Loss: 10.946615
X Loss: -3.580377
Epoch 849 
Overall Loss: 13.168763
Rec Loss: 7.769191
KL Loss: 5.399572
Y Loss: 0.920762
T Loss: 10.933064
X Loss: -3.624254
Epoch 899 
Overall Loss: 13.134112
Rec Loss: 7.704369
KL Loss: 5.429744
Y Loss: 0.926388
T Loss: 10.919941
X Loss: -3.678767
Epoch 949 
Overall Loss: 13.113752
Rec Loss: 7.660801
KL Loss: 5.452950
Y Loss: 0.921586
T Loss: 10.920330
X Loss: -3.720322
Epoch 999 
Overall Loss: 13.083342
Rec Loss: 7.588759
KL Loss: 5.494583
Y Loss: 0.921491
T Loss: 10.898716
X Loss: -3.770702
Epoch 1049 
Overall Loss: 13.109041
Rec Loss: 7.578655
KL Loss: 5.530386
Y Loss: 0.915363
T Loss: 10.918655
X Loss: -3.797682
Epoch 1099 
Overall Loss: 13.079421
Rec Loss: 7.540694
KL Loss: 5.538727
Y Loss: 0.924178
T Loss: 10.914414
X Loss: -3.835809
Epoch 1149 
Overall Loss: 13.066274
Rec Loss: 7.501467
KL Loss: 5.564807
Y Loss: 0.894273
T Loss: 10.900796
X Loss: -3.846465
Epoch 1199 
Overall Loss: 13.017453
Rec Loss: 7.460664
KL Loss: 5.556789
Y Loss: 0.891287
T Loss: 10.883485
X Loss: -3.868464
Epoch 1249 
Overall Loss: 13.028916
Rec Loss: 7.447507
KL Loss: 5.581410
Y Loss: 0.899391
T Loss: 10.904753
X Loss: -3.906941
Epoch 1299 
Overall Loss: 13.022836
Rec Loss: 7.427233
KL Loss: 5.595603
Y Loss: 0.904125
T Loss: 10.900634
X Loss: -3.925464
Epoch 1349 
Overall Loss: 13.027588
Rec Loss: 7.409188
KL Loss: 5.618401
Y Loss: 0.919040
T Loss: 10.908980
X Loss: -3.959312
Epoch 1399 
Overall Loss: 12.975860
Rec Loss: 7.346190
KL Loss: 5.629671
Y Loss: 0.901638
T Loss: 10.906811
X Loss: -4.011441
Epoch 1449 
Overall Loss: 13.016997
Rec Loss: 7.389402
KL Loss: 5.627595
Y Loss: 0.910569
T Loss: 10.934799
X Loss: -4.000682
Epoch 1499 
Overall Loss: 12.978153
Rec Loss: 7.314971
KL Loss: 5.663182
Y Loss: 0.894003
T Loss: 10.934046
X Loss: -4.066077
Epoch 1549 
Overall Loss: 12.973895
Rec Loss: 7.290848
KL Loss: 5.683046
Y Loss: 0.895807
T Loss: 10.924417
X Loss: -4.081472
Epoch 1599 
Overall Loss: 12.956437
Rec Loss: 7.263958
KL Loss: 5.692479
Y Loss: 0.901652
T Loss: 10.936011
X Loss: -4.122879
Epoch 1649 
Overall Loss: 12.953957
Rec Loss: 7.223325
KL Loss: 5.730632
Y Loss: 0.894693
T Loss: 10.944990
X Loss: -4.169011
Epoch 1699 
Overall Loss: 12.955940
Rec Loss: 7.236035
KL Loss: 5.719904
Y Loss: 0.925562
T Loss: 10.945005
X Loss: -4.171751
Epoch 1749 
Overall Loss: 12.962855
Rec Loss: 7.172187
KL Loss: 5.790668
Y Loss: 0.894168
T Loss: 10.949838
X Loss: -4.224735
Epoch 1799 
Overall Loss: 12.959894
Rec Loss: 7.145984
KL Loss: 5.813910
Y Loss: 0.898388
T Loss: 10.954976
X Loss: -4.258186
Epoch 1849 
Overall Loss: 12.920359
Rec Loss: 7.100607
KL Loss: 5.819752
Y Loss: 0.877001
T Loss: 10.972547
X Loss: -4.310440
Epoch 1899 
Overall Loss: 12.918650
Rec Loss: 7.066525
KL Loss: 5.852125
Y Loss: 0.871381
T Loss: 10.979674
X Loss: -4.348839
Epoch 1949 
Overall Loss: 12.930690
Rec Loss: 7.050719
KL Loss: 5.879971
Y Loss: 0.884390
T Loss: 10.975827
X Loss: -4.367303
Epoch 1999 
Overall Loss: 12.919811
Rec Loss: 7.028632
KL Loss: 5.891179
Y Loss: 0.891090
T Loss: 10.998301
X Loss: -4.415214
Epoch 2049 
Overall Loss: 12.888621
Rec Loss: 6.973528
KL Loss: 5.915093
Y Loss: 0.864823
T Loss: 11.001762
X Loss: -4.460646
Epoch 2099 
Overall Loss: 12.903653
Rec Loss: 6.971243
KL Loss: 5.932410
Y Loss: 0.881374
T Loss: 11.002442
X Loss: -4.471885
Epoch 2149 
Overall Loss: 12.900743
Rec Loss: 6.947307
KL Loss: 5.953436
Y Loss: 0.891696
T Loss: 11.017616
X Loss: -4.516157
Epoch 2199 
Overall Loss: 12.849739
Rec Loss: 6.859453
KL Loss: 5.990286
Y Loss: 0.886880
T Loss: 10.997930
X Loss: -4.581918
Epoch 2249 
Overall Loss: 12.893661
Rec Loss: 6.881669
KL Loss: 6.011992
Y Loss: 0.892664
T Loss: 11.024914
X Loss: -4.589576
Epoch 2299 
Overall Loss: 12.867718
Rec Loss: 6.847141
KL Loss: 6.020578
Y Loss: 0.902493
T Loss: 11.006988
X Loss: -4.611094
Epoch 2349 
Overall Loss: 12.871186
Rec Loss: 6.829306
KL Loss: 6.041880
Y Loss: 0.867431
T Loss: 11.022853
X Loss: -4.627262
Epoch 2399 
Overall Loss: 12.875369
Rec Loss: 6.808162
KL Loss: 6.067207
Y Loss: 0.922092
T Loss: 11.017464
X Loss: -4.670348
Epoch 2449 
Overall Loss: 12.880351
Rec Loss: 6.808414
KL Loss: 6.071937
Y Loss: 0.909944
T Loss: 11.014522
X Loss: -4.661079
Epoch 2499 
Overall Loss: 12.877262
Rec Loss: 6.791977
KL Loss: 6.085285
Y Loss: 0.890526
T Loss: 11.024132
X Loss: -4.677418
Epoch 2549 
Overall Loss: 12.858631
Rec Loss: 6.733286
KL Loss: 6.125345
Y Loss: 0.879667
T Loss: 11.027050
X Loss: -4.733597
Epoch 2599 
Overall Loss: 12.842115
Rec Loss: 6.731685
KL Loss: 6.110430
Y Loss: 0.912987
T Loss: 11.023407
X Loss: -4.748216
Epoch 2649 
Overall Loss: 12.834237
Rec Loss: 6.719612
KL Loss: 6.114625
Y Loss: 0.903405
T Loss: 11.025434
X Loss: -4.757524
Epoch 2699 
Overall Loss: 12.844104
Rec Loss: 6.688191
KL Loss: 6.155913
Y Loss: 0.884539
T Loss: 11.016787
X Loss: -4.770866
Epoch 2749 
Overall Loss: 12.869688
Rec Loss: 6.676728
KL Loss: 6.192960
Y Loss: 0.869339
T Loss: 11.023353
X Loss: -4.781295
Epoch 2799 
Overall Loss: 12.838453
Rec Loss: 6.675543
KL Loss: 6.162910
Y Loss: 0.889558
T Loss: 11.031682
X Loss: -4.800918
Epoch 2849 
Overall Loss: 12.874374
Rec Loss: 6.685293
KL Loss: 6.189081
Y Loss: 0.887957
T Loss: 11.040313
X Loss: -4.798998
Epoch 2899 
Overall Loss: 12.825257
Rec Loss: 6.617207
KL Loss: 6.208051
Y Loss: 0.890378
T Loss: 11.020047
X Loss: -4.848030
Epoch 2949 
Overall Loss: 12.835717
Rec Loss: 6.622403
KL Loss: 6.213315
Y Loss: 0.916294
T Loss: 11.036017
X Loss: -4.871761
Epoch 2999 
Overall Loss: 12.801536
Rec Loss: 6.586163
KL Loss: 6.215373
Y Loss: 0.869387
T Loss: 11.022990
X Loss: -4.871520
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.563299
Epoch 99
Rec Loss: 1.562515
Epoch 149
Rec Loss: 1.552049
Epoch 199
Rec Loss: 1.560606
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.007204
Epoch 99
Rec Loss: 1.999150
Epoch 149
Rec Loss: 1.995709
Epoch 199
Rec Loss: 1.995843
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.666750
Insample Error 2.578345
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.859922
Epoch 99 
Prediction Loss: 1.737207
Epoch 149 
Prediction Loss: 1.647401
Epoch 199 
Prediction Loss: 1.540906
Epoch 249 
Prediction Loss: 1.458946
Epoch 299 
Prediction Loss: 1.415312
Epoch 349 
Prediction Loss: 1.327998
Epoch 399 
Prediction Loss: 1.238024
Epoch 449 
Prediction Loss: 1.144870
Epoch 499 
Prediction Loss: 1.170658
Epoch 549 
Prediction Loss: 1.053330
Epoch 599 
Prediction Loss: 0.992561
Epoch 649 
Prediction Loss: 0.951842
Epoch 699 
Prediction Loss: 0.899614
Epoch 749 
Prediction Loss: 0.861646
Epoch 799 
Prediction Loss: 0.835560
Epoch 849 
Prediction Loss: 0.820956
Epoch 899 
Prediction Loss: 0.787871
Epoch 949 
Prediction Loss: 0.742264
Epoch 999 
Prediction Loss: 0.740077
Epoch 1049 
Prediction Loss: 0.709264
Epoch 1099 
Prediction Loss: 0.682720
Epoch 1149 
Prediction Loss: 0.663047
Epoch 1199 
Prediction Loss: 0.648562
Epoch 1249 
Prediction Loss: 0.648009
Epoch 1299 
Prediction Loss: 0.638777
Epoch 1349 
Prediction Loss: 0.610509
Epoch 1399 
Prediction Loss: 0.592661
Epoch 1449 
Prediction Loss: 0.579098
Epoch 1499 
Prediction Loss: 0.560880
Epoch 1549 
Prediction Loss: 0.557072
Epoch 1599 
Prediction Loss: 0.555211
Epoch 1649 
Prediction Loss: 0.541583
Epoch 1699 
Prediction Loss: 0.528634
Epoch 1749 
Prediction Loss: 0.529056
Epoch 1799 
Prediction Loss: 0.532983
Epoch 1849 
Prediction Loss: 0.503411
Epoch 1899 
Prediction Loss: 0.499598
Epoch 1949 
Prediction Loss: 0.512816
Epoch 1999 
Prediction Loss: 0.496282
Epoch 2049 
Prediction Loss: 0.482354
Epoch 2099 
Prediction Loss: 0.494073
Epoch 2149 
Prediction Loss: 0.471971
Epoch 2199 
Prediction Loss: 0.479350
Epoch 2249 
Prediction Loss: 0.472065
Epoch 2299 
Prediction Loss: 0.468454
Epoch 2349 
Prediction Loss: 0.456169
Epoch 2399 
Prediction Loss: 0.450375
Epoch 2449 
Prediction Loss: 0.439993
Epoch 2499 
Prediction Loss: 0.462719
Epoch 2549 
Prediction Loss: 0.445113
Epoch 2599 
Prediction Loss: 0.447901
Epoch 2649 
Prediction Loss: 0.427835
Epoch 2699 
Prediction Loss: 0.425450
Epoch 2749 
Prediction Loss: 0.416377
Epoch 2799 
Prediction Loss: 0.428324
Epoch 2849 
Prediction Loss: 0.431966
Epoch 2899 
Prediction Loss: 0.428000
Epoch 2949 
Prediction Loss: 0.417709
Epoch 2999 
Prediction Loss: 0.436697
Epoch 3049 
Prediction Loss: 0.418095
Epoch 3099 
Prediction Loss: 0.399376
Epoch 3149 
Prediction Loss: 0.405951
Epoch 3199 
Prediction Loss: 0.423024
Epoch 3249 
Prediction Loss: 0.412492
Epoch 3299 
Prediction Loss: 0.398217
Epoch 3349 
Prediction Loss: 0.402469
Epoch 3399 
Prediction Loss: 0.394395
Epoch 3449 
Prediction Loss: 0.403969
Epoch 3499 
Prediction Loss: 0.398703
Epoch 3549 
Prediction Loss: 0.394372
Epoch 3599 
Prediction Loss: 0.410407
Epoch 3649 
Prediction Loss: 0.385002
Epoch 3699 
Prediction Loss: 0.385436
Epoch 3749 
Prediction Loss: 0.396828
Epoch 3799 
Prediction Loss: 0.382155
Epoch 3849 
Prediction Loss: 0.380570
Epoch 3899 
Prediction Loss: 0.373315
Epoch 3949 
Prediction Loss: 0.385305
Epoch 3999 
Prediction Loss: 0.378387
Epoch 4049 
Prediction Loss: 0.376973
Epoch 4099 
Prediction Loss: 0.368452
Epoch 4149 
Prediction Loss: 0.372929
Epoch 4199 
Prediction Loss: 0.369511
Epoch 4249 
Prediction Loss: 0.382574
Epoch 4299 
Prediction Loss: 0.377607
Epoch 4349 
Prediction Loss: 0.375413
Epoch 4399 
Prediction Loss: 0.379088
Epoch 4449 
Prediction Loss: 0.376960
Epoch 4499 
Prediction Loss: 0.382252
Epoch 4549 
Prediction Loss: 0.372864
Epoch 4599 
Prediction Loss: 0.354023
Epoch 4649 
Prediction Loss: 0.374327
Epoch 4699 
Prediction Loss: 0.365704
Epoch 4749 
Prediction Loss: 0.357264
Epoch 4799 
Prediction Loss: 0.360393
Epoch 4849 
Prediction Loss: 0.378304
Epoch 4899 
Prediction Loss: 0.354120
Epoch 4949 
Prediction Loss: 0.394402
Epoch 4999 
Prediction Loss: 0.354767
Epoch 5049 
Prediction Loss: 0.355102
Epoch 5099 
Prediction Loss: 0.385134
Epoch 5149 
Prediction Loss: 0.360358
Epoch 5199 
Prediction Loss: 0.361884
Epoch 5249 
Prediction Loss: 0.351158
Epoch 5299 
Prediction Loss: 0.347748
Epoch 5349 
Prediction Loss: 0.348508
Epoch 5399 
Prediction Loss: 0.351938
Epoch 5449 
Prediction Loss: 0.352186
Epoch 5499 
Prediction Loss: 0.356061
Epoch 5549 
Prediction Loss: 0.356438
Epoch 5599 
Prediction Loss: 0.346284
Epoch 5649 
Prediction Loss: 0.351891
Epoch 5699 
Prediction Loss: 0.353347
Epoch 5749 
Prediction Loss: 0.343690
Epoch 5799 
Prediction Loss: 0.348855
Epoch 5849 
Prediction Loss: 0.337836
Epoch 5899 
Prediction Loss: 0.350149
Epoch 5949 
Prediction Loss: 0.351100
Epoch 5999 
Prediction Loss: 0.340338
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.574347
Insample Error 3.053640
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.827471
Rec Loss: 11.456707
KL Loss: 1.370764
Y Loss: 0.955057
T Loss: 10.979179
Epoch 99 
Overall Loss: 12.438770
Rec Loss: 10.842729
KL Loss: 1.596042
Y Loss: 0.873302
T Loss: 10.406078
Epoch 149 
Overall Loss: 12.345729
Rec Loss: 10.839184
KL Loss: 1.506545
Y Loss: 0.847872
T Loss: 10.415248
Epoch 199 
Overall Loss: 12.281206
Rec Loss: 10.824977
KL Loss: 1.456229
Y Loss: 0.843833
T Loss: 10.403060
Epoch 249 
Overall Loss: 12.259791
Rec Loss: 10.817337
KL Loss: 1.442454
Y Loss: 0.836331
T Loss: 10.399171
Epoch 299 
Overall Loss: 12.236526
Rec Loss: 10.817662
KL Loss: 1.418864
Y Loss: 0.826687
T Loss: 10.404319
Epoch 349 
Overall Loss: 12.242569
Rec Loss: 10.818539
KL Loss: 1.424030
Y Loss: 0.830029
T Loss: 10.403525
Epoch 399 
Overall Loss: 12.228152
Rec Loss: 10.827512
KL Loss: 1.400641
Y Loss: 0.824254
T Loss: 10.415385
Epoch 449 
Overall Loss: 12.215132
Rec Loss: 10.829566
KL Loss: 1.385566
Y Loss: 0.821821
T Loss: 10.418656
Epoch 499 
Overall Loss: 12.208559
Rec Loss: 10.816369
KL Loss: 1.392190
Y Loss: 0.806689
T Loss: 10.413025
Epoch 549 
Overall Loss: 12.186574
Rec Loss: 10.798829
KL Loss: 1.387744
Y Loss: 0.798869
T Loss: 10.399395
Epoch 599 
Overall Loss: 12.160247
Rec Loss: 10.786229
KL Loss: 1.374018
Y Loss: 0.794805
T Loss: 10.388827
Epoch 649 
Overall Loss: 12.187240
Rec Loss: 10.808634
KL Loss: 1.378607
Y Loss: 0.807602
T Loss: 10.404833
Epoch 699 
Overall Loss: 12.157758
Rec Loss: 10.790726
KL Loss: 1.367031
Y Loss: 0.786693
T Loss: 10.397380
Epoch 749 
Overall Loss: 12.157076
Rec Loss: 10.803333
KL Loss: 1.353743
Y Loss: 0.782983
T Loss: 10.411841
Epoch 799 
Overall Loss: 12.158375
Rec Loss: 10.779699
KL Loss: 1.378677
Y Loss: 0.763241
T Loss: 10.398078
Epoch 849 
Overall Loss: 12.152986
Rec Loss: 10.807711
KL Loss: 1.345275
Y Loss: 0.788120
T Loss: 10.413651
Epoch 899 
Overall Loss: 12.141654
Rec Loss: 10.795687
KL Loss: 1.345967
Y Loss: 0.764813
T Loss: 10.413281
Epoch 949 
Overall Loss: 12.142985
Rec Loss: 10.782651
KL Loss: 1.360333
Y Loss: 0.779535
T Loss: 10.392884
Epoch 999 
Overall Loss: 12.141223
Rec Loss: 10.784250
KL Loss: 1.356973
Y Loss: 0.767636
T Loss: 10.400432
Epoch 1049 
Overall Loss: 12.128375
Rec Loss: 10.781462
KL Loss: 1.346912
Y Loss: 0.790656
T Loss: 10.386134
Epoch 1099 
Overall Loss: 12.115433
Rec Loss: 10.743461
KL Loss: 1.371972
Y Loss: 0.773711
T Loss: 10.356606
Epoch 1149 
Overall Loss: 12.131361
Rec Loss: 10.773644
KL Loss: 1.357717
Y Loss: 0.765859
T Loss: 10.390715
Epoch 1199 
Overall Loss: 12.118582
Rec Loss: 10.756989
KL Loss: 1.361593
Y Loss: 0.769308
T Loss: 10.372335
Epoch 1249 
Overall Loss: 12.099716
Rec Loss: 10.751257
KL Loss: 1.348459
Y Loss: 0.739886
T Loss: 10.381314
Epoch 1299 
Overall Loss: 12.109217
Rec Loss: 10.779318
KL Loss: 1.329898
Y Loss: 0.745420
T Loss: 10.406609
Epoch 1349 
Overall Loss: 12.107184
Rec Loss: 10.753098
KL Loss: 1.354086
Y Loss: 0.742856
T Loss: 10.381670
Epoch 1399 
Overall Loss: 12.107427
Rec Loss: 10.741542
KL Loss: 1.365885
Y Loss: 0.747444
T Loss: 10.367820
Epoch 1449 
Overall Loss: 12.094749
Rec Loss: 10.764266
KL Loss: 1.330483
Y Loss: 0.764089
T Loss: 10.382222
Epoch 1499 
Overall Loss: 12.061124
Rec Loss: 10.747959
KL Loss: 1.313166
Y Loss: 0.774009
T Loss: 10.360954
Epoch 1549 
Overall Loss: 12.069804
Rec Loss: 10.743440
KL Loss: 1.326365
Y Loss: 0.754849
T Loss: 10.366015
Epoch 1599 
Overall Loss: 12.077717
Rec Loss: 10.745289
KL Loss: 1.332428
Y Loss: 0.759218
T Loss: 10.365680
Epoch 1649 
Overall Loss: 12.087512
Rec Loss: 10.759278
KL Loss: 1.328234
Y Loss: 0.764646
T Loss: 10.376955
Epoch 1699 
Overall Loss: 12.074716
Rec Loss: 10.730407
KL Loss: 1.344309
Y Loss: 0.741339
T Loss: 10.359737
Epoch 1749 
Overall Loss: 12.079520
Rec Loss: 10.741757
KL Loss: 1.337763
Y Loss: 0.752405
T Loss: 10.365554
Epoch 1799 
Overall Loss: 12.063597
Rec Loss: 10.704053
KL Loss: 1.359544
Y Loss: 0.727614
T Loss: 10.340246
Epoch 1849 
Overall Loss: 12.037409
Rec Loss: 10.697533
KL Loss: 1.339876
Y Loss: 0.729652
T Loss: 10.332707
Epoch 1899 
Overall Loss: 12.066204
Rec Loss: 10.734712
KL Loss: 1.331492
Y Loss: 0.749962
T Loss: 10.359731
Epoch 1949 
Overall Loss: 12.069877
Rec Loss: 10.746235
KL Loss: 1.323642
Y Loss: 0.770871
T Loss: 10.360799
Epoch 1999 
Overall Loss: 12.072323
Rec Loss: 10.721122
KL Loss: 1.351201
Y Loss: 0.755225
T Loss: 10.343509
Epoch 2049 
Overall Loss: 12.036732
Rec Loss: 10.714283
KL Loss: 1.322448
Y Loss: 0.738222
T Loss: 10.345173
Epoch 2099 
Overall Loss: 12.051956
Rec Loss: 10.707144
KL Loss: 1.344813
Y Loss: 0.741953
T Loss: 10.336167
Epoch 2149 
Overall Loss: 12.039591
Rec Loss: 10.698499
KL Loss: 1.341093
Y Loss: 0.732937
T Loss: 10.332030
Epoch 2199 
Overall Loss: 12.023783
Rec Loss: 10.704140
KL Loss: 1.319643
Y Loss: 0.730058
T Loss: 10.339110
Epoch 2249 
Overall Loss: 12.002120
Rec Loss: 10.675629
KL Loss: 1.326491
Y Loss: 0.739814
T Loss: 10.305722
Epoch 2299 
Overall Loss: 12.046542
Rec Loss: 10.698430
KL Loss: 1.348113
Y Loss: 0.740406
T Loss: 10.328226
Epoch 2349 
Overall Loss: 12.010141
Rec Loss: 10.698987
KL Loss: 1.311154
Y Loss: 0.739389
T Loss: 10.329292
Epoch 2399 
Overall Loss: 12.003541
Rec Loss: 10.673054
KL Loss: 1.330487
Y Loss: 0.729383
T Loss: 10.308362
Epoch 2449 
Overall Loss: 12.017160
Rec Loss: 10.672579
KL Loss: 1.344581
Y Loss: 0.727768
T Loss: 10.308694
Epoch 2499 
Overall Loss: 12.031184
Rec Loss: 10.715612
KL Loss: 1.315572
Y Loss: 0.718365
T Loss: 10.356429
Epoch 2549 
Overall Loss: 12.013157
Rec Loss: 10.672331
KL Loss: 1.340827
Y Loss: 0.720009
T Loss: 10.312327
Epoch 2599 
Overall Loss: 12.005694
Rec Loss: 10.678711
KL Loss: 1.326983
Y Loss: 0.737412
T Loss: 10.310005
Epoch 2649 
Overall Loss: 12.010655
Rec Loss: 10.688070
KL Loss: 1.322585
Y Loss: 0.736770
T Loss: 10.319684
Epoch 2699 
Overall Loss: 11.998157
Rec Loss: 10.677751
KL Loss: 1.320406
Y Loss: 0.721940
T Loss: 10.316781
Epoch 2749 
Overall Loss: 11.993113
Rec Loss: 10.672852
KL Loss: 1.320261
Y Loss: 0.727269
T Loss: 10.309218
Epoch 2799 
Overall Loss: 11.994103
Rec Loss: 10.682630
KL Loss: 1.311474
Y Loss: 0.714876
T Loss: 10.325192
Epoch 2849 
Overall Loss: 12.012223
Rec Loss: 10.658460
KL Loss: 1.353763
Y Loss: 0.729236
T Loss: 10.293842
Epoch 2899 
Overall Loss: 11.987829
Rec Loss: 10.671340
KL Loss: 1.316489
Y Loss: 0.713079
T Loss: 10.314801
Epoch 2949 
Overall Loss: 11.986746
Rec Loss: 10.657005
KL Loss: 1.329741
Y Loss: 0.711279
T Loss: 10.301365
Epoch 2999 
Overall Loss: 11.964631
Rec Loss: 10.647765
KL Loss: 1.316866
Y Loss: 0.714119
T Loss: 10.290705
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.851657
Epoch 99
Rec Loss: 0.841420
Epoch 149
Rec Loss: 0.836471
Epoch 199
Rec Loss: 0.832865
Epoch 249
Rec Loss: 0.826242
Epoch 299
Rec Loss: 0.826479
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.934894
Epoch 99
Rec Loss: 9.924077
Epoch 149
Rec Loss: 9.886563
Epoch 199
Rec Loss: 9.899635
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.671701
Insample Error: 1.886227
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.670890
Rec Loss: 18.558660
KL Loss: 3.112231
Y Loss: 7.161956
T Loss: 12.905640
X Loss: 2.072041
Epoch 99 
Overall Loss: 17.256798
Rec Loss: 13.717573
KL Loss: 3.539225
Y Loss: 3.090265
T Loss: 12.923977
X Loss: -0.751537
Epoch 149 
Overall Loss: 15.649582
Rec Loss: 12.005588
KL Loss: 3.643993
Y Loss: 2.468351
T Loss: 12.611166
X Loss: -1.839753
Epoch 199 
Overall Loss: 14.838381
Rec Loss: 10.966833
KL Loss: 3.871548
Y Loss: 1.947580
T Loss: 12.230183
X Loss: -2.237140
Epoch 249 
Overall Loss: 14.284847
Rec Loss: 10.040552
KL Loss: 4.244295
Y Loss: 1.502061
T Loss: 11.733344
X Loss: -2.443823
Epoch 299 
Overall Loss: 14.068582
Rec Loss: 9.679608
KL Loss: 4.388974
Y Loss: 1.372630
T Loss: 11.565621
X Loss: -2.572327
Epoch 349 
Overall Loss: 13.939879
Rec Loss: 9.451735
KL Loss: 4.488145
Y Loss: 1.312962
T Loss: 11.500878
X Loss: -2.705624
Epoch 399 
Overall Loss: 13.760256
Rec Loss: 9.128345
KL Loss: 4.631911
Y Loss: 1.246433
T Loss: 11.366359
X Loss: -2.861231
Epoch 449 
Overall Loss: 13.594803
Rec Loss: 8.655657
KL Loss: 4.939147
Y Loss: 1.184637
T Loss: 11.143351
X Loss: -3.080013
Epoch 499 
Overall Loss: 13.456439
Rec Loss: 8.289397
KL Loss: 5.167042
Y Loss: 1.153399
T Loss: 11.012738
X Loss: -3.300040
Epoch 549 
Overall Loss: 13.370182
Rec Loss: 8.068402
KL Loss: 5.301780
Y Loss: 1.114393
T Loss: 10.949691
X Loss: -3.438486
Epoch 599 
Overall Loss: 13.306344
Rec Loss: 7.954597
KL Loss: 5.351747
Y Loss: 1.088590
T Loss: 10.927382
X Loss: -3.517079
Epoch 649 
Overall Loss: 13.277863
Rec Loss: 7.856386
KL Loss: 5.421477
Y Loss: 1.067623
T Loss: 10.914419
X Loss: -3.591844
Epoch 699 
Overall Loss: 13.226647
Rec Loss: 7.783440
KL Loss: 5.443207
Y Loss: 1.013989
T Loss: 10.904704
X Loss: -3.628258
Epoch 749 
Overall Loss: 13.220589
Rec Loss: 7.756587
KL Loss: 5.464002
Y Loss: 1.005576
T Loss: 10.922942
X Loss: -3.669143
Epoch 799 
Overall Loss: 13.187067
Rec Loss: 7.697862
KL Loss: 5.489205
Y Loss: 1.004751
T Loss: 10.903512
X Loss: -3.708026
Epoch 849 
Overall Loss: 13.143436
Rec Loss: 7.637066
KL Loss: 5.506369
Y Loss: 0.988847
T Loss: 10.899599
X Loss: -3.756956
Epoch 899 
Overall Loss: 13.149123
Rec Loss: 7.626049
KL Loss: 5.523074
Y Loss: 0.948777
T Loss: 10.930053
X Loss: -3.778393
Epoch 949 
Overall Loss: 13.121736
Rec Loss: 7.560795
KL Loss: 5.560941
Y Loss: 0.967930
T Loss: 10.902576
X Loss: -3.825747
Epoch 999 
Overall Loss: 13.092345
Rec Loss: 7.514332
KL Loss: 5.578013
Y Loss: 0.920795
T Loss: 10.921844
X Loss: -3.867909
Epoch 1049 
Overall Loss: 13.075000
Rec Loss: 7.484961
KL Loss: 5.590038
Y Loss: 0.931498
T Loss: 10.924008
X Loss: -3.904795
Epoch 1099 
Overall Loss: 13.084543
Rec Loss: 7.471520
KL Loss: 5.613023
Y Loss: 0.944431
T Loss: 10.914290
X Loss: -3.914985
Epoch 1149 
Overall Loss: 13.052220
Rec Loss: 7.433616
KL Loss: 5.618604
Y Loss: 0.918595
T Loss: 10.926596
X Loss: -3.952278
Epoch 1199 
Overall Loss: 13.039081
Rec Loss: 7.376913
KL Loss: 5.662168
Y Loss: 0.907055
T Loss: 10.913719
X Loss: -3.990334
Epoch 1249 
Overall Loss: 13.012821
Rec Loss: 7.367038
KL Loss: 5.645783
Y Loss: 0.918891
T Loss: 10.916783
X Loss: -4.009190
Epoch 1299 
Overall Loss: 13.015607
Rec Loss: 7.340663
KL Loss: 5.674944
Y Loss: 0.912722
T Loss: 10.926286
X Loss: -4.041984
Epoch 1349 
Overall Loss: 13.017370
Rec Loss: 7.321808
KL Loss: 5.695563
Y Loss: 0.915046
T Loss: 10.925916
X Loss: -4.061631
Epoch 1399 
Overall Loss: 13.003048
Rec Loss: 7.293164
KL Loss: 5.709884
Y Loss: 0.931046
T Loss: 10.933998
X Loss: -4.106357
Epoch 1449 
Overall Loss: 12.974694
Rec Loss: 7.260621
KL Loss: 5.714073
Y Loss: 0.894560
T Loss: 10.926844
X Loss: -4.113503
Epoch 1499 
Overall Loss: 12.952513
Rec Loss: 7.219575
KL Loss: 5.732938
Y Loss: 0.880352
T Loss: 10.921555
X Loss: -4.142157
Epoch 1549 
Overall Loss: 12.971149
Rec Loss: 7.215230
KL Loss: 5.755919
Y Loss: 0.896609
T Loss: 10.930940
X Loss: -4.164015
Epoch 1599 
Overall Loss: 12.944068
Rec Loss: 7.199964
KL Loss: 5.744105
Y Loss: 0.902047
T Loss: 10.940564
X Loss: -4.191624
Epoch 1649 
Overall Loss: 12.968707
Rec Loss: 7.180984
KL Loss: 5.787724
Y Loss: 0.907289
T Loss: 10.939096
X Loss: -4.211757
Epoch 1699 
Overall Loss: 12.918506
Rec Loss: 7.092601
KL Loss: 5.825905
Y Loss: 0.887742
T Loss: 10.936344
X Loss: -4.287613
Epoch 1749 
Overall Loss: 12.963722
Rec Loss: 7.141992
KL Loss: 5.821730
Y Loss: 0.880898
T Loss: 10.951434
X Loss: -4.249890
Epoch 1799 
Overall Loss: 12.908984
Rec Loss: 7.088867
KL Loss: 5.820117
Y Loss: 0.892353
T Loss: 10.939360
X Loss: -4.296670
Epoch 1849 
Overall Loss: 12.907347
Rec Loss: 7.095420
KL Loss: 5.811927
Y Loss: 0.889147
T Loss: 10.938337
X Loss: -4.287491
Epoch 1899 
Overall Loss: 12.924632
Rec Loss: 7.070021
KL Loss: 5.854611
Y Loss: 0.881148
T Loss: 10.950735
X Loss: -4.321288
Epoch 1949 
Overall Loss: 12.914926
Rec Loss: 7.050596
KL Loss: 5.864330
Y Loss: 0.874577
T Loss: 10.969256
X Loss: -4.355949
Epoch 1999 
Overall Loss: 12.911129
Rec Loss: 7.024611
KL Loss: 5.886518
Y Loss: 0.899113
T Loss: 10.968681
X Loss: -4.393627
Epoch 2049 
Overall Loss: 12.890228
Rec Loss: 6.983740
KL Loss: 5.906488
Y Loss: 0.861984
T Loss: 10.947808
X Loss: -4.395059
Epoch 2099 
Overall Loss: 12.907150
Rec Loss: 6.997319
KL Loss: 5.909831
Y Loss: 0.901374
T Loss: 10.961144
X Loss: -4.414512
Epoch 2149 
Overall Loss: 12.885871
Rec Loss: 6.956393
KL Loss: 5.929478
Y Loss: 0.881300
T Loss: 10.966513
X Loss: -4.450770
Epoch 2199 
Overall Loss: 12.879191
Rec Loss: 6.945241
KL Loss: 5.933950
Y Loss: 0.871604
T Loss: 10.970104
X Loss: -4.460664
Epoch 2249 
Overall Loss: 12.865562
Rec Loss: 6.924181
KL Loss: 5.941381
Y Loss: 0.884553
T Loss: 10.969691
X Loss: -4.487786
Epoch 2299 
Overall Loss: 12.886070
Rec Loss: 6.897931
KL Loss: 5.988139
Y Loss: 0.881611
T Loss: 10.974711
X Loss: -4.517585
Epoch 2349 
Overall Loss: 12.865472
Rec Loss: 6.888380
KL Loss: 5.977092
Y Loss: 0.866531
T Loss: 10.986980
X Loss: -4.531866
Epoch 2399 
Overall Loss: 12.848391
Rec Loss: 6.836257
KL Loss: 6.012134
Y Loss: 0.886189
T Loss: 10.971539
X Loss: -4.578377
Epoch 2449 
Overall Loss: 12.852935
Rec Loss: 6.836551
KL Loss: 6.016385
Y Loss: 0.901520
T Loss: 10.979059
X Loss: -4.593269
Epoch 2499 
Overall Loss: 12.883465
Rec Loss: 6.853741
KL Loss: 6.029724
Y Loss: 0.899333
T Loss: 10.999839
X Loss: -4.595764
Epoch 2549 
Overall Loss: 12.851467
Rec Loss: 6.801638
KL Loss: 6.049828
Y Loss: 0.878669
T Loss: 10.990228
X Loss: -4.627923
Epoch 2599 
Overall Loss: 12.837094
Rec Loss: 6.770160
KL Loss: 6.066933
Y Loss: 0.854476
T Loss: 11.004229
X Loss: -4.661307
Epoch 2649 
Overall Loss: 12.850888
Rec Loss: 6.794991
KL Loss: 6.055897
Y Loss: 0.862577
T Loss: 11.024378
X Loss: -4.660675
Epoch 2699 
Overall Loss: 12.839791
Rec Loss: 6.754575
KL Loss: 6.085216
Y Loss: 0.870735
T Loss: 11.000730
X Loss: -4.681523
Epoch 2749 
Overall Loss: 12.847558
Rec Loss: 6.735764
KL Loss: 6.111794
Y Loss: 0.861541
T Loss: 10.997984
X Loss: -4.692990
Epoch 2799 
Overall Loss: 12.834969
Rec Loss: 6.699562
KL Loss: 6.135407
Y Loss: 0.863681
T Loss: 11.021548
X Loss: -4.753826
Epoch 2849 
Overall Loss: 12.848122
Rec Loss: 6.703458
KL Loss: 6.144663
Y Loss: 0.879867
T Loss: 11.043720
X Loss: -4.780195
Epoch 2899 
Overall Loss: 12.853763
Rec Loss: 6.700541
KL Loss: 6.153223
Y Loss: 0.886287
T Loss: 11.023775
X Loss: -4.766378
Epoch 2949 
Overall Loss: 12.842168
Rec Loss: 6.650286
KL Loss: 6.191882
Y Loss: 0.882499
T Loss: 11.029095
X Loss: -4.820059
Epoch 2999 
Overall Loss: 12.817145
Rec Loss: 6.644487
KL Loss: 6.172658
Y Loss: 0.874884
T Loss: 11.033851
X Loss: -4.826806
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.568043
Epoch 99
Rec Loss: 1.553694
Epoch 149
Rec Loss: 1.553160
Epoch 199
Rec Loss: 1.556153
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.008176
Epoch 99
Rec Loss: 2.000091
Epoch 149
Rec Loss: 1.993803
Epoch 199
Rec Loss: 1.998511
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.649481
Insample Error 2.441401
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.873969
Epoch 99 
Prediction Loss: 1.766509
Epoch 149 
Prediction Loss: 1.661424
Epoch 199 
Prediction Loss: 1.569502
Epoch 249 
Prediction Loss: 1.481834
Epoch 299 
Prediction Loss: 1.441859
Epoch 349 
Prediction Loss: 1.359493
Epoch 399 
Prediction Loss: 1.272640
Epoch 449 
Prediction Loss: 1.248145
Epoch 499 
Prediction Loss: 1.163933
Epoch 549 
Prediction Loss: 1.080925
Epoch 599 
Prediction Loss: 1.028050
Epoch 649 
Prediction Loss: 0.992625
Epoch 699 
Prediction Loss: 0.954757
Epoch 749 
Prediction Loss: 0.912649
Epoch 799 
Prediction Loss: 0.875478
Epoch 849 
Prediction Loss: 0.852644
Epoch 899 
Prediction Loss: 0.825338
Epoch 949 
Prediction Loss: 0.790763
Epoch 999 
Prediction Loss: 0.800231
Epoch 1049 
Prediction Loss: 0.766247
Epoch 1099 
Prediction Loss: 0.784831
Epoch 1149 
Prediction Loss: 0.697370
Epoch 1199 
Prediction Loss: 0.702646
Epoch 1249 
Prediction Loss: 0.680991
Epoch 1299 
Prediction Loss: 0.669283
Epoch 1349 
Prediction Loss: 0.652432
Epoch 1399 
Prediction Loss: 0.629054
Epoch 1449 
Prediction Loss: 0.611491
Epoch 1499 
Prediction Loss: 0.605648
Epoch 1549 
Prediction Loss: 0.588682
Epoch 1599 
Prediction Loss: 0.600004
Epoch 1649 
Prediction Loss: 0.595761
Epoch 1699 
Prediction Loss: 0.572179
Epoch 1749 
Prediction Loss: 0.566502
Epoch 1799 
Prediction Loss: 0.577775
Epoch 1849 
Prediction Loss: 0.558200
Epoch 1899 
Prediction Loss: 0.539353
Epoch 1949 
Prediction Loss: 0.542431
Epoch 1999 
Prediction Loss: 0.515058
Epoch 2049 
Prediction Loss: 0.520597
Epoch 2099 
Prediction Loss: 0.517497
Epoch 2149 
Prediction Loss: 0.529385
Epoch 2199 
Prediction Loss: 0.513452
Epoch 2249 
Prediction Loss: 0.506202
Epoch 2299 
Prediction Loss: 0.502533
Epoch 2349 
Prediction Loss: 0.503193
Epoch 2399 
Prediction Loss: 0.487119
Epoch 2449 
Prediction Loss: 0.488901
Epoch 2499 
Prediction Loss: 0.484948
Epoch 2549 
Prediction Loss: 0.484161
Epoch 2599 
Prediction Loss: 0.489976
Epoch 2649 
Prediction Loss: 0.478598
Epoch 2699 
Prediction Loss: 0.499738
Epoch 2749 
Prediction Loss: 0.463380
Epoch 2799 
Prediction Loss: 0.464684
Epoch 2849 
Prediction Loss: 0.472366
Epoch 2899 
Prediction Loss: 0.464457
Epoch 2949 
Prediction Loss: 0.464902
Epoch 2999 
Prediction Loss: 0.450097
Epoch 3049 
Prediction Loss: 0.447640
Epoch 3099 
Prediction Loss: 0.442369
Epoch 3149 
Prediction Loss: 0.465339
Epoch 3199 
Prediction Loss: 0.437377
Epoch 3249 
Prediction Loss: 0.460565
Epoch 3299 
Prediction Loss: 0.454522
Epoch 3349 
Prediction Loss: 0.443181
Epoch 3399 
Prediction Loss: 0.469317
Epoch 3449 
Prediction Loss: 0.451989
Epoch 3499 
Prediction Loss: 0.445595
Epoch 3549 
Prediction Loss: 0.424931
Epoch 3599 
Prediction Loss: 0.431131
Epoch 3649 
Prediction Loss: 0.421751
Epoch 3699 
Prediction Loss: 0.416866
Epoch 3749 
Prediction Loss: 0.454596
Epoch 3799 
Prediction Loss: 0.435310
Epoch 3849 
Prediction Loss: 0.421877
Epoch 3899 
Prediction Loss: 0.413489
Epoch 3949 
Prediction Loss: 0.404642
Epoch 3999 
Prediction Loss: 0.421228
Epoch 4049 
Prediction Loss: 0.417067
Epoch 4099 
Prediction Loss: 0.420647
Epoch 4149 
Prediction Loss: 0.422787
Epoch 4199 
Prediction Loss: 0.401717
Epoch 4249 
Prediction Loss: 0.401976
Epoch 4299 
Prediction Loss: 0.407306
Epoch 4349 
Prediction Loss: 0.410829
Epoch 4399 
Prediction Loss: 0.395781
Epoch 4449 
Prediction Loss: 0.402853
Epoch 4499 
Prediction Loss: 0.394436
Epoch 4549 
Prediction Loss: 0.410718
Epoch 4599 
Prediction Loss: 0.386829
Epoch 4649 
Prediction Loss: 0.407585
Epoch 4699 
Prediction Loss: 0.424013
Epoch 4749 
Prediction Loss: 0.384492
Epoch 4799 
Prediction Loss: 0.394783
Epoch 4849 
Prediction Loss: 0.394389
Epoch 4899 
Prediction Loss: 0.392572
Epoch 4949 
Prediction Loss: 0.383798
Epoch 4999 
Prediction Loss: 0.419306
Epoch 5049 
Prediction Loss: 0.383488
Epoch 5099 
Prediction Loss: 0.389048
Epoch 5149 
Prediction Loss: 0.398211
Epoch 5199 
Prediction Loss: 0.398250
Epoch 5249 
Prediction Loss: 0.383576
Epoch 5299 
Prediction Loss: 0.384023
Epoch 5349 
Prediction Loss: 0.391083
Epoch 5399 
Prediction Loss: 0.393126
Epoch 5449 
Prediction Loss: 0.377768
Epoch 5499 
Prediction Loss: 0.388212
Epoch 5549 
Prediction Loss: 0.375964
Epoch 5599 
Prediction Loss: 0.390718
Epoch 5649 
Prediction Loss: 0.373402
Epoch 5699 
Prediction Loss: 0.381996
Epoch 5749 
Prediction Loss: 0.374062
Epoch 5799 
Prediction Loss: 0.371210
Epoch 5849 
Prediction Loss: 0.377221
Epoch 5899 
Prediction Loss: 0.388478
Epoch 5949 
Prediction Loss: 0.373564
Epoch 5999 
Prediction Loss: 0.374327
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.597383
Insample Error 2.986861
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.791997
Rec Loss: 11.311547
KL Loss: 1.480449
Y Loss: 1.009118
T Loss: 10.806989
Epoch 99 
Overall Loss: 12.432205
Rec Loss: 10.844397
KL Loss: 1.587809
Y Loss: 0.859778
T Loss: 10.414508
Epoch 149 
Overall Loss: 12.344040
Rec Loss: 10.826838
KL Loss: 1.517203
Y Loss: 0.838342
T Loss: 10.407666
Epoch 199 
Overall Loss: 12.297852
Rec Loss: 10.857161
KL Loss: 1.440691
Y Loss: 0.842058
T Loss: 10.436133
Epoch 249 
Overall Loss: 12.274049
Rec Loss: 10.845798
KL Loss: 1.428251
Y Loss: 0.841364
T Loss: 10.425116
Epoch 299 
Overall Loss: 12.264924
Rec Loss: 10.833113
KL Loss: 1.431811
Y Loss: 0.833310
T Loss: 10.416458
Epoch 349 
Overall Loss: 12.227909
Rec Loss: 10.812406
KL Loss: 1.415503
Y Loss: 0.818746
T Loss: 10.403033
Epoch 399 
Overall Loss: 12.233411
Rec Loss: 10.827770
KL Loss: 1.405640
Y Loss: 0.815719
T Loss: 10.419911
Epoch 449 
Overall Loss: 12.225343
Rec Loss: 10.839186
KL Loss: 1.386156
Y Loss: 0.827834
T Loss: 10.425269
Epoch 499 
Overall Loss: 12.199392
Rec Loss: 10.810886
KL Loss: 1.388506
Y Loss: 0.798134
T Loss: 10.411819
Epoch 549 
Overall Loss: 12.206420
Rec Loss: 10.823568
KL Loss: 1.382853
Y Loss: 0.809641
T Loss: 10.418747
Epoch 599 
Overall Loss: 12.191255
Rec Loss: 10.805048
KL Loss: 1.386207
Y Loss: 0.791128
T Loss: 10.409484
Epoch 649 
Overall Loss: 12.185549
Rec Loss: 10.790355
KL Loss: 1.395194
Y Loss: 0.786714
T Loss: 10.396998
Epoch 699 
Overall Loss: 12.203060
Rec Loss: 10.823772
KL Loss: 1.379288
Y Loss: 0.806628
T Loss: 10.420458
Epoch 749 
Overall Loss: 12.153556
Rec Loss: 10.783948
KL Loss: 1.369608
Y Loss: 0.789402
T Loss: 10.389247
Epoch 799 
Overall Loss: 12.163905
Rec Loss: 10.791369
KL Loss: 1.372536
Y Loss: 0.782562
T Loss: 10.400089
Epoch 849 
Overall Loss: 12.150166
Rec Loss: 10.776756
KL Loss: 1.373409
Y Loss: 0.784278
T Loss: 10.384617
Epoch 899 
Overall Loss: 12.162756
Rec Loss: 10.802326
KL Loss: 1.360430
Y Loss: 0.800377
T Loss: 10.402137
Epoch 949 
Overall Loss: 12.155132
Rec Loss: 10.788727
KL Loss: 1.366405
Y Loss: 0.785999
T Loss: 10.395727
Epoch 999 
Overall Loss: 12.139938
Rec Loss: 10.783195
KL Loss: 1.356743
Y Loss: 0.793144
T Loss: 10.386623
Epoch 1049 
Overall Loss: 12.142830
Rec Loss: 10.795681
KL Loss: 1.347149
Y Loss: 0.776712
T Loss: 10.407325
Epoch 1099 
Overall Loss: 12.114124
Rec Loss: 10.756470
KL Loss: 1.357654
Y Loss: 0.750709
T Loss: 10.381115
Epoch 1149 
Overall Loss: 12.134597
Rec Loss: 10.785594
KL Loss: 1.349003
Y Loss: 0.781350
T Loss: 10.394920
Epoch 1199 
Overall Loss: 12.121822
Rec Loss: 10.769308
KL Loss: 1.352514
Y Loss: 0.774165
T Loss: 10.382225
Epoch 1249 
Overall Loss: 12.137090
Rec Loss: 10.786709
KL Loss: 1.350382
Y Loss: 0.776533
T Loss: 10.398442
Epoch 1299 
Overall Loss: 12.113824
Rec Loss: 10.761423
KL Loss: 1.352401
Y Loss: 0.769790
T Loss: 10.376528
Epoch 1349 
Overall Loss: 12.095312
Rec Loss: 10.754437
KL Loss: 1.340876
Y Loss: 0.761827
T Loss: 10.373523
Epoch 1399 
Overall Loss: 12.099752
Rec Loss: 10.753354
KL Loss: 1.346398
Y Loss: 0.756536
T Loss: 10.375086
Epoch 1449 
Overall Loss: 12.106270
Rec Loss: 10.744915
KL Loss: 1.361355
Y Loss: 0.759553
T Loss: 10.365138
Epoch 1499 
Overall Loss: 12.112376
Rec Loss: 10.758717
KL Loss: 1.353659
Y Loss: 0.769330
T Loss: 10.374052
Epoch 1549 
Overall Loss: 12.071000
Rec Loss: 10.726723
KL Loss: 1.344276
Y Loss: 0.751496
T Loss: 10.350975
Epoch 1599 
Overall Loss: 12.073968
Rec Loss: 10.743867
KL Loss: 1.330101
Y Loss: 0.752828
T Loss: 10.367453
Epoch 1649 
Overall Loss: 12.081915
Rec Loss: 10.735158
KL Loss: 1.346757
Y Loss: 0.753089
T Loss: 10.358613
Epoch 1699 
Overall Loss: 12.080629
Rec Loss: 10.727457
KL Loss: 1.353172
Y Loss: 0.726829
T Loss: 10.364042
Epoch 1749 
Overall Loss: 12.078639
Rec Loss: 10.733683
KL Loss: 1.344956
Y Loss: 0.772935
T Loss: 10.347215
Epoch 1799 
Overall Loss: 12.068562
Rec Loss: 10.719290
KL Loss: 1.349272
Y Loss: 0.748662
T Loss: 10.344959
Epoch 1849 
Overall Loss: 12.049197
Rec Loss: 10.709998
KL Loss: 1.339200
Y Loss: 0.744548
T Loss: 10.337724
Epoch 1899 
Overall Loss: 12.071580
Rec Loss: 10.720976
KL Loss: 1.350604
Y Loss: 0.753180
T Loss: 10.344386
Epoch 1949 
Overall Loss: 12.051632
Rec Loss: 10.707050
KL Loss: 1.344582
Y Loss: 0.736401
T Loss: 10.338849
Epoch 1999 
Overall Loss: 12.041733
Rec Loss: 10.703432
KL Loss: 1.338301
Y Loss: 0.754134
T Loss: 10.326365
Epoch 2049 
Overall Loss: 12.036150
Rec Loss: 10.679172
KL Loss: 1.356978
Y Loss: 0.733447
T Loss: 10.312449
Epoch 2099 
Overall Loss: 12.048270
Rec Loss: 10.719703
KL Loss: 1.328567
Y Loss: 0.747126
T Loss: 10.346140
Epoch 2149 
Overall Loss: 12.028307
Rec Loss: 10.676195
KL Loss: 1.352111
Y Loss: 0.714389
T Loss: 10.319001
Epoch 2199 
Overall Loss: 12.030496
Rec Loss: 10.699824
KL Loss: 1.330672
Y Loss: 0.727622
T Loss: 10.336013
Epoch 2249 
Overall Loss: 12.001326
Rec Loss: 10.682112
KL Loss: 1.319214
Y Loss: 0.728437
T Loss: 10.317893
Epoch 2299 
Overall Loss: 12.029853
Rec Loss: 10.696067
KL Loss: 1.333786
Y Loss: 0.738352
T Loss: 10.326891
Epoch 2349 
Overall Loss: 12.013111
Rec Loss: 10.674087
KL Loss: 1.339024
Y Loss: 0.744770
T Loss: 10.301702
Epoch 2399 
Overall Loss: 12.028057
Rec Loss: 10.678312
KL Loss: 1.349745
Y Loss: 0.717561
T Loss: 10.319532
Epoch 2449 
Overall Loss: 12.034645
Rec Loss: 10.701418
KL Loss: 1.333227
Y Loss: 0.767108
T Loss: 10.317864
Epoch 2499 
Overall Loss: 12.023337
Rec Loss: 10.687589
KL Loss: 1.335748
Y Loss: 0.733553
T Loss: 10.320812
Epoch 2549 
Overall Loss: 12.015490
Rec Loss: 10.687729
KL Loss: 1.327761
Y Loss: 0.754557
T Loss: 10.310450
Epoch 2599 
Overall Loss: 11.998058
Rec Loss: 10.682810
KL Loss: 1.315247
Y Loss: 0.729864
T Loss: 10.317878
Epoch 2649 
Overall Loss: 12.004039
Rec Loss: 10.647809
KL Loss: 1.356230
Y Loss: 0.714652
T Loss: 10.290483
Epoch 2699 
Overall Loss: 12.008991
Rec Loss: 10.664025
KL Loss: 1.344965
Y Loss: 0.736386
T Loss: 10.295832
Epoch 2749 
Overall Loss: 12.023885
Rec Loss: 10.659293
KL Loss: 1.364592
Y Loss: 0.721532
T Loss: 10.298527
Epoch 2799 
Overall Loss: 11.999147
Rec Loss: 10.674113
KL Loss: 1.325033
Y Loss: 0.725854
T Loss: 10.311187
Epoch 2849 
Overall Loss: 12.008479
Rec Loss: 10.672988
KL Loss: 1.335491
Y Loss: 0.721838
T Loss: 10.312070
Epoch 2899 
Overall Loss: 11.987677
Rec Loss: 10.644062
KL Loss: 1.343615
Y Loss: 0.725540
T Loss: 10.281292
Epoch 2949 
Overall Loss: 11.982394
Rec Loss: 10.669454
KL Loss: 1.312939
Y Loss: 0.723356
T Loss: 10.307777
Epoch 2999 
Overall Loss: 11.994757
Rec Loss: 10.656119
KL Loss: 1.338638
Y Loss: 0.746090
T Loss: 10.283074
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.829507
Epoch 99
Rec Loss: 0.822142
Epoch 149
Rec Loss: 0.827758
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.945497
Epoch 99
Rec Loss: 9.906892
Epoch 149
Rec Loss: 9.904060
Epoch 199
Rec Loss: 9.894325
Epoch 249
Rec Loss: 9.882364
Epoch 299
Rec Loss: 9.848833
Epoch 349
Rec Loss: 9.870187
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.673195
Insample Error: 1.804727
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.645823
Rec Loss: 20.097843
KL Loss: 2.547980
Y Loss: 9.403795
T Loss: 13.093911
X Loss: 2.302035
Epoch 99 
Overall Loss: 17.379911
Rec Loss: 13.818424
KL Loss: 3.561487
Y Loss: 2.857623
T Loss: 12.909599
X Loss: -0.519987
Epoch 149 
Overall Loss: 16.258633
Rec Loss: 12.601658
KL Loss: 3.656975
Y Loss: 1.858037
T Loss: 12.842334
X Loss: -1.169694
Epoch 199 
Overall Loss: 15.303478
Rec Loss: 11.595258
KL Loss: 3.708221
Y Loss: 1.300942
T Loss: 12.688757
X Loss: -1.743971
Epoch 249 
Overall Loss: 14.665497
Rec Loss: 10.895408
KL Loss: 3.770090
Y Loss: 1.090990
T Loss: 12.476108
X Loss: -2.126195
Epoch 299 
Overall Loss: 14.315645
Rec Loss: 10.358101
KL Loss: 3.957543
Y Loss: 1.049281
T Loss: 12.162854
X Loss: -2.329392
Epoch 349 
Overall Loss: 14.087684
Rec Loss: 9.960313
KL Loss: 4.127371
Y Loss: 1.034821
T Loss: 11.903730
X Loss: -2.460827
Epoch 399 
Overall Loss: 13.937380
Rec Loss: 9.646179
KL Loss: 4.291201
Y Loss: 1.005989
T Loss: 11.710672
X Loss: -2.567488
Epoch 449 
Overall Loss: 13.821729
Rec Loss: 9.389677
KL Loss: 4.432051
Y Loss: 0.984596
T Loss: 11.584399
X Loss: -2.687019
Epoch 499 
Overall Loss: 13.682455
Rec Loss: 9.134786
KL Loss: 4.547670
Y Loss: 0.968588
T Loss: 11.458721
X Loss: -2.808230
Epoch 549 
Overall Loss: 13.616112
Rec Loss: 9.008464
KL Loss: 4.607648
Y Loss: 1.002273
T Loss: 11.393019
X Loss: -2.885691
Epoch 599 
Overall Loss: 13.534460
Rec Loss: 8.803186
KL Loss: 4.731274
Y Loss: 0.981055
T Loss: 11.325746
X Loss: -3.013088
Epoch 649 
Overall Loss: 13.354951
Rec Loss: 8.288774
KL Loss: 5.066178
Y Loss: 0.962993
T Loss: 11.102558
X Loss: -3.295280
Epoch 699 
Overall Loss: 13.228569
Rec Loss: 7.848241
KL Loss: 5.380328
Y Loss: 0.954777
T Loss: 10.955270
X Loss: -3.584417
Epoch 749 
Overall Loss: 13.163178
Rec Loss: 7.715697
KL Loss: 5.447481
Y Loss: 0.963287
T Loss: 10.907618
X Loss: -3.673564
Epoch 799 
Overall Loss: 13.147649
Rec Loss: 7.631992
KL Loss: 5.515657
Y Loss: 0.942944
T Loss: 10.912933
X Loss: -3.752413
Epoch 849 
Overall Loss: 13.097876
Rec Loss: 7.560152
KL Loss: 5.537725
Y Loss: 0.924025
T Loss: 10.907923
X Loss: -3.809784
Epoch 899 
Overall Loss: 13.092782
Rec Loss: 7.527569
KL Loss: 5.565213
Y Loss: 0.915454
T Loss: 10.933654
X Loss: -3.863813
Epoch 949 
Overall Loss: 13.057932
Rec Loss: 7.453404
KL Loss: 5.604527
Y Loss: 0.907306
T Loss: 10.916307
X Loss: -3.916556
Epoch 999 
Overall Loss: 13.054383
Rec Loss: 7.414044
KL Loss: 5.640338
Y Loss: 0.905494
T Loss: 10.923699
X Loss: -3.962402
Epoch 1049 
Overall Loss: 13.046772
Rec Loss: 7.397320
KL Loss: 5.649452
Y Loss: 0.905732
T Loss: 10.927450
X Loss: -3.982995
Epoch 1099 
Overall Loss: 13.016351
Rec Loss: 7.337097
KL Loss: 5.679254
Y Loss: 0.883483
T Loss: 10.930582
X Loss: -4.035227
Epoch 1149 
Overall Loss: 12.990569
Rec Loss: 7.245938
KL Loss: 5.744632
Y Loss: 0.887495
T Loss: 10.913710
X Loss: -4.111520
Epoch 1199 
Overall Loss: 12.983716
Rec Loss: 7.250914
KL Loss: 5.732802
Y Loss: 0.898276
T Loss: 10.916677
X Loss: -4.114901
Epoch 1249 
Overall Loss: 13.033237
Rec Loss: 7.253935
KL Loss: 5.779302
Y Loss: 0.905854
T Loss: 10.950994
X Loss: -4.149985
Epoch 1299 
Overall Loss: 12.992313
Rec Loss: 7.200016
KL Loss: 5.792297
Y Loss: 0.881799
T Loss: 10.956274
X Loss: -4.197157
Epoch 1349 
Overall Loss: 12.947971
Rec Loss: 7.150434
KL Loss: 5.797537
Y Loss: 0.877972
T Loss: 10.966633
X Loss: -4.255185
Epoch 1399 
Overall Loss: 12.967221
Rec Loss: 7.130499
KL Loss: 5.836722
Y Loss: 0.884746
T Loss: 10.965688
X Loss: -4.277562
Epoch 1449 
Overall Loss: 12.962452
Rec Loss: 7.096899
KL Loss: 5.865553
Y Loss: 0.881481
T Loss: 10.975251
X Loss: -4.319092
Epoch 1499 
Overall Loss: 12.967261
Rec Loss: 7.098871
KL Loss: 5.868390
Y Loss: 0.896401
T Loss: 10.977320
X Loss: -4.326651
Epoch 1549 
Overall Loss: 12.927589
Rec Loss: 7.034359
KL Loss: 5.893230
Y Loss: 0.886463
T Loss: 10.973646
X Loss: -4.382519
Epoch 1599 
Overall Loss: 12.925220
Rec Loss: 6.992128
KL Loss: 5.933092
Y Loss: 0.885832
T Loss: 10.980663
X Loss: -4.431451
Epoch 1649 
Overall Loss: 12.953199
Rec Loss: 7.004229
KL Loss: 5.948970
Y Loss: 0.884633
T Loss: 11.004308
X Loss: -4.442396
Epoch 1699 
Overall Loss: 12.932905
Rec Loss: 6.967674
KL Loss: 5.965231
Y Loss: 0.892400
T Loss: 11.005540
X Loss: -4.484066
Epoch 1749 
Overall Loss: 12.928673
Rec Loss: 6.969186
KL Loss: 5.959487
Y Loss: 0.883300
T Loss: 11.004025
X Loss: -4.476489
Epoch 1799 
Overall Loss: 12.931574
Rec Loss: 6.922488
KL Loss: 6.009086
Y Loss: 0.894010
T Loss: 10.999432
X Loss: -4.523949
Epoch 1849 
Overall Loss: 12.880019
Rec Loss: 6.889569
KL Loss: 5.990450
Y Loss: 0.882853
T Loss: 11.025330
X Loss: -4.577187
Epoch 1899 
Overall Loss: 12.909201
Rec Loss: 6.869097
KL Loss: 6.040104
Y Loss: 0.922996
T Loss: 11.008328
X Loss: -4.600729
Epoch 1949 
Overall Loss: 12.898060
Rec Loss: 6.840970
KL Loss: 6.057090
Y Loss: 0.905288
T Loss: 11.014051
X Loss: -4.625724
Epoch 1999 
Overall Loss: 12.843860
Rec Loss: 6.766496
KL Loss: 6.077364
Y Loss: 0.878255
T Loss: 10.997917
X Loss: -4.670549
Epoch 2049 
Overall Loss: 12.841849
Rec Loss: 6.744148
KL Loss: 6.097701
Y Loss: 0.857526
T Loss: 11.002410
X Loss: -4.687025
Epoch 2099 
Overall Loss: 12.888120
Rec Loss: 6.754750
KL Loss: 6.133370
Y Loss: 0.881814
T Loss: 11.018036
X Loss: -4.704193
Epoch 2149 
Overall Loss: 12.859064
Rec Loss: 6.722015
KL Loss: 6.137049
Y Loss: 0.875691
T Loss: 11.025552
X Loss: -4.741383
Epoch 2199 
Overall Loss: 12.887232
Rec Loss: 6.730398
KL Loss: 6.156834
Y Loss: 0.883701
T Loss: 11.031011
X Loss: -4.742463
Epoch 2249 
Overall Loss: 12.822525
Rec Loss: 6.662965
KL Loss: 6.159560
Y Loss: 0.882569
T Loss: 11.028026
X Loss: -4.806345
Epoch 2299 
Overall Loss: 12.846344
Rec Loss: 6.678405
KL Loss: 6.167939
Y Loss: 0.876253
T Loss: 11.041991
X Loss: -4.801712
Epoch 2349 
Overall Loss: 12.843849
Rec Loss: 6.637095
KL Loss: 6.206753
Y Loss: 0.864844
T Loss: 11.032092
X Loss: -4.827419
Epoch 2399 
Overall Loss: 12.862756
Rec Loss: 6.646540
KL Loss: 6.216215
Y Loss: 0.882617
T Loss: 11.038172
X Loss: -4.832940
Epoch 2449 
Overall Loss: 12.817708
Rec Loss: 6.583406
KL Loss: 6.234302
Y Loss: 0.869112
T Loss: 11.028899
X Loss: -4.880049
Epoch 2499 
Overall Loss: 12.844657
Rec Loss: 6.589956
KL Loss: 6.254700
Y Loss: 0.865990
T Loss: 11.035445
X Loss: -4.878484
Epoch 2549 
Overall Loss: 12.830129
Rec Loss: 6.558801
KL Loss: 6.271328
Y Loss: 0.861627
T Loss: 11.039904
X Loss: -4.911917
Epoch 2599 
Overall Loss: 12.826948
Rec Loss: 6.575776
KL Loss: 6.251172
Y Loss: 0.880772
T Loss: 11.052373
X Loss: -4.916983
Epoch 2649 
Overall Loss: 12.854203
Rec Loss: 6.529607
KL Loss: 6.324596
Y Loss: 0.883971
T Loss: 11.041711
X Loss: -4.954089
Epoch 2699 
Overall Loss: 12.850977
Rec Loss: 6.564615
KL Loss: 6.286363
Y Loss: 0.891044
T Loss: 11.052156
X Loss: -4.933064
Epoch 2749 
Overall Loss: 12.839661
Rec Loss: 6.509524
KL Loss: 6.330137
Y Loss: 0.892197
T Loss: 11.040954
X Loss: -4.977529
Epoch 2799 
Overall Loss: 12.832907
Rec Loss: 6.483168
KL Loss: 6.349739
Y Loss: 0.866880
T Loss: 11.052290
X Loss: -5.002562
Epoch 2849 
Overall Loss: 12.854190
Rec Loss: 6.507628
KL Loss: 6.346563
Y Loss: 0.870790
T Loss: 11.071684
X Loss: -4.999451
Epoch 2899 
Overall Loss: 12.849273
Rec Loss: 6.469772
KL Loss: 6.379501
Y Loss: 0.879775
T Loss: 11.061940
X Loss: -5.032056
Epoch 2949 
Overall Loss: 12.801112
Rec Loss: 6.433766
KL Loss: 6.367346
Y Loss: 0.892610
T Loss: 11.056922
X Loss: -5.069461
Epoch 2999 
Overall Loss: 12.806989
Rec Loss: 6.416935
KL Loss: 6.390054
Y Loss: 0.880316
T Loss: 11.056457
X Loss: -5.079679
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.494118
Epoch 99
Rec Loss: 1.483758
Epoch 149
Rec Loss: 1.478024
Epoch 199
Rec Loss: 1.481402
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.011030
Epoch 99
Rec Loss: 2.008212
Epoch 149
Rec Loss: 1.999940
Epoch 199
Rec Loss: 1.997070
Epoch 249
Rec Loss: 2.006958
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.659918
Insample Error 2.365533
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.957982
Epoch 99 
Prediction Loss: 1.782569
Epoch 149 
Prediction Loss: 1.647372
Epoch 199 
Prediction Loss: 1.563220
Epoch 249 
Prediction Loss: 1.488740
Epoch 299 
Prediction Loss: 1.411540
Epoch 349 
Prediction Loss: 1.333818
Epoch 399 
Prediction Loss: 1.306959
Epoch 449 
Prediction Loss: 1.218546
Epoch 499 
Prediction Loss: 1.163286
Epoch 549 
Prediction Loss: 1.092919
Epoch 599 
Prediction Loss: 1.094552
Epoch 649 
Prediction Loss: 1.015745
Epoch 699 
Prediction Loss: 0.949365
Epoch 749 
Prediction Loss: 0.954649
Epoch 799 
Prediction Loss: 0.906504
Epoch 849 
Prediction Loss: 0.873952
Epoch 899 
Prediction Loss: 0.830979
Epoch 949 
Prediction Loss: 0.824210
Epoch 999 
Prediction Loss: 0.794985
Epoch 1049 
Prediction Loss: 0.744883
Epoch 1099 
Prediction Loss: 0.752893
Epoch 1149 
Prediction Loss: 0.745041
Epoch 1199 
Prediction Loss: 0.728638
Epoch 1249 
Prediction Loss: 0.703504
Epoch 1299 
Prediction Loss: 0.679802
Epoch 1349 
Prediction Loss: 0.705077
Epoch 1399 
Prediction Loss: 0.657709
Epoch 1449 
Prediction Loss: 0.648576
Epoch 1499 
Prediction Loss: 0.676768
Epoch 1549 
Prediction Loss: 0.656001
Epoch 1599 
Prediction Loss: 0.631031
Epoch 1649 
Prediction Loss: 0.597333
Epoch 1699 
Prediction Loss: 0.619096
Epoch 1749 
Prediction Loss: 0.586742
Epoch 1799 
Prediction Loss: 0.587549
Epoch 1849 
Prediction Loss: 0.584501
Epoch 1899 
Prediction Loss: 0.594975
Epoch 1949 
Prediction Loss: 0.560100
Epoch 1999 
Prediction Loss: 0.597973
Epoch 2049 
Prediction Loss: 0.543406
Epoch 2099 
Prediction Loss: 0.540001
Epoch 2149 
Prediction Loss: 0.536478
Epoch 2199 
Prediction Loss: 0.549807
Epoch 2249 
Prediction Loss: 0.557851
Epoch 2299 
Prediction Loss: 0.524013
Epoch 2349 
Prediction Loss: 0.535572
Epoch 2399 
Prediction Loss: 0.512647
Epoch 2449 
Prediction Loss: 0.510280
Epoch 2499 
Prediction Loss: 0.510677
Epoch 2549 
Prediction Loss: 0.489418
Epoch 2599 
Prediction Loss: 0.506379
Epoch 2649 
Prediction Loss: 0.525792
Epoch 2699 
Prediction Loss: 0.492230
Epoch 2749 
Prediction Loss: 0.478446
Epoch 2799 
Prediction Loss: 0.478600
Epoch 2849 
Prediction Loss: 0.467261
Epoch 2899 
Prediction Loss: 0.470353
Epoch 2949 
Prediction Loss: 0.465977
Epoch 2999 
Prediction Loss: 0.475972
Epoch 3049 
Prediction Loss: 0.470536
Epoch 3099 
Prediction Loss: 0.451253
Epoch 3149 
Prediction Loss: 0.457798
Epoch 3199 
Prediction Loss: 0.452039
Epoch 3249 
Prediction Loss: 0.459772
Epoch 3299 
Prediction Loss: 0.445837
Epoch 3349 
Prediction Loss: 0.460041
Epoch 3399 
Prediction Loss: 0.500277
Epoch 3449 
Prediction Loss: 0.446794
Epoch 3499 
Prediction Loss: 0.437950
Epoch 3549 
Prediction Loss: 0.453326
Epoch 3599 
Prediction Loss: 0.424306
Epoch 3649 
Prediction Loss: 0.429822
Epoch 3699 
Prediction Loss: 0.429201
Epoch 3749 
Prediction Loss: 0.426344
Epoch 3799 
Prediction Loss: 0.425075
Epoch 3849 
Prediction Loss: 0.418220
Epoch 3899 
Prediction Loss: 0.409451
Epoch 3949 
Prediction Loss: 0.451331
Epoch 3999 
Prediction Loss: 0.419141
Epoch 4049 
Prediction Loss: 0.417120
Epoch 4099 
Prediction Loss: 0.414550
Epoch 4149 
Prediction Loss: 0.427856
Epoch 4199 
Prediction Loss: 0.403196
Epoch 4249 
Prediction Loss: 0.399483
Epoch 4299 
Prediction Loss: 0.414526
Epoch 4349 
Prediction Loss: 0.417622
Epoch 4399 
Prediction Loss: 0.403643
Epoch 4449 
Prediction Loss: 0.399339
Epoch 4499 
Prediction Loss: 0.433167
Epoch 4549 
Prediction Loss: 0.394643
Epoch 4599 
Prediction Loss: 0.398070
Epoch 4649 
Prediction Loss: 0.391042
Epoch 4699 
Prediction Loss: 0.403938
Epoch 4749 
Prediction Loss: 0.394858
Epoch 4799 
Prediction Loss: 0.387208
Epoch 4849 
Prediction Loss: 0.400437
Epoch 4899 
Prediction Loss: 0.406045
Epoch 4949 
Prediction Loss: 0.390785
Epoch 4999 
Prediction Loss: 0.383897
Epoch 5049 
Prediction Loss: 0.394349
Epoch 5099 
Prediction Loss: 0.379306
Epoch 5149 
Prediction Loss: 0.385227
Epoch 5199 
Prediction Loss: 0.374705
Epoch 5249 
Prediction Loss: 0.387688
Epoch 5299 
Prediction Loss: 0.380435
Epoch 5349 
Prediction Loss: 0.390034
Epoch 5399 
Prediction Loss: 0.381217
Epoch 5449 
Prediction Loss: 0.394202
Epoch 5499 
Prediction Loss: 0.405808
Epoch 5549 
Prediction Loss: 0.386464
Epoch 5599 
Prediction Loss: 0.389066
Epoch 5649 
Prediction Loss: 0.386915
Epoch 5699 
Prediction Loss: 0.399325
Epoch 5749 
Prediction Loss: 0.388145
Epoch 5799 
Prediction Loss: 0.372923
Epoch 5849 
Prediction Loss: 0.367036
Epoch 5899 
Prediction Loss: 0.380297
Epoch 5949 
Prediction Loss: 0.374039
Epoch 5999 
Prediction Loss: 0.375223
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.610657
Insample Error 3.054207
[31m========== repeat time 4 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.652684
Rec Loss: 10.956996
KL Loss: 1.695688
Y Loss: 0.958218
T Loss: 10.477887
Epoch 99 
Overall Loss: 12.458522
Rec Loss: 10.843429
KL Loss: 1.615093
Y Loss: 0.906540
T Loss: 10.390159
Epoch 149 
Overall Loss: 12.376157
Rec Loss: 10.830150
KL Loss: 1.546007
Y Loss: 0.874147
T Loss: 10.393076
Epoch 199 
Overall Loss: 12.292837
Rec Loss: 10.814299
KL Loss: 1.478537
Y Loss: 0.843889
T Loss: 10.392355
Epoch 249 
Overall Loss: 12.259040
Rec Loss: 10.794529
KL Loss: 1.464511
Y Loss: 0.836145
T Loss: 10.376457
Epoch 299 
Overall Loss: 12.244638
Rec Loss: 10.816137
KL Loss: 1.428501
Y Loss: 0.825435
T Loss: 10.403420
Epoch 349 
Overall Loss: 12.243306
Rec Loss: 10.817624
KL Loss: 1.425682
Y Loss: 0.820730
T Loss: 10.407259
Epoch 399 
Overall Loss: 12.215304
Rec Loss: 10.801558
KL Loss: 1.413746
Y Loss: 0.818085
T Loss: 10.392516
Epoch 449 
Overall Loss: 12.203063
Rec Loss: 10.812890
KL Loss: 1.390173
Y Loss: 0.822672
T Loss: 10.401554
Epoch 499 
Overall Loss: 12.226843
Rec Loss: 10.842804
KL Loss: 1.384038
Y Loss: 0.831683
T Loss: 10.426963
Epoch 549 
Overall Loss: 12.199566
Rec Loss: 10.811566
KL Loss: 1.388000
Y Loss: 0.800006
T Loss: 10.411562
Epoch 599 
Overall Loss: 12.198710
Rec Loss: 10.787435
KL Loss: 1.411275
Y Loss: 0.799100
T Loss: 10.387884
Epoch 649 
Overall Loss: 12.176604
Rec Loss: 10.795664
KL Loss: 1.380940
Y Loss: 0.794457
T Loss: 10.398435
Epoch 699 
Overall Loss: 12.188269
Rec Loss: 10.797914
KL Loss: 1.390356
Y Loss: 0.800068
T Loss: 10.397879
Epoch 749 
Overall Loss: 12.184962
Rec Loss: 10.784816
KL Loss: 1.400146
Y Loss: 0.801022
T Loss: 10.384305
Epoch 799 
Overall Loss: 12.167171
Rec Loss: 10.792977
KL Loss: 1.374193
Y Loss: 0.792045
T Loss: 10.396955
Epoch 849 
Overall Loss: 12.163326
Rec Loss: 10.786805
KL Loss: 1.376520
Y Loss: 0.786601
T Loss: 10.393505
Epoch 899 
Overall Loss: 12.163640
Rec Loss: 10.795187
KL Loss: 1.368453
Y Loss: 0.786266
T Loss: 10.402054
Epoch 949 
Overall Loss: 12.154035
Rec Loss: 10.763226
KL Loss: 1.390810
Y Loss: 0.763864
T Loss: 10.381294
Epoch 999 
Overall Loss: 12.130622
Rec Loss: 10.759055
KL Loss: 1.371567
Y Loss: 0.780737
T Loss: 10.368687
Epoch 1049 
Overall Loss: 12.139355
Rec Loss: 10.773657
KL Loss: 1.365698
Y Loss: 0.778625
T Loss: 10.384345
Epoch 1099 
Overall Loss: 12.145039
Rec Loss: 10.774743
KL Loss: 1.370295
Y Loss: 0.768519
T Loss: 10.390483
Epoch 1149 
Overall Loss: 12.132465
Rec Loss: 10.750557
KL Loss: 1.381908
Y Loss: 0.769604
T Loss: 10.365754
Epoch 1199 
Overall Loss: 12.151381
Rec Loss: 10.776730
KL Loss: 1.374651
Y Loss: 0.785452
T Loss: 10.384004
Epoch 1249 
Overall Loss: 12.126597
Rec Loss: 10.754557
KL Loss: 1.372040
Y Loss: 0.764583
T Loss: 10.372265
Epoch 1299 
Overall Loss: 12.108229
Rec Loss: 10.749463
KL Loss: 1.358766
Y Loss: 0.777962
T Loss: 10.360482
Epoch 1349 
Overall Loss: 12.099047
Rec Loss: 10.748871
KL Loss: 1.350176
Y Loss: 0.781497
T Loss: 10.358123
Epoch 1399 
Overall Loss: 12.085447
Rec Loss: 10.748520
KL Loss: 1.336927
Y Loss: 0.763655
T Loss: 10.366692
Epoch 1449 
Overall Loss: 12.110314
Rec Loss: 10.748257
KL Loss: 1.362058
Y Loss: 0.789675
T Loss: 10.353419
Epoch 1499 
Overall Loss: 12.092251
Rec Loss: 10.736807
KL Loss: 1.355444
Y Loss: 0.759789
T Loss: 10.356913
Epoch 1549 
Overall Loss: 12.093161
Rec Loss: 10.732179
KL Loss: 1.360982
Y Loss: 0.772314
T Loss: 10.346022
Epoch 1599 
Overall Loss: 12.077120
Rec Loss: 10.725844
KL Loss: 1.351276
Y Loss: 0.748467
T Loss: 10.351610
Epoch 1649 
Overall Loss: 12.079001
Rec Loss: 10.750456
KL Loss: 1.328545
Y Loss: 0.750939
T Loss: 10.374987
Epoch 1699 
Overall Loss: 12.075893
Rec Loss: 10.714188
KL Loss: 1.361705
Y Loss: 0.753592
T Loss: 10.337392
Epoch 1749 
Overall Loss: 12.068838
Rec Loss: 10.690693
KL Loss: 1.378145
Y Loss: 0.736020
T Loss: 10.322683
Epoch 1799 
Overall Loss: 12.079603
Rec Loss: 10.728100
KL Loss: 1.351504
Y Loss: 0.749346
T Loss: 10.353427
Epoch 1849 
Overall Loss: 12.077623
Rec Loss: 10.740150
KL Loss: 1.337473
Y Loss: 0.763122
T Loss: 10.358589
Epoch 1899 
Overall Loss: 12.065591
Rec Loss: 10.707769
KL Loss: 1.357822
Y Loss: 0.750484
T Loss: 10.332527
Epoch 1949 
Overall Loss: 12.062309
Rec Loss: 10.710348
KL Loss: 1.351961
Y Loss: 0.751813
T Loss: 10.334441
Epoch 1999 
Overall Loss: 12.037642
Rec Loss: 10.694958
KL Loss: 1.342684
Y Loss: 0.754624
T Loss: 10.317646
Epoch 2049 
Overall Loss: 12.044699
Rec Loss: 10.720919
KL Loss: 1.323780
Y Loss: 0.744610
T Loss: 10.348613
Epoch 2099 
Overall Loss: 12.042615
Rec Loss: 10.684443
KL Loss: 1.358172
Y Loss: 0.718627
T Loss: 10.325129
Epoch 2149 
Overall Loss: 12.053301
Rec Loss: 10.696684
KL Loss: 1.356617
Y Loss: 0.746285
T Loss: 10.323542
Epoch 2199 
Overall Loss: 12.039058
Rec Loss: 10.683713
KL Loss: 1.355345
Y Loss: 0.735062
T Loss: 10.316182
Epoch 2249 
Overall Loss: 12.027636
Rec Loss: 10.679219
KL Loss: 1.348417
Y Loss: 0.748225
T Loss: 10.305106
Epoch 2299 
Overall Loss: 12.011461
Rec Loss: 10.679232
KL Loss: 1.332229
Y Loss: 0.744850
T Loss: 10.306807
Epoch 2349 
Overall Loss: 12.021420
Rec Loss: 10.668705
KL Loss: 1.352715
Y Loss: 0.712627
T Loss: 10.312391
Epoch 2399 
Overall Loss: 12.007100
Rec Loss: 10.679958
KL Loss: 1.327142
Y Loss: 0.722895
T Loss: 10.318510
Epoch 2449 
Overall Loss: 12.022682
Rec Loss: 10.673142
KL Loss: 1.349540
Y Loss: 0.727988
T Loss: 10.309148
Epoch 2499 
Overall Loss: 12.013478
Rec Loss: 10.674397
KL Loss: 1.339080
Y Loss: 0.749054
T Loss: 10.299870
Epoch 2549 
Overall Loss: 11.986275
Rec Loss: 10.656098
KL Loss: 1.330177
Y Loss: 0.730489
T Loss: 10.290853
Epoch 2599 
Overall Loss: 12.013139
Rec Loss: 10.677150
KL Loss: 1.335989
Y Loss: 0.739768
T Loss: 10.307265
Epoch 2649 
Overall Loss: 12.017609
Rec Loss: 10.684562
KL Loss: 1.333047
Y Loss: 0.739665
T Loss: 10.314730
Epoch 2699 
Overall Loss: 12.006437
Rec Loss: 10.686808
KL Loss: 1.319628
Y Loss: 0.752751
T Loss: 10.310433
Epoch 2749 
Overall Loss: 11.968604
Rec Loss: 10.636071
KL Loss: 1.332533
Y Loss: 0.737083
T Loss: 10.267530
Epoch 2799 
Overall Loss: 11.975045
Rec Loss: 10.634782
KL Loss: 1.340264
Y Loss: 0.730713
T Loss: 10.269425
Epoch 2849 
Overall Loss: 11.974849
Rec Loss: 10.656835
KL Loss: 1.318015
Y Loss: 0.714149
T Loss: 10.299761
Epoch 2899 
Overall Loss: 11.981760
Rec Loss: 10.663175
KL Loss: 1.318585
Y Loss: 0.715278
T Loss: 10.305536
Epoch 2949 
Overall Loss: 11.989743
Rec Loss: 10.662368
KL Loss: 1.327375
Y Loss: 0.731625
T Loss: 10.296555
Epoch 2999 
Overall Loss: 11.994999
Rec Loss: 10.650006
KL Loss: 1.344993
Y Loss: 0.709135
T Loss: 10.295438
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.816432
Epoch 99
Rec Loss: 0.813278
Epoch 149
Rec Loss: 0.816796
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.895224
Epoch 99
Rec Loss: 9.885283
Epoch 149
Rec Loss: 9.876949
Epoch 199
Rec Loss: 9.863087
Epoch 249
Rec Loss: 9.869561
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.667207
Insample Error: 1.860582
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.905412
Rec Loss: 18.708133
KL Loss: 3.197279
Y Loss: 7.901916
T Loss: 12.909066
X Loss: 1.848109
Epoch 99 
Overall Loss: 16.935864
Rec Loss: 13.455218
KL Loss: 3.480646
Y Loss: 2.575072
T Loss: 12.858913
X Loss: -0.691231
Epoch 149 
Overall Loss: 15.834459
Rec Loss: 12.475438
KL Loss: 3.359020
Y Loss: 1.924864
T Loss: 12.803912
X Loss: -1.290905
Epoch 199 
Overall Loss: 15.095287
Rec Loss: 11.574815
KL Loss: 3.520472
Y Loss: 1.300032
T Loss: 12.632251
X Loss: -1.707452
Epoch 249 
Overall Loss: 14.752527
Rec Loss: 11.106210
KL Loss: 3.646317
Y Loss: 1.016720
T Loss: 12.578973
X Loss: -1.981123
Epoch 299 
Overall Loss: 14.488872
Rec Loss: 10.718788
KL Loss: 3.770084
Y Loss: 0.928388
T Loss: 12.473174
X Loss: -2.218580
Epoch 349 
Overall Loss: 14.247184
Rec Loss: 10.300291
KL Loss: 3.946892
Y Loss: 0.886871
T Loss: 12.246483
X Loss: -2.389627
Epoch 399 
Overall Loss: 14.048844
Rec Loss: 9.958108
KL Loss: 4.090736
Y Loss: 0.898228
T Loss: 11.993716
X Loss: -2.484722
Epoch 449 
Overall Loss: 13.908995
Rec Loss: 9.641567
KL Loss: 4.267428
Y Loss: 0.894248
T Loss: 11.742667
X Loss: -2.548225
Epoch 499 
Overall Loss: 13.744537
Rec Loss: 9.234985
KL Loss: 4.509552
Y Loss: 0.898802
T Loss: 11.504110
X Loss: -2.718526
Epoch 549 
Overall Loss: 13.640723
Rec Loss: 8.991232
KL Loss: 4.649491
Y Loss: 0.899060
T Loss: 11.392146
X Loss: -2.850444
Epoch 599 
Overall Loss: 13.380062
Rec Loss: 8.234001
KL Loss: 5.146061
Y Loss: 0.913514
T Loss: 11.066588
X Loss: -3.289344
Epoch 649 
Overall Loss: 13.300525
Rec Loss: 7.884453
KL Loss: 5.416071
Y Loss: 0.917129
T Loss: 10.928760
X Loss: -3.502871
Epoch 699 
Overall Loss: 13.227665
Rec Loss: 7.716388
KL Loss: 5.511277
Y Loss: 0.928538
T Loss: 10.908783
X Loss: -3.656665
Epoch 749 
Overall Loss: 13.191575
Rec Loss: 7.648555
KL Loss: 5.543020
Y Loss: 0.912037
T Loss: 10.871996
X Loss: -3.679460
Epoch 799 
Overall Loss: 13.144649
Rec Loss: 7.553275
KL Loss: 5.591374
Y Loss: 0.914909
T Loss: 10.868042
X Loss: -3.772222
Epoch 849 
Overall Loss: 13.140925
Rec Loss: 7.509877
KL Loss: 5.631048
Y Loss: 0.884117
T Loss: 10.872107
X Loss: -3.804289
Epoch 899 
Overall Loss: 13.135607
Rec Loss: 7.464647
KL Loss: 5.670960
Y Loss: 0.886839
T Loss: 10.877382
X Loss: -3.856155
Epoch 949 
Overall Loss: 13.154650
Rec Loss: 7.463906
KL Loss: 5.690745
Y Loss: 0.889741
T Loss: 10.892460
X Loss: -3.873425
Epoch 999 
Overall Loss: 13.099252
Rec Loss: 7.396332
KL Loss: 5.702919
Y Loss: 0.872941
T Loss: 10.870648
X Loss: -3.910786
Epoch 1049 
Overall Loss: 13.084431
Rec Loss: 7.369331
KL Loss: 5.715100
Y Loss: 0.882128
T Loss: 10.887231
X Loss: -3.958964
Epoch 1099 
Overall Loss: 13.059736
Rec Loss: 7.309659
KL Loss: 5.750077
Y Loss: 0.870035
T Loss: 10.884769
X Loss: -4.010127
Epoch 1149 
Overall Loss: 13.062980
Rec Loss: 7.298702
KL Loss: 5.764278
Y Loss: 0.861506
T Loss: 10.888669
X Loss: -4.020720
Epoch 1199 
Overall Loss: 13.044652
Rec Loss: 7.249319
KL Loss: 5.795333
Y Loss: 0.876775
T Loss: 10.880791
X Loss: -4.069859
Epoch 1249 
Overall Loss: 12.997248
Rec Loss: 7.200574
KL Loss: 5.796675
Y Loss: 0.848045
T Loss: 10.887034
X Loss: -4.110482
Epoch 1299 
Overall Loss: 13.013803
Rec Loss: 7.175452
KL Loss: 5.838351
Y Loss: 0.871250
T Loss: 10.885304
X Loss: -4.145477
Epoch 1349 
Overall Loss: 13.010823
Rec Loss: 7.189864
KL Loss: 5.820959
Y Loss: 0.869709
T Loss: 10.904828
X Loss: -4.149818
Epoch 1399 
Overall Loss: 13.002696
Rec Loss: 7.165432
KL Loss: 5.837263
Y Loss: 0.873295
T Loss: 10.920959
X Loss: -4.192175
Epoch 1449 
Overall Loss: 12.984330
Rec Loss: 7.076379
KL Loss: 5.907951
Y Loss: 0.843522
T Loss: 10.907848
X Loss: -4.253230
Epoch 1499 
Overall Loss: 12.976678
Rec Loss: 7.079330
KL Loss: 5.897349
Y Loss: 0.849168
T Loss: 10.909264
X Loss: -4.254518
Epoch 1549 
Overall Loss: 12.963272
Rec Loss: 7.024864
KL Loss: 5.938409
Y Loss: 0.833062
T Loss: 10.909210
X Loss: -4.300877
Epoch 1599 
Overall Loss: 12.971246
Rec Loss: 7.001902
KL Loss: 5.969344
Y Loss: 0.855413
T Loss: 10.912493
X Loss: -4.338298
Epoch 1649 
Overall Loss: 12.945234
Rec Loss: 6.985740
KL Loss: 5.959494
Y Loss: 0.857155
T Loss: 10.928308
X Loss: -4.371146
Epoch 1699 
Overall Loss: 12.933698
Rec Loss: 6.957734
KL Loss: 5.975964
Y Loss: 0.855067
T Loss: 10.915180
X Loss: -4.384979
Epoch 1749 
Overall Loss: 12.937601
Rec Loss: 6.929914
KL Loss: 6.007687
Y Loss: 0.851835
T Loss: 10.930145
X Loss: -4.426149
Epoch 1799 
Overall Loss: 12.934968
Rec Loss: 6.922499
KL Loss: 6.012470
Y Loss: 0.842089
T Loss: 10.938196
X Loss: -4.436741
Epoch 1849 
Overall Loss: 12.932660
Rec Loss: 6.888187
KL Loss: 6.044473
Y Loss: 0.858971
T Loss: 10.938972
X Loss: -4.480270
Epoch 1899 
Overall Loss: 12.919629
Rec Loss: 6.860223
KL Loss: 6.059406
Y Loss: 0.862962
T Loss: 10.935414
X Loss: -4.506672
Epoch 1949 
Overall Loss: 12.949469
Rec Loss: 6.874737
KL Loss: 6.074732
Y Loss: 0.868696
T Loss: 10.950901
X Loss: -4.510513
Epoch 1999 
Overall Loss: 12.916680
Rec Loss: 6.838549
KL Loss: 6.078131
Y Loss: 0.854339
T Loss: 10.951540
X Loss: -4.540161
Epoch 2049 
Overall Loss: 12.909328
Rec Loss: 6.838988
KL Loss: 6.070340
Y Loss: 0.879436
T Loss: 10.960055
X Loss: -4.560785
Epoch 2099 
Overall Loss: 12.915695
Rec Loss: 6.783730
KL Loss: 6.131965
Y Loss: 0.862035
T Loss: 10.953772
X Loss: -4.601060
Epoch 2149 
Overall Loss: 12.919912
Rec Loss: 6.781821
KL Loss: 6.138092
Y Loss: 0.851969
T Loss: 10.952909
X Loss: -4.597073
Epoch 2199 
Overall Loss: 12.896223
Rec Loss: 6.755295
KL Loss: 6.140928
Y Loss: 0.873816
T Loss: 10.955646
X Loss: -4.637259
Epoch 2249 
Overall Loss: 12.898394
Rec Loss: 6.695723
KL Loss: 6.202671
Y Loss: 0.870448
T Loss: 10.947002
X Loss: -4.686502
Epoch 2299 
Overall Loss: 12.885533
Rec Loss: 6.705239
KL Loss: 6.180294
Y Loss: 0.872321
T Loss: 10.963739
X Loss: -4.694660
Epoch 2349 
Overall Loss: 12.902428
Rec Loss: 6.668200
KL Loss: 6.234228
Y Loss: 0.856572
T Loss: 10.958153
X Loss: -4.718239
Epoch 2399 
Overall Loss: 12.881640
Rec Loss: 6.668502
KL Loss: 6.213138
Y Loss: 0.862350
T Loss: 10.971421
X Loss: -4.734094
Epoch 2449 
Overall Loss: 12.854857
Rec Loss: 6.627187
KL Loss: 6.227670
Y Loss: 0.849153
T Loss: 10.973725
X Loss: -4.771114
Epoch 2499 
Overall Loss: 12.883909
Rec Loss: 6.631713
KL Loss: 6.252196
Y Loss: 0.835623
T Loss: 10.997105
X Loss: -4.783204
Epoch 2549 
Overall Loss: 12.859906
Rec Loss: 6.598837
KL Loss: 6.261069
Y Loss: 0.860103
T Loss: 10.987802
X Loss: -4.819017
Epoch 2599 
Overall Loss: 12.879742
Rec Loss: 6.608683
KL Loss: 6.271059
Y Loss: 0.874384
T Loss: 10.989742
X Loss: -4.818251
Epoch 2649 
Overall Loss: 12.868319
Rec Loss: 6.572374
KL Loss: 6.295945
Y Loss: 0.857022
T Loss: 10.984813
X Loss: -4.840950
Epoch 2699 
Overall Loss: 12.853163
Rec Loss: 6.540992
KL Loss: 6.312172
Y Loss: 0.854973
T Loss: 10.994240
X Loss: -4.880735
Epoch 2749 
Overall Loss: 12.836689
Rec Loss: 6.510230
KL Loss: 6.326458
Y Loss: 0.872433
T Loss: 10.984584
X Loss: -4.910569
Epoch 2799 
Overall Loss: 12.847470
Rec Loss: 6.509128
KL Loss: 6.338343
Y Loss: 0.871705
T Loss: 10.991336
X Loss: -4.918061
Epoch 2849 
Overall Loss: 12.838729
Rec Loss: 6.502606
KL Loss: 6.336123
Y Loss: 0.869891
T Loss: 10.996835
X Loss: -4.929174
Epoch 2899 
Overall Loss: 12.841875
Rec Loss: 6.456574
KL Loss: 6.385301
Y Loss: 0.859315
T Loss: 10.988655
X Loss: -4.961738
Epoch 2949 
Overall Loss: 12.834447
Rec Loss: 6.467230
KL Loss: 6.367217
Y Loss: 0.831506
T Loss: 10.996833
X Loss: -4.945356
Epoch 2999 
Overall Loss: 12.867781
Rec Loss: 6.479041
KL Loss: 6.388740
Y Loss: 0.872694
T Loss: 11.005363
X Loss: -4.962669
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.520423
Epoch 99
Rec Loss: 1.525626
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.010831
Epoch 99
Rec Loss: 2.000356
Epoch 149
Rec Loss: 2.005509
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.633705
Insample Error 2.476022
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.888450
Epoch 99 
Prediction Loss: 1.765495
Epoch 149 
Prediction Loss: 1.665625
Epoch 199 
Prediction Loss: 1.596128
Epoch 249 
Prediction Loss: 1.571068
Epoch 299 
Prediction Loss: 1.430655
Epoch 349 
Prediction Loss: 1.404608
Epoch 399 
Prediction Loss: 1.298314
Epoch 449 
Prediction Loss: 1.221538
Epoch 499 
Prediction Loss: 1.183869
Epoch 549 
Prediction Loss: 1.132232
Epoch 599 
Prediction Loss: 1.084353
Epoch 649 
Prediction Loss: 1.028163
Epoch 699 
Prediction Loss: 0.973071
Epoch 749 
Prediction Loss: 0.954515
Epoch 799 
Prediction Loss: 0.895264
Epoch 849 
Prediction Loss: 0.867391
Epoch 899 
Prediction Loss: 0.866788
Epoch 949 
Prediction Loss: 0.831068
Epoch 999 
Prediction Loss: 0.779243
Epoch 1049 
Prediction Loss: 0.778733
Epoch 1099 
Prediction Loss: 0.735832
Epoch 1149 
Prediction Loss: 0.716583
Epoch 1199 
Prediction Loss: 0.694486
Epoch 1249 
Prediction Loss: 0.689062
Epoch 1299 
Prediction Loss: 0.663914
Epoch 1349 
Prediction Loss: 0.643470
Epoch 1399 
Prediction Loss: 0.624502
Epoch 1449 
Prediction Loss: 0.611464
Epoch 1499 
Prediction Loss: 0.598220
Epoch 1549 
Prediction Loss: 0.604757
Epoch 1599 
Prediction Loss: 0.594803
Epoch 1649 
Prediction Loss: 0.574235
Epoch 1699 
Prediction Loss: 0.569707
Epoch 1749 
Prediction Loss: 0.578884
Epoch 1799 
Prediction Loss: 0.556120
Epoch 1849 
Prediction Loss: 0.550546
Epoch 1899 
Prediction Loss: 0.563729
Epoch 1949 
Prediction Loss: 0.528873
Epoch 1999 
Prediction Loss: 0.521538
Epoch 2049 
Prediction Loss: 0.526469
Epoch 2099 
Prediction Loss: 0.509545
Epoch 2149 
Prediction Loss: 0.494904
Epoch 2199 
Prediction Loss: 0.515801
Epoch 2249 
Prediction Loss: 0.519247
Epoch 2299 
Prediction Loss: 0.504565
Epoch 2349 
Prediction Loss: 0.502142
Epoch 2399 
Prediction Loss: 0.483793
Epoch 2449 
Prediction Loss: 0.492181
Epoch 2499 
Prediction Loss: 0.474879
Epoch 2549 
Prediction Loss: 0.473585
Epoch 2599 
Prediction Loss: 0.474762
Epoch 2649 
Prediction Loss: 0.462631
Epoch 2699 
Prediction Loss: 0.470656
Epoch 2749 
Prediction Loss: 0.464675
Epoch 2799 
Prediction Loss: 0.454890
Epoch 2849 
Prediction Loss: 0.442972
Epoch 2899 
Prediction Loss: 0.460125
Epoch 2949 
Prediction Loss: 0.438334
Epoch 2999 
Prediction Loss: 0.435949
Epoch 3049 
Prediction Loss: 0.443055
Epoch 3099 
Prediction Loss: 0.436003
Epoch 3149 
Prediction Loss: 0.435768
Epoch 3199 
Prediction Loss: 0.439600
Epoch 3249 
Prediction Loss: 0.435618
Epoch 3299 
Prediction Loss: 0.416374
Epoch 3349 
Prediction Loss: 0.433790
Epoch 3399 
Prediction Loss: 0.436074
Epoch 3449 
Prediction Loss: 0.409523
Epoch 3499 
Prediction Loss: 0.423955
Epoch 3549 
Prediction Loss: 0.418021
Epoch 3599 
Prediction Loss: 0.412004
Epoch 3649 
Prediction Loss: 0.413327
Epoch 3699 
Prediction Loss: 0.400385
Epoch 3749 
Prediction Loss: 0.403869
Epoch 3799 
Prediction Loss: 0.405723
Epoch 3849 
Prediction Loss: 0.410110
Epoch 3899 
Prediction Loss: 0.400194
Epoch 3949 
Prediction Loss: 0.426864
Epoch 3999 
Prediction Loss: 0.401664
Epoch 4049 
Prediction Loss: 0.430362
Epoch 4099 
Prediction Loss: 0.387331
Epoch 4149 
Prediction Loss: 0.399595
Epoch 4199 
Prediction Loss: 0.400015
Epoch 4249 
Prediction Loss: 0.407105
Epoch 4299 
Prediction Loss: 0.399251
Epoch 4349 
Prediction Loss: 0.390410
Epoch 4399 
Prediction Loss: 0.391348
Epoch 4449 
Prediction Loss: 0.374309
Epoch 4499 
Prediction Loss: 0.391141
Epoch 4549 
Prediction Loss: 0.379878
Epoch 4599 
Prediction Loss: 0.401174
Epoch 4649 
Prediction Loss: 0.381424
Epoch 4699 
Prediction Loss: 0.376779
Epoch 4749 
Prediction Loss: 0.395262
Epoch 4799 
Prediction Loss: 0.373933
Epoch 4849 
Prediction Loss: 0.373202
Epoch 4899 
Prediction Loss: 0.370073
Epoch 4949 
Prediction Loss: 0.376869
Epoch 4999 
Prediction Loss: 0.377510
Epoch 5049 
Prediction Loss: 0.387924
Epoch 5099 
Prediction Loss: 0.366704
Epoch 5149 
Prediction Loss: 0.384720
Epoch 5199 
Prediction Loss: 0.378376
Epoch 5249 
Prediction Loss: 0.374631
Epoch 5299 
Prediction Loss: 0.372144
Epoch 5349 
Prediction Loss: 0.408128
Epoch 5399 
Prediction Loss: 0.362643
Epoch 5449 
Prediction Loss: 0.362292
Epoch 5499 
Prediction Loss: 0.367795
Epoch 5549 
Prediction Loss: 0.360571
Epoch 5599 
Prediction Loss: 0.388712
Epoch 5649 
Prediction Loss: 0.361570
Epoch 5699 
Prediction Loss: 0.357268
Epoch 5749 
Prediction Loss: 0.373759
Epoch 5799 
Prediction Loss: 0.365025
Epoch 5849 
Prediction Loss: 0.361195
Epoch 5899 
Prediction Loss: 0.355537
Epoch 5949 
Prediction Loss: 0.370938
Epoch 5999 
Prediction Loss: 0.355583
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.598866
Insample Error 2.970536
[31m========== repeat time 5 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.755434
Rec Loss: 11.085594
KL Loss: 1.669839
Y Loss: 0.946049
T Loss: 10.612570
Epoch 99 
Overall Loss: 12.414658
Rec Loss: 10.802127
KL Loss: 1.612530
Y Loss: 0.866198
T Loss: 10.369028
Epoch 149 
Overall Loss: 12.320135
Rec Loss: 10.802070
KL Loss: 1.518065
Y Loss: 0.848461
T Loss: 10.377840
Epoch 199 
Overall Loss: 12.292131
Rec Loss: 10.813085
KL Loss: 1.479045
Y Loss: 0.823162
T Loss: 10.401504
Epoch 249 
Overall Loss: 12.271870
Rec Loss: 10.811253
KL Loss: 1.460617
Y Loss: 0.826191
T Loss: 10.398157
Epoch 299 
Overall Loss: 12.267794
Rec Loss: 10.831181
KL Loss: 1.436613
Y Loss: 0.834709
T Loss: 10.413826
Epoch 349 
Overall Loss: 12.246040
Rec Loss: 10.818689
KL Loss: 1.427351
Y Loss: 0.839184
T Loss: 10.399097
Epoch 399 
Overall Loss: 12.230751
Rec Loss: 10.801775
KL Loss: 1.428977
Y Loss: 0.809787
T Loss: 10.396881
Epoch 449 
Overall Loss: 12.242808
Rec Loss: 10.821166
KL Loss: 1.421641
Y Loss: 0.814478
T Loss: 10.413927
Epoch 499 
Overall Loss: 12.216866
Rec Loss: 10.808909
KL Loss: 1.407957
Y Loss: 0.802800
T Loss: 10.407509
Epoch 549 
Overall Loss: 12.197709
Rec Loss: 10.806292
KL Loss: 1.391417
Y Loss: 0.795754
T Loss: 10.408415
Epoch 599 
Overall Loss: 12.175019
Rec Loss: 10.781347
KL Loss: 1.393672
Y Loss: 0.797349
T Loss: 10.382673
Epoch 649 
Overall Loss: 12.196892
Rec Loss: 10.788900
KL Loss: 1.407992
Y Loss: 0.783225
T Loss: 10.397288
Epoch 699 
Overall Loss: 12.186145
Rec Loss: 10.789272
KL Loss: 1.396873
Y Loss: 0.793038
T Loss: 10.392753
Epoch 749 
Overall Loss: 12.169271
Rec Loss: 10.788495
KL Loss: 1.380776
Y Loss: 0.780122
T Loss: 10.398434
Epoch 799 
Overall Loss: 12.146997
Rec Loss: 10.760765
KL Loss: 1.386232
Y Loss: 0.773267
T Loss: 10.374132
Epoch 849 
Overall Loss: 12.146111
Rec Loss: 10.759377
KL Loss: 1.386734
Y Loss: 0.780101
T Loss: 10.369327
Epoch 899 
Overall Loss: 12.133763
Rec Loss: 10.750232
KL Loss: 1.383531
Y Loss: 0.761020
T Loss: 10.369722
Epoch 949 
Overall Loss: 12.149471
Rec Loss: 10.743592
KL Loss: 1.405879
Y Loss: 0.782017
T Loss: 10.352584
Epoch 999 
Overall Loss: 12.148169
Rec Loss: 10.777067
KL Loss: 1.371102
Y Loss: 0.780534
T Loss: 10.386800
Epoch 1049 
Overall Loss: 12.143401
Rec Loss: 10.769498
KL Loss: 1.373903
Y Loss: 0.797280
T Loss: 10.370858
Epoch 1099 
Overall Loss: 12.129962
Rec Loss: 10.760301
KL Loss: 1.369661
Y Loss: 0.768140
T Loss: 10.376231
Epoch 1149 
Overall Loss: 12.126412
Rec Loss: 10.753859
KL Loss: 1.372553
Y Loss: 0.767931
T Loss: 10.369893
Epoch 1199 
Overall Loss: 12.120251
Rec Loss: 10.752177
KL Loss: 1.368074
Y Loss: 0.777039
T Loss: 10.363657
Epoch 1249 
Overall Loss: 12.117800
Rec Loss: 10.736511
KL Loss: 1.381290
Y Loss: 0.752096
T Loss: 10.360463
Epoch 1299 
Overall Loss: 12.108922
Rec Loss: 10.726544
KL Loss: 1.382378
Y Loss: 0.760022
T Loss: 10.346533
Epoch 1349 
Overall Loss: 12.095902
Rec Loss: 10.741682
KL Loss: 1.354220
Y Loss: 0.764717
T Loss: 10.359323
Epoch 1399 
Overall Loss: 12.108015
Rec Loss: 10.757641
KL Loss: 1.350374
Y Loss: 0.763795
T Loss: 10.375744
Epoch 1449 
Overall Loss: 12.088623
Rec Loss: 10.740233
KL Loss: 1.348390
Y Loss: 0.749326
T Loss: 10.365570
Epoch 1499 
Overall Loss: 12.101471
Rec Loss: 10.727234
KL Loss: 1.374237
Y Loss: 0.753377
T Loss: 10.350545
Epoch 1549 
Overall Loss: 12.081498
Rec Loss: 10.719341
KL Loss: 1.362157
Y Loss: 0.766088
T Loss: 10.336297
Epoch 1599 
Overall Loss: 12.081379
Rec Loss: 10.711306
KL Loss: 1.370073
Y Loss: 0.761443
T Loss: 10.330584
Epoch 1649 
Overall Loss: 12.083197
Rec Loss: 10.716315
KL Loss: 1.366881
Y Loss: 0.761466
T Loss: 10.335582
Epoch 1699 
Overall Loss: 12.055969
Rec Loss: 10.708679
KL Loss: 1.347289
Y Loss: 0.742380
T Loss: 10.337490
Epoch 1749 
Overall Loss: 12.058174
Rec Loss: 10.693438
KL Loss: 1.364736
Y Loss: 0.744864
T Loss: 10.321006
Epoch 1799 
Overall Loss: 12.050133
Rec Loss: 10.709005
KL Loss: 1.341128
Y Loss: 0.734128
T Loss: 10.341941
Epoch 1849 
Overall Loss: 12.044270
Rec Loss: 10.694124
KL Loss: 1.350145
Y Loss: 0.726327
T Loss: 10.330961
Epoch 1899 
Overall Loss: 12.031342
Rec Loss: 10.711942
KL Loss: 1.319400
Y Loss: 0.755902
T Loss: 10.333992
Epoch 1949 
Overall Loss: 12.044437
Rec Loss: 10.701645
KL Loss: 1.342792
Y Loss: 0.725936
T Loss: 10.338677
Epoch 1999 
Overall Loss: 12.059994
Rec Loss: 10.683588
KL Loss: 1.376407
Y Loss: 0.741691
T Loss: 10.312742
Epoch 2049 
Overall Loss: 12.032243
Rec Loss: 10.671829
KL Loss: 1.360414
Y Loss: 0.736768
T Loss: 10.303444
Epoch 2099 
Overall Loss: 12.022189
Rec Loss: 10.684426
KL Loss: 1.337762
Y Loss: 0.729609
T Loss: 10.319621
Epoch 2149 
Overall Loss: 12.033011
Rec Loss: 10.678315
KL Loss: 1.354696
Y Loss: 0.744167
T Loss: 10.306231
Epoch 2199 
Overall Loss: 12.024955
Rec Loss: 10.669182
KL Loss: 1.355773
Y Loss: 0.732969
T Loss: 10.302697
Epoch 2249 
Overall Loss: 12.008711
Rec Loss: 10.666686
KL Loss: 1.342025
Y Loss: 0.731211
T Loss: 10.301080
Epoch 2299 
Overall Loss: 12.012818
Rec Loss: 10.655798
KL Loss: 1.357021
Y Loss: 0.720895
T Loss: 10.295350
Epoch 2349 
Overall Loss: 12.022164
Rec Loss: 10.674886
KL Loss: 1.347278
Y Loss: 0.732247
T Loss: 10.308763
Epoch 2399 
Overall Loss: 12.019863
Rec Loss: 10.649269
KL Loss: 1.370594
Y Loss: 0.709662
T Loss: 10.294438
Epoch 2449 
Overall Loss: 11.991500
Rec Loss: 10.654862
KL Loss: 1.336638
Y Loss: 0.722380
T Loss: 10.293672
Epoch 2499 
Overall Loss: 12.011095
Rec Loss: 10.673586
KL Loss: 1.337509
Y Loss: 0.733483
T Loss: 10.306844
Epoch 2549 
Overall Loss: 12.006581
Rec Loss: 10.672382
KL Loss: 1.334199
Y Loss: 0.724431
T Loss: 10.310167
Epoch 2599 
Overall Loss: 12.004863
Rec Loss: 10.670733
KL Loss: 1.334131
Y Loss: 0.741496
T Loss: 10.299985
Epoch 2649 
Overall Loss: 12.002197
Rec Loss: 10.660649
KL Loss: 1.341547
Y Loss: 0.727471
T Loss: 10.296913
Epoch 2699 
Overall Loss: 11.985547
Rec Loss: 10.640904
KL Loss: 1.344642
Y Loss: 0.726715
T Loss: 10.277547
Epoch 2749 
Overall Loss: 11.998052
Rec Loss: 10.655748
KL Loss: 1.342304
Y Loss: 0.728831
T Loss: 10.291332
Epoch 2799 
Overall Loss: 11.998327
Rec Loss: 10.647267
KL Loss: 1.351060
Y Loss: 0.727880
T Loss: 10.283327
Epoch 2849 
Overall Loss: 11.984002
Rec Loss: 10.658365
KL Loss: 1.325637
Y Loss: 0.713024
T Loss: 10.301853
Epoch 2899 
Overall Loss: 11.987342
Rec Loss: 10.640180
KL Loss: 1.347161
Y Loss: 0.729044
T Loss: 10.275658
Epoch 2949 
Overall Loss: 11.981036
Rec Loss: 10.646699
KL Loss: 1.334337
Y Loss: 0.733350
T Loss: 10.280024
Epoch 2999 
Overall Loss: 11.961742
Rec Loss: 10.633278
KL Loss: 1.328464
Y Loss: 0.706951
T Loss: 10.279802
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.835088
Epoch 99
Rec Loss: 0.831297
Epoch 149
Rec Loss: 0.829606
Epoch 199
Rec Loss: 0.829672
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.934119
Epoch 99
Rec Loss: 9.932094
Epoch 149
Rec Loss: 9.915652
Epoch 199
Rec Loss: 9.896243
Epoch 249
Rec Loss: 9.894528
Epoch 299
Rec Loss: 9.874660
Epoch 349
Rec Loss: 9.885942
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.675714
Insample Error: 1.836976
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 23.258759
Rec Loss: 20.527910
KL Loss: 2.730850
Y Loss: 10.933261
T Loss: 13.077473
X Loss: 1.983806
Epoch 99 
Overall Loss: 17.160953
Rec Loss: 13.605631
KL Loss: 3.555321
Y Loss: 3.264072
T Loss: 12.943946
X Loss: -0.970351
Epoch 149 
Overall Loss: 16.110176
Rec Loss: 12.771692
KL Loss: 3.338484
Y Loss: 2.490497
T Loss: 13.039805
X Loss: -1.513361
Epoch 199 
Overall Loss: 15.385266
Rec Loss: 11.786169
KL Loss: 3.599096
Y Loss: 2.074040
T Loss: 12.691609
X Loss: -1.942459
Epoch 249 
Overall Loss: 14.576373
Rec Loss: 10.445111
KL Loss: 4.131262
Y Loss: 1.614376
T Loss: 11.935973
X Loss: -2.298050
Epoch 299 
Overall Loss: 14.174604
Rec Loss: 9.803561
KL Loss: 4.371044
Y Loss: 1.469485
T Loss: 11.553948
X Loss: -2.485130
Epoch 349 
Overall Loss: 14.011026
Rec Loss: 9.601236
KL Loss: 4.409790
Y Loss: 1.361395
T Loss: 11.482067
X Loss: -2.561529
Epoch 399 
Overall Loss: 13.896420
Rec Loss: 9.409788
KL Loss: 4.486632
Y Loss: 1.264800
T Loss: 11.457027
X Loss: -2.679639
Epoch 449 
Overall Loss: 13.827907
Rec Loss: 9.269491
KL Loss: 4.558417
Y Loss: 1.203301
T Loss: 11.453406
X Loss: -2.785566
Epoch 499 
Overall Loss: 13.746316
Rec Loss: 9.152329
KL Loss: 4.593987
Y Loss: 1.154728
T Loss: 11.429186
X Loss: -2.854220
Epoch 549 
Overall Loss: 13.697738
Rec Loss: 9.065852
KL Loss: 4.631885
Y Loss: 1.112188
T Loss: 11.433108
X Loss: -2.923349
Epoch 599 
Overall Loss: 13.609940
Rec Loss: 8.981446
KL Loss: 4.628494
Y Loss: 1.061047
T Loss: 11.411370
X Loss: -2.960448
Epoch 649 
Overall Loss: 13.596752
Rec Loss: 8.913086
KL Loss: 4.683666
Y Loss: 1.043248
T Loss: 11.400120
X Loss: -3.008658
Epoch 699 
Overall Loss: 13.542891
Rec Loss: 8.844981
KL Loss: 4.697910
Y Loss: 1.010723
T Loss: 11.372912
X Loss: -3.033294
Epoch 749 
Overall Loss: 13.510724
Rec Loss: 8.782016
KL Loss: 4.728708
Y Loss: 0.967309
T Loss: 11.373380
X Loss: -3.075019
Epoch 799 
Overall Loss: 13.451166
Rec Loss: 8.701331
KL Loss: 4.749834
Y Loss: 0.979875
T Loss: 11.343708
X Loss: -3.132314
Epoch 849 
Overall Loss: 13.356990
Rec Loss: 8.465857
KL Loss: 4.891132
Y Loss: 0.976882
T Loss: 11.213956
X Loss: -3.236540
Epoch 899 
Overall Loss: 13.191041
Rec Loss: 7.913612
KL Loss: 5.277429
Y Loss: 0.932825
T Loss: 10.957245
X Loss: -3.510045
Epoch 949 
Overall Loss: 13.152977
Rec Loss: 7.730910
KL Loss: 5.422067
Y Loss: 0.952457
T Loss: 10.908133
X Loss: -3.653451
Epoch 999 
Overall Loss: 13.104504
Rec Loss: 7.638607
KL Loss: 5.465896
Y Loss: 0.963842
T Loss: 10.896107
X Loss: -3.739420
Epoch 1049 
Overall Loss: 13.077999
Rec Loss: 7.566483
KL Loss: 5.511516
Y Loss: 0.924675
T Loss: 10.891129
X Loss: -3.786984
Epoch 1099 
Overall Loss: 13.060040
Rec Loss: 7.497148
KL Loss: 5.562892
Y Loss: 0.937287
T Loss: 10.898640
X Loss: -3.870136
Epoch 1149 
Overall Loss: 13.040288
Rec Loss: 7.452494
KL Loss: 5.587795
Y Loss: 0.939993
T Loss: 10.893009
X Loss: -3.910512
Epoch 1199 
Overall Loss: 13.052188
Rec Loss: 7.443509
KL Loss: 5.608680
Y Loss: 0.923963
T Loss: 10.919384
X Loss: -3.937857
Epoch 1249 
Overall Loss: 13.041941
Rec Loss: 7.391757
KL Loss: 5.650184
Y Loss: 0.893421
T Loss: 10.918894
X Loss: -3.973848
Epoch 1299 
Overall Loss: 13.023328
Rec Loss: 7.341825
KL Loss: 5.681504
Y Loss: 0.923114
T Loss: 10.921142
X Loss: -4.040875
Epoch 1349 
Overall Loss: 12.966167
Rec Loss: 7.269456
KL Loss: 5.696712
Y Loss: 0.889714
T Loss: 10.928060
X Loss: -4.103462
Epoch 1399 
Overall Loss: 12.998553
Rec Loss: 7.291964
KL Loss: 5.706589
Y Loss: 0.927348
T Loss: 10.933294
X Loss: -4.105004
Epoch 1449 
Overall Loss: 12.970900
Rec Loss: 7.224967
KL Loss: 5.745934
Y Loss: 0.901208
T Loss: 10.930356
X Loss: -4.155994
Epoch 1499 
Overall Loss: 12.954928
Rec Loss: 7.194278
KL Loss: 5.760651
Y Loss: 0.921488
T Loss: 10.919371
X Loss: -4.185837
Epoch 1549 
Overall Loss: 12.964841
Rec Loss: 7.185449
KL Loss: 5.779392
Y Loss: 0.893250
T Loss: 10.946223
X Loss: -4.207398
Epoch 1599 
Overall Loss: 12.930563
Rec Loss: 7.128468
KL Loss: 5.802095
Y Loss: 0.893587
T Loss: 10.941367
X Loss: -4.259692
Epoch 1649 
Overall Loss: 12.942414
Rec Loss: 7.157278
KL Loss: 5.785136
Y Loss: 0.913529
T Loss: 10.943377
X Loss: -4.242864
Epoch 1699 
Overall Loss: 12.937481
Rec Loss: 7.089493
KL Loss: 5.847987
Y Loss: 0.905135
T Loss: 10.947246
X Loss: -4.310321
Epoch 1749 
Overall Loss: 12.943816
Rec Loss: 7.095189
KL Loss: 5.848626
Y Loss: 0.888205
T Loss: 10.960708
X Loss: -4.309621
Epoch 1799 
Overall Loss: 12.895282
Rec Loss: 7.028719
KL Loss: 5.866563
Y Loss: 0.891360
T Loss: 10.947783
X Loss: -4.364744
Epoch 1849 
Overall Loss: 12.935552
Rec Loss: 7.063600
KL Loss: 5.871952
Y Loss: 0.883553
T Loss: 10.975823
X Loss: -4.353999
Epoch 1899 
Overall Loss: 12.869974
Rec Loss: 6.990740
KL Loss: 5.879234
Y Loss: 0.868355
T Loss: 10.952219
X Loss: -4.395656
Epoch 1949 
Overall Loss: 12.908101
Rec Loss: 6.997856
KL Loss: 5.910245
Y Loss: 0.878888
T Loss: 10.969960
X Loss: -4.411549
Epoch 1999 
Overall Loss: 12.909456
Rec Loss: 6.976825
KL Loss: 5.932631
Y Loss: 0.893364
T Loss: 10.979909
X Loss: -4.449766
Epoch 2049 
Overall Loss: 12.895550
Rec Loss: 6.964283
KL Loss: 5.931267
Y Loss: 0.879969
T Loss: 10.988298
X Loss: -4.464000
Epoch 2099 
Overall Loss: 12.881617
Rec Loss: 6.914883
KL Loss: 5.966734
Y Loss: 0.878550
T Loss: 10.978544
X Loss: -4.502936
Epoch 2149 
Overall Loss: 12.892256
Rec Loss: 6.906294
KL Loss: 5.985962
Y Loss: 0.893500
T Loss: 10.988322
X Loss: -4.528779
Epoch 2199 
Overall Loss: 12.850618
Rec Loss: 6.871778
KL Loss: 5.978841
Y Loss: 0.874948
T Loss: 10.987864
X Loss: -4.553560
Epoch 2249 
Overall Loss: 12.889175
Rec Loss: 6.890387
KL Loss: 5.998787
Y Loss: 0.876068
T Loss: 11.007769
X Loss: -4.555416
Epoch 2299 
Overall Loss: 12.871606
Rec Loss: 6.827268
KL Loss: 6.044338
Y Loss: 0.871165
T Loss: 10.992186
X Loss: -4.600501
Epoch 2349 
Overall Loss: 12.888802
Rec Loss: 6.820858
KL Loss: 6.067944
Y Loss: 0.875655
T Loss: 10.999188
X Loss: -4.616158
Epoch 2399 
Overall Loss: 12.862402
Rec Loss: 6.793027
KL Loss: 6.069375
Y Loss: 0.882103
T Loss: 11.001876
X Loss: -4.649900
Epoch 2449 
Overall Loss: 12.857754
Rec Loss: 6.788424
KL Loss: 6.069329
Y Loss: 0.882983
T Loss: 11.008359
X Loss: -4.661426
Epoch 2499 
Overall Loss: 12.873440
Rec Loss: 6.770990
KL Loss: 6.102450
Y Loss: 0.871994
T Loss: 11.006755
X Loss: -4.671762
Epoch 2549 
Overall Loss: 12.874027
Rec Loss: 6.727510
KL Loss: 6.146517
Y Loss: 0.856954
T Loss: 11.021695
X Loss: -4.722662
Epoch 2599 
Overall Loss: 12.875015
Rec Loss: 6.733291
KL Loss: 6.141724
Y Loss: 0.858575
T Loss: 11.026628
X Loss: -4.722625
Epoch 2649 
Overall Loss: 12.844248
Rec Loss: 6.682616
KL Loss: 6.161632
Y Loss: 0.869742
T Loss: 11.027583
X Loss: -4.779838
Epoch 2699 
Overall Loss: 12.833504
Rec Loss: 6.658089
KL Loss: 6.175415
Y Loss: 0.872153
T Loss: 11.026759
X Loss: -4.804747
Epoch 2749 
Overall Loss: 12.835824
Rec Loss: 6.638889
KL Loss: 6.196935
Y Loss: 0.880867
T Loss: 11.031793
X Loss: -4.833337
Epoch 2799 
Overall Loss: 12.828406
Rec Loss: 6.612709
KL Loss: 6.215697
Y Loss: 0.868117
T Loss: 11.023556
X Loss: -4.844906
Epoch 2849 
Overall Loss: 12.856693
Rec Loss: 6.641744
KL Loss: 6.214949
Y Loss: 0.877960
T Loss: 11.052996
X Loss: -4.850232
Epoch 2899 
Overall Loss: 12.837754
Rec Loss: 6.600646
KL Loss: 6.237109
Y Loss: 0.854348
T Loss: 11.037545
X Loss: -4.864073
Epoch 2949 
Overall Loss: 12.816694
Rec Loss: 6.584175
KL Loss: 6.232519
Y Loss: 0.876012
T Loss: 11.051027
X Loss: -4.904858
Epoch 2999 
Overall Loss: 12.817416
Rec Loss: 6.551549
KL Loss: 6.265866
Y Loss: 0.859908
T Loss: 11.036903
X Loss: -4.915308
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.524541
Epoch 99
Rec Loss: 1.525635
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.006819
Epoch 99
Rec Loss: 1.998295
Epoch 149
Rec Loss: 2.004553
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.656138
Insample Error 2.441955
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.852882
Epoch 99 
Prediction Loss: 1.707549
Epoch 149 
Prediction Loss: 1.628354
Epoch 199 
Prediction Loss: 1.592487
Epoch 249 
Prediction Loss: 1.476950
Epoch 299 
Prediction Loss: 1.409384
Epoch 349 
Prediction Loss: 1.327509
Epoch 399 
Prediction Loss: 1.293372
Epoch 449 
Prediction Loss: 1.213611
Epoch 499 
Prediction Loss: 1.151980
Epoch 549 
Prediction Loss: 1.080139
Epoch 599 
Prediction Loss: 1.049562
Epoch 649 
Prediction Loss: 1.010371
Epoch 699 
Prediction Loss: 0.963220
Epoch 749 
Prediction Loss: 0.991130
Epoch 799 
Prediction Loss: 0.896321
Epoch 849 
Prediction Loss: 0.861922
Epoch 899 
Prediction Loss: 0.832136
Epoch 949 
Prediction Loss: 0.811657
Epoch 999 
Prediction Loss: 0.802274
Epoch 1049 
Prediction Loss: 0.792646
Epoch 1099 
Prediction Loss: 0.781048
Epoch 1149 
Prediction Loss: 0.734580
Epoch 1199 
Prediction Loss: 0.740947
Epoch 1249 
Prediction Loss: 0.707529
Epoch 1299 
Prediction Loss: 0.690957
Epoch 1349 
Prediction Loss: 0.697632
Epoch 1399 
Prediction Loss: 0.675277
Epoch 1449 
Prediction Loss: 0.645340
Epoch 1499 
Prediction Loss: 0.661023
Epoch 1549 
Prediction Loss: 0.643950
Epoch 1599 
Prediction Loss: 0.616565
Epoch 1649 
Prediction Loss: 0.638250
Epoch 1699 
Prediction Loss: 0.615307
Epoch 1749 
Prediction Loss: 0.604358
Epoch 1799 
Prediction Loss: 0.581203
Epoch 1849 
Prediction Loss: 0.593551
Epoch 1899 
Prediction Loss: 0.579458
Epoch 1949 
Prediction Loss: 0.571568
Epoch 1999 
Prediction Loss: 0.569736
Epoch 2049 
Prediction Loss: 0.553872
Epoch 2099 
Prediction Loss: 0.542194
Epoch 2149 
Prediction Loss: 0.588455
Epoch 2199 
Prediction Loss: 0.559540
Epoch 2249 
Prediction Loss: 0.539063
Epoch 2299 
Prediction Loss: 0.532404
Epoch 2349 
Prediction Loss: 0.536769
Epoch 2399 
Prediction Loss: 0.527625
Epoch 2449 
Prediction Loss: 0.504795
Epoch 2499 
Prediction Loss: 0.499110
Epoch 2549 
Prediction Loss: 0.494228
Epoch 2599 
Prediction Loss: 0.501008
Epoch 2649 
Prediction Loss: 0.510425
Epoch 2699 
Prediction Loss: 0.510522
Epoch 2749 
Prediction Loss: 0.494030
Epoch 2799 
Prediction Loss: 0.518073
Epoch 2849 
Prediction Loss: 0.486455
Epoch 2899 
Prediction Loss: 0.486201
Epoch 2949 
Prediction Loss: 0.490829
Epoch 2999 
Prediction Loss: 0.488025
Epoch 3049 
Prediction Loss: 0.480482
Epoch 3099 
Prediction Loss: 0.483980
Epoch 3149 
Prediction Loss: 0.470833
Epoch 3199 
Prediction Loss: 0.473353
Epoch 3249 
Prediction Loss: 0.477968
Epoch 3299 
Prediction Loss: 0.471539
Epoch 3349 
Prediction Loss: 0.500239
Epoch 3399 
Prediction Loss: 0.468964
Epoch 3449 
Prediction Loss: 0.448753
Epoch 3499 
Prediction Loss: 0.450401
Epoch 3549 
Prediction Loss: 0.460755
Epoch 3599 
Prediction Loss: 0.454618
Epoch 3649 
Prediction Loss: 0.460183
Epoch 3699 
Prediction Loss: 0.435949
Epoch 3749 
Prediction Loss: 0.450558
Epoch 3799 
Prediction Loss: 0.460854
Epoch 3849 
Prediction Loss: 0.434431
Epoch 3899 
Prediction Loss: 0.452571
Epoch 3949 
Prediction Loss: 0.457137
Epoch 3999 
Prediction Loss: 0.425188
Epoch 4049 
Prediction Loss: 0.424668
Epoch 4099 
Prediction Loss: 0.456040
Epoch 4149 
Prediction Loss: 0.446908
Epoch 4199 
Prediction Loss: 0.455679
Epoch 4249 
Prediction Loss: 0.423493
Epoch 4299 
Prediction Loss: 0.424756
Epoch 4349 
Prediction Loss: 0.422806
Epoch 4399 
Prediction Loss: 0.422054
Epoch 4449 
Prediction Loss: 0.422873
Epoch 4499 
Prediction Loss: 0.412750
Epoch 4549 
Prediction Loss: 0.419188
Epoch 4599 
Prediction Loss: 0.414368
Epoch 4649 
Prediction Loss: 0.436158
Epoch 4699 
Prediction Loss: 0.413950
Epoch 4749 
Prediction Loss: 0.417939
Epoch 4799 
Prediction Loss: 0.419126
Epoch 4849 
Prediction Loss: 0.413588
Epoch 4899 
Prediction Loss: 0.427001
Epoch 4949 
Prediction Loss: 0.423433
Epoch 4999 
Prediction Loss: 0.419266
Epoch 5049 
Prediction Loss: 0.414162
Epoch 5099 
Prediction Loss: 0.398708
Epoch 5149 
Prediction Loss: 0.400574
Epoch 5199 
Prediction Loss: 0.444274
Epoch 5249 
Prediction Loss: 0.412612
Epoch 5299 
Prediction Loss: 0.407223
Epoch 5349 
Prediction Loss: 0.403899
Epoch 5399 
Prediction Loss: 0.409322
Epoch 5449 
Prediction Loss: 0.399313
Epoch 5499 
Prediction Loss: 0.408858
Epoch 5549 
Prediction Loss: 0.417565
Epoch 5599 
Prediction Loss: 0.405079
Epoch 5649 
Prediction Loss: 0.395775
Epoch 5699 
Prediction Loss: 0.402762
Epoch 5749 
Prediction Loss: 0.398979
Epoch 5799 
Prediction Loss: 0.393850
Epoch 5849 
Prediction Loss: 0.404583
Epoch 5899 
Prediction Loss: 0.401581
Epoch 5949 
Prediction Loss: 0.425418
Epoch 5999 
Prediction Loss: 0.400763
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.634061
Insample Error 3.004084
[31m========== repeat time 6 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.581802
Rec Loss: 10.870217
KL Loss: 1.711585
Y Loss: 1.069348
T Loss: 10.335543
Epoch 99 
Overall Loss: 12.396786
Rec Loss: 10.836281
KL Loss: 1.560506
Y Loss: 0.897509
T Loss: 10.387526
Epoch 149 
Overall Loss: 12.315399
Rec Loss: 10.814236
KL Loss: 1.501162
Y Loss: 0.863840
T Loss: 10.382316
Epoch 199 
Overall Loss: 12.310648
Rec Loss: 10.806020
KL Loss: 1.504628
Y Loss: 0.844102
T Loss: 10.383969
Epoch 249 
Overall Loss: 12.274809
Rec Loss: 10.806997
KL Loss: 1.467811
Y Loss: 0.850425
T Loss: 10.381785
Epoch 299 
Overall Loss: 12.268125
Rec Loss: 10.808154
KL Loss: 1.459971
Y Loss: 0.831414
T Loss: 10.392447
Epoch 349 
Overall Loss: 12.245407
Rec Loss: 10.806230
KL Loss: 1.439177
Y Loss: 0.824726
T Loss: 10.393867
Epoch 399 
Overall Loss: 12.237762
Rec Loss: 10.807886
KL Loss: 1.429876
Y Loss: 0.818434
T Loss: 10.398669
Epoch 449 
Overall Loss: 12.233006
Rec Loss: 10.823669
KL Loss: 1.409337
Y Loss: 0.845019
T Loss: 10.401160
Epoch 499 
Overall Loss: 12.213430
Rec Loss: 10.802867
KL Loss: 1.410563
Y Loss: 0.817444
T Loss: 10.394145
Epoch 549 
Overall Loss: 12.194924
Rec Loss: 10.776500
KL Loss: 1.418424
Y Loss: 0.790250
T Loss: 10.381375
Epoch 599 
Overall Loss: 12.179531
Rec Loss: 10.792398
KL Loss: 1.387133
Y Loss: 0.806830
T Loss: 10.388982
Epoch 649 
Overall Loss: 12.181041
Rec Loss: 10.780026
KL Loss: 1.401015
Y Loss: 0.803370
T Loss: 10.378341
Epoch 699 
Overall Loss: 12.172174
Rec Loss: 10.773968
KL Loss: 1.398207
Y Loss: 0.777559
T Loss: 10.385188
Epoch 749 
Overall Loss: 12.155571
Rec Loss: 10.774777
KL Loss: 1.380794
Y Loss: 0.774972
T Loss: 10.387291
Epoch 799 
Overall Loss: 12.148669
Rec Loss: 10.790931
KL Loss: 1.357738
Y Loss: 0.784548
T Loss: 10.398657
Epoch 849 
Overall Loss: 12.150583
Rec Loss: 10.782308
KL Loss: 1.368275
Y Loss: 0.771239
T Loss: 10.396688
Epoch 899 
Overall Loss: 12.148630
Rec Loss: 10.782542
KL Loss: 1.366088
Y Loss: 0.801176
T Loss: 10.381954
Epoch 949 
Overall Loss: 12.139515
Rec Loss: 10.773645
KL Loss: 1.365870
Y Loss: 0.773746
T Loss: 10.386772
Epoch 999 
Overall Loss: 12.142139
Rec Loss: 10.770103
KL Loss: 1.372036
Y Loss: 0.767503
T Loss: 10.386352
Epoch 1049 
Overall Loss: 12.117070
Rec Loss: 10.739478
KL Loss: 1.377592
Y Loss: 0.775552
T Loss: 10.351702
Epoch 1099 
Overall Loss: 12.134516
Rec Loss: 10.750767
KL Loss: 1.383750
Y Loss: 0.769117
T Loss: 10.366208
Epoch 1149 
Overall Loss: 12.113364
Rec Loss: 10.754596
KL Loss: 1.358768
Y Loss: 0.783894
T Loss: 10.362649
Epoch 1199 
Overall Loss: 12.124352
Rec Loss: 10.755022
KL Loss: 1.369329
Y Loss: 0.790741
T Loss: 10.359652
Epoch 1249 
Overall Loss: 12.114795
Rec Loss: 10.752002
KL Loss: 1.362792
Y Loss: 0.773716
T Loss: 10.365145
Epoch 1299 
Overall Loss: 12.095475
Rec Loss: 10.732955
KL Loss: 1.362520
Y Loss: 0.758429
T Loss: 10.353740
Epoch 1349 
Overall Loss: 12.098109
Rec Loss: 10.735474
KL Loss: 1.362635
Y Loss: 0.756060
T Loss: 10.357444
Epoch 1399 
Overall Loss: 12.095968
Rec Loss: 10.735724
KL Loss: 1.360244
Y Loss: 0.750725
T Loss: 10.360362
Epoch 1449 
Overall Loss: 12.087364
Rec Loss: 10.736682
KL Loss: 1.350682
Y Loss: 0.774773
T Loss: 10.349295
Epoch 1499 
Overall Loss: 12.109798
Rec Loss: 10.743409
KL Loss: 1.366390
Y Loss: 0.760783
T Loss: 10.363017
Epoch 1549 
Overall Loss: 12.080370
Rec Loss: 10.703585
KL Loss: 1.376786
Y Loss: 0.746114
T Loss: 10.330528
Epoch 1599 
Overall Loss: 12.078907
Rec Loss: 10.718730
KL Loss: 1.360177
Y Loss: 0.757494
T Loss: 10.339983
Epoch 1649 
Overall Loss: 12.063470
Rec Loss: 10.717838
KL Loss: 1.345632
Y Loss: 0.767223
T Loss: 10.334227
Epoch 1699 
Overall Loss: 12.064342
Rec Loss: 10.703636
KL Loss: 1.360705
Y Loss: 0.762207
T Loss: 10.322533
Epoch 1749 
Overall Loss: 12.074520
Rec Loss: 10.712841
KL Loss: 1.361679
Y Loss: 0.751894
T Loss: 10.336894
Epoch 1799 
Overall Loss: 12.070678
Rec Loss: 10.717659
KL Loss: 1.353019
Y Loss: 0.766755
T Loss: 10.334282
Epoch 1849 
Overall Loss: 12.059323
Rec Loss: 10.708252
KL Loss: 1.351071
Y Loss: 0.754130
T Loss: 10.331187
Epoch 1899 
Overall Loss: 12.054852
Rec Loss: 10.699704
KL Loss: 1.355148
Y Loss: 0.740066
T Loss: 10.329671
Epoch 1949 
Overall Loss: 12.060372
Rec Loss: 10.695308
KL Loss: 1.365064
Y Loss: 0.743822
T Loss: 10.323396
Epoch 1999 
Overall Loss: 12.048273
Rec Loss: 10.679360
KL Loss: 1.368913
Y Loss: 0.737787
T Loss: 10.310467
Epoch 2049 
Overall Loss: 12.058336
Rec Loss: 10.709614
KL Loss: 1.348721
Y Loss: 0.753939
T Loss: 10.332644
Epoch 2099 
Overall Loss: 12.033173
Rec Loss: 10.678561
KL Loss: 1.354611
Y Loss: 0.744857
T Loss: 10.306133
Epoch 2149 
Overall Loss: 12.049469
Rec Loss: 10.700138
KL Loss: 1.349331
Y Loss: 0.752090
T Loss: 10.324093
Epoch 2199 
Overall Loss: 12.044604
Rec Loss: 10.692955
KL Loss: 1.351650
Y Loss: 0.746038
T Loss: 10.319936
Epoch 2249 
Overall Loss: 12.033186
Rec Loss: 10.695970
KL Loss: 1.337216
Y Loss: 0.759016
T Loss: 10.316462
Epoch 2299 
Overall Loss: 12.026111
Rec Loss: 10.694003
KL Loss: 1.332109
Y Loss: 0.757325
T Loss: 10.315340
Epoch 2349 
Overall Loss: 12.011173
Rec Loss: 10.661299
KL Loss: 1.349874
Y Loss: 0.739152
T Loss: 10.291723
Epoch 2399 
Overall Loss: 12.012255
Rec Loss: 10.690054
KL Loss: 1.322202
Y Loss: 0.740823
T Loss: 10.319642
Epoch 2449 
Overall Loss: 12.026425
Rec Loss: 10.683655
KL Loss: 1.342770
Y Loss: 0.714567
T Loss: 10.326371
Epoch 2499 
Overall Loss: 12.009882
Rec Loss: 10.668041
KL Loss: 1.341841
Y Loss: 0.738219
T Loss: 10.298932
Epoch 2549 
Overall Loss: 12.015991
Rec Loss: 10.669342
KL Loss: 1.346649
Y Loss: 0.752637
T Loss: 10.293024
Epoch 2599 
Overall Loss: 12.010975
Rec Loss: 10.645924
KL Loss: 1.365052
Y Loss: 0.747501
T Loss: 10.272174
Epoch 2649 
Overall Loss: 12.010730
Rec Loss: 10.683907
KL Loss: 1.326824
Y Loss: 0.736152
T Loss: 10.315831
Epoch 2699 
Overall Loss: 11.992342
Rec Loss: 10.653311
KL Loss: 1.339031
Y Loss: 0.738060
T Loss: 10.284281
Epoch 2749 
Overall Loss: 11.970569
Rec Loss: 10.647712
KL Loss: 1.322856
Y Loss: 0.728148
T Loss: 10.283639
Epoch 2799 
Overall Loss: 11.980797
Rec Loss: 10.636372
KL Loss: 1.344425
Y Loss: 0.721968
T Loss: 10.275388
Epoch 2849 
Overall Loss: 11.990569
Rec Loss: 10.662409
KL Loss: 1.328160
Y Loss: 0.734180
T Loss: 10.295319
Epoch 2899 
Overall Loss: 11.988084
Rec Loss: 10.628095
KL Loss: 1.359989
Y Loss: 0.713435
T Loss: 10.271377
Epoch 2949 
Overall Loss: 11.971654
Rec Loss: 10.652630
KL Loss: 1.319024
Y Loss: 0.738798
T Loss: 10.283231
Epoch 2999 
Overall Loss: 11.963756
Rec Loss: 10.619193
KL Loss: 1.344564
Y Loss: 0.709357
T Loss: 10.264514
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.830815
Epoch 99
Rec Loss: 0.825199
Epoch 149
Rec Loss: 0.824713
Epoch 199
Rec Loss: 0.822118
Epoch 249
Rec Loss: 0.826573
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.928221
Epoch 99
Rec Loss: 9.916193
Epoch 149
Rec Loss: 9.903354
Epoch 199
Rec Loss: 9.888184
Epoch 249
Rec Loss: 9.886350
Epoch 299
Rec Loss: 9.859018
Epoch 349
Rec Loss: 9.872719
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.668918
Insample Error: 1.783630
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 23.596402
Rec Loss: 21.236813
KL Loss: 2.359589
Y Loss: 11.681780
T Loss: 13.122135
X Loss: 2.273789
Epoch 99 
Overall Loss: 17.170556
Rec Loss: 13.856552
KL Loss: 3.314005
Y Loss: 3.602107
T Loss: 12.962843
X Loss: -0.907345
Epoch 149 
Overall Loss: 15.802051
Rec Loss: 12.370073
KL Loss: 3.431978
Y Loss: 2.596414
T Loss: 12.844689
X Loss: -1.772823
Epoch 199 
Overall Loss: 15.232467
Rec Loss: 11.459395
KL Loss: 3.773072
Y Loss: 2.142237
T Loss: 12.494062
X Loss: -2.105785
Epoch 249 
Overall Loss: 14.695346
Rec Loss: 10.672176
KL Loss: 4.023170
Y Loss: 1.799723
T Loss: 12.106672
X Loss: -2.334358
Epoch 299 
Overall Loss: 14.252636
Rec Loss: 9.925150
KL Loss: 4.327486
Y Loss: 1.524073
T Loss: 11.660922
X Loss: -2.497809
Epoch 349 
Overall Loss: 13.974910
Rec Loss: 9.418203
KL Loss: 4.556707
Y Loss: 1.369801
T Loss: 11.415220
X Loss: -2.681918
Epoch 399 
Overall Loss: 13.690422
Rec Loss: 8.743229
KL Loss: 4.947194
Y Loss: 1.246250
T Loss: 11.166590
X Loss: -3.046487
Epoch 449 
Overall Loss: 13.532847
Rec Loss: 8.347747
KL Loss: 5.185100
Y Loss: 1.232177
T Loss: 11.016884
X Loss: -3.285226
Epoch 499 
Overall Loss: 13.468623
Rec Loss: 8.156005
KL Loss: 5.312618
Y Loss: 1.177553
T Loss: 10.972670
X Loss: -3.405441
Epoch 549 
Overall Loss: 13.395497
Rec Loss: 7.973709
KL Loss: 5.421788
Y Loss: 1.149640
T Loss: 10.951805
X Loss: -3.552916
Epoch 599 
Overall Loss: 13.354628
Rec Loss: 7.877368
KL Loss: 5.477259
Y Loss: 1.075494
T Loss: 10.956320
X Loss: -3.616698
Epoch 649 
Overall Loss: 13.320391
Rec Loss: 7.818286
KL Loss: 5.502105
Y Loss: 1.076249
T Loss: 10.928425
X Loss: -3.648264
Epoch 699 
Overall Loss: 13.247680
Rec Loss: 7.705998
KL Loss: 5.541682
Y Loss: 1.042050
T Loss: 10.910878
X Loss: -3.725905
Epoch 749 
Overall Loss: 13.232250
Rec Loss: 7.676194
KL Loss: 5.556057
Y Loss: 1.033528
T Loss: 10.920436
X Loss: -3.761006
Epoch 799 
Overall Loss: 13.193371
Rec Loss: 7.618072
KL Loss: 5.575299
Y Loss: 1.024484
T Loss: 10.908989
X Loss: -3.803159
Epoch 849 
Overall Loss: 13.170973
Rec Loss: 7.589458
KL Loss: 5.581514
Y Loss: 0.994593
T Loss: 10.920500
X Loss: -3.828338
Epoch 899 
Overall Loss: 13.179695
Rec Loss: 7.580479
KL Loss: 5.599216
Y Loss: 0.990013
T Loss: 10.922819
X Loss: -3.837346
Epoch 949 
Overall Loss: 13.152690
Rec Loss: 7.563425
KL Loss: 5.589265
Y Loss: 0.996302
T Loss: 10.925903
X Loss: -3.860628
Epoch 999 
Overall Loss: 13.128244
Rec Loss: 7.521005
KL Loss: 5.607239
Y Loss: 0.958941
T Loss: 10.928919
X Loss: -3.887385
Epoch 1049 
Overall Loss: 13.078156
Rec Loss: 7.491519
KL Loss: 5.586637
Y Loss: 0.938784
T Loss: 10.931588
X Loss: -3.909461
Epoch 1099 
Overall Loss: 13.106675
Rec Loss: 7.504230
KL Loss: 5.602445
Y Loss: 0.971269
T Loss: 10.928114
X Loss: -3.909518
Epoch 1149 
Overall Loss: 13.036162
Rec Loss: 7.402981
KL Loss: 5.633181
Y Loss: 0.929197
T Loss: 10.918455
X Loss: -3.980072
Epoch 1199 
Overall Loss: 13.069792
Rec Loss: 7.455532
KL Loss: 5.614260
Y Loss: 0.944765
T Loss: 10.961580
X Loss: -3.978431
Epoch 1249 
Overall Loss: 13.040109
Rec Loss: 7.418268
KL Loss: 5.621841
Y Loss: 0.939702
T Loss: 10.948396
X Loss: -3.999979
Epoch 1299 
Overall Loss: 13.038191
Rec Loss: 7.385945
KL Loss: 5.652246
Y Loss: 0.933108
T Loss: 10.919529
X Loss: -4.000137
Epoch 1349 
Overall Loss: 13.029982
Rec Loss: 7.352608
KL Loss: 5.677374
Y Loss: 0.940464
T Loss: 10.940188
X Loss: -4.057811
Epoch 1399 
Overall Loss: 12.998445
Rec Loss: 7.308477
KL Loss: 5.689968
Y Loss: 0.909206
T Loss: 10.918262
X Loss: -4.064388
Epoch 1449 
Overall Loss: 13.008873
Rec Loss: 7.322210
KL Loss: 5.686663
Y Loss: 0.922842
T Loss: 10.957792
X Loss: -4.097003
Epoch 1499 
Overall Loss: 13.031175
Rec Loss: 7.321811
KL Loss: 5.709364
Y Loss: 0.935916
T Loss: 10.967343
X Loss: -4.113490
Epoch 1549 
Overall Loss: 12.999489
Rec Loss: 7.283251
KL Loss: 5.716238
Y Loss: 0.925893
T Loss: 10.962004
X Loss: -4.141699
Epoch 1599 
Overall Loss: 12.972679
Rec Loss: 7.261911
KL Loss: 5.710768
Y Loss: 0.920347
T Loss: 10.966953
X Loss: -4.165215
Epoch 1649 
Overall Loss: 12.960894
Rec Loss: 7.194522
KL Loss: 5.766372
Y Loss: 0.934018
T Loss: 10.962434
X Loss: -4.234922
Epoch 1699 
Overall Loss: 12.949666
Rec Loss: 7.171664
KL Loss: 5.778002
Y Loss: 0.896083
T Loss: 10.952836
X Loss: -4.229213
Epoch 1749 
Overall Loss: 12.964608
Rec Loss: 7.184749
KL Loss: 5.779860
Y Loss: 0.912637
T Loss: 10.988648
X Loss: -4.260218
Epoch 1799 
Overall Loss: 12.946790
Rec Loss: 7.136035
KL Loss: 5.810755
Y Loss: 0.894625
T Loss: 10.979652
X Loss: -4.290929
Epoch 1849 
Overall Loss: 12.940974
Rec Loss: 7.106513
KL Loss: 5.834460
Y Loss: 0.921698
T Loss: 10.980704
X Loss: -4.335040
Epoch 1899 
Overall Loss: 12.926546
Rec Loss: 7.059014
KL Loss: 5.867531
Y Loss: 0.901496
T Loss: 10.992581
X Loss: -4.384314
Epoch 1949 
Overall Loss: 12.928218
Rec Loss: 7.042848
KL Loss: 5.885370
Y Loss: 0.892535
T Loss: 10.994400
X Loss: -4.397819
Epoch 1999 
Overall Loss: 12.939221
Rec Loss: 7.051098
KL Loss: 5.888123
Y Loss: 0.918607
T Loss: 11.006752
X Loss: -4.414957
Epoch 2049 
Overall Loss: 12.917153
Rec Loss: 7.006445
KL Loss: 5.910708
Y Loss: 0.915459
T Loss: 11.004318
X Loss: -4.455603
Epoch 2099 
Overall Loss: 12.899134
Rec Loss: 6.992041
KL Loss: 5.907093
Y Loss: 0.892877
T Loss: 11.012775
X Loss: -4.467173
Epoch 2149 
Overall Loss: 12.906340
Rec Loss: 6.967507
KL Loss: 5.938833
Y Loss: 0.911398
T Loss: 11.018747
X Loss: -4.506939
Epoch 2199 
Overall Loss: 12.910699
Rec Loss: 6.964089
KL Loss: 5.946609
Y Loss: 0.903495
T Loss: 11.020007
X Loss: -4.507665
Epoch 2249 
Overall Loss: 12.902782
Rec Loss: 6.908035
KL Loss: 5.994747
Y Loss: 0.889504
T Loss: 11.006463
X Loss: -4.543180
Epoch 2299 
Overall Loss: 12.879750
Rec Loss: 6.896340
KL Loss: 5.983410
Y Loss: 0.903847
T Loss: 11.020637
X Loss: -4.576221
Epoch 2349 
Overall Loss: 12.879690
Rec Loss: 6.880477
KL Loss: 5.999213
Y Loss: 0.921184
T Loss: 11.011307
X Loss: -4.591421
Epoch 2399 
Overall Loss: 12.874816
Rec Loss: 6.845800
KL Loss: 6.029015
Y Loss: 0.899856
T Loss: 11.029353
X Loss: -4.633481
Epoch 2449 
Overall Loss: 12.898188
Rec Loss: 6.859050
KL Loss: 6.039138
Y Loss: 0.897958
T Loss: 11.030453
X Loss: -4.620382
Epoch 2499 
Overall Loss: 12.839273
Rec Loss: 6.789497
KL Loss: 6.049776
Y Loss: 0.892708
T Loss: 11.020957
X Loss: -4.677815
Epoch 2549 
Overall Loss: 12.837207
Rec Loss: 6.776408
KL Loss: 6.060799
Y Loss: 0.886738
T Loss: 11.022369
X Loss: -4.689330
Epoch 2599 
Overall Loss: 12.850340
Rec Loss: 6.758715
KL Loss: 6.091625
Y Loss: 0.903735
T Loss: 11.029346
X Loss: -4.722498
Epoch 2649 
Overall Loss: 12.838422
Rec Loss: 6.774726
KL Loss: 6.063696
Y Loss: 0.904867
T Loss: 11.020898
X Loss: -4.698606
Epoch 2699 
Overall Loss: 12.826280
Rec Loss: 6.719789
KL Loss: 6.106491
Y Loss: 0.885821
T Loss: 11.015558
X Loss: -4.738679
Epoch 2749 
Overall Loss: 12.802357
Rec Loss: 6.703975
KL Loss: 6.098382
Y Loss: 0.898408
T Loss: 11.031228
X Loss: -4.776456
Epoch 2799 
Overall Loss: 12.851913
Rec Loss: 6.728648
KL Loss: 6.123265
Y Loss: 0.913626
T Loss: 11.043022
X Loss: -4.771188
Epoch 2849 
Overall Loss: 12.844631
Rec Loss: 6.717708
KL Loss: 6.126923
Y Loss: 0.894001
T Loss: 11.037302
X Loss: -4.766594
Epoch 2899 
Overall Loss: 12.840686
Rec Loss: 6.678767
KL Loss: 6.161919
Y Loss: 0.901204
T Loss: 11.041793
X Loss: -4.813627
Epoch 2949 
Overall Loss: 12.825594
Rec Loss: 6.657936
KL Loss: 6.167658
Y Loss: 0.896137
T Loss: 11.030454
X Loss: -4.820586
Epoch 2999 
Overall Loss: 12.826008
Rec Loss: 6.649955
KL Loss: 6.176053
Y Loss: 0.901658
T Loss: 11.035793
X Loss: -4.836667
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.562079
Epoch 99
Rec Loss: 1.567049
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.010297
Epoch 99
Rec Loss: 2.008327
Epoch 149
Rec Loss: 1.999236
Epoch 199
Rec Loss: 1.997785
Epoch 249
Rec Loss: 2.004011
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.672203
Insample Error 2.546181
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.894353
Epoch 99 
Prediction Loss: 1.741351
Epoch 149 
Prediction Loss: 1.601643
Epoch 199 
Prediction Loss: 1.556724
Epoch 249 
Prediction Loss: 1.485789
Epoch 299 
Prediction Loss: 1.372436
Epoch 349 
Prediction Loss: 1.299010
Epoch 399 
Prediction Loss: 1.312155
Epoch 449 
Prediction Loss: 1.203609
Epoch 499 
Prediction Loss: 1.198777
Epoch 549 
Prediction Loss: 1.089568
Epoch 599 
Prediction Loss: 1.046906
Epoch 649 
Prediction Loss: 1.024131
Epoch 699 
Prediction Loss: 0.972637
Epoch 749 
Prediction Loss: 0.930598
Epoch 799 
Prediction Loss: 0.912363
Epoch 849 
Prediction Loss: 0.920279
Epoch 899 
Prediction Loss: 0.840916
Epoch 949 
Prediction Loss: 0.820515
Epoch 999 
Prediction Loss: 0.811518
Epoch 1049 
Prediction Loss: 0.777621
Epoch 1099 
Prediction Loss: 0.747050
Epoch 1149 
Prediction Loss: 0.742147
Epoch 1199 
Prediction Loss: 0.709529
Epoch 1249 
Prediction Loss: 0.722952
Epoch 1299 
Prediction Loss: 0.694307
Epoch 1349 
Prediction Loss: 0.692457
Epoch 1399 
Prediction Loss: 0.704063
Epoch 1449 
Prediction Loss: 0.651121
Epoch 1499 
Prediction Loss: 0.671344
Epoch 1549 
Prediction Loss: 0.642123
Epoch 1599 
Prediction Loss: 0.661547
Epoch 1649 
Prediction Loss: 0.615981
Epoch 1699 
Prediction Loss: 0.599058
Epoch 1749 
Prediction Loss: 0.589699
Epoch 1799 
Prediction Loss: 0.602372
Epoch 1849 
Prediction Loss: 0.585165
Epoch 1899 
Prediction Loss: 0.595932
Epoch 1949 
Prediction Loss: 0.586984
Epoch 1999 
Prediction Loss: 0.576293
Epoch 2049 
Prediction Loss: 0.596948
Epoch 2099 
Prediction Loss: 0.541594
Epoch 2149 
Prediction Loss: 0.557828
Epoch 2199 
Prediction Loss: 0.546654
Epoch 2249 
Prediction Loss: 0.539720
Epoch 2299 
Prediction Loss: 0.549718
Epoch 2349 
Prediction Loss: 0.519203
Epoch 2399 
Prediction Loss: 0.549152
Epoch 2449 
Prediction Loss: 0.518225
Epoch 2499 
Prediction Loss: 0.531402
Epoch 2549 
Prediction Loss: 0.522428
Epoch 2599 
Prediction Loss: 0.515465
Epoch 2649 
Prediction Loss: 0.512669
Epoch 2699 
Prediction Loss: 0.521920
Epoch 2749 
Prediction Loss: 0.498513
Epoch 2799 
Prediction Loss: 0.506603
Epoch 2849 
Prediction Loss: 0.509939
Epoch 2899 
Prediction Loss: 0.492768
Epoch 2949 
Prediction Loss: 0.489599
Epoch 2999 
Prediction Loss: 0.498253
Epoch 3049 
Prediction Loss: 0.487654
Epoch 3099 
Prediction Loss: 0.488760
Epoch 3149 
Prediction Loss: 0.492192
Epoch 3199 
Prediction Loss: 0.473234
Epoch 3249 
Prediction Loss: 0.509567
Epoch 3299 
Prediction Loss: 0.473347
Epoch 3349 
Prediction Loss: 0.492677
Epoch 3399 
Prediction Loss: 0.469784
Epoch 3449 
Prediction Loss: 0.480824
Epoch 3499 
Prediction Loss: 0.461269
Epoch 3549 
Prediction Loss: 0.467133
Epoch 3599 
Prediction Loss: 0.460003
Epoch 3649 
Prediction Loss: 0.468649
Epoch 3699 
Prediction Loss: 0.465541
Epoch 3749 
Prediction Loss: 0.468188
Epoch 3799 
Prediction Loss: 0.447653
Epoch 3849 
Prediction Loss: 0.455163
Epoch 3899 
Prediction Loss: 0.450302
Epoch 3949 
Prediction Loss: 0.471384
Epoch 3999 
Prediction Loss: 0.460063
Epoch 4049 
Prediction Loss: 0.445561
Epoch 4099 
Prediction Loss: 0.474144
Epoch 4149 
Prediction Loss: 0.453141
Epoch 4199 
Prediction Loss: 0.483983
Epoch 4249 
Prediction Loss: 0.444410
Epoch 4299 
Prediction Loss: 0.437700
Epoch 4349 
Prediction Loss: 0.439031
Epoch 4399 
Prediction Loss: 0.434671
Epoch 4449 
Prediction Loss: 0.438664
Epoch 4499 
Prediction Loss: 0.443540
Epoch 4549 
Prediction Loss: 0.443182
Epoch 4599 
Prediction Loss: 0.426330
Epoch 4649 
Prediction Loss: 0.426465
Epoch 4699 
Prediction Loss: 0.449917
Epoch 4749 
Prediction Loss: 0.462365
Epoch 4799 
Prediction Loss: 0.432229
Epoch 4849 
Prediction Loss: 0.431260
Epoch 4899 
Prediction Loss: 0.455122
Epoch 4949 
Prediction Loss: 0.433010
Epoch 4999 
Prediction Loss: 0.424162
Epoch 5049 
Prediction Loss: 0.422557
Epoch 5099 
Prediction Loss: 0.420072
Epoch 5149 
Prediction Loss: 0.434081
Epoch 5199 
Prediction Loss: 0.426884
Epoch 5249 
Prediction Loss: 0.425616
Epoch 5299 
Prediction Loss: 0.426590
Epoch 5349 
Prediction Loss: 0.413933
Epoch 5399 
Prediction Loss: 0.431886
Epoch 5449 
Prediction Loss: 0.431912
Epoch 5499 
Prediction Loss: 0.431568
Epoch 5549 
Prediction Loss: 0.413233
Epoch 5599 
Prediction Loss: 0.426665
Epoch 5649 
Prediction Loss: 0.413122
Epoch 5699 
Prediction Loss: 0.427119
Epoch 5749 
Prediction Loss: 0.415279
Epoch 5799 
Prediction Loss: 0.425054
Epoch 5849 
Prediction Loss: 0.418423
Epoch 5899 
Prediction Loss: 0.415042
Epoch 5949 
Prediction Loss: 0.412934
Epoch 5999 
Prediction Loss: 0.406718
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.630062
Insample Error 2.988080
[31m========== repeat time 7 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.899587
Rec Loss: 11.487363
KL Loss: 1.412225
Y Loss: 1.052055
T Loss: 10.961335
Epoch 99 
Overall Loss: 12.440472
Rec Loss: 10.796551
KL Loss: 1.643920
Y Loss: 0.887466
T Loss: 10.352819
Epoch 149 
Overall Loss: 12.345236
Rec Loss: 10.811681
KL Loss: 1.533554
Y Loss: 0.835966
T Loss: 10.393699
Epoch 199 
Overall Loss: 12.289478
Rec Loss: 10.817682
KL Loss: 1.471796
Y Loss: 0.854017
T Loss: 10.390674
Epoch 249 
Overall Loss: 12.281522
Rec Loss: 10.821166
KL Loss: 1.460355
Y Loss: 0.823244
T Loss: 10.409544
Epoch 299 
Overall Loss: 12.247478
Rec Loss: 10.827352
KL Loss: 1.420126
Y Loss: 0.842410
T Loss: 10.406147
Epoch 349 
Overall Loss: 12.253929
Rec Loss: 10.818184
KL Loss: 1.435744
Y Loss: 0.825225
T Loss: 10.405572
Epoch 399 
Overall Loss: 12.237911
Rec Loss: 10.821455
KL Loss: 1.416456
Y Loss: 0.815088
T Loss: 10.413911
Epoch 449 
Overall Loss: 12.206589
Rec Loss: 10.799672
KL Loss: 1.406918
Y Loss: 0.811775
T Loss: 10.393785
Epoch 499 
Overall Loss: 12.222888
Rec Loss: 10.809327
KL Loss: 1.413561
Y Loss: 0.810479
T Loss: 10.404087
Epoch 549 
Overall Loss: 12.202790
Rec Loss: 10.793328
KL Loss: 1.409461
Y Loss: 0.800699
T Loss: 10.392978
Epoch 599 
Overall Loss: 12.167729
Rec Loss: 10.776827
KL Loss: 1.390903
Y Loss: 0.788239
T Loss: 10.382707
Epoch 649 
Overall Loss: 12.191242
Rec Loss: 10.786886
KL Loss: 1.404355
Y Loss: 0.782065
T Loss: 10.395853
Epoch 699 
Overall Loss: 12.179413
Rec Loss: 10.782073
KL Loss: 1.397340
Y Loss: 0.794985
T Loss: 10.384580
Epoch 749 
Overall Loss: 12.155594
Rec Loss: 10.774639
KL Loss: 1.380955
Y Loss: 0.794064
T Loss: 10.377607
Epoch 799 
Overall Loss: 12.161733
Rec Loss: 10.795783
KL Loss: 1.365950
Y Loss: 0.787294
T Loss: 10.402137
Epoch 849 
Overall Loss: 12.148141
Rec Loss: 10.778454
KL Loss: 1.369687
Y Loss: 0.779583
T Loss: 10.388662
Epoch 899 
Overall Loss: 12.141333
Rec Loss: 10.756719
KL Loss: 1.384613
Y Loss: 0.780098
T Loss: 10.366670
Epoch 949 
Overall Loss: 12.151415
Rec Loss: 10.758995
KL Loss: 1.392420
Y Loss: 0.776347
T Loss: 10.370821
Epoch 999 
Overall Loss: 12.151975
Rec Loss: 10.753774
KL Loss: 1.398201
Y Loss: 0.755012
T Loss: 10.376268
Epoch 1049 
Overall Loss: 12.134187
Rec Loss: 10.762002
KL Loss: 1.372185
Y Loss: 0.764705
T Loss: 10.379649
Epoch 1099 
Overall Loss: 12.116893
Rec Loss: 10.764665
KL Loss: 1.352229
Y Loss: 0.752078
T Loss: 10.388626
Epoch 1149 
Overall Loss: 12.110070
Rec Loss: 10.751191
KL Loss: 1.358880
Y Loss: 0.754862
T Loss: 10.373759
Epoch 1199 
Overall Loss: 12.116190
Rec Loss: 10.762915
KL Loss: 1.353275
Y Loss: 0.766169
T Loss: 10.379831
Epoch 1249 
Overall Loss: 12.099026
Rec Loss: 10.750000
KL Loss: 1.349027
Y Loss: 0.775605
T Loss: 10.362197
Epoch 1299 
Overall Loss: 12.096514
Rec Loss: 10.724588
KL Loss: 1.371926
Y Loss: 0.760211
T Loss: 10.344482
Epoch 1349 
Overall Loss: 12.096093
Rec Loss: 10.753808
KL Loss: 1.342285
Y Loss: 0.760366
T Loss: 10.373625
Epoch 1399 
Overall Loss: 12.103968
Rec Loss: 10.734364
KL Loss: 1.369604
Y Loss: 0.751680
T Loss: 10.358524
Epoch 1449 
Overall Loss: 12.085566
Rec Loss: 10.732645
KL Loss: 1.352921
Y Loss: 0.748412
T Loss: 10.358439
Epoch 1499 
Overall Loss: 12.073712
Rec Loss: 10.727399
KL Loss: 1.346313
Y Loss: 0.738793
T Loss: 10.358002
Epoch 1549 
Overall Loss: 12.089181
Rec Loss: 10.745723
KL Loss: 1.343458
Y Loss: 0.759810
T Loss: 10.365818
Epoch 1599 
Overall Loss: 12.061984
Rec Loss: 10.731683
KL Loss: 1.330300
Y Loss: 0.736059
T Loss: 10.363653
Epoch 1649 
Overall Loss: 12.069047
Rec Loss: 10.729891
KL Loss: 1.339156
Y Loss: 0.753278
T Loss: 10.353253
Epoch 1699 
Overall Loss: 12.061665
Rec Loss: 10.728255
KL Loss: 1.333410
Y Loss: 0.754039
T Loss: 10.351235
Epoch 1749 
Overall Loss: 12.062463
Rec Loss: 10.710245
KL Loss: 1.352219
Y Loss: 0.739822
T Loss: 10.340334
Epoch 1799 
Overall Loss: 12.060087
Rec Loss: 10.711548
KL Loss: 1.348540
Y Loss: 0.752070
T Loss: 10.335512
Epoch 1849 
Overall Loss: 12.049970
Rec Loss: 10.725378
KL Loss: 1.324592
Y Loss: 0.752936
T Loss: 10.348910
Epoch 1899 
Overall Loss: 12.062329
Rec Loss: 10.720516
KL Loss: 1.341813
Y Loss: 0.740949
T Loss: 10.350041
Epoch 1949 
Overall Loss: 12.059140
Rec Loss: 10.719278
KL Loss: 1.339862
Y Loss: 0.751002
T Loss: 10.343776
Epoch 1999 
Overall Loss: 12.050437
Rec Loss: 10.697558
KL Loss: 1.352879
Y Loss: 0.721128
T Loss: 10.336994
Epoch 2049 
Overall Loss: 12.047475
Rec Loss: 10.704931
KL Loss: 1.342544
Y Loss: 0.745407
T Loss: 10.332228
Epoch 2099 
Overall Loss: 12.032810
Rec Loss: 10.709498
KL Loss: 1.323312
Y Loss: 0.730216
T Loss: 10.344391
Epoch 2149 
Overall Loss: 12.043156
Rec Loss: 10.717191
KL Loss: 1.325966
Y Loss: 0.744485
T Loss: 10.344948
Epoch 2199 
Overall Loss: 12.045411
Rec Loss: 10.689457
KL Loss: 1.355954
Y Loss: 0.717102
T Loss: 10.330906
Epoch 2249 
Overall Loss: 12.001098
Rec Loss: 10.676627
KL Loss: 1.324471
Y Loss: 0.727028
T Loss: 10.313113
Epoch 2299 
Overall Loss: 12.020527
Rec Loss: 10.692099
KL Loss: 1.328429
Y Loss: 0.722905
T Loss: 10.330646
Epoch 2349 
Overall Loss: 12.008522
Rec Loss: 10.686142
KL Loss: 1.322380
Y Loss: 0.737963
T Loss: 10.317160
Epoch 2399 
Overall Loss: 12.010534
Rec Loss: 10.699963
KL Loss: 1.310571
Y Loss: 0.726932
T Loss: 10.336497
Epoch 2449 
Overall Loss: 12.007444
Rec Loss: 10.687026
KL Loss: 1.320418
Y Loss: 0.737570
T Loss: 10.318241
Epoch 2499 
Overall Loss: 12.002738
Rec Loss: 10.675342
KL Loss: 1.327397
Y Loss: 0.731052
T Loss: 10.309816
Epoch 2549 
Overall Loss: 12.010034
Rec Loss: 10.690036
KL Loss: 1.319998
Y Loss: 0.727476
T Loss: 10.326298
Epoch 2599 
Overall Loss: 11.988122
Rec Loss: 10.650747
KL Loss: 1.337376
Y Loss: 0.715229
T Loss: 10.293132
Epoch 2649 
Overall Loss: 12.007390
Rec Loss: 10.656368
KL Loss: 1.351022
Y Loss: 0.711349
T Loss: 10.300693
Epoch 2699 
Overall Loss: 11.979498
Rec Loss: 10.661030
KL Loss: 1.318469
Y Loss: 0.705248
T Loss: 10.308406
Epoch 2749 
Overall Loss: 11.992489
Rec Loss: 10.677826
KL Loss: 1.314663
Y Loss: 0.712671
T Loss: 10.321490
Epoch 2799 
Overall Loss: 11.985551
Rec Loss: 10.675833
KL Loss: 1.309718
Y Loss: 0.727912
T Loss: 10.311877
Epoch 2849 
Overall Loss: 11.983318
Rec Loss: 10.654693
KL Loss: 1.328625
Y Loss: 0.702036
T Loss: 10.303675
Epoch 2899 
Overall Loss: 11.989461
Rec Loss: 10.648225
KL Loss: 1.341237
Y Loss: 0.713935
T Loss: 10.291257
Epoch 2949 
Overall Loss: 11.979709
Rec Loss: 10.670416
KL Loss: 1.309293
Y Loss: 0.729638
T Loss: 10.305597
Epoch 2999 
Overall Loss: 11.981985
Rec Loss: 10.633919
KL Loss: 1.348066
Y Loss: 0.681658
T Loss: 10.293090
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.831442
Epoch 99
Rec Loss: 0.826228
Epoch 149
Rec Loss: 0.829600
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.914180
Epoch 99
Rec Loss: 9.893881
Epoch 149
Rec Loss: 9.872538
Epoch 199
Rec Loss: 9.880839
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.661962
Insample Error: 1.797687
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 23.261748
Rec Loss: 20.455555
KL Loss: 2.806193
Y Loss: 11.691510
T Loss: 13.014285
X Loss: 1.595515
Epoch 99 
Overall Loss: 17.220927
Rec Loss: 13.696662
KL Loss: 3.524266
Y Loss: 3.134025
T Loss: 12.870433
X Loss: -0.740784
Epoch 149 
Overall Loss: 15.891058
Rec Loss: 12.476205
KL Loss: 3.414852
Y Loss: 2.110743
T Loss: 12.801772
X Loss: -1.380938
Epoch 199 
Overall Loss: 14.801903
Rec Loss: 10.848552
KL Loss: 3.953351
Y Loss: 1.351221
T Loss: 12.204496
X Loss: -2.031555
Epoch 249 
Overall Loss: 14.316981
Rec Loss: 9.998698
KL Loss: 4.318284
Y Loss: 1.072948
T Loss: 11.801227
X Loss: -2.339003
Epoch 299 
Overall Loss: 14.070026
Rec Loss: 9.625525
KL Loss: 4.444500
Y Loss: 1.043868
T Loss: 11.659014
X Loss: -2.555422
Epoch 349 
Overall Loss: 13.937057
Rec Loss: 9.392626
KL Loss: 4.544431
Y Loss: 1.013522
T Loss: 11.579698
X Loss: -2.693832
Epoch 399 
Overall Loss: 13.818540
Rec Loss: 9.192169
KL Loss: 4.626371
Y Loss: 0.977582
T Loss: 11.496582
X Loss: -2.793204
Epoch 449 
Overall Loss: 13.729007
Rec Loss: 9.025299
KL Loss: 4.703708
Y Loss: 0.960206
T Loss: 11.428927
X Loss: -2.883731
Epoch 499 
Overall Loss: 13.656525
Rec Loss: 8.956783
KL Loss: 4.699742
Y Loss: 0.928518
T Loss: 11.382869
X Loss: -2.890345
Epoch 549 
Overall Loss: 13.632179
Rec Loss: 8.867429
KL Loss: 4.764750
Y Loss: 0.943164
T Loss: 11.366231
X Loss: -2.970384
Epoch 599 
Overall Loss: 13.475923
Rec Loss: 8.570388
KL Loss: 4.905535
Y Loss: 0.916072
T Loss: 11.250432
X Loss: -3.138080
Epoch 649 
Overall Loss: 13.293773
Rec Loss: 7.983052
KL Loss: 5.310722
Y Loss: 0.925995
T Loss: 10.963501
X Loss: -3.443447
Epoch 699 
Overall Loss: 13.201605
Rec Loss: 7.751450
KL Loss: 5.450156
Y Loss: 0.938115
T Loss: 10.896171
X Loss: -3.613779
Epoch 749 
Overall Loss: 13.149504
Rec Loss: 7.662330
KL Loss: 5.487174
Y Loss: 0.931480
T Loss: 10.872130
X Loss: -3.675540
Epoch 799 
Overall Loss: 13.144691
Rec Loss: 7.598298
KL Loss: 5.546393
Y Loss: 0.902928
T Loss: 10.879195
X Loss: -3.732361
Epoch 849 
Overall Loss: 13.146261
Rec Loss: 7.548417
KL Loss: 5.597844
Y Loss: 0.910293
T Loss: 10.887520
X Loss: -3.794249
Epoch 899 
Overall Loss: 13.112565
Rec Loss: 7.489837
KL Loss: 5.622728
Y Loss: 0.891650
T Loss: 10.881367
X Loss: -3.837355
Epoch 949 
Overall Loss: 13.092372
Rec Loss: 7.454794
KL Loss: 5.637578
Y Loss: 0.908007
T Loss: 10.887344
X Loss: -3.886553
Epoch 999 
Overall Loss: 13.105563
Rec Loss: 7.449806
KL Loss: 5.655756
Y Loss: 0.922227
T Loss: 10.893426
X Loss: -3.904733
Epoch 1049 
Overall Loss: 13.024392
Rec Loss: 7.333041
KL Loss: 5.691351
Y Loss: 0.885458
T Loss: 10.887981
X Loss: -3.997669
Epoch 1099 
Overall Loss: 13.030478
Rec Loss: 7.319663
KL Loss: 5.710816
Y Loss: 0.887223
T Loss: 10.888089
X Loss: -4.012038
Epoch 1149 
Overall Loss: 13.003952
Rec Loss: 7.275436
KL Loss: 5.728516
Y Loss: 0.869585
T Loss: 10.884201
X Loss: -4.043558
Epoch 1199 
Overall Loss: 13.031671
Rec Loss: 7.244871
KL Loss: 5.786799
Y Loss: 0.871992
T Loss: 10.894250
X Loss: -4.085374
Epoch 1249 
Overall Loss: 12.999825
Rec Loss: 7.226850
KL Loss: 5.772974
Y Loss: 0.867392
T Loss: 10.918064
X Loss: -4.124909
Epoch 1299 
Overall Loss: 12.980513
Rec Loss: 7.179310
KL Loss: 5.801204
Y Loss: 0.884291
T Loss: 10.902123
X Loss: -4.164959
Epoch 1349 
Overall Loss: 12.987456
Rec Loss: 7.166200
KL Loss: 5.821256
Y Loss: 0.878664
T Loss: 10.905998
X Loss: -4.179130
Epoch 1399 
Overall Loss: 13.001615
Rec Loss: 7.149294
KL Loss: 5.852321
Y Loss: 0.869662
T Loss: 10.904197
X Loss: -4.189734
Epoch 1449 
Overall Loss: 12.963959
Rec Loss: 7.112821
KL Loss: 5.851138
Y Loss: 0.885210
T Loss: 10.913122
X Loss: -4.242907
Epoch 1499 
Overall Loss: 12.930927
Rec Loss: 7.027920
KL Loss: 5.903006
Y Loss: 0.857876
T Loss: 10.916015
X Loss: -4.317032
Epoch 1549 
Overall Loss: 12.979465
Rec Loss: 7.098799
KL Loss: 5.880666
Y Loss: 0.889437
T Loss: 10.933083
X Loss: -4.279002
Epoch 1599 
Overall Loss: 12.948067
Rec Loss: 7.027146
KL Loss: 5.920921
Y Loss: 0.875203
T Loss: 10.941406
X Loss: -4.351861
Epoch 1649 
Overall Loss: 12.924200
Rec Loss: 7.010356
KL Loss: 5.913844
Y Loss: 0.867443
T Loss: 10.950360
X Loss: -4.373726
Epoch 1699 
Overall Loss: 12.934105
Rec Loss: 6.980946
KL Loss: 5.953159
Y Loss: 0.882076
T Loss: 10.926227
X Loss: -4.386319
Epoch 1749 
Overall Loss: 12.961871
Rec Loss: 6.981249
KL Loss: 5.980621
Y Loss: 0.865945
T Loss: 10.937296
X Loss: -4.389020
Epoch 1799 
Overall Loss: 12.903089
Rec Loss: 6.917465
KL Loss: 5.985624
Y Loss: 0.873955
T Loss: 10.952095
X Loss: -4.471607
Epoch 1849 
Overall Loss: 12.915126
Rec Loss: 6.937830
KL Loss: 5.977296
Y Loss: 0.897713
T Loss: 10.960913
X Loss: -4.471940
Epoch 1899 
Overall Loss: 12.926427
Rec Loss: 6.921762
KL Loss: 6.004665
Y Loss: 0.877810
T Loss: 10.952644
X Loss: -4.469787
Epoch 1949 
Overall Loss: 12.907275
Rec Loss: 6.890953
KL Loss: 6.016322
Y Loss: 0.864810
T Loss: 10.964488
X Loss: -4.505940
Epoch 1999 
Overall Loss: 12.902153
Rec Loss: 6.875841
KL Loss: 6.026312
Y Loss: 0.887252
T Loss: 10.965131
X Loss: -4.532916
Epoch 2049 
Overall Loss: 12.909265
Rec Loss: 6.862374
KL Loss: 6.046890
Y Loss: 0.891064
T Loss: 10.981140
X Loss: -4.564298
Epoch 2099 
Overall Loss: 12.893454
Rec Loss: 6.816666
KL Loss: 6.076788
Y Loss: 0.876945
T Loss: 10.982226
X Loss: -4.604033
Epoch 2149 
Overall Loss: 12.901926
Rec Loss: 6.804636
KL Loss: 6.097290
Y Loss: 0.856420
T Loss: 10.992694
X Loss: -4.616268
Epoch 2199 
Overall Loss: 12.885150
Rec Loss: 6.779791
KL Loss: 6.105359
Y Loss: 0.870042
T Loss: 10.991809
X Loss: -4.647038
Epoch 2249 
Overall Loss: 12.864603
Rec Loss: 6.759837
KL Loss: 6.104767
Y Loss: 0.875561
T Loss: 11.000618
X Loss: -4.678562
Epoch 2299 
Overall Loss: 12.885874
Rec Loss: 6.748950
KL Loss: 6.136924
Y Loss: 0.892107
T Loss: 10.986983
X Loss: -4.684087
Epoch 2349 
Overall Loss: 12.851136
Rec Loss: 6.691262
KL Loss: 6.159874
Y Loss: 0.901944
T Loss: 10.996605
X Loss: -4.756315
Epoch 2399 
Overall Loss: 12.872163
Rec Loss: 6.664780
KL Loss: 6.207383
Y Loss: 0.870733
T Loss: 11.005680
X Loss: -4.776266
Epoch 2449 
Overall Loss: 12.838543
Rec Loss: 6.672421
KL Loss: 6.166121
Y Loss: 0.872597
T Loss: 10.992427
X Loss: -4.756304
Epoch 2499 
Overall Loss: 12.901052
Rec Loss: 6.677795
KL Loss: 6.223257
Y Loss: 0.886853
T Loss: 11.017700
X Loss: -4.783331
Epoch 2549 
Overall Loss: 12.860208
Rec Loss: 6.621676
KL Loss: 6.238532
Y Loss: 0.878729
T Loss: 11.009898
X Loss: -4.827586
Epoch 2599 
Overall Loss: 12.861550
Rec Loss: 6.599290
KL Loss: 6.262260
Y Loss: 0.858393
T Loss: 11.012675
X Loss: -4.842582
Epoch 2649 
Overall Loss: 12.833328
Rec Loss: 6.549691
KL Loss: 6.283636
Y Loss: 0.865366
T Loss: 11.021085
X Loss: -4.904077
Epoch 2699 
Overall Loss: 12.813985
Rec Loss: 6.528137
KL Loss: 6.285848
Y Loss: 0.888602
T Loss: 11.020039
X Loss: -4.936203
Epoch 2749 
Overall Loss: 12.848347
Rec Loss: 6.527150
KL Loss: 6.321198
Y Loss: 0.873118
T Loss: 11.038299
X Loss: -4.947709
Epoch 2799 
Overall Loss: 12.842114
Rec Loss: 6.520427
KL Loss: 6.321686
Y Loss: 0.876290
T Loss: 11.044510
X Loss: -4.962228
Epoch 2849 
Overall Loss: 12.825580
Rec Loss: 6.492087
KL Loss: 6.333493
Y Loss: 0.887289
T Loss: 11.034916
X Loss: -4.986473
Epoch 2899 
Overall Loss: 12.849305
Rec Loss: 6.489989
KL Loss: 6.359316
Y Loss: 0.878330
T Loss: 11.046450
X Loss: -4.995626
Epoch 2949 
Overall Loss: 12.814835
Rec Loss: 6.454754
KL Loss: 6.360080
Y Loss: 0.878290
T Loss: 11.046208
X Loss: -5.030599
Epoch 2999 
Overall Loss: 12.832433
Rec Loss: 6.433575
KL Loss: 6.398858
Y Loss: 0.860851
T Loss: 11.042080
X Loss: -5.038931
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.508886
Epoch 99
Rec Loss: 1.499971
Epoch 149
Rec Loss: 1.506790
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.008992
Epoch 99
Rec Loss: 2.003088
Epoch 149
Rec Loss: 2.005736
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.662545
Insample Error 2.514511
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.871729
Epoch 99 
Prediction Loss: 1.735781
Epoch 149 
Prediction Loss: 1.667133
Epoch 199 
Prediction Loss: 1.588580
Epoch 249 
Prediction Loss: 1.496851
Epoch 299 
Prediction Loss: 1.395158
Epoch 349 
Prediction Loss: 1.354573
Epoch 399 
Prediction Loss: 1.291436
Epoch 449 
Prediction Loss: 1.269251
Epoch 499 
Prediction Loss: 1.182566
Epoch 549 
Prediction Loss: 1.192152
Epoch 599 
Prediction Loss: 1.124919
Epoch 649 
Prediction Loss: 1.067488
Epoch 699 
Prediction Loss: 1.029474
Epoch 749 
Prediction Loss: 1.033724
Epoch 799 
Prediction Loss: 0.989008
Epoch 849 
Prediction Loss: 0.952677
Epoch 899 
Prediction Loss: 0.881543
Epoch 949 
Prediction Loss: 0.836037
Epoch 999 
Prediction Loss: 0.822281
Epoch 1049 
Prediction Loss: 0.795967
Epoch 1099 
Prediction Loss: 0.781174
Epoch 1149 
Prediction Loss: 0.770926
Epoch 1199 
Prediction Loss: 0.749362
Epoch 1249 
Prediction Loss: 0.720509
Epoch 1299 
Prediction Loss: 0.703052
Epoch 1349 
Prediction Loss: 0.697087
Epoch 1399 
Prediction Loss: 0.701267
Epoch 1449 
Prediction Loss: 0.668034
Epoch 1499 
Prediction Loss: 0.667687
Epoch 1549 
Prediction Loss: 0.661413
Epoch 1599 
Prediction Loss: 0.632818
Epoch 1649 
Prediction Loss: 0.630441
Epoch 1699 
Prediction Loss: 0.639380
Epoch 1749 
Prediction Loss: 0.636181
Epoch 1799 
Prediction Loss: 0.647615
Epoch 1849 
Prediction Loss: 0.595165
Epoch 1899 
Prediction Loss: 0.626771
Epoch 1949 
Prediction Loss: 0.597782
Epoch 1999 
Prediction Loss: 0.576123
Epoch 2049 
Prediction Loss: 0.590255
Epoch 2099 
Prediction Loss: 0.580177
Epoch 2149 
Prediction Loss: 0.568931
Epoch 2199 
Prediction Loss: 0.556141
Epoch 2249 
Prediction Loss: 0.575709
Epoch 2299 
Prediction Loss: 0.544533
Epoch 2349 
Prediction Loss: 0.541571
Epoch 2399 
Prediction Loss: 0.547344
Epoch 2449 
Prediction Loss: 0.557726
Epoch 2499 
Prediction Loss: 0.565005
Epoch 2549 
Prediction Loss: 0.533674
Epoch 2599 
Prediction Loss: 0.529887
Epoch 2649 
Prediction Loss: 0.535248
Epoch 2699 
Prediction Loss: 0.539383
Epoch 2749 
Prediction Loss: 0.513545
Epoch 2799 
Prediction Loss: 0.557805
Epoch 2849 
Prediction Loss: 0.514846
Epoch 2899 
Prediction Loss: 0.509578
Epoch 2949 
Prediction Loss: 0.497449
Epoch 2999 
Prediction Loss: 0.512802
Epoch 3049 
Prediction Loss: 0.556962
Epoch 3099 
Prediction Loss: 0.496553
Epoch 3149 
Prediction Loss: 0.494117
Epoch 3199 
Prediction Loss: 0.486182
Epoch 3249 
Prediction Loss: 0.507056
Epoch 3299 
Prediction Loss: 0.498027
Epoch 3349 
Prediction Loss: 0.511079
Epoch 3399 
Prediction Loss: 0.470455
Epoch 3449 
Prediction Loss: 0.488356
Epoch 3499 
Prediction Loss: 0.474714
Epoch 3549 
Prediction Loss: 0.484099
Epoch 3599 
Prediction Loss: 0.482127
Epoch 3649 
Prediction Loss: 0.489830
Epoch 3699 
Prediction Loss: 0.461266
Epoch 3749 
Prediction Loss: 0.468785
Epoch 3799 
Prediction Loss: 0.461140
Epoch 3849 
Prediction Loss: 0.478315
Epoch 3899 
Prediction Loss: 0.475367
Epoch 3949 
Prediction Loss: 0.455387
Epoch 3999 
Prediction Loss: 0.450148
Epoch 4049 
Prediction Loss: 0.449049
Epoch 4099 
Prediction Loss: 0.449149
Epoch 4149 
Prediction Loss: 0.446376
Epoch 4199 
Prediction Loss: 0.449828
Epoch 4249 
Prediction Loss: 0.445924
Epoch 4299 
Prediction Loss: 0.458185
Epoch 4349 
Prediction Loss: 0.453170
Epoch 4399 
Prediction Loss: 0.442697
Epoch 4449 
Prediction Loss: 0.446823
Epoch 4499 
Prediction Loss: 0.442969
Epoch 4549 
Prediction Loss: 0.443953
Epoch 4599 
Prediction Loss: 0.443283
Epoch 4649 
Prediction Loss: 0.456510
Epoch 4699 
Prediction Loss: 0.433305
Epoch 4749 
Prediction Loss: 0.443495
Epoch 4799 
Prediction Loss: 0.456127
Epoch 4849 
Prediction Loss: 0.438963
Epoch 4899 
Prediction Loss: 0.426231
Epoch 4949 
Prediction Loss: 0.424839
Epoch 4999 
Prediction Loss: 0.436304
Epoch 5049 
Prediction Loss: 0.439508
Epoch 5099 
Prediction Loss: 0.419768
Epoch 5149 
Prediction Loss: 0.441130
Epoch 5199 
Prediction Loss: 0.428040
Epoch 5249 
Prediction Loss: 0.423516
Epoch 5299 
Prediction Loss: 0.427827
Epoch 5349 
Prediction Loss: 0.420740
Epoch 5399 
Prediction Loss: 0.430992
Epoch 5449 
Prediction Loss: 0.409671
Epoch 5499 
Prediction Loss: 0.412131
Epoch 5549 
Prediction Loss: 0.423944
Epoch 5599 
Prediction Loss: 0.410851
Epoch 5649 
Prediction Loss: 0.404825
Epoch 5699 
Prediction Loss: 0.409857
Epoch 5749 
Prediction Loss: 0.418162
Epoch 5799 
Prediction Loss: 0.408359
Epoch 5849 
Prediction Loss: 0.425539
Epoch 5899 
Prediction Loss: 0.412997
Epoch 5949 
Prediction Loss: 0.410774
Epoch 5999 
Prediction Loss: 0.406179
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.637600
Insample Error 3.055238
[31m========== repeat time 8 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.914456
Rec Loss: 11.461665
KL Loss: 1.452790
Y Loss: 1.004767
T Loss: 10.959281
Epoch 99 
Overall Loss: 12.513763
Rec Loss: 10.821349
KL Loss: 1.692414
Y Loss: 0.922486
T Loss: 10.360106
Epoch 149 
Overall Loss: 12.347171
Rec Loss: 10.813111
KL Loss: 1.534060
Y Loss: 0.853800
T Loss: 10.386211
Epoch 199 
Overall Loss: 12.306427
Rec Loss: 10.834303
KL Loss: 1.472125
Y Loss: 0.840589
T Loss: 10.414008
Epoch 249 
Overall Loss: 12.268700
Rec Loss: 10.818101
KL Loss: 1.450599
Y Loss: 0.846941
T Loss: 10.394631
Epoch 299 
Overall Loss: 12.245707
Rec Loss: 10.818616
KL Loss: 1.427091
Y Loss: 0.809559
T Loss: 10.413836
Epoch 349 
Overall Loss: 12.255852
Rec Loss: 10.824462
KL Loss: 1.431391
Y Loss: 0.821066
T Loss: 10.413928
Epoch 399 
Overall Loss: 12.215157
Rec Loss: 10.792964
KL Loss: 1.422193
Y Loss: 0.813259
T Loss: 10.386334
Epoch 449 
Overall Loss: 12.223292
Rec Loss: 10.802833
KL Loss: 1.420460
Y Loss: 0.804573
T Loss: 10.400546
Epoch 499 
Overall Loss: 12.212492
Rec Loss: 10.805656
KL Loss: 1.406835
Y Loss: 0.818894
T Loss: 10.396209
Epoch 549 
Overall Loss: 12.198989
Rec Loss: 10.812234
KL Loss: 1.386754
Y Loss: 0.832160
T Loss: 10.396154
Epoch 599 
Overall Loss: 12.208115
Rec Loss: 10.800173
KL Loss: 1.407941
Y Loss: 0.808001
T Loss: 10.396173
Epoch 649 
Overall Loss: 12.176236
Rec Loss: 10.796540
KL Loss: 1.379696
Y Loss: 0.790208
T Loss: 10.401437
Epoch 699 
Overall Loss: 12.176708
Rec Loss: 10.811273
KL Loss: 1.365435
Y Loss: 0.811622
T Loss: 10.405462
Epoch 749 
Overall Loss: 12.170888
Rec Loss: 10.781993
KL Loss: 1.388894
Y Loss: 0.788477
T Loss: 10.387754
Epoch 799 
Overall Loss: 12.157906
Rec Loss: 10.770072
KL Loss: 1.387834
Y Loss: 0.779986
T Loss: 10.380079
Epoch 849 
Overall Loss: 12.154186
Rec Loss: 10.767605
KL Loss: 1.386581
Y Loss: 0.783359
T Loss: 10.375925
Epoch 899 
Overall Loss: 12.142985
Rec Loss: 10.765832
KL Loss: 1.377154
Y Loss: 0.765753
T Loss: 10.382955
Epoch 949 
Overall Loss: 12.146315
Rec Loss: 10.771679
KL Loss: 1.374636
Y Loss: 0.802031
T Loss: 10.370664
Epoch 999 
Overall Loss: 12.142270
Rec Loss: 10.766412
KL Loss: 1.375858
Y Loss: 0.768923
T Loss: 10.381951
Epoch 1049 
Overall Loss: 12.126499
Rec Loss: 10.759550
KL Loss: 1.366949
Y Loss: 0.783152
T Loss: 10.367974
Epoch 1099 
Overall Loss: 12.110070
Rec Loss: 10.735313
KL Loss: 1.374756
Y Loss: 0.754389
T Loss: 10.358119
Epoch 1149 
Overall Loss: 12.123720
Rec Loss: 10.750005
KL Loss: 1.373715
Y Loss: 0.763317
T Loss: 10.368346
Epoch 1199 
Overall Loss: 12.114967
Rec Loss: 10.741128
KL Loss: 1.373838
Y Loss: 0.752537
T Loss: 10.364860
Epoch 1249 
Overall Loss: 12.128940
Rec Loss: 10.752591
KL Loss: 1.376350
Y Loss: 0.775112
T Loss: 10.365035
Epoch 1299 
Overall Loss: 12.103491
Rec Loss: 10.737892
KL Loss: 1.365599
Y Loss: 0.743871
T Loss: 10.365957
Epoch 1349 
Overall Loss: 12.121310
Rec Loss: 10.758620
KL Loss: 1.362691
Y Loss: 0.782474
T Loss: 10.367382
Epoch 1399 
Overall Loss: 12.081800
Rec Loss: 10.722432
KL Loss: 1.359367
Y Loss: 0.747611
T Loss: 10.348627
Epoch 1449 
Overall Loss: 12.105894
Rec Loss: 10.723316
KL Loss: 1.382578
Y Loss: 0.753220
T Loss: 10.346705
Epoch 1499 
Overall Loss: 12.092061
Rec Loss: 10.736294
KL Loss: 1.355766
Y Loss: 0.765645
T Loss: 10.353471
Epoch 1549 
Overall Loss: 12.084257
Rec Loss: 10.724036
KL Loss: 1.360221
Y Loss: 0.734194
T Loss: 10.356939
Epoch 1599 
Overall Loss: 12.089290
Rec Loss: 10.725500
KL Loss: 1.363790
Y Loss: 0.760768
T Loss: 10.345116
Epoch 1649 
Overall Loss: 12.077624
Rec Loss: 10.721880
KL Loss: 1.355743
Y Loss: 0.757612
T Loss: 10.343075
Epoch 1699 
Overall Loss: 12.072210
Rec Loss: 10.728368
KL Loss: 1.343843
Y Loss: 0.754001
T Loss: 10.351368
Epoch 1749 
Overall Loss: 12.067160
Rec Loss: 10.709210
KL Loss: 1.357950
Y Loss: 0.765052
T Loss: 10.326684
Epoch 1799 
Overall Loss: 12.066985
Rec Loss: 10.712693
KL Loss: 1.354293
Y Loss: 0.753599
T Loss: 10.335893
Epoch 1849 
Overall Loss: 12.062995
Rec Loss: 10.710195
KL Loss: 1.352800
Y Loss: 0.760911
T Loss: 10.329740
Epoch 1899 
Overall Loss: 12.061987
Rec Loss: 10.700722
KL Loss: 1.361265
Y Loss: 0.734809
T Loss: 10.333317
Epoch 1949 
Overall Loss: 12.054960
Rec Loss: 10.688643
KL Loss: 1.366318
Y Loss: 0.740403
T Loss: 10.318441
Epoch 1999 
Overall Loss: 12.049931
Rec Loss: 10.681485
KL Loss: 1.368446
Y Loss: 0.735176
T Loss: 10.313897
Epoch 2049 
Overall Loss: 12.041613
Rec Loss: 10.687535
KL Loss: 1.354078
Y Loss: 0.729177
T Loss: 10.322946
Epoch 2099 
Overall Loss: 12.035349
Rec Loss: 10.697251
KL Loss: 1.338098
Y Loss: 0.747469
T Loss: 10.323516
Epoch 2149 
Overall Loss: 12.023871
Rec Loss: 10.666722
KL Loss: 1.357149
Y Loss: 0.752824
T Loss: 10.290310
Epoch 2199 
Overall Loss: 12.029847
Rec Loss: 10.692314
KL Loss: 1.337533
Y Loss: 0.741982
T Loss: 10.321323
Epoch 2249 
Overall Loss: 12.028519
Rec Loss: 10.701744
KL Loss: 1.326775
Y Loss: 0.744288
T Loss: 10.329600
Epoch 2299 
Overall Loss: 12.011739
Rec Loss: 10.672832
KL Loss: 1.338907
Y Loss: 0.723750
T Loss: 10.310957
Epoch 2349 
Overall Loss: 12.002489
Rec Loss: 10.672777
KL Loss: 1.329712
Y Loss: 0.722822
T Loss: 10.311366
Epoch 2399 
Overall Loss: 12.023874
Rec Loss: 10.680466
KL Loss: 1.343408
Y Loss: 0.728587
T Loss: 10.316172
Epoch 2449 
Overall Loss: 11.996323
Rec Loss: 10.666286
KL Loss: 1.330037
Y Loss: 0.732751
T Loss: 10.299910
Epoch 2499 
Overall Loss: 11.974879
Rec Loss: 10.639435
KL Loss: 1.335444
Y Loss: 0.727828
T Loss: 10.275521
Epoch 2549 
Overall Loss: 12.005452
Rec Loss: 10.680981
KL Loss: 1.324471
Y Loss: 0.730529
T Loss: 10.315716
Epoch 2599 
Overall Loss: 11.978971
Rec Loss: 10.638984
KL Loss: 1.339988
Y Loss: 0.724301
T Loss: 10.276833
Epoch 2649 
Overall Loss: 12.021508
Rec Loss: 10.646750
KL Loss: 1.374757
Y Loss: 0.713195
T Loss: 10.290152
Epoch 2699 
Overall Loss: 11.999471
Rec Loss: 10.657070
KL Loss: 1.342400
Y Loss: 0.748656
T Loss: 10.282742
Epoch 2749 
Overall Loss: 11.970003
Rec Loss: 10.654023
KL Loss: 1.315980
Y Loss: 0.727717
T Loss: 10.290165
Epoch 2799 
Overall Loss: 11.975520
Rec Loss: 10.621485
KL Loss: 1.354035
Y Loss: 0.697447
T Loss: 10.272762
Epoch 2849 
Overall Loss: 11.992781
Rec Loss: 10.641892
KL Loss: 1.350889
Y Loss: 0.720200
T Loss: 10.281792
Epoch 2899 
Overall Loss: 11.979258
Rec Loss: 10.647670
KL Loss: 1.331588
Y Loss: 0.713271
T Loss: 10.291034
Epoch 2949 
Overall Loss: 11.984157
Rec Loss: 10.620844
KL Loss: 1.363313
Y Loss: 0.713893
T Loss: 10.263897
Epoch 2999 
Overall Loss: 11.965415
Rec Loss: 10.642146
KL Loss: 1.323270
Y Loss: 0.730354
T Loss: 10.276969
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.832504
Epoch 99
Rec Loss: 0.805274
Epoch 149
Rec Loss: 0.803442
Epoch 199
Rec Loss: 0.806843
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.931795
Epoch 99
Rec Loss: 9.928994
Epoch 149
Rec Loss: 9.912061
Epoch 199
Rec Loss: 9.904715
Epoch 249
Rec Loss: 9.909033
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.668493
Insample Error: 1.785862
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.422748
Rec Loss: 19.413973
KL Loss: 3.008776
Y Loss: 10.150417
T Loss: 12.948799
X Loss: 1.389965
Epoch 99 
Overall Loss: 17.141213
Rec Loss: 13.502887
KL Loss: 3.638326
Y Loss: 3.174667
T Loss: 12.808856
X Loss: -0.893303
Epoch 149 
Overall Loss: 15.602683
Rec Loss: 11.949390
KL Loss: 3.653293
Y Loss: 2.117784
T Loss: 12.587540
X Loss: -1.697042
Epoch 199 
Overall Loss: 14.918238
Rec Loss: 11.086335
KL Loss: 3.831904
Y Loss: 1.561456
T Loss: 12.428937
X Loss: -2.123330
Epoch 249 
Overall Loss: 14.507632
Rec Loss: 10.507729
KL Loss: 3.999903
Y Loss: 1.319967
T Loss: 12.257164
X Loss: -2.409419
Epoch 299 
Overall Loss: 14.255627
Rec Loss: 10.004390
KL Loss: 4.251237
Y Loss: 1.255542
T Loss: 12.001639
X Loss: -2.625021
Epoch 349 
Overall Loss: 14.010132
Rec Loss: 9.481692
KL Loss: 4.528440
Y Loss: 1.157725
T Loss: 11.724848
X Loss: -2.822019
Epoch 399 
Overall Loss: 13.818327
Rec Loss: 9.074858
KL Loss: 4.743468
Y Loss: 1.095531
T Loss: 11.505445
X Loss: -2.978352
Epoch 449 
Overall Loss: 13.645785
Rec Loss: 8.640291
KL Loss: 5.005494
Y Loss: 1.063620
T Loss: 11.250345
X Loss: -3.141865
Epoch 499 
Overall Loss: 13.486897
Rec Loss: 8.232959
KL Loss: 5.253938
Y Loss: 1.078900
T Loss: 11.033533
X Loss: -3.340024
Epoch 549 
Overall Loss: 13.373199
Rec Loss: 7.982730
KL Loss: 5.390469
Y Loss: 1.021991
T Loss: 10.964554
X Loss: -3.492820
Epoch 599 
Overall Loss: 13.358183
Rec Loss: 7.904152
KL Loss: 5.454031
Y Loss: 1.048411
T Loss: 10.941665
X Loss: -3.561718
Epoch 649 
Overall Loss: 13.310402
Rec Loss: 7.822573
KL Loss: 5.487829
Y Loss: 1.033346
T Loss: 10.913770
X Loss: -3.607870
Epoch 699 
Overall Loss: 13.243572
Rec Loss: 7.704566
KL Loss: 5.539006
Y Loss: 1.021593
T Loss: 10.912516
X Loss: -3.718746
Epoch 749 
Overall Loss: 13.225247
Rec Loss: 7.650255
KL Loss: 5.574991
Y Loss: 1.012292
T Loss: 10.915204
X Loss: -3.771095
Epoch 799 
Overall Loss: 13.165166
Rec Loss: 7.580996
KL Loss: 5.584170
Y Loss: 1.018630
T Loss: 10.896196
X Loss: -3.824515
Epoch 849 
Overall Loss: 13.171602
Rec Loss: 7.574412
KL Loss: 5.597190
Y Loss: 1.016450
T Loss: 10.917378
X Loss: -3.851191
Epoch 899 
Overall Loss: 13.120636
Rec Loss: 7.477567
KL Loss: 5.643069
Y Loss: 0.963370
T Loss: 10.900319
X Loss: -3.904437
Epoch 949 
Overall Loss: 13.107094
Rec Loss: 7.460260
KL Loss: 5.646834
Y Loss: 0.987253
T Loss: 10.912155
X Loss: -3.945522
Epoch 999 
Overall Loss: 13.111902
Rec Loss: 7.414396
KL Loss: 5.697506
Y Loss: 0.958823
T Loss: 10.920360
X Loss: -3.985375
Epoch 1049 
Overall Loss: 13.072611
Rec Loss: 7.352511
KL Loss: 5.720100
Y Loss: 0.943373
T Loss: 10.926672
X Loss: -4.045848
Epoch 1099 
Overall Loss: 13.052169
Rec Loss: 7.343187
KL Loss: 5.708982
Y Loss: 0.937515
T Loss: 10.930257
X Loss: -4.055828
Epoch 1149 
Overall Loss: 13.038247
Rec Loss: 7.304410
KL Loss: 5.733837
Y Loss: 0.937037
T Loss: 10.927924
X Loss: -4.092033
Epoch 1199 
Overall Loss: 13.042696
Rec Loss: 7.285305
KL Loss: 5.757391
Y Loss: 0.969725
T Loss: 10.925856
X Loss: -4.125413
Epoch 1249 
Overall Loss: 13.011503
Rec Loss: 7.241240
KL Loss: 5.770263
Y Loss: 0.903536
T Loss: 10.939445
X Loss: -4.149973
Epoch 1299 
Overall Loss: 12.994534
Rec Loss: 7.192967
KL Loss: 5.801567
Y Loss: 0.915732
T Loss: 10.946105
X Loss: -4.211005
Epoch 1349 
Overall Loss: 12.987064
Rec Loss: 7.178742
KL Loss: 5.808323
Y Loss: 0.917096
T Loss: 10.942729
X Loss: -4.222535
Epoch 1399 
Overall Loss: 12.965971
Rec Loss: 7.132136
KL Loss: 5.833835
Y Loss: 0.916503
T Loss: 10.956396
X Loss: -4.282511
Epoch 1449 
Overall Loss: 12.989043
Rec Loss: 7.128297
KL Loss: 5.860746
Y Loss: 0.929986
T Loss: 10.956267
X Loss: -4.292963
Epoch 1499 
Overall Loss: 12.942158
Rec Loss: 7.091188
KL Loss: 5.850970
Y Loss: 0.926173
T Loss: 10.958396
X Loss: -4.330294
Epoch 1549 
Overall Loss: 12.938380
Rec Loss: 7.056012
KL Loss: 5.882367
Y Loss: 0.904407
T Loss: 10.965662
X Loss: -4.361853
Epoch 1599 
Overall Loss: 12.949189
Rec Loss: 7.046019
KL Loss: 5.903169
Y Loss: 0.892138
T Loss: 10.962845
X Loss: -4.362895
Epoch 1649 
Overall Loss: 12.935560
Rec Loss: 7.001345
KL Loss: 5.934214
Y Loss: 0.879208
T Loss: 10.970165
X Loss: -4.408424
Epoch 1699 
Overall Loss: 12.918926
Rec Loss: 6.986305
KL Loss: 5.932621
Y Loss: 0.893079
T Loss: 10.976075
X Loss: -4.436309
Epoch 1749 
Overall Loss: 12.929810
Rec Loss: 6.980970
KL Loss: 5.948840
Y Loss: 0.903863
T Loss: 10.971208
X Loss: -4.442169
Epoch 1799 
Overall Loss: 12.907917
Rec Loss: 6.969176
KL Loss: 5.938741
Y Loss: 0.887993
T Loss: 10.986709
X Loss: -4.461530
Epoch 1849 
Overall Loss: 12.919350
Rec Loss: 6.948174
KL Loss: 5.971176
Y Loss: 0.883065
T Loss: 10.992906
X Loss: -4.486265
Epoch 1899 
Overall Loss: 12.925269
Rec Loss: 6.938858
KL Loss: 5.986411
Y Loss: 0.920734
T Loss: 10.987727
X Loss: -4.509236
Epoch 1949 
Overall Loss: 12.900847
Rec Loss: 6.882078
KL Loss: 6.018770
Y Loss: 0.886129
T Loss: 10.990239
X Loss: -4.551226
Epoch 1999 
Overall Loss: 12.892760
Rec Loss: 6.852987
KL Loss: 6.039773
Y Loss: 0.857750
T Loss: 10.990085
X Loss: -4.565973
Epoch 2049 
Overall Loss: 12.909982
Rec Loss: 6.863646
KL Loss: 6.046337
Y Loss: 0.906975
T Loss: 10.981441
X Loss: -4.571283
Epoch 2099 
Overall Loss: 12.871069
Rec Loss: 6.832800
KL Loss: 6.038269
Y Loss: 0.906029
T Loss: 10.976596
X Loss: -4.596811
Epoch 2149 
Overall Loss: 12.879058
Rec Loss: 6.810337
KL Loss: 6.068721
Y Loss: 0.886639
T Loss: 10.993277
X Loss: -4.626259
Epoch 2199 
Overall Loss: 12.877217
Rec Loss: 6.809728
KL Loss: 6.067489
Y Loss: 0.899942
T Loss: 10.985867
X Loss: -4.626111
Epoch 2249 
Overall Loss: 12.866223
Rec Loss: 6.789245
KL Loss: 6.076978
Y Loss: 0.857519
T Loss: 11.013532
X Loss: -4.653047
Epoch 2299 
Overall Loss: 12.865892
Rec Loss: 6.771173
KL Loss: 6.094719
Y Loss: 0.858164
T Loss: 11.001729
X Loss: -4.659638
Epoch 2349 
Overall Loss: 12.820897
Rec Loss: 6.745407
KL Loss: 6.075489
Y Loss: 0.877885
T Loss: 10.999986
X Loss: -4.693521
Epoch 2399 
Overall Loss: 12.877108
Rec Loss: 6.767086
KL Loss: 6.110021
Y Loss: 0.887519
T Loss: 11.014970
X Loss: -4.691643
Epoch 2449 
Overall Loss: 12.859910
Rec Loss: 6.717819
KL Loss: 6.142091
Y Loss: 0.882853
T Loss: 11.008706
X Loss: -4.732314
Epoch 2499 
Overall Loss: 12.839970
Rec Loss: 6.705837
KL Loss: 6.134132
Y Loss: 0.897988
T Loss: 11.008335
X Loss: -4.751492
Epoch 2549 
Overall Loss: 12.874677
Rec Loss: 6.728003
KL Loss: 6.146673
Y Loss: 0.899533
T Loss: 11.011881
X Loss: -4.733644
Epoch 2599 
Overall Loss: 12.842147
Rec Loss: 6.688783
KL Loss: 6.153364
Y Loss: 0.867943
T Loss: 11.019851
X Loss: -4.765040
Epoch 2649 
Overall Loss: 12.878156
Rec Loss: 6.714739
KL Loss: 6.163417
Y Loss: 0.911980
T Loss: 11.021574
X Loss: -4.762825
Epoch 2699 
Overall Loss: 12.829451
Rec Loss: 6.656628
KL Loss: 6.172824
Y Loss: 0.864477
T Loss: 11.021439
X Loss: -4.797050
Epoch 2749 
Overall Loss: 12.830166
Rec Loss: 6.622918
KL Loss: 6.207248
Y Loss: 0.874700
T Loss: 11.016781
X Loss: -4.831214
Epoch 2799 
Overall Loss: 12.840745
Rec Loss: 6.610254
KL Loss: 6.230490
Y Loss: 0.874708
T Loss: 11.016030
X Loss: -4.843130
Epoch 2849 
Overall Loss: 12.830911
Rec Loss: 6.616720
KL Loss: 6.214191
Y Loss: 0.840040
T Loss: 11.036546
X Loss: -4.839846
Epoch 2899 
Overall Loss: 12.829456
Rec Loss: 6.595488
KL Loss: 6.233968
Y Loss: 0.873145
T Loss: 11.025089
X Loss: -4.866173
Epoch 2949 
Overall Loss: 12.841963
Rec Loss: 6.594203
KL Loss: 6.247760
Y Loss: 0.876904
T Loss: 11.032860
X Loss: -4.877109
Epoch 2999 
Overall Loss: 12.831642
Rec Loss: 6.592910
KL Loss: 6.238731
Y Loss: 0.889007
T Loss: 11.028950
X Loss: -4.880543
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.557793
Epoch 99
Rec Loss: 1.539049
Epoch 149
Rec Loss: 1.533165
Epoch 199
Rec Loss: 1.543333
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.006902
Epoch 99
Rec Loss: 2.002504
Epoch 149
Rec Loss: 2.001090
Epoch 199
Rec Loss: 2.000231
Epoch 249
Rec Loss: 1.996572
Epoch 299
Rec Loss: 2.001109
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.649495
Insample Error 2.383519
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.858650
Epoch 99 
Prediction Loss: 1.723834
Epoch 149 
Prediction Loss: 1.651629
Epoch 199 
Prediction Loss: 1.555106
Epoch 249 
Prediction Loss: 1.483850
Epoch 299 
Prediction Loss: 1.424444
Epoch 349 
Prediction Loss: 1.359498
Epoch 399 
Prediction Loss: 1.298214
Epoch 449 
Prediction Loss: 1.217083
Epoch 499 
Prediction Loss: 1.207617
Epoch 549 
Prediction Loss: 1.107344
Epoch 599 
Prediction Loss: 1.076360
Epoch 649 
Prediction Loss: 1.044828
Epoch 699 
Prediction Loss: 1.004514
Epoch 749 
Prediction Loss: 0.955333
Epoch 799 
Prediction Loss: 0.926775
Epoch 849 
Prediction Loss: 0.850420
Epoch 899 
Prediction Loss: 0.858860
Epoch 949 
Prediction Loss: 0.818678
Epoch 999 
Prediction Loss: 0.772621
Epoch 1049 
Prediction Loss: 0.788010
Epoch 1099 
Prediction Loss: 0.755934
Epoch 1149 
Prediction Loss: 0.703746
Epoch 1199 
Prediction Loss: 0.719498
Epoch 1249 
Prediction Loss: 0.696097
Epoch 1299 
Prediction Loss: 0.672103
Epoch 1349 
Prediction Loss: 0.657979
Epoch 1399 
Prediction Loss: 0.636143
Epoch 1449 
Prediction Loss: 0.622860
Epoch 1499 
Prediction Loss: 0.611363
Epoch 1549 
Prediction Loss: 0.603973
Epoch 1599 
Prediction Loss: 0.577508
Epoch 1649 
Prediction Loss: 0.593242
Epoch 1699 
Prediction Loss: 0.560957
Epoch 1749 
Prediction Loss: 0.553944
Epoch 1799 
Prediction Loss: 0.554353
Epoch 1849 
Prediction Loss: 0.538161
Epoch 1899 
Prediction Loss: 0.529941
Epoch 1949 
Prediction Loss: 0.536983
Epoch 1999 
Prediction Loss: 0.536520
Epoch 2049 
Prediction Loss: 0.512377
Epoch 2099 
Prediction Loss: 0.501719
Epoch 2149 
Prediction Loss: 0.520533
Epoch 2199 
Prediction Loss: 0.514219
Epoch 2249 
Prediction Loss: 0.486797
Epoch 2299 
Prediction Loss: 0.485739
Epoch 2349 
Prediction Loss: 0.485053
Epoch 2399 
Prediction Loss: 0.483587
Epoch 2449 
Prediction Loss: 0.490333
Epoch 2499 
Prediction Loss: 0.472311
Epoch 2549 
Prediction Loss: 0.480344
Epoch 2599 
Prediction Loss: 0.492511
Epoch 2649 
Prediction Loss: 0.475981
Epoch 2699 
Prediction Loss: 0.457305
Epoch 2749 
Prediction Loss: 0.458920
Epoch 2799 
Prediction Loss: 0.469265
Epoch 2849 
Prediction Loss: 0.466165
Epoch 2899 
Prediction Loss: 0.450752
Epoch 2949 
Prediction Loss: 0.469876
Epoch 2999 
Prediction Loss: 0.460251
Epoch 3049 
Prediction Loss: 0.469581
Epoch 3099 
Prediction Loss: 0.449180
Epoch 3149 
Prediction Loss: 0.463295
Epoch 3199 
Prediction Loss: 0.446109
Epoch 3249 
Prediction Loss: 0.435573
Epoch 3299 
Prediction Loss: 0.436061
Epoch 3349 
Prediction Loss: 0.435273
Epoch 3399 
Prediction Loss: 0.434650
Epoch 3449 
Prediction Loss: 0.440579
Epoch 3499 
Prediction Loss: 0.432396
Epoch 3549 
Prediction Loss: 0.439956
Epoch 3599 
Prediction Loss: 0.432386
Epoch 3649 
Prediction Loss: 0.428401
Epoch 3699 
Prediction Loss: 0.461336
Epoch 3749 
Prediction Loss: 0.420478
Epoch 3799 
Prediction Loss: 0.431330
Epoch 3849 
Prediction Loss: 0.415195
Epoch 3899 
Prediction Loss: 0.412904
Epoch 3949 
Prediction Loss: 0.418513
Epoch 3999 
Prediction Loss: 0.416622
Epoch 4049 
Prediction Loss: 0.414558
Epoch 4099 
Prediction Loss: 0.406271
Epoch 4149 
Prediction Loss: 0.405402
Epoch 4199 
Prediction Loss: 0.402870
Epoch 4249 
Prediction Loss: 0.414080
Epoch 4299 
Prediction Loss: 0.406263
Epoch 4349 
Prediction Loss: 0.409082
Epoch 4399 
Prediction Loss: 0.409358
Epoch 4449 
Prediction Loss: 0.409747
Epoch 4499 
Prediction Loss: 0.400613
Epoch 4549 
Prediction Loss: 0.395945
Epoch 4599 
Prediction Loss: 0.401121
Epoch 4649 
Prediction Loss: 0.463266
Epoch 4699 
Prediction Loss: 0.391890
Epoch 4749 
Prediction Loss: 0.415106
Epoch 4799 
Prediction Loss: 0.397732
Epoch 4849 
Prediction Loss: 0.404319
Epoch 4899 
Prediction Loss: 0.391167
Epoch 4949 
Prediction Loss: 0.390832
Epoch 4999 
Prediction Loss: 0.397693
Epoch 5049 
Prediction Loss: 0.388962
Epoch 5099 
Prediction Loss: 0.411470
Epoch 5149 
Prediction Loss: 0.381713
Epoch 5199 
Prediction Loss: 0.395214
Epoch 5249 
Prediction Loss: 0.396841
Epoch 5299 
Prediction Loss: 0.388979
Epoch 5349 
Prediction Loss: 0.404792
Epoch 5399 
Prediction Loss: 0.380815
Epoch 5449 
Prediction Loss: 0.377041
Epoch 5499 
Prediction Loss: 0.394021
Epoch 5549 
Prediction Loss: 0.383513
Epoch 5599 
Prediction Loss: 0.385480
Epoch 5649 
Prediction Loss: 0.403853
Epoch 5699 
Prediction Loss: 0.381437
Epoch 5749 
Prediction Loss: 0.396817
Epoch 5799 
Prediction Loss: 0.394536
Epoch 5849 
Prediction Loss: 0.385956
Epoch 5899 
Prediction Loss: 0.381012
Epoch 5949 
Prediction Loss: 0.370894
Epoch 5999 
Prediction Loss: 0.374397
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.596564
Insample Error 3.069963
[31m========== repeat time 9 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.628129
Rec Loss: 10.931486
KL Loss: 1.696643
Y Loss: 1.012762
T Loss: 10.425105
Epoch 99 
Overall Loss: 12.403996
Rec Loss: 10.826908
KL Loss: 1.577088
Y Loss: 0.897884
T Loss: 10.377966
Epoch 149 
Overall Loss: 12.304786
Rec Loss: 10.825296
KL Loss: 1.479490
Y Loss: 0.855159
T Loss: 10.397716
Epoch 199 
Overall Loss: 12.304079
Rec Loss: 10.828574
KL Loss: 1.475505
Y Loss: 0.852586
T Loss: 10.402281
Epoch 249 
Overall Loss: 12.261395
Rec Loss: 10.833986
KL Loss: 1.427409
Y Loss: 0.838118
T Loss: 10.414927
Epoch 299 
Overall Loss: 12.233997
Rec Loss: 10.807110
KL Loss: 1.426887
Y Loss: 0.811813
T Loss: 10.401203
Epoch 349 
Overall Loss: 12.237778
Rec Loss: 10.840480
KL Loss: 1.397298
Y Loss: 0.825183
T Loss: 10.427889
Epoch 399 
Overall Loss: 12.234942
Rec Loss: 10.830380
KL Loss: 1.404562
Y Loss: 0.831609
T Loss: 10.414575
Epoch 449 
Overall Loss: 12.214000
Rec Loss: 10.828373
KL Loss: 1.385627
Y Loss: 0.810949
T Loss: 10.422898
Epoch 499 
Overall Loss: 12.198358
Rec Loss: 10.815190
KL Loss: 1.383168
Y Loss: 0.822261
T Loss: 10.404059
Epoch 549 
Overall Loss: 12.188625
Rec Loss: 10.787953
KL Loss: 1.400672
Y Loss: 0.794518
T Loss: 10.390694
Epoch 599 
Overall Loss: 12.185294
Rec Loss: 10.798462
KL Loss: 1.386832
Y Loss: 0.795032
T Loss: 10.400946
Epoch 649 
Overall Loss: 12.185394
Rec Loss: 10.796565
KL Loss: 1.388829
Y Loss: 0.788229
T Loss: 10.402451
Epoch 699 
Overall Loss: 12.157087
Rec Loss: 10.790464
KL Loss: 1.366624
Y Loss: 0.803647
T Loss: 10.388640
Epoch 749 
Overall Loss: 12.165645
Rec Loss: 10.778271
KL Loss: 1.387374
Y Loss: 0.783980
T Loss: 10.386281
Epoch 799 
Overall Loss: 12.158596
Rec Loss: 10.770457
KL Loss: 1.388139
Y Loss: 0.779331
T Loss: 10.380791
Epoch 849 
Overall Loss: 12.166410
Rec Loss: 10.792885
KL Loss: 1.373525
Y Loss: 0.776448
T Loss: 10.404662
Epoch 899 
Overall Loss: 12.142749
Rec Loss: 10.780824
KL Loss: 1.361925
Y Loss: 0.783076
T Loss: 10.389286
Epoch 949 
Overall Loss: 12.143410
Rec Loss: 10.779660
KL Loss: 1.363751
Y Loss: 0.774430
T Loss: 10.392445
Epoch 999 
Overall Loss: 12.120870
Rec Loss: 10.769943
KL Loss: 1.350927
Y Loss: 0.788408
T Loss: 10.375739
Epoch 1049 
Overall Loss: 12.152602
Rec Loss: 10.776724
KL Loss: 1.375878
Y Loss: 0.779631
T Loss: 10.386909
Epoch 1099 
Overall Loss: 12.131037
Rec Loss: 10.776438
KL Loss: 1.354600
Y Loss: 0.763095
T Loss: 10.394890
Epoch 1149 
Overall Loss: 12.113984
Rec Loss: 10.764584
KL Loss: 1.349400
Y Loss: 0.769464
T Loss: 10.379852
Epoch 1199 
Overall Loss: 12.120678
Rec Loss: 10.747073
KL Loss: 1.373605
Y Loss: 0.755021
T Loss: 10.369562
Epoch 1249 
Overall Loss: 12.107780
Rec Loss: 10.757462
KL Loss: 1.350318
Y Loss: 0.758630
T Loss: 10.378147
Epoch 1299 
Overall Loss: 12.124083
Rec Loss: 10.747389
KL Loss: 1.376693
Y Loss: 0.758343
T Loss: 10.368218
Epoch 1349 
Overall Loss: 12.102423
Rec Loss: 10.748965
KL Loss: 1.353458
Y Loss: 0.755191
T Loss: 10.371370
Epoch 1399 
Overall Loss: 12.099004
Rec Loss: 10.744704
KL Loss: 1.354300
Y Loss: 0.754304
T Loss: 10.367552
Epoch 1449 
Overall Loss: 12.089928
Rec Loss: 10.752001
KL Loss: 1.337926
Y Loss: 0.748974
T Loss: 10.377514
Epoch 1499 
Overall Loss: 12.099206
Rec Loss: 10.734770
KL Loss: 1.364435
Y Loss: 0.752690
T Loss: 10.358425
Epoch 1549 
Overall Loss: 12.094392
Rec Loss: 10.753767
KL Loss: 1.340625
Y Loss: 0.751767
T Loss: 10.377884
Epoch 1599 
Overall Loss: 12.090280
Rec Loss: 10.731887
KL Loss: 1.358394
Y Loss: 0.760141
T Loss: 10.351816
Epoch 1649 
Overall Loss: 12.096533
Rec Loss: 10.737731
KL Loss: 1.358802
Y Loss: 0.752834
T Loss: 10.361314
Epoch 1699 
Overall Loss: 12.079767
Rec Loss: 10.718284
KL Loss: 1.361483
Y Loss: 0.751720
T Loss: 10.342424
Epoch 1749 
Overall Loss: 12.055172
Rec Loss: 10.733343
KL Loss: 1.321830
Y Loss: 0.757030
T Loss: 10.354828
Epoch 1799 
Overall Loss: 12.067221
Rec Loss: 10.703802
KL Loss: 1.363418
Y Loss: 0.738758
T Loss: 10.334423
Epoch 1849 
Overall Loss: 12.054832
Rec Loss: 10.712993
KL Loss: 1.341839
Y Loss: 0.742854
T Loss: 10.341566
Epoch 1899 
Overall Loss: 12.056148
Rec Loss: 10.710582
KL Loss: 1.345566
Y Loss: 0.727788
T Loss: 10.346688
Epoch 1949 
Overall Loss: 12.065025
Rec Loss: 10.732365
KL Loss: 1.332660
Y Loss: 0.735913
T Loss: 10.364409
Epoch 1999 
Overall Loss: 12.065308
Rec Loss: 10.708371
KL Loss: 1.356937
Y Loss: 0.729131
T Loss: 10.343806
Epoch 2049 
Overall Loss: 12.048729
Rec Loss: 10.697024
KL Loss: 1.351705
Y Loss: 0.731289
T Loss: 10.331380
Epoch 2099 
Overall Loss: 12.037926
Rec Loss: 10.697056
KL Loss: 1.340869
Y Loss: 0.727729
T Loss: 10.333192
Epoch 2149 
Overall Loss: 12.046392
Rec Loss: 10.689463
KL Loss: 1.356929
Y Loss: 0.723673
T Loss: 10.327626
Epoch 2199 
Overall Loss: 12.029754
Rec Loss: 10.681711
KL Loss: 1.348044
Y Loss: 0.740490
T Loss: 10.311465
Epoch 2249 
Overall Loss: 12.040026
Rec Loss: 10.693428
KL Loss: 1.346598
Y Loss: 0.735073
T Loss: 10.325891
Epoch 2299 
Overall Loss: 12.027716
Rec Loss: 10.693600
KL Loss: 1.334116
Y Loss: 0.734454
T Loss: 10.326373
Epoch 2349 
Overall Loss: 12.027472
Rec Loss: 10.679958
KL Loss: 1.347514
Y Loss: 0.719621
T Loss: 10.320147
Epoch 2399 
Overall Loss: 12.020006
Rec Loss: 10.691497
KL Loss: 1.328508
Y Loss: 0.729917
T Loss: 10.326539
Epoch 2449 
Overall Loss: 12.019352
Rec Loss: 10.680603
KL Loss: 1.338749
Y Loss: 0.729826
T Loss: 10.315690
Epoch 2499 
Overall Loss: 12.021983
Rec Loss: 10.685420
KL Loss: 1.336564
Y Loss: 0.733522
T Loss: 10.318659
Epoch 2549 
Overall Loss: 11.998640
Rec Loss: 10.664751
KL Loss: 1.333890
Y Loss: 0.717347
T Loss: 10.306077
Epoch 2599 
Overall Loss: 12.006454
Rec Loss: 10.698959
KL Loss: 1.307494
Y Loss: 0.748038
T Loss: 10.324940
Epoch 2649 
Overall Loss: 12.019790
Rec Loss: 10.674474
KL Loss: 1.345316
Y Loss: 0.717982
T Loss: 10.315483
Epoch 2699 
Overall Loss: 11.980636
Rec Loss: 10.669755
KL Loss: 1.310882
Y Loss: 0.734875
T Loss: 10.302317
Epoch 2749 
Overall Loss: 11.993608
Rec Loss: 10.672715
KL Loss: 1.320893
Y Loss: 0.721118
T Loss: 10.312156
Epoch 2799 
Overall Loss: 11.983450
Rec Loss: 10.652699
KL Loss: 1.330750
Y Loss: 0.701233
T Loss: 10.302083
Epoch 2849 
Overall Loss: 12.010431
Rec Loss: 10.663939
KL Loss: 1.346491
Y Loss: 0.724610
T Loss: 10.301635
Epoch 2899 
Overall Loss: 12.005599
Rec Loss: 10.664697
KL Loss: 1.340902
Y Loss: 0.744942
T Loss: 10.292226
Epoch 2949 
Overall Loss: 11.987257
Rec Loss: 10.658494
KL Loss: 1.328763
Y Loss: 0.720796
T Loss: 10.298096
Epoch 2999 
Overall Loss: 11.982776
Rec Loss: 10.668871
KL Loss: 1.313904
Y Loss: 0.728055
T Loss: 10.304844
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.834049
Epoch 99
Rec Loss: 0.819447
Epoch 149
Rec Loss: 0.818861
Epoch 199
Rec Loss: 0.829971
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.931434
Epoch 99
Rec Loss: 9.902958
Epoch 149
Rec Loss: 9.907997
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.662623
Insample Error: 1.795161
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 22.225264
Rec Loss: 19.150281
KL Loss: 3.074983
Y Loss: 9.678261
T Loss: 12.984734
X Loss: 1.326416
Epoch 99 
Overall Loss: 17.173856
Rec Loss: 13.687876
KL Loss: 3.485980
Y Loss: 3.669210
T Loss: 12.941484
X Loss: -1.088212
Epoch 149 
Overall Loss: 15.725753
Rec Loss: 12.152397
KL Loss: 3.573355
Y Loss: 2.690304
T Loss: 12.626680
X Loss: -1.819435
Epoch 199 
Overall Loss: 14.905208
Rec Loss: 10.843101
KL Loss: 4.062107
Y Loss: 2.034905
T Loss: 12.126625
X Loss: -2.300976
Epoch 249 
Overall Loss: 14.451499
Rec Loss: 10.248848
KL Loss: 4.202651
Y Loss: 1.597838
T Loss: 11.880654
X Loss: -2.430725
Epoch 299 
Overall Loss: 14.230920
Rec Loss: 9.937797
KL Loss: 4.293122
Y Loss: 1.412514
T Loss: 11.749678
X Loss: -2.518138
Epoch 349 
Overall Loss: 13.983248
Rec Loss: 9.496364
KL Loss: 4.486884
Y Loss: 1.321518
T Loss: 11.578746
X Loss: -2.743142
Epoch 399 
Overall Loss: 13.751477
Rec Loss: 8.963571
KL Loss: 4.787906
Y Loss: 1.194871
T Loss: 11.379079
X Loss: -3.012944
Epoch 449 
Overall Loss: 13.592044
Rec Loss: 8.575120
KL Loss: 5.016924
Y Loss: 1.202256
T Loss: 11.225819
X Loss: -3.251827
Epoch 499 
Overall Loss: 13.438047
Rec Loss: 8.241863
KL Loss: 5.196184
Y Loss: 1.168879
T Loss: 11.111599
X Loss: -3.454176
Epoch 549 
Overall Loss: 13.338021
Rec Loss: 8.038548
KL Loss: 5.299473
Y Loss: 1.144671
T Loss: 11.028068
X Loss: -3.561855
Epoch 599 
Overall Loss: 13.294242
Rec Loss: 7.891490
KL Loss: 5.402752
Y Loss: 1.089623
T Loss: 10.981739
X Loss: -3.635060
Epoch 649 
Overall Loss: 13.235092
Rec Loss: 7.771635
KL Loss: 5.463457
Y Loss: 1.062715
T Loss: 10.944735
X Loss: -3.704458
Epoch 699 
Overall Loss: 13.195217
Rec Loss: 7.725084
KL Loss: 5.470133
Y Loss: 1.009033
T Loss: 10.971728
X Loss: -3.751161
Epoch 749 
Overall Loss: 13.168405
Rec Loss: 7.683640
KL Loss: 5.484765
Y Loss: 1.007260
T Loss: 10.945998
X Loss: -3.765988
Epoch 799 
Overall Loss: 13.137302
Rec Loss: 7.628448
KL Loss: 5.508854
Y Loss: 0.975571
T Loss: 10.930723
X Loss: -3.790060
Epoch 849 
Overall Loss: 13.129327
Rec Loss: 7.589616
KL Loss: 5.539711
Y Loss: 0.959833
T Loss: 10.946462
X Loss: -3.836763
Epoch 899 
Overall Loss: 13.101485
Rec Loss: 7.530435
KL Loss: 5.571051
Y Loss: 0.954573
T Loss: 10.927047
X Loss: -3.873899
Epoch 949 
Overall Loss: 13.097350
Rec Loss: 7.507576
KL Loss: 5.589774
Y Loss: 0.965437
T Loss: 10.914866
X Loss: -3.890009
Epoch 999 
Overall Loss: 13.049355
Rec Loss: 7.443570
KL Loss: 5.605785
Y Loss: 0.931708
T Loss: 10.902274
X Loss: -3.924558
Epoch 1049 
Overall Loss: 13.069017
Rec Loss: 7.448162
KL Loss: 5.620855
Y Loss: 0.922480
T Loss: 10.918157
X Loss: -3.931235
Epoch 1099 
Overall Loss: 13.060650
Rec Loss: 7.406980
KL Loss: 5.653671
Y Loss: 0.931040
T Loss: 10.892561
X Loss: -3.951101
Epoch 1149 
Overall Loss: 13.019843
Rec Loss: 7.393661
KL Loss: 5.626182
Y Loss: 0.931211
T Loss: 10.910546
X Loss: -3.982491
Epoch 1199 
Overall Loss: 13.026130
Rec Loss: 7.349077
KL Loss: 5.677053
Y Loss: 0.918960
T Loss: 10.910575
X Loss: -4.020978
Epoch 1249 
Overall Loss: 13.012844
Rec Loss: 7.330135
KL Loss: 5.682709
Y Loss: 0.898346
T Loss: 10.910121
X Loss: -4.029160
Epoch 1299 
Overall Loss: 13.015298
Rec Loss: 7.325822
KL Loss: 5.689476
Y Loss: 0.901943
T Loss: 10.923853
X Loss: -4.049002
Epoch 1349 
Overall Loss: 12.990108
Rec Loss: 7.295638
KL Loss: 5.694470
Y Loss: 0.889098
T Loss: 10.915380
X Loss: -4.064291
Epoch 1399 
Overall Loss: 12.991996
Rec Loss: 7.273464
KL Loss: 5.718532
Y Loss: 0.906775
T Loss: 10.909440
X Loss: -4.089365
Epoch 1449 
Overall Loss: 12.942504
Rec Loss: 7.224937
KL Loss: 5.717567
Y Loss: 0.918297
T Loss: 10.909855
X Loss: -4.144067
Epoch 1499 
Overall Loss: 12.978212
Rec Loss: 7.250398
KL Loss: 5.727814
Y Loss: 0.929692
T Loss: 10.923570
X Loss: -4.138019
Epoch 1549 
Overall Loss: 12.948861
Rec Loss: 7.199820
KL Loss: 5.749041
Y Loss: 0.909034
T Loss: 10.930084
X Loss: -4.184781
Epoch 1599 
Overall Loss: 12.956692
Rec Loss: 7.191341
KL Loss: 5.765352
Y Loss: 0.902261
T Loss: 10.930650
X Loss: -4.190439
Epoch 1649 
Overall Loss: 12.915309
Rec Loss: 7.156760
KL Loss: 5.758549
Y Loss: 0.910007
T Loss: 10.938031
X Loss: -4.236275
Epoch 1699 
Overall Loss: 12.922900
Rec Loss: 7.134339
KL Loss: 5.788561
Y Loss: 0.885801
T Loss: 10.943487
X Loss: -4.252048
Epoch 1749 
Overall Loss: 12.911526
Rec Loss: 7.110215
KL Loss: 5.801311
Y Loss: 0.877084
T Loss: 10.939640
X Loss: -4.267966
Epoch 1799 
Overall Loss: 12.928177
Rec Loss: 7.134989
KL Loss: 5.793188
Y Loss: 0.882386
T Loss: 10.960168
X Loss: -4.266373
Epoch 1849 
Overall Loss: 12.904255
Rec Loss: 7.078547
KL Loss: 5.825708
Y Loss: 0.879028
T Loss: 10.950312
X Loss: -4.311279
Epoch 1899 
Overall Loss: 12.908379
Rec Loss: 7.087220
KL Loss: 5.821159
Y Loss: 0.874334
T Loss: 10.959571
X Loss: -4.309517
Epoch 1949 
Overall Loss: 12.930365
Rec Loss: 7.087902
KL Loss: 5.842463
Y Loss: 0.885275
T Loss: 10.957299
X Loss: -4.312034
Epoch 1999 
Overall Loss: 12.912641
Rec Loss: 7.056494
KL Loss: 5.856147
Y Loss: 0.859697
T Loss: 10.951748
X Loss: -4.325103
Epoch 2049 
Overall Loss: 12.874501
Rec Loss: 6.984189
KL Loss: 5.890312
Y Loss: 0.883328
T Loss: 10.942809
X Loss: -4.400284
Epoch 2099 
Overall Loss: 12.897609
Rec Loss: 7.019255
KL Loss: 5.878353
Y Loss: 0.881199
T Loss: 10.958860
X Loss: -4.380204
Epoch 2149 
Overall Loss: 12.869284
Rec Loss: 6.978979
KL Loss: 5.890306
Y Loss: 0.913577
T Loss: 10.948598
X Loss: -4.426407
Epoch 2199 
Overall Loss: 12.884736
Rec Loss: 7.002492
KL Loss: 5.882244
Y Loss: 0.875808
T Loss: 10.978256
X Loss: -4.413668
Epoch 2249 
Overall Loss: 12.897355
Rec Loss: 6.996295
KL Loss: 5.901061
Y Loss: 0.890158
T Loss: 10.988699
X Loss: -4.437484
Epoch 2299 
Overall Loss: 12.884077
Rec Loss: 6.961775
KL Loss: 5.922302
Y Loss: 0.902046
T Loss: 10.968979
X Loss: -4.458227
Epoch 2349 
Overall Loss: 12.864524
Rec Loss: 6.920083
KL Loss: 5.944441
Y Loss: 0.866716
T Loss: 10.969842
X Loss: -4.483117
Epoch 2399 
Overall Loss: 12.888996
Rec Loss: 6.937204
KL Loss: 5.951791
Y Loss: 0.886667
T Loss: 10.976024
X Loss: -4.482154
Epoch 2449 
Overall Loss: 12.866592
Rec Loss: 6.916844
KL Loss: 5.949748
Y Loss: 0.875828
T Loss: 10.979828
X Loss: -4.500898
Epoch 2499 
Overall Loss: 12.873451
Rec Loss: 6.891322
KL Loss: 5.982130
Y Loss: 0.879128
T Loss: 10.974799
X Loss: -4.523042
Epoch 2549 
Overall Loss: 12.826462
Rec Loss: 6.865865
KL Loss: 5.960597
Y Loss: 0.882466
T Loss: 10.993422
X Loss: -4.568790
Epoch 2599 
Overall Loss: 12.855468
Rec Loss: 6.871095
KL Loss: 5.984374
Y Loss: 0.891537
T Loss: 10.990327
X Loss: -4.565001
Epoch 2649 
Overall Loss: 12.876307
Rec Loss: 6.855793
KL Loss: 6.020514
Y Loss: 0.855769
T Loss: 10.990731
X Loss: -4.562822
Epoch 2699 
Overall Loss: 12.851467
Rec Loss: 6.848699
KL Loss: 6.002768
Y Loss: 0.881852
T Loss: 11.010628
X Loss: -4.602855
Epoch 2749 
Overall Loss: 12.834903
Rec Loss: 6.787464
KL Loss: 6.047439
Y Loss: 0.877797
T Loss: 10.997829
X Loss: -4.649264
Epoch 2799 
Overall Loss: 12.831966
Rec Loss: 6.766336
KL Loss: 6.065630
Y Loss: 0.856120
T Loss: 11.018719
X Loss: -4.680444
Epoch 2849 
Overall Loss: 12.861519
Rec Loss: 6.788181
KL Loss: 6.073338
Y Loss: 0.876536
T Loss: 11.008608
X Loss: -4.658695
Epoch 2899 
Overall Loss: 12.842424
Rec Loss: 6.724445
KL Loss: 6.117979
Y Loss: 0.848353
T Loss: 11.004778
X Loss: -4.704509
Epoch 2949 
Overall Loss: 12.819216
Rec Loss: 6.731387
KL Loss: 6.087829
Y Loss: 0.878761
T Loss: 11.014932
X Loss: -4.722926
Epoch 2999 
Overall Loss: 12.805370
Rec Loss: 6.692913
KL Loss: 6.112457
Y Loss: 0.860699
T Loss: 11.019467
X Loss: -4.756903
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.579949
Epoch 99
Rec Loss: 1.584862
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.003530
Epoch 99
Rec Loss: 2.006593
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.645924
Insample Error 2.475551
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.895995
Epoch 99 
Prediction Loss: 1.763994
Epoch 149 
Prediction Loss: 1.680018
Epoch 199 
Prediction Loss: 1.589228
Epoch 249 
Prediction Loss: 1.597718
Epoch 299 
Prediction Loss: 1.454233
Epoch 349 
Prediction Loss: 1.384348
Epoch 399 
Prediction Loss: 1.321643
Epoch 449 
Prediction Loss: 1.294055
Epoch 499 
Prediction Loss: 1.231799
Epoch 549 
Prediction Loss: 1.166826
Epoch 599 
Prediction Loss: 1.168329
Epoch 649 
Prediction Loss: 1.080445
Epoch 699 
Prediction Loss: 1.028666
Epoch 749 
Prediction Loss: 1.011870
Epoch 799 
Prediction Loss: 0.960515
Epoch 849 
Prediction Loss: 0.910580
Epoch 899 
Prediction Loss: 0.925745
Epoch 949 
Prediction Loss: 0.860108
Epoch 999 
Prediction Loss: 0.820356
Epoch 1049 
Prediction Loss: 0.803591
Epoch 1099 
Prediction Loss: 0.796654
Epoch 1149 
Prediction Loss: 0.759203
Epoch 1199 
Prediction Loss: 0.771134
Epoch 1249 
Prediction Loss: 0.727147
Epoch 1299 
Prediction Loss: 0.698592
Epoch 1349 
Prediction Loss: 0.689337
Epoch 1399 
Prediction Loss: 0.671814
Epoch 1449 
Prediction Loss: 0.681148
Epoch 1499 
Prediction Loss: 0.644743
Epoch 1549 
Prediction Loss: 0.677566
Epoch 1599 
Prediction Loss: 0.622555
Epoch 1649 
Prediction Loss: 0.630557
Epoch 1699 
Prediction Loss: 0.605493
Epoch 1749 
Prediction Loss: 0.614239
Epoch 1799 
Prediction Loss: 0.598798
Epoch 1849 
Prediction Loss: 0.580034
Epoch 1899 
Prediction Loss: 0.563356
Epoch 1949 
Prediction Loss: 0.559394
Epoch 1999 
Prediction Loss: 0.554874
Epoch 2049 
Prediction Loss: 0.542114
Epoch 2099 
Prediction Loss: 0.532049
Epoch 2149 
Prediction Loss: 0.550302
Epoch 2199 
Prediction Loss: 0.520299
Epoch 2249 
Prediction Loss: 0.512081
Epoch 2299 
Prediction Loss: 0.542650
Epoch 2349 
Prediction Loss: 0.522367
Epoch 2399 
Prediction Loss: 0.510744
Epoch 2449 
Prediction Loss: 0.483551
Epoch 2499 
Prediction Loss: 0.483510
Epoch 2549 
Prediction Loss: 0.499549
Epoch 2599 
Prediction Loss: 0.508163
Epoch 2649 
Prediction Loss: 0.493527
Epoch 2699 
Prediction Loss: 0.523917
Epoch 2749 
Prediction Loss: 0.467251
Epoch 2799 
Prediction Loss: 0.460663
Epoch 2849 
Prediction Loss: 0.496555
Epoch 2899 
Prediction Loss: 0.460069
Epoch 2949 
Prediction Loss: 0.465506
Epoch 2999 
Prediction Loss: 0.441141
Epoch 3049 
Prediction Loss: 0.441887
Epoch 3099 
Prediction Loss: 0.444791
Epoch 3149 
Prediction Loss: 0.440773
Epoch 3199 
Prediction Loss: 0.446313
Epoch 3249 
Prediction Loss: 0.430398
Epoch 3299 
Prediction Loss: 0.438959
Epoch 3349 
Prediction Loss: 0.459147
Epoch 3399 
Prediction Loss: 0.426557
Epoch 3449 
Prediction Loss: 0.440456
Epoch 3499 
Prediction Loss: 0.441361
Epoch 3549 
Prediction Loss: 0.427660
Epoch 3599 
Prediction Loss: 0.420588
Epoch 3649 
Prediction Loss: 0.411830
Epoch 3699 
Prediction Loss: 0.421736
Epoch 3749 
Prediction Loss: 0.410367
Epoch 3799 
Prediction Loss: 0.400635
Epoch 3849 
Prediction Loss: 0.419859
Epoch 3899 
Prediction Loss: 0.460360
Epoch 3949 
Prediction Loss: 0.402752
Epoch 3999 
Prediction Loss: 0.414868
Epoch 4049 
Prediction Loss: 0.395223
Epoch 4099 
Prediction Loss: 0.404128
Epoch 4149 
Prediction Loss: 0.430894
Epoch 4199 
Prediction Loss: 0.389441
Epoch 4249 
Prediction Loss: 0.396213
Epoch 4299 
Prediction Loss: 0.395140
Epoch 4349 
Prediction Loss: 0.393353
Epoch 4399 
Prediction Loss: 0.404555
Epoch 4449 
Prediction Loss: 0.395395
Epoch 4499 
Prediction Loss: 0.396406
Epoch 4549 
Prediction Loss: 0.381126
Epoch 4599 
Prediction Loss: 0.431438
Epoch 4649 
Prediction Loss: 0.409220
Epoch 4699 
Prediction Loss: 0.374136
Epoch 4749 
Prediction Loss: 0.386585
Epoch 4799 
Prediction Loss: 0.377354
Epoch 4849 
Prediction Loss: 0.384607
Epoch 4899 
Prediction Loss: 0.385656
Epoch 4949 
Prediction Loss: 0.382418
Epoch 4999 
Prediction Loss: 0.375778
Epoch 5049 
Prediction Loss: 0.378697
Epoch 5099 
Prediction Loss: 0.385216
Epoch 5149 
Prediction Loss: 0.374016
Epoch 5199 
Prediction Loss: 0.376876
Epoch 5249 
Prediction Loss: 0.364387
Epoch 5299 
Prediction Loss: 0.365372
Epoch 5349 
Prediction Loss: 0.393632
Epoch 5399 
Prediction Loss: 0.371982
Epoch 5449 
Prediction Loss: 0.392187
Epoch 5499 
Prediction Loss: 0.376930
Epoch 5549 
Prediction Loss: 0.362947
Epoch 5599 
Prediction Loss: 0.379002
Epoch 5649 
Prediction Loss: 0.371386
Epoch 5699 
Prediction Loss: 0.362250
Epoch 5749 
Prediction Loss: 0.366478
Epoch 5799 
Prediction Loss: 0.378397
Epoch 5849 
Prediction Loss: 0.368753
Epoch 5899 
Prediction Loss: 0.362044
Epoch 5949 
Prediction Loss: 0.361749
Epoch 5999 
Prediction Loss: 0.362448
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.609613
Insample Error 2.920478
[31m========== repeat time 10 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 12.602144
Rec Loss: 10.895223
KL Loss: 1.706921
Y Loss: 0.935260
T Loss: 10.427593
Epoch 99 
Overall Loss: 12.396369
Rec Loss: 10.792987
KL Loss: 1.603382
Y Loss: 0.860166
T Loss: 10.362904
Epoch 149 
Overall Loss: 12.333796
Rec Loss: 10.810301
KL Loss: 1.523494
Y Loss: 0.851560
T Loss: 10.384521
Epoch 199 
Overall Loss: 12.297391
Rec Loss: 10.801540
KL Loss: 1.495851
Y Loss: 0.829800
T Loss: 10.386640
Epoch 249 
Overall Loss: 12.253197
Rec Loss: 10.809711
KL Loss: 1.443486
Y Loss: 0.834918
T Loss: 10.392252
Epoch 299 
Overall Loss: 12.247460
Rec Loss: 10.802114
KL Loss: 1.445346
Y Loss: 0.810725
T Loss: 10.396751
Epoch 349 
Overall Loss: 12.227850
Rec Loss: 10.800066
KL Loss: 1.427783
Y Loss: 0.857150
T Loss: 10.371491
Epoch 399 
Overall Loss: 12.241523
Rec Loss: 10.821474
KL Loss: 1.420049
Y Loss: 0.827545
T Loss: 10.407701
Epoch 449 
Overall Loss: 12.214183
Rec Loss: 10.809611
KL Loss: 1.404572
Y Loss: 0.818915
T Loss: 10.400154
Epoch 499 
Overall Loss: 12.212939
Rec Loss: 10.809785
KL Loss: 1.403154
Y Loss: 0.811933
T Loss: 10.403818
Epoch 549 
Overall Loss: 12.199110
Rec Loss: 10.806287
KL Loss: 1.392823
Y Loss: 0.798993
T Loss: 10.406790
Epoch 599 
Overall Loss: 12.205069
Rec Loss: 10.797193
KL Loss: 1.407876
Y Loss: 0.792835
T Loss: 10.400776
Epoch 649 
Overall Loss: 12.184155
Rec Loss: 10.809637
KL Loss: 1.374518
Y Loss: 0.833492
T Loss: 10.392892
Epoch 699 
Overall Loss: 12.192927
Rec Loss: 10.784911
KL Loss: 1.408016
Y Loss: 0.788413
T Loss: 10.390704
Epoch 749 
Overall Loss: 12.192240
Rec Loss: 10.769128
KL Loss: 1.423111
Y Loss: 0.792729
T Loss: 10.372764
Epoch 799 
Overall Loss: 12.167816
Rec Loss: 10.775493
KL Loss: 1.392322
Y Loss: 0.788999
T Loss: 10.380993
Epoch 849 
Overall Loss: 12.154343
Rec Loss: 10.791064
KL Loss: 1.363279
Y Loss: 0.814256
T Loss: 10.383936
Epoch 899 
Overall Loss: 12.130933
Rec Loss: 10.769763
KL Loss: 1.361170
Y Loss: 0.793205
T Loss: 10.373161
Epoch 949 
Overall Loss: 12.150291
Rec Loss: 10.783341
KL Loss: 1.366950
Y Loss: 0.785703
T Loss: 10.390489
Epoch 999 
Overall Loss: 12.121436
Rec Loss: 10.756831
KL Loss: 1.364604
Y Loss: 0.763800
T Loss: 10.374931
Epoch 1049 
Overall Loss: 12.138715
Rec Loss: 10.758927
KL Loss: 1.379787
Y Loss: 0.769006
T Loss: 10.374424
Epoch 1099 
Overall Loss: 12.142483
Rec Loss: 10.764533
KL Loss: 1.377949
Y Loss: 0.778486
T Loss: 10.375290
Epoch 1149 
Overall Loss: 12.109252
Rec Loss: 10.727938
KL Loss: 1.381314
Y Loss: 0.759745
T Loss: 10.348065
Epoch 1199 
Overall Loss: 12.126663
Rec Loss: 10.761437
KL Loss: 1.365226
Y Loss: 0.759689
T Loss: 10.381592
Epoch 1249 
Overall Loss: 12.115840
Rec Loss: 10.751614
KL Loss: 1.364226
Y Loss: 0.768665
T Loss: 10.367281
Epoch 1299 
Overall Loss: 12.124372
Rec Loss: 10.755342
KL Loss: 1.369030
Y Loss: 0.772250
T Loss: 10.369217
Epoch 1349 
Overall Loss: 12.104914
Rec Loss: 10.752699
KL Loss: 1.352215
Y Loss: 0.783492
T Loss: 10.360953
Epoch 1399 
Overall Loss: 12.106859
Rec Loss: 10.745878
KL Loss: 1.360981
Y Loss: 0.773863
T Loss: 10.358946
Epoch 1449 
Overall Loss: 12.101792
Rec Loss: 10.736276
KL Loss: 1.365516
Y Loss: 0.765059
T Loss: 10.353747
Epoch 1499 
Overall Loss: 12.087824
Rec Loss: 10.732093
KL Loss: 1.355731
Y Loss: 0.758186
T Loss: 10.353000
Epoch 1549 
Overall Loss: 12.092549
Rec Loss: 10.730497
KL Loss: 1.362051
Y Loss: 0.745625
T Loss: 10.357685
Epoch 1599 
Overall Loss: 12.086283
Rec Loss: 10.744444
KL Loss: 1.341839
Y Loss: 0.753515
T Loss: 10.367686
Epoch 1649 
Overall Loss: 12.075625
Rec Loss: 10.728942
KL Loss: 1.346682
Y Loss: 0.762517
T Loss: 10.347683
Epoch 1699 
Overall Loss: 12.090012
Rec Loss: 10.722122
KL Loss: 1.367890
Y Loss: 0.750635
T Loss: 10.346804
Epoch 1749 
Overall Loss: 12.068653
Rec Loss: 10.724390
KL Loss: 1.344264
Y Loss: 0.761926
T Loss: 10.343427
Epoch 1799 
Overall Loss: 12.063501
Rec Loss: 10.704954
KL Loss: 1.358547
Y Loss: 0.732648
T Loss: 10.338630
Epoch 1849 
Overall Loss: 12.065517
Rec Loss: 10.715986
KL Loss: 1.349530
Y Loss: 0.745823
T Loss: 10.343075
Epoch 1899 
Overall Loss: 12.072143
Rec Loss: 10.726179
KL Loss: 1.345965
Y Loss: 0.745277
T Loss: 10.353540
Epoch 1949 
Overall Loss: 12.041112
Rec Loss: 10.708883
KL Loss: 1.332228
Y Loss: 0.747551
T Loss: 10.335108
Epoch 1999 
Overall Loss: 12.066540
Rec Loss: 10.712720
KL Loss: 1.353820
Y Loss: 0.738263
T Loss: 10.343589
Epoch 2049 
Overall Loss: 12.024103
Rec Loss: 10.686534
KL Loss: 1.337569
Y Loss: 0.746611
T Loss: 10.313228
Epoch 2099 
Overall Loss: 12.033641
Rec Loss: 10.700853
KL Loss: 1.332787
Y Loss: 0.740426
T Loss: 10.330640
Epoch 2149 
Overall Loss: 12.038829
Rec Loss: 10.685090
KL Loss: 1.353739
Y Loss: 0.720128
T Loss: 10.325026
Epoch 2199 
Overall Loss: 12.031029
Rec Loss: 10.691739
KL Loss: 1.339289
Y Loss: 0.733246
T Loss: 10.325117
Epoch 2249 
Overall Loss: 12.037302
Rec Loss: 10.675263
KL Loss: 1.362039
Y Loss: 0.717170
T Loss: 10.316678
Epoch 2299 
Overall Loss: 12.035303
Rec Loss: 10.680444
KL Loss: 1.354859
Y Loss: 0.730346
T Loss: 10.315271
Epoch 2349 
Overall Loss: 12.027394
Rec Loss: 10.694580
KL Loss: 1.332814
Y Loss: 0.749191
T Loss: 10.319985
Epoch 2399 
Overall Loss: 12.051540
Rec Loss: 10.709027
KL Loss: 1.342513
Y Loss: 0.720844
T Loss: 10.348605
Epoch 2449 
Overall Loss: 12.029548
Rec Loss: 10.688814
KL Loss: 1.340734
Y Loss: 0.731753
T Loss: 10.322937
Epoch 2499 
Overall Loss: 12.035828
Rec Loss: 10.687407
KL Loss: 1.348422
Y Loss: 0.732710
T Loss: 10.321052
Epoch 2549 
Overall Loss: 12.001049
Rec Loss: 10.660520
KL Loss: 1.340530
Y Loss: 0.714018
T Loss: 10.303511
Epoch 2599 
Overall Loss: 12.008618
Rec Loss: 10.673680
KL Loss: 1.334938
Y Loss: 0.725085
T Loss: 10.311138
Epoch 2649 
Overall Loss: 11.998101
Rec Loss: 10.678618
KL Loss: 1.319483
Y Loss: 0.741444
T Loss: 10.307896
Epoch 2699 
Overall Loss: 12.001041
Rec Loss: 10.666789
KL Loss: 1.334252
Y Loss: 0.730001
T Loss: 10.301789
Epoch 2749 
Overall Loss: 11.975493
Rec Loss: 10.643713
KL Loss: 1.331780
Y Loss: 0.708110
T Loss: 10.289659
Epoch 2799 
Overall Loss: 12.000199
Rec Loss: 10.663549
KL Loss: 1.336650
Y Loss: 0.738730
T Loss: 10.294184
Epoch 2849 
Overall Loss: 11.978017
Rec Loss: 10.638331
KL Loss: 1.339686
Y Loss: 0.703964
T Loss: 10.286349
Epoch 2899 
Overall Loss: 11.980111
Rec Loss: 10.667428
KL Loss: 1.312683
Y Loss: 0.742155
T Loss: 10.296351
Epoch 2949 
Overall Loss: 11.982157
Rec Loss: 10.661956
KL Loss: 1.320202
Y Loss: 0.722752
T Loss: 10.300579
Epoch 2999 
Overall Loss: 12.014616
Rec Loss: 10.680981
KL Loss: 1.333636
Y Loss: 0.734482
T Loss: 10.313739
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.824161
Epoch 99
Rec Loss: 0.820498
Epoch 149
Rec Loss: 0.808219
Epoch 199
Rec Loss: 0.824416
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.910341
Epoch 99
Rec Loss: 9.882454
Epoch 149
Rec Loss: 9.892874
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.674403
Insample Error: 1.744483
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 21.871363
Rec Loss: 18.729384
KL Loss: 3.141979
Y Loss: 8.201672
T Loss: 12.931347
X Loss: 1.697202
Epoch 99 
Overall Loss: 17.059485
Rec Loss: 13.513715
KL Loss: 3.545770
Y Loss: 2.859630
T Loss: 12.942545
X Loss: -0.858645
Epoch 149 
Overall Loss: 16.004873
Rec Loss: 12.622658
KL Loss: 3.382216
Y Loss: 2.160279
T Loss: 12.940709
X Loss: -1.398190
Epoch 199 
Overall Loss: 15.153584
Rec Loss: 11.700385
KL Loss: 3.453200
Y Loss: 1.516200
T Loss: 12.719114
X Loss: -1.776830
Epoch 249 
Overall Loss: 14.447022
Rec Loss: 10.466176
KL Loss: 3.980847
Y Loss: 1.063642
T Loss: 12.099762
X Loss: -2.165408
Epoch 299 
Overall Loss: 14.154824
Rec Loss: 9.914329
KL Loss: 4.240496
Y Loss: 0.938247
T Loss: 11.794600
X Loss: -2.349395
Epoch 349 
Overall Loss: 13.834457
Rec Loss: 9.175317
KL Loss: 4.659140
Y Loss: 0.925138
T Loss: 11.434604
X Loss: -2.721855
Epoch 399 
Overall Loss: 13.567866
Rec Loss: 8.532434
KL Loss: 5.035431
Y Loss: 0.914938
T Loss: 11.170502
X Loss: -3.095536
Epoch 449 
Overall Loss: 13.442773
Rec Loss: 8.205099
KL Loss: 5.237673
Y Loss: 0.954882
T Loss: 11.059955
X Loss: -3.332296
Epoch 499 
Overall Loss: 13.349669
Rec Loss: 8.009468
KL Loss: 5.340201
Y Loss: 0.946296
T Loss: 10.974345
X Loss: -3.438025
Epoch 549 
Overall Loss: 13.309595
Rec Loss: 7.887989
KL Loss: 5.421606
Y Loss: 0.947445
T Loss: 10.956467
X Loss: -3.542201
Epoch 599 
Overall Loss: 13.234604
Rec Loss: 7.778940
KL Loss: 5.455663
Y Loss: 0.922837
T Loss: 10.942126
X Loss: -3.624604
Epoch 649 
Overall Loss: 13.213505
Rec Loss: 7.705949
KL Loss: 5.507556
Y Loss: 0.935914
T Loss: 10.919876
X Loss: -3.681884
Epoch 699 
Overall Loss: 13.174570
Rec Loss: 7.638435
KL Loss: 5.536134
Y Loss: 0.918722
T Loss: 10.918573
X Loss: -3.739498
Epoch 749 
Overall Loss: 13.179353
Rec Loss: 7.599582
KL Loss: 5.579771
Y Loss: 0.913742
T Loss: 10.923792
X Loss: -3.781082
Epoch 799 
Overall Loss: 13.141794
Rec Loss: 7.516259
KL Loss: 5.625535
Y Loss: 0.906548
T Loss: 10.925389
X Loss: -3.862404
Epoch 849 
Overall Loss: 13.132928
Rec Loss: 7.521613
KL Loss: 5.611316
Y Loss: 0.916374
T Loss: 10.927163
X Loss: -3.863737
Epoch 899 
Overall Loss: 13.094993
Rec Loss: 7.443193
KL Loss: 5.651799
Y Loss: 0.890313
T Loss: 10.918484
X Loss: -3.920447
Epoch 949 
Overall Loss: 13.085633
Rec Loss: 7.404810
KL Loss: 5.680823
Y Loss: 0.895967
T Loss: 10.930795
X Loss: -3.973969
Epoch 999 
Overall Loss: 13.072083
Rec Loss: 7.364036
KL Loss: 5.708047
Y Loss: 0.880165
T Loss: 10.926473
X Loss: -4.002520
Epoch 1049 
Overall Loss: 13.038567
Rec Loss: 7.321449
KL Loss: 5.717118
Y Loss: 0.882492
T Loss: 10.929615
X Loss: -4.049412
Epoch 1099 
Overall Loss: 13.024144
Rec Loss: 7.280992
KL Loss: 5.743152
Y Loss: 0.903912
T Loss: 10.926187
X Loss: -4.097151
Epoch 1149 
Overall Loss: 13.009288
Rec Loss: 7.238872
KL Loss: 5.770416
Y Loss: 0.889484
T Loss: 10.937252
X Loss: -4.143122
Epoch 1199 
Overall Loss: 12.990979
Rec Loss: 7.194772
KL Loss: 5.796207
Y Loss: 0.898371
T Loss: 10.920272
X Loss: -4.174685
Epoch 1249 
Overall Loss: 13.003393
Rec Loss: 7.175533
KL Loss: 5.827860
Y Loss: 0.901787
T Loss: 10.935817
X Loss: -4.211178
Epoch 1299 
Overall Loss: 12.992070
Rec Loss: 7.129700
KL Loss: 5.862370
Y Loss: 0.876883
T Loss: 10.963057
X Loss: -4.271799
Epoch 1349 
Overall Loss: 12.984964
Rec Loss: 7.097224
KL Loss: 5.887739
Y Loss: 0.874938
T Loss: 10.956746
X Loss: -4.296990
Epoch 1399 
Overall Loss: 12.970709
Rec Loss: 7.073159
KL Loss: 5.897549
Y Loss: 0.879539
T Loss: 10.974832
X Loss: -4.341442
Epoch 1449 
Overall Loss: 12.959084
Rec Loss: 7.004048
KL Loss: 5.955036
Y Loss: 0.873941
T Loss: 10.951419
X Loss: -4.384341
Epoch 1499 
Overall Loss: 12.949785
Rec Loss: 6.962861
KL Loss: 5.986924
Y Loss: 0.875440
T Loss: 10.960787
X Loss: -4.435646
Epoch 1549 
Overall Loss: 12.930677
Rec Loss: 6.952455
KL Loss: 5.978222
Y Loss: 0.868693
T Loss: 10.984485
X Loss: -4.466377
Epoch 1599 
Overall Loss: 12.934620
Rec Loss: 6.911514
KL Loss: 6.023105
Y Loss: 0.862522
T Loss: 10.976210
X Loss: -4.495957
Epoch 1649 
Overall Loss: 12.918894
Rec Loss: 6.855672
KL Loss: 6.063222
Y Loss: 0.869113
T Loss: 10.986030
X Loss: -4.564915
Epoch 1699 
Overall Loss: 12.936613
Rec Loss: 6.845221
KL Loss: 6.091391
Y Loss: 0.881312
T Loss: 10.991372
X Loss: -4.586807
Epoch 1749 
Overall Loss: 12.894134
Rec Loss: 6.800618
KL Loss: 6.093516
Y Loss: 0.869030
T Loss: 11.001204
X Loss: -4.635100
Epoch 1799 
Overall Loss: 12.870245
Rec Loss: 6.783170
KL Loss: 6.087076
Y Loss: 0.872280
T Loss: 10.997767
X Loss: -4.650738
Epoch 1849 
Overall Loss: 12.910572
Rec Loss: 6.776284
KL Loss: 6.134288
Y Loss: 0.871389
T Loss: 11.003997
X Loss: -4.663408
Epoch 1899 
Overall Loss: 12.890089
Rec Loss: 6.726847
KL Loss: 6.163243
Y Loss: 0.876021
T Loss: 10.994845
X Loss: -4.706009
Epoch 1949 
Overall Loss: 12.907528
Rec Loss: 6.711831
KL Loss: 6.195696
Y Loss: 0.892555
T Loss: 11.011324
X Loss: -4.745770
Epoch 1999 
Overall Loss: 12.913818
Rec Loss: 6.715292
KL Loss: 6.198526
Y Loss: 0.868093
T Loss: 11.012280
X Loss: -4.731034
Epoch 2049 
Overall Loss: 12.886558
Rec Loss: 6.676168
KL Loss: 6.210390
Y Loss: 0.866913
T Loss: 11.014041
X Loss: -4.771328
Epoch 2099 
Overall Loss: 12.867391
Rec Loss: 6.639644
KL Loss: 6.227747
Y Loss: 0.865105
T Loss: 11.021516
X Loss: -4.814425
Epoch 2149 
Overall Loss: 12.858841
Rec Loss: 6.616992
KL Loss: 6.241849
Y Loss: 0.886549
T Loss: 11.016549
X Loss: -4.842831
Epoch 2199 
Overall Loss: 12.856333
Rec Loss: 6.608486
KL Loss: 6.247848
Y Loss: 0.861589
T Loss: 11.032199
X Loss: -4.854508
Epoch 2249 
Overall Loss: 12.872489
Rec Loss: 6.593852
KL Loss: 6.278637
Y Loss: 0.868370
T Loss: 11.035483
X Loss: -4.875816
Epoch 2299 
Overall Loss: 12.870545
Rec Loss: 6.542938
KL Loss: 6.327607
Y Loss: 0.862166
T Loss: 11.020950
X Loss: -4.909095
Epoch 2349 
Overall Loss: 12.872975
Rec Loss: 6.568493
KL Loss: 6.304482
Y Loss: 0.883102
T Loss: 11.038093
X Loss: -4.911151
Epoch 2399 
Overall Loss: 12.880946
Rec Loss: 6.566772
KL Loss: 6.314174
Y Loss: 0.897724
T Loss: 11.042767
X Loss: -4.924857
Epoch 2449 
Overall Loss: 12.875988
Rec Loss: 6.532103
KL Loss: 6.343884
Y Loss: 0.858604
T Loss: 11.043556
X Loss: -4.940754
Epoch 2499 
Overall Loss: 12.851098
Rec Loss: 6.504064
KL Loss: 6.347034
Y Loss: 0.883022
T Loss: 11.041370
X Loss: -4.978817
Epoch 2549 
Overall Loss: 12.812832
Rec Loss: 6.443503
KL Loss: 6.369330
Y Loss: 0.866445
T Loss: 11.036320
X Loss: -5.026040
Epoch 2599 
Overall Loss: 12.839080
Rec Loss: 6.481244
KL Loss: 6.357836
Y Loss: 0.871378
T Loss: 11.049493
X Loss: -5.003938
Epoch 2649 
Overall Loss: 12.819670
Rec Loss: 6.419847
KL Loss: 6.399824
Y Loss: 0.861660
T Loss: 11.046810
X Loss: -5.057793
Epoch 2699 
Overall Loss: 12.844078
Rec Loss: 6.420190
KL Loss: 6.423888
Y Loss: 0.853682
T Loss: 11.043302
X Loss: -5.049953
Epoch 2749 
Overall Loss: 12.798688
Rec Loss: 6.384911
KL Loss: 6.413777
Y Loss: 0.859227
T Loss: 11.027071
X Loss: -5.071774
Epoch 2799 
Overall Loss: 12.834844
Rec Loss: 6.410032
KL Loss: 6.424812
Y Loss: 0.863596
T Loss: 11.044407
X Loss: -5.066173
Epoch 2849 
Overall Loss: 12.824775
Rec Loss: 6.366490
KL Loss: 6.458285
Y Loss: 0.865133
T Loss: 11.051412
X Loss: -5.117489
Epoch 2899 
Overall Loss: 12.808054
Rec Loss: 6.313655
KL Loss: 6.494399
Y Loss: 0.868753
T Loss: 11.043983
X Loss: -5.164704
Epoch 2949 
Overall Loss: 12.862773
Rec Loss: 6.376660
KL Loss: 6.486112
Y Loss: 0.874381
T Loss: 11.050218
X Loss: -5.110749
Epoch 2999 
Overall Loss: 12.819986
Rec Loss: 6.339805
KL Loss: 6.480181
Y Loss: 0.860717
T Loss: 11.063085
X Loss: -5.153639
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 1.480890
Epoch 99
Rec Loss: 1.477501
Epoch 149
Rec Loss: 1.477974
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 2.012204
Epoch 99
Rec Loss: 2.002970
Epoch 149
Rec Loss: 2.002826
Epoch 199
Rec Loss: 2.001132
Epoch 249
Rec Loss: 2.007149
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.667896
Insample Error 2.436684
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.933507
Epoch 99 
Prediction Loss: 1.700488
Epoch 149 
Prediction Loss: 1.617026
Epoch 199 
Prediction Loss: 1.559001
Epoch 249 
Prediction Loss: 1.487309
Epoch 299 
Prediction Loss: 1.381277
Epoch 349 
Prediction Loss: 1.335621
Epoch 399 
Prediction Loss: 1.282934
Epoch 449 
Prediction Loss: 1.306446
Epoch 499 
Prediction Loss: 1.193583
Epoch 549 
Prediction Loss: 1.128685
Epoch 599 
Prediction Loss: 1.097233
Epoch 649 
Prediction Loss: 1.143683
Epoch 699 
Prediction Loss: 1.044710
Epoch 749 
Prediction Loss: 0.982054
Epoch 799 
Prediction Loss: 0.930282
Epoch 849 
Prediction Loss: 0.937631
Epoch 899 
Prediction Loss: 0.884857
Epoch 949 
Prediction Loss: 0.851602
Epoch 999 
Prediction Loss: 0.842252
Epoch 1049 
Prediction Loss: 0.818886
Epoch 1099 
Prediction Loss: 0.821431
Epoch 1149 
Prediction Loss: 0.765660
Epoch 1199 
Prediction Loss: 0.754824
Epoch 1249 
Prediction Loss: 0.738990
Epoch 1299 
Prediction Loss: 0.737627
Epoch 1349 
Prediction Loss: 0.705271
Epoch 1399 
Prediction Loss: 0.705399
Epoch 1449 
Prediction Loss: 0.713622
Epoch 1499 
Prediction Loss: 0.695153
Epoch 1549 
Prediction Loss: 0.665454
Epoch 1599 
Prediction Loss: 0.679000
Epoch 1649 
Prediction Loss: 0.646764
Epoch 1699 
Prediction Loss: 0.644115
Epoch 1749 
Prediction Loss: 0.638764
Epoch 1799 
Prediction Loss: 0.647588
Epoch 1849 
Prediction Loss: 0.602096
Epoch 1899 
Prediction Loss: 0.594254
Epoch 1949 
Prediction Loss: 0.600023
Epoch 1999 
Prediction Loss: 0.591240
Epoch 2049 
Prediction Loss: 0.601224
Epoch 2099 
Prediction Loss: 0.589240
Epoch 2149 
Prediction Loss: 0.582154
Epoch 2199 
Prediction Loss: 0.564930
Epoch 2249 
Prediction Loss: 0.547252
Epoch 2299 
Prediction Loss: 0.553966
Epoch 2349 
Prediction Loss: 0.529700
Epoch 2399 
Prediction Loss: 0.555978
Epoch 2449 
Prediction Loss: 0.556778
Epoch 2499 
Prediction Loss: 0.539035
Epoch 2549 
Prediction Loss: 0.528645
Epoch 2599 
Prediction Loss: 0.518680
Epoch 2649 
Prediction Loss: 0.529267
Epoch 2699 
Prediction Loss: 0.520717
Epoch 2749 
Prediction Loss: 0.511072
Epoch 2799 
Prediction Loss: 0.525569
Epoch 2849 
Prediction Loss: 0.501635
Epoch 2899 
Prediction Loss: 0.514882
Epoch 2949 
Prediction Loss: 0.495956
Epoch 2999 
Prediction Loss: 0.491266
Epoch 3049 
Prediction Loss: 0.503093
Epoch 3099 
Prediction Loss: 0.489078
Epoch 3149 
Prediction Loss: 0.502959
Epoch 3199 
Prediction Loss: 0.490524
Epoch 3249 
Prediction Loss: 0.481062
Epoch 3299 
Prediction Loss: 0.478484
Epoch 3349 
Prediction Loss: 0.490702
Epoch 3399 
Prediction Loss: 0.481663
Epoch 3449 
Prediction Loss: 0.483070
Epoch 3499 
Prediction Loss: 0.467887
Epoch 3549 
Prediction Loss: 0.473393
Epoch 3599 
Prediction Loss: 0.518967
Epoch 3649 
Prediction Loss: 0.458850
Epoch 3699 
Prediction Loss: 0.474753
Epoch 3749 
Prediction Loss: 0.462591
Epoch 3799 
Prediction Loss: 0.463414
Epoch 3849 
Prediction Loss: 0.469641
Epoch 3899 
Prediction Loss: 0.458542
Epoch 3949 
Prediction Loss: 0.473861
Epoch 3999 
Prediction Loss: 0.453913
Epoch 4049 
Prediction Loss: 0.465099
Epoch 4099 
Prediction Loss: 0.441884
Epoch 4149 
Prediction Loss: 0.446054
Epoch 4199 
Prediction Loss: 0.444614
Epoch 4249 
Prediction Loss: 0.450486
Epoch 4299 
Prediction Loss: 0.444524
Epoch 4349 
Prediction Loss: 0.468763
Epoch 4399 
Prediction Loss: 0.444781
Epoch 4449 
Prediction Loss: 0.446960
Epoch 4499 
Prediction Loss: 0.467666
Epoch 4549 
Prediction Loss: 0.431351
Epoch 4599 
Prediction Loss: 0.441666
Epoch 4649 
Prediction Loss: 0.433678
Epoch 4699 
Prediction Loss: 0.430110
Epoch 4749 
Prediction Loss: 0.435910
Epoch 4799 
Prediction Loss: 0.437354
Epoch 4849 
Prediction Loss: 0.434721
Epoch 4899 
Prediction Loss: 0.449766
Epoch 4949 
Prediction Loss: 0.465528
Epoch 4999 
Prediction Loss: 0.422372
Epoch 5049 
Prediction Loss: 0.433476
Epoch 5099 
Prediction Loss: 0.415270
Epoch 5149 
Prediction Loss: 0.433442
Epoch 5199 
Prediction Loss: 0.449782
Epoch 5249 
Prediction Loss: 0.422451
Epoch 5299 
Prediction Loss: 0.429325
Epoch 5349 
Prediction Loss: 0.422574
Epoch 5399 
Prediction Loss: 0.420660
Epoch 5449 
Prediction Loss: 0.413461
Epoch 5499 
Prediction Loss: 0.417921
Epoch 5549 
Prediction Loss: 0.415781
Epoch 5599 
Prediction Loss: 0.425489
Epoch 5649 
Prediction Loss: 0.410312
Epoch 5699 
Prediction Loss: 0.436248
Epoch 5749 
Prediction Loss: 0.411318
Epoch 5799 
Prediction Loss: 0.450736
Epoch 5849 
Prediction Loss: 0.403300
Epoch 5899 
Prediction Loss: 0.417244
Epoch 5949 
Prediction Loss: 0.409091
Epoch 5999 
Prediction Loss: 0.423390
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.642129
Insample Error 2.949069
Ours, Train RMSE
0.6699, 
0.6717, 
0.6732, 
0.6672, 
0.6757, 
0.6689, 
0.6620, 
0.6685, 
0.6626, 
0.6744, 
CEVAE, Train RMSE
0.6668, 
0.6495, 
0.6599, 
0.6337, 
0.6561, 
0.6722, 
0.6625, 
0.6495, 
0.6459, 
0.6679, 
Ours, Insample RMSE
1.8271, 
1.8862, 
1.8047, 
1.8606, 
1.8370, 
1.7836, 
1.7977, 
1.7859, 
1.7952, 
1.7445, 
CEVAE, Insample RMSE
2.5783, 
2.4414, 
2.3655, 
2.4760, 
2.4420, 
2.5462, 
2.5145, 
2.3835, 
2.4756, 
2.4367, 
Direct Regression, Insample RMSE
3.0536, 
2.9869, 
3.0542, 
2.9705, 
3.0041, 
2.9881, 
3.0552, 
3.0700, 
2.9205, 
2.9491, 
Train, RMSE mean 0.6694 std 0.0044
CEVAE, RMSE mean 0.6564 std 0.0112
Ours, RMSE mean 1.8122 std 0.0391, reconstruct confounder 0.8199 (0.0085) noise 9.8797 (0.0186)
CEVAE, RMSE mean 2.4660 std 0.0637, reconstruct confounder 1.5281 (0.0332) noise 1.9987 (0.0030)
Direct Regression, RMSE mean 3.0052 std 0.0486
