Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=4, mask=0, nlayer=50, obsm=3, stop=2000, ycof=0.5, ylayer=50)
Y Mean 0.467551, Std 3.004609 
Test Y Mean 0.015136, Std 2.801871 
Observe confounder 3, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.117302
Rec Loss: 9.994970
KL Loss: 1.122332
Y Loss: 0.983640
T Loss: 9.503150
Epoch 99 
Overall Loss: 10.624928
Rec Loss: 9.870437
KL Loss: 0.754491
Y Loss: 0.526892
T Loss: 9.606991
Epoch 149 
Overall Loss: 10.525173
Rec Loss: 9.774964
KL Loss: 0.750209
Y Loss: 0.404554
T Loss: 9.572687
Epoch 199 
Overall Loss: 10.473382
Rec Loss: 9.746656
KL Loss: 0.726726
Y Loss: 0.352376
T Loss: 9.570467
Epoch 249 
Overall Loss: 10.456928
Rec Loss: 9.734046
KL Loss: 0.722882
Y Loss: 0.334767
T Loss: 9.566662
Epoch 299 
Overall Loss: 10.441950
Rec Loss: 9.716565
KL Loss: 0.725385
Y Loss: 0.314914
T Loss: 9.559108
Epoch 349 
Overall Loss: 10.434400
Rec Loss: 9.701060
KL Loss: 0.733340
Y Loss: 0.297725
T Loss: 9.552198
Epoch 399 
Overall Loss: 10.419259
Rec Loss: 9.694020
KL Loss: 0.725239
Y Loss: 0.293072
T Loss: 9.547484
Epoch 449 
Overall Loss: 10.405175
Rec Loss: 9.700457
KL Loss: 0.704718
Y Loss: 0.287230
T Loss: 9.556842
Epoch 499 
Overall Loss: 10.400162
Rec Loss: 9.668816
KL Loss: 0.731347
Y Loss: 0.277976
T Loss: 9.529827
Epoch 549 
Overall Loss: 10.398243
Rec Loss: 9.676341
KL Loss: 0.721903
Y Loss: 0.281289
T Loss: 9.535696
Epoch 599 
Overall Loss: 10.400306
Rec Loss: 9.665140
KL Loss: 0.735165
Y Loss: 0.278572
T Loss: 9.525855
Epoch 649 
Overall Loss: 10.400257
Rec Loss: 9.672237
KL Loss: 0.728020
Y Loss: 0.270066
T Loss: 9.537203
Epoch 699 
Overall Loss: 10.378727
Rec Loss: 9.656270
KL Loss: 0.722457
Y Loss: 0.272401
T Loss: 9.520070
Epoch 749 
Overall Loss: 10.386442
Rec Loss: 9.654135
KL Loss: 0.732306
Y Loss: 0.266541
T Loss: 9.520865
Epoch 799 
Overall Loss: 10.383149
Rec Loss: 9.655165
KL Loss: 0.727984
Y Loss: 0.255156
T Loss: 9.527587
Epoch 849 
Overall Loss: 10.381595
Rec Loss: 9.644514
KL Loss: 0.737081
Y Loss: 0.254908
T Loss: 9.517059
Epoch 899 
Overall Loss: 10.352500
Rec Loss: 9.621434
KL Loss: 0.731066
Y Loss: 0.250859
T Loss: 9.496005
Epoch 949 
Overall Loss: 10.367467
Rec Loss: 9.607092
KL Loss: 0.760375
Y Loss: 0.257008
T Loss: 9.478589
Epoch 999 
Overall Loss: 10.348801
Rec Loss: 9.611410
KL Loss: 0.737391
Y Loss: 0.250866
T Loss: 9.485977
Epoch 1049 
Overall Loss: 10.360526
Rec Loss: 9.607660
KL Loss: 0.752866
Y Loss: 0.251476
T Loss: 9.481922
Epoch 1099 
Overall Loss: 10.378303
Rec Loss: 9.634807
KL Loss: 0.743497
Y Loss: 0.251163
T Loss: 9.509225
Epoch 1149 
Overall Loss: 10.345862
Rec Loss: 9.604059
KL Loss: 0.741803
Y Loss: 0.245695
T Loss: 9.481211
Epoch 1199 
Overall Loss: 10.361405
Rec Loss: 9.609647
KL Loss: 0.751758
Y Loss: 0.248817
T Loss: 9.485238
Epoch 1249 
Overall Loss: 10.346376
Rec Loss: 9.600685
KL Loss: 0.745691
Y Loss: 0.245408
T Loss: 9.477982
Epoch 1299 
Overall Loss: 10.352721
Rec Loss: 9.592140
KL Loss: 0.760581
Y Loss: 0.241393
T Loss: 9.471444
Epoch 1349 
Overall Loss: 10.348117
Rec Loss: 9.592560
KL Loss: 0.755557
Y Loss: 0.244650
T Loss: 9.470235
Epoch 1399 
Overall Loss: 10.334896
Rec Loss: 9.602199
KL Loss: 0.732698
Y Loss: 0.238205
T Loss: 9.483096
Epoch 1449 
Overall Loss: 10.327772
Rec Loss: 9.561065
KL Loss: 0.766707
Y Loss: 0.242799
T Loss: 9.439665
Epoch 1499 
Overall Loss: 10.346190
Rec Loss: 9.587405
KL Loss: 0.758784
Y Loss: 0.236230
T Loss: 9.469290
Epoch 1549 
Overall Loss: 10.329178
Rec Loss: 9.574674
KL Loss: 0.754504
Y Loss: 0.239118
T Loss: 9.455115
Epoch 1599 
Overall Loss: 10.333858
Rec Loss: 9.587851
KL Loss: 0.746007
Y Loss: 0.236432
T Loss: 9.469635
Epoch 1649 
Overall Loss: 10.317777
Rec Loss: 9.563336
KL Loss: 0.754441
Y Loss: 0.231718
T Loss: 9.447477
Epoch 1699 
Overall Loss: 10.322659
Rec Loss: 9.581866
KL Loss: 0.740794
Y Loss: 0.229403
T Loss: 9.467164
Epoch 1749 
Overall Loss: 10.310796
Rec Loss: 9.562808
KL Loss: 0.747988
Y Loss: 0.229702
T Loss: 9.447956
Epoch 1799 
Overall Loss: 10.329146
Rec Loss: 9.571753
KL Loss: 0.757393
Y Loss: 0.232013
T Loss: 9.455747
Epoch 1849 
Overall Loss: 10.313198
Rec Loss: 9.567513
KL Loss: 0.745684
Y Loss: 0.230927
T Loss: 9.452050
Epoch 1899 
Overall Loss: 10.304992
Rec Loss: 9.555273
KL Loss: 0.749720
Y Loss: 0.227242
T Loss: 9.441651
Epoch 1949 
Overall Loss: 10.331133
Rec Loss: 9.561439
KL Loss: 0.769695
Y Loss: 0.228366
T Loss: 9.447256
Epoch 1999 
Overall Loss: 10.300001
Rec Loss: 9.566128
KL Loss: 0.733873
Y Loss: 0.224641
T Loss: 9.453807
Epoch 2049 
Overall Loss: 10.305098
Rec Loss: 9.551809
KL Loss: 0.753290
Y Loss: 0.222923
T Loss: 9.440347
Epoch 2099 
Overall Loss: 10.312510
Rec Loss: 9.557069
KL Loss: 0.755440
Y Loss: 0.226208
T Loss: 9.443966
Epoch 2149 
Overall Loss: 10.306602
Rec Loss: 9.546773
KL Loss: 0.759828
Y Loss: 0.225326
T Loss: 9.434111
Epoch 2199 
Overall Loss: 10.314109
Rec Loss: 9.545936
KL Loss: 0.768174
Y Loss: 0.222503
T Loss: 9.434685
Epoch 2249 
Overall Loss: 10.292219
Rec Loss: 9.540649
KL Loss: 0.751570
Y Loss: 0.224897
T Loss: 9.428201
Epoch 2299 
Overall Loss: 10.299959
Rec Loss: 9.553682
KL Loss: 0.746277
Y Loss: 0.220357
T Loss: 9.443503
Epoch 2349 
Overall Loss: 10.290301
Rec Loss: 9.545263
KL Loss: 0.745039
Y Loss: 0.222152
T Loss: 9.434187
Epoch 2399 
Overall Loss: 10.274645
Rec Loss: 9.535500
KL Loss: 0.739145
Y Loss: 0.217563
T Loss: 9.426718
Epoch 2449 
Overall Loss: 10.287834
Rec Loss: 9.540245
KL Loss: 0.747590
Y Loss: 0.217893
T Loss: 9.431298
Epoch 2499 
Overall Loss: 10.293688
Rec Loss: 9.525773
KL Loss: 0.767915
Y Loss: 0.215741
T Loss: 9.417902
Epoch 2549 
Overall Loss: 10.288617
Rec Loss: 9.531764
KL Loss: 0.756852
Y Loss: 0.213871
T Loss: 9.424829
Epoch 2599 
Overall Loss: 10.298377
Rec Loss: 9.548874
KL Loss: 0.749503
Y Loss: 0.211911
T Loss: 9.442919
Epoch 2649 
Overall Loss: 10.302232
Rec Loss: 9.535087
KL Loss: 0.767144
Y Loss: 0.211368
T Loss: 9.429404
Epoch 2699 
Overall Loss: 10.299443
Rec Loss: 9.531162
KL Loss: 0.768280
Y Loss: 0.213240
T Loss: 9.424542
Epoch 2749 
Overall Loss: 10.272807
Rec Loss: 9.522429
KL Loss: 0.750378
Y Loss: 0.212168
T Loss: 9.416345
Epoch 2799 
Overall Loss: 10.272498
Rec Loss: 9.514256
KL Loss: 0.758242
Y Loss: 0.212420
T Loss: 9.408046
Epoch 2849 
Overall Loss: 10.308832
Rec Loss: 9.522489
KL Loss: 0.786344
Y Loss: 0.211619
T Loss: 9.416680
Epoch 2899 
Overall Loss: 10.301274
Rec Loss: 9.523034
KL Loss: 0.778240
Y Loss: 0.209152
T Loss: 9.418458
Epoch 2949 
Overall Loss: 10.284308
Rec Loss: 9.525336
KL Loss: 0.758972
Y Loss: 0.210740
T Loss: 9.419966
Epoch 2999 
Overall Loss: 10.284016
Rec Loss: 9.515068
KL Loss: 0.768947
Y Loss: 0.205636
T Loss: 9.412251
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.442830
Epoch 99
Rec Loss: 0.431279
Epoch 149
Rec Loss: 0.429019
Epoch 199
Rec Loss: 0.429284
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.743069
Epoch 99
Rec Loss: 9.731484
Epoch 149
Rec Loss: 9.726421
Epoch 199
Rec Loss: 9.721969
Epoch 249
Rec Loss: 9.709495
Epoch 299
Rec Loss: 9.724847
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.443724
Insample Error: 1.202100
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.061247
Epoch 99
Rec Loss: 4.070524
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 8.807339
Epoch 99
Rec Loss: 8.722925
Epoch 149
Rec Loss: 8.771704
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.993478
Insample Error 2.801339
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.733940
Epoch 99 
Prediction Loss: 0.410805
Epoch 149 
Prediction Loss: 0.328537
Epoch 199 
Prediction Loss: 0.299651
Epoch 249 
Prediction Loss: 0.283580
Epoch 299 
Prediction Loss: 0.279600
Epoch 349 
Prediction Loss: 0.273276
Epoch 399 
Prediction Loss: 0.270985
Epoch 449 
Prediction Loss: 0.270305
Epoch 499 
Prediction Loss: 0.264863
Epoch 549 
Prediction Loss: 0.260211
Epoch 599 
Prediction Loss: 0.257044
Epoch 649 
Prediction Loss: 0.258875
Epoch 699 
Prediction Loss: 0.254074
Epoch 749 
Prediction Loss: 0.258150
Epoch 799 
Prediction Loss: 0.250511
Epoch 849 
Prediction Loss: 0.251515
Epoch 899 
Prediction Loss: 0.243226
Epoch 949 
Prediction Loss: 0.253537
Epoch 999 
Prediction Loss: 0.240063
Epoch 1049 
Prediction Loss: 0.241722
Epoch 1099 
Prediction Loss: 0.243261
Epoch 1149 
Prediction Loss: 0.242978
Epoch 1199 
Prediction Loss: 0.244683
Epoch 1249 
Prediction Loss: 0.238301
Epoch 1299 
Prediction Loss: 0.235751
Epoch 1349 
Prediction Loss: 0.235384
Epoch 1399 
Prediction Loss: 0.230609
Epoch 1449 
Prediction Loss: 0.232758
Epoch 1499 
Prediction Loss: 0.233992
Epoch 1549 
Prediction Loss: 0.227767
Epoch 1599 
Prediction Loss: 0.230042
Epoch 1649 
Prediction Loss: 0.224517
Epoch 1699 
Prediction Loss: 0.228099
Epoch 1749 
Prediction Loss: 0.228260
Epoch 1799 
Prediction Loss: 0.224944
Epoch 1849 
Prediction Loss: 0.230298
Epoch 1899 
Prediction Loss: 0.222116
Epoch 1949 
Prediction Loss: 0.222868
Epoch 1999 
Prediction Loss: 0.219095
Epoch 2049 
Prediction Loss: 0.219898
Epoch 2099 
Prediction Loss: 0.218535
Epoch 2149 
Prediction Loss: 0.218307
Epoch 2199 
Prediction Loss: 0.218893
Epoch 2249 
Prediction Loss: 0.214431
Epoch 2299 
Prediction Loss: 0.215334
Epoch 2349 
Prediction Loss: 0.213733
Epoch 2399 
Prediction Loss: 0.221002
Epoch 2449 
Prediction Loss: 0.213911
Epoch 2499 
Prediction Loss: 0.210488
Epoch 2549 
Prediction Loss: 0.223217
Epoch 2599 
Prediction Loss: 0.210672
Epoch 2649 
Prediction Loss: 0.211595
Epoch 2699 
Prediction Loss: 0.209552
Epoch 2749 
Prediction Loss: 0.207827
Epoch 2799 
Prediction Loss: 0.207049
Epoch 2849 
Prediction Loss: 0.209272
Epoch 2899 
Prediction Loss: 0.204943
Epoch 2949 
Prediction Loss: 0.207112
Epoch 2999 
Prediction Loss: 0.206943
Epoch 3049 
Prediction Loss: 0.204956
Epoch 3099 
Prediction Loss: 0.209527
Epoch 3149 
Prediction Loss: 0.201517
Epoch 3199 
Prediction Loss: 0.211004
Epoch 3249 
Prediction Loss: 0.202190
Epoch 3299 
Prediction Loss: 0.200415
Epoch 3349 
Prediction Loss: 0.200012
Epoch 3399 
Prediction Loss: 0.201372
Epoch 3449 
Prediction Loss: 0.203976
Epoch 3499 
Prediction Loss: 0.202313
Epoch 3549 
Prediction Loss: 0.199180
Epoch 3599 
Prediction Loss: 0.204589
Epoch 3649 
Prediction Loss: 0.196440
Epoch 3699 
Prediction Loss: 0.199372
Epoch 3749 
Prediction Loss: 0.198793
Epoch 3799 
Prediction Loss: 0.193706
Epoch 3849 
Prediction Loss: 0.196115
Epoch 3899 
Prediction Loss: 0.204802
Epoch 3949 
Prediction Loss: 0.194151
Epoch 3999 
Prediction Loss: 0.194472
Epoch 4049 
Prediction Loss: 0.193900
Epoch 4099 
Prediction Loss: 0.190890
Epoch 4149 
Prediction Loss: 0.191222
Epoch 4199 
Prediction Loss: 0.195059
Epoch 4249 
Prediction Loss: 0.189009
Epoch 4299 
Prediction Loss: 0.192445
Epoch 4349 
Prediction Loss: 0.189349
Epoch 4399 
Prediction Loss: 0.189795
Epoch 4449 
Prediction Loss: 0.186358
Epoch 4499 
Prediction Loss: 0.189595
Epoch 4549 
Prediction Loss: 0.186245
Epoch 4599 
Prediction Loss: 0.184678
Epoch 4649 
Prediction Loss: 0.195326
Epoch 4699 
Prediction Loss: 0.185071
Epoch 4749 
Prediction Loss: 0.185277
Epoch 4799 
Prediction Loss: 0.188438
Epoch 4849 
Prediction Loss: 0.183270
Epoch 4899 
Prediction Loss: 0.183163
Epoch 4949 
Prediction Loss: 0.181987
Epoch 4999 
Prediction Loss: 0.180436
Epoch 5049 
Prediction Loss: 0.181732
Epoch 5099 
Prediction Loss: 0.187500
Epoch 5149 
Prediction Loss: 0.179171
Epoch 5199 
Prediction Loss: 0.179938
Epoch 5249 
Prediction Loss: 0.180873
Epoch 5299 
Prediction Loss: 0.178881
Epoch 5349 
Prediction Loss: 0.177456
Epoch 5399 
Prediction Loss: 0.180607
Epoch 5449 
Prediction Loss: 0.180095
Epoch 5499 
Prediction Loss: 0.173246
Epoch 5549 
Prediction Loss: 0.176497
Epoch 5599 
Prediction Loss: 0.175659
Epoch 5649 
Prediction Loss: 0.172882
Epoch 5699 
Prediction Loss: 0.174458
Epoch 5749 
Prediction Loss: 0.171179
Epoch 5799 
Prediction Loss: 0.170234
Epoch 5849 
Prediction Loss: 0.174072
Epoch 5899 
Prediction Loss: 0.171019
Epoch 5949 
Prediction Loss: 0.175008
Epoch 5999 
Prediction Loss: 0.171151
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.415210
Insample Error 1.221003
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.145896
Rec Loss: 9.953346
KL Loss: 1.192550
Y Loss: 0.943040
T Loss: 9.481826
Epoch 99 
Overall Loss: 10.604991
Rec Loss: 9.847722
KL Loss: 0.757269
Y Loss: 0.520463
T Loss: 9.587491
Epoch 149 
Overall Loss: 10.511256
Rec Loss: 9.763738
KL Loss: 0.747517
Y Loss: 0.397618
T Loss: 9.564929
Epoch 199 
Overall Loss: 10.473035
Rec Loss: 9.743365
KL Loss: 0.729670
Y Loss: 0.362239
T Loss: 9.562246
Epoch 249 
Overall Loss: 10.459492
Rec Loss: 9.723348
KL Loss: 0.736143
Y Loss: 0.329452
T Loss: 9.558622
Epoch 299 
Overall Loss: 10.458624
Rec Loss: 9.717060
KL Loss: 0.741563
Y Loss: 0.323605
T Loss: 9.555259
Epoch 349 
Overall Loss: 10.434033
Rec Loss: 9.704073
KL Loss: 0.729960
Y Loss: 0.308352
T Loss: 9.549897
Epoch 399 
Overall Loss: 10.416383
Rec Loss: 9.685634
KL Loss: 0.730749
Y Loss: 0.299437
T Loss: 9.535915
Epoch 449 
Overall Loss: 10.427263
Rec Loss: 9.669975
KL Loss: 0.757288
Y Loss: 0.299453
T Loss: 9.520249
Epoch 499 
Overall Loss: 10.411463
Rec Loss: 9.689696
KL Loss: 0.721766
Y Loss: 0.287696
T Loss: 9.545849
Epoch 549 
Overall Loss: 10.404576
Rec Loss: 9.662768
KL Loss: 0.741808
Y Loss: 0.285984
T Loss: 9.519775
Epoch 599 
Overall Loss: 10.423812
Rec Loss: 9.667692
KL Loss: 0.756120
Y Loss: 0.283661
T Loss: 9.525862
Epoch 649 
Overall Loss: 10.410956
Rec Loss: 9.675003
KL Loss: 0.735953
Y Loss: 0.272739
T Loss: 9.538634
Epoch 699 
Overall Loss: 10.395555
Rec Loss: 9.645377
KL Loss: 0.750178
Y Loss: 0.270965
T Loss: 9.509895
Epoch 749 
Overall Loss: 10.401821
Rec Loss: 9.660107
KL Loss: 0.741715
Y Loss: 0.273461
T Loss: 9.523376
Epoch 799 
Overall Loss: 10.401803
Rec Loss: 9.677078
KL Loss: 0.724725
Y Loss: 0.273046
T Loss: 9.540555
Epoch 849 
Overall Loss: 10.381354
Rec Loss: 9.659552
KL Loss: 0.721802
Y Loss: 0.269987
T Loss: 9.524558
Epoch 899 
Overall Loss: 10.385567
Rec Loss: 9.661196
KL Loss: 0.724371
Y Loss: 0.264416
T Loss: 9.528988
Epoch 949 
Overall Loss: 10.373243
Rec Loss: 9.655306
KL Loss: 0.717937
Y Loss: 0.266568
T Loss: 9.522022
Epoch 999 
Overall Loss: 10.371234
Rec Loss: 9.628992
KL Loss: 0.742243
Y Loss: 0.252822
T Loss: 9.502580
Epoch 1049 
Overall Loss: 10.374333
Rec Loss: 9.640063
KL Loss: 0.734270
Y Loss: 0.250972
T Loss: 9.514577
Epoch 1099 
Overall Loss: 10.364659
Rec Loss: 9.628556
KL Loss: 0.736103
Y Loss: 0.253793
T Loss: 9.501659
Epoch 1149 
Overall Loss: 10.358200
Rec Loss: 9.625744
KL Loss: 0.732455
Y Loss: 0.252208
T Loss: 9.499640
Epoch 1199 
Overall Loss: 10.353291
Rec Loss: 9.629460
KL Loss: 0.723831
Y Loss: 0.252486
T Loss: 9.503217
Epoch 1249 
Overall Loss: 10.346981
Rec Loss: 9.600142
KL Loss: 0.746838
Y Loss: 0.249413
T Loss: 9.475436
Epoch 1299 
Overall Loss: 10.350049
Rec Loss: 9.604057
KL Loss: 0.745992
Y Loss: 0.247044
T Loss: 9.480535
Epoch 1349 
Overall Loss: 10.347849
Rec Loss: 9.596779
KL Loss: 0.751070
Y Loss: 0.245804
T Loss: 9.473877
Epoch 1399 
Overall Loss: 10.342602
Rec Loss: 9.588089
KL Loss: 0.754512
Y Loss: 0.248789
T Loss: 9.463695
Epoch 1449 
Overall Loss: 10.341336
Rec Loss: 9.599861
KL Loss: 0.741476
Y Loss: 0.250588
T Loss: 9.474566
Epoch 1499 
Overall Loss: 10.342207
Rec Loss: 9.583454
KL Loss: 0.758754
Y Loss: 0.242935
T Loss: 9.461986
Epoch 1549 
Overall Loss: 10.357180
Rec Loss: 9.588504
KL Loss: 0.768676
Y Loss: 0.240827
T Loss: 9.468090
Epoch 1599 
Overall Loss: 10.333279
Rec Loss: 9.587948
KL Loss: 0.745331
Y Loss: 0.238439
T Loss: 9.468728
Epoch 1649 
Overall Loss: 10.334983
Rec Loss: 9.582114
KL Loss: 0.752869
Y Loss: 0.239305
T Loss: 9.462462
Epoch 1699 
Overall Loss: 10.338022
Rec Loss: 9.575237
KL Loss: 0.762785
Y Loss: 0.240201
T Loss: 9.455136
Epoch 1749 
Overall Loss: 10.341545
Rec Loss: 9.569677
KL Loss: 0.771868
Y Loss: 0.241506
T Loss: 9.448924
Epoch 1799 
Overall Loss: 10.330676
Rec Loss: 9.572593
KL Loss: 0.758083
Y Loss: 0.236212
T Loss: 9.454487
Epoch 1849 
Overall Loss: 10.333401
Rec Loss: 9.556984
KL Loss: 0.776417
Y Loss: 0.231823
T Loss: 9.441073
Epoch 1899 
Overall Loss: 10.322608
Rec Loss: 9.584425
KL Loss: 0.738183
Y Loss: 0.236328
T Loss: 9.466261
Epoch 1949 
Overall Loss: 10.329587
Rec Loss: 9.560834
KL Loss: 0.768753
Y Loss: 0.241116
T Loss: 9.440277
Epoch 1999 
Overall Loss: 10.317899
Rec Loss: 9.546252
KL Loss: 0.771647
Y Loss: 0.228860
T Loss: 9.431823
Epoch 2049 
Overall Loss: 10.324531
Rec Loss: 9.562552
KL Loss: 0.761979
Y Loss: 0.229220
T Loss: 9.447942
Epoch 2099 
Overall Loss: 10.311676
Rec Loss: 9.551199
KL Loss: 0.760477
Y Loss: 0.231945
T Loss: 9.435227
Epoch 2149 
Overall Loss: 10.315947
Rec Loss: 9.568262
KL Loss: 0.747685
Y Loss: 0.229579
T Loss: 9.453472
Epoch 2199 
Overall Loss: 10.315714
Rec Loss: 9.547784
KL Loss: 0.767930
Y Loss: 0.228890
T Loss: 9.433339
Epoch 2249 
Overall Loss: 10.324205
Rec Loss: 9.554398
KL Loss: 0.769807
Y Loss: 0.233231
T Loss: 9.437782
Epoch 2299 
Overall Loss: 10.294541
Rec Loss: 9.540670
KL Loss: 0.753871
Y Loss: 0.224068
T Loss: 9.428635
Epoch 2349 
Overall Loss: 10.308346
Rec Loss: 9.548306
KL Loss: 0.760040
Y Loss: 0.226964
T Loss: 9.434824
Epoch 2399 
Overall Loss: 10.312603
Rec Loss: 9.539851
KL Loss: 0.772752
Y Loss: 0.225094
T Loss: 9.427305
Epoch 2449 
Overall Loss: 10.303942
Rec Loss: 9.561721
KL Loss: 0.742222
Y Loss: 0.225383
T Loss: 9.449030
Epoch 2499 
Overall Loss: 10.306365
Rec Loss: 9.542701
KL Loss: 0.763663
Y Loss: 0.225683
T Loss: 9.429860
Epoch 2549 
Overall Loss: 10.316170
Rec Loss: 9.542755
KL Loss: 0.773415
Y Loss: 0.222013
T Loss: 9.431748
Epoch 2599 
Overall Loss: 10.300145
Rec Loss: 9.540500
KL Loss: 0.759645
Y Loss: 0.218786
T Loss: 9.431108
Epoch 2649 
Overall Loss: 10.299052
Rec Loss: 9.521937
KL Loss: 0.777115
Y Loss: 0.223081
T Loss: 9.410397
Epoch 2699 
Overall Loss: 10.302560
Rec Loss: 9.531279
KL Loss: 0.771281
Y Loss: 0.217636
T Loss: 9.422461
Epoch 2749 
Overall Loss: 10.306353
Rec Loss: 9.534916
KL Loss: 0.771437
Y Loss: 0.220877
T Loss: 9.424477
Epoch 2799 
Overall Loss: 10.300247
Rec Loss: 9.523874
KL Loss: 0.776373
Y Loss: 0.219596
T Loss: 9.414076
Epoch 2849 
Overall Loss: 10.298531
Rec Loss: 9.533848
KL Loss: 0.764682
Y Loss: 0.216990
T Loss: 9.425353
Epoch 2899 
Overall Loss: 10.270598
Rec Loss: 9.535076
KL Loss: 0.735522
Y Loss: 0.216869
T Loss: 9.426642
Epoch 2949 
Overall Loss: 10.275892
Rec Loss: 9.517817
KL Loss: 0.758075
Y Loss: 0.216929
T Loss: 9.409353
Epoch 2999 
Overall Loss: 10.261979
Rec Loss: 9.506179
KL Loss: 0.755800
Y Loss: 0.213946
T Loss: 9.399206
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.442167
Epoch 99
Rec Loss: 0.448815
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.740227
Epoch 99
Rec Loss: 9.731233
Epoch 149
Rec Loss: 9.712129
Epoch 199
Rec Loss: 9.706837
Epoch 249
Rec Loss: 9.690424
Epoch 299
Rec Loss: 9.689863
Epoch 349
Rec Loss: 9.688695
Epoch 399
Rec Loss: 9.673894
Epoch 449
Rec Loss: 9.665191
Epoch 499
Rec Loss: 9.665225
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.444031
Insample Error: 1.220474
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.034901
Epoch 99
Rec Loss: 4.050382
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.207926
Epoch 99
Rec Loss: 9.115481
Epoch 149
Rec Loss: 9.104888
Epoch 199
Rec Loss: 9.135012
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.966687
Insample Error 2.795567
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.690486
Epoch 99 
Prediction Loss: 0.419152
Epoch 149 
Prediction Loss: 0.343636
Epoch 199 
Prediction Loss: 0.310132
Epoch 249 
Prediction Loss: 0.294280
Epoch 299 
Prediction Loss: 0.290251
Epoch 349 
Prediction Loss: 0.283060
Epoch 399 
Prediction Loss: 0.280846
Epoch 449 
Prediction Loss: 0.274633
Epoch 499 
Prediction Loss: 0.271391
Epoch 549 
Prediction Loss: 0.275270
Epoch 599 
Prediction Loss: 0.267524
Epoch 649 
Prediction Loss: 0.265789
Epoch 699 
Prediction Loss: 0.259749
Epoch 749 
Prediction Loss: 0.259576
Epoch 799 
Prediction Loss: 0.263425
Epoch 849 
Prediction Loss: 0.257179
Epoch 899 
Prediction Loss: 0.253917
Epoch 949 
Prediction Loss: 0.258040
Epoch 999 
Prediction Loss: 0.252582
Epoch 1049 
Prediction Loss: 0.249227
Epoch 1099 
Prediction Loss: 0.246048
Epoch 1149 
Prediction Loss: 0.248632
Epoch 1199 
Prediction Loss: 0.243033
Epoch 1249 
Prediction Loss: 0.241584
Epoch 1299 
Prediction Loss: 0.243968
Epoch 1349 
Prediction Loss: 0.239817
Epoch 1399 
Prediction Loss: 0.243701
Epoch 1449 
Prediction Loss: 0.241016
Epoch 1499 
Prediction Loss: 0.236235
Epoch 1549 
Prediction Loss: 0.237204
Epoch 1599 
Prediction Loss: 0.236605
Epoch 1649 
Prediction Loss: 0.231313
Epoch 1699 
Prediction Loss: 0.234890
Epoch 1749 
Prediction Loss: 0.239222
Epoch 1799 
Prediction Loss: 0.230036
Epoch 1849 
Prediction Loss: 0.231102
Epoch 1899 
Prediction Loss: 0.227194
Epoch 1949 
Prediction Loss: 0.234697
Epoch 1999 
Prediction Loss: 0.231572
Epoch 2049 
Prediction Loss: 0.226975
Epoch 2099 
Prediction Loss: 0.229864
Epoch 2149 
Prediction Loss: 0.223792
Epoch 2199 
Prediction Loss: 0.222360
Epoch 2249 
Prediction Loss: 0.231378
Epoch 2299 
Prediction Loss: 0.227128
Epoch 2349 
Prediction Loss: 0.227217
Epoch 2399 
Prediction Loss: 0.222464
Epoch 2449 
Prediction Loss: 0.220559
Epoch 2499 
Prediction Loss: 0.221266
Epoch 2549 
Prediction Loss: 0.218035
Epoch 2599 
Prediction Loss: 0.217083
Epoch 2649 
Prediction Loss: 0.223149
Epoch 2699 
Prediction Loss: 0.215607
Epoch 2749 
Prediction Loss: 0.225953
Epoch 2799 
Prediction Loss: 0.217639
Epoch 2849 
Prediction Loss: 0.216944
Epoch 2899 
Prediction Loss: 0.214656
Epoch 2949 
Prediction Loss: 0.212222
Epoch 2999 
Prediction Loss: 0.216903
Epoch 3049 
Prediction Loss: 0.218048
Epoch 3099 
Prediction Loss: 0.223527
Epoch 3149 
Prediction Loss: 0.212483
Epoch 3199 
Prediction Loss: 0.211410
Epoch 3249 
Prediction Loss: 0.208567
Epoch 3299 
Prediction Loss: 0.212548
Epoch 3349 
Prediction Loss: 0.207077
Epoch 3399 
Prediction Loss: 0.210994
Epoch 3449 
Prediction Loss: 0.206478
Epoch 3499 
Prediction Loss: 0.210617
Epoch 3549 
Prediction Loss: 0.205910
Epoch 3599 
Prediction Loss: 0.208076
Epoch 3649 
Prediction Loss: 0.203235
Epoch 3699 
Prediction Loss: 0.205005
Epoch 3749 
Prediction Loss: 0.203390
Epoch 3799 
Prediction Loss: 0.203205
Epoch 3849 
Prediction Loss: 0.205455
Epoch 3899 
Prediction Loss: 0.199584
Epoch 3949 
Prediction Loss: 0.203252
Epoch 3999 
Prediction Loss: 0.202260
Epoch 4049 
Prediction Loss: 0.201645
Epoch 4099 
Prediction Loss: 0.198782
Epoch 4149 
Prediction Loss: 0.196547
Epoch 4199 
Prediction Loss: 0.197584
Epoch 4249 
Prediction Loss: 0.197315
Epoch 4299 
Prediction Loss: 0.197833
Epoch 4349 
Prediction Loss: 0.200707
Epoch 4399 
Prediction Loss: 0.195139
Epoch 4449 
Prediction Loss: 0.196202
Epoch 4499 
Prediction Loss: 0.197524
Epoch 4549 
Prediction Loss: 0.197335
Epoch 4599 
Prediction Loss: 0.194691
Epoch 4649 
Prediction Loss: 0.195334
Epoch 4699 
Prediction Loss: 0.194196
Epoch 4749 
Prediction Loss: 0.194010
Epoch 4799 
Prediction Loss: 0.194315
Epoch 4849 
Prediction Loss: 0.192399
Epoch 4899 
Prediction Loss: 0.190473
Epoch 4949 
Prediction Loss: 0.194030
Epoch 4999 
Prediction Loss: 0.198834
Epoch 5049 
Prediction Loss: 0.194216
Epoch 5099 
Prediction Loss: 0.190609
Epoch 5149 
Prediction Loss: 0.190571
Epoch 5199 
Prediction Loss: 0.187538
Epoch 5249 
Prediction Loss: 0.187552
Epoch 5299 
Prediction Loss: 0.187354
Epoch 5349 
Prediction Loss: 0.188826
Epoch 5399 
Prediction Loss: 0.196363
Epoch 5449 
Prediction Loss: 0.187821
Epoch 5499 
Prediction Loss: 0.186857
Epoch 5549 
Prediction Loss: 0.187006
Epoch 5599 
Prediction Loss: 0.185780
Epoch 5649 
Prediction Loss: 0.187452
Epoch 5699 
Prediction Loss: 0.190521
Epoch 5749 
Prediction Loss: 0.184523
Epoch 5799 
Prediction Loss: 0.183761
Epoch 5849 
Prediction Loss: 0.185452
Epoch 5899 
Prediction Loss: 0.182207
Epoch 5949 
Prediction Loss: 0.181969
Epoch 5999 
Prediction Loss: 0.185132
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.426809
Insample Error 1.210420
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.202704
Rec Loss: 9.967706
KL Loss: 1.234998
Y Loss: 0.999303
T Loss: 9.468054
Epoch 99 
Overall Loss: 10.598283
Rec Loss: 9.856520
KL Loss: 0.741762
Y Loss: 0.506818
T Loss: 9.603111
Epoch 149 
Overall Loss: 10.520224
Rec Loss: 9.786232
KL Loss: 0.733992
Y Loss: 0.400852
T Loss: 9.585806
Epoch 199 
Overall Loss: 10.474931
Rec Loss: 9.743168
KL Loss: 0.731763
Y Loss: 0.358247
T Loss: 9.564045
Epoch 249 
Overall Loss: 10.458883
Rec Loss: 9.735246
KL Loss: 0.723636
Y Loss: 0.333921
T Loss: 9.568286
Epoch 299 
Overall Loss: 10.450248
Rec Loss: 9.715384
KL Loss: 0.734864
Y Loss: 0.312994
T Loss: 9.558887
Epoch 349 
Overall Loss: 10.440758
Rec Loss: 9.701522
KL Loss: 0.739236
Y Loss: 0.304362
T Loss: 9.549341
Epoch 399 
Overall Loss: 10.425426
Rec Loss: 9.687790
KL Loss: 0.737636
Y Loss: 0.292821
T Loss: 9.541380
Epoch 449 
Overall Loss: 10.419618
Rec Loss: 9.675542
KL Loss: 0.744076
Y Loss: 0.294047
T Loss: 9.528518
Epoch 499 
Overall Loss: 10.418516
Rec Loss: 9.688329
KL Loss: 0.730187
Y Loss: 0.283335
T Loss: 9.546661
Epoch 549 
Overall Loss: 10.415689
Rec Loss: 9.674904
KL Loss: 0.740786
Y Loss: 0.282642
T Loss: 9.533583
Epoch 599 
Overall Loss: 10.399020
Rec Loss: 9.678552
KL Loss: 0.720467
Y Loss: 0.276892
T Loss: 9.540107
Epoch 649 
Overall Loss: 10.403899
Rec Loss: 9.669727
KL Loss: 0.734172
Y Loss: 0.271479
T Loss: 9.533988
Epoch 699 
Overall Loss: 10.412554
Rec Loss: 9.669449
KL Loss: 0.743105
Y Loss: 0.271686
T Loss: 9.533605
Epoch 749 
Overall Loss: 10.428530
Rec Loss: 9.659466
KL Loss: 0.769064
Y Loss: 0.263928
T Loss: 9.527502
Epoch 799 
Overall Loss: 10.378318
Rec Loss: 9.648925
KL Loss: 0.729393
Y Loss: 0.260029
T Loss: 9.518911
Epoch 849 
Overall Loss: 10.388547
Rec Loss: 9.653647
KL Loss: 0.734900
Y Loss: 0.269416
T Loss: 9.518939
Epoch 899 
Overall Loss: 10.362594
Rec Loss: 9.640858
KL Loss: 0.721736
Y Loss: 0.260193
T Loss: 9.510762
Epoch 949 
Overall Loss: 10.377527
Rec Loss: 9.652161
KL Loss: 0.725366
Y Loss: 0.253674
T Loss: 9.525324
Epoch 999 
Overall Loss: 10.379341
Rec Loss: 9.635800
KL Loss: 0.743541
Y Loss: 0.261946
T Loss: 9.504826
Epoch 1049 
Overall Loss: 10.368030
Rec Loss: 9.633239
KL Loss: 0.734791
Y Loss: 0.249990
T Loss: 9.508244
Epoch 1099 
Overall Loss: 10.365667
Rec Loss: 9.627196
KL Loss: 0.738470
Y Loss: 0.249256
T Loss: 9.502569
Epoch 1149 
Overall Loss: 10.362275
Rec Loss: 9.620386
KL Loss: 0.741889
Y Loss: 0.253602
T Loss: 9.493585
Epoch 1199 
Overall Loss: 10.370588
Rec Loss: 9.620958
KL Loss: 0.749630
Y Loss: 0.262367
T Loss: 9.489774
Epoch 1249 
Overall Loss: 10.352240
Rec Loss: 9.607357
KL Loss: 0.744884
Y Loss: 0.247781
T Loss: 9.483466
Epoch 1299 
Overall Loss: 10.353537
Rec Loss: 9.625126
KL Loss: 0.728411
Y Loss: 0.246689
T Loss: 9.501781
Epoch 1349 
Overall Loss: 10.350811
Rec Loss: 9.599327
KL Loss: 0.751484
Y Loss: 0.245713
T Loss: 9.476471
Epoch 1399 
Overall Loss: 10.361700
Rec Loss: 9.596573
KL Loss: 0.765128
Y Loss: 0.246866
T Loss: 9.473140
Epoch 1449 
Overall Loss: 10.355284
Rec Loss: 9.594541
KL Loss: 0.760743
Y Loss: 0.252342
T Loss: 9.468369
Epoch 1499 
Overall Loss: 10.349926
Rec Loss: 9.587238
KL Loss: 0.762688
Y Loss: 0.241176
T Loss: 9.466650
Epoch 1549 
Overall Loss: 10.340898
Rec Loss: 9.580709
KL Loss: 0.760189
Y Loss: 0.234587
T Loss: 9.463415
Epoch 1599 
Overall Loss: 10.336390
Rec Loss: 9.609181
KL Loss: 0.727209
Y Loss: 0.242140
T Loss: 9.488111
Epoch 1649 
Overall Loss: 10.320631
Rec Loss: 9.587596
KL Loss: 0.733035
Y Loss: 0.234858
T Loss: 9.470167
Epoch 1699 
Overall Loss: 10.341669
Rec Loss: 9.578661
KL Loss: 0.763008
Y Loss: 0.236991
T Loss: 9.460166
Epoch 1749 
Overall Loss: 10.330748
Rec Loss: 9.568495
KL Loss: 0.762253
Y Loss: 0.233537
T Loss: 9.451726
Epoch 1799 
Overall Loss: 10.325197
Rec Loss: 9.572367
KL Loss: 0.752831
Y Loss: 0.229891
T Loss: 9.457421
Epoch 1849 
Overall Loss: 10.324108
Rec Loss: 9.568485
KL Loss: 0.755623
Y Loss: 0.233702
T Loss: 9.451634
Epoch 1899 
Overall Loss: 10.324540
Rec Loss: 9.569556
KL Loss: 0.754984
Y Loss: 0.232710
T Loss: 9.453200
Epoch 1949 
Overall Loss: 10.336635
Rec Loss: 9.560586
KL Loss: 0.776049
Y Loss: 0.229763
T Loss: 9.445704
Epoch 1999 
Overall Loss: 10.315316
Rec Loss: 9.566230
KL Loss: 0.749085
Y Loss: 0.228774
T Loss: 9.451843
Epoch 2049 
Overall Loss: 10.312098
Rec Loss: 9.562308
KL Loss: 0.749789
Y Loss: 0.226808
T Loss: 9.448904
Epoch 2099 
Overall Loss: 10.331410
Rec Loss: 9.537966
KL Loss: 0.793444
Y Loss: 0.225914
T Loss: 9.425009
Epoch 2149 
Overall Loss: 10.322887
Rec Loss: 9.562217
KL Loss: 0.760670
Y Loss: 0.222035
T Loss: 9.451200
Epoch 2199 
Overall Loss: 10.316235
Rec Loss: 9.556830
KL Loss: 0.759405
Y Loss: 0.222114
T Loss: 9.445773
Epoch 2249 
Overall Loss: 10.333477
Rec Loss: 9.571364
KL Loss: 0.762114
Y Loss: 0.231450
T Loss: 9.455639
Epoch 2299 
Overall Loss: 10.302998
Rec Loss: 9.544751
KL Loss: 0.758247
Y Loss: 0.222864
T Loss: 9.433319
Epoch 2349 
Overall Loss: 10.311168
Rec Loss: 9.539952
KL Loss: 0.771216
Y Loss: 0.218049
T Loss: 9.430928
Epoch 2399 
Overall Loss: 10.309705
Rec Loss: 9.550281
KL Loss: 0.759423
Y Loss: 0.220820
T Loss: 9.439872
Epoch 2449 
Overall Loss: 10.306849
Rec Loss: 9.540945
KL Loss: 0.765904
Y Loss: 0.215640
T Loss: 9.433125
Epoch 2499 
Overall Loss: 10.297359
Rec Loss: 9.541578
KL Loss: 0.755782
Y Loss: 0.216770
T Loss: 9.433192
Epoch 2549 
Overall Loss: 10.299417
Rec Loss: 9.557131
KL Loss: 0.742287
Y Loss: 0.215041
T Loss: 9.449610
Epoch 2599 
Overall Loss: 10.302564
Rec Loss: 9.547992
KL Loss: 0.754572
Y Loss: 0.214670
T Loss: 9.440657
Epoch 2649 
Overall Loss: 10.300588
Rec Loss: 9.537159
KL Loss: 0.763429
Y Loss: 0.214679
T Loss: 9.429819
Epoch 2699 
Overall Loss: 10.302864
Rec Loss: 9.545197
KL Loss: 0.757666
Y Loss: 0.212892
T Loss: 9.438751
Epoch 2749 
Overall Loss: 10.310809
Rec Loss: 9.539256
KL Loss: 0.771554
Y Loss: 0.214400
T Loss: 9.432056
Epoch 2799 
Overall Loss: 10.290539
Rec Loss: 9.514933
KL Loss: 0.775606
Y Loss: 0.208375
T Loss: 9.410746
Epoch 2849 
Overall Loss: 10.306039
Rec Loss: 9.540405
KL Loss: 0.765634
Y Loss: 0.212662
T Loss: 9.434074
Epoch 2899 
Overall Loss: 10.283308
Rec Loss: 9.513469
KL Loss: 0.769839
Y Loss: 0.207335
T Loss: 9.409802
Epoch 2949 
Overall Loss: 10.306297
Rec Loss: 9.521486
KL Loss: 0.784811
Y Loss: 0.208338
T Loss: 9.417317
Epoch 2999 
Overall Loss: 10.293035
Rec Loss: 9.534960
KL Loss: 0.758075
Y Loss: 0.208282
T Loss: 9.430820
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.440661
Epoch 99
Rec Loss: 0.424294
Epoch 149
Rec Loss: 0.421578
Epoch 199
Rec Loss: 0.413314
Epoch 249
Rec Loss: 0.428313
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.737662
Epoch 99
Rec Loss: 9.734935
Epoch 149
Rec Loss: 9.724843
Epoch 199
Rec Loss: 9.706407
Epoch 249
Rec Loss: 9.700281
Epoch 299
Rec Loss: 9.703656
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.438130
Insample Error: 1.212658
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.032108
Epoch 99
Rec Loss: 4.032762
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 8.622094
Epoch 99
Rec Loss: 8.613780
Epoch 149
Rec Loss: 8.622667
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.962819
Insample Error 2.796001
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.710128
Epoch 99 
Prediction Loss: 0.414888
Epoch 149 
Prediction Loss: 0.329283
Epoch 199 
Prediction Loss: 0.300830
Epoch 249 
Prediction Loss: 0.293323
Epoch 299 
Prediction Loss: 0.278050
Epoch 349 
Prediction Loss: 0.274256
Epoch 399 
Prediction Loss: 0.271532
Epoch 449 
Prediction Loss: 0.270776
Epoch 499 
Prediction Loss: 0.267536
Epoch 549 
Prediction Loss: 0.262341
Epoch 599 
Prediction Loss: 0.260622
Epoch 649 
Prediction Loss: 0.261829
Epoch 699 
Prediction Loss: 0.257934
Epoch 749 
Prediction Loss: 0.255597
Epoch 799 
Prediction Loss: 0.255785
Epoch 849 
Prediction Loss: 0.256776
Epoch 899 
Prediction Loss: 0.260452
Epoch 949 
Prediction Loss: 0.248131
Epoch 999 
Prediction Loss: 0.254996
Epoch 1049 
Prediction Loss: 0.243243
Epoch 1099 
Prediction Loss: 0.255180
Epoch 1149 
Prediction Loss: 0.245228
Epoch 1199 
Prediction Loss: 0.246524
Epoch 1249 
Prediction Loss: 0.243789
Epoch 1299 
Prediction Loss: 0.239734
Epoch 1349 
Prediction Loss: 0.238336
Epoch 1399 
Prediction Loss: 0.241140
Epoch 1449 
Prediction Loss: 0.237719
Epoch 1499 
Prediction Loss: 0.236860
Epoch 1549 
Prediction Loss: 0.239251
Epoch 1599 
Prediction Loss: 0.247254
Epoch 1649 
Prediction Loss: 0.233305
Epoch 1699 
Prediction Loss: 0.237077
Epoch 1749 
Prediction Loss: 0.232990
Epoch 1799 
Prediction Loss: 0.238086
Epoch 1849 
Prediction Loss: 0.233287
Epoch 1899 
Prediction Loss: 0.228482
Epoch 1949 
Prediction Loss: 0.230957
Epoch 1999 
Prediction Loss: 0.226892
Epoch 2049 
Prediction Loss: 0.230963
Epoch 2099 
Prediction Loss: 0.230146
Epoch 2149 
Prediction Loss: 0.230610
Epoch 2199 
Prediction Loss: 0.224927
Epoch 2249 
Prediction Loss: 0.225023
Epoch 2299 
Prediction Loss: 0.222047
Epoch 2349 
Prediction Loss: 0.225016
Epoch 2399 
Prediction Loss: 0.234768
Epoch 2449 
Prediction Loss: 0.221128
Epoch 2499 
Prediction Loss: 0.222419
Epoch 2549 
Prediction Loss: 0.220467
Epoch 2599 
Prediction Loss: 0.221698
Epoch 2649 
Prediction Loss: 0.220405
Epoch 2699 
Prediction Loss: 0.216289
Epoch 2749 
Prediction Loss: 0.222804
Epoch 2799 
Prediction Loss: 0.218604
Epoch 2849 
Prediction Loss: 0.216350
Epoch 2899 
Prediction Loss: 0.221785
Epoch 2949 
Prediction Loss: 0.214895
Epoch 2999 
Prediction Loss: 0.215404
Epoch 3049 
Prediction Loss: 0.214715
Epoch 3099 
Prediction Loss: 0.220506
Epoch 3149 
Prediction Loss: 0.211168
Epoch 3199 
Prediction Loss: 0.212699
Epoch 3249 
Prediction Loss: 0.212728
Epoch 3299 
Prediction Loss: 0.211964
Epoch 3349 
Prediction Loss: 0.209874
Epoch 3399 
Prediction Loss: 0.209478
Epoch 3449 
Prediction Loss: 0.210787
Epoch 3499 
Prediction Loss: 0.213809
Epoch 3549 
Prediction Loss: 0.211166
Epoch 3599 
Prediction Loss: 0.209978
Epoch 3649 
Prediction Loss: 0.217860
Epoch 3699 
Prediction Loss: 0.208134
Epoch 3749 
Prediction Loss: 0.214370
Epoch 3799 
Prediction Loss: 0.211961
Epoch 3849 
Prediction Loss: 0.204629
Epoch 3899 
Prediction Loss: 0.207902
Epoch 3949 
Prediction Loss: 0.202461
Epoch 3999 
Prediction Loss: 0.204454
Epoch 4049 
Prediction Loss: 0.205032
Epoch 4099 
Prediction Loss: 0.209807
Epoch 4149 
Prediction Loss: 0.205475
Epoch 4199 
Prediction Loss: 0.201872
Epoch 4249 
Prediction Loss: 0.203534
Epoch 4299 
Prediction Loss: 0.201826
Epoch 4349 
Prediction Loss: 0.200905
Epoch 4399 
Prediction Loss: 0.198816
Epoch 4449 
Prediction Loss: 0.201461
Epoch 4499 
Prediction Loss: 0.200585
Epoch 4549 
Prediction Loss: 0.198283
Epoch 4599 
Prediction Loss: 0.200543
Epoch 4649 
Prediction Loss: 0.198063
Epoch 4699 
Prediction Loss: 0.203683
Epoch 4749 
Prediction Loss: 0.197428
Epoch 4799 
Prediction Loss: 0.200136
Epoch 4849 
Prediction Loss: 0.199382
Epoch 4899 
Prediction Loss: 0.195179
Epoch 4949 
Prediction Loss: 0.199652
Epoch 4999 
Prediction Loss: 0.200360
Epoch 5049 
Prediction Loss: 0.194220
Epoch 5099 
Prediction Loss: 0.195930
Epoch 5149 
Prediction Loss: 0.191461
Epoch 5199 
Prediction Loss: 0.194346
Epoch 5249 
Prediction Loss: 0.195285
Epoch 5299 
Prediction Loss: 0.191811
Epoch 5349 
Prediction Loss: 0.198202
Epoch 5399 
Prediction Loss: 0.190845
Epoch 5449 
Prediction Loss: 0.189509
Epoch 5499 
Prediction Loss: 0.190851
Epoch 5549 
Prediction Loss: 0.191548
Epoch 5599 
Prediction Loss: 0.193799
Epoch 5649 
Prediction Loss: 0.190053
Epoch 5699 
Prediction Loss: 0.187169
Epoch 5749 
Prediction Loss: 0.190681
Epoch 5799 
Prediction Loss: 0.188985
Epoch 5849 
Prediction Loss: 0.187084
Epoch 5899 
Prediction Loss: 0.188195
Epoch 5949 
Prediction Loss: 0.197532
Epoch 5999 
Prediction Loss: 0.186208
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.436505
Insample Error 1.192943
[31m========== repeat time 4 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.261015
Rec Loss: 9.939800
KL Loss: 1.321215
Y Loss: 1.007723
T Loss: 9.435939
Epoch 99 
Overall Loss: 10.668949
Rec Loss: 9.880463
KL Loss: 0.788487
Y Loss: 0.580808
T Loss: 9.590059
Epoch 149 
Overall Loss: 10.529633
Rec Loss: 9.797504
KL Loss: 0.732130
Y Loss: 0.431473
T Loss: 9.581767
Epoch 199 
Overall Loss: 10.487449
Rec Loss: 9.754608
KL Loss: 0.732841
Y Loss: 0.380772
T Loss: 9.564222
Epoch 249 
Overall Loss: 10.473827
Rec Loss: 9.717600
KL Loss: 0.756228
Y Loss: 0.342298
T Loss: 9.546451
Epoch 299 
Overall Loss: 10.456233
Rec Loss: 9.710660
KL Loss: 0.745572
Y Loss: 0.326639
T Loss: 9.547341
Epoch 349 
Overall Loss: 10.436352
Rec Loss: 9.705087
KL Loss: 0.731265
Y Loss: 0.315903
T Loss: 9.547136
Epoch 399 
Overall Loss: 10.428724
Rec Loss: 9.693011
KL Loss: 0.735713
Y Loss: 0.303692
T Loss: 9.541165
Epoch 449 
Overall Loss: 10.408773
Rec Loss: 9.694954
KL Loss: 0.713819
Y Loss: 0.296028
T Loss: 9.546940
Epoch 499 
Overall Loss: 10.427653
Rec Loss: 9.708814
KL Loss: 0.718839
Y Loss: 0.298016
T Loss: 9.559806
Epoch 549 
Overall Loss: 10.414530
Rec Loss: 9.681840
KL Loss: 0.732691
Y Loss: 0.280303
T Loss: 9.541688
Epoch 599 
Overall Loss: 10.405760
Rec Loss: 9.682928
KL Loss: 0.722832
Y Loss: 0.285681
T Loss: 9.540088
Epoch 649 
Overall Loss: 10.400099
Rec Loss: 9.677910
KL Loss: 0.722189
Y Loss: 0.273196
T Loss: 9.541312
Epoch 699 
Overall Loss: 10.402177
Rec Loss: 9.662908
KL Loss: 0.739270
Y Loss: 0.273075
T Loss: 9.526370
Epoch 749 
Overall Loss: 10.395605
Rec Loss: 9.648102
KL Loss: 0.747503
Y Loss: 0.276742
T Loss: 9.509731
Epoch 799 
Overall Loss: 10.398557
Rec Loss: 9.656273
KL Loss: 0.742284
Y Loss: 0.266494
T Loss: 9.523026
Epoch 849 
Overall Loss: 10.395875
Rec Loss: 9.647338
KL Loss: 0.748537
Y Loss: 0.259958
T Loss: 9.517359
Epoch 899 
Overall Loss: 10.387426
Rec Loss: 9.649111
KL Loss: 0.738315
Y Loss: 0.270234
T Loss: 9.513995
Epoch 949 
Overall Loss: 10.364597
Rec Loss: 9.633361
KL Loss: 0.731236
Y Loss: 0.256978
T Loss: 9.504873
Epoch 999 
Overall Loss: 10.359172
Rec Loss: 9.642207
KL Loss: 0.716965
Y Loss: 0.257429
T Loss: 9.513492
Epoch 1049 
Overall Loss: 10.385257
Rec Loss: 9.642189
KL Loss: 0.743068
Y Loss: 0.269361
T Loss: 9.507508
Epoch 1099 
Overall Loss: 10.363784
Rec Loss: 9.634394
KL Loss: 0.729390
Y Loss: 0.256915
T Loss: 9.505936
Epoch 1149 
Overall Loss: 10.367342
Rec Loss: 9.627442
KL Loss: 0.739901
Y Loss: 0.251453
T Loss: 9.501716
Epoch 1199 
Overall Loss: 10.368859
Rec Loss: 9.633020
KL Loss: 0.735839
Y Loss: 0.252379
T Loss: 9.506831
Epoch 1249 
Overall Loss: 10.366027
Rec Loss: 9.627962
KL Loss: 0.738065
Y Loss: 0.248160
T Loss: 9.503882
Epoch 1299 
Overall Loss: 10.359881
Rec Loss: 9.630475
KL Loss: 0.729406
Y Loss: 0.249326
T Loss: 9.505811
Epoch 1349 
Overall Loss: 10.363853
Rec Loss: 9.630827
KL Loss: 0.733026
Y Loss: 0.249129
T Loss: 9.506262
Epoch 1399 
Overall Loss: 10.391894
Rec Loss: 9.627768
KL Loss: 0.764126
Y Loss: 0.243656
T Loss: 9.505940
Epoch 1449 
Overall Loss: 10.365571
Rec Loss: 9.642919
KL Loss: 0.722652
Y Loss: 0.245400
T Loss: 9.520219
Epoch 1499 
Overall Loss: 10.366737
Rec Loss: 9.633754
KL Loss: 0.732983
Y Loss: 0.244480
T Loss: 9.511514
Epoch 1549 
Overall Loss: 10.318791
Rec Loss: 9.595483
KL Loss: 0.723307
Y Loss: 0.238452
T Loss: 9.476258
Epoch 1599 
Overall Loss: 10.340913
Rec Loss: 9.600262
KL Loss: 0.740651
Y Loss: 0.241245
T Loss: 9.479639
Epoch 1649 
Overall Loss: 10.342059
Rec Loss: 9.603769
KL Loss: 0.738290
Y Loss: 0.240471
T Loss: 9.483533
Epoch 1699 
Overall Loss: 10.350076
Rec Loss: 9.599178
KL Loss: 0.750898
Y Loss: 0.246969
T Loss: 9.475693
Epoch 1749 
Overall Loss: 10.340439
Rec Loss: 9.604480
KL Loss: 0.735959
Y Loss: 0.236921
T Loss: 9.486019
Epoch 1799 
Overall Loss: 10.334787
Rec Loss: 9.596199
KL Loss: 0.738589
Y Loss: 0.241180
T Loss: 9.475609
Epoch 1849 
Overall Loss: 10.317202
Rec Loss: 9.586965
KL Loss: 0.730237
Y Loss: 0.240537
T Loss: 9.466697
Epoch 1899 
Overall Loss: 10.347389
Rec Loss: 9.592606
KL Loss: 0.754784
Y Loss: 0.229303
T Loss: 9.477954
Epoch 1949 
Overall Loss: 10.333932
Rec Loss: 9.582025
KL Loss: 0.751907
Y Loss: 0.234233
T Loss: 9.464909
Epoch 1999 
Overall Loss: 10.321804
Rec Loss: 9.569122
KL Loss: 0.752683
Y Loss: 0.227617
T Loss: 9.455314
Epoch 2049 
Overall Loss: 10.329825
Rec Loss: 9.579130
KL Loss: 0.750694
Y Loss: 0.230648
T Loss: 9.463806
Epoch 2099 
Overall Loss: 10.325424
Rec Loss: 9.581029
KL Loss: 0.744395
Y Loss: 0.226495
T Loss: 9.467782
Epoch 2149 
Overall Loss: 10.329721
Rec Loss: 9.561283
KL Loss: 0.768438
Y Loss: 0.226165
T Loss: 9.448201
Epoch 2199 
Overall Loss: 10.307895
Rec Loss: 9.561003
KL Loss: 0.746892
Y Loss: 0.228407
T Loss: 9.446799
Epoch 2249 
Overall Loss: 10.325074
Rec Loss: 9.558967
KL Loss: 0.766107
Y Loss: 0.230346
T Loss: 9.443794
Epoch 2299 
Overall Loss: 10.298347
Rec Loss: 9.554093
KL Loss: 0.744253
Y Loss: 0.226290
T Loss: 9.440949
Epoch 2349 
Overall Loss: 10.308338
Rec Loss: 9.539427
KL Loss: 0.768911
Y Loss: 0.224110
T Loss: 9.427372
Epoch 2399 
Overall Loss: 10.322097
Rec Loss: 9.552565
KL Loss: 0.769531
Y Loss: 0.225163
T Loss: 9.439984
Epoch 2449 
Overall Loss: 10.312888
Rec Loss: 9.547359
KL Loss: 0.765530
Y Loss: 0.223524
T Loss: 9.435596
Epoch 2499 
Overall Loss: 10.291141
Rec Loss: 9.543984
KL Loss: 0.747156
Y Loss: 0.218106
T Loss: 9.434931
Epoch 2549 
Overall Loss: 10.308552
Rec Loss: 9.518703
KL Loss: 0.789850
Y Loss: 0.219541
T Loss: 9.408932
Epoch 2599 
Overall Loss: 10.301785
Rec Loss: 9.542497
KL Loss: 0.759288
Y Loss: 0.217349
T Loss: 9.433822
Epoch 2649 
Overall Loss: 10.291554
Rec Loss: 9.532176
KL Loss: 0.759378
Y Loss: 0.217817
T Loss: 9.423268
Epoch 2699 
Overall Loss: 10.316431
Rec Loss: 9.543855
KL Loss: 0.772576
Y Loss: 0.219548
T Loss: 9.434081
Epoch 2749 
Overall Loss: 10.301288
Rec Loss: 9.532325
KL Loss: 0.768963
Y Loss: 0.218507
T Loss: 9.423072
Epoch 2799 
Overall Loss: 10.287708
Rec Loss: 9.519882
KL Loss: 0.767826
Y Loss: 0.216838
T Loss: 9.411464
Epoch 2849 
Overall Loss: 10.299287
Rec Loss: 9.525507
KL Loss: 0.773780
Y Loss: 0.217170
T Loss: 9.416922
Epoch 2899 
Overall Loss: 10.298957
Rec Loss: 9.525836
KL Loss: 0.773121
Y Loss: 0.212469
T Loss: 9.419601
Epoch 2949 
Overall Loss: 10.287266
Rec Loss: 9.511279
KL Loss: 0.775987
Y Loss: 0.212278
T Loss: 9.405140
Epoch 2999 
Overall Loss: 10.277745
Rec Loss: 9.518762
KL Loss: 0.758983
Y Loss: 0.211754
T Loss: 9.412884
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.431254
Epoch 99
Rec Loss: 0.420935
Epoch 149
Rec Loss: 0.429182
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.731624
Epoch 99
Rec Loss: 9.729167
Epoch 149
Rec Loss: 9.725104
Epoch 199
Rec Loss: 9.703782
Epoch 249
Rec Loss: 9.686161
Epoch 299
Rec Loss: 9.681966
Epoch 349
Rec Loss: 9.676016
Epoch 399
Rec Loss: 9.689783
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.453852
Insample Error: 1.175560
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.057151
Epoch 99
Rec Loss: 4.058703
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.520941
Epoch 99
Rec Loss: 9.556186
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 2.989247
Insample Error 2.803228
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.713531
Epoch 99 
Prediction Loss: 0.415231
Epoch 149 
Prediction Loss: 0.344512
Epoch 199 
Prediction Loss: 0.310679
Epoch 249 
Prediction Loss: 0.294425
Epoch 299 
Prediction Loss: 0.289175
Epoch 349 
Prediction Loss: 0.287487
Epoch 399 
Prediction Loss: 0.291033
Epoch 449 
Prediction Loss: 0.301410
Epoch 499 
Prediction Loss: 0.279626
Epoch 549 
Prediction Loss: 0.273247
Epoch 599 
Prediction Loss: 0.270575
Epoch 649 
Prediction Loss: 0.268122
Epoch 699 
Prediction Loss: 0.275130
Epoch 749 
Prediction Loss: 0.267787
Epoch 799 
Prediction Loss: 0.267173
Epoch 849 
Prediction Loss: 0.264451
Epoch 899 
Prediction Loss: 0.263595
Epoch 949 
Prediction Loss: 0.263323
Epoch 999 
Prediction Loss: 0.268961
Epoch 1049 
Prediction Loss: 0.256888
Epoch 1099 
Prediction Loss: 0.257876
Epoch 1149 
Prediction Loss: 0.254741
Epoch 1199 
Prediction Loss: 0.253863
Epoch 1249 
Prediction Loss: 0.253832
Epoch 1299 
Prediction Loss: 0.250811
Epoch 1349 
Prediction Loss: 0.256591
Epoch 1399 
Prediction Loss: 0.258861
Epoch 1449 
Prediction Loss: 0.256822
Epoch 1499 
Prediction Loss: 0.246278
Epoch 1549 
Prediction Loss: 0.250420
Epoch 1599 
Prediction Loss: 0.248234
Epoch 1649 
Prediction Loss: 0.249852
Epoch 1699 
Prediction Loss: 0.250090
Epoch 1749 
Prediction Loss: 0.247134
Epoch 1799 
Prediction Loss: 0.242010
Epoch 1849 
Prediction Loss: 0.240327
Epoch 1899 
Prediction Loss: 0.236586
Epoch 1949 
Prediction Loss: 0.244801
Epoch 1999 
Prediction Loss: 0.236367
Epoch 2049 
Prediction Loss: 0.238870
Epoch 2099 
Prediction Loss: 0.238409
Epoch 2149 
Prediction Loss: 0.241184
Epoch 2199 
Prediction Loss: 0.244232
Epoch 2249 
Prediction Loss: 0.237078
Epoch 2299 
Prediction Loss: 0.232734
Epoch 2349 
Prediction Loss: 0.236167
Epoch 2399 
Prediction Loss: 0.233096
Epoch 2449 
Prediction Loss: 0.234589
Epoch 2499 
Prediction Loss: 0.236278
Epoch 2549 
Prediction Loss: 0.233965
Epoch 2599 
Prediction Loss: 0.232549
Epoch 2649 
Prediction Loss: 0.226750
Epoch 2699 
Prediction Loss: 0.228672
Epoch 2749 
Prediction Loss: 0.230020
Epoch 2799 
Prediction Loss: 0.227019
Epoch 2849 
Prediction Loss: 0.229819
Epoch 2899 
Prediction Loss: 0.225398
Epoch 2949 
Prediction Loss: 0.233528
Epoch 2999 
Prediction Loss: 0.228765
Epoch 3049 
Prediction Loss: 0.222379
Epoch 3099 
Prediction Loss: 0.229538
Epoch 3149 
Prediction Loss: 0.226947
Epoch 3199 
Prediction Loss: 0.229987
Epoch 3249 
Prediction Loss: 0.223614
Epoch 3299 
Prediction Loss: 0.224413
Epoch 3349 
Prediction Loss: 0.226114
Epoch 3399 
Prediction Loss: 0.220063
Epoch 3449 
Prediction Loss: 0.224616
Epoch 3499 
Prediction Loss: 0.229819
Epoch 3549 
Prediction Loss: 0.223452
Epoch 3599 
Prediction Loss: 0.218749
Epoch 3649 
Prediction Loss: 0.223994
Epoch 3699 
Prediction Loss: 0.218714
Epoch 3749 
Prediction Loss: 0.227581
Epoch 3799 
Prediction Loss: 0.217859
Epoch 3849 
Prediction Loss: 0.219441
Epoch 3899 
Prediction Loss: 0.214654
Epoch 3949 
Prediction Loss: 0.214541
Epoch 3999 
Prediction Loss: 0.221758
Epoch 4049 
Prediction Loss: 0.215592
Epoch 4099 
Prediction Loss: 0.214116
Epoch 4149 
Prediction Loss: 0.217264
Epoch 4199 
Prediction Loss: 0.215030
Epoch 4249 
Prediction Loss: 0.220415
Epoch 4299 
Prediction Loss: 0.212010
Epoch 4349 
Prediction Loss: 0.215276
Epoch 4399 
Prediction Loss: 0.209334
Epoch 4449 
Prediction Loss: 0.212494
Epoch 4499 
Prediction Loss: 0.213124
Epoch 4549 
Prediction Loss: 0.207633
Epoch 4599 
Prediction Loss: 0.210716
Epoch 4649 
Prediction Loss: 0.211559
Epoch 4699 
Prediction Loss: 0.210764
Epoch 4749 
Prediction Loss: 0.205962
Epoch 4799 
Prediction Loss: 0.209604
Epoch 4849 
Prediction Loss: 0.204896
Epoch 4899 
Prediction Loss: 0.204162
Epoch 4949 
Prediction Loss: 0.222312
Epoch 4999 
Prediction Loss: 0.214529
Epoch 5049 
Prediction Loss: 0.210737
Epoch 5099 
Prediction Loss: 0.209453
Epoch 5149 
Prediction Loss: 0.203016
Epoch 5199 
Prediction Loss: 0.202857
Epoch 5249 
Prediction Loss: 0.204026
Epoch 5299 
Prediction Loss: 0.199895
Epoch 5349 
Prediction Loss: 0.205106
Epoch 5399 
Prediction Loss: 0.203805
Epoch 5449 
Prediction Loss: 0.198687
Epoch 5499 
Prediction Loss: 0.200299
Epoch 5549 
Prediction Loss: 0.198802
Epoch 5599 
Prediction Loss: 0.202103
Epoch 5649 
Prediction Loss: 0.200201
Epoch 5699 
Prediction Loss: 0.195376
Epoch 5749 
Prediction Loss: 0.205185
Epoch 5799 
Prediction Loss: 0.195845
Epoch 5849 
Prediction Loss: 0.195454
Epoch 5899 
Prediction Loss: 0.195185
Epoch 5949 
Prediction Loss: 0.199535
Epoch 5999 
Prediction Loss: 0.198509
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.437690
Insample Error 1.206711
[31m========== repeat time 5 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.155551
Rec Loss: 9.945121
KL Loss: 1.210430
Y Loss: 0.924359
T Loss: 9.482942
Epoch 99 
Overall Loss: 10.592001
Rec Loss: 9.874203
KL Loss: 0.717798
Y Loss: 0.501711
T Loss: 9.623348
Epoch 149 
Overall Loss: 10.528586
Rec Loss: 9.805306
KL Loss: 0.723280
Y Loss: 0.402696
T Loss: 9.603958
Epoch 199 
Overall Loss: 10.477169
Rec Loss: 9.740510
KL Loss: 0.736659
Y Loss: 0.356834
T Loss: 9.562093
Epoch 249 
Overall Loss: 10.447672
Rec Loss: 9.721867
KL Loss: 0.725805
Y Loss: 0.330564
T Loss: 9.556585
Epoch 299 
Overall Loss: 10.438390
Rec Loss: 9.696401
KL Loss: 0.741989
Y Loss: 0.318429
T Loss: 9.537186
Epoch 349 
Overall Loss: 10.440462
Rec Loss: 9.715417
KL Loss: 0.725045
Y Loss: 0.310683
T Loss: 9.560076
Epoch 399 
Overall Loss: 10.446057
Rec Loss: 9.706391
KL Loss: 0.739667
Y Loss: 0.312856
T Loss: 9.549963
Epoch 449 
Overall Loss: 10.415392
Rec Loss: 9.683872
KL Loss: 0.731520
Y Loss: 0.293923
T Loss: 9.536911
Epoch 499 
Overall Loss: 10.418899
Rec Loss: 9.685305
KL Loss: 0.733594
Y Loss: 0.290325
T Loss: 9.540143
Epoch 549 
Overall Loss: 10.399981
Rec Loss: 9.688507
KL Loss: 0.711474
Y Loss: 0.276929
T Loss: 9.550043
Epoch 599 
Overall Loss: 10.427079
Rec Loss: 9.692013
KL Loss: 0.735066
Y Loss: 0.278288
T Loss: 9.552868
Epoch 649 
Overall Loss: 10.410341
Rec Loss: 9.688201
KL Loss: 0.722140
Y Loss: 0.280333
T Loss: 9.548035
Epoch 699 
Overall Loss: 10.402709
Rec Loss: 9.675122
KL Loss: 0.727587
Y Loss: 0.265854
T Loss: 9.542195
Epoch 749 
Overall Loss: 10.386865
Rec Loss: 9.653719
KL Loss: 0.733146
Y Loss: 0.263310
T Loss: 9.522064
Epoch 799 
Overall Loss: 10.385772
Rec Loss: 9.667865
KL Loss: 0.717908
Y Loss: 0.263239
T Loss: 9.536245
Epoch 849 
Overall Loss: 10.402650
Rec Loss: 9.661488
KL Loss: 0.741162
Y Loss: 0.264880
T Loss: 9.529048
Epoch 899 
Overall Loss: 10.373195
Rec Loss: 9.656501
KL Loss: 0.716694
Y Loss: 0.255664
T Loss: 9.528669
Epoch 949 
Overall Loss: 10.371367
Rec Loss: 9.657294
KL Loss: 0.714073
Y Loss: 0.255242
T Loss: 9.529673
Epoch 999 
Overall Loss: 10.362621
Rec Loss: 9.642756
KL Loss: 0.719865
Y Loss: 0.255504
T Loss: 9.515005
Epoch 1049 
Overall Loss: 10.378146
Rec Loss: 9.632287
KL Loss: 0.745859
Y Loss: 0.258144
T Loss: 9.503215
Epoch 1099 
Overall Loss: 10.366862
Rec Loss: 9.655637
KL Loss: 0.711225
Y Loss: 0.250465
T Loss: 9.530405
Epoch 1149 
Overall Loss: 10.376390
Rec Loss: 9.650575
KL Loss: 0.725815
Y Loss: 0.257903
T Loss: 9.521624
Epoch 1199 
Overall Loss: 10.381086
Rec Loss: 9.622729
KL Loss: 0.758356
Y Loss: 0.251191
T Loss: 9.497134
Epoch 1249 
Overall Loss: 10.362387
Rec Loss: 9.631846
KL Loss: 0.730541
Y Loss: 0.247374
T Loss: 9.508160
Epoch 1299 
Overall Loss: 10.369256
Rec Loss: 9.630224
KL Loss: 0.739032
Y Loss: 0.243999
T Loss: 9.508224
Epoch 1349 
Overall Loss: 10.341879
Rec Loss: 9.621750
KL Loss: 0.720128
Y Loss: 0.241493
T Loss: 9.501004
Epoch 1399 
Overall Loss: 10.361162
Rec Loss: 9.625740
KL Loss: 0.735422
Y Loss: 0.242952
T Loss: 9.504264
Epoch 1449 
Overall Loss: 10.349996
Rec Loss: 9.616064
KL Loss: 0.733932
Y Loss: 0.239123
T Loss: 9.496502
Epoch 1499 
Overall Loss: 10.371081
Rec Loss: 9.622446
KL Loss: 0.748636
Y Loss: 0.241485
T Loss: 9.501703
Epoch 1549 
Overall Loss: 10.346612
Rec Loss: 9.620267
KL Loss: 0.726345
Y Loss: 0.243659
T Loss: 9.498438
Epoch 1599 
Overall Loss: 10.342021
Rec Loss: 9.622450
KL Loss: 0.719572
Y Loss: 0.240504
T Loss: 9.502198
Epoch 1649 
Overall Loss: 10.340718
Rec Loss: 9.592621
KL Loss: 0.748098
Y Loss: 0.238819
T Loss: 9.473211
Epoch 1699 
Overall Loss: 10.339229
Rec Loss: 9.593836
KL Loss: 0.745392
Y Loss: 0.236635
T Loss: 9.475519
Epoch 1749 
Overall Loss: 10.334835
Rec Loss: 9.588071
KL Loss: 0.746764
Y Loss: 0.234694
T Loss: 9.470724
Epoch 1799 
Overall Loss: 10.326839
Rec Loss: 9.586066
KL Loss: 0.740772
Y Loss: 0.235996
T Loss: 9.468069
Epoch 1849 
Overall Loss: 10.326071
Rec Loss: 9.579315
KL Loss: 0.746756
Y Loss: 0.235787
T Loss: 9.461422
Epoch 1899 
Overall Loss: 10.332719
Rec Loss: 9.572696
KL Loss: 0.760023
Y Loss: 0.235723
T Loss: 9.454834
Epoch 1949 
Overall Loss: 10.321767
Rec Loss: 9.564330
KL Loss: 0.757437
Y Loss: 0.233034
T Loss: 9.447813
Epoch 1999 
Overall Loss: 10.314086
Rec Loss: 9.564807
KL Loss: 0.749278
Y Loss: 0.230894
T Loss: 9.449360
Epoch 2049 
Overall Loss: 10.328209
Rec Loss: 9.576581
KL Loss: 0.751629
Y Loss: 0.235504
T Loss: 9.458829
Epoch 2099 
Overall Loss: 10.315200
Rec Loss: 9.562794
KL Loss: 0.752406
Y Loss: 0.227161
T Loss: 9.449213
Epoch 2149 
Overall Loss: 10.322824
Rec Loss: 9.553577
KL Loss: 0.769248
Y Loss: 0.231409
T Loss: 9.437872
Epoch 2199 
Overall Loss: 10.300153
Rec Loss: 9.549910
KL Loss: 0.750243
Y Loss: 0.227337
T Loss: 9.436241
Epoch 2249 
Overall Loss: 10.319774
Rec Loss: 9.541220
KL Loss: 0.778555
Y Loss: 0.229753
T Loss: 9.426343
Epoch 2299 
Overall Loss: 10.308642
Rec Loss: 9.551560
KL Loss: 0.757082
Y Loss: 0.227643
T Loss: 9.437738
Epoch 2349 
Overall Loss: 10.290256
Rec Loss: 9.540316
KL Loss: 0.749940
Y Loss: 0.224574
T Loss: 9.428030
Epoch 2399 
Overall Loss: 10.309621
Rec Loss: 9.540435
KL Loss: 0.769186
Y Loss: 0.222685
T Loss: 9.429092
Epoch 2449 
Overall Loss: 10.304291
Rec Loss: 9.542931
KL Loss: 0.761361
Y Loss: 0.222840
T Loss: 9.431511
Epoch 2499 
Overall Loss: 10.309934
Rec Loss: 9.544834
KL Loss: 0.765100
Y Loss: 0.223374
T Loss: 9.433147
Epoch 2549 
Overall Loss: 10.301395
Rec Loss: 9.535031
KL Loss: 0.766363
Y Loss: 0.219022
T Loss: 9.425521
Epoch 2599 
Overall Loss: 10.313372
Rec Loss: 9.556043
KL Loss: 0.757329
Y Loss: 0.223554
T Loss: 9.444266
Epoch 2649 
Overall Loss: 10.284046
Rec Loss: 9.547473
KL Loss: 0.736573
Y Loss: 0.222900
T Loss: 9.436022
Epoch 2699 
Overall Loss: 10.295353
Rec Loss: 9.541151
KL Loss: 0.754202
Y Loss: 0.218961
T Loss: 9.431671
Epoch 2749 
Overall Loss: 10.286285
Rec Loss: 9.531654
KL Loss: 0.754632
Y Loss: 0.219346
T Loss: 9.421982
Epoch 2799 
Overall Loss: 10.287720
Rec Loss: 9.525995
KL Loss: 0.761726
Y Loss: 0.219180
T Loss: 9.416405
Epoch 2849 
Overall Loss: 10.290478
Rec Loss: 9.528771
KL Loss: 0.761707
Y Loss: 0.218462
T Loss: 9.419540
Epoch 2899 
Overall Loss: 10.305833
Rec Loss: 9.538986
KL Loss: 0.766847
Y Loss: 0.214767
T Loss: 9.431602
Epoch 2949 
Overall Loss: 10.302547
Rec Loss: 9.527590
KL Loss: 0.774958
Y Loss: 0.215239
T Loss: 9.419971
Epoch 2999 
Overall Loss: 10.291750
Rec Loss: 9.520507
KL Loss: 0.771244
Y Loss: 0.216687
T Loss: 9.412163
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.443687
Epoch 99
Rec Loss: 0.442904
Epoch 149
Rec Loss: 0.434451
Epoch 199
Rec Loss: 0.433048
Epoch 249
Rec Loss: 0.441893
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.751050
Epoch 99
Rec Loss: 9.735584
Epoch 149
Rec Loss: 9.725713
Epoch 199
Rec Loss: 9.714539
Epoch 249
Rec Loss: 9.703020
Epoch 299
Rec Loss: 9.692696
Epoch 349
Rec Loss: 9.683505
Epoch 399
Rec Loss: 9.686259
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.446575
Insample Error: 1.191443
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.073008
Epoch 99
Rec Loss: 4.073804
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 8.200137
Epoch 99
Rec Loss: 8.192188
Epoch 149
Rec Loss: 8.120610
Epoch 199
Rec Loss: 8.027740
Epoch 249
Rec Loss: 8.177430
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.004744
Insample Error 2.804452
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.821830
Epoch 99 
Prediction Loss: 0.421250
Epoch 149 
Prediction Loss: 0.331879
Epoch 199 
Prediction Loss: 0.312124
Epoch 249 
Prediction Loss: 0.293758
Epoch 299 
Prediction Loss: 0.287042
Epoch 349 
Prediction Loss: 0.280346
Epoch 399 
Prediction Loss: 0.279216
Epoch 449 
Prediction Loss: 0.282481
Epoch 499 
Prediction Loss: 0.268103
Epoch 549 
Prediction Loss: 0.266240
Epoch 599 
Prediction Loss: 0.263823
Epoch 649 
Prediction Loss: 0.263921
Epoch 699 
Prediction Loss: 0.258350
Epoch 749 
Prediction Loss: 0.253768
Epoch 799 
Prediction Loss: 0.254847
Epoch 849 
Prediction Loss: 0.258742
Epoch 899 
Prediction Loss: 0.254027
Epoch 949 
Prediction Loss: 0.248823
Epoch 999 
Prediction Loss: 0.251420
Epoch 1049 
Prediction Loss: 0.246328
Epoch 1099 
Prediction Loss: 0.243774
Epoch 1149 
Prediction Loss: 0.244513
Epoch 1199 
Prediction Loss: 0.242242
Epoch 1249 
Prediction Loss: 0.249863
Epoch 1299 
Prediction Loss: 0.241090
Epoch 1349 
Prediction Loss: 0.242311
Epoch 1399 
Prediction Loss: 0.242078
Epoch 1449 
Prediction Loss: 0.239291
Epoch 1499 
Prediction Loss: 0.238180
Epoch 1549 
Prediction Loss: 0.235173
Epoch 1599 
Prediction Loss: 0.243153
Epoch 1649 
Prediction Loss: 0.239435
Epoch 1699 
Prediction Loss: 0.240312
Epoch 1749 
Prediction Loss: 0.233480
Epoch 1799 
Prediction Loss: 0.230860
Epoch 1849 
Prediction Loss: 0.232742
Epoch 1899 
Prediction Loss: 0.230741
Epoch 1949 
Prediction Loss: 0.239133
Epoch 1999 
Prediction Loss: 0.238844
Epoch 2049 
Prediction Loss: 0.228070
Epoch 2099 
Prediction Loss: 0.226926
Epoch 2149 
Prediction Loss: 0.229768
Epoch 2199 
Prediction Loss: 0.229080
Epoch 2249 
Prediction Loss: 0.225709
Epoch 2299 
Prediction Loss: 0.226107
Epoch 2349 
Prediction Loss: 0.232455
Epoch 2399 
Prediction Loss: 0.238306
Epoch 2449 
Prediction Loss: 0.221609
Epoch 2499 
Prediction Loss: 0.233379
Epoch 2549 
Prediction Loss: 0.223144
Epoch 2599 
Prediction Loss: 0.223133
Epoch 2649 
Prediction Loss: 0.221317
Epoch 2699 
Prediction Loss: 0.221833
Epoch 2749 
Prediction Loss: 0.228523
Epoch 2799 
Prediction Loss: 0.218927
Epoch 2849 
Prediction Loss: 0.221335
Epoch 2899 
Prediction Loss: 0.218827
Epoch 2949 
Prediction Loss: 0.222413
Epoch 2999 
Prediction Loss: 0.215444
Epoch 3049 
Prediction Loss: 0.214285
Epoch 3099 
Prediction Loss: 0.217275
Epoch 3149 
Prediction Loss: 0.212274
Epoch 3199 
Prediction Loss: 0.213372
Epoch 3249 
Prediction Loss: 0.219773
Epoch 3299 
Prediction Loss: 0.212783
Epoch 3349 
Prediction Loss: 0.213680
Epoch 3399 
Prediction Loss: 0.210670
Epoch 3449 
Prediction Loss: 0.212239
Epoch 3499 
Prediction Loss: 0.208984
Epoch 3549 
Prediction Loss: 0.208896
Epoch 3599 
Prediction Loss: 0.211460
Epoch 3649 
Prediction Loss: 0.206875
Epoch 3699 
Prediction Loss: 0.212241
Epoch 3749 
Prediction Loss: 0.211030
Epoch 3799 
Prediction Loss: 0.210430
Epoch 3849 
Prediction Loss: 0.204962
Epoch 3899 
Prediction Loss: 0.206254
Epoch 3949 
Prediction Loss: 0.206190
Epoch 3999 
Prediction Loss: 0.202141
Epoch 4049 
Prediction Loss: 0.209245
Epoch 4099 
Prediction Loss: 0.218379
Epoch 4149 
Prediction Loss: 0.206453
Epoch 4199 
Prediction Loss: 0.204441
Epoch 4249 
Prediction Loss: 0.201483
Epoch 4299 
Prediction Loss: 0.202403
Epoch 4349 
Prediction Loss: 0.203018
Epoch 4399 
Prediction Loss: 0.200199
Epoch 4449 
Prediction Loss: 0.199913
Epoch 4499 
Prediction Loss: 0.203125
Epoch 4549 
Prediction Loss: 0.201411
Epoch 4599 
Prediction Loss: 0.199437
Epoch 4649 
Prediction Loss: 0.199442
Epoch 4699 
Prediction Loss: 0.205949
Epoch 4749 
Prediction Loss: 0.199339
Epoch 4799 
Prediction Loss: 0.202546
Epoch 4849 
Prediction Loss: 0.196089
Epoch 4899 
Prediction Loss: 0.194507
Epoch 4949 
Prediction Loss: 0.198873
Epoch 4999 
Prediction Loss: 0.197362
Epoch 5049 
Prediction Loss: 0.194559
Epoch 5099 
Prediction Loss: 0.199517
Epoch 5149 
Prediction Loss: 0.199065
Epoch 5199 
Prediction Loss: 0.190815
Epoch 5249 
Prediction Loss: 0.193613
Epoch 5299 
Prediction Loss: 0.190992
Epoch 5349 
Prediction Loss: 0.189836
Epoch 5399 
Prediction Loss: 0.189826
Epoch 5449 
Prediction Loss: 0.197363
Epoch 5499 
Prediction Loss: 0.193391
Epoch 5549 
Prediction Loss: 0.191042
Epoch 5599 
Prediction Loss: 0.190043
Epoch 5649 
Prediction Loss: 0.198548
Epoch 5699 
Prediction Loss: 0.188211
Epoch 5749 
Prediction Loss: 0.190404
Epoch 5799 
Prediction Loss: 0.186783
Epoch 5849 
Prediction Loss: 0.186269
Epoch 5899 
Prediction Loss: 0.195901
Epoch 5949 
Prediction Loss: 0.188331
Epoch 5999 
Prediction Loss: 0.185336
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.430544
Insample Error 1.196204
Ours, Train RMSE
0.4437, 
0.4440, 
0.4381, 
0.4539, 
0.4466, 
CEVAE, Train RMSE
2.9935, 
2.9667, 
2.9628, 
2.9892, 
3.0047, 
Ours, Insample RMSE
1.2021, 
1.2205, 
1.2127, 
1.1756, 
1.1914, 
CEVAE, Insample RMSE
2.8013, 
2.7956, 
2.7960, 
2.8032, 
2.8045, 
Direct Regression, Insample RMSE
1.2210, 
1.2104, 
1.1929, 
1.2067, 
1.1962, 
Train, RMSE mean 0.4453 std 0.0051
CEVAE, RMSE mean 2.9834 std 0.0161
Ours, RMSE mean 1.2004 std 0.0158, reconstruct confounder 0.4277 (0.0099) noise 9.6869 (0.0161)
CEVAE, RMSE mean 2.8001 std 0.0037, reconstruct confounder 4.0517 (0.0158) noise 8.7981 (0.4999)
Direct Regression, RMSE mean 1.2055 std 0.0101
Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=4, mask=0, nlayer=50, obsm=3, stop=2000, ycof=0.5, ylayer=50)
Y Mean 1.776465, Std 3.501489 
Test Y Mean -0.006496, Std 3.341313 
Observe confounder 3, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.042930
Rec Loss: 9.976747
KL Loss: 1.066184
Y Loss: 0.836735
T Loss: 9.558379
Epoch 99 
Overall Loss: 10.786207
Rec Loss: 9.976782
KL Loss: 0.809425
Y Loss: 0.692830
T Loss: 9.630368
Epoch 149 
Overall Loss: 10.691272
Rec Loss: 9.935269
KL Loss: 0.756002
Y Loss: 0.641280
T Loss: 9.614629
Epoch 199 
Overall Loss: 10.660026
Rec Loss: 9.913999
KL Loss: 0.746027
Y Loss: 0.603672
T Loss: 9.612162
Epoch 249 
Overall Loss: 10.634129
Rec Loss: 9.892606
KL Loss: 0.741523
Y Loss: 0.582850
T Loss: 9.601181
Epoch 299 
Overall Loss: 10.621379
Rec Loss: 9.892230
KL Loss: 0.729149
Y Loss: 0.582824
T Loss: 9.600818
Epoch 349 
Overall Loss: 10.603871
Rec Loss: 9.879955
KL Loss: 0.723916
Y Loss: 0.555827
T Loss: 9.602041
Epoch 399 
Overall Loss: 10.590402
Rec Loss: 9.871491
KL Loss: 0.718911
Y Loss: 0.549671
T Loss: 9.596655
Epoch 449 
Overall Loss: 10.607484
Rec Loss: 9.890614
KL Loss: 0.716870
Y Loss: 0.542655
T Loss: 9.619286
Epoch 499 
Overall Loss: 10.588693
Rec Loss: 9.872755
KL Loss: 0.715938
Y Loss: 0.552210
T Loss: 9.596650
Epoch 549 
Overall Loss: 10.585963
Rec Loss: 9.877685
KL Loss: 0.708278
Y Loss: 0.552127
T Loss: 9.601621
Epoch 599 
Overall Loss: 10.572920
Rec Loss: 9.857977
KL Loss: 0.714942
Y Loss: 0.527081
T Loss: 9.594437
Epoch 649 
Overall Loss: 10.588623
Rec Loss: 9.864527
KL Loss: 0.724096
Y Loss: 0.535028
T Loss: 9.597013
Epoch 699 
Overall Loss: 10.561875
Rec Loss: 9.855848
KL Loss: 0.706026
Y Loss: 0.528881
T Loss: 9.591408
Epoch 749 
Overall Loss: 10.565607
Rec Loss: 9.858281
KL Loss: 0.707326
Y Loss: 0.534708
T Loss: 9.590927
Epoch 799 
Overall Loss: 10.570039
Rec Loss: 9.852150
KL Loss: 0.717889
Y Loss: 0.530808
T Loss: 9.586746
Epoch 849 
Overall Loss: 10.555295
Rec Loss: 9.847891
KL Loss: 0.707404
Y Loss: 0.523697
T Loss: 9.586042
Epoch 899 
Overall Loss: 10.559488
Rec Loss: 9.840705
KL Loss: 0.718783
Y Loss: 0.517936
T Loss: 9.581738
Epoch 949 
Overall Loss: 10.541540
Rec Loss: 9.832612
KL Loss: 0.708927
Y Loss: 0.508422
T Loss: 9.578402
Epoch 999 
Overall Loss: 10.554408
Rec Loss: 9.837217
KL Loss: 0.717191
Y Loss: 0.512559
T Loss: 9.580938
Epoch 1049 
Overall Loss: 10.539068
Rec Loss: 9.835509
KL Loss: 0.703559
Y Loss: 0.522201
T Loss: 9.574409
Epoch 1099 
Overall Loss: 10.542449
Rec Loss: 9.828368
KL Loss: 0.714081
Y Loss: 0.519070
T Loss: 9.568833
Epoch 1149 
Overall Loss: 10.554492
Rec Loss: 9.821008
KL Loss: 0.733484
Y Loss: 0.511521
T Loss: 9.565247
Epoch 1199 
Overall Loss: 10.530372
Rec Loss: 9.831563
KL Loss: 0.698810
Y Loss: 0.501089
T Loss: 9.581018
Epoch 1249 
Overall Loss: 10.534042
Rec Loss: 9.829057
KL Loss: 0.704985
Y Loss: 0.499371
T Loss: 9.579372
Epoch 1299 
Overall Loss: 10.517739
Rec Loss: 9.811482
KL Loss: 0.706257
Y Loss: 0.493463
T Loss: 9.564751
Epoch 1349 
Overall Loss: 10.531227
Rec Loss: 9.810634
KL Loss: 0.720592
Y Loss: 0.507891
T Loss: 9.556689
Epoch 1399 
Overall Loss: 10.515836
Rec Loss: 9.803325
KL Loss: 0.712511
Y Loss: 0.486656
T Loss: 9.559997
Epoch 1449 
Overall Loss: 10.504610
Rec Loss: 9.792943
KL Loss: 0.711667
Y Loss: 0.500661
T Loss: 9.542613
Epoch 1499 
Overall Loss: 10.513303
Rec Loss: 9.797824
KL Loss: 0.715480
Y Loss: 0.492074
T Loss: 9.551787
Epoch 1549 
Overall Loss: 10.527185
Rec Loss: 9.818078
KL Loss: 0.709107
Y Loss: 0.503750
T Loss: 9.566203
Epoch 1599 
Overall Loss: 10.512551
Rec Loss: 9.810540
KL Loss: 0.702010
Y Loss: 0.482162
T Loss: 9.569460
Epoch 1649 
Overall Loss: 10.505538
Rec Loss: 9.814795
KL Loss: 0.690743
Y Loss: 0.494425
T Loss: 9.567583
Epoch 1699 
Overall Loss: 10.495376
Rec Loss: 9.777423
KL Loss: 0.717952
Y Loss: 0.482056
T Loss: 9.536395
Epoch 1749 
Overall Loss: 10.495306
Rec Loss: 9.793525
KL Loss: 0.701782
Y Loss: 0.493924
T Loss: 9.546563
Epoch 1799 
Overall Loss: 10.512542
Rec Loss: 9.795951
KL Loss: 0.716591
Y Loss: 0.487987
T Loss: 9.551958
Epoch 1849 
Overall Loss: 10.495544
Rec Loss: 9.787571
KL Loss: 0.707973
Y Loss: 0.488455
T Loss: 9.543344
Epoch 1899 
Overall Loss: 10.497703
Rec Loss: 9.789625
KL Loss: 0.708078
Y Loss: 0.486305
T Loss: 9.546473
Epoch 1949 
Overall Loss: 10.498389
Rec Loss: 9.794889
KL Loss: 0.703500
Y Loss: 0.478276
T Loss: 9.555751
Epoch 1999 
Overall Loss: 10.492119
Rec Loss: 9.779723
KL Loss: 0.712395
Y Loss: 0.478879
T Loss: 9.540284
Epoch 2049 
Overall Loss: 10.485286
Rec Loss: 9.769422
KL Loss: 0.715864
Y Loss: 0.465042
T Loss: 9.536901
Epoch 2099 
Overall Loss: 10.488346
Rec Loss: 9.772587
KL Loss: 0.715760
Y Loss: 0.472739
T Loss: 9.536217
Epoch 2149 
Overall Loss: 10.489785
Rec Loss: 9.783428
KL Loss: 0.706357
Y Loss: 0.474740
T Loss: 9.546058
Epoch 2199 
Overall Loss: 10.470623
Rec Loss: 9.777200
KL Loss: 0.693424
Y Loss: 0.474206
T Loss: 9.540097
Epoch 2249 
Overall Loss: 10.479967
Rec Loss: 9.778350
KL Loss: 0.701617
Y Loss: 0.466274
T Loss: 9.545213
Epoch 2299 
Overall Loss: 10.482415
Rec Loss: 9.773423
KL Loss: 0.708992
Y Loss: 0.483413
T Loss: 9.531716
Epoch 2349 
Overall Loss: 10.479412
Rec Loss: 9.774746
KL Loss: 0.704666
Y Loss: 0.483044
T Loss: 9.533224
Epoch 2399 
Overall Loss: 10.467287
Rec Loss: 9.759748
KL Loss: 0.707539
Y Loss: 0.464864
T Loss: 9.527317
Epoch 2449 
Overall Loss: 10.469993
Rec Loss: 9.758489
KL Loss: 0.711504
Y Loss: 0.468834
T Loss: 9.524072
Epoch 2499 
Overall Loss: 10.473987
Rec Loss: 9.771362
KL Loss: 0.702624
Y Loss: 0.467148
T Loss: 9.537788
Epoch 2549 
Overall Loss: 10.478598
Rec Loss: 9.755557
KL Loss: 0.723041
Y Loss: 0.479349
T Loss: 9.515882
Epoch 2599 
Overall Loss: 10.468590
Rec Loss: 9.756155
KL Loss: 0.712435
Y Loss: 0.458301
T Loss: 9.527005
Epoch 2649 
Overall Loss: 10.471841
Rec Loss: 9.743385
KL Loss: 0.728456
Y Loss: 0.460999
T Loss: 9.512885
Epoch 2699 
Overall Loss: 10.459687
Rec Loss: 9.750183
KL Loss: 0.709504
Y Loss: 0.459667
T Loss: 9.520350
Epoch 2749 
Overall Loss: 10.456853
Rec Loss: 9.752037
KL Loss: 0.704816
Y Loss: 0.467108
T Loss: 9.518483
Epoch 2799 
Overall Loss: 10.464165
Rec Loss: 9.759955
KL Loss: 0.704210
Y Loss: 0.464482
T Loss: 9.527714
Epoch 2849 
Overall Loss: 10.473981
Rec Loss: 9.756447
KL Loss: 0.717535
Y Loss: 0.461620
T Loss: 9.525636
Epoch 2899 
Overall Loss: 10.456299
Rec Loss: 9.755146
KL Loss: 0.701153
Y Loss: 0.453931
T Loss: 9.528181
Epoch 2949 
Overall Loss: 10.451680
Rec Loss: 9.750656
KL Loss: 0.701023
Y Loss: 0.464829
T Loss: 9.518242
Epoch 2999 
Overall Loss: 10.449204
Rec Loss: 9.740542
KL Loss: 0.708661
Y Loss: 0.449636
T Loss: 9.515724
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.438418
Epoch 99
Rec Loss: 0.442587
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.192449
Epoch 99
Rec Loss: 10.195815
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.632309
Insample Error: 1.437985
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.985374
Epoch 99
Rec Loss: 3.980682
Epoch 149
Rec Loss: 3.992475
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.047085
Epoch 99
Rec Loss: 9.088703
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.800931
Insample Error 3.335064
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.970591
Epoch 99 
Prediction Loss: 0.720889
Epoch 149 
Prediction Loss: 0.665257
Epoch 199 
Prediction Loss: 0.642941
Epoch 249 
Prediction Loss: 0.626823
Epoch 299 
Prediction Loss: 0.610819
Epoch 349 
Prediction Loss: 0.596846
Epoch 399 
Prediction Loss: 0.586418
Epoch 449 
Prediction Loss: 0.579219
Epoch 499 
Prediction Loss: 0.583680
Epoch 549 
Prediction Loss: 0.571587
Epoch 599 
Prediction Loss: 0.564919
Epoch 649 
Prediction Loss: 0.564888
Epoch 699 
Prediction Loss: 0.560774
Epoch 749 
Prediction Loss: 0.559225
Epoch 799 
Prediction Loss: 0.552648
Epoch 849 
Prediction Loss: 0.551101
Epoch 899 
Prediction Loss: 0.553974
Epoch 949 
Prediction Loss: 0.546207
Epoch 999 
Prediction Loss: 0.547012
Epoch 1049 
Prediction Loss: 0.541600
Epoch 1099 
Prediction Loss: 0.539553
Epoch 1149 
Prediction Loss: 0.552738
Epoch 1199 
Prediction Loss: 0.542806
Epoch 1249 
Prediction Loss: 0.543468
Epoch 1299 
Prediction Loss: 0.535509
Epoch 1349 
Prediction Loss: 0.541250
Epoch 1399 
Prediction Loss: 0.533519
Epoch 1449 
Prediction Loss: 0.535416
Epoch 1499 
Prediction Loss: 0.525032
Epoch 1549 
Prediction Loss: 0.538252
Epoch 1599 
Prediction Loss: 0.518250
Epoch 1649 
Prediction Loss: 0.515864
Epoch 1699 
Prediction Loss: 0.518757
Epoch 1749 
Prediction Loss: 0.521331
Epoch 1799 
Prediction Loss: 0.523669
Epoch 1849 
Prediction Loss: 0.515260
Epoch 1899 
Prediction Loss: 0.511114
Epoch 1949 
Prediction Loss: 0.516501
Epoch 1999 
Prediction Loss: 0.505724
Epoch 2049 
Prediction Loss: 0.504661
Epoch 2099 
Prediction Loss: 0.508612
Epoch 2149 
Prediction Loss: 0.508128
Epoch 2199 
Prediction Loss: 0.498079
Epoch 2249 
Prediction Loss: 0.499885
Epoch 2299 
Prediction Loss: 0.501008
Epoch 2349 
Prediction Loss: 0.501938
Epoch 2399 
Prediction Loss: 0.491709
Epoch 2449 
Prediction Loss: 0.498795
Epoch 2499 
Prediction Loss: 0.496312
Epoch 2549 
Prediction Loss: 0.500201
Epoch 2599 
Prediction Loss: 0.489631
Epoch 2649 
Prediction Loss: 0.484272
Epoch 2699 
Prediction Loss: 0.483922
Epoch 2749 
Prediction Loss: 0.480019
Epoch 2799 
Prediction Loss: 0.484275
Epoch 2849 
Prediction Loss: 0.484220
Epoch 2899 
Prediction Loss: 0.472847
Epoch 2949 
Prediction Loss: 0.473757
Epoch 2999 
Prediction Loss: 0.471823
Epoch 3049 
Prediction Loss: 0.469263
Epoch 3099 
Prediction Loss: 0.472931
Epoch 3149 
Prediction Loss: 0.468140
Epoch 3199 
Prediction Loss: 0.471466
Epoch 3249 
Prediction Loss: 0.467836
Epoch 3299 
Prediction Loss: 0.459657
Epoch 3349 
Prediction Loss: 0.462419
Epoch 3399 
Prediction Loss: 0.462092
Epoch 3449 
Prediction Loss: 0.456903
Epoch 3499 
Prediction Loss: 0.456614
Epoch 3549 
Prediction Loss: 0.449467
Epoch 3599 
Prediction Loss: 0.455236
Epoch 3649 
Prediction Loss: 0.451714
Epoch 3699 
Prediction Loss: 0.452630
Epoch 3749 
Prediction Loss: 0.450064
Epoch 3799 
Prediction Loss: 0.443726
Epoch 3849 
Prediction Loss: 0.439827
Epoch 3899 
Prediction Loss: 0.437211
Epoch 3949 
Prediction Loss: 0.435765
Epoch 3999 
Prediction Loss: 0.434937
Epoch 4049 
Prediction Loss: 0.431141
Epoch 4099 
Prediction Loss: 0.431355
Epoch 4149 
Prediction Loss: 0.433288
Epoch 4199 
Prediction Loss: 0.427831
Epoch 4249 
Prediction Loss: 0.436711
Epoch 4299 
Prediction Loss: 0.425398
Epoch 4349 
Prediction Loss: 0.422611
Epoch 4399 
Prediction Loss: 0.425926
Epoch 4449 
Prediction Loss: 0.422725
Epoch 4499 
Prediction Loss: 0.426560
Epoch 4549 
Prediction Loss: 0.415659
Epoch 4599 
Prediction Loss: 0.411851
Epoch 4649 
Prediction Loss: 0.412066
Epoch 4699 
Prediction Loss: 0.408242
Epoch 4749 
Prediction Loss: 0.415475
Epoch 4799 
Prediction Loss: 0.409127
Epoch 4849 
Prediction Loss: 0.414517
Epoch 4899 
Prediction Loss: 0.407144
Epoch 4949 
Prediction Loss: 0.406928
Epoch 4999 
Prediction Loss: 0.399698
Epoch 5049 
Prediction Loss: 0.403260
Epoch 5099 
Prediction Loss: 0.407283
Epoch 5149 
Prediction Loss: 0.396650
Epoch 5199 
Prediction Loss: 0.399830
Epoch 5249 
Prediction Loss: 0.400975
Epoch 5299 
Prediction Loss: 0.393965
Epoch 5349 
Prediction Loss: 0.394419
Epoch 5399 
Prediction Loss: 0.388752
Epoch 5449 
Prediction Loss: 0.392442
Epoch 5499 
Prediction Loss: 0.386267
Epoch 5549 
Prediction Loss: 0.390921
Epoch 5599 
Prediction Loss: 0.385613
Epoch 5649 
Prediction Loss: 0.381909
Epoch 5699 
Prediction Loss: 0.381700
Epoch 5749 
Prediction Loss: 0.380594
Epoch 5799 
Prediction Loss: 0.377747
Epoch 5849 
Prediction Loss: 0.381126
Epoch 5899 
Prediction Loss: 0.375951
Epoch 5949 
Prediction Loss: 0.378374
Epoch 5999 
Prediction Loss: 0.377289
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.606126
Insample Error 1.608639
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.998962
Rec Loss: 10.005731
KL Loss: 0.993231
Y Loss: 0.834775
T Loss: 9.588344
Epoch 99 
Overall Loss: 10.775964
Rec Loss: 9.988170
KL Loss: 0.787795
Y Loss: 0.726871
T Loss: 9.624734
Epoch 149 
Overall Loss: 10.683867
Rec Loss: 9.943109
KL Loss: 0.740759
Y Loss: 0.637762
T Loss: 9.624227
Epoch 199 
Overall Loss: 10.641723
Rec Loss: 9.928735
KL Loss: 0.712988
Y Loss: 0.606913
T Loss: 9.625278
Epoch 249 
Overall Loss: 10.623026
Rec Loss: 9.891932
KL Loss: 0.731094
Y Loss: 0.572087
T Loss: 9.605888
Epoch 299 
Overall Loss: 10.610230
Rec Loss: 9.900888
KL Loss: 0.709342
Y Loss: 0.544952
T Loss: 9.628412
Epoch 349 
Overall Loss: 10.587619
Rec Loss: 9.891704
KL Loss: 0.695915
Y Loss: 0.549310
T Loss: 9.617049
Epoch 399 
Overall Loss: 10.574886
Rec Loss: 9.858752
KL Loss: 0.716134
Y Loss: 0.540819
T Loss: 9.588342
Epoch 449 
Overall Loss: 10.580332
Rec Loss: 9.863041
KL Loss: 0.717291
Y Loss: 0.534421
T Loss: 9.595830
Epoch 499 
Overall Loss: 10.577289
Rec Loss: 9.887469
KL Loss: 0.689820
Y Loss: 0.535221
T Loss: 9.619858
Epoch 549 
Overall Loss: 10.557683
Rec Loss: 9.851655
KL Loss: 0.706028
Y Loss: 0.518768
T Loss: 9.592270
Epoch 599 
Overall Loss: 10.581260
Rec Loss: 9.857196
KL Loss: 0.724064
Y Loss: 0.523143
T Loss: 9.595625
Epoch 649 
Overall Loss: 10.563053
Rec Loss: 9.853282
KL Loss: 0.709771
Y Loss: 0.511799
T Loss: 9.597382
Epoch 699 
Overall Loss: 10.554217
Rec Loss: 9.831449
KL Loss: 0.722768
Y Loss: 0.512491
T Loss: 9.575204
Epoch 749 
Overall Loss: 10.549437
Rec Loss: 9.851006
KL Loss: 0.698430
Y Loss: 0.513889
T Loss: 9.594062
Epoch 799 
Overall Loss: 10.552428
Rec Loss: 9.856864
KL Loss: 0.695564
Y Loss: 0.495803
T Loss: 9.608962
Epoch 849 
Overall Loss: 10.530727
Rec Loss: 9.838532
KL Loss: 0.692195
Y Loss: 0.504201
T Loss: 9.586431
Epoch 899 
Overall Loss: 10.536880
Rec Loss: 9.859640
KL Loss: 0.677240
Y Loss: 0.514849
T Loss: 9.602216
Epoch 949 
Overall Loss: 10.533710
Rec Loss: 9.839765
KL Loss: 0.693945
Y Loss: 0.502870
T Loss: 9.588331
Epoch 999 
Overall Loss: 10.539851
Rec Loss: 9.829863
KL Loss: 0.709988
Y Loss: 0.504404
T Loss: 9.577661
Epoch 1049 
Overall Loss: 10.522571
Rec Loss: 9.834904
KL Loss: 0.687668
Y Loss: 0.495871
T Loss: 9.586968
Epoch 1099 
Overall Loss: 10.518059
Rec Loss: 9.812222
KL Loss: 0.705837
Y Loss: 0.496849
T Loss: 9.563797
Epoch 1149 
Overall Loss: 10.521453
Rec Loss: 9.824770
KL Loss: 0.696683
Y Loss: 0.485767
T Loss: 9.581886
Epoch 1199 
Overall Loss: 10.533767
Rec Loss: 9.840971
KL Loss: 0.692796
Y Loss: 0.510090
T Loss: 9.585926
Epoch 1249 
Overall Loss: 10.512024
Rec Loss: 9.814675
KL Loss: 0.697349
Y Loss: 0.486936
T Loss: 9.571207
Epoch 1299 
Overall Loss: 10.525973
Rec Loss: 9.822088
KL Loss: 0.703885
Y Loss: 0.493341
T Loss: 9.575418
Epoch 1349 
Overall Loss: 10.518003
Rec Loss: 9.815996
KL Loss: 0.702007
Y Loss: 0.480881
T Loss: 9.575556
Epoch 1399 
Overall Loss: 10.505024
Rec Loss: 9.792183
KL Loss: 0.712841
Y Loss: 0.486634
T Loss: 9.548866
Epoch 1449 
Overall Loss: 10.502118
Rec Loss: 9.815711
KL Loss: 0.686408
Y Loss: 0.485196
T Loss: 9.573112
Epoch 1499 
Overall Loss: 10.474698
Rec Loss: 9.786103
KL Loss: 0.688595
Y Loss: 0.476389
T Loss: 9.547908
Epoch 1549 
Overall Loss: 10.496849
Rec Loss: 9.796915
KL Loss: 0.699935
Y Loss: 0.470407
T Loss: 9.561711
Epoch 1599 
Overall Loss: 10.491366
Rec Loss: 9.791531
KL Loss: 0.699835
Y Loss: 0.475782
T Loss: 9.553640
Epoch 1649 
Overall Loss: 10.481832
Rec Loss: 9.793611
KL Loss: 0.688221
Y Loss: 0.473622
T Loss: 9.556800
Epoch 1699 
Overall Loss: 10.498217
Rec Loss: 9.786976
KL Loss: 0.711241
Y Loss: 0.473667
T Loss: 9.550143
Epoch 1749 
Overall Loss: 10.485911
Rec Loss: 9.781365
KL Loss: 0.704545
Y Loss: 0.474396
T Loss: 9.544168
Epoch 1799 
Overall Loss: 10.476426
Rec Loss: 9.784536
KL Loss: 0.691890
Y Loss: 0.466133
T Loss: 9.551469
Epoch 1849 
Overall Loss: 10.494524
Rec Loss: 9.776355
KL Loss: 0.718169
Y Loss: 0.474653
T Loss: 9.539029
Epoch 1899 
Overall Loss: 10.462027
Rec Loss: 9.774975
KL Loss: 0.687052
Y Loss: 0.464143
T Loss: 9.542904
Epoch 1949 
Overall Loss: 10.469484
Rec Loss: 9.770673
KL Loss: 0.698811
Y Loss: 0.466812
T Loss: 9.537266
Epoch 1999 
Overall Loss: 10.466252
Rec Loss: 9.754024
KL Loss: 0.712228
Y Loss: 0.458055
T Loss: 9.524996
Epoch 2049 
Overall Loss: 10.472991
Rec Loss: 9.774646
KL Loss: 0.698344
Y Loss: 0.457922
T Loss: 9.545685
Epoch 2099 
Overall Loss: 10.467329
Rec Loss: 9.775408
KL Loss: 0.691920
Y Loss: 0.460702
T Loss: 9.545057
Epoch 2149 
Overall Loss: 10.464661
Rec Loss: 9.763107
KL Loss: 0.701554
Y Loss: 0.456500
T Loss: 9.534857
Epoch 2199 
Overall Loss: 10.479705
Rec Loss: 9.768317
KL Loss: 0.711388
Y Loss: 0.465715
T Loss: 9.535459
Epoch 2249 
Overall Loss: 10.458655
Rec Loss: 9.775878
KL Loss: 0.682777
Y Loss: 0.462479
T Loss: 9.544639
Epoch 2299 
Overall Loss: 10.436773
Rec Loss: 9.759807
KL Loss: 0.676966
Y Loss: 0.460455
T Loss: 9.529580
Epoch 2349 
Overall Loss: 10.467020
Rec Loss: 9.766618
KL Loss: 0.700403
Y Loss: 0.473804
T Loss: 9.529715
Epoch 2399 
Overall Loss: 10.458422
Rec Loss: 9.743653
KL Loss: 0.714769
Y Loss: 0.448137
T Loss: 9.519584
Epoch 2449 
Overall Loss: 10.460740
Rec Loss: 9.771605
KL Loss: 0.689135
Y Loss: 0.459028
T Loss: 9.542090
Epoch 2499 
Overall Loss: 10.445704
Rec Loss: 9.750660
KL Loss: 0.695044
Y Loss: 0.445450
T Loss: 9.527935
Epoch 2549 
Overall Loss: 10.446826
Rec Loss: 9.746142
KL Loss: 0.700684
Y Loss: 0.453084
T Loss: 9.519600
Epoch 2599 
Overall Loss: 10.443880
Rec Loss: 9.752366
KL Loss: 0.691513
Y Loss: 0.446634
T Loss: 9.529050
Epoch 2649 
Overall Loss: 10.463947
Rec Loss: 9.753729
KL Loss: 0.710217
Y Loss: 0.455249
T Loss: 9.526105
Epoch 2699 
Overall Loss: 10.446007
Rec Loss: 9.752173
KL Loss: 0.693835
Y Loss: 0.445223
T Loss: 9.529561
Epoch 2749 
Overall Loss: 10.436829
Rec Loss: 9.743857
KL Loss: 0.692972
Y Loss: 0.439521
T Loss: 9.524097
Epoch 2799 
Overall Loss: 10.442494
Rec Loss: 9.747474
KL Loss: 0.695020
Y Loss: 0.452157
T Loss: 9.521396
Epoch 2849 
Overall Loss: 10.446532
Rec Loss: 9.758219
KL Loss: 0.688313
Y Loss: 0.452350
T Loss: 9.532043
Epoch 2899 
Overall Loss: 10.435179
Rec Loss: 9.735650
KL Loss: 0.699529
Y Loss: 0.431049
T Loss: 9.520125
Epoch 2949 
Overall Loss: 10.429567
Rec Loss: 9.744329
KL Loss: 0.685238
Y Loss: 0.435253
T Loss: 9.526703
Epoch 2999 
Overall Loss: 10.414050
Rec Loss: 9.728384
KL Loss: 0.685667
Y Loss: 0.428825
T Loss: 9.513971
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.461326
Epoch 99
Rec Loss: 0.468298
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.198858
Epoch 99
Rec Loss: 10.175527
Epoch 149
Rec Loss: 10.182109
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.630939
Insample Error: 1.488934
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.014010
Epoch 99
Rec Loss: 4.012461
Epoch 149
Rec Loss: 4.005236
Epoch 199
Rec Loss: 4.009162
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 9.536136
Epoch 99
Rec Loss: 9.447109
Epoch 149
Rec Loss: 9.569574
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.785115
Insample Error 3.342208
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.059335
Epoch 99 
Prediction Loss: 0.788383
Epoch 149 
Prediction Loss: 0.690831
Epoch 199 
Prediction Loss: 0.653283
Epoch 249 
Prediction Loss: 0.625520
Epoch 299 
Prediction Loss: 0.608493
Epoch 349 
Prediction Loss: 0.598306
Epoch 399 
Prediction Loss: 0.599815
Epoch 449 
Prediction Loss: 0.589822
Epoch 499 
Prediction Loss: 0.586218
Epoch 549 
Prediction Loss: 0.585393
Epoch 599 
Prediction Loss: 0.575608
Epoch 649 
Prediction Loss: 0.566669
Epoch 699 
Prediction Loss: 0.570761
Epoch 749 
Prediction Loss: 0.565048
Epoch 799 
Prediction Loss: 0.561685
Epoch 849 
Prediction Loss: 0.560605
Epoch 899 
Prediction Loss: 0.562640
Epoch 949 
Prediction Loss: 0.553393
Epoch 999 
Prediction Loss: 0.549373
Epoch 1049 
Prediction Loss: 0.546399
Epoch 1099 
Prediction Loss: 0.550157
Epoch 1149 
Prediction Loss: 0.551098
Epoch 1199 
Prediction Loss: 0.537049
Epoch 1249 
Prediction Loss: 0.536424
Epoch 1299 
Prediction Loss: 0.535036
Epoch 1349 
Prediction Loss: 0.534706
Epoch 1399 
Prediction Loss: 0.539352
Epoch 1449 
Prediction Loss: 0.532561
Epoch 1499 
Prediction Loss: 0.525564
Epoch 1549 
Prediction Loss: 0.522646
Epoch 1599 
Prediction Loss: 0.525013
Epoch 1649 
Prediction Loss: 0.522600
Epoch 1699 
Prediction Loss: 0.523774
Epoch 1749 
Prediction Loss: 0.520059
Epoch 1799 
Prediction Loss: 0.516137
Epoch 1849 
Prediction Loss: 0.513080
Epoch 1899 
Prediction Loss: 0.512035
Epoch 1949 
Prediction Loss: 0.511650
Epoch 1999 
Prediction Loss: 0.510230
Epoch 2049 
Prediction Loss: 0.507058
Epoch 2099 
Prediction Loss: 0.512289
Epoch 2149 
Prediction Loss: 0.511100
Epoch 2199 
Prediction Loss: 0.506866
Epoch 2249 
Prediction Loss: 0.500971
Epoch 2299 
Prediction Loss: 0.501285
Epoch 2349 
Prediction Loss: 0.509691
Epoch 2399 
Prediction Loss: 0.495647
Epoch 2449 
Prediction Loss: 0.504472
Epoch 2499 
Prediction Loss: 0.494061
Epoch 2549 
Prediction Loss: 0.490146
Epoch 2599 
Prediction Loss: 0.489396
Epoch 2649 
Prediction Loss: 0.488519
Epoch 2699 
Prediction Loss: 0.490303
Epoch 2749 
Prediction Loss: 0.491374
Epoch 2799 
Prediction Loss: 0.487083
Epoch 2849 
Prediction Loss: 0.486478
Epoch 2899 
Prediction Loss: 0.478668
Epoch 2949 
Prediction Loss: 0.479356
Epoch 2999 
Prediction Loss: 0.475637
Epoch 3049 
Prediction Loss: 0.473796
Epoch 3099 
Prediction Loss: 0.488143
Epoch 3149 
Prediction Loss: 0.474680
Epoch 3199 
Prediction Loss: 0.472334
Epoch 3249 
Prediction Loss: 0.477110
Epoch 3299 
Prediction Loss: 0.468197
Epoch 3349 
Prediction Loss: 0.471549
Epoch 3399 
Prediction Loss: 0.460358
Epoch 3449 
Prediction Loss: 0.468422
Epoch 3499 
Prediction Loss: 0.464985
Epoch 3549 
Prediction Loss: 0.460804
Epoch 3599 
Prediction Loss: 0.464712
Epoch 3649 
Prediction Loss: 0.457533
Epoch 3699 
Prediction Loss: 0.461961
Epoch 3749 
Prediction Loss: 0.455703
Epoch 3799 
Prediction Loss: 0.454536
Epoch 3849 
Prediction Loss: 0.457268
Epoch 3899 
Prediction Loss: 0.450626
Epoch 3949 
Prediction Loss: 0.455037
Epoch 3999 
Prediction Loss: 0.454136
Epoch 4049 
Prediction Loss: 0.454139
Epoch 4099 
Prediction Loss: 0.443994
Epoch 4149 
Prediction Loss: 0.444076
Epoch 4199 
Prediction Loss: 0.442798
Epoch 4249 
Prediction Loss: 0.439823
Epoch 4299 
Prediction Loss: 0.433495
Epoch 4349 
Prediction Loss: 0.441535
Epoch 4399 
Prediction Loss: 0.436135
Epoch 4449 
Prediction Loss: 0.449572
Epoch 4499 
Prediction Loss: 0.430517
Epoch 4549 
Prediction Loss: 0.428001
Epoch 4599 
Prediction Loss: 0.429483
Epoch 4649 
Prediction Loss: 0.427319
Epoch 4699 
Prediction Loss: 0.431593
Epoch 4749 
Prediction Loss: 0.423171
Epoch 4799 
Prediction Loss: 0.428955
Epoch 4849 
Prediction Loss: 0.419756
Epoch 4899 
Prediction Loss: 0.423918
Epoch 4949 
Prediction Loss: 0.417615
Epoch 4999 
Prediction Loss: 0.415492
Epoch 5049 
Prediction Loss: 0.416565
Epoch 5099 
Prediction Loss: 0.412889
Epoch 5149 
Prediction Loss: 0.416806
Epoch 5199 
Prediction Loss: 0.413339
Epoch 5249 
Prediction Loss: 0.412143
Epoch 5299 
Prediction Loss: 0.418052
Epoch 5349 
Prediction Loss: 0.415230
Epoch 5399 
Prediction Loss: 0.403736
Epoch 5449 
Prediction Loss: 0.402475
Epoch 5499 
Prediction Loss: 0.401049
Epoch 5549 
Prediction Loss: 0.398822
Epoch 5599 
Prediction Loss: 0.407322
Epoch 5649 
Prediction Loss: 0.403282
Epoch 5699 
Prediction Loss: 0.401233
Epoch 5749 
Prediction Loss: 0.394674
Epoch 5799 
Prediction Loss: 0.392596
Epoch 5849 
Prediction Loss: 0.396921
Epoch 5899 
Prediction Loss: 0.390192
Epoch 5949 
Prediction Loss: 0.393532
Epoch 5999 
Prediction Loss: 0.398809
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.633148
Insample Error 1.632346
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.057094
Rec Loss: 10.001589
KL Loss: 1.055505
Y Loss: 0.802202
T Loss: 9.600489
Epoch 99 
Overall Loss: 10.805668
Rec Loss: 10.010198
KL Loss: 0.795470
Y Loss: 0.704681
T Loss: 9.657857
Epoch 149 
Overall Loss: 10.702449
Rec Loss: 9.970630
KL Loss: 0.731819
Y Loss: 0.661897
T Loss: 9.639681
Epoch 199 
Overall Loss: 10.668308
Rec Loss: 9.959464
KL Loss: 0.708844
Y Loss: 0.631495
T Loss: 9.643716
Epoch 249 
Overall Loss: 10.653636
Rec Loss: 9.936935
KL Loss: 0.716701
Y Loss: 0.613267
T Loss: 9.630301
Epoch 299 
Overall Loss: 10.617662
Rec Loss: 9.925680
KL Loss: 0.691982
Y Loss: 0.604911
T Loss: 9.623224
Epoch 349 
Overall Loss: 10.608821
Rec Loss: 9.915342
KL Loss: 0.693479
Y Loss: 0.590112
T Loss: 9.620286
Epoch 399 
Overall Loss: 10.599482
Rec Loss: 9.891125
KL Loss: 0.708357
Y Loss: 0.576838
T Loss: 9.602706
Epoch 449 
Overall Loss: 10.604342
Rec Loss: 9.920309
KL Loss: 0.684033
Y Loss: 0.584808
T Loss: 9.627905
Epoch 499 
Overall Loss: 10.603517
Rec Loss: 9.903828
KL Loss: 0.699690
Y Loss: 0.577545
T Loss: 9.615056
Epoch 549 
Overall Loss: 10.593308
Rec Loss: 9.894767
KL Loss: 0.698541
Y Loss: 0.574421
T Loss: 9.607556
Epoch 599 
Overall Loss: 10.619435
Rec Loss: 9.895037
KL Loss: 0.724397
Y Loss: 0.562997
T Loss: 9.613539
Epoch 649 
Overall Loss: 10.581392
Rec Loss: 9.886436
KL Loss: 0.694956
Y Loss: 0.561767
T Loss: 9.605553
Epoch 699 
Overall Loss: 10.568736
Rec Loss: 9.886778
KL Loss: 0.681959
Y Loss: 0.555234
T Loss: 9.609161
Epoch 749 
Overall Loss: 10.566068
Rec Loss: 9.877588
KL Loss: 0.688480
Y Loss: 0.550815
T Loss: 9.602180
Epoch 799 
Overall Loss: 10.554160
Rec Loss: 9.869496
KL Loss: 0.684664
Y Loss: 0.557437
T Loss: 9.590778
Epoch 849 
Overall Loss: 10.564962
Rec Loss: 9.877315
KL Loss: 0.687647
Y Loss: 0.552990
T Loss: 9.600820
Epoch 899 
Overall Loss: 10.546721
Rec Loss: 9.869458
KL Loss: 0.677264
Y Loss: 0.546424
T Loss: 9.596246
Epoch 949 
Overall Loss: 10.559257
Rec Loss: 9.876867
KL Loss: 0.682390
Y Loss: 0.548419
T Loss: 9.602657
Epoch 999 
Overall Loss: 10.541721
Rec Loss: 9.870779
KL Loss: 0.670942
Y Loss: 0.551055
T Loss: 9.595252
Epoch 1049 
Overall Loss: 10.538482
Rec Loss: 9.850148
KL Loss: 0.688335
Y Loss: 0.553540
T Loss: 9.573378
Epoch 1099 
Overall Loss: 10.525457
Rec Loss: 9.852837
KL Loss: 0.672620
Y Loss: 0.539690
T Loss: 9.582992
Epoch 1149 
Overall Loss: 10.551339
Rec Loss: 9.863330
KL Loss: 0.688009
Y Loss: 0.546941
T Loss: 9.589859
Epoch 1199 
Overall Loss: 10.538599
Rec Loss: 9.852915
KL Loss: 0.685683
Y Loss: 0.537903
T Loss: 9.583964
Epoch 1249 
Overall Loss: 10.524663
Rec Loss: 9.860023
KL Loss: 0.664640
Y Loss: 0.537355
T Loss: 9.591345
Epoch 1299 
Overall Loss: 10.521231
Rec Loss: 9.830474
KL Loss: 0.690757
Y Loss: 0.540138
T Loss: 9.560405
Epoch 1349 
Overall Loss: 10.531078
Rec Loss: 9.842768
KL Loss: 0.688310
Y Loss: 0.532296
T Loss: 9.576619
Epoch 1399 
Overall Loss: 10.538493
Rec Loss: 9.852360
KL Loss: 0.686134
Y Loss: 0.541080
T Loss: 9.581820
Epoch 1449 
Overall Loss: 10.520949
Rec Loss: 9.853400
KL Loss: 0.667550
Y Loss: 0.541175
T Loss: 9.582812
Epoch 1499 
Overall Loss: 10.527406
Rec Loss: 9.834233
KL Loss: 0.693172
Y Loss: 0.541931
T Loss: 9.563267
Epoch 1549 
Overall Loss: 10.569992
Rec Loss: 9.846259
KL Loss: 0.723733
Y Loss: 0.541801
T Loss: 9.575359
Epoch 1599 
Overall Loss: 10.520894
Rec Loss: 9.840425
KL Loss: 0.680469
Y Loss: 0.528872
T Loss: 9.575989
Epoch 1649 
Overall Loss: 10.526106
Rec Loss: 9.825503
KL Loss: 0.700603
Y Loss: 0.529811
T Loss: 9.560598
Epoch 1699 
Overall Loss: 10.509536
Rec Loss: 9.828600
KL Loss: 0.680936
Y Loss: 0.519198
T Loss: 9.569001
Epoch 1749 
Overall Loss: 10.507187
Rec Loss: 9.821600
KL Loss: 0.685587
Y Loss: 0.515439
T Loss: 9.563881
Epoch 1799 
Overall Loss: 10.498267
Rec Loss: 9.826872
KL Loss: 0.671395
Y Loss: 0.517416
T Loss: 9.568164
Epoch 1849 
Overall Loss: 10.507749
Rec Loss: 9.825931
KL Loss: 0.681818
Y Loss: 0.526056
T Loss: 9.562903
Epoch 1899 
Overall Loss: 10.493064
Rec Loss: 9.805274
KL Loss: 0.687791
Y Loss: 0.513610
T Loss: 9.548469
Epoch 1949 
Overall Loss: 10.503130
Rec Loss: 9.800861
KL Loss: 0.702269
Y Loss: 0.510681
T Loss: 9.545520
Epoch 1999 
Overall Loss: 10.489984
Rec Loss: 9.806516
KL Loss: 0.683468
Y Loss: 0.513182
T Loss: 9.549924
Epoch 2049 
Overall Loss: 10.502163
Rec Loss: 9.818050
KL Loss: 0.684113
Y Loss: 0.513509
T Loss: 9.561295
Epoch 2099 
Overall Loss: 10.491778
Rec Loss: 9.792554
KL Loss: 0.699225
Y Loss: 0.510751
T Loss: 9.537178
Epoch 2149 
Overall Loss: 10.492942
Rec Loss: 9.809112
KL Loss: 0.683830
Y Loss: 0.512436
T Loss: 9.552894
Epoch 2199 
Overall Loss: 10.492107
Rec Loss: 9.791455
KL Loss: 0.700652
Y Loss: 0.501576
T Loss: 9.540667
Epoch 2249 
Overall Loss: 10.491476
Rec Loss: 9.796324
KL Loss: 0.695151
Y Loss: 0.506653
T Loss: 9.542997
Epoch 2299 
Overall Loss: 10.470885
Rec Loss: 9.787047
KL Loss: 0.683838
Y Loss: 0.505797
T Loss: 9.534148
Epoch 2349 
Overall Loss: 10.502519
Rec Loss: 9.811568
KL Loss: 0.690951
Y Loss: 0.501126
T Loss: 9.561005
Epoch 2399 
Overall Loss: 10.493236
Rec Loss: 9.797240
KL Loss: 0.695995
Y Loss: 0.504627
T Loss: 9.544927
Epoch 2449 
Overall Loss: 10.469317
Rec Loss: 9.784174
KL Loss: 0.685143
Y Loss: 0.497052
T Loss: 9.535648
Epoch 2499 
Overall Loss: 10.459663
Rec Loss: 9.790469
KL Loss: 0.669195
Y Loss: 0.489084
T Loss: 9.545927
Epoch 2549 
Overall Loss: 10.461800
Rec Loss: 9.780572
KL Loss: 0.681228
Y Loss: 0.494219
T Loss: 9.533463
Epoch 2599 
Overall Loss: 10.482570
Rec Loss: 9.780726
KL Loss: 0.701844
Y Loss: 0.493813
T Loss: 9.533819
Epoch 2649 
Overall Loss: 10.464972
Rec Loss: 9.769380
KL Loss: 0.695592
Y Loss: 0.487286
T Loss: 9.525737
Epoch 2699 
Overall Loss: 10.451940
Rec Loss: 9.777334
KL Loss: 0.674605
Y Loss: 0.483788
T Loss: 9.535440
Epoch 2749 
Overall Loss: 10.455906
Rec Loss: 9.764916
KL Loss: 0.690990
Y Loss: 0.483385
T Loss: 9.523223
Epoch 2799 
Overall Loss: 10.440777
Rec Loss: 9.764263
KL Loss: 0.676514
Y Loss: 0.483537
T Loss: 9.522495
Epoch 2849 
Overall Loss: 10.463038
Rec Loss: 9.776820
KL Loss: 0.686218
Y Loss: 0.483035
T Loss: 9.535302
Epoch 2899 
Overall Loss: 10.468477
Rec Loss: 9.772906
KL Loss: 0.695571
Y Loss: 0.493397
T Loss: 9.526208
Epoch 2949 
Overall Loss: 10.449069
Rec Loss: 9.763858
KL Loss: 0.685211
Y Loss: 0.475583
T Loss: 9.526066
Epoch 2999 
Overall Loss: 10.464957
Rec Loss: 9.778628
KL Loss: 0.686328
Y Loss: 0.479339
T Loss: 9.538959
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.476010
Epoch 99
Rec Loss: 0.471674
Epoch 149
Rec Loss: 0.472235
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.184380
Epoch 99
Rec Loss: 10.166613
Epoch 149
Rec Loss: 10.163152
Epoch 199
Rec Loss: 10.168736
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.673125
Insample Error: 1.474669
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.987586
Epoch 99
Rec Loss: 3.977775
Epoch 149
Rec Loss: 3.973927
Epoch 199
Rec Loss: 3.981078
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 8.962195
Epoch 99
Rec Loss: 9.033156
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.761465
Insample Error 3.341172
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.043571
Epoch 99 
Prediction Loss: 0.752004
Epoch 149 
Prediction Loss: 0.672651
Epoch 199 
Prediction Loss: 0.635653
Epoch 249 
Prediction Loss: 0.616943
Epoch 299 
Prediction Loss: 0.601130
Epoch 349 
Prediction Loss: 0.601412
Epoch 399 
Prediction Loss: 0.580421
Epoch 449 
Prediction Loss: 0.570911
Epoch 499 
Prediction Loss: 0.570966
Epoch 549 
Prediction Loss: 0.564702
Epoch 599 
Prediction Loss: 0.558604
Epoch 649 
Prediction Loss: 0.546219
Epoch 699 
Prediction Loss: 0.543280
Epoch 749 
Prediction Loss: 0.539312
Epoch 799 
Prediction Loss: 0.535797
Epoch 849 
Prediction Loss: 0.537713
Epoch 899 
Prediction Loss: 0.528564
Epoch 949 
Prediction Loss: 0.529425
Epoch 999 
Prediction Loss: 0.524864
Epoch 1049 
Prediction Loss: 0.518365
Epoch 1099 
Prediction Loss: 0.522201
Epoch 1149 
Prediction Loss: 0.518431
Epoch 1199 
Prediction Loss: 0.510464
Epoch 1249 
Prediction Loss: 0.508413
Epoch 1299 
Prediction Loss: 0.505487
Epoch 1349 
Prediction Loss: 0.506462
Epoch 1399 
Prediction Loss: 0.502629
Epoch 1449 
Prediction Loss: 0.500946
Epoch 1499 
Prediction Loss: 0.496439
Epoch 1549 
Prediction Loss: 0.490534
Epoch 1599 
Prediction Loss: 0.495089
Epoch 1649 
Prediction Loss: 0.491285
Epoch 1699 
Prediction Loss: 0.485139
Epoch 1749 
Prediction Loss: 0.488403
Epoch 1799 
Prediction Loss: 0.480847
Epoch 1849 
Prediction Loss: 0.488880
Epoch 1899 
Prediction Loss: 0.476396
Epoch 1949 
Prediction Loss: 0.479896
Epoch 1999 
Prediction Loss: 0.473765
Epoch 2049 
Prediction Loss: 0.468605
Epoch 2099 
Prediction Loss: 0.464843
Epoch 2149 
Prediction Loss: 0.465044
Epoch 2199 
Prediction Loss: 0.459185
Epoch 2249 
Prediction Loss: 0.460448
Epoch 2299 
Prediction Loss: 0.458435
Epoch 2349 
Prediction Loss: 0.462907
Epoch 2399 
Prediction Loss: 0.463834
Epoch 2449 
Prediction Loss: 0.450564
Epoch 2499 
Prediction Loss: 0.448901
Epoch 2549 
Prediction Loss: 0.444249
Epoch 2599 
Prediction Loss: 0.457999
Epoch 2649 
Prediction Loss: 0.440601
Epoch 2699 
Prediction Loss: 0.442365
Epoch 2749 
Prediction Loss: 0.445632
Epoch 2799 
Prediction Loss: 0.448469
Epoch 2849 
Prediction Loss: 0.437457
Epoch 2899 
Prediction Loss: 0.443688
Epoch 2949 
Prediction Loss: 0.426283
Epoch 2999 
Prediction Loss: 0.427135
Epoch 3049 
Prediction Loss: 0.424785
Epoch 3099 
Prediction Loss: 0.420449
Epoch 3149 
Prediction Loss: 0.418612
Epoch 3199 
Prediction Loss: 0.417145
Epoch 3249 
Prediction Loss: 0.418438
Epoch 3299 
Prediction Loss: 0.410922
Epoch 3349 
Prediction Loss: 0.411804
Epoch 3399 
Prediction Loss: 0.407249
Epoch 3449 
Prediction Loss: 0.416466
Epoch 3499 
Prediction Loss: 0.410547
Epoch 3549 
Prediction Loss: 0.408125
Epoch 3599 
Prediction Loss: 0.398493
Epoch 3649 
Prediction Loss: 0.401023
Epoch 3699 
Prediction Loss: 0.402016
Epoch 3749 
Prediction Loss: 0.402174
Epoch 3799 
Prediction Loss: 0.396662
Epoch 3849 
Prediction Loss: 0.398470
Epoch 3899 
Prediction Loss: 0.399058
Epoch 3949 
Prediction Loss: 0.391645
Epoch 3999 
Prediction Loss: 0.385962
Epoch 4049 
Prediction Loss: 0.386368
Epoch 4099 
Prediction Loss: 0.383976
Epoch 4149 
Prediction Loss: 0.384736
Epoch 4199 
Prediction Loss: 0.381808
Epoch 4249 
Prediction Loss: 0.385206
Epoch 4299 
Prediction Loss: 0.381846
Epoch 4349 
Prediction Loss: 0.384877
Epoch 4399 
Prediction Loss: 0.378553
Epoch 4449 
Prediction Loss: 0.373140
Epoch 4499 
Prediction Loss: 0.369152
Epoch 4549 
Prediction Loss: 0.373710
Epoch 4599 
Prediction Loss: 0.373341
Epoch 4649 
Prediction Loss: 0.370299
Epoch 4699 
Prediction Loss: 0.365011
Epoch 4749 
Prediction Loss: 0.366029
Epoch 4799 
Prediction Loss: 0.368039
Epoch 4849 
Prediction Loss: 0.362483
Epoch 4899 
Prediction Loss: 0.363891
Epoch 4949 
Prediction Loss: 0.360514
Epoch 4999 
Prediction Loss: 0.361704
Epoch 5049 
Prediction Loss: 0.351511
Epoch 5099 
Prediction Loss: 0.366563
Epoch 5149 
Prediction Loss: 0.352578
Epoch 5199 
Prediction Loss: 0.350704
Epoch 5249 
Prediction Loss: 0.353514
Epoch 5299 
Prediction Loss: 0.347516
Epoch 5349 
Prediction Loss: 0.351232
Epoch 5399 
Prediction Loss: 0.351263
Epoch 5449 
Prediction Loss: 0.351343
Epoch 5499 
Prediction Loss: 0.342325
Epoch 5549 
Prediction Loss: 0.347724
Epoch 5599 
Prediction Loss: 0.350877
Epoch 5649 
Prediction Loss: 0.337381
Epoch 5699 
Prediction Loss: 0.339982
Epoch 5749 
Prediction Loss: 0.336028
Epoch 5799 
Prediction Loss: 0.341709
Epoch 5849 
Prediction Loss: 0.344752
Epoch 5899 
Prediction Loss: 0.334728
Epoch 5949 
Prediction Loss: 0.339630
Epoch 5999 
Prediction Loss: 0.334578
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.575939
Insample Error 1.667234
[31m========== repeat time 4 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.035590
Rec Loss: 10.082665
KL Loss: 0.952925
Y Loss: 0.956527
T Loss: 9.604402
Epoch 99 
Overall Loss: 10.771971
Rec Loss: 10.007303
KL Loss: 0.764667
Y Loss: 0.738996
T Loss: 9.637805
Epoch 149 
Overall Loss: 10.690619
Rec Loss: 9.973935
KL Loss: 0.716684
Y Loss: 0.670549
T Loss: 9.638661
Epoch 199 
Overall Loss: 10.650223
Rec Loss: 9.949139
KL Loss: 0.701084
Y Loss: 0.637019
T Loss: 9.630630
Epoch 249 
Overall Loss: 10.635559
Rec Loss: 9.912603
KL Loss: 0.722957
Y Loss: 0.609868
T Loss: 9.607669
Epoch 299 
Overall Loss: 10.615312
Rec Loss: 9.915322
KL Loss: 0.699989
Y Loss: 0.597115
T Loss: 9.616765
Epoch 349 
Overall Loss: 10.603974
Rec Loss: 9.901528
KL Loss: 0.702447
Y Loss: 0.589340
T Loss: 9.606858
Epoch 399 
Overall Loss: 10.595972
Rec Loss: 9.903544
KL Loss: 0.692429
Y Loss: 0.576211
T Loss: 9.615438
Epoch 449 
Overall Loss: 10.590853
Rec Loss: 9.900533
KL Loss: 0.690320
Y Loss: 0.569351
T Loss: 9.615857
Epoch 499 
Overall Loss: 10.571698
Rec Loss: 9.877733
KL Loss: 0.693965
Y Loss: 0.569109
T Loss: 9.593179
Epoch 549 
Overall Loss: 10.579260
Rec Loss: 9.890936
KL Loss: 0.688325
Y Loss: 0.564777
T Loss: 9.608547
Epoch 599 
Overall Loss: 10.574229
Rec Loss: 9.889200
KL Loss: 0.685030
Y Loss: 0.562449
T Loss: 9.607975
Epoch 649 
Overall Loss: 10.558951
Rec Loss: 9.870031
KL Loss: 0.688919
Y Loss: 0.556983
T Loss: 9.591540
Epoch 699 
Overall Loss: 10.552952
Rec Loss: 9.873811
KL Loss: 0.679141
Y Loss: 0.558009
T Loss: 9.594807
Epoch 749 
Overall Loss: 10.555559
Rec Loss: 9.866387
KL Loss: 0.689172
Y Loss: 0.543670
T Loss: 9.594552
Epoch 799 
Overall Loss: 10.559402
Rec Loss: 9.865710
KL Loss: 0.693692
Y Loss: 0.537182
T Loss: 9.597118
Epoch 849 
Overall Loss: 10.550170
Rec Loss: 9.849609
KL Loss: 0.700560
Y Loss: 0.530990
T Loss: 9.584114
Epoch 899 
Overall Loss: 10.557188
Rec Loss: 9.864144
KL Loss: 0.693043
Y Loss: 0.537479
T Loss: 9.595405
Epoch 949 
Overall Loss: 10.539427
Rec Loss: 9.844385
KL Loss: 0.695042
Y Loss: 0.537111
T Loss: 9.575830
Epoch 999 
Overall Loss: 10.521187
Rec Loss: 9.853641
KL Loss: 0.667546
Y Loss: 0.528799
T Loss: 9.589241
Epoch 1049 
Overall Loss: 10.543550
Rec Loss: 9.846586
KL Loss: 0.696964
Y Loss: 0.537604
T Loss: 9.577784
Epoch 1099 
Overall Loss: 10.521358
Rec Loss: 9.839978
KL Loss: 0.681381
Y Loss: 0.528706
T Loss: 9.575624
Epoch 1149 
Overall Loss: 10.536141
Rec Loss: 9.843919
KL Loss: 0.692222
Y Loss: 0.526241
T Loss: 9.580798
Epoch 1199 
Overall Loss: 10.511196
Rec Loss: 9.826872
KL Loss: 0.684324
Y Loss: 0.524973
T Loss: 9.564385
Epoch 1249 
Overall Loss: 10.525915
Rec Loss: 9.822028
KL Loss: 0.703888
Y Loss: 0.521971
T Loss: 9.561042
Epoch 1299 
Overall Loss: 10.522208
Rec Loss: 9.827627
KL Loss: 0.694581
Y Loss: 0.517697
T Loss: 9.568778
Epoch 1349 
Overall Loss: 10.519398
Rec Loss: 9.826110
KL Loss: 0.693289
Y Loss: 0.511217
T Loss: 9.570501
Epoch 1399 
Overall Loss: 10.558864
Rec Loss: 9.837325
KL Loss: 0.721539
Y Loss: 0.510557
T Loss: 9.582047
Epoch 1449 
Overall Loss: 10.504410
Rec Loss: 9.827259
KL Loss: 0.677150
Y Loss: 0.514330
T Loss: 9.570094
Epoch 1499 
Overall Loss: 10.527698
Rec Loss: 9.842648
KL Loss: 0.685049
Y Loss: 0.512278
T Loss: 9.586510
Epoch 1549 
Overall Loss: 10.487417
Rec Loss: 9.804386
KL Loss: 0.683031
Y Loss: 0.512325
T Loss: 9.548224
Epoch 1599 
Overall Loss: 10.498213
Rec Loss: 9.799623
KL Loss: 0.698589
Y Loss: 0.511815
T Loss: 9.543716
Epoch 1649 
Overall Loss: 10.494345
Rec Loss: 9.799251
KL Loss: 0.695094
Y Loss: 0.493796
T Loss: 9.552353
Epoch 1699 
Overall Loss: 10.503869
Rec Loss: 9.819004
KL Loss: 0.684866
Y Loss: 0.504600
T Loss: 9.566704
Epoch 1749 
Overall Loss: 10.487989
Rec Loss: 9.809503
KL Loss: 0.678486
Y Loss: 0.494800
T Loss: 9.562103
Epoch 1799 
Overall Loss: 10.508906
Rec Loss: 9.809376
KL Loss: 0.699530
Y Loss: 0.498045
T Loss: 9.560353
Epoch 1849 
Overall Loss: 10.485852
Rec Loss: 9.801870
KL Loss: 0.683982
Y Loss: 0.498761
T Loss: 9.552490
Epoch 1899 
Overall Loss: 10.491025
Rec Loss: 9.787668
KL Loss: 0.703357
Y Loss: 0.497021
T Loss: 9.539158
Epoch 1949 
Overall Loss: 10.490213
Rec Loss: 9.789878
KL Loss: 0.700335
Y Loss: 0.494986
T Loss: 9.542385
Epoch 1999 
Overall Loss: 10.475035
Rec Loss: 9.793669
KL Loss: 0.681366
Y Loss: 0.491709
T Loss: 9.547815
Epoch 2049 
Overall Loss: 10.481638
Rec Loss: 9.795181
KL Loss: 0.686457
Y Loss: 0.496274
T Loss: 9.547044
Epoch 2099 
Overall Loss: 10.476240
Rec Loss: 9.780907
KL Loss: 0.695332
Y Loss: 0.485565
T Loss: 9.538125
Epoch 2149 
Overall Loss: 10.475754
Rec Loss: 9.780406
KL Loss: 0.695348
Y Loss: 0.492618
T Loss: 9.534097
Epoch 2199 
Overall Loss: 10.462388
Rec Loss: 9.763040
KL Loss: 0.699348
Y Loss: 0.488869
T Loss: 9.518606
Epoch 2249 
Overall Loss: 10.472424
Rec Loss: 9.787332
KL Loss: 0.685092
Y Loss: 0.485848
T Loss: 9.544408
Epoch 2299 
Overall Loss: 10.471548
Rec Loss: 9.775665
KL Loss: 0.695884
Y Loss: 0.481588
T Loss: 9.534871
Epoch 2349 
Overall Loss: 10.466810
Rec Loss: 9.772075
KL Loss: 0.694735
Y Loss: 0.487698
T Loss: 9.528226
Epoch 2399 
Overall Loss: 10.470155
Rec Loss: 9.770551
KL Loss: 0.699603
Y Loss: 0.475548
T Loss: 9.532777
Epoch 2449 
Overall Loss: 10.476270
Rec Loss: 9.779251
KL Loss: 0.697018
Y Loss: 0.472046
T Loss: 9.543228
Epoch 2499 
Overall Loss: 10.470404
Rec Loss: 9.776724
KL Loss: 0.693680
Y Loss: 0.481027
T Loss: 9.536211
Epoch 2549 
Overall Loss: 10.467960
Rec Loss: 9.772536
KL Loss: 0.695424
Y Loss: 0.478660
T Loss: 9.533206
Epoch 2599 
Overall Loss: 10.452063
Rec Loss: 9.759436
KL Loss: 0.692628
Y Loss: 0.469567
T Loss: 9.524652
Epoch 2649 
Overall Loss: 10.444529
Rec Loss: 9.755754
KL Loss: 0.688775
Y Loss: 0.479382
T Loss: 9.516063
Epoch 2699 
Overall Loss: 10.446949
Rec Loss: 9.760913
KL Loss: 0.686036
Y Loss: 0.475918
T Loss: 9.522954
Epoch 2749 
Overall Loss: 10.459659
Rec Loss: 9.773677
KL Loss: 0.685982
Y Loss: 0.465152
T Loss: 9.541101
Epoch 2799 
Overall Loss: 10.431423
Rec Loss: 9.746102
KL Loss: 0.685320
Y Loss: 0.464090
T Loss: 9.514058
Epoch 2849 
Overall Loss: 10.447506
Rec Loss: 9.749592
KL Loss: 0.697914
Y Loss: 0.468169
T Loss: 9.515508
Epoch 2899 
Overall Loss: 10.438297
Rec Loss: 9.747137
KL Loss: 0.691160
Y Loss: 0.465142
T Loss: 9.514566
Epoch 2949 
Overall Loss: 10.445560
Rec Loss: 9.753238
KL Loss: 0.692322
Y Loss: 0.474373
T Loss: 9.516051
Epoch 2999 
Overall Loss: 10.437119
Rec Loss: 9.748426
KL Loss: 0.688694
Y Loss: 0.466418
T Loss: 9.515217
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.471066
Epoch 99
Rec Loss: 0.470524
Epoch 149
Rec Loss: 0.462378
Epoch 199
Rec Loss: 0.468072
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.186691
Epoch 99
Rec Loss: 10.182703
Epoch 149
Rec Loss: 10.172399
Epoch 199
Rec Loss: 10.173277
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.655025
Insample Error: 1.516376
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 4.002682
Epoch 99
Rec Loss: 3.999521
Epoch 149
Rec Loss: 3.996892
Epoch 199
Rec Loss: 3.996058
Epoch 249
Rec Loss: 4.000793
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.033304
Epoch 99
Rec Loss: 10.030446
Epoch 149
Rec Loss: 10.015108
Epoch 199
Rec Loss: 9.997941
Epoch 249
Rec Loss: 10.008720
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.794623
Insample Error 3.347295
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.978907
Epoch 99 
Prediction Loss: 0.702397
Epoch 149 
Prediction Loss: 0.664168
Epoch 199 
Prediction Loss: 0.635824
Epoch 249 
Prediction Loss: 0.624748
Epoch 299 
Prediction Loss: 0.617177
Epoch 349 
Prediction Loss: 0.607646
Epoch 399 
Prediction Loss: 0.595996
Epoch 449 
Prediction Loss: 0.595876
Epoch 499 
Prediction Loss: 0.578927
Epoch 549 
Prediction Loss: 0.582059
Epoch 599 
Prediction Loss: 0.583235
Epoch 649 
Prediction Loss: 0.583857
Epoch 699 
Prediction Loss: 0.571602
Epoch 749 
Prediction Loss: 0.566421
Epoch 799 
Prediction Loss: 0.570848
Epoch 849 
Prediction Loss: 0.561089
Epoch 899 
Prediction Loss: 0.567660
Epoch 949 
Prediction Loss: 0.561868
Epoch 999 
Prediction Loss: 0.558471
Epoch 1049 
Prediction Loss: 0.554128
Epoch 1099 
Prediction Loss: 0.552300
Epoch 1149 
Prediction Loss: 0.555242
Epoch 1199 
Prediction Loss: 0.550432
Epoch 1249 
Prediction Loss: 0.546471
Epoch 1299 
Prediction Loss: 0.546764
Epoch 1349 
Prediction Loss: 0.543895
Epoch 1399 
Prediction Loss: 0.542648
Epoch 1449 
Prediction Loss: 0.542618
Epoch 1499 
Prediction Loss: 0.559319
Epoch 1549 
Prediction Loss: 0.543729
Epoch 1599 
Prediction Loss: 0.547221
Epoch 1649 
Prediction Loss: 0.539485
Epoch 1699 
Prediction Loss: 0.558043
Epoch 1749 
Prediction Loss: 0.536932
Epoch 1799 
Prediction Loss: 0.537331
Epoch 1849 
Prediction Loss: 0.530578
Epoch 1899 
Prediction Loss: 0.529624
Epoch 1949 
Prediction Loss: 0.532849
Epoch 1999 
Prediction Loss: 0.525051
Epoch 2049 
Prediction Loss: 0.525990
Epoch 2099 
Prediction Loss: 0.527521
Epoch 2149 
Prediction Loss: 0.525004
Epoch 2199 
Prediction Loss: 0.531025
Epoch 2249 
Prediction Loss: 0.534857
Epoch 2299 
Prediction Loss: 0.537675
Epoch 2349 
Prediction Loss: 0.530183
Epoch 2399 
Prediction Loss: 0.525096
Epoch 2449 
Prediction Loss: 0.525544
Epoch 2499 
Prediction Loss: 0.517079
Epoch 2549 
Prediction Loss: 0.520019
Epoch 2599 
Prediction Loss: 0.521687
Epoch 2649 
Prediction Loss: 0.521319
Epoch 2699 
Prediction Loss: 0.515082
Epoch 2749 
Prediction Loss: 0.520544
Epoch 2799 
Prediction Loss: 0.509994
Epoch 2849 
Prediction Loss: 0.514873
Epoch 2899 
Prediction Loss: 0.524008
Epoch 2949 
Prediction Loss: 0.509983
Epoch 2999 
Prediction Loss: 0.529830
Epoch 3049 
Prediction Loss: 0.511098
Epoch 3099 
Prediction Loss: 0.508021
Epoch 3149 
Prediction Loss: 0.530923
Epoch 3199 
Prediction Loss: 0.505810
Epoch 3249 
Prediction Loss: 0.519834
Epoch 3299 
Prediction Loss: 0.505995
Epoch 3349 
Prediction Loss: 0.528842
Epoch 3399 
Prediction Loss: 0.517864
Epoch 3449 
Prediction Loss: 0.500986
Epoch 3499 
Prediction Loss: 0.505505
Epoch 3549 
Prediction Loss: 0.502888
Epoch 3599 
Prediction Loss: 0.506759
Epoch 3649 
Prediction Loss: 0.497244
Epoch 3699 
Prediction Loss: 0.504421
Epoch 3749 
Prediction Loss: 0.500321
Epoch 3799 
Prediction Loss: 0.504274
Epoch 3849 
Prediction Loss: 0.505830
Epoch 3899 
Prediction Loss: 0.506666
Epoch 3949 
Prediction Loss: 0.497303
Epoch 3999 
Prediction Loss: 0.496500
Epoch 4049 
Prediction Loss: 0.496821
Epoch 4099 
Prediction Loss: 0.501011
Epoch 4149 
Prediction Loss: 0.500526
Epoch 4199 
Prediction Loss: 0.495039
Epoch 4249 
Prediction Loss: 0.504727
Epoch 4299 
Prediction Loss: 0.493433
Epoch 4349 
Prediction Loss: 0.491448
Epoch 4399 
Prediction Loss: 0.495877
Epoch 4449 
Prediction Loss: 0.489664
Epoch 4499 
Prediction Loss: 0.500679
Epoch 4549 
Prediction Loss: 0.489897
Epoch 4599 
Prediction Loss: 0.491638
Epoch 4649 
Prediction Loss: 0.490321
Epoch 4699 
Prediction Loss: 0.494836
Epoch 4749 
Prediction Loss: 0.482511
Epoch 4799 
Prediction Loss: 0.485907
Epoch 4849 
Prediction Loss: 0.498192
Epoch 4899 
Prediction Loss: 0.484744
Epoch 4949 
Prediction Loss: 0.492518
Epoch 4999 
Prediction Loss: 0.483707
Epoch 5049 
Prediction Loss: 0.483050
Epoch 5099 
Prediction Loss: 0.480260
Epoch 5149 
Prediction Loss: 0.477973
Epoch 5199 
Prediction Loss: 0.481726
Epoch 5249 
Prediction Loss: 0.480800
Epoch 5299 
Prediction Loss: 0.487800
Epoch 5349 
Prediction Loss: 0.479894
Epoch 5399 
Prediction Loss: 0.488238
Epoch 5449 
Prediction Loss: 0.482548
Epoch 5499 
Prediction Loss: 0.475459
Epoch 5549 
Prediction Loss: 0.477639
Epoch 5599 
Prediction Loss: 0.479677
Epoch 5649 
Prediction Loss: 0.470296
Epoch 5699 
Prediction Loss: 0.474568
Epoch 5749 
Prediction Loss: 0.487872
Epoch 5799 
Prediction Loss: 0.479447
Epoch 5849 
Prediction Loss: 0.475125
Epoch 5899 
Prediction Loss: 0.469500
Epoch 5949 
Prediction Loss: 0.470859
Epoch 5999 
Prediction Loss: 0.473533
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.683470
Insample Error 1.612908
[31m========== repeat time 5 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.981777
Rec Loss: 10.060440
KL Loss: 0.921337
Y Loss: 0.926373
T Loss: 9.597253
Epoch 99 
Overall Loss: 10.754845
Rec Loss: 9.992086
KL Loss: 0.762759
Y Loss: 0.707417
T Loss: 9.638377
Epoch 149 
Overall Loss: 10.688566
Rec Loss: 9.953932
KL Loss: 0.734634
Y Loss: 0.637142
T Loss: 9.635361
Epoch 199 
Overall Loss: 10.662677
Rec Loss: 9.929444
KL Loss: 0.733233
Y Loss: 0.605352
T Loss: 9.626768
Epoch 249 
Overall Loss: 10.637038
Rec Loss: 9.910105
KL Loss: 0.726933
Y Loss: 0.585877
T Loss: 9.617166
Epoch 299 
Overall Loss: 10.617148
Rec Loss: 9.895243
KL Loss: 0.721905
Y Loss: 0.576776
T Loss: 9.606855
Epoch 349 
Overall Loss: 10.606102
Rec Loss: 9.894406
KL Loss: 0.711696
Y Loss: 0.559685
T Loss: 9.614564
Epoch 399 
Overall Loss: 10.589577
Rec Loss: 9.866762
KL Loss: 0.722815
Y Loss: 0.543254
T Loss: 9.595135
Epoch 449 
Overall Loss: 10.596586
Rec Loss: 9.893480
KL Loss: 0.703106
Y Loss: 0.548675
T Loss: 9.619142
Epoch 499 
Overall Loss: 10.584764
Rec Loss: 9.877198
KL Loss: 0.707566
Y Loss: 0.533200
T Loss: 9.610598
Epoch 549 
Overall Loss: 10.585360
Rec Loss: 9.867486
KL Loss: 0.717874
Y Loss: 0.539700
T Loss: 9.597636
Epoch 599 
Overall Loss: 10.561041
Rec Loss: 9.869908
KL Loss: 0.691133
Y Loss: 0.525530
T Loss: 9.607143
Epoch 649 
Overall Loss: 10.569414
Rec Loss: 9.865488
KL Loss: 0.703927
Y Loss: 0.532318
T Loss: 9.599329
Epoch 699 
Overall Loss: 10.554978
Rec Loss: 9.858415
KL Loss: 0.696563
Y Loss: 0.532134
T Loss: 9.592348
Epoch 749 
Overall Loss: 10.553285
Rec Loss: 9.861395
KL Loss: 0.691890
Y Loss: 0.531395
T Loss: 9.595698
Epoch 799 
Overall Loss: 10.559495
Rec Loss: 9.856361
KL Loss: 0.703134
Y Loss: 0.520903
T Loss: 9.595909
Epoch 849 
Overall Loss: 10.546533
Rec Loss: 9.841658
KL Loss: 0.704875
Y Loss: 0.514659
T Loss: 9.584328
Epoch 899 
Overall Loss: 10.546271
Rec Loss: 9.841240
KL Loss: 0.705031
Y Loss: 0.517208
T Loss: 9.582635
Epoch 949 
Overall Loss: 10.547533
Rec Loss: 9.841901
KL Loss: 0.705631
Y Loss: 0.505573
T Loss: 9.589115
Epoch 999 
Overall Loss: 10.540673
Rec Loss: 9.828881
KL Loss: 0.711791
Y Loss: 0.506673
T Loss: 9.575545
Epoch 1049 
Overall Loss: 10.521587
Rec Loss: 9.822603
KL Loss: 0.698983
Y Loss: 0.505661
T Loss: 9.569772
Epoch 1099 
Overall Loss: 10.530432
Rec Loss: 9.825012
KL Loss: 0.705419
Y Loss: 0.501081
T Loss: 9.574472
Epoch 1149 
Overall Loss: 10.528309
Rec Loss: 9.838064
KL Loss: 0.690245
Y Loss: 0.503275
T Loss: 9.586426
Epoch 1199 
Overall Loss: 10.528356
Rec Loss: 9.822443
KL Loss: 0.705913
Y Loss: 0.501203
T Loss: 9.571840
Epoch 1249 
Overall Loss: 10.531772
Rec Loss: 9.823128
KL Loss: 0.708644
Y Loss: 0.498286
T Loss: 9.573985
Epoch 1299 
Overall Loss: 10.528568
Rec Loss: 9.820530
KL Loss: 0.708037
Y Loss: 0.498088
T Loss: 9.571486
Epoch 1349 
Overall Loss: 10.524673
Rec Loss: 9.826177
KL Loss: 0.698496
Y Loss: 0.489700
T Loss: 9.581327
Epoch 1399 
Overall Loss: 10.517122
Rec Loss: 9.812018
KL Loss: 0.705103
Y Loss: 0.498185
T Loss: 9.562926
Epoch 1449 
Overall Loss: 10.518577
Rec Loss: 9.814428
KL Loss: 0.704148
Y Loss: 0.497952
T Loss: 9.565452
Epoch 1499 
Overall Loss: 10.506483
Rec Loss: 9.803309
KL Loss: 0.703173
Y Loss: 0.491541
T Loss: 9.557539
Epoch 1549 
Overall Loss: 10.511077
Rec Loss: 9.804109
KL Loss: 0.706968
Y Loss: 0.501328
T Loss: 9.553445
Epoch 1599 
Overall Loss: 10.500934
Rec Loss: 9.796312
KL Loss: 0.704622
Y Loss: 0.483399
T Loss: 9.554612
Epoch 1649 
Overall Loss: 10.508937
Rec Loss: 9.790932
KL Loss: 0.718005
Y Loss: 0.478847
T Loss: 9.551509
Epoch 1699 
Overall Loss: 10.494534
Rec Loss: 9.788392
KL Loss: 0.706142
Y Loss: 0.487142
T Loss: 9.544821
Epoch 1749 
Overall Loss: 10.505914
Rec Loss: 9.805464
KL Loss: 0.700450
Y Loss: 0.487538
T Loss: 9.561695
Epoch 1799 
Overall Loss: 10.511670
Rec Loss: 9.800858
KL Loss: 0.710812
Y Loss: 0.489822
T Loss: 9.555947
Epoch 1849 
Overall Loss: 10.491590
Rec Loss: 9.783378
KL Loss: 0.708213
Y Loss: 0.477031
T Loss: 9.544862
Epoch 1899 
Overall Loss: 10.493303
Rec Loss: 9.788510
KL Loss: 0.704792
Y Loss: 0.478053
T Loss: 9.549484
Epoch 1949 
Overall Loss: 10.502105
Rec Loss: 9.794312
KL Loss: 0.707792
Y Loss: 0.488096
T Loss: 9.550264
Epoch 1999 
Overall Loss: 10.485674
Rec Loss: 9.788163
KL Loss: 0.697512
Y Loss: 0.473869
T Loss: 9.551228
Epoch 2049 
Overall Loss: 10.495306
Rec Loss: 9.789787
KL Loss: 0.705519
Y Loss: 0.482323
T Loss: 9.548626
Epoch 2099 
Overall Loss: 10.474500
Rec Loss: 9.765795
KL Loss: 0.708705
Y Loss: 0.466799
T Loss: 9.532395
Epoch 2149 
Overall Loss: 10.488350
Rec Loss: 9.786668
KL Loss: 0.701682
Y Loss: 0.477824
T Loss: 9.547755
Epoch 2199 
Overall Loss: 10.476059
Rec Loss: 9.775022
KL Loss: 0.701036
Y Loss: 0.473436
T Loss: 9.538304
Epoch 2249 
Overall Loss: 10.483762
Rec Loss: 9.791752
KL Loss: 0.692010
Y Loss: 0.487983
T Loss: 9.547761
Epoch 2299 
Overall Loss: 10.479198
Rec Loss: 9.782371
KL Loss: 0.696826
Y Loss: 0.479211
T Loss: 9.542766
Epoch 2349 
Overall Loss: 10.470329
Rec Loss: 9.759439
KL Loss: 0.710890
Y Loss: 0.472260
T Loss: 9.523309
Epoch 2399 
Overall Loss: 10.478370
Rec Loss: 9.772924
KL Loss: 0.705446
Y Loss: 0.476415
T Loss: 9.534717
Epoch 2449 
Overall Loss: 10.473773
Rec Loss: 9.779195
KL Loss: 0.694578
Y Loss: 0.469575
T Loss: 9.544408
Epoch 2499 
Overall Loss: 10.470287
Rec Loss: 9.750354
KL Loss: 0.719934
Y Loss: 0.467056
T Loss: 9.516825
Epoch 2549 
Overall Loss: 10.463210
Rec Loss: 9.769394
KL Loss: 0.693816
Y Loss: 0.465519
T Loss: 9.536634
Epoch 2599 
Overall Loss: 10.467890
Rec Loss: 9.757949
KL Loss: 0.709941
Y Loss: 0.465394
T Loss: 9.525252
Epoch 2649 
Overall Loss: 10.474939
Rec Loss: 9.758513
KL Loss: 0.716426
Y Loss: 0.472592
T Loss: 9.522217
Epoch 2699 
Overall Loss: 10.460086
Rec Loss: 9.754735
KL Loss: 0.705352
Y Loss: 0.463601
T Loss: 9.522934
Epoch 2749 
Overall Loss: 10.446195
Rec Loss: 9.757032
KL Loss: 0.689162
Y Loss: 0.461181
T Loss: 9.526442
Epoch 2799 
Overall Loss: 10.449395
Rec Loss: 9.754477
KL Loss: 0.694918
Y Loss: 0.461675
T Loss: 9.523639
Epoch 2849 
Overall Loss: 10.451424
Rec Loss: 9.756482
KL Loss: 0.694943
Y Loss: 0.462469
T Loss: 9.525247
Epoch 2899 
Overall Loss: 10.449932
Rec Loss: 9.741280
KL Loss: 0.708653
Y Loss: 0.456536
T Loss: 9.513012
Epoch 2949 
Overall Loss: 10.451942
Rec Loss: 9.750435
KL Loss: 0.701508
Y Loss: 0.456320
T Loss: 9.522274
Epoch 2999 
Overall Loss: 10.443811
Rec Loss: 9.746671
KL Loss: 0.697140
Y Loss: 0.452116
T Loss: 9.520612
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.463383
Epoch 99
Rec Loss: 0.460588
Epoch 149
Rec Loss: 0.455008
Epoch 199
Rec Loss: 0.450846
Epoch 249
Rec Loss: 0.450053
Epoch 299
Rec Loss: 0.456439
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.193965
Epoch 99
Rec Loss: 10.170517
Epoch 149
Rec Loss: 10.159319
Epoch 199
Rec Loss: 10.150847
Epoch 249
Rec Loss: 10.142505
Epoch 299
Rec Loss: 10.142981
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.638943
Insample Error: 1.433051
[34m== CEVAE: Training all ==[0m
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 3.980939
Epoch 99
Rec Loss: 3.983549
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 8.733316
Epoch 99
Rec Loss: 8.410346
Epoch 149
Rec Loss: 8.538340
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 3.757708
Insample Error 3.354174
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.977459
Epoch 99 
Prediction Loss: 0.717126
Epoch 149 
Prediction Loss: 0.671727
Epoch 199 
Prediction Loss: 0.647838
Epoch 249 
Prediction Loss: 0.635354
Epoch 299 
Prediction Loss: 0.628735
Epoch 349 
Prediction Loss: 0.611677
Epoch 399 
Prediction Loss: 0.599009
Epoch 449 
Prediction Loss: 0.590459
Epoch 499 
Prediction Loss: 0.588304
Epoch 549 
Prediction Loss: 0.578578
Epoch 599 
Prediction Loss: 0.583798
Epoch 649 
Prediction Loss: 0.576971
Epoch 699 
Prediction Loss: 0.571654
Epoch 749 
Prediction Loss: 0.563387
Epoch 799 
Prediction Loss: 0.569875
Epoch 849 
Prediction Loss: 0.566531
Epoch 899 
Prediction Loss: 0.559811
Epoch 949 
Prediction Loss: 0.554564
Epoch 999 
Prediction Loss: 0.550970
Epoch 1049 
Prediction Loss: 0.550550
Epoch 1099 
Prediction Loss: 0.562091
Epoch 1149 
Prediction Loss: 0.548149
Epoch 1199 
Prediction Loss: 0.549518
Epoch 1249 
Prediction Loss: 0.545361
Epoch 1299 
Prediction Loss: 0.549065
Epoch 1349 
Prediction Loss: 0.540356
Epoch 1399 
Prediction Loss: 0.542315
Epoch 1449 
Prediction Loss: 0.549827
Epoch 1499 
Prediction Loss: 0.541014
Epoch 1549 
Prediction Loss: 0.536748
Epoch 1599 
Prediction Loss: 0.531695
Epoch 1649 
Prediction Loss: 0.534357
Epoch 1699 
Prediction Loss: 0.530003
Epoch 1749 
Prediction Loss: 0.533166
Epoch 1799 
Prediction Loss: 0.529484
Epoch 1849 
Prediction Loss: 0.527393
Epoch 1899 
Prediction Loss: 0.519728
Epoch 1949 
Prediction Loss: 0.524712
Epoch 1999 
Prediction Loss: 0.515387
Epoch 2049 
Prediction Loss: 0.520706
Epoch 2099 
Prediction Loss: 0.519475
Epoch 2149 
Prediction Loss: 0.516088
Epoch 2199 
Prediction Loss: 0.519065
Epoch 2249 
Prediction Loss: 0.516968
Epoch 2299 
Prediction Loss: 0.521553
Epoch 2349 
Prediction Loss: 0.505712
Epoch 2399 
Prediction Loss: 0.506599
Epoch 2449 
Prediction Loss: 0.509313
Epoch 2499 
Prediction Loss: 0.504600
Epoch 2549 
Prediction Loss: 0.508113
Epoch 2599 
Prediction Loss: 0.498822
Epoch 2649 
Prediction Loss: 0.497851
Epoch 2699 
Prediction Loss: 0.503617
Epoch 2749 
Prediction Loss: 0.497571
Epoch 2799 
Prediction Loss: 0.498703
Epoch 2849 
Prediction Loss: 0.493051
Epoch 2899 
Prediction Loss: 0.487284
Epoch 2949 
Prediction Loss: 0.495089
Epoch 2999 
Prediction Loss: 0.486052
Epoch 3049 
Prediction Loss: 0.485807
Epoch 3099 
Prediction Loss: 0.483403
Epoch 3149 
Prediction Loss: 0.483606
Epoch 3199 
Prediction Loss: 0.489467
Epoch 3249 
Prediction Loss: 0.477080
Epoch 3299 
Prediction Loss: 0.475592
Epoch 3349 
Prediction Loss: 0.476108
Epoch 3399 
Prediction Loss: 0.474461
Epoch 3449 
Prediction Loss: 0.470156
Epoch 3499 
Prediction Loss: 0.484269
Epoch 3549 
Prediction Loss: 0.467555
Epoch 3599 
Prediction Loss: 0.464518
Epoch 3649 
Prediction Loss: 0.465222
Epoch 3699 
Prediction Loss: 0.464827
Epoch 3749 
Prediction Loss: 0.461481
Epoch 3799 
Prediction Loss: 0.462003
Epoch 3849 
Prediction Loss: 0.457973
Epoch 3899 
Prediction Loss: 0.461265
Epoch 3949 
Prediction Loss: 0.454530
Epoch 3999 
Prediction Loss: 0.458687
Epoch 4049 
Prediction Loss: 0.451382
Epoch 4099 
Prediction Loss: 0.451316
Epoch 4149 
Prediction Loss: 0.447837
Epoch 4199 
Prediction Loss: 0.443081
Epoch 4249 
Prediction Loss: 0.443544
Epoch 4299 
Prediction Loss: 0.445040
Epoch 4349 
Prediction Loss: 0.442692
Epoch 4399 
Prediction Loss: 0.448441
Epoch 4449 
Prediction Loss: 0.443556
Epoch 4499 
Prediction Loss: 0.445478
Epoch 4549 
Prediction Loss: 0.439218
Epoch 4599 
Prediction Loss: 0.436988
Epoch 4649 
Prediction Loss: 0.432174
Epoch 4699 
Prediction Loss: 0.435367
Epoch 4749 
Prediction Loss: 0.438841
Epoch 4799 
Prediction Loss: 0.427089
Epoch 4849 
Prediction Loss: 0.428863
Epoch 4899 
Prediction Loss: 0.432972
Epoch 4949 
Prediction Loss: 0.422226
Epoch 4999 
Prediction Loss: 0.423192
Epoch 5049 
Prediction Loss: 0.424395
Epoch 5099 
Prediction Loss: 0.426769
Epoch 5149 
Prediction Loss: 0.418951
Epoch 5199 
Prediction Loss: 0.412119
Epoch 5249 
Prediction Loss: 0.423434
Epoch 5299 
Prediction Loss: 0.421735
Epoch 5349 
Prediction Loss: 0.419227
Epoch 5399 
Prediction Loss: 0.420178
Epoch 5449 
Prediction Loss: 0.410138
Epoch 5499 
Prediction Loss: 0.414087
Epoch 5549 
Prediction Loss: 0.406965
Epoch 5599 
Prediction Loss: 0.420340
Epoch 5649 
Prediction Loss: 0.405127
Epoch 5699 
Prediction Loss: 0.397535
Epoch 5749 
Prediction Loss: 0.409779
Epoch 5799 
Prediction Loss: 0.395996
Epoch 5849 
Prediction Loss: 0.390584
Epoch 5899 
Prediction Loss: 0.395872
Epoch 5949 
Prediction Loss: 0.388878
Epoch 5999 
Prediction Loss: 0.387358
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.623117
Insample Error 1.584092
Ours, Train RMSE
0.6323, 
0.6309, 
0.6731, 
0.6550, 
0.6389, 
CEVAE, Train RMSE
3.8009, 
3.7851, 
3.7615, 
3.7946, 
3.7577, 
Ours, Insample RMSE
1.4380, 
1.4889, 
1.4747, 
1.5164, 
1.4331, 
CEVAE, Insample RMSE
3.3351, 
3.3422, 
3.3412, 
3.3473, 
3.3542, 
Direct Regression, Insample RMSE
1.6086, 
1.6323, 
1.6672, 
1.6129, 
1.5841, 
Train, RMSE mean 0.6461 std 0.0160
CEVAE, RMSE mean 3.7800 std 0.0174
Ours, RMSE mean 1.4702 std 0.0314, reconstruct confounder 0.4568 (0.0115) noise 10.1692 (0.0164)
CEVAE, RMSE mean 3.3440 std 0.0064, reconstruct confounder 3.9874 (0.0115) noise 9.1729 (0.5287)
Direct Regression, RMSE mean 1.6210 std 0.0277
Experiment Start!
Namespace(cevaelr=5e-05, decay=0.0, l=0.001, latdim=4, mask=0, nlayer=50, obsm=3, stop=2000, ycof=0.5, ylayer=50)
Y Mean 1.776465, Std 3.501489 
Test Y Mean -0.006496, Std 3.341313 
Observe confounder 3, Noise 10 dimension
Learning Rate 0.001000
[31m========== repeat time 1 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.042930
Rec Loss: 9.976747
KL Loss: 1.066184
Y Loss: 0.836735
T Loss: 9.558379
Epoch 99 
Overall Loss: 10.786207
Rec Loss: 9.976782
KL Loss: 0.809425
Y Loss: 0.692830
T Loss: 9.630368
Epoch 149 
Overall Loss: 10.691272
Rec Loss: 9.935269
KL Loss: 0.756002
Y Loss: 0.641280
T Loss: 9.614629
Epoch 199 
Overall Loss: 10.660026
Rec Loss: 9.913999
KL Loss: 0.746027
Y Loss: 0.603672
T Loss: 9.612162
Epoch 249 
Overall Loss: 10.634129
Rec Loss: 9.892606
KL Loss: 0.741523
Y Loss: 0.582850
T Loss: 9.601181
Epoch 299 
Overall Loss: 10.621379
Rec Loss: 9.892230
KL Loss: 0.729149
Y Loss: 0.582824
T Loss: 9.600818
Epoch 349 
Overall Loss: 10.603871
Rec Loss: 9.879955
KL Loss: 0.723916
Y Loss: 0.555827
T Loss: 9.602041
Epoch 399 
Overall Loss: 10.590402
Rec Loss: 9.871491
KL Loss: 0.718911
Y Loss: 0.549671
T Loss: 9.596655
Epoch 449 
Overall Loss: 10.607484
Rec Loss: 9.890614
KL Loss: 0.716870
Y Loss: 0.542655
T Loss: 9.619286
Epoch 499 
Overall Loss: 10.588693
Rec Loss: 9.872755
KL Loss: 0.715938
Y Loss: 0.552210
T Loss: 9.596650
Epoch 549 
Overall Loss: 10.585963
Rec Loss: 9.877685
KL Loss: 0.708278
Y Loss: 0.552127
T Loss: 9.601621
Epoch 599 
Overall Loss: 10.572920
Rec Loss: 9.857977
KL Loss: 0.714942
Y Loss: 0.527081
T Loss: 9.594437
Epoch 649 
Overall Loss: 10.588623
Rec Loss: 9.864527
KL Loss: 0.724096
Y Loss: 0.535028
T Loss: 9.597013
Epoch 699 
Overall Loss: 10.561875
Rec Loss: 9.855848
KL Loss: 0.706026
Y Loss: 0.528881
T Loss: 9.591408
Epoch 749 
Overall Loss: 10.565607
Rec Loss: 9.858281
KL Loss: 0.707326
Y Loss: 0.534708
T Loss: 9.590927
Epoch 799 
Overall Loss: 10.570039
Rec Loss: 9.852150
KL Loss: 0.717889
Y Loss: 0.530808
T Loss: 9.586746
Epoch 849 
Overall Loss: 10.555295
Rec Loss: 9.847891
KL Loss: 0.707404
Y Loss: 0.523697
T Loss: 9.586042
Epoch 899 
Overall Loss: 10.559488
Rec Loss: 9.840705
KL Loss: 0.718783
Y Loss: 0.517936
T Loss: 9.581738
Epoch 949 
Overall Loss: 10.541540
Rec Loss: 9.832612
KL Loss: 0.708927
Y Loss: 0.508422
T Loss: 9.578402
Epoch 999 
Overall Loss: 10.554408
Rec Loss: 9.837217
KL Loss: 0.717191
Y Loss: 0.512559
T Loss: 9.580938
Epoch 1049 
Overall Loss: 10.539068
Rec Loss: 9.835509
KL Loss: 0.703559
Y Loss: 0.522201
T Loss: 9.574409
Epoch 1099 
Overall Loss: 10.542449
Rec Loss: 9.828368
KL Loss: 0.714081
Y Loss: 0.519070
T Loss: 9.568833
Epoch 1149 
Overall Loss: 10.554492
Rec Loss: 9.821008
KL Loss: 0.733484
Y Loss: 0.511521
T Loss: 9.565247
Epoch 1199 
Overall Loss: 10.530372
Rec Loss: 9.831563
KL Loss: 0.698810
Y Loss: 0.501089
T Loss: 9.581018
Epoch 1249 
Overall Loss: 10.534042
Rec Loss: 9.829057
KL Loss: 0.704985
Y Loss: 0.499371
T Loss: 9.579372
Epoch 1299 
Overall Loss: 10.517739
Rec Loss: 9.811482
KL Loss: 0.706257
Y Loss: 0.493463
T Loss: 9.564751
Epoch 1349 
Overall Loss: 10.531227
Rec Loss: 9.810634
KL Loss: 0.720592
Y Loss: 0.507891
T Loss: 9.556689
Epoch 1399 
Overall Loss: 10.515836
Rec Loss: 9.803325
KL Loss: 0.712511
Y Loss: 0.486656
T Loss: 9.559997
Epoch 1449 
Overall Loss: 10.504610
Rec Loss: 9.792943
KL Loss: 0.711667
Y Loss: 0.500661
T Loss: 9.542613
Epoch 1499 
Overall Loss: 10.513303
Rec Loss: 9.797824
KL Loss: 0.715480
Y Loss: 0.492074
T Loss: 9.551787
Epoch 1549 
Overall Loss: 10.527185
Rec Loss: 9.818078
KL Loss: 0.709107
Y Loss: 0.503750
T Loss: 9.566203
Epoch 1599 
Overall Loss: 10.512551
Rec Loss: 9.810540
KL Loss: 0.702010
Y Loss: 0.482162
T Loss: 9.569460
Epoch 1649 
Overall Loss: 10.505538
Rec Loss: 9.814795
KL Loss: 0.690743
Y Loss: 0.494425
T Loss: 9.567583
Epoch 1699 
Overall Loss: 10.495376
Rec Loss: 9.777423
KL Loss: 0.717952
Y Loss: 0.482056
T Loss: 9.536395
Epoch 1749 
Overall Loss: 10.495306
Rec Loss: 9.793525
KL Loss: 0.701782
Y Loss: 0.493924
T Loss: 9.546563
Epoch 1799 
Overall Loss: 10.512542
Rec Loss: 9.795951
KL Loss: 0.716591
Y Loss: 0.487987
T Loss: 9.551958
Epoch 1849 
Overall Loss: 10.495544
Rec Loss: 9.787571
KL Loss: 0.707973
Y Loss: 0.488455
T Loss: 9.543344
Epoch 1899 
Overall Loss: 10.497703
Rec Loss: 9.789625
KL Loss: 0.708078
Y Loss: 0.486305
T Loss: 9.546473
Epoch 1949 
Overall Loss: 10.498389
Rec Loss: 9.794889
KL Loss: 0.703500
Y Loss: 0.478276
T Loss: 9.555751
Epoch 1999 
Overall Loss: 10.492119
Rec Loss: 9.779723
KL Loss: 0.712395
Y Loss: 0.478879
T Loss: 9.540284
Epoch 2049 
Overall Loss: 10.485286
Rec Loss: 9.769422
KL Loss: 0.715864
Y Loss: 0.465042
T Loss: 9.536901
Epoch 2099 
Overall Loss: 10.488346
Rec Loss: 9.772587
KL Loss: 0.715760
Y Loss: 0.472739
T Loss: 9.536217
Epoch 2149 
Overall Loss: 10.489785
Rec Loss: 9.783428
KL Loss: 0.706357
Y Loss: 0.474740
T Loss: 9.546058
Epoch 2199 
Overall Loss: 10.470623
Rec Loss: 9.777200
KL Loss: 0.693424
Y Loss: 0.474206
T Loss: 9.540097
Epoch 2249 
Overall Loss: 10.479967
Rec Loss: 9.778350
KL Loss: 0.701617
Y Loss: 0.466274
T Loss: 9.545213
Epoch 2299 
Overall Loss: 10.482415
Rec Loss: 9.773423
KL Loss: 0.708992
Y Loss: 0.483413
T Loss: 9.531716
Epoch 2349 
Overall Loss: 10.479412
Rec Loss: 9.774746
KL Loss: 0.704666
Y Loss: 0.483044
T Loss: 9.533224
Epoch 2399 
Overall Loss: 10.467287
Rec Loss: 9.759748
KL Loss: 0.707539
Y Loss: 0.464864
T Loss: 9.527317
Epoch 2449 
Overall Loss: 10.469993
Rec Loss: 9.758489
KL Loss: 0.711504
Y Loss: 0.468834
T Loss: 9.524072
Epoch 2499 
Overall Loss: 10.473987
Rec Loss: 9.771362
KL Loss: 0.702624
Y Loss: 0.467148
T Loss: 9.537788
Epoch 2549 
Overall Loss: 10.478598
Rec Loss: 9.755557
KL Loss: 0.723041
Y Loss: 0.479349
T Loss: 9.515882
Epoch 2599 
Overall Loss: 10.468590
Rec Loss: 9.756155
KL Loss: 0.712435
Y Loss: 0.458301
T Loss: 9.527005
Epoch 2649 
Overall Loss: 10.471841
Rec Loss: 9.743385
KL Loss: 0.728456
Y Loss: 0.460999
T Loss: 9.512885
Epoch 2699 
Overall Loss: 10.459687
Rec Loss: 9.750183
KL Loss: 0.709504
Y Loss: 0.459667
T Loss: 9.520350
Epoch 2749 
Overall Loss: 10.456853
Rec Loss: 9.752037
KL Loss: 0.704816
Y Loss: 0.467108
T Loss: 9.518483
Epoch 2799 
Overall Loss: 10.464165
Rec Loss: 9.759955
KL Loss: 0.704210
Y Loss: 0.464482
T Loss: 9.527714
Epoch 2849 
Overall Loss: 10.473981
Rec Loss: 9.756447
KL Loss: 0.717535
Y Loss: 0.461620
T Loss: 9.525636
Epoch 2899 
Overall Loss: 10.456299
Rec Loss: 9.755146
KL Loss: 0.701153
Y Loss: 0.453931
T Loss: 9.528181
Epoch 2949 
Overall Loss: 10.451680
Rec Loss: 9.750656
KL Loss: 0.701023
Y Loss: 0.464829
T Loss: 9.518242
Epoch 2999 
Overall Loss: 10.449204
Rec Loss: 9.740542
KL Loss: 0.708661
Y Loss: 0.449636
T Loss: 9.515724
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.438418
Epoch 99
Rec Loss: 0.442587
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.192449
Epoch 99
Rec Loss: 10.195815
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.632309
Insample Error: 1.437985
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 16.563122
Rec Loss: 11.805309
KL Loss: 4.757814
Y Loss: 6.569991
T Loss: 13.558374
X Loss: -5.038061
Epoch 99 
Overall Loss: -0.522728
Rec Loss: -10.193790
KL Loss: 9.671061
Y Loss: 2.966621
T Loss: 13.309801
X Loss: -24.986902
Epoch 149 
Overall Loss: -5.584626
Rec Loss: -16.493170
KL Loss: 10.908544
Y Loss: 2.427381
T Loss: 13.245774
X Loss: -30.952634
Epoch 199 
Overall Loss: -9.083648
Rec Loss: -21.332536
KL Loss: 12.248888
Y Loss: 1.833826
T Loss: 13.128626
X Loss: -35.378074
Epoch 249 
Overall Loss: -10.612343
Rec Loss: -23.539111
KL Loss: 12.926768
Y Loss: 1.365171
T Loss: 12.997354
X Loss: -37.219050
Epoch 299 
Overall Loss: -12.013909
Rec Loss: -25.437277
KL Loss: 13.423369
Y Loss: 1.138000
T Loss: 12.826808
X Loss: -38.833085
Epoch 349 
Overall Loss: -13.055586
Rec Loss: -26.902258
KL Loss: 13.846673
Y Loss: 1.014887
T Loss: 12.592925
X Loss: -40.002626
Epoch 399 
Overall Loss: -14.156012
Rec Loss: -28.332919
KL Loss: 14.176908
Y Loss: 0.912672
T Loss: 12.397066
X Loss: -41.186322
Epoch 449 
Overall Loss: -14.910795
Rec Loss: -29.342586
KL Loss: 14.431791
Y Loss: 0.889626
T Loss: 12.250191
X Loss: -42.037590
Epoch 499 
Overall Loss: -15.630227
Rec Loss: -30.315317
KL Loss: 14.685090
Y Loss: 0.812043
T Loss: 12.117502
X Loss: -42.838840
Epoch 549 
Overall Loss: -16.313228
Rec Loss: -31.115429
KL Loss: 14.802200
Y Loss: 0.781010
T Loss: 12.033825
X Loss: -43.539757
Epoch 599 
Overall Loss: -16.805236
Rec Loss: -31.747662
KL Loss: 14.942426
Y Loss: 0.758567
T Loss: 11.928006
X Loss: -44.054953
Epoch 649 
Overall Loss: -17.438008
Rec Loss: -32.535399
KL Loss: 15.097391
Y Loss: 0.731813
T Loss: 11.849617
X Loss: -44.750923
Epoch 699 
Overall Loss: -17.952756
Rec Loss: -33.055534
KL Loss: 15.102778
Y Loss: 0.745748
T Loss: 11.820316
X Loss: -45.248723
Epoch 749 
Overall Loss: -18.434328
Rec Loss: -33.734579
KL Loss: 15.300251
Y Loss: 0.691985
T Loss: 11.770152
X Loss: -45.850722
Epoch 799 
Overall Loss: -18.961266
Rec Loss: -34.354645
KL Loss: 15.393379
Y Loss: 0.658464
T Loss: 11.723863
X Loss: -46.407739
Epoch 849 
Overall Loss: -19.377170
Rec Loss: -34.939843
KL Loss: 15.562673
Y Loss: 0.638679
T Loss: 11.680350
X Loss: -46.939532
Epoch 899 
Overall Loss: -19.557349
Rec Loss: -35.155529
KL Loss: 15.598180
Y Loss: 0.621628
T Loss: 11.663954
X Loss: -47.130297
Epoch 949 
Overall Loss: -20.148603
Rec Loss: -35.732129
KL Loss: 15.583525
Y Loss: 0.626273
T Loss: 11.622614
X Loss: -47.667880
Epoch 999 
Overall Loss: -20.410833
Rec Loss: -36.076788
KL Loss: 15.665954
Y Loss: 0.607414
T Loss: 11.612998
X Loss: -47.993492
Epoch 1049 
Overall Loss: -20.889785
Rec Loss: -36.624495
KL Loss: 15.734710
Y Loss: 0.582983
T Loss: 11.565609
X Loss: -48.481596
Epoch 1099 
Overall Loss: -20.957295
Rec Loss: -36.684032
KL Loss: 15.726738
Y Loss: 0.576086
T Loss: 11.546232
X Loss: -48.518307
Epoch 1149 
Overall Loss: -21.220247
Rec Loss: -37.057224
KL Loss: 15.836978
Y Loss: 0.592337
T Loss: 11.524780
X Loss: -48.878173
Epoch 1199 
Overall Loss: -21.663007
Rec Loss: -37.578323
KL Loss: 15.915317
Y Loss: 0.561425
T Loss: 11.506394
X Loss: -49.365430
Epoch 1249 
Overall Loss: -21.822224
Rec Loss: -37.738229
KL Loss: 15.916005
Y Loss: 0.563408
T Loss: 11.492742
X Loss: -49.512673
Epoch 1299 
Overall Loss: -21.881194
Rec Loss: -37.833424
KL Loss: 15.952230
Y Loss: 0.560665
T Loss: 11.471240
X Loss: -49.584996
Epoch 1349 
Overall Loss: -22.271037
Rec Loss: -38.250191
KL Loss: 15.979155
Y Loss: 0.569654
T Loss: 11.454448
X Loss: -49.989467
Epoch 1399 
Overall Loss: -22.451018
Rec Loss: -38.544715
KL Loss: 16.093697
Y Loss: 0.572692
T Loss: 11.442917
X Loss: -50.273979
Epoch 1449 
Overall Loss: -22.812093
Rec Loss: -38.882431
KL Loss: 16.070339
Y Loss: 0.563566
T Loss: 11.428729
X Loss: -50.592944
Epoch 1499 
Overall Loss: -22.842149
Rec Loss: -38.949172
KL Loss: 16.107022
Y Loss: 0.562548
T Loss: 11.418481
X Loss: -50.648926
Epoch 1549 
Overall Loss: -23.112196
Rec Loss: -39.181334
KL Loss: 16.069139
Y Loss: 0.581191
T Loss: 11.414754
X Loss: -50.886684
Epoch 1599 
Overall Loss: -23.102264
Rec Loss: -39.260607
KL Loss: 16.158343
Y Loss: 0.548958
T Loss: 11.395504
X Loss: -50.930590
Epoch 1649 
Overall Loss: -23.131773
Rec Loss: -39.325922
KL Loss: 16.194148
Y Loss: 0.559053
T Loss: 11.381512
X Loss: -50.986960
Epoch 1699 
Overall Loss: -23.453070
Rec Loss: -39.694631
KL Loss: 16.241561
Y Loss: 0.549415
T Loss: 11.355335
X Loss: -51.324673
Epoch 1749 
Overall Loss: -23.393085
Rec Loss: -39.714524
KL Loss: 16.321439
Y Loss: 0.547922
T Loss: 11.341785
X Loss: -51.330269
Epoch 1799 
Overall Loss: -23.871296
Rec Loss: -40.177549
KL Loss: 16.306253
Y Loss: 0.554499
T Loss: 11.324248
X Loss: -51.779047
Epoch 1849 
Overall Loss: -23.943446
Rec Loss: -40.274347
KL Loss: 16.330900
Y Loss: 0.557622
T Loss: 11.319674
X Loss: -51.872833
Epoch 1899 
Overall Loss: -23.797909
Rec Loss: -40.125888
KL Loss: 16.327980
Y Loss: 0.552175
T Loss: 11.310594
X Loss: -51.712570
Epoch 1949 
Overall Loss: -24.217341
Rec Loss: -40.466883
KL Loss: 16.249542
Y Loss: 0.558487
T Loss: 11.306543
X Loss: -52.052669
Epoch 1999 
Overall Loss: -24.314637
Rec Loss: -40.750663
KL Loss: 16.436025
Y Loss: 0.542013
T Loss: 11.284228
X Loss: -52.305896
Epoch 2049 
Overall Loss: -24.545608
Rec Loss: -41.029650
KL Loss: 16.484043
Y Loss: 0.546575
T Loss: 11.261132
X Loss: -52.564070
Epoch 2099 
Overall Loss: -24.430613
Rec Loss: -40.917354
KL Loss: 16.486741
Y Loss: 0.534252
T Loss: 11.255066
X Loss: -52.439546
Epoch 2149 
Overall Loss: -24.605908
Rec Loss: -41.121371
KL Loss: 16.515463
Y Loss: 0.542723
T Loss: 11.243923
X Loss: -52.636655
Epoch 2199 
Overall Loss: -25.056808
Rec Loss: -41.459393
KL Loss: 16.402585
Y Loss: 0.541803
T Loss: 11.229804
X Loss: -52.960099
Epoch 2249 
Overall Loss: -24.915750
Rec Loss: -41.472605
KL Loss: 16.556856
Y Loss: 0.522058
T Loss: 11.224501
X Loss: -52.958135
Epoch 2299 
Overall Loss: -24.523360
Rec Loss: -41.140230
KL Loss: 16.616871
Y Loss: 0.530598
T Loss: 11.201709
X Loss: -52.607238
Epoch 2349 
Overall Loss: -25.226380
Rec Loss: -41.896558
KL Loss: 16.670177
Y Loss: 0.510842
T Loss: 11.196731
X Loss: -53.348709
Epoch 2399 
Overall Loss: -25.453561
Rec Loss: -41.933611
KL Loss: 16.480051
Y Loss: 0.541499
T Loss: 11.189383
X Loss: -53.393743
Epoch 2449 
Overall Loss: -25.022349
Rec Loss: -41.690915
KL Loss: 16.668566
Y Loss: 0.518660
T Loss: 11.188946
X Loss: -53.139191
Epoch 2499 
Overall Loss: -25.361551
Rec Loss: -41.988306
KL Loss: 16.626754
Y Loss: 0.514248
T Loss: 11.159248
X Loss: -53.404678
Epoch 2549 
Overall Loss: -25.547779
Rec Loss: -42.315371
KL Loss: 16.767591
Y Loss: 0.501049
T Loss: 11.150627
X Loss: -53.716522
Epoch 2599 
Overall Loss: -25.571228
Rec Loss: -42.361232
KL Loss: 16.790005
Y Loss: 0.492557
T Loss: 11.137047
X Loss: -53.744559
Epoch 2649 
Overall Loss: -25.068058
Rec Loss: -41.822037
KL Loss: 16.753980
Y Loss: 0.494853
T Loss: 11.127370
X Loss: -53.196834
Epoch 2699 
Overall Loss: -25.686848
Rec Loss: -42.347160
KL Loss: 16.660312
Y Loss: 0.507649
T Loss: 11.126018
X Loss: -53.727003
Epoch 2749 
Overall Loss: -25.823303
Rec Loss: -42.585430
KL Loss: 16.762128
Y Loss: 0.492102
T Loss: 11.126785
X Loss: -53.958266
Epoch 2799 
Overall Loss: -26.113473
Rec Loss: -42.849110
KL Loss: 16.735639
Y Loss: 0.501369
T Loss: 11.105677
X Loss: -54.205473
Epoch 2849 
Overall Loss: -26.004624
Rec Loss: -42.834011
KL Loss: 16.829387
Y Loss: 0.501221
T Loss: 11.097519
X Loss: -54.182140
Epoch 2899 
Overall Loss: -25.612903
Rec Loss: -42.313458
KL Loss: 16.700557
Y Loss: 0.519427
T Loss: 11.097235
X Loss: -53.670408
Epoch 2949 
Overall Loss: -26.404979
Rec Loss: -43.144933
KL Loss: 16.739953
Y Loss: 0.497941
T Loss: 11.093044
X Loss: -54.486947
Epoch 2999 
Overall Loss: -26.004499
Rec Loss: -42.875201
KL Loss: 16.870701
Y Loss: 0.492277
T Loss: 11.077226
X Loss: -54.198564
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.314026
Epoch 99
Rec Loss: 2.287000
Epoch 149
Rec Loss: 2.271580
Epoch 199
Rec Loss: 2.263775
Epoch 249
Rec Loss: 2.260825
Epoch 299
Rec Loss: 2.251065
Epoch 349
Rec Loss: 2.244836
Epoch 399
Rec Loss: 2.239351
Epoch 449
Rec Loss: 2.231437
Epoch 499
Rec Loss: 2.232062
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.002792
Epoch 99
Rec Loss: 0.002064
Epoch 149
Rec Loss: 0.001322
Epoch 199
Rec Loss: 0.001159
Epoch 249
Rec Loss: 0.000971
Epoch 299
Rec Loss: 0.000913
Epoch 349
Rec Loss: 0.000846
Epoch 399
Rec Loss: 0.001069
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.417224
Insample Error 3.031299
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.970591
Epoch 99 
Prediction Loss: 0.720889
Epoch 149 
Prediction Loss: 0.665257
Epoch 199 
Prediction Loss: 0.642941
Epoch 249 
Prediction Loss: 0.626823
Epoch 299 
Prediction Loss: 0.610819
Epoch 349 
Prediction Loss: 0.596846
Epoch 399 
Prediction Loss: 0.586418
Epoch 449 
Prediction Loss: 0.579219
Epoch 499 
Prediction Loss: 0.583680
Epoch 549 
Prediction Loss: 0.571587
Epoch 599 
Prediction Loss: 0.564919
Epoch 649 
Prediction Loss: 0.564888
Epoch 699 
Prediction Loss: 0.560774
Epoch 749 
Prediction Loss: 0.559225
Epoch 799 
Prediction Loss: 0.552648
Epoch 849 
Prediction Loss: 0.551101
Epoch 899 
Prediction Loss: 0.553974
Epoch 949 
Prediction Loss: 0.546207
Epoch 999 
Prediction Loss: 0.547012
Epoch 1049 
Prediction Loss: 0.541600
Epoch 1099 
Prediction Loss: 0.539553
Epoch 1149 
Prediction Loss: 0.552738
Epoch 1199 
Prediction Loss: 0.542806
Epoch 1249 
Prediction Loss: 0.543468
Epoch 1299 
Prediction Loss: 0.535509
Epoch 1349 
Prediction Loss: 0.541250
Epoch 1399 
Prediction Loss: 0.533519
Epoch 1449 
Prediction Loss: 0.535416
Epoch 1499 
Prediction Loss: 0.525032
Epoch 1549 
Prediction Loss: 0.538252
Epoch 1599 
Prediction Loss: 0.518250
Epoch 1649 
Prediction Loss: 0.515864
Epoch 1699 
Prediction Loss: 0.518757
Epoch 1749 
Prediction Loss: 0.521331
Epoch 1799 
Prediction Loss: 0.523669
Epoch 1849 
Prediction Loss: 0.515260
Epoch 1899 
Prediction Loss: 0.511114
Epoch 1949 
Prediction Loss: 0.516501
Epoch 1999 
Prediction Loss: 0.505724
Epoch 2049 
Prediction Loss: 0.504661
Epoch 2099 
Prediction Loss: 0.508612
Epoch 2149 
Prediction Loss: 0.508128
Epoch 2199 
Prediction Loss: 0.498079
Epoch 2249 
Prediction Loss: 0.499885
Epoch 2299 
Prediction Loss: 0.501008
Epoch 2349 
Prediction Loss: 0.501938
Epoch 2399 
Prediction Loss: 0.491709
Epoch 2449 
Prediction Loss: 0.498795
Epoch 2499 
Prediction Loss: 0.496312
Epoch 2549 
Prediction Loss: 0.500201
Epoch 2599 
Prediction Loss: 0.489631
Epoch 2649 
Prediction Loss: 0.484272
Epoch 2699 
Prediction Loss: 0.483922
Epoch 2749 
Prediction Loss: 0.480019
Epoch 2799 
Prediction Loss: 0.484275
Epoch 2849 
Prediction Loss: 0.484220
Epoch 2899 
Prediction Loss: 0.472847
Epoch 2949 
Prediction Loss: 0.473757
Epoch 2999 
Prediction Loss: 0.471823
Epoch 3049 
Prediction Loss: 0.469263
Epoch 3099 
Prediction Loss: 0.472931
Epoch 3149 
Prediction Loss: 0.468140
Epoch 3199 
Prediction Loss: 0.471466
Epoch 3249 
Prediction Loss: 0.467836
Epoch 3299 
Prediction Loss: 0.459657
Epoch 3349 
Prediction Loss: 0.462419
Epoch 3399 
Prediction Loss: 0.462092
Epoch 3449 
Prediction Loss: 0.456903
Epoch 3499 
Prediction Loss: 0.456614
Epoch 3549 
Prediction Loss: 0.449467
Epoch 3599 
Prediction Loss: 0.455236
Epoch 3649 
Prediction Loss: 0.451714
Epoch 3699 
Prediction Loss: 0.452630
Epoch 3749 
Prediction Loss: 0.450064
Epoch 3799 
Prediction Loss: 0.443726
Epoch 3849 
Prediction Loss: 0.439827
Epoch 3899 
Prediction Loss: 0.437211
Epoch 3949 
Prediction Loss: 0.435765
Epoch 3999 
Prediction Loss: 0.434937
Epoch 4049 
Prediction Loss: 0.431141
Epoch 4099 
Prediction Loss: 0.431355
Epoch 4149 
Prediction Loss: 0.433288
Epoch 4199 
Prediction Loss: 0.427831
Epoch 4249 
Prediction Loss: 0.436711
Epoch 4299 
Prediction Loss: 0.425398
Epoch 4349 
Prediction Loss: 0.422611
Epoch 4399 
Prediction Loss: 0.425926
Epoch 4449 
Prediction Loss: 0.422725
Epoch 4499 
Prediction Loss: 0.426560
Epoch 4549 
Prediction Loss: 0.415659
Epoch 4599 
Prediction Loss: 0.411851
Epoch 4649 
Prediction Loss: 0.412066
Epoch 4699 
Prediction Loss: 0.408242
Epoch 4749 
Prediction Loss: 0.415475
Epoch 4799 
Prediction Loss: 0.409127
Epoch 4849 
Prediction Loss: 0.414517
Epoch 4899 
Prediction Loss: 0.407144
Epoch 4949 
Prediction Loss: 0.406928
Epoch 4999 
Prediction Loss: 0.399698
Epoch 5049 
Prediction Loss: 0.403260
Epoch 5099 
Prediction Loss: 0.407283
Epoch 5149 
Prediction Loss: 0.396650
Epoch 5199 
Prediction Loss: 0.399830
Epoch 5249 
Prediction Loss: 0.400975
Epoch 5299 
Prediction Loss: 0.393965
Epoch 5349 
Prediction Loss: 0.394419
Epoch 5399 
Prediction Loss: 0.388752
Epoch 5449 
Prediction Loss: 0.392442
Epoch 5499 
Prediction Loss: 0.386267
Epoch 5549 
Prediction Loss: 0.390921
Epoch 5599 
Prediction Loss: 0.385613
Epoch 5649 
Prediction Loss: 0.381909
Epoch 5699 
Prediction Loss: 0.381700
Epoch 5749 
Prediction Loss: 0.380594
Epoch 5799 
Prediction Loss: 0.377747
Epoch 5849 
Prediction Loss: 0.381126
Epoch 5899 
Prediction Loss: 0.375951
Epoch 5949 
Prediction Loss: 0.378374
Epoch 5999 
Prediction Loss: 0.377289
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.606126
Insample Error 1.608639
[31m========== repeat time 2 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.998962
Rec Loss: 10.005731
KL Loss: 0.993231
Y Loss: 0.834775
T Loss: 9.588344
Epoch 99 
Overall Loss: 10.775964
Rec Loss: 9.988170
KL Loss: 0.787795
Y Loss: 0.726871
T Loss: 9.624734
Epoch 149 
Overall Loss: 10.683867
Rec Loss: 9.943109
KL Loss: 0.740759
Y Loss: 0.637762
T Loss: 9.624227
Epoch 199 
Overall Loss: 10.641723
Rec Loss: 9.928735
KL Loss: 0.712988
Y Loss: 0.606913
T Loss: 9.625278
Epoch 249 
Overall Loss: 10.623026
Rec Loss: 9.891932
KL Loss: 0.731094
Y Loss: 0.572087
T Loss: 9.605888
Epoch 299 
Overall Loss: 10.610230
Rec Loss: 9.900888
KL Loss: 0.709342
Y Loss: 0.544952
T Loss: 9.628412
Epoch 349 
Overall Loss: 10.587619
Rec Loss: 9.891704
KL Loss: 0.695915
Y Loss: 0.549310
T Loss: 9.617049
Epoch 399 
Overall Loss: 10.574886
Rec Loss: 9.858752
KL Loss: 0.716134
Y Loss: 0.540819
T Loss: 9.588342
Epoch 449 
Overall Loss: 10.580332
Rec Loss: 9.863041
KL Loss: 0.717291
Y Loss: 0.534421
T Loss: 9.595830
Epoch 499 
Overall Loss: 10.577289
Rec Loss: 9.887469
KL Loss: 0.689820
Y Loss: 0.535221
T Loss: 9.619858
Epoch 549 
Overall Loss: 10.557683
Rec Loss: 9.851655
KL Loss: 0.706028
Y Loss: 0.518768
T Loss: 9.592270
Epoch 599 
Overall Loss: 10.581260
Rec Loss: 9.857196
KL Loss: 0.724064
Y Loss: 0.523143
T Loss: 9.595625
Epoch 649 
Overall Loss: 10.563053
Rec Loss: 9.853282
KL Loss: 0.709771
Y Loss: 0.511799
T Loss: 9.597382
Epoch 699 
Overall Loss: 10.554217
Rec Loss: 9.831449
KL Loss: 0.722768
Y Loss: 0.512491
T Loss: 9.575204
Epoch 749 
Overall Loss: 10.549437
Rec Loss: 9.851006
KL Loss: 0.698430
Y Loss: 0.513889
T Loss: 9.594062
Epoch 799 
Overall Loss: 10.552428
Rec Loss: 9.856864
KL Loss: 0.695564
Y Loss: 0.495803
T Loss: 9.608962
Epoch 849 
Overall Loss: 10.530727
Rec Loss: 9.838532
KL Loss: 0.692195
Y Loss: 0.504201
T Loss: 9.586431
Epoch 899 
Overall Loss: 10.536880
Rec Loss: 9.859640
KL Loss: 0.677240
Y Loss: 0.514849
T Loss: 9.602216
Epoch 949 
Overall Loss: 10.533710
Rec Loss: 9.839765
KL Loss: 0.693945
Y Loss: 0.502870
T Loss: 9.588331
Epoch 999 
Overall Loss: 10.539851
Rec Loss: 9.829863
KL Loss: 0.709988
Y Loss: 0.504404
T Loss: 9.577661
Epoch 1049 
Overall Loss: 10.522571
Rec Loss: 9.834904
KL Loss: 0.687668
Y Loss: 0.495871
T Loss: 9.586968
Epoch 1099 
Overall Loss: 10.518059
Rec Loss: 9.812222
KL Loss: 0.705837
Y Loss: 0.496849
T Loss: 9.563797
Epoch 1149 
Overall Loss: 10.521453
Rec Loss: 9.824770
KL Loss: 0.696683
Y Loss: 0.485767
T Loss: 9.581886
Epoch 1199 
Overall Loss: 10.533767
Rec Loss: 9.840971
KL Loss: 0.692796
Y Loss: 0.510090
T Loss: 9.585926
Epoch 1249 
Overall Loss: 10.512024
Rec Loss: 9.814675
KL Loss: 0.697349
Y Loss: 0.486936
T Loss: 9.571207
Epoch 1299 
Overall Loss: 10.525973
Rec Loss: 9.822088
KL Loss: 0.703885
Y Loss: 0.493341
T Loss: 9.575418
Epoch 1349 
Overall Loss: 10.518003
Rec Loss: 9.815996
KL Loss: 0.702007
Y Loss: 0.480881
T Loss: 9.575556
Epoch 1399 
Overall Loss: 10.505024
Rec Loss: 9.792183
KL Loss: 0.712841
Y Loss: 0.486634
T Loss: 9.548866
Epoch 1449 
Overall Loss: 10.502118
Rec Loss: 9.815711
KL Loss: 0.686408
Y Loss: 0.485196
T Loss: 9.573112
Epoch 1499 
Overall Loss: 10.474698
Rec Loss: 9.786103
KL Loss: 0.688595
Y Loss: 0.476389
T Loss: 9.547908
Epoch 1549 
Overall Loss: 10.496849
Rec Loss: 9.796915
KL Loss: 0.699935
Y Loss: 0.470407
T Loss: 9.561711
Epoch 1599 
Overall Loss: 10.491366
Rec Loss: 9.791531
KL Loss: 0.699835
Y Loss: 0.475782
T Loss: 9.553640
Epoch 1649 
Overall Loss: 10.481832
Rec Loss: 9.793611
KL Loss: 0.688221
Y Loss: 0.473622
T Loss: 9.556800
Epoch 1699 
Overall Loss: 10.498217
Rec Loss: 9.786976
KL Loss: 0.711241
Y Loss: 0.473667
T Loss: 9.550143
Epoch 1749 
Overall Loss: 10.485911
Rec Loss: 9.781365
KL Loss: 0.704545
Y Loss: 0.474396
T Loss: 9.544168
Epoch 1799 
Overall Loss: 10.476426
Rec Loss: 9.784536
KL Loss: 0.691890
Y Loss: 0.466133
T Loss: 9.551469
Epoch 1849 
Overall Loss: 10.494524
Rec Loss: 9.776355
KL Loss: 0.718169
Y Loss: 0.474653
T Loss: 9.539029
Epoch 1899 
Overall Loss: 10.462027
Rec Loss: 9.774975
KL Loss: 0.687052
Y Loss: 0.464143
T Loss: 9.542904
Epoch 1949 
Overall Loss: 10.469484
Rec Loss: 9.770673
KL Loss: 0.698811
Y Loss: 0.466812
T Loss: 9.537266
Epoch 1999 
Overall Loss: 10.466252
Rec Loss: 9.754024
KL Loss: 0.712228
Y Loss: 0.458055
T Loss: 9.524996
Epoch 2049 
Overall Loss: 10.472991
Rec Loss: 9.774646
KL Loss: 0.698344
Y Loss: 0.457922
T Loss: 9.545685
Epoch 2099 
Overall Loss: 10.467329
Rec Loss: 9.775408
KL Loss: 0.691920
Y Loss: 0.460702
T Loss: 9.545057
Epoch 2149 
Overall Loss: 10.464661
Rec Loss: 9.763107
KL Loss: 0.701554
Y Loss: 0.456500
T Loss: 9.534857
Epoch 2199 
Overall Loss: 10.479705
Rec Loss: 9.768317
KL Loss: 0.711388
Y Loss: 0.465715
T Loss: 9.535459
Epoch 2249 
Overall Loss: 10.458655
Rec Loss: 9.775878
KL Loss: 0.682777
Y Loss: 0.462479
T Loss: 9.544639
Epoch 2299 
Overall Loss: 10.436773
Rec Loss: 9.759807
KL Loss: 0.676966
Y Loss: 0.460455
T Loss: 9.529580
Epoch 2349 
Overall Loss: 10.467020
Rec Loss: 9.766618
KL Loss: 0.700403
Y Loss: 0.473804
T Loss: 9.529715
Epoch 2399 
Overall Loss: 10.458422
Rec Loss: 9.743653
KL Loss: 0.714769
Y Loss: 0.448137
T Loss: 9.519584
Epoch 2449 
Overall Loss: 10.460740
Rec Loss: 9.771605
KL Loss: 0.689135
Y Loss: 0.459028
T Loss: 9.542090
Epoch 2499 
Overall Loss: 10.445704
Rec Loss: 9.750660
KL Loss: 0.695044
Y Loss: 0.445450
T Loss: 9.527935
Epoch 2549 
Overall Loss: 10.446826
Rec Loss: 9.746142
KL Loss: 0.700684
Y Loss: 0.453084
T Loss: 9.519600
Epoch 2599 
Overall Loss: 10.443880
Rec Loss: 9.752366
KL Loss: 0.691513
Y Loss: 0.446634
T Loss: 9.529050
Epoch 2649 
Overall Loss: 10.463947
Rec Loss: 9.753729
KL Loss: 0.710217
Y Loss: 0.455249
T Loss: 9.526105
Epoch 2699 
Overall Loss: 10.446007
Rec Loss: 9.752173
KL Loss: 0.693835
Y Loss: 0.445223
T Loss: 9.529561
Epoch 2749 
Overall Loss: 10.436829
Rec Loss: 9.743857
KL Loss: 0.692972
Y Loss: 0.439521
T Loss: 9.524097
Epoch 2799 
Overall Loss: 10.442494
Rec Loss: 9.747474
KL Loss: 0.695020
Y Loss: 0.452157
T Loss: 9.521396
Epoch 2849 
Overall Loss: 10.446532
Rec Loss: 9.758219
KL Loss: 0.688313
Y Loss: 0.452350
T Loss: 9.532043
Epoch 2899 
Overall Loss: 10.435179
Rec Loss: 9.735650
KL Loss: 0.699529
Y Loss: 0.431049
T Loss: 9.520125
Epoch 2949 
Overall Loss: 10.429567
Rec Loss: 9.744329
KL Loss: 0.685238
Y Loss: 0.435253
T Loss: 9.526703
Epoch 2999 
Overall Loss: 10.414050
Rec Loss: 9.728384
KL Loss: 0.685667
Y Loss: 0.428825
T Loss: 9.513971
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.461326
Epoch 99
Rec Loss: 0.468298
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.198858
Epoch 99
Rec Loss: 10.175527
Epoch 149
Rec Loss: 10.182109
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.630939
Insample Error: 1.488934
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 17.931498
Rec Loss: 14.269879
KL Loss: 3.661619
Y Loss: 6.154603
T Loss: 13.476255
X Loss: -2.283678
Epoch 99 
Overall Loss: -0.425214
Rec Loss: -10.789828
KL Loss: 10.364614
Y Loss: 2.176019
T Loss: 13.244678
X Loss: -25.122515
Epoch 149 
Overall Loss: -5.554041
Rec Loss: -16.915711
KL Loss: 11.361670
Y Loss: 1.710999
T Loss: 13.208169
X Loss: -30.979379
Epoch 199 
Overall Loss: -8.523010
Rec Loss: -20.851245
KL Loss: 12.328234
Y Loss: 1.269769
T Loss: 13.148802
X Loss: -34.634930
Epoch 249 
Overall Loss: -10.807119
Rec Loss: -23.797936
KL Loss: 12.990818
Y Loss: 1.113225
T Loss: 13.079730
X Loss: -37.434277
Epoch 299 
Overall Loss: -12.299851
Rec Loss: -25.830642
KL Loss: 13.530791
Y Loss: 1.041204
T Loss: 12.981101
X Loss: -39.332345
Epoch 349 
Overall Loss: -13.484410
Rec Loss: -27.421217
KL Loss: 13.936807
Y Loss: 0.975072
T Loss: 12.818246
X Loss: -40.726999
Epoch 399 
Overall Loss: -14.276816
Rec Loss: -28.586172
KL Loss: 14.309355
Y Loss: 0.873610
T Loss: 12.560321
X Loss: -41.583299
Epoch 449 
Overall Loss: -15.072098
Rec Loss: -29.718482
KL Loss: 14.646384
Y Loss: 0.830736
T Loss: 12.273754
X Loss: -42.407603
Epoch 499 
Overall Loss: -16.031010
Rec Loss: -30.941769
KL Loss: 14.910759
Y Loss: 0.793782
T Loss: 12.043200
X Loss: -43.381860
Epoch 549 
Overall Loss: -16.821124
Rec Loss: -31.910872
KL Loss: 15.089747
Y Loss: 0.768533
T Loss: 11.914808
X Loss: -44.209946
Epoch 599 
Overall Loss: -17.226275
Rec Loss: -32.415852
KL Loss: 15.189577
Y Loss: 0.765297
T Loss: 11.819558
X Loss: -44.618059
Epoch 649 
Overall Loss: -17.768740
Rec Loss: -33.119101
KL Loss: 15.350361
Y Loss: 0.739207
T Loss: 11.748681
X Loss: -45.237386
Epoch 699 
Overall Loss: -18.390022
Rec Loss: -33.792602
KL Loss: 15.402580
Y Loss: 0.719352
T Loss: 11.668120
X Loss: -45.820399
Epoch 749 
Overall Loss: -18.762276
Rec Loss: -34.349386
KL Loss: 15.587109
Y Loss: 0.668386
T Loss: 11.607280
X Loss: -46.290858
Epoch 799 
Overall Loss: -19.127162
Rec Loss: -34.786150
KL Loss: 15.658988
Y Loss: 0.689101
T Loss: 11.558627
X Loss: -46.689327
Epoch 849 
Overall Loss: -19.703859
Rec Loss: -35.482688
KL Loss: 15.778829
Y Loss: 0.661321
T Loss: 11.487945
X Loss: -47.301294
Epoch 899 
Overall Loss: -20.106407
Rec Loss: -35.888493
KL Loss: 15.782086
Y Loss: 0.657365
T Loss: 11.468283
X Loss: -47.685459
Epoch 949 
Overall Loss: -20.427995
Rec Loss: -36.318087
KL Loss: 15.890091
Y Loss: 0.645907
T Loss: 11.423196
X Loss: -48.064236
Epoch 999 
Overall Loss: -20.777391
Rec Loss: -36.694680
KL Loss: 15.917291
Y Loss: 0.646969
T Loss: 11.385294
X Loss: -48.403460
Epoch 1049 
Overall Loss: -20.904036
Rec Loss: -37.035389
KL Loss: 16.131353
Y Loss: 0.602308
T Loss: 11.332071
X Loss: -48.668615
Epoch 1099 
Overall Loss: -21.533309
Rec Loss: -37.659868
KL Loss: 16.126557
Y Loss: 0.614249
T Loss: 11.322577
X Loss: -49.289568
Epoch 1149 
Overall Loss: -21.614639
Rec Loss: -37.811844
KL Loss: 16.197205
Y Loss: 0.607983
T Loss: 11.300035
X Loss: -49.415871
Epoch 1199 
Overall Loss: -21.781336
Rec Loss: -37.926176
KL Loss: 16.144840
Y Loss: 0.615763
T Loss: 11.300699
X Loss: -49.534757
Epoch 1249 
Overall Loss: -21.881221
Rec Loss: -38.195687
KL Loss: 16.314467
Y Loss: 0.599003
T Loss: 11.250708
X Loss: -49.745896
Epoch 1299 
Overall Loss: -22.311227
Rec Loss: -38.628320
KL Loss: 16.317092
Y Loss: 0.604070
T Loss: 11.251336
X Loss: -50.181691
Epoch 1349 
Overall Loss: -22.674037
Rec Loss: -39.197978
KL Loss: 16.523942
Y Loss: 0.563016
T Loss: 11.204717
X Loss: -50.684203
Epoch 1399 
Overall Loss: -22.733573
Rec Loss: -39.320865
KL Loss: 16.587292
Y Loss: 0.560649
T Loss: 11.201072
X Loss: -50.802261
Epoch 1449 
Overall Loss: -23.078453
Rec Loss: -39.679418
KL Loss: 16.600966
Y Loss: 0.549652
T Loss: 11.187783
X Loss: -51.142028
Epoch 1499 
Overall Loss: -23.195181
Rec Loss: -39.849428
KL Loss: 16.654248
Y Loss: 0.531723
T Loss: 11.162222
X Loss: -51.277512
Epoch 1549 
Overall Loss: -23.350313
Rec Loss: -40.087558
KL Loss: 16.737246
Y Loss: 0.560969
T Loss: 11.174741
X Loss: -51.542782
Epoch 1599 
Overall Loss: -23.457960
Rec Loss: -40.201827
KL Loss: 16.743867
Y Loss: 0.541169
T Loss: 11.153761
X Loss: -51.626172
Epoch 1649 
Overall Loss: -23.334084
Rec Loss: -40.134253
KL Loss: 16.800167
Y Loss: 0.532792
T Loss: 11.153164
X Loss: -51.553813
Epoch 1699 
Overall Loss: -23.344521
Rec Loss: -40.202696
KL Loss: 16.858176
Y Loss: 0.527236
T Loss: 11.150198
X Loss: -51.616514
Epoch 1749 
Overall Loss: -24.002139
Rec Loss: -40.805765
KL Loss: 16.803626
Y Loss: 0.528045
T Loss: 11.145503
X Loss: -52.215291
Epoch 1799 
Overall Loss: -24.203619
Rec Loss: -41.117749
KL Loss: 16.914129
Y Loss: 0.515685
T Loss: 11.125519
X Loss: -52.501109
Epoch 1849 
Overall Loss: -23.311963
Rec Loss: -40.291981
KL Loss: 16.980018
Y Loss: 0.518023
T Loss: 11.113912
X Loss: -51.664903
Epoch 1899 
Overall Loss: -24.386844
Rec Loss: -41.403600
KL Loss: 17.016756
Y Loss: 0.496546
T Loss: 11.097565
X Loss: -52.749438
Epoch 1949 
Overall Loss: -24.257063
Rec Loss: -41.234238
KL Loss: 16.977176
Y Loss: 0.512323
T Loss: 11.110393
X Loss: -52.600793
Epoch 1999 
Overall Loss: -24.253376
Rec Loss: -41.070396
KL Loss: 16.817020
Y Loss: 0.518196
T Loss: 11.124031
X Loss: -52.453525
Epoch 2049 
Overall Loss: -24.786649
Rec Loss: -41.928967
KL Loss: 17.142318
Y Loss: 0.492418
T Loss: 11.098257
X Loss: -53.273432
Epoch 2099 
Overall Loss: -24.759344
Rec Loss: -41.936440
KL Loss: 17.177096
Y Loss: 0.478954
T Loss: 11.090986
X Loss: -53.266902
Epoch 2149 
Overall Loss: -24.862731
Rec Loss: -41.884811
KL Loss: 17.022081
Y Loss: 0.494558
T Loss: 11.093057
X Loss: -53.225147
Epoch 2199 
Overall Loss: -25.151080
Rec Loss: -42.407069
KL Loss: 17.255991
Y Loss: 0.483347
T Loss: 11.071489
X Loss: -53.720232
Epoch 2249 
Overall Loss: -24.952663
Rec Loss: -42.180032
KL Loss: 17.227369
Y Loss: 0.468144
T Loss: 11.084100
X Loss: -53.498203
Epoch 2299 
Overall Loss: -25.356895
Rec Loss: -42.684317
KL Loss: 17.327420
Y Loss: 0.462911
T Loss: 11.066650
X Loss: -53.982422
Epoch 2349 
Overall Loss: -25.447153
Rec Loss: -42.577396
KL Loss: 17.130243
Y Loss: 0.473581
T Loss: 11.093143
X Loss: -53.907330
Epoch 2399 
Overall Loss: -25.714340
Rec Loss: -43.002033
KL Loss: 17.287692
Y Loss: 0.453792
T Loss: 11.086004
X Loss: -54.314932
Epoch 2449 
Overall Loss: -25.729380
Rec Loss: -43.002182
KL Loss: 17.272802
Y Loss: 0.461244
T Loss: 11.078516
X Loss: -54.311321
Epoch 2499 
Overall Loss: -25.185298
Rec Loss: -42.527462
KL Loss: 17.342163
Y Loss: 0.432748
T Loss: 11.077943
X Loss: -53.821778
Epoch 2549 
Overall Loss: -25.881878
Rec Loss: -43.298584
KL Loss: 17.416707
Y Loss: 0.421846
T Loss: 11.069403
X Loss: -54.578912
Epoch 2599 
Overall Loss: -25.872474
Rec Loss: -43.273516
KL Loss: 17.401042
Y Loss: 0.432863
T Loss: 11.071603
X Loss: -54.561551
Epoch 2649 
Overall Loss: -25.583925
Rec Loss: -42.832602
KL Loss: 17.248677
Y Loss: 0.427894
T Loss: 11.077135
X Loss: -54.123683
Epoch 2699 
Overall Loss: -26.144399
Rec Loss: -43.602778
KL Loss: 17.458381
Y Loss: 0.415840
T Loss: 11.073601
X Loss: -54.884300
Epoch 2749 
Overall Loss: -26.303295
Rec Loss: -43.604406
KL Loss: 17.301112
Y Loss: 0.428252
T Loss: 11.073809
X Loss: -54.892341
Epoch 2799 
Overall Loss: -25.861452
Rec Loss: -42.961300
KL Loss: 17.099847
Y Loss: 0.445393
T Loss: 11.088131
X Loss: -54.272127
Epoch 2849 
Overall Loss: -26.404179
Rec Loss: -43.708157
KL Loss: 17.303978
Y Loss: 0.414263
T Loss: 11.076632
X Loss: -54.991920
Epoch 2899 
Overall Loss: -26.394634
Rec Loss: -43.834248
KL Loss: 17.439614
Y Loss: 0.414891
T Loss: 11.054890
X Loss: -55.096584
Epoch 2949 
Overall Loss: -26.682961
Rec Loss: -44.211883
KL Loss: 17.528923
Y Loss: 0.396368
T Loss: 11.045521
X Loss: -55.455588
Epoch 2999 
Overall Loss: -26.178641
Rec Loss: -43.671062
KL Loss: 17.492419
Y Loss: 0.387207
T Loss: 11.035137
X Loss: -54.899802
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.430992
Epoch 99
Rec Loss: 2.417935
Epoch 149
Rec Loss: 2.413858
Epoch 199
Rec Loss: 2.406467
Epoch 249
Rec Loss: 2.402157
Epoch 299
Rec Loss: 2.385086
Epoch 349
Rec Loss: 2.392762
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.003290
Epoch 99
Rec Loss: 0.001710
Epoch 149
Rec Loss: 0.001080
Epoch 199
Rec Loss: 0.001108
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.365320
Insample Error 3.449225
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.059335
Epoch 99 
Prediction Loss: 0.788383
Epoch 149 
Prediction Loss: 0.690831
Epoch 199 
Prediction Loss: 0.653283
Epoch 249 
Prediction Loss: 0.625520
Epoch 299 
Prediction Loss: 0.608493
Epoch 349 
Prediction Loss: 0.598306
Epoch 399 
Prediction Loss: 0.599815
Epoch 449 
Prediction Loss: 0.589822
Epoch 499 
Prediction Loss: 0.586218
Epoch 549 
Prediction Loss: 0.585393
Epoch 599 
Prediction Loss: 0.575608
Epoch 649 
Prediction Loss: 0.566669
Epoch 699 
Prediction Loss: 0.570761
Epoch 749 
Prediction Loss: 0.565048
Epoch 799 
Prediction Loss: 0.561685
Epoch 849 
Prediction Loss: 0.560605
Epoch 899 
Prediction Loss: 0.562640
Epoch 949 
Prediction Loss: 0.553393
Epoch 999 
Prediction Loss: 0.549373
Epoch 1049 
Prediction Loss: 0.546399
Epoch 1099 
Prediction Loss: 0.550157
Epoch 1149 
Prediction Loss: 0.551098
Epoch 1199 
Prediction Loss: 0.537049
Epoch 1249 
Prediction Loss: 0.536424
Epoch 1299 
Prediction Loss: 0.535036
Epoch 1349 
Prediction Loss: 0.534706
Epoch 1399 
Prediction Loss: 0.539352
Epoch 1449 
Prediction Loss: 0.532561
Epoch 1499 
Prediction Loss: 0.525564
Epoch 1549 
Prediction Loss: 0.522646
Epoch 1599 
Prediction Loss: 0.525013
Epoch 1649 
Prediction Loss: 0.522600
Epoch 1699 
Prediction Loss: 0.523774
Epoch 1749 
Prediction Loss: 0.520059
Epoch 1799 
Prediction Loss: 0.516137
Epoch 1849 
Prediction Loss: 0.513080
Epoch 1899 
Prediction Loss: 0.512035
Epoch 1949 
Prediction Loss: 0.511650
Epoch 1999 
Prediction Loss: 0.510230
Epoch 2049 
Prediction Loss: 0.507058
Epoch 2099 
Prediction Loss: 0.512289
Epoch 2149 
Prediction Loss: 0.511100
Epoch 2199 
Prediction Loss: 0.506866
Epoch 2249 
Prediction Loss: 0.500971
Epoch 2299 
Prediction Loss: 0.501285
Epoch 2349 
Prediction Loss: 0.509691
Epoch 2399 
Prediction Loss: 0.495647
Epoch 2449 
Prediction Loss: 0.504472
Epoch 2499 
Prediction Loss: 0.494061
Epoch 2549 
Prediction Loss: 0.490146
Epoch 2599 
Prediction Loss: 0.489396
Epoch 2649 
Prediction Loss: 0.488519
Epoch 2699 
Prediction Loss: 0.490303
Epoch 2749 
Prediction Loss: 0.491374
Epoch 2799 
Prediction Loss: 0.487083
Epoch 2849 
Prediction Loss: 0.486478
Epoch 2899 
Prediction Loss: 0.478668
Epoch 2949 
Prediction Loss: 0.479356
Epoch 2999 
Prediction Loss: 0.475637
Epoch 3049 
Prediction Loss: 0.473796
Epoch 3099 
Prediction Loss: 0.488143
Epoch 3149 
Prediction Loss: 0.474680
Epoch 3199 
Prediction Loss: 0.472334
Epoch 3249 
Prediction Loss: 0.477110
Epoch 3299 
Prediction Loss: 0.468197
Epoch 3349 
Prediction Loss: 0.471549
Epoch 3399 
Prediction Loss: 0.460358
Epoch 3449 
Prediction Loss: 0.468422
Epoch 3499 
Prediction Loss: 0.464985
Epoch 3549 
Prediction Loss: 0.460804
Epoch 3599 
Prediction Loss: 0.464712
Epoch 3649 
Prediction Loss: 0.457533
Epoch 3699 
Prediction Loss: 0.461961
Epoch 3749 
Prediction Loss: 0.455703
Epoch 3799 
Prediction Loss: 0.454536
Epoch 3849 
Prediction Loss: 0.457268
Epoch 3899 
Prediction Loss: 0.450626
Epoch 3949 
Prediction Loss: 0.455037
Epoch 3999 
Prediction Loss: 0.454136
Epoch 4049 
Prediction Loss: 0.454139
Epoch 4099 
Prediction Loss: 0.443994
Epoch 4149 
Prediction Loss: 0.444076
Epoch 4199 
Prediction Loss: 0.442798
Epoch 4249 
Prediction Loss: 0.439823
Epoch 4299 
Prediction Loss: 0.433495
Epoch 4349 
Prediction Loss: 0.441535
Epoch 4399 
Prediction Loss: 0.436135
Epoch 4449 
Prediction Loss: 0.449572
Epoch 4499 
Prediction Loss: 0.430517
Epoch 4549 
Prediction Loss: 0.428001
Epoch 4599 
Prediction Loss: 0.429483
Epoch 4649 
Prediction Loss: 0.427319
Epoch 4699 
Prediction Loss: 0.431593
Epoch 4749 
Prediction Loss: 0.423171
Epoch 4799 
Prediction Loss: 0.428955
Epoch 4849 
Prediction Loss: 0.419756
Epoch 4899 
Prediction Loss: 0.423918
Epoch 4949 
Prediction Loss: 0.417615
Epoch 4999 
Prediction Loss: 0.415492
Epoch 5049 
Prediction Loss: 0.416565
Epoch 5099 
Prediction Loss: 0.412889
Epoch 5149 
Prediction Loss: 0.416806
Epoch 5199 
Prediction Loss: 0.413339
Epoch 5249 
Prediction Loss: 0.412143
Epoch 5299 
Prediction Loss: 0.418052
Epoch 5349 
Prediction Loss: 0.415230
Epoch 5399 
Prediction Loss: 0.403736
Epoch 5449 
Prediction Loss: 0.402475
Epoch 5499 
Prediction Loss: 0.401049
Epoch 5549 
Prediction Loss: 0.398822
Epoch 5599 
Prediction Loss: 0.407322
Epoch 5649 
Prediction Loss: 0.403282
Epoch 5699 
Prediction Loss: 0.401233
Epoch 5749 
Prediction Loss: 0.394674
Epoch 5799 
Prediction Loss: 0.392596
Epoch 5849 
Prediction Loss: 0.396921
Epoch 5899 
Prediction Loss: 0.390192
Epoch 5949 
Prediction Loss: 0.393532
Epoch 5999 
Prediction Loss: 0.398809
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.633148
Insample Error 1.632346
[31m========== repeat time 3 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.057094
Rec Loss: 10.001589
KL Loss: 1.055505
Y Loss: 0.802202
T Loss: 9.600489
Epoch 99 
Overall Loss: 10.805668
Rec Loss: 10.010198
KL Loss: 0.795470
Y Loss: 0.704681
T Loss: 9.657857
Epoch 149 
Overall Loss: 10.702449
Rec Loss: 9.970630
KL Loss: 0.731819
Y Loss: 0.661897
T Loss: 9.639681
Epoch 199 
Overall Loss: 10.668308
Rec Loss: 9.959464
KL Loss: 0.708844
Y Loss: 0.631495
T Loss: 9.643716
Epoch 249 
Overall Loss: 10.653636
Rec Loss: 9.936935
KL Loss: 0.716701
Y Loss: 0.613267
T Loss: 9.630301
Epoch 299 
Overall Loss: 10.617662
Rec Loss: 9.925680
KL Loss: 0.691982
Y Loss: 0.604911
T Loss: 9.623224
Epoch 349 
Overall Loss: 10.608821
Rec Loss: 9.915342
KL Loss: 0.693479
Y Loss: 0.590112
T Loss: 9.620286
Epoch 399 
Overall Loss: 10.599482
Rec Loss: 9.891125
KL Loss: 0.708357
Y Loss: 0.576838
T Loss: 9.602706
Epoch 449 
Overall Loss: 10.604342
Rec Loss: 9.920309
KL Loss: 0.684033
Y Loss: 0.584808
T Loss: 9.627905
Epoch 499 
Overall Loss: 10.603517
Rec Loss: 9.903828
KL Loss: 0.699690
Y Loss: 0.577545
T Loss: 9.615056
Epoch 549 
Overall Loss: 10.593308
Rec Loss: 9.894767
KL Loss: 0.698541
Y Loss: 0.574421
T Loss: 9.607556
Epoch 599 
Overall Loss: 10.619435
Rec Loss: 9.895037
KL Loss: 0.724397
Y Loss: 0.562997
T Loss: 9.613539
Epoch 649 
Overall Loss: 10.581392
Rec Loss: 9.886436
KL Loss: 0.694956
Y Loss: 0.561767
T Loss: 9.605553
Epoch 699 
Overall Loss: 10.568736
Rec Loss: 9.886778
KL Loss: 0.681959
Y Loss: 0.555234
T Loss: 9.609161
Epoch 749 
Overall Loss: 10.566068
Rec Loss: 9.877588
KL Loss: 0.688480
Y Loss: 0.550815
T Loss: 9.602180
Epoch 799 
Overall Loss: 10.554160
Rec Loss: 9.869496
KL Loss: 0.684664
Y Loss: 0.557437
T Loss: 9.590778
Epoch 849 
Overall Loss: 10.564962
Rec Loss: 9.877315
KL Loss: 0.687647
Y Loss: 0.552990
T Loss: 9.600820
Epoch 899 
Overall Loss: 10.546721
Rec Loss: 9.869458
KL Loss: 0.677264
Y Loss: 0.546424
T Loss: 9.596246
Epoch 949 
Overall Loss: 10.559257
Rec Loss: 9.876867
KL Loss: 0.682390
Y Loss: 0.548419
T Loss: 9.602657
Epoch 999 
Overall Loss: 10.541721
Rec Loss: 9.870779
KL Loss: 0.670942
Y Loss: 0.551055
T Loss: 9.595252
Epoch 1049 
Overall Loss: 10.538482
Rec Loss: 9.850148
KL Loss: 0.688335
Y Loss: 0.553540
T Loss: 9.573378
Epoch 1099 
Overall Loss: 10.525457
Rec Loss: 9.852837
KL Loss: 0.672620
Y Loss: 0.539690
T Loss: 9.582992
Epoch 1149 
Overall Loss: 10.551339
Rec Loss: 9.863330
KL Loss: 0.688009
Y Loss: 0.546941
T Loss: 9.589859
Epoch 1199 
Overall Loss: 10.538599
Rec Loss: 9.852915
KL Loss: 0.685683
Y Loss: 0.537903
T Loss: 9.583964
Epoch 1249 
Overall Loss: 10.524663
Rec Loss: 9.860023
KL Loss: 0.664640
Y Loss: 0.537355
T Loss: 9.591345
Epoch 1299 
Overall Loss: 10.521231
Rec Loss: 9.830474
KL Loss: 0.690757
Y Loss: 0.540138
T Loss: 9.560405
Epoch 1349 
Overall Loss: 10.531078
Rec Loss: 9.842768
KL Loss: 0.688310
Y Loss: 0.532296
T Loss: 9.576619
Epoch 1399 
Overall Loss: 10.538493
Rec Loss: 9.852360
KL Loss: 0.686134
Y Loss: 0.541080
T Loss: 9.581820
Epoch 1449 
Overall Loss: 10.520949
Rec Loss: 9.853400
KL Loss: 0.667550
Y Loss: 0.541175
T Loss: 9.582812
Epoch 1499 
Overall Loss: 10.527406
Rec Loss: 9.834233
KL Loss: 0.693172
Y Loss: 0.541931
T Loss: 9.563267
Epoch 1549 
Overall Loss: 10.569992
Rec Loss: 9.846259
KL Loss: 0.723733
Y Loss: 0.541801
T Loss: 9.575359
Epoch 1599 
Overall Loss: 10.520894
Rec Loss: 9.840425
KL Loss: 0.680469
Y Loss: 0.528872
T Loss: 9.575989
Epoch 1649 
Overall Loss: 10.526106
Rec Loss: 9.825503
KL Loss: 0.700603
Y Loss: 0.529811
T Loss: 9.560598
Epoch 1699 
Overall Loss: 10.509536
Rec Loss: 9.828600
KL Loss: 0.680936
Y Loss: 0.519198
T Loss: 9.569001
Epoch 1749 
Overall Loss: 10.507187
Rec Loss: 9.821600
KL Loss: 0.685587
Y Loss: 0.515439
T Loss: 9.563881
Epoch 1799 
Overall Loss: 10.498267
Rec Loss: 9.826872
KL Loss: 0.671395
Y Loss: 0.517416
T Loss: 9.568164
Epoch 1849 
Overall Loss: 10.507749
Rec Loss: 9.825931
KL Loss: 0.681818
Y Loss: 0.526056
T Loss: 9.562903
Epoch 1899 
Overall Loss: 10.493064
Rec Loss: 9.805274
KL Loss: 0.687791
Y Loss: 0.513610
T Loss: 9.548469
Epoch 1949 
Overall Loss: 10.503130
Rec Loss: 9.800861
KL Loss: 0.702269
Y Loss: 0.510681
T Loss: 9.545520
Epoch 1999 
Overall Loss: 10.489984
Rec Loss: 9.806516
KL Loss: 0.683468
Y Loss: 0.513182
T Loss: 9.549924
Epoch 2049 
Overall Loss: 10.502163
Rec Loss: 9.818050
KL Loss: 0.684113
Y Loss: 0.513509
T Loss: 9.561295
Epoch 2099 
Overall Loss: 10.491778
Rec Loss: 9.792554
KL Loss: 0.699225
Y Loss: 0.510751
T Loss: 9.537178
Epoch 2149 
Overall Loss: 10.492942
Rec Loss: 9.809112
KL Loss: 0.683830
Y Loss: 0.512436
T Loss: 9.552894
Epoch 2199 
Overall Loss: 10.492107
Rec Loss: 9.791455
KL Loss: 0.700652
Y Loss: 0.501576
T Loss: 9.540667
Epoch 2249 
Overall Loss: 10.491476
Rec Loss: 9.796324
KL Loss: 0.695151
Y Loss: 0.506653
T Loss: 9.542997
Epoch 2299 
Overall Loss: 10.470885
Rec Loss: 9.787047
KL Loss: 0.683838
Y Loss: 0.505797
T Loss: 9.534148
Epoch 2349 
Overall Loss: 10.502519
Rec Loss: 9.811568
KL Loss: 0.690951
Y Loss: 0.501126
T Loss: 9.561005
Epoch 2399 
Overall Loss: 10.493236
Rec Loss: 9.797240
KL Loss: 0.695995
Y Loss: 0.504627
T Loss: 9.544927
Epoch 2449 
Overall Loss: 10.469317
Rec Loss: 9.784174
KL Loss: 0.685143
Y Loss: 0.497052
T Loss: 9.535648
Epoch 2499 
Overall Loss: 10.459663
Rec Loss: 9.790469
KL Loss: 0.669195
Y Loss: 0.489084
T Loss: 9.545927
Epoch 2549 
Overall Loss: 10.461800
Rec Loss: 9.780572
KL Loss: 0.681228
Y Loss: 0.494219
T Loss: 9.533463
Epoch 2599 
Overall Loss: 10.482570
Rec Loss: 9.780726
KL Loss: 0.701844
Y Loss: 0.493813
T Loss: 9.533819
Epoch 2649 
Overall Loss: 10.464972
Rec Loss: 9.769380
KL Loss: 0.695592
Y Loss: 0.487286
T Loss: 9.525737
Epoch 2699 
Overall Loss: 10.451940
Rec Loss: 9.777334
KL Loss: 0.674605
Y Loss: 0.483788
T Loss: 9.535440
Epoch 2749 
Overall Loss: 10.455906
Rec Loss: 9.764916
KL Loss: 0.690990
Y Loss: 0.483385
T Loss: 9.523223
Epoch 2799 
Overall Loss: 10.440777
Rec Loss: 9.764263
KL Loss: 0.676514
Y Loss: 0.483537
T Loss: 9.522495
Epoch 2849 
Overall Loss: 10.463038
Rec Loss: 9.776820
KL Loss: 0.686218
Y Loss: 0.483035
T Loss: 9.535302
Epoch 2899 
Overall Loss: 10.468477
Rec Loss: 9.772906
KL Loss: 0.695571
Y Loss: 0.493397
T Loss: 9.526208
Epoch 2949 
Overall Loss: 10.449069
Rec Loss: 9.763858
KL Loss: 0.685211
Y Loss: 0.475583
T Loss: 9.526066
Epoch 2999 
Overall Loss: 10.464957
Rec Loss: 9.778628
KL Loss: 0.686328
Y Loss: 0.479339
T Loss: 9.538959
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.476010
Epoch 99
Rec Loss: 0.471674
Epoch 149
Rec Loss: 0.472235
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.184380
Epoch 99
Rec Loss: 10.166613
Epoch 149
Rec Loss: 10.163152
Epoch 199
Rec Loss: 10.168736
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.673125
Insample Error: 1.474669
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 16.675021
Rec Loss: 12.567785
KL Loss: 4.107236
Y Loss: 7.938599
T Loss: 13.537744
X Loss: -4.939258
Epoch 99 
Overall Loss: -1.353062
Rec Loss: -10.350234
KL Loss: 8.997173
Y Loss: 2.222486
T Loss: 13.268876
X Loss: -24.730353
Epoch 149 
Overall Loss: -5.834748
Rec Loss: -15.558540
KL Loss: 9.723792
Y Loss: 1.614637
T Loss: 13.235119
X Loss: -29.600978
Epoch 199 
Overall Loss: -9.363027
Rec Loss: -20.098663
KL Loss: 10.735636
Y Loss: 1.032933
T Loss: 13.195458
X Loss: -33.810587
Epoch 249 
Overall Loss: -11.643966
Rec Loss: -23.254225
KL Loss: 11.610259
Y Loss: 0.675671
T Loss: 13.138025
X Loss: -36.730084
Epoch 299 
Overall Loss: -13.065919
Rec Loss: -25.351598
KL Loss: 12.285680
Y Loss: 0.516729
T Loss: 12.988033
X Loss: -38.597995
Epoch 349 
Overall Loss: -14.112865
Rec Loss: -26.847152
KL Loss: 12.734286
Y Loss: 0.491124
T Loss: 12.709429
X Loss: -39.802143
Epoch 399 
Overall Loss: -15.056789
Rec Loss: -28.321733
KL Loss: 13.264943
Y Loss: 0.479781
T Loss: 12.196684
X Loss: -40.758308
Epoch 449 
Overall Loss: -15.907069
Rec Loss: -29.601393
KL Loss: 13.694324
Y Loss: 0.446865
T Loss: 11.830583
X Loss: -41.655409
Epoch 499 
Overall Loss: -16.374336
Rec Loss: -30.244464
KL Loss: 13.870129
Y Loss: 0.457587
T Loss: 11.714802
X Loss: -42.188059
Epoch 549 
Overall Loss: -17.022465
Rec Loss: -31.045440
KL Loss: 14.022976
Y Loss: 0.461866
T Loss: 11.660912
X Loss: -42.937285
Epoch 599 
Overall Loss: -17.378993
Rec Loss: -31.538037
KL Loss: 14.159045
Y Loss: 0.456119
T Loss: 11.587354
X Loss: -43.353452
Epoch 649 
Overall Loss: -17.450975
Rec Loss: -31.746348
KL Loss: 14.295373
Y Loss: 0.468693
T Loss: 11.577274
X Loss: -43.557968
Epoch 699 
Overall Loss: -18.209239
Rec Loss: -32.638198
KL Loss: 14.428958
Y Loss: 0.461665
T Loss: 11.516378
X Loss: -44.385409
Epoch 749 
Overall Loss: -18.619308
Rec Loss: -33.020128
KL Loss: 14.400819
Y Loss: 0.471854
T Loss: 11.493864
X Loss: -44.749917
Epoch 799 
Overall Loss: -19.070174
Rec Loss: -33.633964
KL Loss: 14.563791
Y Loss: 0.462689
T Loss: 11.457523
X Loss: -45.322832
Epoch 849 
Overall Loss: -19.562789
Rec Loss: -34.152657
KL Loss: 14.589867
Y Loss: 0.472776
T Loss: 11.448475
X Loss: -45.837520
Epoch 899 
Overall Loss: -19.939786
Rec Loss: -34.799407
KL Loss: 14.859620
Y Loss: 0.450125
T Loss: 11.409167
X Loss: -46.433635
Epoch 949 
Overall Loss: -20.102053
Rec Loss: -34.941862
KL Loss: 14.839809
Y Loss: 0.455300
T Loss: 11.378426
X Loss: -46.547938
Epoch 999 
Overall Loss: -20.026484
Rec Loss: -35.022730
KL Loss: 14.996246
Y Loss: 0.447283
T Loss: 11.384186
X Loss: -46.630557
Epoch 1049 
Overall Loss: -20.704075
Rec Loss: -35.758060
KL Loss: 15.053986
Y Loss: 0.440881
T Loss: 11.339228
X Loss: -47.317730
Epoch 1099 
Overall Loss: -20.939229
Rec Loss: -35.882431
KL Loss: 14.943202
Y Loss: 0.469899
T Loss: 11.338178
X Loss: -47.455558
Epoch 1149 
Overall Loss: -21.150602
Rec Loss: -36.296520
KL Loss: 15.145917
Y Loss: 0.464067
T Loss: 11.322553
X Loss: -47.851106
Epoch 1199 
Overall Loss: -21.365631
Rec Loss: -36.552731
KL Loss: 15.187099
Y Loss: 0.454242
T Loss: 11.302867
X Loss: -48.082719
Epoch 1249 
Overall Loss: -21.706614
Rec Loss: -36.918655
KL Loss: 15.212041
Y Loss: 0.458044
T Loss: 11.295739
X Loss: -48.443415
Epoch 1299 
Overall Loss: -21.714244
Rec Loss: -36.937658
KL Loss: 15.223413
Y Loss: 0.473205
T Loss: 11.280969
X Loss: -48.455229
Epoch 1349 
Overall Loss: -21.757656
Rec Loss: -36.983658
KL Loss: 15.226003
Y Loss: 0.475233
T Loss: 11.259012
X Loss: -48.480287
Epoch 1399 
Overall Loss: -22.324012
Rec Loss: -37.683600
KL Loss: 15.359587
Y Loss: 0.471537
T Loss: 11.233338
X Loss: -49.152705
Epoch 1449 
Overall Loss: -22.415171
Rec Loss: -37.483889
KL Loss: 15.068719
Y Loss: 0.504581
T Loss: 11.255013
X Loss: -48.991193
Epoch 1499 
Overall Loss: -22.142557
Rec Loss: -37.593128
KL Loss: 15.450572
Y Loss: 0.472870
T Loss: 11.194735
X Loss: -49.024297
Epoch 1549 
Overall Loss: -22.681952
Rec Loss: -38.203043
KL Loss: 15.521091
Y Loss: 0.479904
T Loss: 11.190988
X Loss: -49.633984
Epoch 1599 
Overall Loss: -22.992636
Rec Loss: -38.386289
KL Loss: 15.393653
Y Loss: 0.486564
T Loss: 11.185068
X Loss: -49.814638
Epoch 1649 
Overall Loss: -22.987570
Rec Loss: -38.551239
KL Loss: 15.563670
Y Loss: 0.465377
T Loss: 11.171346
X Loss: -49.955275
Epoch 1699 
Overall Loss: -23.423176
Rec Loss: -38.983145
KL Loss: 15.559970
Y Loss: 0.480958
T Loss: 11.151216
X Loss: -50.374841
Epoch 1749 
Overall Loss: -23.401915
Rec Loss: -38.675968
KL Loss: 15.274053
Y Loss: 0.503381
T Loss: 11.163131
X Loss: -50.090789
Epoch 1799 
Overall Loss: -23.675826
Rec Loss: -39.362696
KL Loss: 15.686869
Y Loss: 0.485341
T Loss: 11.137561
X Loss: -50.742927
Epoch 1849 
Overall Loss: -23.645151
Rec Loss: -39.200055
KL Loss: 15.554903
Y Loss: 0.474072
T Loss: 11.135660
X Loss: -50.572750
Epoch 1899 
Overall Loss: -23.837824
Rec Loss: -39.582577
KL Loss: 15.744754
Y Loss: 0.472768
T Loss: 11.124815
X Loss: -50.943776
Epoch 1949 
Overall Loss: -23.972204
Rec Loss: -39.807528
KL Loss: 15.835323
Y Loss: 0.453517
T Loss: 11.111897
X Loss: -51.146182
Epoch 1999 
Overall Loss: -24.150194
Rec Loss: -39.922815
KL Loss: 15.772621
Y Loss: 0.437962
T Loss: 11.105351
X Loss: -51.247146
Epoch 2049 
Overall Loss: -23.824860
Rec Loss: -39.480087
KL Loss: 15.655227
Y Loss: 0.455584
T Loss: 11.106411
X Loss: -50.814289
Epoch 2099 
Overall Loss: -24.479110
Rec Loss: -40.193333
KL Loss: 15.714224
Y Loss: 0.479881
T Loss: 11.105023
X Loss: -51.538298
Epoch 2149 
Overall Loss: -24.458981
Rec Loss: -40.315827
KL Loss: 15.856846
Y Loss: 0.444149
T Loss: 11.066819
X Loss: -51.604721
Epoch 2199 
Overall Loss: -24.489078
Rec Loss: -40.322110
KL Loss: 15.833033
Y Loss: 0.459924
T Loss: 11.074980
X Loss: -51.627053
Epoch 2249 
Overall Loss: -24.868400
Rec Loss: -40.778828
KL Loss: 15.910427
Y Loss: 0.445965
T Loss: 11.068846
X Loss: -52.070656
Epoch 2299 
Overall Loss: -24.801057
Rec Loss: -40.807401
KL Loss: 16.006344
Y Loss: 0.429789
T Loss: 11.065449
X Loss: -52.087746
Epoch 2349 
Overall Loss: -24.398659
Rec Loss: -40.263283
KL Loss: 15.864624
Y Loss: 0.449125
T Loss: 11.077463
X Loss: -51.565309
Epoch 2399 
Overall Loss: -24.050904
Rec Loss: -40.019600
KL Loss: 15.968696
Y Loss: 0.442854
T Loss: 11.056148
X Loss: -51.297175
Epoch 2449 
Overall Loss: -24.985935
Rec Loss: -40.811107
KL Loss: 15.825173
Y Loss: 0.447515
T Loss: 11.075903
X Loss: -52.110768
Epoch 2499 
Overall Loss: -24.474617
Rec Loss: -40.344070
KL Loss: 15.869453
Y Loss: 0.435791
T Loss: 11.064525
X Loss: -51.626490
Epoch 2549 
Overall Loss: -25.516780
Rec Loss: -41.358239
KL Loss: 15.841459
Y Loss: 0.455947
T Loss: 11.064922
X Loss: -52.651134
Epoch 2599 
Overall Loss: -24.671093
Rec Loss: -40.621094
KL Loss: 15.950001
Y Loss: 0.431380
T Loss: 11.059471
X Loss: -51.896256
Epoch 2649 
Overall Loss: -25.343727
Rec Loss: -41.403360
KL Loss: 16.059633
Y Loss: 0.405803
T Loss: 11.045872
X Loss: -52.652133
Epoch 2699 
Overall Loss: -25.232962
Rec Loss: -40.952783
KL Loss: 15.719819
Y Loss: 0.445784
T Loss: 11.077888
X Loss: -52.253562
Epoch 2749 
Overall Loss: -25.706707
Rec Loss: -41.660866
KL Loss: 15.954158
Y Loss: 0.439747
T Loss: 11.048443
X Loss: -52.929182
Epoch 2799 
Overall Loss: -25.291412
Rec Loss: -41.187025
KL Loss: 15.895613
Y Loss: 0.422052
T Loss: 11.059747
X Loss: -52.457799
Epoch 2849 
Overall Loss: -25.967458
Rec Loss: -41.992459
KL Loss: 16.025004
Y Loss: 0.424078
T Loss: 11.048412
X Loss: -53.252912
Epoch 2899 
Overall Loss: -25.956109
Rec Loss: -42.016497
KL Loss: 16.060386
Y Loss: 0.404916
T Loss: 11.050891
X Loss: -53.269844
Epoch 2949 
Overall Loss: -25.246874
Rec Loss: -41.379921
KL Loss: 16.133047
Y Loss: 0.399209
T Loss: 11.043782
X Loss: -52.623308
Epoch 2999 
Overall Loss: -25.621131
Rec Loss: -41.709778
KL Loss: 16.088648
Y Loss: 0.409358
T Loss: 11.043555
X Loss: -52.958013
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.392401
Epoch 99
Rec Loss: 2.395310
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.005242
Epoch 99
Rec Loss: 0.002799
Epoch 149
Rec Loss: 0.002373
Epoch 199
Rec Loss: 0.002191
Epoch 249
Rec Loss: 0.002018
Epoch 299
Rec Loss: 0.001673
Epoch 349
Rec Loss: 0.001573
Epoch 399
Rec Loss: 0.001466
Epoch 449
Rec Loss: 0.002045
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.356919
Insample Error 2.683971
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 1.043571
Epoch 99 
Prediction Loss: 0.752004
Epoch 149 
Prediction Loss: 0.672651
Epoch 199 
Prediction Loss: 0.635653
Epoch 249 
Prediction Loss: 0.616943
Epoch 299 
Prediction Loss: 0.601130
Epoch 349 
Prediction Loss: 0.601412
Epoch 399 
Prediction Loss: 0.580421
Epoch 449 
Prediction Loss: 0.570911
Epoch 499 
Prediction Loss: 0.570966
Epoch 549 
Prediction Loss: 0.564702
Epoch 599 
Prediction Loss: 0.558604
Epoch 649 
Prediction Loss: 0.546219
Epoch 699 
Prediction Loss: 0.543280
Epoch 749 
Prediction Loss: 0.539312
Epoch 799 
Prediction Loss: 0.535797
Epoch 849 
Prediction Loss: 0.537713
Epoch 899 
Prediction Loss: 0.528564
Epoch 949 
Prediction Loss: 0.529425
Epoch 999 
Prediction Loss: 0.524864
Epoch 1049 
Prediction Loss: 0.518365
Epoch 1099 
Prediction Loss: 0.522201
Epoch 1149 
Prediction Loss: 0.518431
Epoch 1199 
Prediction Loss: 0.510464
Epoch 1249 
Prediction Loss: 0.508413
Epoch 1299 
Prediction Loss: 0.505487
Epoch 1349 
Prediction Loss: 0.506462
Epoch 1399 
Prediction Loss: 0.502629
Epoch 1449 
Prediction Loss: 0.500946
Epoch 1499 
Prediction Loss: 0.496439
Epoch 1549 
Prediction Loss: 0.490534
Epoch 1599 
Prediction Loss: 0.495089
Epoch 1649 
Prediction Loss: 0.491285
Epoch 1699 
Prediction Loss: 0.485139
Epoch 1749 
Prediction Loss: 0.488403
Epoch 1799 
Prediction Loss: 0.480847
Epoch 1849 
Prediction Loss: 0.488880
Epoch 1899 
Prediction Loss: 0.476396
Epoch 1949 
Prediction Loss: 0.479896
Epoch 1999 
Prediction Loss: 0.473765
Epoch 2049 
Prediction Loss: 0.468605
Epoch 2099 
Prediction Loss: 0.464843
Epoch 2149 
Prediction Loss: 0.465044
Epoch 2199 
Prediction Loss: 0.459185
Epoch 2249 
Prediction Loss: 0.460448
Epoch 2299 
Prediction Loss: 0.458435
Epoch 2349 
Prediction Loss: 0.462907
Epoch 2399 
Prediction Loss: 0.463834
Epoch 2449 
Prediction Loss: 0.450564
Epoch 2499 
Prediction Loss: 0.448901
Epoch 2549 
Prediction Loss: 0.444249
Epoch 2599 
Prediction Loss: 0.457999
Epoch 2649 
Prediction Loss: 0.440601
Epoch 2699 
Prediction Loss: 0.442365
Epoch 2749 
Prediction Loss: 0.445632
Epoch 2799 
Prediction Loss: 0.448469
Epoch 2849 
Prediction Loss: 0.437457
Epoch 2899 
Prediction Loss: 0.443688
Epoch 2949 
Prediction Loss: 0.426283
Epoch 2999 
Prediction Loss: 0.427135
Epoch 3049 
Prediction Loss: 0.424785
Epoch 3099 
Prediction Loss: 0.420449
Epoch 3149 
Prediction Loss: 0.418612
Epoch 3199 
Prediction Loss: 0.417145
Epoch 3249 
Prediction Loss: 0.418438
Epoch 3299 
Prediction Loss: 0.410922
Epoch 3349 
Prediction Loss: 0.411804
Epoch 3399 
Prediction Loss: 0.407249
Epoch 3449 
Prediction Loss: 0.416466
Epoch 3499 
Prediction Loss: 0.410547
Epoch 3549 
Prediction Loss: 0.408125
Epoch 3599 
Prediction Loss: 0.398493
Epoch 3649 
Prediction Loss: 0.401023
Epoch 3699 
Prediction Loss: 0.402016
Epoch 3749 
Prediction Loss: 0.402174
Epoch 3799 
Prediction Loss: 0.396662
Epoch 3849 
Prediction Loss: 0.398470
Epoch 3899 
Prediction Loss: 0.399058
Epoch 3949 
Prediction Loss: 0.391645
Epoch 3999 
Prediction Loss: 0.385962
Epoch 4049 
Prediction Loss: 0.386368
Epoch 4099 
Prediction Loss: 0.383976
Epoch 4149 
Prediction Loss: 0.384736
Epoch 4199 
Prediction Loss: 0.381808
Epoch 4249 
Prediction Loss: 0.385206
Epoch 4299 
Prediction Loss: 0.381846
Epoch 4349 
Prediction Loss: 0.384877
Epoch 4399 
Prediction Loss: 0.378553
Epoch 4449 
Prediction Loss: 0.373140
Epoch 4499 
Prediction Loss: 0.369152
Epoch 4549 
Prediction Loss: 0.373710
Epoch 4599 
Prediction Loss: 0.373341
Epoch 4649 
Prediction Loss: 0.370299
Epoch 4699 
Prediction Loss: 0.365011
Epoch 4749 
Prediction Loss: 0.366029
Epoch 4799 
Prediction Loss: 0.368039
Epoch 4849 
Prediction Loss: 0.362483
Epoch 4899 
Prediction Loss: 0.363891
Epoch 4949 
Prediction Loss: 0.360514
Epoch 4999 
Prediction Loss: 0.361704
Epoch 5049 
Prediction Loss: 0.351511
Epoch 5099 
Prediction Loss: 0.366563
Epoch 5149 
Prediction Loss: 0.352578
Epoch 5199 
Prediction Loss: 0.350704
Epoch 5249 
Prediction Loss: 0.353514
Epoch 5299 
Prediction Loss: 0.347516
Epoch 5349 
Prediction Loss: 0.351232
Epoch 5399 
Prediction Loss: 0.351263
Epoch 5449 
Prediction Loss: 0.351343
Epoch 5499 
Prediction Loss: 0.342325
Epoch 5549 
Prediction Loss: 0.347724
Epoch 5599 
Prediction Loss: 0.350877
Epoch 5649 
Prediction Loss: 0.337381
Epoch 5699 
Prediction Loss: 0.339982
Epoch 5749 
Prediction Loss: 0.336028
Epoch 5799 
Prediction Loss: 0.341709
Epoch 5849 
Prediction Loss: 0.344752
Epoch 5899 
Prediction Loss: 0.334728
Epoch 5949 
Prediction Loss: 0.339630
Epoch 5999 
Prediction Loss: 0.334578
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.575939
Insample Error 1.667234
[31m========== repeat time 4 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 11.035590
Rec Loss: 10.082665
KL Loss: 0.952925
Y Loss: 0.956527
T Loss: 9.604402
Epoch 99 
Overall Loss: 10.771971
Rec Loss: 10.007303
KL Loss: 0.764667
Y Loss: 0.738996
T Loss: 9.637805
Epoch 149 
Overall Loss: 10.690619
Rec Loss: 9.973935
KL Loss: 0.716684
Y Loss: 0.670549
T Loss: 9.638661
Epoch 199 
Overall Loss: 10.650223
Rec Loss: 9.949139
KL Loss: 0.701084
Y Loss: 0.637019
T Loss: 9.630630
Epoch 249 
Overall Loss: 10.635559
Rec Loss: 9.912603
KL Loss: 0.722957
Y Loss: 0.609868
T Loss: 9.607669
Epoch 299 
Overall Loss: 10.615312
Rec Loss: 9.915322
KL Loss: 0.699989
Y Loss: 0.597115
T Loss: 9.616765
Epoch 349 
Overall Loss: 10.603974
Rec Loss: 9.901528
KL Loss: 0.702447
Y Loss: 0.589340
T Loss: 9.606858
Epoch 399 
Overall Loss: 10.595972
Rec Loss: 9.903544
KL Loss: 0.692429
Y Loss: 0.576211
T Loss: 9.615438
Epoch 449 
Overall Loss: 10.590853
Rec Loss: 9.900533
KL Loss: 0.690320
Y Loss: 0.569351
T Loss: 9.615857
Epoch 499 
Overall Loss: 10.571698
Rec Loss: 9.877733
KL Loss: 0.693965
Y Loss: 0.569109
T Loss: 9.593179
Epoch 549 
Overall Loss: 10.579260
Rec Loss: 9.890936
KL Loss: 0.688325
Y Loss: 0.564777
T Loss: 9.608547
Epoch 599 
Overall Loss: 10.574229
Rec Loss: 9.889200
KL Loss: 0.685030
Y Loss: 0.562449
T Loss: 9.607975
Epoch 649 
Overall Loss: 10.558951
Rec Loss: 9.870031
KL Loss: 0.688919
Y Loss: 0.556983
T Loss: 9.591540
Epoch 699 
Overall Loss: 10.552952
Rec Loss: 9.873811
KL Loss: 0.679141
Y Loss: 0.558009
T Loss: 9.594807
Epoch 749 
Overall Loss: 10.555559
Rec Loss: 9.866387
KL Loss: 0.689172
Y Loss: 0.543670
T Loss: 9.594552
Epoch 799 
Overall Loss: 10.559402
Rec Loss: 9.865710
KL Loss: 0.693692
Y Loss: 0.537182
T Loss: 9.597118
Epoch 849 
Overall Loss: 10.550170
Rec Loss: 9.849609
KL Loss: 0.700560
Y Loss: 0.530990
T Loss: 9.584114
Epoch 899 
Overall Loss: 10.557188
Rec Loss: 9.864144
KL Loss: 0.693043
Y Loss: 0.537479
T Loss: 9.595405
Epoch 949 
Overall Loss: 10.539427
Rec Loss: 9.844385
KL Loss: 0.695042
Y Loss: 0.537111
T Loss: 9.575830
Epoch 999 
Overall Loss: 10.521187
Rec Loss: 9.853641
KL Loss: 0.667546
Y Loss: 0.528799
T Loss: 9.589241
Epoch 1049 
Overall Loss: 10.543550
Rec Loss: 9.846586
KL Loss: 0.696964
Y Loss: 0.537604
T Loss: 9.577784
Epoch 1099 
Overall Loss: 10.521358
Rec Loss: 9.839978
KL Loss: 0.681381
Y Loss: 0.528706
T Loss: 9.575624
Epoch 1149 
Overall Loss: 10.536141
Rec Loss: 9.843919
KL Loss: 0.692222
Y Loss: 0.526241
T Loss: 9.580798
Epoch 1199 
Overall Loss: 10.511196
Rec Loss: 9.826872
KL Loss: 0.684324
Y Loss: 0.524973
T Loss: 9.564385
Epoch 1249 
Overall Loss: 10.525915
Rec Loss: 9.822028
KL Loss: 0.703888
Y Loss: 0.521971
T Loss: 9.561042
Epoch 1299 
Overall Loss: 10.522208
Rec Loss: 9.827627
KL Loss: 0.694581
Y Loss: 0.517697
T Loss: 9.568778
Epoch 1349 
Overall Loss: 10.519398
Rec Loss: 9.826110
KL Loss: 0.693289
Y Loss: 0.511217
T Loss: 9.570501
Epoch 1399 
Overall Loss: 10.558864
Rec Loss: 9.837325
KL Loss: 0.721539
Y Loss: 0.510557
T Loss: 9.582047
Epoch 1449 
Overall Loss: 10.504410
Rec Loss: 9.827259
KL Loss: 0.677150
Y Loss: 0.514330
T Loss: 9.570094
Epoch 1499 
Overall Loss: 10.527698
Rec Loss: 9.842648
KL Loss: 0.685049
Y Loss: 0.512278
T Loss: 9.586510
Epoch 1549 
Overall Loss: 10.487417
Rec Loss: 9.804386
KL Loss: 0.683031
Y Loss: 0.512325
T Loss: 9.548224
Epoch 1599 
Overall Loss: 10.498213
Rec Loss: 9.799623
KL Loss: 0.698589
Y Loss: 0.511815
T Loss: 9.543716
Epoch 1649 
Overall Loss: 10.494345
Rec Loss: 9.799251
KL Loss: 0.695094
Y Loss: 0.493796
T Loss: 9.552353
Epoch 1699 
Overall Loss: 10.503869
Rec Loss: 9.819004
KL Loss: 0.684866
Y Loss: 0.504600
T Loss: 9.566704
Epoch 1749 
Overall Loss: 10.487989
Rec Loss: 9.809503
KL Loss: 0.678486
Y Loss: 0.494800
T Loss: 9.562103
Epoch 1799 
Overall Loss: 10.508906
Rec Loss: 9.809376
KL Loss: 0.699530
Y Loss: 0.498045
T Loss: 9.560353
Epoch 1849 
Overall Loss: 10.485852
Rec Loss: 9.801870
KL Loss: 0.683982
Y Loss: 0.498761
T Loss: 9.552490
Epoch 1899 
Overall Loss: 10.491025
Rec Loss: 9.787668
KL Loss: 0.703357
Y Loss: 0.497021
T Loss: 9.539158
Epoch 1949 
Overall Loss: 10.490213
Rec Loss: 9.789878
KL Loss: 0.700335
Y Loss: 0.494986
T Loss: 9.542385
Epoch 1999 
Overall Loss: 10.475035
Rec Loss: 9.793669
KL Loss: 0.681366
Y Loss: 0.491709
T Loss: 9.547815
Epoch 2049 
Overall Loss: 10.481638
Rec Loss: 9.795181
KL Loss: 0.686457
Y Loss: 0.496274
T Loss: 9.547044
Epoch 2099 
Overall Loss: 10.476240
Rec Loss: 9.780907
KL Loss: 0.695332
Y Loss: 0.485565
T Loss: 9.538125
Epoch 2149 
Overall Loss: 10.475754
Rec Loss: 9.780406
KL Loss: 0.695348
Y Loss: 0.492618
T Loss: 9.534097
Epoch 2199 
Overall Loss: 10.462388
Rec Loss: 9.763040
KL Loss: 0.699348
Y Loss: 0.488869
T Loss: 9.518606
Epoch 2249 
Overall Loss: 10.472424
Rec Loss: 9.787332
KL Loss: 0.685092
Y Loss: 0.485848
T Loss: 9.544408
Epoch 2299 
Overall Loss: 10.471548
Rec Loss: 9.775665
KL Loss: 0.695884
Y Loss: 0.481588
T Loss: 9.534871
Epoch 2349 
Overall Loss: 10.466810
Rec Loss: 9.772075
KL Loss: 0.694735
Y Loss: 0.487698
T Loss: 9.528226
Epoch 2399 
Overall Loss: 10.470155
Rec Loss: 9.770551
KL Loss: 0.699603
Y Loss: 0.475548
T Loss: 9.532777
Epoch 2449 
Overall Loss: 10.476270
Rec Loss: 9.779251
KL Loss: 0.697018
Y Loss: 0.472046
T Loss: 9.543228
Epoch 2499 
Overall Loss: 10.470404
Rec Loss: 9.776724
KL Loss: 0.693680
Y Loss: 0.481027
T Loss: 9.536211
Epoch 2549 
Overall Loss: 10.467960
Rec Loss: 9.772536
KL Loss: 0.695424
Y Loss: 0.478660
T Loss: 9.533206
Epoch 2599 
Overall Loss: 10.452063
Rec Loss: 9.759436
KL Loss: 0.692628
Y Loss: 0.469567
T Loss: 9.524652
Epoch 2649 
Overall Loss: 10.444529
Rec Loss: 9.755754
KL Loss: 0.688775
Y Loss: 0.479382
T Loss: 9.516063
Epoch 2699 
Overall Loss: 10.446949
Rec Loss: 9.760913
KL Loss: 0.686036
Y Loss: 0.475918
T Loss: 9.522954
Epoch 2749 
Overall Loss: 10.459659
Rec Loss: 9.773677
KL Loss: 0.685982
Y Loss: 0.465152
T Loss: 9.541101
Epoch 2799 
Overall Loss: 10.431423
Rec Loss: 9.746102
KL Loss: 0.685320
Y Loss: 0.464090
T Loss: 9.514058
Epoch 2849 
Overall Loss: 10.447506
Rec Loss: 9.749592
KL Loss: 0.697914
Y Loss: 0.468169
T Loss: 9.515508
Epoch 2899 
Overall Loss: 10.438297
Rec Loss: 9.747137
KL Loss: 0.691160
Y Loss: 0.465142
T Loss: 9.514566
Epoch 2949 
Overall Loss: 10.445560
Rec Loss: 9.753238
KL Loss: 0.692322
Y Loss: 0.474373
T Loss: 9.516051
Epoch 2999 
Overall Loss: 10.437119
Rec Loss: 9.748426
KL Loss: 0.688694
Y Loss: 0.466418
T Loss: 9.515217
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.471066
Epoch 99
Rec Loss: 0.470524
Epoch 149
Rec Loss: 0.462378
Epoch 199
Rec Loss: 0.468072
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.186691
Epoch 99
Rec Loss: 10.182703
Epoch 149
Rec Loss: 10.172399
Epoch 199
Rec Loss: 10.173277
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.655025
Insample Error: 1.516376
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 18.757626
Rec Loss: 15.654466
KL Loss: 3.103159
Y Loss: 6.512680
T Loss: 13.322543
X Loss: -0.924416
Epoch 99 
Overall Loss: 1.204286
Rec Loss: -9.235283
KL Loss: 10.439569
Y Loss: 2.296737
T Loss: 12.840471
X Loss: -23.224123
Epoch 149 
Overall Loss: -3.773482
Rec Loss: -15.478280
KL Loss: 11.704797
Y Loss: 1.549036
T Loss: 12.119723
X Loss: -28.372520
Epoch 199 
Overall Loss: -7.121669
Rec Loss: -20.009723
KL Loss: 12.888055
Y Loss: 0.837054
T Loss: 11.678847
X Loss: -32.107097
Epoch 249 
Overall Loss: -9.151865
Rec Loss: -22.966772
KL Loss: 13.814908
Y Loss: 0.491939
T Loss: 11.583098
X Loss: -34.795841
Epoch 299 
Overall Loss: -10.815830
Rec Loss: -25.381454
KL Loss: 14.565625
Y Loss: 0.360546
T Loss: 11.523487
X Loss: -37.085213
Epoch 349 
Overall Loss: -12.102256
Rec Loss: -27.191721
KL Loss: 15.089465
Y Loss: 0.316418
T Loss: 11.481762
X Loss: -38.831693
Epoch 399 
Overall Loss: -12.696414
Rec Loss: -28.102218
KL Loss: 15.405803
Y Loss: 0.399520
T Loss: 11.457410
X Loss: -39.759389
Epoch 449 
Overall Loss: -13.465600
Rec Loss: -29.203148
KL Loss: 15.737548
Y Loss: 0.289523
T Loss: 11.425080
X Loss: -40.772991
Epoch 499 
Overall Loss: -14.239694
Rec Loss: -30.193434
KL Loss: 15.953739
Y Loss: 0.277969
T Loss: 11.388461
X Loss: -41.720880
Epoch 549 
Overall Loss: -14.448164
Rec Loss: -30.595241
KL Loss: 16.147077
Y Loss: 0.275471
T Loss: 11.388475
X Loss: -42.121451
Epoch 599 
Overall Loss: -15.232098
Rec Loss: -31.592194
KL Loss: 16.360095
Y Loss: 0.262216
T Loss: 11.355436
X Loss: -43.078738
Epoch 649 
Overall Loss: -15.795823
Rec Loss: -32.295481
KL Loss: 16.499658
Y Loss: 0.264776
T Loss: 11.325604
X Loss: -43.753472
Epoch 699 
Overall Loss: -16.119102
Rec Loss: -32.722219
KL Loss: 16.603116
Y Loss: 0.267649
T Loss: 11.319603
X Loss: -44.175644
Epoch 749 
Overall Loss: -16.367671
Rec Loss: -32.990740
KL Loss: 16.623069
Y Loss: 0.269493
T Loss: 11.275458
X Loss: -44.400945
Epoch 799 
Overall Loss: -16.978759
Rec Loss: -33.955284
KL Loss: 16.976526
Y Loss: 0.301122
T Loss: 11.248211
X Loss: -45.354056
Epoch 849 
Overall Loss: -17.142713
Rec Loss: -34.081434
KL Loss: 16.938723
Y Loss: 0.259397
T Loss: 11.223057
X Loss: -45.434190
Epoch 899 
Overall Loss: -17.612948
Rec Loss: -34.812394
KL Loss: 17.199444
Y Loss: 0.244499
T Loss: 11.176160
X Loss: -46.110802
Epoch 949 
Overall Loss: -17.948896
Rec Loss: -35.232929
KL Loss: 17.284033
Y Loss: 0.242895
T Loss: 11.133848
X Loss: -46.488223
Epoch 999 
Overall Loss: -18.215121
Rec Loss: -35.580968
KL Loss: 17.365846
Y Loss: 0.247573
T Loss: 11.096488
X Loss: -46.801242
Epoch 1049 
Overall Loss: -18.578614
Rec Loss: -36.162079
KL Loss: 17.583467
Y Loss: 0.228547
T Loss: 11.065640
X Loss: -47.341993
Epoch 1099 
Overall Loss: -18.690756
Rec Loss: -36.379952
KL Loss: 17.689196
Y Loss: 0.241379
T Loss: 11.048816
X Loss: -47.549457
Epoch 1149 
Overall Loss: -18.869661
Rec Loss: -36.584304
KL Loss: 17.714642
Y Loss: 0.230735
T Loss: 11.020648
X Loss: -47.720318
Epoch 1199 
Overall Loss: -19.168428
Rec Loss: -36.921933
KL Loss: 17.753504
Y Loss: 0.231883
T Loss: 10.999871
X Loss: -48.037745
Epoch 1249 
Overall Loss: -19.327518
Rec Loss: -37.215711
KL Loss: 17.888194
Y Loss: 0.220166
T Loss: 10.986564
X Loss: -48.312358
Epoch 1299 
Overall Loss: -19.625482
Rec Loss: -37.481616
KL Loss: 17.856134
Y Loss: 0.233013
T Loss: 10.969484
X Loss: -48.567607
Epoch 1349 
Overall Loss: -19.600823
Rec Loss: -37.522595
KL Loss: 17.921771
Y Loss: 0.219729
T Loss: 10.973765
X Loss: -48.606224
Epoch 1399 
Overall Loss: -19.640582
Rec Loss: -37.749843
KL Loss: 18.109262
Y Loss: 0.228002
T Loss: 10.953750
X Loss: -48.817594
Epoch 1449 
Overall Loss: -20.170000
Rec Loss: -38.298572
KL Loss: 18.128571
Y Loss: 0.224112
T Loss: 10.944140
X Loss: -49.354767
Epoch 1499 
Overall Loss: -19.761478
Rec Loss: -37.960455
KL Loss: 18.198976
Y Loss: 0.218610
T Loss: 10.948480
X Loss: -49.018239
Epoch 1549 
Overall Loss: -20.434284
Rec Loss: -38.647791
KL Loss: 18.213506
Y Loss: 0.223467
T Loss: 10.934895
X Loss: -49.694420
Epoch 1599 
Overall Loss: -19.895370
Rec Loss: -38.219041
KL Loss: 18.323671
Y Loss: 0.220243
T Loss: 10.945513
X Loss: -49.274676
Epoch 1649 
Overall Loss: -20.388626
Rec Loss: -38.585784
KL Loss: 18.197157
Y Loss: 0.218388
T Loss: 10.946545
X Loss: -49.641524
Epoch 1699 
Overall Loss: -20.871833
Rec Loss: -39.104711
KL Loss: 18.232878
Y Loss: 0.213249
T Loss: 10.932064
X Loss: -50.143400
Epoch 1749 
Overall Loss: -20.778323
Rec Loss: -39.162512
KL Loss: 18.384189
Y Loss: 0.217940
T Loss: 10.932377
X Loss: -50.203860
Epoch 1799 
Overall Loss: -21.134349
Rec Loss: -39.513355
KL Loss: 18.379005
Y Loss: 0.219031
T Loss: 10.910132
X Loss: -50.533001
Epoch 1849 
Overall Loss: -21.133110
Rec Loss: -39.662513
KL Loss: 18.529403
Y Loss: 0.216022
T Loss: 10.928175
X Loss: -50.698700
Epoch 1899 
Overall Loss: -20.896411
Rec Loss: -39.328247
KL Loss: 18.431835
Y Loss: 0.228487
T Loss: 10.922125
X Loss: -50.364614
Epoch 1949 
Overall Loss: -21.595293
Rec Loss: -40.228448
KL Loss: 18.633154
Y Loss: 0.219478
T Loss: 10.913362
X Loss: -51.251549
Epoch 1999 
Overall Loss: -21.740581
Rec Loss: -40.413005
KL Loss: 18.672425
Y Loss: 0.212810
T Loss: 10.897398
X Loss: -51.416809
Epoch 2049 
Overall Loss: -21.736551
Rec Loss: -40.367354
KL Loss: 18.630802
Y Loss: 0.221719
T Loss: 10.910586
X Loss: -51.388798
Epoch 2099 
Overall Loss: -22.058540
Rec Loss: -40.693525
KL Loss: 18.634985
Y Loss: 0.218392
T Loss: 10.909869
X Loss: -51.712589
Epoch 2149 
Overall Loss: -21.999255
Rec Loss: -40.389639
KL Loss: 18.390384
Y Loss: 0.225921
T Loss: 10.913222
X Loss: -51.415821
Epoch 2199 
Overall Loss: -21.860130
Rec Loss: -40.474797
KL Loss: 18.614667
Y Loss: 0.215997
T Loss: 10.908599
X Loss: -51.491393
Epoch 2249 
Overall Loss: -21.958599
Rec Loss: -40.829009
KL Loss: 18.870411
Y Loss: 0.215793
T Loss: 10.893249
X Loss: -51.830155
Epoch 2299 
Overall Loss: -22.474572
Rec Loss: -41.132511
KL Loss: 18.657939
Y Loss: 0.211137
T Loss: 10.895326
X Loss: -52.133405
Epoch 2349 
Overall Loss: -22.325691
Rec Loss: -41.301824
KL Loss: 18.976132
Y Loss: 0.221188
T Loss: 10.888698
X Loss: -52.301115
Epoch 2399 
Overall Loss: -22.531228
Rec Loss: -41.408442
KL Loss: 18.877214
Y Loss: 0.215549
T Loss: 10.895792
X Loss: -52.412007
Epoch 2449 
Overall Loss: -21.823916
Rec Loss: -40.426853
KL Loss: 18.602937
Y Loss: 0.221502
T Loss: 10.911999
X Loss: -51.449603
Epoch 2499 
Overall Loss: -22.556867
Rec Loss: -41.337683
KL Loss: 18.780817
Y Loss: 0.213957
T Loss: 10.903921
X Loss: -52.348583
Epoch 2549 
Overall Loss: -22.695354
Rec Loss: -41.578193
KL Loss: 18.882837
Y Loss: 0.220551
T Loss: 10.897508
X Loss: -52.585976
Epoch 2599 
Overall Loss: -22.614445
Rec Loss: -41.612850
KL Loss: 18.998404
Y Loss: 0.215203
T Loss: 10.882355
X Loss: -52.602806
Epoch 2649 
Overall Loss: -21.925169
Rec Loss: -40.884444
KL Loss: 18.959276
Y Loss: 0.216238
T Loss: 10.891474
X Loss: -51.884037
Epoch 2699 
Overall Loss: -22.548222
Rec Loss: -41.716636
KL Loss: 19.168414
Y Loss: 0.217105
T Loss: 10.886802
X Loss: -52.711991
Epoch 2749 
Overall Loss: -23.062278
Rec Loss: -42.134703
KL Loss: 19.072426
Y Loss: 0.216015
T Loss: 10.889955
X Loss: -53.132666
Epoch 2799 
Overall Loss: -23.254941
Rec Loss: -42.426459
KL Loss: 19.171518
Y Loss: 0.212325
T Loss: 10.888411
X Loss: -53.421031
Epoch 2849 
Overall Loss: -23.072567
Rec Loss: -42.279878
KL Loss: 19.207311
Y Loss: 0.218807
T Loss: 10.871144
X Loss: -53.260425
Epoch 2899 
Overall Loss: -22.136484
Rec Loss: -41.399389
KL Loss: 19.262905
Y Loss: 0.220479
T Loss: 10.872276
X Loss: -52.381904
Epoch 2949 
Overall Loss: -23.128496
Rec Loss: -42.346010
KL Loss: 19.217515
Y Loss: 0.219837
T Loss: 10.871490
X Loss: -53.327420
Epoch 2999 
Overall Loss: -22.874136
Rec Loss: -42.089502
KL Loss: 19.215365
Y Loss: 0.217299
T Loss: 10.873648
X Loss: -53.071800
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.365045
Epoch 99
Rec Loss: 2.345199
Epoch 149
Rec Loss: 2.331897
Epoch 199
Rec Loss: 2.322963
Epoch 249
Rec Loss: 2.314600
Epoch 299
Rec Loss: 2.312483
Epoch 349
Rec Loss: 2.313703
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.003895
Epoch 99
Rec Loss: 0.002699
Epoch 149
Rec Loss: 0.001637
Epoch 199
Rec Loss: 0.001962
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.415128
Insample Error 4.613717
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.978907
Epoch 99 
Prediction Loss: 0.702397
Epoch 149 
Prediction Loss: 0.664168
Epoch 199 
Prediction Loss: 0.635824
Epoch 249 
Prediction Loss: 0.624748
Epoch 299 
Prediction Loss: 0.617177
Epoch 349 
Prediction Loss: 0.607646
Epoch 399 
Prediction Loss: 0.595996
Epoch 449 
Prediction Loss: 0.595876
Epoch 499 
Prediction Loss: 0.578927
Epoch 549 
Prediction Loss: 0.582059
Epoch 599 
Prediction Loss: 0.583235
Epoch 649 
Prediction Loss: 0.583857
Epoch 699 
Prediction Loss: 0.571602
Epoch 749 
Prediction Loss: 0.566421
Epoch 799 
Prediction Loss: 0.570848
Epoch 849 
Prediction Loss: 0.561089
Epoch 899 
Prediction Loss: 0.567660
Epoch 949 
Prediction Loss: 0.561868
Epoch 999 
Prediction Loss: 0.558471
Epoch 1049 
Prediction Loss: 0.554128
Epoch 1099 
Prediction Loss: 0.552300
Epoch 1149 
Prediction Loss: 0.555242
Epoch 1199 
Prediction Loss: 0.550432
Epoch 1249 
Prediction Loss: 0.546471
Epoch 1299 
Prediction Loss: 0.546764
Epoch 1349 
Prediction Loss: 0.543895
Epoch 1399 
Prediction Loss: 0.542648
Epoch 1449 
Prediction Loss: 0.542618
Epoch 1499 
Prediction Loss: 0.559319
Epoch 1549 
Prediction Loss: 0.543729
Epoch 1599 
Prediction Loss: 0.547221
Epoch 1649 
Prediction Loss: 0.539485
Epoch 1699 
Prediction Loss: 0.558043
Epoch 1749 
Prediction Loss: 0.536932
Epoch 1799 
Prediction Loss: 0.537331
Epoch 1849 
Prediction Loss: 0.530578
Epoch 1899 
Prediction Loss: 0.529624
Epoch 1949 
Prediction Loss: 0.532849
Epoch 1999 
Prediction Loss: 0.525051
Epoch 2049 
Prediction Loss: 0.525990
Epoch 2099 
Prediction Loss: 0.527521
Epoch 2149 
Prediction Loss: 0.525004
Epoch 2199 
Prediction Loss: 0.531025
Epoch 2249 
Prediction Loss: 0.534857
Epoch 2299 
Prediction Loss: 0.537675
Epoch 2349 
Prediction Loss: 0.530183
Epoch 2399 
Prediction Loss: 0.525096
Epoch 2449 
Prediction Loss: 0.525544
Epoch 2499 
Prediction Loss: 0.517079
Epoch 2549 
Prediction Loss: 0.520019
Epoch 2599 
Prediction Loss: 0.521687
Epoch 2649 
Prediction Loss: 0.521319
Epoch 2699 
Prediction Loss: 0.515082
Epoch 2749 
Prediction Loss: 0.520544
Epoch 2799 
Prediction Loss: 0.509994
Epoch 2849 
Prediction Loss: 0.514873
Epoch 2899 
Prediction Loss: 0.524008
Epoch 2949 
Prediction Loss: 0.509983
Epoch 2999 
Prediction Loss: 0.529830
Epoch 3049 
Prediction Loss: 0.511098
Epoch 3099 
Prediction Loss: 0.508021
Epoch 3149 
Prediction Loss: 0.530923
Epoch 3199 
Prediction Loss: 0.505810
Epoch 3249 
Prediction Loss: 0.519834
Epoch 3299 
Prediction Loss: 0.505995
Epoch 3349 
Prediction Loss: 0.528842
Epoch 3399 
Prediction Loss: 0.517864
Epoch 3449 
Prediction Loss: 0.500986
Epoch 3499 
Prediction Loss: 0.505505
Epoch 3549 
Prediction Loss: 0.502888
Epoch 3599 
Prediction Loss: 0.506759
Epoch 3649 
Prediction Loss: 0.497244
Epoch 3699 
Prediction Loss: 0.504421
Epoch 3749 
Prediction Loss: 0.500321
Epoch 3799 
Prediction Loss: 0.504274
Epoch 3849 
Prediction Loss: 0.505830
Epoch 3899 
Prediction Loss: 0.506666
Epoch 3949 
Prediction Loss: 0.497303
Epoch 3999 
Prediction Loss: 0.496500
Epoch 4049 
Prediction Loss: 0.496821
Epoch 4099 
Prediction Loss: 0.501011
Epoch 4149 
Prediction Loss: 0.500526
Epoch 4199 
Prediction Loss: 0.495039
Epoch 4249 
Prediction Loss: 0.504727
Epoch 4299 
Prediction Loss: 0.493433
Epoch 4349 
Prediction Loss: 0.491448
Epoch 4399 
Prediction Loss: 0.495877
Epoch 4449 
Prediction Loss: 0.489664
Epoch 4499 
Prediction Loss: 0.500679
Epoch 4549 
Prediction Loss: 0.489897
Epoch 4599 
Prediction Loss: 0.491638
Epoch 4649 
Prediction Loss: 0.490321
Epoch 4699 
Prediction Loss: 0.494836
Epoch 4749 
Prediction Loss: 0.482511
Epoch 4799 
Prediction Loss: 0.485907
Epoch 4849 
Prediction Loss: 0.498192
Epoch 4899 
Prediction Loss: 0.484744
Epoch 4949 
Prediction Loss: 0.492518
Epoch 4999 
Prediction Loss: 0.483707
Epoch 5049 
Prediction Loss: 0.483050
Epoch 5099 
Prediction Loss: 0.480260
Epoch 5149 
Prediction Loss: 0.477973
Epoch 5199 
Prediction Loss: 0.481726
Epoch 5249 
Prediction Loss: 0.480800
Epoch 5299 
Prediction Loss: 0.487800
Epoch 5349 
Prediction Loss: 0.479894
Epoch 5399 
Prediction Loss: 0.488238
Epoch 5449 
Prediction Loss: 0.482548
Epoch 5499 
Prediction Loss: 0.475459
Epoch 5549 
Prediction Loss: 0.477639
Epoch 5599 
Prediction Loss: 0.479677
Epoch 5649 
Prediction Loss: 0.470296
Epoch 5699 
Prediction Loss: 0.474568
Epoch 5749 
Prediction Loss: 0.487872
Epoch 5799 
Prediction Loss: 0.479447
Epoch 5849 
Prediction Loss: 0.475125
Epoch 5899 
Prediction Loss: 0.469500
Epoch 5949 
Prediction Loss: 0.470859
Epoch 5999 
Prediction Loss: 0.473533
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.683470
Insample Error 1.612908
[31m========== repeat time 5 ==========[0m
[34m== Ours: Training all ==[0m
Epoch 49 
Overall Loss: 10.981777
Rec Loss: 10.060440
KL Loss: 0.921337
Y Loss: 0.926373
T Loss: 9.597253
Epoch 99 
Overall Loss: 10.754845
Rec Loss: 9.992086
KL Loss: 0.762759
Y Loss: 0.707417
T Loss: 9.638377
Epoch 149 
Overall Loss: 10.688566
Rec Loss: 9.953932
KL Loss: 0.734634
Y Loss: 0.637142
T Loss: 9.635361
Epoch 199 
Overall Loss: 10.662677
Rec Loss: 9.929444
KL Loss: 0.733233
Y Loss: 0.605352
T Loss: 9.626768
Epoch 249 
Overall Loss: 10.637038
Rec Loss: 9.910105
KL Loss: 0.726933
Y Loss: 0.585877
T Loss: 9.617166
Epoch 299 
Overall Loss: 10.617148
Rec Loss: 9.895243
KL Loss: 0.721905
Y Loss: 0.576776
T Loss: 9.606855
Epoch 349 
Overall Loss: 10.606102
Rec Loss: 9.894406
KL Loss: 0.711696
Y Loss: 0.559685
T Loss: 9.614564
Epoch 399 
Overall Loss: 10.589577
Rec Loss: 9.866762
KL Loss: 0.722815
Y Loss: 0.543254
T Loss: 9.595135
Epoch 449 
Overall Loss: 10.596586
Rec Loss: 9.893480
KL Loss: 0.703106
Y Loss: 0.548675
T Loss: 9.619142
Epoch 499 
Overall Loss: 10.584764
Rec Loss: 9.877198
KL Loss: 0.707566
Y Loss: 0.533200
T Loss: 9.610598
Epoch 549 
Overall Loss: 10.585360
Rec Loss: 9.867486
KL Loss: 0.717874
Y Loss: 0.539700
T Loss: 9.597636
Epoch 599 
Overall Loss: 10.561041
Rec Loss: 9.869908
KL Loss: 0.691133
Y Loss: 0.525530
T Loss: 9.607143
Epoch 649 
Overall Loss: 10.569414
Rec Loss: 9.865488
KL Loss: 0.703927
Y Loss: 0.532318
T Loss: 9.599329
Epoch 699 
Overall Loss: 10.554978
Rec Loss: 9.858415
KL Loss: 0.696563
Y Loss: 0.532134
T Loss: 9.592348
Epoch 749 
Overall Loss: 10.553285
Rec Loss: 9.861395
KL Loss: 0.691890
Y Loss: 0.531395
T Loss: 9.595698
Epoch 799 
Overall Loss: 10.559495
Rec Loss: 9.856361
KL Loss: 0.703134
Y Loss: 0.520903
T Loss: 9.595909
Epoch 849 
Overall Loss: 10.546533
Rec Loss: 9.841658
KL Loss: 0.704875
Y Loss: 0.514659
T Loss: 9.584328
Epoch 899 
Overall Loss: 10.546271
Rec Loss: 9.841240
KL Loss: 0.705031
Y Loss: 0.517208
T Loss: 9.582635
Epoch 949 
Overall Loss: 10.547533
Rec Loss: 9.841901
KL Loss: 0.705631
Y Loss: 0.505573
T Loss: 9.589115
Epoch 999 
Overall Loss: 10.540673
Rec Loss: 9.828881
KL Loss: 0.711791
Y Loss: 0.506673
T Loss: 9.575545
Epoch 1049 
Overall Loss: 10.521587
Rec Loss: 9.822603
KL Loss: 0.698983
Y Loss: 0.505661
T Loss: 9.569772
Epoch 1099 
Overall Loss: 10.530432
Rec Loss: 9.825012
KL Loss: 0.705419
Y Loss: 0.501081
T Loss: 9.574472
Epoch 1149 
Overall Loss: 10.528309
Rec Loss: 9.838064
KL Loss: 0.690245
Y Loss: 0.503275
T Loss: 9.586426
Epoch 1199 
Overall Loss: 10.528356
Rec Loss: 9.822443
KL Loss: 0.705913
Y Loss: 0.501203
T Loss: 9.571840
Epoch 1249 
Overall Loss: 10.531772
Rec Loss: 9.823128
KL Loss: 0.708644
Y Loss: 0.498286
T Loss: 9.573985
Epoch 1299 
Overall Loss: 10.528568
Rec Loss: 9.820530
KL Loss: 0.708037
Y Loss: 0.498088
T Loss: 9.571486
Epoch 1349 
Overall Loss: 10.524673
Rec Loss: 9.826177
KL Loss: 0.698496
Y Loss: 0.489700
T Loss: 9.581327
Epoch 1399 
Overall Loss: 10.517122
Rec Loss: 9.812018
KL Loss: 0.705103
Y Loss: 0.498185
T Loss: 9.562926
Epoch 1449 
Overall Loss: 10.518577
Rec Loss: 9.814428
KL Loss: 0.704148
Y Loss: 0.497952
T Loss: 9.565452
Epoch 1499 
Overall Loss: 10.506483
Rec Loss: 9.803309
KL Loss: 0.703173
Y Loss: 0.491541
T Loss: 9.557539
Epoch 1549 
Overall Loss: 10.511077
Rec Loss: 9.804109
KL Loss: 0.706968
Y Loss: 0.501328
T Loss: 9.553445
Epoch 1599 
Overall Loss: 10.500934
Rec Loss: 9.796312
KL Loss: 0.704622
Y Loss: 0.483399
T Loss: 9.554612
Epoch 1649 
Overall Loss: 10.508937
Rec Loss: 9.790932
KL Loss: 0.718005
Y Loss: 0.478847
T Loss: 9.551509
Epoch 1699 
Overall Loss: 10.494534
Rec Loss: 9.788392
KL Loss: 0.706142
Y Loss: 0.487142
T Loss: 9.544821
Epoch 1749 
Overall Loss: 10.505914
Rec Loss: 9.805464
KL Loss: 0.700450
Y Loss: 0.487538
T Loss: 9.561695
Epoch 1799 
Overall Loss: 10.511670
Rec Loss: 9.800858
KL Loss: 0.710812
Y Loss: 0.489822
T Loss: 9.555947
Epoch 1849 
Overall Loss: 10.491590
Rec Loss: 9.783378
KL Loss: 0.708213
Y Loss: 0.477031
T Loss: 9.544862
Epoch 1899 
Overall Loss: 10.493303
Rec Loss: 9.788510
KL Loss: 0.704792
Y Loss: 0.478053
T Loss: 9.549484
Epoch 1949 
Overall Loss: 10.502105
Rec Loss: 9.794312
KL Loss: 0.707792
Y Loss: 0.488096
T Loss: 9.550264
Epoch 1999 
Overall Loss: 10.485674
Rec Loss: 9.788163
KL Loss: 0.697512
Y Loss: 0.473869
T Loss: 9.551228
Epoch 2049 
Overall Loss: 10.495306
Rec Loss: 9.789787
KL Loss: 0.705519
Y Loss: 0.482323
T Loss: 9.548626
Epoch 2099 
Overall Loss: 10.474500
Rec Loss: 9.765795
KL Loss: 0.708705
Y Loss: 0.466799
T Loss: 9.532395
Epoch 2149 
Overall Loss: 10.488350
Rec Loss: 9.786668
KL Loss: 0.701682
Y Loss: 0.477824
T Loss: 9.547755
Epoch 2199 
Overall Loss: 10.476059
Rec Loss: 9.775022
KL Loss: 0.701036
Y Loss: 0.473436
T Loss: 9.538304
Epoch 2249 
Overall Loss: 10.483762
Rec Loss: 9.791752
KL Loss: 0.692010
Y Loss: 0.487983
T Loss: 9.547761
Epoch 2299 
Overall Loss: 10.479198
Rec Loss: 9.782371
KL Loss: 0.696826
Y Loss: 0.479211
T Loss: 9.542766
Epoch 2349 
Overall Loss: 10.470329
Rec Loss: 9.759439
KL Loss: 0.710890
Y Loss: 0.472260
T Loss: 9.523309
Epoch 2399 
Overall Loss: 10.478370
Rec Loss: 9.772924
KL Loss: 0.705446
Y Loss: 0.476415
T Loss: 9.534717
Epoch 2449 
Overall Loss: 10.473773
Rec Loss: 9.779195
KL Loss: 0.694578
Y Loss: 0.469575
T Loss: 9.544408
Epoch 2499 
Overall Loss: 10.470287
Rec Loss: 9.750354
KL Loss: 0.719934
Y Loss: 0.467056
T Loss: 9.516825
Epoch 2549 
Overall Loss: 10.463210
Rec Loss: 9.769394
KL Loss: 0.693816
Y Loss: 0.465519
T Loss: 9.536634
Epoch 2599 
Overall Loss: 10.467890
Rec Loss: 9.757949
KL Loss: 0.709941
Y Loss: 0.465394
T Loss: 9.525252
Epoch 2649 
Overall Loss: 10.474939
Rec Loss: 9.758513
KL Loss: 0.716426
Y Loss: 0.472592
T Loss: 9.522217
Epoch 2699 
Overall Loss: 10.460086
Rec Loss: 9.754735
KL Loss: 0.705352
Y Loss: 0.463601
T Loss: 9.522934
Epoch 2749 
Overall Loss: 10.446195
Rec Loss: 9.757032
KL Loss: 0.689162
Y Loss: 0.461181
T Loss: 9.526442
Epoch 2799 
Overall Loss: 10.449395
Rec Loss: 9.754477
KL Loss: 0.694918
Y Loss: 0.461675
T Loss: 9.523639
Epoch 2849 
Overall Loss: 10.451424
Rec Loss: 9.756482
KL Loss: 0.694943
Y Loss: 0.462469
T Loss: 9.525247
Epoch 2899 
Overall Loss: 10.449932
Rec Loss: 9.741280
KL Loss: 0.708653
Y Loss: 0.456536
T Loss: 9.513012
Epoch 2949 
Overall Loss: 10.451942
Rec Loss: 9.750435
KL Loss: 0.701508
Y Loss: 0.456320
T Loss: 9.522274
Epoch 2999 
Overall Loss: 10.443811
Rec Loss: 9.746671
KL Loss: 0.697140
Y Loss: 0.452116
T Loss: 9.520612
[34m== Ours: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 0.463383
Epoch 99
Rec Loss: 0.460588
Epoch 149
Rec Loss: 0.455008
Epoch 199
Rec Loss: 0.450846
Epoch 249
Rec Loss: 0.450053
Epoch 299
Rec Loss: 0.456439
[34m== Ours: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 10.193965
Epoch 99
Rec Loss: 10.170517
Epoch 149
Rec Loss: 10.159319
Epoch 199
Rec Loss: 10.150847
Epoch 249
Rec Loss: 10.142505
Epoch 299
Rec Loss: 10.142981
[34m== Ours: Testing in sample performance ==[0m
Train Error: 0.638943
Insample Error: 1.433051
[34m== CEVAE: Training all ==[0m
Epoch 49 
Overall Loss: 17.824261
Rec Loss: 13.863804
KL Loss: 3.960456
Y Loss: 7.006462
T Loss: 13.527618
X Loss: -3.167044
Epoch 99 
Overall Loss: 0.128405
Rec Loss: -9.692849
KL Loss: 9.821254
Y Loss: 2.698872
T Loss: 13.276554
X Loss: -24.318839
Epoch 149 
Overall Loss: -5.168664
Rec Loss: -16.062857
KL Loss: 10.894193
Y Loss: 2.079642
T Loss: 13.189761
X Loss: -30.292439
Epoch 199 
Overall Loss: 0.263916
Rec Loss: -11.784925
KL Loss: 12.048841
Y Loss: 1.519954
T Loss: 13.007164
X Loss: -25.552065
Epoch 249 
Overall Loss: -8.174539
Rec Loss: -19.920153
KL Loss: 11.745614
Y Loss: 1.423640
T Loss: 12.979219
X Loss: -33.611194
Epoch 299 
Overall Loss: -8.997953
Rec Loss: -21.175343
KL Loss: 12.177390
Y Loss: 1.328497
T Loss: 12.908482
X Loss: -34.748074
Epoch 349 
Overall Loss: -9.916855
Rec Loss: -22.450094
KL Loss: 12.533239
Y Loss: 1.239758
T Loss: 12.830239
X Loss: -35.900212
Epoch 399 
Overall Loss: -10.611884
Rec Loss: -23.520595
KL Loss: 12.908710
Y Loss: 1.128188
T Loss: 12.763464
X Loss: -36.848154
Epoch 449 
Overall Loss: -11.451784
Rec Loss: -24.684267
KL Loss: 13.232483
Y Loss: 1.051205
T Loss: 12.629346
X Loss: -37.839217
Epoch 499 
Overall Loss: -12.167505
Rec Loss: -25.759824
KL Loss: 13.592320
Y Loss: 1.009234
T Loss: 12.513906
X Loss: -38.778347
Epoch 549 
Overall Loss: -12.717469
Rec Loss: -26.626590
KL Loss: 13.909121
Y Loss: 0.931885
T Loss: 12.402519
X Loss: -39.495053
Epoch 599 
Overall Loss: -13.489799
Rec Loss: -27.667759
KL Loss: 14.177959
Y Loss: 0.901792
T Loss: 12.314060
X Loss: -40.432715
Epoch 649 
Overall Loss: -14.212094
Rec Loss: -28.614668
KL Loss: 14.402574
Y Loss: 0.898444
T Loss: 12.208105
X Loss: -41.271994
Epoch 699 
Overall Loss: -14.647454
Rec Loss: -29.263438
KL Loss: 14.615984
Y Loss: 0.903425
T Loss: 12.127500
X Loss: -41.842651
Epoch 749 
Overall Loss: -15.210070
Rec Loss: -30.019254
KL Loss: 14.809183
Y Loss: 0.876771
T Loss: 12.027119
X Loss: -42.484758
Epoch 799 
Overall Loss: -15.949729
Rec Loss: -30.912649
KL Loss: 14.962921
Y Loss: 0.879892
T Loss: 11.928414
X Loss: -43.281008
Epoch 849 
Overall Loss: -16.441378
Rec Loss: -31.575406
KL Loss: 15.134029
Y Loss: 0.879422
T Loss: 11.833069
X Loss: -43.848186
Epoch 899 
Overall Loss: -16.926628
Rec Loss: -32.167063
KL Loss: 15.240435
Y Loss: 0.867769
T Loss: 11.760078
X Loss: -44.361026
Epoch 949 
Overall Loss: -17.359108
Rec Loss: -32.768000
KL Loss: 15.408893
Y Loss: 0.867372
T Loss: 11.701492
X Loss: -44.903178
Epoch 999 
Overall Loss: -17.726330
Rec Loss: -33.221065
KL Loss: 15.494734
Y Loss: 0.828206
T Loss: 11.635315
X Loss: -45.270481
Epoch 1049 
Overall Loss: -17.763580
Rec Loss: -33.366302
KL Loss: 15.602722
Y Loss: 0.829935
T Loss: 11.570284
X Loss: -45.351554
Epoch 1099 
Overall Loss: -18.661392
Rec Loss: -34.367270
KL Loss: 15.705878
Y Loss: 0.821983
T Loss: 11.536172
X Loss: -46.314433
Epoch 1149 
Overall Loss: -18.733176
Rec Loss: -34.520489
KL Loss: 15.787313
Y Loss: 0.807329
T Loss: 11.490428
X Loss: -46.414582
Epoch 1199 
Overall Loss: -19.317487
Rec Loss: -35.160942
KL Loss: 15.843455
Y Loss: 0.811766
T Loss: 11.428273
X Loss: -46.995098
Epoch 1249 
Overall Loss: -19.618644
Rec Loss: -35.540894
KL Loss: 15.922249
Y Loss: 0.762500
T Loss: 11.395329
X Loss: -47.317473
Epoch 1299 
Overall Loss: -19.942637
Rec Loss: -35.865004
KL Loss: 15.922367
Y Loss: 0.776081
T Loss: 11.368390
X Loss: -47.621435
Epoch 1349 
Overall Loss: -20.353867
Rec Loss: -36.442792
KL Loss: 16.088926
Y Loss: 0.730040
T Loss: 11.331941
X Loss: -48.139753
Epoch 1399 
Overall Loss: -20.366732
Rec Loss: -36.487655
KL Loss: 16.120922
Y Loss: 0.730531
T Loss: 11.310547
X Loss: -48.163466
Epoch 1449 
Overall Loss: -20.718282
Rec Loss: -36.905102
KL Loss: 16.186822
Y Loss: 0.725818
T Loss: 11.288682
X Loss: -48.556694
Epoch 1499 
Overall Loss: -20.901415
Rec Loss: -37.185635
KL Loss: 16.284219
Y Loss: 0.712130
T Loss: 11.257217
X Loss: -48.798917
Epoch 1549 
Overall Loss: -21.043324
Rec Loss: -37.323969
KL Loss: 16.280644
Y Loss: 0.703338
T Loss: 11.247477
X Loss: -48.923117
Epoch 1599 
Overall Loss: -21.337530
Rec Loss: -37.746606
KL Loss: 16.409076
Y Loss: 0.704708
T Loss: 11.225202
X Loss: -49.324161
Epoch 1649 
Overall Loss: -21.811762
Rec Loss: -38.262586
KL Loss: 16.450823
Y Loss: 0.690606
T Loss: 11.190638
X Loss: -49.798527
Epoch 1699 
Overall Loss: -21.684167
Rec Loss: -38.158211
KL Loss: 16.474043
Y Loss: 0.703151
T Loss: 11.188272
X Loss: -49.698058
Epoch 1749 
Overall Loss: -22.012690
Rec Loss: -38.477644
KL Loss: 16.464954
Y Loss: 0.668769
T Loss: 11.162632
X Loss: -49.974661
Epoch 1799 
Overall Loss: -22.260509
Rec Loss: -38.770177
KL Loss: 16.509668
Y Loss: 0.678642
T Loss: 11.156532
X Loss: -50.266030
Epoch 1849 
Overall Loss: -22.505119
Rec Loss: -39.106338
KL Loss: 16.601220
Y Loss: 0.659455
T Loss: 11.138694
X Loss: -50.574759
Epoch 1899 
Overall Loss: -22.670655
Rec Loss: -39.239609
KL Loss: 16.568954
Y Loss: 0.668073
T Loss: 11.127435
X Loss: -50.701080
Epoch 1949 
Overall Loss: -22.812976
Rec Loss: -39.435861
KL Loss: 16.622885
Y Loss: 0.669845
T Loss: 11.110278
X Loss: -50.881062
Epoch 1999 
Overall Loss: -21.924705
Rec Loss: -38.609066
KL Loss: 16.684360
Y Loss: 0.656643
T Loss: 11.112174
X Loss: -50.049561
Epoch 2049 
Overall Loss: -23.077281
Rec Loss: -39.829651
KL Loss: 16.752370
Y Loss: 0.637830
T Loss: 11.092211
X Loss: -51.240777
Epoch 2099 
Overall Loss: -23.110771
Rec Loss: -39.929719
KL Loss: 16.818948
Y Loss: 0.636778
T Loss: 11.091303
X Loss: -51.339410
Epoch 2149 
Overall Loss: -22.985364
Rec Loss: -39.773711
KL Loss: 16.788348
Y Loss: 0.636873
T Loss: 11.089684
X Loss: -51.181832
Epoch 2199 
Overall Loss: -23.676825
Rec Loss: -40.545457
KL Loss: 16.868632
Y Loss: 0.642975
T Loss: 11.086085
X Loss: -51.953029
Epoch 2249 
Overall Loss: -23.640069
Rec Loss: -40.541695
KL Loss: 16.901625
Y Loss: 0.617139
T Loss: 11.060847
X Loss: -51.911112
Epoch 2299 
Overall Loss: -23.916915
Rec Loss: -40.822516
KL Loss: 16.905601
Y Loss: 0.621531
T Loss: 11.071495
X Loss: -52.204776
Epoch 2349 
Overall Loss: -23.959913
Rec Loss: -40.874130
KL Loss: 16.914216
Y Loss: 0.625844
T Loss: 11.051639
X Loss: -52.238690
Epoch 2399 
Overall Loss: -23.331470
Rec Loss: -40.250718
KL Loss: 16.919247
Y Loss: 0.639994
T Loss: 11.061866
X Loss: -51.632580
Epoch 2449 
Overall Loss: -23.850019
Rec Loss: -40.802286
KL Loss: 16.952267
Y Loss: 0.607265
T Loss: 11.056462
X Loss: -52.162381
Epoch 2499 
Overall Loss: -23.991775
Rec Loss: -40.930150
KL Loss: 16.938376
Y Loss: 0.627429
T Loss: 11.052023
X Loss: -52.295889
Epoch 2549 
Overall Loss: -24.603488
Rec Loss: -41.638141
KL Loss: 17.034652
Y Loss: 0.617250
T Loss: 11.039162
X Loss: -52.985929
Epoch 2599 
Overall Loss: -24.611736
Rec Loss: -41.640722
KL Loss: 17.028985
Y Loss: 0.610788
T Loss: 11.050330
X Loss: -52.996445
Epoch 2649 
Overall Loss: -24.576971
Rec Loss: -41.637381
KL Loss: 17.060410
Y Loss: 0.598720
T Loss: 11.033961
X Loss: -52.970702
Epoch 2699 
Overall Loss: -24.493449
Rec Loss: -41.600178
KL Loss: 17.106729
Y Loss: 0.603619
T Loss: 11.029095
X Loss: -52.931082
Epoch 2749 
Overall Loss: -24.799173
Rec Loss: -41.860211
KL Loss: 17.061037
Y Loss: 0.589714
T Loss: 11.029987
X Loss: -53.185055
Epoch 2799 
Overall Loss: -24.446945
Rec Loss: -41.632961
KL Loss: 17.186015
Y Loss: 0.604246
T Loss: 11.015626
X Loss: -52.950710
Epoch 2849 
Overall Loss: -24.387576
Rec Loss: -41.517763
KL Loss: 17.130187
Y Loss: 0.584882
T Loss: 11.013665
X Loss: -52.823870
Epoch 2899 
Overall Loss: -24.669293
Rec Loss: -41.869145
KL Loss: 17.199851
Y Loss: 0.587343
T Loss: 11.013097
X Loss: -53.175912
Epoch 2949 
Overall Loss: -25.464749
Rec Loss: -42.519896
KL Loss: 17.055148
Y Loss: 0.602626
T Loss: 11.022666
X Loss: -53.843875
Epoch 2999 
Overall Loss: -25.296551
Rec Loss: -42.505454
KL Loss: 17.208903
Y Loss: 0.583203
T Loss: 11.014562
X Loss: -53.811618
[34m== CEVAE: Reconstructing confounder ==[0m
Epoch 49
Rec Loss: 2.366636
Epoch 99
Rec Loss: 2.360854
Epoch 149
Rec Loss: 2.355065
Epoch 199
Rec Loss: 2.354826
Epoch 249
Rec Loss: 2.348372
Epoch 299
Rec Loss: 2.340813
Epoch 349
Rec Loss: 2.344222
[34m== CEVAE: Reconstructing noise ==[0m
Epoch 49
Rec Loss: 0.004678
Epoch 99
Rec Loss: 0.002364
Epoch 149
Rec Loss: 0.002225
Epoch 199
Rec Loss: 0.001422
Epoch 249
Rec Loss: 0.001614
[34m== CEVAE: Testing in sample performance ==[0m
Train Error 0.451730
Insample Error 2.824316
[34m== Direct Regression: Training all ==[0m
Epoch 49 
Prediction Loss: 0.977459
Epoch 99 
Prediction Loss: 0.717126
Epoch 149 
Prediction Loss: 0.671727
Epoch 199 
Prediction Loss: 0.647838
Epoch 249 
Prediction Loss: 0.635354
Epoch 299 
Prediction Loss: 0.628735
Epoch 349 
Prediction Loss: 0.611677
Epoch 399 
Prediction Loss: 0.599009
Epoch 449 
Prediction Loss: 0.590459
Epoch 499 
Prediction Loss: 0.588304
Epoch 549 
Prediction Loss: 0.578578
Epoch 599 
Prediction Loss: 0.583798
Epoch 649 
Prediction Loss: 0.576971
Epoch 699 
Prediction Loss: 0.571654
Epoch 749 
Prediction Loss: 0.563387
Epoch 799 
Prediction Loss: 0.569875
Epoch 849 
Prediction Loss: 0.566531
Epoch 899 
Prediction Loss: 0.559811
Epoch 949 
Prediction Loss: 0.554564
Epoch 999 
Prediction Loss: 0.550970
Epoch 1049 
Prediction Loss: 0.550550
Epoch 1099 
Prediction Loss: 0.562091
Epoch 1149 
Prediction Loss: 0.548149
Epoch 1199 
Prediction Loss: 0.549518
Epoch 1249 
Prediction Loss: 0.545361
Epoch 1299 
Prediction Loss: 0.549065
Epoch 1349 
Prediction Loss: 0.540356
Epoch 1399 
Prediction Loss: 0.542315
Epoch 1449 
Prediction Loss: 0.549827
Epoch 1499 
Prediction Loss: 0.541014
Epoch 1549 
Prediction Loss: 0.536748
Epoch 1599 
Prediction Loss: 0.531695
Epoch 1649 
Prediction Loss: 0.534357
Epoch 1699 
Prediction Loss: 0.530003
Epoch 1749 
Prediction Loss: 0.533166
Epoch 1799 
Prediction Loss: 0.529484
Epoch 1849 
Prediction Loss: 0.527393
Epoch 1899 
Prediction Loss: 0.519728
Epoch 1949 
Prediction Loss: 0.524712
Epoch 1999 
Prediction Loss: 0.515387
Epoch 2049 
Prediction Loss: 0.520706
Epoch 2099 
Prediction Loss: 0.519475
Epoch 2149 
Prediction Loss: 0.516088
Epoch 2199 
Prediction Loss: 0.519065
Epoch 2249 
Prediction Loss: 0.516968
Epoch 2299 
Prediction Loss: 0.521553
Epoch 2349 
Prediction Loss: 0.505712
Epoch 2399 
Prediction Loss: 0.506599
Epoch 2449 
Prediction Loss: 0.509313
Epoch 2499 
Prediction Loss: 0.504600
Epoch 2549 
Prediction Loss: 0.508113
Epoch 2599 
Prediction Loss: 0.498822
Epoch 2649 
Prediction Loss: 0.497851
Epoch 2699 
Prediction Loss: 0.503617
Epoch 2749 
Prediction Loss: 0.497571
Epoch 2799 
Prediction Loss: 0.498703
Epoch 2849 
Prediction Loss: 0.493051
Epoch 2899 
Prediction Loss: 0.487284
Epoch 2949 
Prediction Loss: 0.495089
Epoch 2999 
Prediction Loss: 0.486052
Epoch 3049 
Prediction Loss: 0.485807
Epoch 3099 
Prediction Loss: 0.483403
Epoch 3149 
Prediction Loss: 0.483606
Epoch 3199 
Prediction Loss: 0.489467
Epoch 3249 
Prediction Loss: 0.477080
Epoch 3299 
Prediction Loss: 0.475592
Epoch 3349 
Prediction Loss: 0.476108
Epoch 3399 
Prediction Loss: 0.474461
Epoch 3449 
Prediction Loss: 0.470156
Epoch 3499 
Prediction Loss: 0.484269
Epoch 3549 
Prediction Loss: 0.467555
Epoch 3599 
Prediction Loss: 0.464518
Epoch 3649 
Prediction Loss: 0.465222
Epoch 3699 
Prediction Loss: 0.464827
Epoch 3749 
Prediction Loss: 0.461481
Epoch 3799 
Prediction Loss: 0.462003
Epoch 3849 
Prediction Loss: 0.457973
Epoch 3899 
Prediction Loss: 0.461265
Epoch 3949 
Prediction Loss: 0.454530
Epoch 3999 
Prediction Loss: 0.458687
Epoch 4049 
Prediction Loss: 0.451382
Epoch 4099 
Prediction Loss: 0.451316
Epoch 4149 
Prediction Loss: 0.447837
Epoch 4199 
Prediction Loss: 0.443081
Epoch 4249 
Prediction Loss: 0.443544
Epoch 4299 
Prediction Loss: 0.445040
Epoch 4349 
Prediction Loss: 0.442692
Epoch 4399 
Prediction Loss: 0.448441
Epoch 4449 
Prediction Loss: 0.443556
Epoch 4499 
Prediction Loss: 0.445478
Epoch 4549 
Prediction Loss: 0.439218
Epoch 4599 
Prediction Loss: 0.436988
Epoch 4649 
Prediction Loss: 0.432174
Epoch 4699 
Prediction Loss: 0.435367
Epoch 4749 
Prediction Loss: 0.438841
Epoch 4799 
Prediction Loss: 0.427089
Epoch 4849 
Prediction Loss: 0.428863
Epoch 4899 
Prediction Loss: 0.432972
Epoch 4949 
Prediction Loss: 0.422226
Epoch 4999 
Prediction Loss: 0.423192
Epoch 5049 
Prediction Loss: 0.424395
Epoch 5099 
Prediction Loss: 0.426769
Epoch 5149 
Prediction Loss: 0.418951
Epoch 5199 
Prediction Loss: 0.412119
Epoch 5249 
Prediction Loss: 0.423434
Epoch 5299 
Prediction Loss: 0.421735
Epoch 5349 
Prediction Loss: 0.419227
Epoch 5399 
Prediction Loss: 0.420178
Epoch 5449 
Prediction Loss: 0.410138
Epoch 5499 
Prediction Loss: 0.414087
Epoch 5549 
Prediction Loss: 0.406965
Epoch 5599 
Prediction Loss: 0.420340
Epoch 5649 
Prediction Loss: 0.405127
Epoch 5699 
Prediction Loss: 0.397535
Epoch 5749 
Prediction Loss: 0.409779
Epoch 5799 
Prediction Loss: 0.395996
Epoch 5849 
Prediction Loss: 0.390584
Epoch 5899 
Prediction Loss: 0.395872
Epoch 5949 
Prediction Loss: 0.388878
Epoch 5999 
Prediction Loss: 0.387358
[34m== Direct Regression: Testing in sample performance ==[0m
Train Error 0.623117
Insample Error 1.584092
Ours, Train RMSE
0.6323, 
0.6309, 
0.6731, 
0.6550, 
0.6389, 
CEVAE, Train RMSE
0.4172, 
0.3653, 
0.3569, 
0.4151, 
0.4517, 
Ours, Insample RMSE
1.4380, 
1.4889, 
1.4747, 
1.5164, 
1.4331, 
CEVAE, Insample RMSE
3.0313, 
3.4492, 
2.6840, 
4.6137, 
2.8243, 
Direct Regression, Insample RMSE
1.6086, 
1.6323, 
1.6672, 
1.6129, 
1.5841, 
Train, RMSE mean 0.6461 std 0.0160
CEVAE, RMSE mean 0.4013 std 0.0354
Ours, RMSE mean 1.4702 std 0.0314, reconstruct confounder 0.4568 (0.0115) noise 10.1692 (0.0164)
CEVAE, RMSE mean 3.3205 std 0.6963, reconstruct confounder 2.3324 (0.0584) noise 0.0013 (0.0003)
Direct Regression, RMSE mean 1.6210 std 0.0277
